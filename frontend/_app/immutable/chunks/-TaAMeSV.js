var KO=Object.defineProperty;var Qv=n=>{throw TypeError(n)};var XO=(n,e,t)=>e in n?KO(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ze=(n,e,t)=>XO(n,typeof e!="symbol"?e+"":e,t),Yy=(n,e,t)=>e.has(n)||Qv("Cannot "+t);var b=(n,e,t)=>(Yy(n,e,"read from private field"),t?t.call(n):e.get(n)),B=(n,e,t)=>e.has(n)?Qv("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),N=(n,e,t,i)=>(Yy(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),L=(n,e,t)=>(Yy(n,e,"access private method"),t);var Rr=(n,e,t,i)=>({set _(s){N(n,e,s,t)},get _(){return b(n,e,i)}});import{s as qt,y as Et,e as ie,k as Se,c as se,o as Ie,f as A,U as tn,i as te,u as xt,A as Wt,d as E,j as Oe,p as qs,C as un,a as V,r as zs,v as js,w as Gs,x as Vs,l as Xt,R as vo,g as W,D as lt,E as ct,t as At,b as St,h as Pt,X as _o,n as It,W as Ka,q as ol,I as Gh,F as Zr,_ as g0,z as zg,B as xo,Y as yI,Z as wI,aq as mn,K as Qi,L as ai,M as ll,P as ra,V as Ds,a3 as Qe,a4 as Ip,ar as c3,al as vI,a1 as h3,N as Yn,a2 as vg,J as Rh,ak as YO,as as JO,ao as ZO,am as $v,an as e_,S as t_,Q as Ax,m as QO}from"./CpYWeDpV.js";import{S as Ht,i as zt,f as Kt,b as be,d as ve,m as xe,t as H,a as q,e as ye,g as yt,c as wt,h as up}from"./A77IWoha.js";import{g as _I}from"./D0QH3NT1.js";import{t as on,p as n_}from"./DRUj32p2.js";import{j as Ko,bB as kI,bC as Y6,bD as Jy,bE as Zy,aG as jg,bF as $O,aq as eD,bG as tD,bH as nD,bI as iD,bJ as sD}from"./_oz107bi.js";import{C as rD,D as aD,I as oD,a as lD,h as cD,b as CI,c as hD,P as uD}from"./LdMQ3QBi.js";import{w as $t,a as Io,d as Kf,g as i_}from"./D5y9Pikv.js";import{p as s_}from"./5_pD_hR2.js";import{t as zd,u as w0,c as Gg,j as tx,D as AI,a as ja,l as Od,m as Vg,T as Jw,e as Yo,d as dD,Y as r_,Z as Fa,G as Ki,J as n0,F as Jl,W as SI,h as cu,s as Zw,N as fD,v as gD,f as a_,B as mD,H as pD,P as u3,C as Kh,n as bD,Q as Sx,E as Xh,i as xD}from"./CII-ifV1.js";import{v as kl,L as o_,M as yD,a as Oa,h as wD,i as vD,j as _D,k as kD,n as CD,o as AD,p as SD,m as _g,q as ID,d as J6,y as ED,w as d3,N as TD,O as RD,P as MD,b as PD,E as Qy,D as $y}from"./CGXrK5Vj.js";import{h as Qw,j as cf,C as ND,u as ew,e as OD,a as DD}from"./CAwXrIow.js";import{g as LD}from"./BpCxpEqW.js";import{p as FD,c as BD}from"./CeBPNkuN.js";import{j as l_,g as c_,k as h_}from"./DUKUEZdH.js";import{w as UD,x as HD,y as zD,z as jD,A as GD,B as VD,C as qD}from"./p9RbhZKl.js";import{g as Z6,j as WD,k as KD,m as XD}from"./NBCPB5M7.js";import{f as dp}from"./Ce8fqCmC.js";import{e as ni,u as j5,o as G5}from"./BvZIxBJR.js";import{u as YD}from"./xa08u1tN.js";import"./C9NuHAYV.js";import{M as II,a as EI,b as TI}from"./DvvCzOWK.js";import{M as ha}from"./Cigl7-MF.js";import{b as Q6}from"./CKXXzQBv.js";import{f as V5}from"./CBc5jlPY.js";import{D as $6}from"./B7q7rktR.js";import{T as yi}from"./BP0ESyD0.js";import{S as JD}from"./D17tzOGu.js";import{W as ZD,B as e4}from"./DQvY1UnC.js";import{V as QD,R as $D,D as eL}from"./Bcbhvo6A.js";import{F as tL}from"./BFJdv29V.js";import{M as nL}from"./CBRABhh8.js";import{X as qg}from"./tGJoZG05.js";import{F as RI}from"./CQImYGIE.js";import{G as iL}from"./z35fUBA9.js";import{S as sL}from"./Des-ZCXq.js";import{K as rL,S as aL,M as oL}from"./BMfnlrZ5.js";import{T as lL,S as cL}from"./DMgJHBIz.js";import{S as hL}from"./tEaCy1yn.js";import{f as uL}from"./CyTOOynw.js";import{E as u_,h as dL}from"./CMN7qSiR.js";import{M as fL,U as gL}from"./BuMMzUyG.js";import{M as mL}from"./U7svfMp8.js";import{P as MI}from"./Cg0Ew_Fo.js";/* empty css        */import{A as pL}from"./dO0E1cNA.js";import{g as bL,j as xL,k as yL,m as wL}from"./yURkOgmz.js";import{S as t4}from"./8PHfpnp8.js";import{V as vL,H as _L}from"./CfOKkuv2.js";import{s as kL,t as CL}from"./DVv-wuCi.js";import{P as PI}from"./Cgx9ELzN.js";import{g as Nh,a as Ep}from"./CgU5AtxT.js";import{E as AL}from"./C5S_ig62.js";import{A as SL}from"./C6fGBNqr.js";import{C as IL}from"./CPo0RP4Q.js";import{E as EL}from"./vYXyNVrM.js";function TL(n){let e;for(;e=n.sourceEvent;)n=e;return n}function Cl(n,e){if(n=TL(n),e===void 0&&(e=n.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var i=t.createSVGPoint();return i.x=n.clientX,i.y=n.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[n.clientX-s.left-e.clientLeft,n.clientY-s.top-e.clientTop]}}return[n.pageX,n.pageY]}const RL={passive:!1},Tp={capture:!0,passive:!1};function tw(n){n.stopImmediatePropagation()}function Xf(n){n.preventDefault(),n.stopImmediatePropagation()}function NI(n){var e=n.document.documentElement,t=Ko(n).on("dragstart.drag",Xf,Tp);"onselectstart"in e?t.on("selectstart.drag",Xf,Tp):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function OI(n,e){var t=n.document.documentElement,i=Ko(n).on("dragstart.drag",null);e&&(i.on("click.drag",Xf,Tp),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in t?i.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const Ix=n=>()=>n;function $w(n,{sourceEvent:e,subject:t,target:i,identifier:s,active:r,x:a,y:o,dx:l,dy:c,dispatch:h}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:r,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:h}})}$w.prototype.on=function(){var n=this._.on.apply(this._,arguments);return n===this._?this:n};function ML(n){return!n.ctrlKey&&!n.button}function PL(){return this.parentNode}function NL(n,e){return e??{x:n.x,y:n.y}}function OL(){return navigator.maxTouchPoints||"ontouchstart"in this}function DL(){var n=ML,e=PL,t=NL,i=OL,s={},r=kI("start","drag","end"),a=0,o,l,c,h,u=0;function d(v){v.on("mousedown.drag",f).filter(i).on("touchstart.drag",x).on("touchmove.drag",p,RL).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(v,_){if(!(h||!n.call(this,v,_))){var C=w(this,e.call(this,v,_),v,_,"mouse");C&&(Ko(v.view).on("mousemove.drag",g,Tp).on("mouseup.drag",m,Tp),NI(v.view),tw(v),c=!1,o=v.clientX,l=v.clientY,C("start",v))}}function g(v){if(Xf(v),!c){var _=v.clientX-o,C=v.clientY-l;c=_*_+C*C>u}s.mouse("drag",v)}function m(v){Ko(v.view).on("mousemove.drag mouseup.drag",null),OI(v.view,c),Xf(v),s.mouse("end",v)}function x(v,_){if(n.call(this,v,_)){var C=v.changedTouches,k=e.call(this,v,_),I=C.length,S,R;for(S=0;S<I;++S)(R=w(this,k,v,_,C[S].identifier,C[S]))&&(tw(v),R("start",v,C[S]))}}function p(v){var _=v.changedTouches,C=_.length,k,I;for(k=0;k<C;++k)(I=s[_[k].identifier])&&(Xf(v),I("drag",v,_[k]))}function y(v){var _=v.changedTouches,C=_.length,k,I;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),k=0;k<C;++k)(I=s[_[k].identifier])&&(tw(v),I("end",v,_[k]))}function w(v,_,C,k,I,S){var R=r.copy(),P=Cl(S||C,_),D,U,T;if((T=t.call(v,new $w("beforestart",{sourceEvent:C,target:d,identifier:I,active:a,x:P[0],y:P[1],dx:0,dy:0,dispatch:R}),k))!=null)return D=T.x-P[0]||0,U=T.y-P[1]||0,function G(M,F,X){var z=P,K;switch(M){case"start":s[I]=G,K=a++;break;case"end":delete s[I],--a;case"drag":P=Cl(X||F,_),K=a;break}R.call(M,v,new $w(M,{sourceEvent:F,subject:T,target:d,identifier:I,active:K,x:P[0]+D,y:P[1]+U,dx:P[0]-z[0],dy:P[1]-z[1],dispatch:R}),k)}}return d.filter=function(v){return arguments.length?(n=typeof v=="function"?v:Ix(!!v),d):n},d.container=function(v){return arguments.length?(e=typeof v=="function"?v:Ix(v),d):e},d.subject=function(v){return arguments.length?(t=typeof v=="function"?v:Ix(v),d):t},d.touchable=function(v){return arguments.length?(i=typeof v=="function"?v:Ix(!!v),d):i},d.on=function(){var v=r.on.apply(r,arguments);return v===r?d:v},d.clickDistance=function(v){return arguments.length?(u=(v=+v)*v,d):Math.sqrt(u)},d}var LL=1e-12;function d_(n){return((n=Math.exp(n))+1/n)/2}function FL(n){return((n=Math.exp(n))-1/n)/2}function BL(n){return((n=Math.exp(2*n))-1)/(n+1)}const UL=function n(e,t,i){function s(r,a){var o=r[0],l=r[1],c=r[2],h=a[0],u=a[1],d=a[2],f=h-o,g=u-l,m=f*f+g*g,x,p;if(m<LL)p=Math.log(d/c)/e,x=function(k){return[o+k*f,l+k*g,c*Math.exp(e*k*p)]};else{var y=Math.sqrt(m),w=(d*d-c*c+i*m)/(2*c*t*y),v=(d*d-c*c-i*m)/(2*d*t*y),_=Math.log(Math.sqrt(w*w+1)-w),C=Math.log(Math.sqrt(v*v+1)-v);p=(C-_)/e,x=function(k){var I=k*p,S=d_(_),R=c/(t*y)*(S*BL(e*I+_)-FL(_));return[o+R*f,l+R*g,c*S/d_(e*I+_)]}}return x.duration=p*1e3*e/Math.SQRT2,x}return s.rho=function(r){var a=Math.max(.001,+r),o=a*a,l=o*o;return n(a,o,l)},s}(Math.SQRT2,2,4),Ex=n=>()=>n;function HL(n,{sourceEvent:e,target:t,transform:i,dispatch:s}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:s}})}function nw(n){n.stopImmediatePropagation()}function bm(n){n.preventDefault(),n.stopImmediatePropagation()}function zL(n){return(!n.ctrlKey||n.type==="wheel")&&!n.button}function jL(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function f_(){return this.__zoom||Y6}function GL(n){return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*(n.ctrlKey?10:1)}function VL(){return navigator.maxTouchPoints||"ontouchstart"in this}function qL(n,e,t){var i=n.invertX(e[0][0])-t[0][0],s=n.invertX(e[1][0])-t[1][0],r=n.invertY(e[0][1])-t[0][1],a=n.invertY(e[1][1])-t[1][1];return n.translate(s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s),a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a))}function WL(){var n=zL,e=jL,t=qL,i=GL,s=VL,r=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],o=250,l=UL,c=kI("start","zoom","end"),h,u,d,f=500,g=150,m=0,x=10;function p(T){T.property("__zoom",f_).on("wheel.zoom",I,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",R).filter(s).on("touchstart.zoom",P).on("touchmove.zoom",D).on("touchend.zoom touchcancel.zoom",U).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(T,G,M,F){var X=T.selection?T.selection():T;X.property("__zoom",f_),T!==X?_(T,G,M,F):X.interrupt().each(function(){C(this,arguments).event(F).start().zoom(null,typeof G=="function"?G.apply(this,arguments):G).end()})},p.scaleBy=function(T,G,M,F){p.scaleTo(T,function(){var X=this.__zoom.k,z=typeof G=="function"?G.apply(this,arguments):G;return X*z},M,F)},p.scaleTo=function(T,G,M,F){p.transform(T,function(){var X=e.apply(this,arguments),z=this.__zoom,K=M==null?v(X):typeof M=="function"?M.apply(this,arguments):M,j=z.invert(K),ae=typeof G=="function"?G.apply(this,arguments):G;return t(w(y(z,ae),K,j),X,a)},M,F)},p.translateBy=function(T,G,M,F){p.transform(T,function(){return t(this.__zoom.translate(typeof G=="function"?G.apply(this,arguments):G,typeof M=="function"?M.apply(this,arguments):M),e.apply(this,arguments),a)},null,F)},p.translateTo=function(T,G,M,F,X){p.transform(T,function(){var z=e.apply(this,arguments),K=this.__zoom,j=F==null?v(z):typeof F=="function"?F.apply(this,arguments):F;return t(Y6.translate(j[0],j[1]).scale(K.k).translate(typeof G=="function"?-G.apply(this,arguments):-G,typeof M=="function"?-M.apply(this,arguments):-M),z,a)},F,X)};function y(T,G){return G=Math.max(r[0],Math.min(r[1],G)),G===T.k?T:new Jy(G,T.x,T.y)}function w(T,G,M){var F=G[0]-M[0]*T.k,X=G[1]-M[1]*T.k;return F===T.x&&X===T.y?T:new Jy(T.k,F,X)}function v(T){return[(+T[0][0]+ +T[1][0])/2,(+T[0][1]+ +T[1][1])/2]}function _(T,G,M,F){T.on("start.zoom",function(){C(this,arguments).event(F).start()}).on("interrupt.zoom end.zoom",function(){C(this,arguments).event(F).end()}).tween("zoom",function(){var X=this,z=arguments,K=C(X,z).event(F),j=e.apply(X,z),ae=M==null?v(j):typeof M=="function"?M.apply(X,z):M,ge=Math.max(j[1][0]-j[0][0],j[1][1]-j[0][1]),ue=X.__zoom,pe=typeof G=="function"?G.apply(X,z):G,de=l(ue.invert(ae).concat(ge/ue.k),pe.invert(ae).concat(ge/pe.k));return function(O){if(O===1)O=pe;else{var Y=de(O),le=ge/Y[2];O=new Jy(le,ae[0]-Y[0]*le,ae[1]-Y[1]*le)}K.zoom(null,O)}})}function C(T,G,M){return!M&&T.__zooming||new k(T,G)}function k(T,G){this.that=T,this.args=G,this.active=0,this.sourceEvent=null,this.extent=e.apply(T,G),this.taps=0}k.prototype={event:function(T){return T&&(this.sourceEvent=T),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(T,G){return this.mouse&&T!=="mouse"&&(this.mouse[1]=G.invert(this.mouse[0])),this.touch0&&T!=="touch"&&(this.touch0[1]=G.invert(this.touch0[0])),this.touch1&&T!=="touch"&&(this.touch1[1]=G.invert(this.touch1[0])),this.that.__zoom=G,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(T){var G=Ko(this.that).datum();c.call(T,this.that,new HL(T,{sourceEvent:this.sourceEvent,target:p,type:T,transform:this.that.__zoom,dispatch:c}),G)}};function I(T,...G){if(!n.apply(this,arguments))return;var M=C(this,G).event(T),F=this.__zoom,X=Math.max(r[0],Math.min(r[1],F.k*Math.pow(2,i.apply(this,arguments)))),z=Cl(T);if(M.wheel)(M.mouse[0][0]!==z[0]||M.mouse[0][1]!==z[1])&&(M.mouse[1]=F.invert(M.mouse[0]=z)),clearTimeout(M.wheel);else{if(F.k===X)return;M.mouse=[z,F.invert(z)],Zy(this),M.start()}bm(T),M.wheel=setTimeout(K,g),M.zoom("mouse",t(w(y(F,X),M.mouse[0],M.mouse[1]),M.extent,a));function K(){M.wheel=null,M.end()}}function S(T,...G){if(d||!n.apply(this,arguments))return;var M=T.currentTarget,F=C(this,G,!0).event(T),X=Ko(T.view).on("mousemove.zoom",ae,!0).on("mouseup.zoom",ge,!0),z=Cl(T,M),K=T.clientX,j=T.clientY;NI(T.view),nw(T),F.mouse=[z,this.__zoom.invert(z)],Zy(this),F.start();function ae(ue){if(bm(ue),!F.moved){var pe=ue.clientX-K,de=ue.clientY-j;F.moved=pe*pe+de*de>m}F.event(ue).zoom("mouse",t(w(F.that.__zoom,F.mouse[0]=Cl(ue,M),F.mouse[1]),F.extent,a))}function ge(ue){X.on("mousemove.zoom mouseup.zoom",null),OI(ue.view,F.moved),bm(ue),F.event(ue).end()}}function R(T,...G){if(n.apply(this,arguments)){var M=this.__zoom,F=Cl(T.changedTouches?T.changedTouches[0]:T,this),X=M.invert(F),z=M.k*(T.shiftKey?.5:2),K=t(w(y(M,z),F,X),e.apply(this,G),a);bm(T),o>0?Ko(this).transition().duration(o).call(_,K,F,T):Ko(this).call(p.transform,K,F,T)}}function P(T,...G){if(n.apply(this,arguments)){var M=T.touches,F=M.length,X=C(this,G,T.changedTouches.length===F).event(T),z,K,j,ae;for(nw(T),K=0;K<F;++K)j=M[K],ae=Cl(j,this),ae=[ae,this.__zoom.invert(ae),j.identifier],X.touch0?!X.touch1&&X.touch0[2]!==ae[2]&&(X.touch1=ae,X.taps=0):(X.touch0=ae,z=!0,X.taps=1+!!h);h&&(h=clearTimeout(h)),z&&(X.taps<2&&(u=ae[0],h=setTimeout(function(){h=null},f)),Zy(this),X.start())}}function D(T,...G){if(this.__zooming){var M=C(this,G).event(T),F=T.changedTouches,X=F.length,z,K,j,ae;for(bm(T),z=0;z<X;++z)K=F[z],j=Cl(K,this),M.touch0&&M.touch0[2]===K.identifier?M.touch0[0]=j:M.touch1&&M.touch1[2]===K.identifier&&(M.touch1[0]=j);if(K=M.that.__zoom,M.touch1){var ge=M.touch0[0],ue=M.touch0[1],pe=M.touch1[0],de=M.touch1[1],O=(O=pe[0]-ge[0])*O+(O=pe[1]-ge[1])*O,Y=(Y=de[0]-ue[0])*Y+(Y=de[1]-ue[1])*Y;K=y(K,Math.sqrt(O/Y)),j=[(ge[0]+pe[0])/2,(ge[1]+pe[1])/2],ae=[(ue[0]+de[0])/2,(ue[1]+de[1])/2]}else if(M.touch0)j=M.touch0[0],ae=M.touch0[1];else return;M.zoom("touch",t(w(K,j,ae),M.extent,a))}}function U(T,...G){if(this.__zooming){var M=C(this,G).event(T),F=T.changedTouches,X=F.length,z,K;for(nw(T),d&&clearTimeout(d),d=setTimeout(function(){d=null},f),z=0;z<X;++z)K=F[z],M.touch0&&M.touch0[2]===K.identifier?delete M.touch0:M.touch1&&M.touch1[2]===K.identifier&&delete M.touch1;if(M.touch1&&!M.touch0&&(M.touch0=M.touch1,delete M.touch1),M.touch0)M.touch0[1]=this.__zoom.invert(M.touch0[0]);else if(M.end(),M.taps===2&&(K=Cl(K,this),Math.hypot(u[0]-K[0],u[1]-K[1])<x)){var j=Ko(this).on("dblclick.zoom");j&&j.apply(this,arguments)}}}return p.wheelDelta=function(T){return arguments.length?(i=typeof T=="function"?T:Ex(+T),p):i},p.filter=function(T){return arguments.length?(n=typeof T=="function"?T:Ex(!!T),p):n},p.touchable=function(T){return arguments.length?(s=typeof T=="function"?T:Ex(!!T),p):s},p.extent=function(T){return arguments.length?(e=typeof T=="function"?T:Ex([[+T[0][0],+T[0][1]],[+T[1][0],+T[1][1]]]),p):e},p.scaleExtent=function(T){return arguments.length?(r[0]=+T[0],r[1]=+T[1],p):[r[0],r[1]]},p.translateExtent=function(T){return arguments.length?(a[0][0]=+T[0][0],a[1][0]=+T[1][0],a[0][1]=+T[0][1],a[1][1]=+T[1][1],p):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},p.constrain=function(T){return arguments.length?(t=T,p):t},p.duration=function(T){return arguments.length?(o=+T,p):o},p.interpolate=function(T){return arguments.length?(l=T,p):l},p.on=function(){var T=c.on.apply(c,arguments);return T===c?p:T},p.clickDistance=function(T){return arguments.length?(m=(T=+T)*T,p):Math.sqrt(m)},p.tapDistance=function(T){return arguments.length?(x=+T,p):x},p}function KL(n){let e,t,i,s,r,a,o;return l(),{feed:c,reset:l};function l(){e=!0,t="",i=0,s=-1,r=void 0,a=void 0,o=""}function c(u){t=t?t+u:u,e&&XL(t)&&(t=t.slice(DI.length)),e=!1;const d=t.length;let f=0,g=!1;for(;f<d;){g&&(t[f]===`
`&&++f,g=!1);let m=-1,x=s,p;for(let y=i;m<0&&y<d;++y)p=t[y],p===":"&&x<0?x=y-f:p==="\r"?(g=!0,m=y-f):p===`
`&&(m=y-f);if(m<0){i=d-f,s=x;break}else i=0,s=-1;h(t,f,x,m),f+=m+1}f===d?t="":f>0&&(t=t.slice(f))}function h(u,d,f,g){if(g===0){o.length>0&&(n({type:"event",id:r,event:a||void 0,data:o.slice(0,-1)}),o="",r=void 0),a=void 0;return}const m=f<0,x=u.slice(d,d+(m?g:f));let p=0;m?p=g:u[d+f+1]===" "?p=f+2:p=f+1;const y=d+p,w=g-p,v=u.slice(y,y+w).toString();if(x==="data")o+=v?"".concat(v,`
`):`
`;else if(x==="event")a=v;else if(x==="id"&&!v.includes("\0"))r=v;else if(x==="retry"){const _=parseInt(v,10);Number.isNaN(_)||n({type:"reconnect-interval",value:_})}}}const DI=[239,187,191];function XL(n){return DI.every((e,t)=>n.charCodeAt(t)===e)}class YL extends TransformStream{constructor(){let e;super({start(t){e=KL(i=>{i.type==="event"&&t.enqueue(i)})},transform(t){e.feed(t)}})}}async function JL(n,e){const t=n.pipeThrough(new TextDecoderStream).pipeThrough(new YL).getReader();let i=ZL(t);return e&&(i=QL(i)),i}async function*ZL(n){var e,t,i;for(;;){const{value:s,done:r}=await n.read();if(r){yield{done:!0,value:""};break}if(!s)continue;const a=s.data;if(a.startsWith("[DONE]")){yield{done:!0,value:""};break}try{const o=JSON.parse(a);if(o.error){yield{done:!0,value:"",error:o.error};break}if(o.sources){yield{done:!1,value:"",sources:o.sources};continue}if(o.selected_model_id){yield{done:!1,value:"",selectedModelId:o.selected_model_id};continue}if(o.usage){yield{done:!1,value:"",usage:o.usage};continue}yield{done:!1,value:((i=(t=(e=o.choices)==null?void 0:e[0])==null?void 0:t.delta)==null?void 0:i.content)??""}}catch(o){console.error("Error extracting delta from SSE event:",o)}}}async function*QL(n){for await(const e of n){if(e.done){yield e;return}if(e.error){yield e;continue}if(e.sources){yield e;continue}if(e.selectedModelId){yield e;continue}if(e.usage){yield e;continue}let t=e.value;if(t.length<5){yield{done:!1,value:t};continue}for(;t!="";){const i=Math.min(Math.floor(Math.random()*3)+1,t.length);yield{done:!1,value:t.slice(0,i)},(document==null?void 0:document.visibilityState)!=="hidden"&&await $L(5),t=t.slice(i)}}}const $L=n=>new Promise(e=>setTimeout(e,n)),Br=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),e8=[.001,0,0,.001,0,0],iw=1.35,Da={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},T0={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},LI="pdfjs_internal_editor_",yn={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},Vn={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},eF={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},pr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},m9={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},us={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},xf={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},q5={ERRORS:0,WARNINGS:1,INFOS:5},f3={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Tx={moveTo:0,lineTo:1,curveTo:2,closePath:3},tF={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let W5=q5.WARNINGS;function nF(n){Number.isInteger(n)&&(W5=n)}function iF(){return W5}function K5(n){W5>=q5.INFOS&&`${n}`}function wn(n){W5>=q5.WARNINGS&&`${n}`}function gi(n){throw new Error(n)}function gs(n,e){n||gi(e)}function sF(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function FI(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=cF(n)}catch{}}const i=e?URL.parse(n,e):URL.parse(n);return sF(i)?i:null}function BI(n,e,t=!1){const i=URL.parse(n);return i?(i.hash=e,i.href):t&&FI(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Hn(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const sf=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();let g_=class extends sf{constructor(e,t){super(e,"PasswordException"),this.code=t}},sw=class extends sf{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}},t8=class extends sf{constructor(e){super(e,"InvalidPDFException")}},g3=class extends sf{constructor(e,t,i){super(e,"ResponseException"),this.status=t,this.missing=i}},rF=class extends sf{constructor(e){super(e,"FormatError")}},Oh=class extends sf{constructor(e){super(e,"AbortException")}};function UI(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&gi("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<e;s+=t){const r=Math.min(s+t,e),a=n.subarray(s,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function nx(n){typeof n!="string"&&gi("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function aF(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function oF(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function lF(){try{return new Function(""),!0}catch{return!1}}class ur{static get isLittleEndian(){return Hn(this,"isLittleEndian",oF())}static get isEvalSupported(){return Hn(this,"isEvalSupported",lF())}static get isOffscreenCanvasSupported(){return Hn(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Hn(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Hn(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Hn(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const rw=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var u0,Yw,p9,n8;let en=(Yw=class{static makeHexColor(e,t,i){return`#${rw[e]}${rw[t]}${rw[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,i=0){const s=e[i],r=e[i+1];e[i]=s*t[0]+r*t[2]+t[4],e[i+1]=s*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,i=0){const s=t[0],r=t[1],a=t[2],o=t[3],l=t[4],c=t[5];for(let h=0;h<6;h+=2){const u=e[i+h],d=e[i+h+1];e[i+h]=u*s+d*a+l,e[i+h+1]=u*r+d*o+c}}static applyInverseTransform(e,t){const i=e[0],s=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(i*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-i*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,i){const s=t[0],r=t[1],a=t[2],o=t[3],l=t[4],c=t[5],h=e[0],u=e[1],d=e[2],f=e[3];let g=s*h+l,m=g,x=s*d+l,p=x,y=o*u+c,w=y,v=o*f+c,_=v;if(r!==0||a!==0){const C=r*h,k=r*d,I=a*u,S=a*f;g+=I,p+=I,x+=S,m+=S,y+=C,_+=C,v+=k,w+=k}i[0]=Math.min(i[0],g,x,m,p),i[1]=Math.min(i[1],y,v,w,_),i[2]=Math.max(i[2],g,x,m,p),i[3]=Math.max(i[3],y,v,w,_)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const i=e[0],s=e[1],r=e[2],a=e[3],o=i**2+s**2,l=i*r+s*a,c=r**2+a**2,h=(o+c)/2,u=Math.sqrt(h**2-(o*c-l**2));t[0]=Math.sqrt(h+u||1),t[1]=Math.sqrt(h-u||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>s)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[i,r,s,a]}static pointBoundingBox(e,t,i){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}static rectBoundingBox(e,t,i,s,r){r[0]=Math.min(r[0],e,i),r[1]=Math.min(r[1],t,s),r[2]=Math.max(r[2],e,i),r[3]=Math.max(r[3],t,s)}static bezierBoundingBox(e,t,i,s,r,a,o,l,c){c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l),L(this,u0,n8).call(this,e,i,r,o,t,s,a,l,3*(-e+3*(i-r)+o),6*(e-2*i+r),3*(i-e),c),L(this,u0,n8).call(this,e,i,r,o,t,s,a,l,3*(-t+3*(s-a)+l),6*(t-2*s+a),3*(s-t),c)}},u0=new WeakSet,p9=function(e,t,i,s,r,a,o,l,c,h){if(c<=0||c>=1)return;const u=1-c,d=c*c,f=d*c,g=u*(u*(u*e+3*c*t)+3*d*i)+f*s,m=u*(u*(u*r+3*c*a)+3*d*o)+f*l;h[0]=Math.min(h[0],g),h[1]=Math.min(h[1],m),h[2]=Math.max(h[2],g),h[3]=Math.max(h[3],m)},n8=function(e,t,i,s,r,a,o,l,c,h,u,d){if(Math.abs(c)<1e-12){Math.abs(h)>=1e-12&&L(this,u0,p9).call(this,e,t,i,s,r,a,o,l,-u/h,d);return}const f=h**2-4*u*c;if(f<0)return;const g=Math.sqrt(f),m=2*c;L(this,u0,p9).call(this,e,t,i,s,r,a,o,l,(-h+g)/m,d),L(this,u0,p9).call(this,e,t,i,s,r,a,o,l,(-h-g)/m,d)},B(Yw,u0),Yw);function cF(n){return decodeURIComponent(escape(n))}let aw=null,m_=null;function hF(n){return aw||(aw=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,m_=new Map([["ﬅ","ſt"]])),n.replaceAll(aw,(e,t,i)=>t?t.normalize("NFKC"):m_.get(i))}function HI(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),UI(n)}const n4="pdfjs_internal_id_";function uF(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[i,s,...r]=t;if(!n(i)&&!Number.isInteger(i)||!e(s))return!1;const a=r.length;let o=!0;switch(s.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of r)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function Ur(n,e,t){return Math.min(Math.max(n,e),t)}function zI(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(UI(n))}function dF(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):nx(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});const hc="http://www.w3.org/2000/svg",fu=class fu{};ze(fu,"CSS",96),ze(fu,"PDF",72),ze(fu,"PDF_TO_CSS_UNITS",fu.CSS/fu.PDF);let Dh=fu;async function ix(n,e="text"){if(Bm(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class sx{constructor({viewBox:e,userUnit:t,scale:i,rotation:s,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=s,this.offsetX=r,this.offsetY=a,i*=t;const l=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let h,u,d,f;switch(s%=360,s<0&&(s+=360),s){case 180:h=-1,u=0,d=0,f=1;break;case 90:h=0,u=1,d=1,f=0;break;case 270:h=0,u=-1,d=-1,f=0;break;case 0:h=1,u=0,d=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(d=-d,f=-f);let g,m,x,p;h===0?(g=Math.abs(c-e[1])*i+r,m=Math.abs(l-e[0])*i+a,x=(e[3]-e[1])*i,p=(e[2]-e[0])*i):(g=Math.abs(l-e[0])*i+r,m=Math.abs(c-e[1])*i+a,x=(e[2]-e[0])*i,p=(e[3]-e[1])*i),this.transform=[h*i,u*i,d*i,f*i,g-h*i*l-d*i*c,m-u*i*l-f*i*c],this.width=x,this.height=p}get rawDims(){const e=this.viewBox;return Hn(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:r=!1}={}){return new sx({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}convertToViewportPoint(e,t){const i=[e,t];return en.applyTransform(i,this.transform),i}convertToViewportRectangle(e){const t=[e[0],e[1]];en.applyTransform(t,this.transform);const i=[e[2],e[3]];return en.applyTransform(i,this.transform),[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){const i=[e,t];return en.applyInverseTransform(i,this.transform),i}}class i4 extends sf{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function X5(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function s4(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function fF(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function gF(n,e="document.pdf"){if(typeof n!="string")return e;if(X5(n))return wn('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const i=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(n);if(!i)return e;const s=o=>{try{let l=decodeURIComponent(o);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:o):l}catch{return o}},r=/\.pdf$/i,a=i.pathname.split("/").at(-1);if(r.test(a))return s(a);if(i.searchParams.size>0){const o=Array.from(i.searchParams.values()).reverse();for(const c of o)if(r.test(c))return s(c);const l=Array.from(i.searchParams.keys()).reverse();for(const c of l)if(r.test(c))return s(c)}if(i.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(l)return s(l[0])}return e}class p_{constructor(){ze(this,"started",Object.create(null));ze(this,"times",[])}time(e){e in this.started&&wn(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||wn(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:s,end:r}of this.times)e.push(`${i.padEnd(t)} ${r-s}ms
`);return e.join("")}}function Bm(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function nl(n){n.preventDefault()}function fs(n){n.preventDefault(),n.stopPropagation()}function mF(n){""+n}var o2;class r4{static toDateObject(e){if(!e||typeof e!="string")return null;b(this,o2)||N(this,o2,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=b(this,o2).exec(e);if(!t)return null;const i=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let u=parseInt(t[9],10)||0;return u=u>=0&&u<=59?u:0,c==="-"?(a+=h,o+=u):c==="+"&&(a-=h,o-=u),new Date(Date.UTC(i,s,r,a,o,l))}}o2=new WeakMap,B(r4,o2);function pF(n,{scale:e=1,rotation:t=0}){const{width:i,height:s}=n.attributes.style,r=[0,0,parseInt(i),parseInt(s)];return new sx({viewBox:r,userUnit:1,scale:e,rotation:t})}function a4(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(wn(`Not a valid color format: "${n}"`),[0,0,0])}function bF(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,a4(i))}e.remove()}function Vi(n){const{a:e,b:t,c:i,d:s,e:r,f:a}=n.getTransform();return[e,t,i,s,r,a]}function gl(n){const{a:e,b:t,c:i,d:s,e:r,f:a}=n.getTransform().invertSelf();return[e,t,i,s,r,a]}function jd(n,e,t=!1,i=!0){if(e instanceof sx){const{pageWidth:s,pageHeight:r}=e.rawDims,{style:a}=n,o=ur.isCSSRoundSupported,l=`var(--total-scale-factor) * ${s}px`,c=`var(--total-scale-factor) * ${r}px`,h=o?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,u=o?`round(down, ${c}, var(--scale-round-y))`:`calc(${c})`;!t||e.rotation%180===0?(a.width=h,a.height=u):(a.width=u,a.height=h)}i&&n.setAttribute("data-main-rotation",e.rotation)}class nc{constructor(){const{pixelRatio:e}=nc;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,i,s,r=-1){let a=1/0,o=1/0,l=1/0;i=nc.capPixels(i,r),i>0&&(a=Math.sqrt(i/(e*t))),s!==-1&&(o=s/e,l=s/t);const c=Math.min(a,o,l);return this.sx>c||this.sy>c?(this.sx=c,this.sy=c,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,i):i}return e}}const i8=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var P0,wu,Qa,N0,l2,a1,c2,c5,jI,Vr,GI,VI,Um,b9;const mc=class mc{constructor(e){B(this,Vr);B(this,P0,null);B(this,wu,null);B(this,Qa);B(this,N0,null);B(this,l2,null);B(this,a1,null);N(this,Qa,e),b(mc,c2)||N(mc,c2,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=N(this,P0,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=b(this,Qa)._uiManager._signal;e.addEventListener("contextmenu",nl,{signal:t}),e.addEventListener("pointerdown",L(mc,c5,jI),{signal:t});const i=N(this,N0,document.createElement("div"));i.className="buttons",e.append(i);const s=b(this,Qa).toolbarPosition;if(s){const{style:r}=e,a=b(this,Qa)._uiManager.direction==="ltr"?1-s[0]:s[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return b(this,P0)}hide(){var e;b(this,P0).classList.add("hidden"),(e=b(this,wu))==null||e.hideDropdown()}show(){var e;b(this,P0).classList.remove("hidden"),(e=b(this,l2))==null||e.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=b(this,Qa),i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",b(mc,c2)[e]),L(this,Vr,Um).call(this,i),i.addEventListener("click",s=>{t.delete()},{signal:t._signal}),b(this,N0).append(i)}async addAltText(e){const t=await e.render();L(this,Vr,Um).call(this,t),b(this,N0).append(t,b(this,Vr,b9)),N(this,l2,e)}addColorPicker(e){N(this,wu,e);const t=e.renderButton();L(this,Vr,Um).call(this,t),b(this,N0).append(t,b(this,Vr,b9))}async addEditSignatureButton(e){const t=N(this,a1,await e.renderEditButton(b(this,Qa)));L(this,Vr,Um).call(this,t),b(this,N0).append(t,b(this,Vr,b9))}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break}}updateEditSignatureButton(e){b(this,a1)&&(b(this,a1).title=e)}remove(){var e;b(this,P0).remove(),(e=b(this,wu))==null||e.destroy(),N(this,wu,null)}};P0=new WeakMap,wu=new WeakMap,Qa=new WeakMap,N0=new WeakMap,l2=new WeakMap,a1=new WeakMap,c2=new WeakMap,c5=new WeakSet,jI=function(e){e.stopPropagation()},Vr=new WeakSet,GI=function(e){b(this,Qa)._focusEventsAllowed=!1,fs(e)},VI=function(e){b(this,Qa)._focusEventsAllowed=!0,fs(e)},Um=function(e){const t=b(this,Qa)._uiManager._signal;e.addEventListener("focusin",L(this,Vr,GI).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",L(this,Vr,VI).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",nl,{signal:t})},b9=function(){const e=document.createElement("div");return e.className="divider",e},B(mc,c5),B(mc,c2,null);let s8=mc;var h2,vu,_u,Hh,qI,WI,KI;class xF{constructor(e){B(this,Hh);B(this,h2,null);B(this,vu,null);B(this,_u);N(this,_u,e)}show(e,t,i){const[s,r]=L(this,Hh,WI).call(this,t,i),{style:a}=b(this,vu)||N(this,vu,L(this,Hh,qI).call(this));e.append(b(this,vu)),a.insetInlineEnd=`${100*s}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){b(this,vu).remove()}}h2=new WeakMap,vu=new WeakMap,_u=new WeakMap,Hh=new WeakSet,qI=function(){const e=N(this,vu,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",nl,{signal:b(this,_u)._signal});const t=N(this,h2,document.createElement("div"));return t.className="buttons",e.append(t),L(this,Hh,KI).call(this),e},WI=function(e,t){let i=0,s=0;for(const r of e){const a=r.y+r.height;if(a<i)continue;const o=r.x+(t?r.width:0);if(a>i){s=o,i=a;continue}t?o>s&&(s=o):o<s&&(s=o)}return[t?1-s:s,i]},KI=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=b(this,_u)._signal;e.addEventListener("contextmenu",nl,{signal:i}),e.addEventListener("click",()=>{b(this,_u).highlightSelection("floating_button")},{signal:i}),b(this,h2).append(e)};function XI(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}var h5;class yF{constructor(){B(this,h5,0)}get id(){return`${LI}${Rr(this,h5)._++}`}}h5=new WeakMap;var o1,u2,xr,l1,x9;const Uv=class Uv{constructor(){B(this,l1);B(this,o1,HI());B(this,u2,0);B(this,xr,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const r=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Hn(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:i,size:s,type:r}=e;return L(this,l1,x9).call(this,`${t}_${i}_${s}_${r}`,e)}async getFromUrl(e){return L(this,l1,x9).call(this,e,e)}async getFromBlob(e,t){const i=await t;return L(this,l1,x9).call(this,e,i)}async getFromId(e){b(this,xr)||N(this,xr,new Map);const t=b(this,xr).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){b(this,xr)||N(this,xr,new Map);let i=b(this,xr).get(e);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${b(this,o1)}_${Rr(this,u2)._++}`,refCounter:1,isSvg:!1},b(this,xr).set(e,i),b(this,xr).set(i.id,i),i}getSvgUrl(e){const t=b(this,xr).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var s;b(this,xr)||N(this,xr,new Map);const t=b(this,xr).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=r.convertToBlob()}(s=i.close)==null||s.call(i),t.bitmap=null}isValidId(e){return e.startsWith(`image_${b(this,o1)}_`)}};o1=new WeakMap,u2=new WeakMap,xr=new WeakMap,l1=new WeakSet,x9=async function(e,t){b(this,xr)||N(this,xr,new Map);let i=b(this,xr).get(e);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${b(this,o1)}_${Rr(this,u2)._++}`,refCounter:0,isSvg:!1});let s;if(typeof t=="string"?(i.url=t,s=await ix(t,"blob")):t instanceof File?s=i.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const r=Uv._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,h)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,c()},a.onload=async()=>{const u=i.svgUrl=a.result;o.src=await r?`${u}#svgView(preserveAspectRatio(none))`:u},o.onerror=a.onerror=h});a.readAsDataURL(s),await l}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){wn(s),i=null}return b(this,xr).set(e,i),i&&b(this,xr).set(i.id,i),i};let r8=Uv;var ts,O0,d2,Gi;class wF{constructor(e=128){B(this,ts,[]);B(this,O0,!1);B(this,d2);B(this,Gi,-1);N(this,d2,e)}add({cmd:e,undo:t,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(s&&e(),b(this,O0))return;const l={cmd:e,undo:t,post:i,type:r};if(b(this,Gi)===-1){b(this,ts).length>0&&(b(this,ts).length=0),N(this,Gi,0),b(this,ts).push(l);return}if(a&&b(this,ts)[b(this,Gi)].type===r){o&&(l.undo=b(this,ts)[b(this,Gi)].undo),b(this,ts)[b(this,Gi)]=l;return}const c=b(this,Gi)+1;c===b(this,d2)?b(this,ts).splice(0,1):(N(this,Gi,c),c<b(this,ts).length&&b(this,ts).splice(c)),b(this,ts).push(l)}undo(){if(b(this,Gi)===-1)return;N(this,O0,!0);const{undo:e,post:t}=b(this,ts)[b(this,Gi)];e(),t==null||t(),N(this,O0,!1),N(this,Gi,b(this,Gi)-1)}redo(){if(b(this,Gi)<b(this,ts).length-1){N(this,Gi,b(this,Gi)+1),N(this,O0,!0);const{cmd:e,post:t}=b(this,ts)[b(this,Gi)];e(),t==null||t(),N(this,O0,!1)}}hasSomethingToUndo(){return b(this,Gi)!==-1}hasSomethingToRedo(){return b(this,Gi)<b(this,ts).length-1}cleanType(e){if(b(this,Gi)!==-1){for(let t=b(this,Gi);t>=0;t--)if(b(this,ts)[t].type!==e){b(this,ts).splice(t+1,b(this,Gi)-t),N(this,Gi,t);return}b(this,ts).length=0,N(this,Gi,-1)}}destroy(){N(this,ts,null)}}ts=new WeakMap,O0=new WeakMap,d2=new WeakMap,Gi=new WeakMap;var u5,YI;class rx{constructor(e){B(this,u5);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=ur.platform;for(const[i,s,r={}]of e)for(const a of i){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(L(this,u5,YI).call(this,t));if(!i)return;const{callback:s,options:{bubbles:r=!1,args:a=[],checker:o=null}}=i;o&&!o(e,t)||(s.bind(e,...a,t)(),r||fs(t))}}u5=new WeakSet,YI=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const d5=class d5{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return bF(e),Hn(this,"_colors",e)}convert(e){const t=a4(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,s]of this._colors)if(s.every((r,a)=>r===t[a]))return d5._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?en.makeHexColor(...t):e}};ze(d5,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let a8=d5;var c1,wa,_s,$s,h1,wc,u1,$a,D0,L0,d1,ku,Al,Mo,Cu,f2,g2,f1,m2,Sl,F0,g1,B0,Il,f5,U0,p2,H0,Au,Su,z0,b2,Is,oi,vc,j0,Iu,x2,y2,G0,El,_c,w2,v2,eo,Ct,y9,o8,JI,ZI,w9,QI,$I,eE,l8,tE,c8,h8,nE,Nr,uc,iE,sE,u8,rE,Hm,d8;const zf=class zf{constructor(e,t,i,s,r,a,o,l,c,h,u,d,f,g,m){B(this,Ct);B(this,c1,new AbortController);B(this,wa,null);B(this,_s,new Map);B(this,$s,new Map);B(this,h1,null);B(this,wc,null);B(this,u1,null);B(this,$a,new wF);B(this,D0,null);B(this,L0,null);B(this,d1,0);B(this,ku,new Set);B(this,Al,null);B(this,Mo,null);B(this,Cu,new Set);ze(this,"_editorUndoBar",null);B(this,f2,!1);B(this,g2,!1);B(this,f1,!1);B(this,m2,null);B(this,Sl,null);B(this,F0,null);B(this,g1,null);B(this,B0,!1);B(this,Il,null);B(this,f5,new yF);B(this,U0,!1);B(this,p2,!1);B(this,H0,null);B(this,Au,null);B(this,Su,null);B(this,z0,null);B(this,b2,null);B(this,Is,yn.NONE);B(this,oi,new Set);B(this,vc,null);B(this,j0,null);B(this,Iu,null);B(this,x2,null);B(this,y2,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});B(this,G0,[0,0]);B(this,El,null);B(this,_c,null);B(this,w2,null);B(this,v2,null);B(this,eo,null);const x=this._signal=b(this,c1).signal;N(this,_c,e),N(this,w2,t),N(this,v2,i),N(this,h1,s),N(this,j0,r),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:x}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:x}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:x}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:x}),a._on("setpreference",this.onSetPreference.bind(this),{signal:x}),a._on("switchannotationeditorparams",p=>this.updateParams(p.type,p.value),{signal:x}),L(this,Ct,QI).call(this),L(this,Ct,nE).call(this),L(this,Ct,l8).call(this),N(this,wc,o.annotationStorage),N(this,m2,o.filterFactory),N(this,Iu,l),N(this,g1,c||null),N(this,f2,h),N(this,g2,u),N(this,f1,d),N(this,b2,f||null),this.viewParameters={realScale:Dh.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=g||null,this._supportsPinchToZoom=m!==!1}static get _keyboardManager(){const e=zf.prototype,t=a=>b(a,_c).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return Hn(this,"_keyboardManager",new rx([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&b(a,_c).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&b(a,_c).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,i,s,r,a,o,l;(e=b(this,eo))==null||e.resolve(),N(this,eo,null),(t=b(this,c1))==null||t.abort(),N(this,c1,null),this._signal=null;for(const c of b(this,$s).values())c.destroy();b(this,$s).clear(),b(this,_s).clear(),b(this,Cu).clear(),(i=b(this,z0))==null||i.clear(),N(this,wa,null),b(this,oi).clear(),b(this,$a).destroy(),(s=b(this,h1))==null||s.destroy(),(r=b(this,j0))==null||r.destroy(),(a=b(this,Il))==null||a.hide(),N(this,Il,null),(o=b(this,Su))==null||o.destroy(),N(this,Su,null),b(this,Sl)&&(clearTimeout(b(this,Sl)),N(this,Sl,null)),b(this,El)&&(clearTimeout(b(this,El)),N(this,El,null)),(l=this._editorUndoBar)==null||l.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return b(this,b2)}get useNewAltTextFlow(){return b(this,g2)}get useNewAltTextWhenAddingImage(){return b(this,f1)}get hcmFilter(){return Hn(this,"hcmFilter",b(this,Iu)?b(this,m2).addHCMFilter(b(this,Iu).foreground,b(this,Iu).background):"none")}get direction(){return Hn(this,"direction",getComputedStyle(b(this,_c)).direction)}get highlightColors(){return Hn(this,"highlightColors",b(this,g1)?new Map(b(this,g1).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColorNames(){return Hn(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),N(this,L0,e)}setMainHighlightColorPicker(e){N(this,Su,e)}editAltText(e,t=!1){var i;(i=b(this,h1))==null||i.editAltText(this,e,t)}getSignature(e){var t;(t=b(this,j0))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return b(this,j0)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":N(this,f1,t);break}}onPageChanging({pageNumber:e}){N(this,d1,e-1)}focusMainContainer(){b(this,_c).focus()}findParent(e,t){for(const i of b(this,$s).values()){const{x:s,y:r,width:a,height:o}=i.div.getBoundingClientRect();if(e>=s&&e<=s+a&&t>=r&&t<=r+o)return i}return null}disableUserSelect(e=!1){b(this,w2).classList.toggle("noUserSelect",e)}addShouldRescale(e){b(this,Cu).add(e)}removeShouldRescale(e){b(this,Cu).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Dh.PDF_TO_CSS_UNITS;for(const i of b(this,Cu))i.onScaleChanging();(t=b(this,L0))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:a}=t,o=t.toString(),c=L(this,Ct,y9).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(c);if(!h)return;t.empty();const u=L(this,Ct,o8).call(this,c),d=b(this,Is)===yn.NONE,f=()=>{u==null||u.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:a,text:o}),d&&this.showAllEditors("highlight",!0,!0)};if(d){this.switchToMode(yn.HIGHLIGHT,f);return}f()}addToAnnotationStorage(e){!e.isEmpty()&&b(this,wc)&&!b(this,wc).has(e.id)&&b(this,wc).setValue(e.id,e)}a11yAlert(e,t=null){const i=b(this,v2);i&&(i.setAttribute("data-l10n-id",e),t?i.setAttribute("data-l10n-args",JSON.stringify(t)):i.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,b(this,B0)&&(N(this,B0,!1),L(this,Ct,w9).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of b(this,oi))if(t.div.contains(e)){N(this,Au,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!b(this,Au))return;const[e,t]=b(this,Au);N(this,Au,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){L(this,Ct,l8).call(this),L(this,Ct,c8).call(this)}removeEditListeners(){L(this,Ct,tE).call(this),L(this,Ct,h8).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of b(this,Mo))if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of b(this,Mo))if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var i;if(e.preventDefault(),(i=b(this,wa))==null||i.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of b(this,oi)){const r=s.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of b(this,Mo))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){wn(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const r=[];for(const l of i){const c=await s.deserialize(l);if(!c)return;r.push(c)}const a=()=>{for(const l of r)L(this,Ct,u8).call(this,l);L(this,Ct,d8).call(this,r)},o=()=>{for(const l of r)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){wn(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),b(this,Is)!==yn.NONE&&!this.isEditorHandlingKeyboard&&zf._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,b(this,B0)&&(N(this,B0,!1),L(this,Ct,w9).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(L(this,Ct,$I).call(this),L(this,Ct,c8).call(this),L(this,Ct,Nr).call(this,{isEditing:b(this,Is)!==yn.NONE,isEmpty:L(this,Ct,Hm).call(this),hasSomethingToUndo:b(this,$a).hasSomethingToUndo(),hasSomethingToRedo:b(this,$a).hasSomethingToRedo(),hasSelectedEditor:!1})):(L(this,Ct,eE).call(this),L(this,Ct,h8).call(this),L(this,Ct,Nr).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!b(this,Mo)){N(this,Mo,e);for(const t of b(this,Mo))L(this,Ct,uc).call(this,t.defaultPropertiesToUpdate)}}getId(){return b(this,f5).id}get currentLayer(){return b(this,$s).get(b(this,d1))}getLayer(e){return b(this,$s).get(e)}get currentPageIndex(){return b(this,d1)}addLayer(e){b(this,$s).set(e.pageIndex,e),b(this,U0)?e.enable():e.disable()}removeLayer(e){b(this,$s).delete(e.pageIndex)}async updateMode(e,t=null,i=!1,s=!1){var r,a,o;if(b(this,Is)!==e&&!(b(this,eo)&&(await b(this,eo).promise,!b(this,eo)))){if(N(this,eo,Promise.withResolvers()),(r=b(this,L0))==null||r.commitOrRemove(),N(this,Is,e),e===yn.NONE){this.setEditingState(!1),L(this,Ct,sE).call(this),(a=this._editorUndoBar)==null||a.hide(),b(this,eo).resolve();return}e===yn.SIGNATURE&&await((o=b(this,j0))==null?void 0:o.loadSignatures()),this.setEditingState(!0),await L(this,Ct,iE).call(this),this.unselectAll();for(const l of b(this,$s).values())l.updateMode(e);if(!t){i&&this.addNewEditorFromKeyboard(),b(this,eo).resolve();return}for(const l of b(this,_s).values())l.annotationElementId===t||l.id===t?(this.setSelected(l),s&&l.enterInEditMode()):l.unselect();b(this,eo).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==b(this,Is)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){var i;if(b(this,Mo)){switch(e){case Vn.CREATE:this.currentLayer.addNewEditor(t);return;case Vn.HIGHLIGHT_DEFAULT_COLOR:(i=b(this,Su))==null||i.updateColor(t);break;case Vn.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(b(this,x2)||N(this,x2,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const s of b(this,oi))s.updateParams(e,t);for(const s of b(this,Mo))s.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){var r;for(const a of b(this,_s).values())a.editorType===e&&a.show(t);(((r=b(this,x2))==null?void 0:r.get(Vn.HIGHLIGHT_SHOW_ALL))??!0)!==t&&L(this,Ct,uc).call(this,[[Vn.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(b(this,p2)!==e){N(this,p2,e);for(const t of b(this,$s).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const i of b(this,_s).values())i.pageIndex===e&&t.push(i);return t}getEditor(e){return b(this,_s).get(e)}addEditor(e){b(this,_s).set(e.id,e)}removeEditor(e){var t,i;e.div.contains(document.activeElement)&&(b(this,Sl)&&clearTimeout(b(this,Sl)),N(this,Sl,setTimeout(()=>{this.focusMainContainer(),N(this,Sl,null)},0))),b(this,_s).delete(e.id),e.annotationElementId&&((t=b(this,z0))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!b(this,ku).has(e.annotationElementId))&&((i=b(this,wc))==null||i.remove(e.id))}addDeletedAnnotationElement(e){b(this,ku).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return b(this,ku).has(e)}removeDeletedAnnotationElement(e){b(this,ku).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){b(this,wa)!==e&&(N(this,wa,e),e&&L(this,Ct,uc).call(this,e.propertiesToUpdate))}updateUI(e){b(this,Ct,rE)===e&&L(this,Ct,uc).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){L(this,Ct,uc).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(b(this,oi).has(e)){b(this,oi).delete(e),e.unselect(),L(this,Ct,Nr).call(this,{hasSelectedEditor:this.hasSelection});return}b(this,oi).add(e),e.select(),L(this,Ct,uc).call(this,e.propertiesToUpdate),L(this,Ct,Nr).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=b(this,L0))==null||t.commitOrRemove();for(const i of b(this,oi))i!==e&&i.unselect();b(this,oi).clear(),b(this,oi).add(e),e.select(),L(this,Ct,uc).call(this,e.propertiesToUpdate),L(this,Ct,Nr).call(this,{hasSelectedEditor:!0})}isSelected(e){return b(this,oi).has(e)}get firstSelectedEditor(){return b(this,oi).values().next().value}unselect(e){e.unselect(),b(this,oi).delete(e),L(this,Ct,Nr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return b(this,oi).size!==0}get isEnterHandled(){return b(this,oi).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;b(this,$a).undo(),L(this,Ct,Nr).call(this,{hasSomethingToUndo:b(this,$a).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:L(this,Ct,Hm).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){b(this,$a).redo(),L(this,Ct,Nr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:b(this,$a).hasSomethingToRedo(),isEmpty:L(this,Ct,Hm).call(this)})}addCommands(e){b(this,$a).add(e),L(this,Ct,Nr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:L(this,Ct,Hm).call(this)})}cleanUndoStack(e){b(this,$a).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...b(this,oi)],i=()=>{var a;(a=this._editorUndoBar)==null||a.show(s,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},s=()=>{for(const a of t)L(this,Ct,u8).call(this,a)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=b(this,wa))==null||e.commitOrRemove()}hasSomethingToControl(){return b(this,wa)||this.hasSelection}selectAll(){for(const e of b(this,oi))e.commit();L(this,Ct,d8).call(this,b(this,_s).values())}unselectAll(){var e;if(!(b(this,wa)&&(b(this,wa).commitOrRemove(),b(this,Is)!==yn.NONE))&&!((e=b(this,L0))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of b(this,oi))t.unselect();b(this,oi).clear(),L(this,Ct,Nr).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;b(this,G0)[0]+=e,b(this,G0)[1]+=t;const[s,r]=b(this,G0),a=[...b(this,oi)],o=1e3;b(this,El)&&clearTimeout(b(this,El)),N(this,El,setTimeout(()=>{N(this,El,null),b(this,G0)[0]=b(this,G0)[1]=0,this.addCommands({cmd:()=>{for(const l of a)b(this,_s).has(l.id)&&(l.translateInPage(s,r),l.translationDone())},undo:()=>{for(const l of a)b(this,_s).has(l.id)&&(l.translateInPage(-s,-r),l.translationDone())},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),N(this,Al,new Map);for(const e of b(this,oi))b(this,Al).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!b(this,Al))return!1;this.disableUserSelect(!1);const e=b(this,Al);N(this,Al,null);let t=!1;for(const[{x:s,y:r,pageIndex:a},o]of e)o.newX=s,o.newY=r,o.newPageIndex=a,t||(t=s!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const i=(s,r,a,o)=>{if(b(this,_s).has(s.id)){const l=b(this,$s).get(o);l?s._setParentAndPosition(l,r,a):(s.pageIndex=o,s.x=r,s.y=a)}};return this.addCommands({cmd:()=>{for(const[s,{newX:r,newY:a,newPageIndex:o}]of e)i(s,r,a,o)},undo:()=>{for(const[s,{savedX:r,savedY:a,savedPageIndex:o}]of e)i(s,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(b(this,Al))for(const i of b(this,Al).keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||b(this,oi).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return b(this,wa)===e}getActive(){return b(this,wa)}getMode(){return b(this,Is)}get imageManager(){return Hn(this,"imageManager",new r8)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,h=t.rangeCount;c<h;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:i,y:s,width:r,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(c,h,u,d)=>({x:(h-s)/a,y:1-(c+u-i)/r,width:d/a,height:u/r});break;case"180":o=(c,h,u,d)=>({x:1-(c+u-i)/r,y:1-(h+d-s)/a,width:u/r,height:d/a});break;case"270":o=(c,h,u,d)=>({x:1-(h+d-s)/a,y:(c-i)/r,width:d/a,height:u/r});break;default:o=(c,h,u,d)=>({x:(c-i)/r,y:(h-s)/a,width:u/r,height:d/a});break}const l=[];for(let c=0,h=t.rangeCount;c<h;c++){const u=t.getRangeAt(c);if(!u.collapsed)for(const{x:d,y:f,width:g,height:m}of u.getClientRects())g===0||m===0||l.push(o(d,f,g,m))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(b(this,u1)||N(this,u1,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=b(this,u1))==null||t.delete(e)}renderAnnotationElement(e){var s;const t=(s=b(this,u1))==null?void 0:s.get(e.data.id);if(!t)return;const i=b(this,wc).getRawValue(t);i&&(b(this,Is)===yn.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}setMissingCanvas(e,t,i){var r;const s=(r=b(this,z0))==null?void 0:r.get(e);s&&(s.setCanvas(t,i),b(this,z0).delete(e))}addMissingCanvas(e,t){(b(this,z0)||N(this,z0,new Map)).set(e,t)}};c1=new WeakMap,wa=new WeakMap,_s=new WeakMap,$s=new WeakMap,h1=new WeakMap,wc=new WeakMap,u1=new WeakMap,$a=new WeakMap,D0=new WeakMap,L0=new WeakMap,d1=new WeakMap,ku=new WeakMap,Al=new WeakMap,Mo=new WeakMap,Cu=new WeakMap,f2=new WeakMap,g2=new WeakMap,f1=new WeakMap,m2=new WeakMap,Sl=new WeakMap,F0=new WeakMap,g1=new WeakMap,B0=new WeakMap,Il=new WeakMap,f5=new WeakMap,U0=new WeakMap,p2=new WeakMap,H0=new WeakMap,Au=new WeakMap,Su=new WeakMap,z0=new WeakMap,b2=new WeakMap,Is=new WeakMap,oi=new WeakMap,vc=new WeakMap,j0=new WeakMap,Iu=new WeakMap,x2=new WeakMap,y2=new WeakMap,G0=new WeakMap,El=new WeakMap,_c=new WeakMap,w2=new WeakMap,v2=new WeakMap,eo=new WeakMap,Ct=new WeakSet,y9=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},o8=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of b(this,$s).values())if(i.hasTextLayer(e))return i;return null},JI=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=L(this,Ct,y9).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(b(this,Il)||N(this,Il,new xF(this)),b(this,Il).show(i,s,this.direction==="ltr"))},ZI=function(){var r,a,o;const e=document.getSelection();if(!e||e.isCollapsed){b(this,vc)&&((r=b(this,Il))==null||r.hide(),N(this,vc,null),L(this,Ct,Nr).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===b(this,vc))return;const s=L(this,Ct,y9).call(this,e).closest(".textLayer");if(!s){b(this,vc)&&((a=b(this,Il))==null||a.hide(),N(this,vc,null),L(this,Ct,Nr).call(this,{hasSelectedText:!1}));return}if((o=b(this,Il))==null||o.hide(),N(this,vc,t),L(this,Ct,Nr).call(this,{hasSelectedText:!0}),!(b(this,Is)!==yn.HIGHLIGHT&&b(this,Is)!==yn.NONE)&&(b(this,Is)===yn.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),N(this,B0,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=b(this,Is)===yn.HIGHLIGHT?L(this,Ct,o8).call(this,s):null;l==null||l.toggleDrawing();const c=new AbortController,h=this.combinedSignal(c),u=d=>{d.type==="pointerup"&&d.button!==0||(c.abort(),l==null||l.toggleDrawing(!0),d.type==="pointerup"&&L(this,Ct,w9).call(this,"main_toolbar"))};window.addEventListener("pointerup",u,{signal:h}),window.addEventListener("blur",u,{signal:h})}},w9=function(e=""){b(this,Is)===yn.HIGHLIGHT?this.highlightSelection(e):b(this,f2)&&L(this,Ct,JI).call(this)},QI=function(){document.addEventListener("selectionchange",L(this,Ct,ZI).bind(this),{signal:this._signal})},$I=function(){if(b(this,F0))return;N(this,F0,new AbortController);const e=this.combinedSignal(b(this,F0));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},eE=function(){var e;(e=b(this,F0))==null||e.abort(),N(this,F0,null)},l8=function(){if(b(this,H0))return;N(this,H0,new AbortController);const e=this.combinedSignal(b(this,H0));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},tE=function(){var e;(e=b(this,H0))==null||e.abort(),N(this,H0,null)},c8=function(){if(b(this,D0))return;N(this,D0,new AbortController);const e=this.combinedSignal(b(this,D0));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},h8=function(){var e;(e=b(this,D0))==null||e.abort(),N(this,D0,null)},nE=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Nr=function(e){Object.entries(e).some(([i,s])=>b(this,y2)[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(b(this,y2),e)}),b(this,Is)===yn.HIGHLIGHT&&e.hasSelectedEditor===!1&&L(this,Ct,uc).call(this,[[Vn.HIGHLIGHT_FREE,!0]]))},uc=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},iE=async function(){if(!b(this,U0)){N(this,U0,!0);const e=[];for(const t of b(this,$s).values())e.push(t.enable());await Promise.all(e);for(const t of b(this,_s).values())t.enable()}},sE=function(){if(this.unselectAll(),b(this,U0)){N(this,U0,!1);for(const e of b(this,$s).values())e.disable();for(const e of b(this,_s).values())e.disable()}},u8=function(e){const t=b(this,$s).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},rE=function(){let e=null;for(e of b(this,oi));return e},Hm=function(){if(b(this,_s).size===0)return!0;if(b(this,_s).size===1)for(const e of b(this,_s).values())return e.isEmpty();return!1},d8=function(e){for(const t of b(this,oi))t.unselect();b(this,oi).clear();for(const t of e)t.isEmpty()||(b(this,oi).add(t),t.select());L(this,Ct,Nr).call(this,{hasSelectedEditor:this.hasSelection})},ze(zf,"TRANSLATE_SMALL",1),ze(zf,"TRANSLATE_BIG",10);let Gd=zf;var Es,Tl,Po,m1,Rl,va,p1,Ml,na,kc,Eu,Pl,V0,Qo,zm,v9;const Or=class Or{constructor(e){B(this,Qo);B(this,Es,null);B(this,Tl,!1);B(this,Po,null);B(this,m1,null);B(this,Rl,null);B(this,va,null);B(this,p1,!1);B(this,Ml,null);B(this,na,null);B(this,kc,null);B(this,Eu,null);B(this,Pl,!1);N(this,na,e),N(this,Pl,e._uiManager.useNewAltTextFlow),b(Or,V0)||N(Or,V0,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Or._l10n??(Or._l10n=e)}async render(){const e=N(this,Po,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=N(this,m1,document.createElement("span"));e.append(t),b(this,Pl)?(e.classList.add("new"),e.setAttribute("data-l10n-id",b(Or,V0).missing),t.setAttribute("data-l10n-id",b(Or,V0)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=b(this,na)._uiManager._signal;e.addEventListener("contextmenu",nl,{signal:i}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),b(this,na)._uiManager.editAltText(b(this,na)),b(this,Pl)&&b(this,na)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:b(this,Qo,zm)}})};return e.addEventListener("click",s,{capture:!0,signal:i}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(N(this,p1,!0),s(r))},{signal:i}),await L(this,Qo,v9).call(this),e}finish(){b(this,Po)&&(b(this,Po).focus({focusVisible:b(this,p1)}),N(this,p1,!1))}isEmpty(){return b(this,Pl)?b(this,Es)===null:!b(this,Es)&&!b(this,Tl)}hasData(){return b(this,Pl)?b(this,Es)!==null||!!b(this,kc):this.isEmpty()}get guessedText(){return b(this,kc)}async setGuessedText(e){b(this,Es)===null&&(N(this,kc,e),N(this,Eu,await Or._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),L(this,Qo,v9).call(this))}toggleAltTextBadge(e=!1){var t;if(!b(this,Pl)||b(this,Es)){(t=b(this,Ml))==null||t.remove(),N(this,Ml,null);return}if(!b(this,Ml)){const i=N(this,Ml,document.createElement("div"));i.className="noAltTextBadge",b(this,na).div.append(i)}b(this,Ml).classList.toggle("hidden",!e)}serialize(e){let t=b(this,Es);return!e&&b(this,kc)===t&&(t=b(this,Eu)),{altText:t,decorative:b(this,Tl),guessedText:b(this,kc),textWithDisclaimer:b(this,Eu)}}get data(){return{altText:b(this,Es),decorative:b(this,Tl)}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:s,cancel:r=!1}){i&&(N(this,kc,i),N(this,Eu,s)),!(b(this,Es)===e&&b(this,Tl)===t)&&(r||(N(this,Es,e),N(this,Tl,t)),L(this,Qo,v9).call(this))}toggle(e=!1){b(this,Po)&&(!e&&b(this,va)&&(clearTimeout(b(this,va)),N(this,va,null)),b(this,Po).disabled=!e)}shown(){b(this,na)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:b(this,Qo,zm)}})}destroy(){var e,t;(e=b(this,Po))==null||e.remove(),N(this,Po,null),N(this,m1,null),N(this,Rl,null),(t=b(this,Ml))==null||t.remove(),N(this,Ml,null)}};Es=new WeakMap,Tl=new WeakMap,Po=new WeakMap,m1=new WeakMap,Rl=new WeakMap,va=new WeakMap,p1=new WeakMap,Ml=new WeakMap,na=new WeakMap,kc=new WeakMap,Eu=new WeakMap,Pl=new WeakMap,V0=new WeakMap,Qo=new WeakSet,zm=function(){return b(this,Es)&&"added"||b(this,Es)===null&&this.guessedText&&"review"||"missing"},v9=async function(){var s,r,a;const e=b(this,Po);if(!e)return;if(b(this,Pl)){if(e.classList.toggle("done",!!b(this,Es)),e.setAttribute("data-l10n-id",b(Or,V0)[b(this,Qo,zm)]),(s=b(this,m1))==null||s.setAttribute("data-l10n-id",b(Or,V0)[`${b(this,Qo,zm)}-label`]),!b(this,Es)){(r=b(this,Rl))==null||r.remove();return}}else{if(!b(this,Es)&&!b(this,Tl)){e.classList.remove("done"),(a=b(this,Rl))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=b(this,Rl);if(!t){N(this,Rl,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${b(this,na).id}`;const o=100,l=b(this,na)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(b(this,va)),N(this,va,null)},{once:!0}),e.addEventListener("mouseenter",()=>{N(this,va,setTimeout(()=>{N(this,va,null),b(this,Rl).classList.add("show"),b(this,na)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var c;b(this,va)&&(clearTimeout(b(this,va)),N(this,va,null)),(c=b(this,Rl))==null||c.classList.remove("show")},{signal:l})}b(this,Tl)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=b(this,Es)),t.parentNode||e.append(t);const i=b(this,na).getElementForAltText();i==null||i.setAttribute("aria-describedby",t.id)},B(Or,V0,null),ze(Or,"_l10n",null);let m3=Or;var b1,Tu,_2,k2,C2,A2,S2,Cc,Ru,Ac,Mu,Sc,zh,aE,oE,lE;const Hv=class Hv{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:r=null,onPinchEnd:a=null,signal:o}){B(this,zh);B(this,b1);B(this,Tu,!1);B(this,_2,null);B(this,k2);B(this,C2);B(this,A2);B(this,S2);B(this,Cc,null);B(this,Ru);B(this,Ac,null);B(this,Mu);B(this,Sc,null);N(this,b1,e),N(this,_2,i),N(this,k2,t),N(this,C2,s),N(this,A2,r),N(this,S2,a),N(this,Mu,new AbortController),N(this,Ru,AbortSignal.any([o,b(this,Mu).signal])),e.addEventListener("touchstart",L(this,zh,aE).bind(this),{passive:!1,signal:b(this,Ru)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/nc.pixelRatio}destroy(){var e,t;(e=b(this,Mu))==null||e.abort(),N(this,Mu,null),(t=b(this,Cc))==null||t.abort(),N(this,Cc,null)}};b1=new WeakMap,Tu=new WeakMap,_2=new WeakMap,k2=new WeakMap,C2=new WeakMap,A2=new WeakMap,S2=new WeakMap,Cc=new WeakMap,Ru=new WeakMap,Ac=new WeakMap,Mu=new WeakMap,Sc=new WeakMap,zh=new WeakSet,aE=function(e){var s,r,a;if((s=b(this,k2))!=null&&s.call(this))return;if(e.touches.length===1){if(b(this,Cc))return;const o=N(this,Cc,new AbortController),l=AbortSignal.any([b(this,Ru),o.signal]),c=b(this,b1),h={capture:!0,signal:l,passive:!1},u=d=>{var f;d.pointerType==="touch"&&((f=b(this,Cc))==null||f.abort(),N(this,Cc,null))};c.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(fs(d),u(d))},h),c.addEventListener("pointerup",u,h),c.addEventListener("pointercancel",u,h);return}if(!b(this,Sc)){N(this,Sc,new AbortController);const o=AbortSignal.any([b(this,Ru),b(this,Sc).signal]),l=b(this,b1),c={signal:o,capture:!1,passive:!1};l.addEventListener("touchmove",L(this,zh,oE).bind(this),c);const h=L(this,zh,lE).bind(this);l.addEventListener("touchend",h,c),l.addEventListener("touchcancel",h,c),c.capture=!0,l.addEventListener("pointerdown",fs,c),l.addEventListener("pointermove",fs,c),l.addEventListener("pointercancel",fs,c),l.addEventListener("pointerup",fs,c),(r=b(this,C2))==null||r.call(this)}if(fs(e),e.touches.length!==2||(a=b(this,_2))!=null&&a.call(this)){N(this,Ac,null);return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),N(this,Ac,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY})},oE=function(e){var v;if(!b(this,Ac)||e.touches.length!==2)return;fs(e);let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:s,screenY:r}=t,{screenX:a,screenY:o}=i,l=b(this,Ac),{touch0X:c,touch0Y:h,touch1X:u,touch1Y:d}=l,f=u-c,g=d-h,m=a-s,x=o-r,p=Math.hypot(m,x)||1,y=Math.hypot(f,g)||1;if(!b(this,Tu)&&Math.abs(y-p)<=Hv.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=s,l.touch0Y=r,l.touch1X=a,l.touch1Y=o,!b(this,Tu)){N(this,Tu,!0);return}const w=[(s+a)/2,(r+o)/2];(v=b(this,A2))==null||v.call(this,w,y,p)},lE=function(e){var t;e.touches.length>=2||(b(this,Sc)&&(b(this,Sc).abort(),N(this,Sc,null),(t=b(this,S2))==null||t.call(this)),b(this,Ac)&&(fs(e),N(this,Ac,null),N(this,Tu,!1)))};let p3=Hv;var Pu,No,Ri,x1,q0,I2,Nu,er,Ou,Ic,W0,E2,Du,_a,T2,Lu,Ec,Nl,y1,w1,to,Fu,R2,g5,ln,f8,M2,g8,_9,cE,hE,m8,k9,p8,uE,dE,fE,b8,gE,x8,mE,pE,bE,y8,jm;const In=class In{constructor(e){B(this,ln);B(this,Pu,null);B(this,No,null);B(this,Ri,null);B(this,x1,!1);B(this,q0,null);B(this,I2,"");B(this,Nu,!1);B(this,er,null);B(this,Ou,null);B(this,Ic,null);B(this,W0,null);B(this,E2,"");B(this,Du,!1);B(this,_a,null);B(this,T2,!1);B(this,Lu,!1);B(this,Ec,!1);B(this,Nl,null);B(this,y1,0);B(this,w1,0);B(this,to,null);B(this,Fu,null);ze(this,"isSelected",!1);ze(this,"_isCopy",!1);ze(this,"_editToolbar",null);ze(this,"_initialOptions",Object.create(null));ze(this,"_initialData",null);ze(this,"_isVisible",!0);ze(this,"_uiManager",null);ze(this,"_focusEventsAllowed",!0);B(this,R2,!1);B(this,g5,In._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[r,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=In.prototype._resizeWithKeyboard,t=Gd.TRANSLATE_SMALL,i=Gd.TRANSLATE_BIG;return Hn(this,"_resizerKeyboardManager",new rx([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],In.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Hn(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new vF({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(In._l10n??(In._l10n=e),In._l10nResizer||(In._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),In._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);In._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){gi("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return b(this,R2)}set _isDraggable(e){var t;N(this,R2,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=b(this,g5)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):L(this,ln,jm).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(b(this,Du)?N(this,Du,!1):this.parent.setSelected(this))}focusout(e){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,s){const[r,a]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(e+i)/r,this.y=(t+s)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[i,s]=this.parentDimensions;this.setAt(e*i,t*s,this.width*i,this.height*s),this._onTranslated()}translate(e,t){L(this,ln,f8).call(this,this.parentDimensions,e,t)}translateInPage(e,t){b(this,_a)||N(this,_a,[this.x,this.y,this.width,this.height]),L(this,ln,f8).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){b(this,_a)||N(this,_a,[this.x,this.y,this.width,this.height]);const{div:i,parentDimensions:[s,r]}=this;if(this.x+=e/s,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:u,y:d}=this.div.getBoundingClientRect();this.parent.findNewParent(this,u,d)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,c]=this.getBaseTranslation();a+=l,o+=c;const{style:h}=i;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!b(this,_a)&&(b(this,_a)[0]!==this.x||b(this,_a)[1]!==this.y)}get _hasBeenResized(){return!!b(this,_a)&&(b(this,_a)[2]!==this.width||b(this,_a)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=In,s=i/e,r=i/t;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,s]}=this;let{x:r,y:a,width:o,height:l}=this;if(o*=i,l*=s,r*=i,a*=s,this._mustFixPosition)switch(e){case 0:r=Ur(r,0,i-o),a=Ur(a,0,s-l);break;case 90:r=Ur(r,0,i-l),a=Ur(a,o,s);break;case 180:r=Ur(r,o,i),a=Ur(a,l,s);break;case 270:r=Ur(r,l,i),a=Ur(a,0,s-o);break}this.x=r/=i,this.y=a/=s;const[c,h]=this.getBaseTranslation();r+=c,a+=h,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var i;return L(i=In,M2,g8).call(i,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var i;return L(i=In,M2,g8).call(i,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(e,t){const[i,s]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/i).toFixed(2)}%`,b(this,Nu)||(r.height=`${(100*t/s).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:i}=e,s=i.endsWith("%"),r=!b(this,Nu)&&t.endsWith("%");if(s&&r)return;const[a,o]=this.parentDimensions;s||(e.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!b(this,Nu)&&!r&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=b(this,Ri))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||b(this,Lu))return this._editToolbar;this._editToolbar=new s8(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,i]of e)await this._editToolbar.addButton(t,i);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=b(this,Ri))==null||e.destroy())}addContainer(e){var i;const t=(i=this._editToolbar)==null?void 0:i.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return b(this,Ri)||(m3.initialize(In._l10n),N(this,Ri,new m3(this)),b(this,Pu)&&(b(this,Ri).data=b(this,Pu),N(this,Pu,null))),b(this,Ri)}get altTextData(){var e;return(e=b(this,Ri))==null?void 0:e.data}set altTextData(e){b(this,Ri)&&(b(this,Ri).data=e)}get guessedAltText(){var e;return(e=b(this,Ri))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=b(this,Ri))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=b(this,Ri))==null?void 0:t.serialize(e)}hasAltText(){return!!b(this,Ri)&&!b(this,Ri).isEmpty()}hasAltTextData(){var e;return((e=b(this,Ri))==null?void 0:e.hasData())??!1}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=b(this,x1)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),L(this,ln,x8).call(this);const[t,i]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*i/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/i).toFixed(2)}%`);const[s,r]=this.getInitialTranslation();return this.translate(s,r),XI(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(b(this,Fu)||N(this,Fu,new p3({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:L(this,ln,uE).bind(this),onPinching:L(this,ln,dE).bind(this),onPinchEnd:L(this,ln,fE).bind(this),signal:this._uiManager._signal}))),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:t}=ur.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(N(this,Du,!0),this._isDraggable){L(this,ln,gE).call(this,e);return}L(this,ln,b8).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){b(this,Nl)&&clearTimeout(b(this,Nl)),N(this,Nl,setTimeout(()=>{var e;N(this,Nl,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const s=this.parentScale,[r,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=e/s,h=t/s,u=this.x*r,d=this.y*a,f=this.width*r,g=this.height*a;switch(i){case 0:return[u+c+o,a-d-h-g+l,u+c+f+o,a-d-h+l];case 90:return[u+h+o,a-d+c+l,u+h+g+o,a-d+c+f+l];case 180:return[u-c-f+o,a-d+h+l,u-c+o,a-d+h+g+l];case 270:return[u-h-g+o,a-d-c-f+l,u-h+o,a-d-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,s,r,a]=e,o=r-i,l=a-s;switch(this.rotation){case 0:return[i,t-a,o,l];case 90:return[i,t-s,l,o];case 180:return[r,t-s,o,l];case 270:return[r,t-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),N(this,Lu,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),N(this,Lu,!1),!0):!1}isInEditMode(){return b(this,Lu)}shouldGetKeyboardEvents(){return b(this,Ec)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:s}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&s>0&&e<r&&i>0}rebuild(){L(this,ln,x8).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){gi("An editor must be serializable")}static async deserialize(e,t,i){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i,annotationElementId:e.annotationElementId});s.rotation=e.rotation,N(s,Pu,e.accessibilityData),s._isCopy=e.isCopy||!1;const[r,a]=s.pageDimensions,[o,l,c,h]=s.getRectInCurrentCoords(e.rect,a);return s.x=o/r,s.y=l/a,s.width=c/r,s.height=h/a,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=b(this,W0))==null||e.abort(),N(this,W0,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),b(this,Nl)&&(clearTimeout(b(this,Nl)),N(this,Nl,null)),L(this,ln,jm).call(this),this.removeEditToolbar(),b(this,to)){for(const i of b(this,to).values())clearTimeout(i);N(this,to,null)}this.parent=null,(t=b(this,Fu))==null||t.destroy(),N(this,Fu,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(L(this,ln,cE).call(this),b(this,er).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),N(this,Ic,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=b(this,er).children;if(!b(this,No)){N(this,No,Array.from(t));const a=L(this,ln,mE).bind(this),o=L(this,ln,pE).bind(this),l=this._uiManager._signal;for(const c of b(this,No)){const h=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",L(this,ln,bE).bind(this,h),{signal:l}),c.setAttribute("data-l10n-id",In._l10nResizer[h])}}const i=b(this,No)[0];let s=0;for(const a of t){if(a===i)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*(b(this,No).length/4);if(r!==s){if(r<s)for(let o=0;o<s-r;o++)b(this,er).append(b(this,er).firstChild);else if(r>s)for(let o=0;o<r-s;o++)b(this,er).firstChild.before(b(this,er).lastChild);let a=0;for(const o of t){const c=b(this,No)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",In._l10nResizer[c])}}L(this,ln,y8).call(this,0),N(this,Ec,!0),b(this,er).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){b(this,Ec)&&L(this,ln,p8).call(this,b(this,E2),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){L(this,ln,jm).call(this),this.div.focus()}select(){var e,t,i;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,r;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(i=b(this,Ri))==null||i.toggleAltTextBadge(!1)}}unselect(){var e,t,i,s,r;this.isSelected&&(this.isSelected=!1,(e=b(this,er))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(r=b(this,Ri))==null||r.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return b(this,T2)}set isEditing(e){N(this,T2,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){N(this,Nu,!0);const i=e/t,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){b(this,to)||N(this,to,new Map);const{action:i}=e;let s=b(this,to).get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),b(this,to).delete(i),b(this,to).size===0&&N(this,to,null)},In._telemetryTimeout),b(this,to).set(i,s);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),N(this,x1,!1)}disable(){this.div&&(this.div.tabIndex=-1),N(this,x1,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Pu=new WeakMap,No=new WeakMap,Ri=new WeakMap,x1=new WeakMap,q0=new WeakMap,I2=new WeakMap,Nu=new WeakMap,er=new WeakMap,Ou=new WeakMap,Ic=new WeakMap,W0=new WeakMap,E2=new WeakMap,Du=new WeakMap,_a=new WeakMap,T2=new WeakMap,Lu=new WeakMap,Ec=new WeakMap,Nl=new WeakMap,y1=new WeakMap,w1=new WeakMap,to=new WeakMap,Fu=new WeakMap,R2=new WeakMap,g5=new WeakMap,ln=new WeakSet,f8=function([e,t],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},M2=new WeakSet,g8=function(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},_9=function(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}},cE=function(){if(b(this,er))return;N(this,er,document.createElement("div")),b(this,er).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const s=document.createElement("div");b(this,er).append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",L(this,ln,hE).bind(this,i),{signal:t}),s.addEventListener("contextmenu",nl,{signal:t}),s.tabIndex=-1}this.div.prepend(b(this,er))},hE=function(e,t){var h;t.preventDefault();const{isMac:i}=ur.platform;if(t.button!==0||t.ctrlKey&&i)return;(h=b(this,Ri))==null||h.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,N(this,Ou,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",L(this,ln,p8).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",fs,{passive:!1,signal:a}),window.addEventListener("contextmenu",nl,{signal:a}),N(this,Ic,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var u;r.abort(),this.parent.togglePointerEvents(!0),(u=b(this,Ri))==null||u.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=o,this.div.style.cursor=l,L(this,ln,k9).call(this)};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})},m8=function(e,t,i,s){this.width=i,this.height=s,this.x=e,this.y=t;const[r,a]=this.parentDimensions;this.setDims(r*i,a*s),this.fixAndSetPosition(),this._onResized()},k9=function(){if(!b(this,Ic))return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:s}=b(this,Ic);N(this,Ic,null);const r=this.x,a=this.y,o=this.width,l=this.height;r===e&&a===t&&o===i&&l===s||this.addCommands({cmd:L(this,ln,m8).bind(this,r,a,o,l),undo:L(this,ln,m8).bind(this,e,t,i,s),mustExec:!0})},p8=function(e,t){const[i,s]=this.parentDimensions,r=this.x,a=this.y,o=this.width,l=this.height,c=In.MIN_SIZE/i,h=In.MIN_SIZE/s,u=L(this,ln,_9).call(this,this.rotation),d=(M,F)=>[u[0]*M+u[2]*F,u[1]*M+u[3]*F],f=L(this,ln,_9).call(this,360-this.rotation),g=(M,F)=>[f[0]*M+f[2]*F,f[1]*M+f[3]*F];let m,x,p=!1,y=!1;switch(e){case"topLeft":p=!0,m=(M,F)=>[0,0],x=(M,F)=>[M,F];break;case"topMiddle":m=(M,F)=>[M/2,0],x=(M,F)=>[M/2,F];break;case"topRight":p=!0,m=(M,F)=>[M,0],x=(M,F)=>[0,F];break;case"middleRight":y=!0,m=(M,F)=>[M,F/2],x=(M,F)=>[0,F/2];break;case"bottomRight":p=!0,m=(M,F)=>[M,F],x=(M,F)=>[0,0];break;case"bottomMiddle":m=(M,F)=>[M/2,F],x=(M,F)=>[M/2,0];break;case"bottomLeft":p=!0,m=(M,F)=>[0,F],x=(M,F)=>[M,0];break;case"middleLeft":y=!0,m=(M,F)=>[0,F/2],x=(M,F)=>[M,F/2];break}const w=m(o,l),v=x(o,l);let _=d(...v);const C=In._round(r+_[0]),k=In._round(a+_[1]);let I=1,S=1,R,P;if(t.fromKeyboard)({deltaX:R,deltaY:P}=t);else{const{screenX:M,screenY:F}=t,[X,z]=b(this,Ou);[R,P]=this.screenToPageTranslation(M-X,F-z),b(this,Ou)[0]=M,b(this,Ou)[1]=F}if([R,P]=g(R/i,P/s),p){const M=Math.hypot(o,l);I=S=Math.max(Math.min(Math.hypot(v[0]-w[0]-R,v[1]-w[1]-P)/M,1/o,1/l),c/o,h/l)}else y?I=Ur(Math.abs(v[0]-w[0]-R),c,1)/o:S=Ur(Math.abs(v[1]-w[1]-P),h,1)/l;const D=In._round(o*I),U=In._round(l*S);_=d(...x(D,U));const T=C-_[0],G=k-_[1];b(this,_a)||N(this,_a,[this.x,this.y,this.width,this.height]),this.width=D,this.height=U,this.x=T,this.y=G,this.setDims(i*D,s*U),this.fixAndSetPosition(),this._onResizing()},uE=function(){var e;N(this,Ic,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=b(this,Ri))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},dE=function(e,t,i){let r=.7*(i/t)+1-.7;if(r===1)return;const a=L(this,ln,_9).call(this,this.rotation),o=(C,k)=>[a[0]*C+a[2]*k,a[1]*C+a[3]*k],[l,c]=this.parentDimensions,h=this.x,u=this.y,d=this.width,f=this.height,g=In.MIN_SIZE/l,m=In.MIN_SIZE/c;r=Math.max(Math.min(r,1/d,1/f),g/d,m/f);const x=In._round(d*r),p=In._round(f*r);if(x===d&&p===f)return;b(this,_a)||N(this,_a,[h,u,d,f]);const y=o(d/2,f/2),w=In._round(h+y[0]),v=In._round(u+y[1]),_=o(x/2,p/2);this.x=w-_[0],this.y=v-_[1],this.width=x,this.height=p,this.setDims(l*x,c*p),this.fixAndSetPosition(),this._onResizing()},fE=function(){var e;(e=b(this,Ri))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),L(this,ln,k9).call(this)},b8=function(e){const{isMac:t}=ur.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},gE=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const s=new AbortController,r=this._uiManager.combinedSignal(s),a={capture:!0,passive:!1,signal:r},o=c=>{s.abort(),N(this,q0,null),N(this,Du,!1),this._uiManager.endDragSession()||L(this,ln,b8).call(this,c),i&&this._onStopDragging()};t&&(N(this,y1,e.clientX),N(this,w1,e.clientY),N(this,q0,e.pointerId),N(this,I2,e.pointerType),window.addEventListener("pointermove",c=>{i||(i=!0,this._onStartDragging());const{clientX:h,clientY:u,pointerId:d}=c;if(d!==b(this,q0)){fs(c);return}const[f,g]=this.screenToPageTranslation(h-b(this,y1),u-b(this,w1));N(this,y1,h),N(this,w1,u),this._uiManager.dragSelectedEditors(f,g)},a),window.addEventListener("touchmove",fs,a),window.addEventListener("pointerdown",c=>{c.pointerType===b(this,I2)&&(b(this,Fu)||c.isPrimary)&&o(c),fs(c)},a));const l=c=>{if(!b(this,q0)||b(this,q0)===c.pointerId){o(c);return}fs(c)};window.addEventListener("pointerup",l,{signal:r}),window.addEventListener("blur",l,{signal:r})},x8=function(){if(b(this,W0)||!this.div)return;N(this,W0,new AbortController);const e=this._uiManager.combinedSignal(b(this,W0));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},mE=function(e){In._resizerKeyboardManager.exec(this,e)},pE=function(e){var t;b(this,Ec)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==b(this,er)&&L(this,ln,jm).call(this)},bE=function(e){N(this,E2,b(this,Ec)?e:"")},y8=function(e){if(b(this,No))for(const t of b(this,No))t.tabIndex=e},jm=function(){N(this,Ec,!1),L(this,ln,y8).call(this,-1),L(this,ln,k9).call(this)},B(In,M2),ze(In,"_l10n",null),ze(In,"_l10nResizer",null),ze(In,"_borderLineWidth",-1),ze(In,"_colorManager",new a8),ze(In,"_zIndex",1),ze(In,"_telemetryTimeout",1e3);let _i=In;class vF extends _i{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const b_=3285377520,Ya=4294901760,ml=65535;let xE=class{constructor(e){this.h1=e?e&4294967295:b_,this.h2=e?e&4294967295:b_}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let m=0,x=e.length;m<x;m++){const p=e.charCodeAt(m);p<=255?t[i++]=p:(t[i++]=p>>>8,t[i++]=p&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,a=new Uint32Array(t.buffer,0,s);let o=0,l=0,c=this.h1,h=this.h2;const u=3432918353,d=461845907,f=u&ml,g=d&ml;for(let m=0;m<s;m++)m&1?(o=a[m],o=o*u&Ya|o*f&ml,o=o<<15|o>>>17,o=o*d&Ya|o*g&ml,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[m],l=l*u&Ya|l*f&ml,l=l<<15|l>>>17,l=l*d&Ya|l*g&ml,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=t[s*4+2]<<16;case 2:o^=t[s*4+1]<<8;case 1:o^=t[s*4],o=o*u&Ya|o*f&ml,o=o<<15|o>>>17,o=o*d&Ya|o*g&ml,s&1?c^=o:h^=o}this.h1=c,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Ya|e*36045&ml,t=t*4283543511&Ya|((t<<16|e>>>16)*2950163797&Ya)>>>16,e^=t>>>1,e=e*444984403&Ya|e*60499&ml,t=t*3301882366&Ya|((t<<16|e>>>16)*3120437893&Ya)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}};const w8=Object.freeze({map:null,hash:"",transfer:void 0});var Bu,Uu,tr,m5,yE;class o4{constructor(){B(this,m5);B(this,Bu,!1);B(this,Uu,null);B(this,tr,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=b(this,tr).get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return b(this,tr).get(e)}remove(e){if(b(this,tr).delete(e),b(this,tr).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of b(this,tr).values())if(t instanceof _i)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=b(this,tr).get(e);let s=!1;if(i!==void 0)for(const[r,a]of Object.entries(t))i[r]!==a&&(s=!0,i[r]=a);else s=!0,b(this,tr).set(e,t);s&&L(this,m5,yE).call(this),t instanceof _i&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return b(this,tr).has(e)}get size(){return b(this,tr).size}resetModified(){b(this,Bu)&&(N(this,Bu,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new wE(this)}get serializable(){if(b(this,tr).size===0)return w8;const e=new Map,t=new xE,i=[],s=Object.create(null);let r=!1;for(const[a,o]of b(this,tr)){const l=o instanceof _i?o.serialize(!1,s):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),r||(r=!!l.bitmap))}if(r)for(const a of e.values())a.bitmap&&i.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:w8}get editorStats(){let e=null;const t=new Map;for(const i of b(this,tr).values()){if(!(i instanceof _i))continue;const s=i.telemetryFinalData;if(!s)continue;const{type:r}=s;t.has(r)||t.set(r,Object.getPrototypeOf(i).constructor),e||(e=Object.create(null));const a=e[r]||(e[r]=new Map);for(const[o,l]of Object.entries(s)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const h=c.get(l)??0;c.set(l,h+1)}}for(const[i,s]of t)e[i]=s.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){N(this,Uu,null)}get modifiedIds(){if(b(this,Uu))return b(this,Uu);const e=[];for(const t of b(this,tr).values())!(t instanceof _i)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return N(this,Uu,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return b(this,tr).entries()}}Bu=new WeakMap,Uu=new WeakMap,tr=new WeakMap,m5=new WeakSet,yE=function(){b(this,Bu)||(N(this,Bu,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var P2;class wE extends o4{constructor(t){super();B(this,P2);const{map:i,hash:s,transfer:r}=t.serializable,a=structuredClone(i,r?{transfer:r}:null);N(this,P2,{map:a,hash:s,transfer:r})}get print(){gi("Should not call PrintAnnotationStorage.print")}get serializable(){return b(this,P2)}get modifiedIds(){return Hn(this,"modifiedIds",{ids:new Set,hash:""})}}P2=new WeakMap;var v1;class _F{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){B(this,v1,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),b(this,v1).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:i}){if(!(!e||b(this,v1).has(e.loadedName))){if(gs(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:r,style:a}=e,o=new FontFace(s,r,a);this.addNativeFontFace(o);try{await o.load(),b(this,v1).add(s),i==null||i(e)}catch{wn(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}gi("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw wn(`Failed to load font '${i.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Hn(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Hn(this,"isSyncFontLoadingSupported",Br||ur.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(gs(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:t,callback:e};return i.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Hn(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(v,_){return v.charCodeAt(_)<<24|v.charCodeAt(_+1)<<16|v.charCodeAt(_+2)<<8|v.charCodeAt(_+3)&255}function s(v,_,C,k){const I=v.substring(0,_),S=v.substring(_+C);return I+k+S}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function h(v,_){if(++c>30){wn("Load test font never loaded."),_();return}if(l.font="30px "+v,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){_();return}setTimeout(h.bind(null,v,_))}const u=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=s(d,976,u.length,u);const g=16,m=1482184792;let x=i(d,g);for(r=0,a=u.length-3;r<a;r+=4)x=x-m+i(u,r)|0;r<u.length&&(x=x-m+i(u+"XXX",r)|0),d=s(d,g,4,aF(x));const p=`url(data:font/opentype;base64,${btoa(d)});`,y=`@font-face {font-family:"${u}";src:${p}}`;this.insertRule(y);const w=this._document.createElement("div");w.style.visibility="hidden",w.style.width=w.style.height="10px",w.style.position="absolute",w.style.top=w.style.left="0px";for(const v of[e.loadedName,u]){const _=this._document.createElement("span");_.textContent="Hi",_.style.fontFamily=v,w.append(_)}this._document.body.append(w),h(u,()=>{w.remove(),t.complete()})}}v1=new WeakMap;class kF{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const i in e)this[i]=e[i];this._inspectFont=t}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${zI(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(i=this._inspectFont)==null||i.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let s;try{s=e.get(i)}catch(a){wn(`getPathGenerator - ignoring character: "${a}".`)}const r=new Path2D(s||"");return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=r}}function CF(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(Br)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function AF(n){if(Br&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return nx(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Rx(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const v8=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,SF=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",IF=uF.bind(null,v8,SF);var Tc,p5;class EF{constructor(){B(this,Tc,new Map);B(this,p5,Promise.resolve())}postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};b(this,p5).then(()=>{for(const[s]of b(this,Tc))s.call(this,i)})}addEventListener(e,t,i=null){let s=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:r}=i;if(r.aborted){wn("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);s=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}b(this,Tc).set(t,s)}removeEventListener(e,t){const i=b(this,Tc).get(t);i==null||i(),b(this,Tc).delete(t)}terminate(){for(const[,e]of b(this,Tc))e==null||e();b(this,Tc).clear()}}Tc=new WeakMap,p5=new WeakMap;const Mx={DATA:1,ERROR:2},ls={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function x_(){}function ea(n){if(n instanceof Oh||n instanceof t8||n instanceof g_||n instanceof g3||n instanceof sw)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||gi('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Oh(n.message);case"InvalidPDFException":return new t8(n.message);case"PasswordException":return new g_(n.message,n.code);case"ResponseException":return new g3(n.message,n.status,n.missing);case"UnknownErrorException":return new sw(n.message,n.details)}return new sw(n.message,n.toString())}var _1,po,vE,_E,kE,C9,bI;let Gm=(bI=class{constructor(e,t,i){B(this,po);B(this,_1,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",L(this,po,vE).bind(this),{signal:b(this,_1).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},i)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,i,s){const r=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:c,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:c.desiredSize},s),h.promise},pull:c=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:ls.PULL,streamId:r,desiredSize:c.desiredSize}),h.promise},cancel:c=>{gs(c instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:ls.CANCEL,streamId:r,reason:ea(c)}),h.promise}},i)}destroy(){var e;(e=b(this,_1))==null||e.abort(),N(this,_1,null)}},_1=new WeakMap,po=new WeakSet,vE=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){L(this,po,kE).call(this,e);return}if(e.callback){const i=e.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===Mx.DATA)s.resolve(e.data);else if(e.callback===Mx.ERROR)s.reject(ea(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,s=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:i,targetName:s,callback:Mx.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:i,targetName:s,callback:Mx.ERROR,callbackId:e.callbackId,reason:ea(a)})});return}if(e.streamId){L(this,po,_E).call(this,e);return}t(e.data)},_E=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(c,h=1,u){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=h,d>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:ls.ENQUEUE,streamId:t,chunk:c},u)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:ls.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){gs(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:ls.ERROR,streamId:t,reason:ea(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:ls.START_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:ls.START_COMPLETE,streamId:t,reason:ea(c)})})},kE=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case ls.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(ea(e.reason));break;case ls.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(ea(e.reason));break;case ls.PULL:if(!o){r.postMessage({sourceName:i,targetName:s,stream:ls.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||x_).then(function(){r.postMessage({sourceName:i,targetName:s,stream:ls.PULL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:ls.PULL_COMPLETE,streamId:t,reason:ea(c)})});break;case ls.ENQUEUE:if(gs(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case ls.CLOSE:if(gs(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),L(this,po,C9).call(this,a,t);break;case ls.ERROR:gs(a,"error should have stream controller"),a.controller.error(ea(e.reason)),L(this,po,C9).call(this,a,t);break;case ls.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(ea(e.reason)),L(this,po,C9).call(this,a,t);break;case ls.CANCEL:if(!o)break;const l=ea(e.reason);Promise.try(o.onCancel||x_,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:ls.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:ls.CANCEL_COMPLETE,streamId:t,reason:ea(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},C9=async function(e,t){var i,s,r;await Promise.allSettled([(i=e.startCall)==null?void 0:i.promise,(s=e.pullCall)==null?void 0:s.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]},bI);var N2;class CE{constructor({enableHWA:e=!1}){B(this,N2,!1);N(this,N2,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!b(this,N2)})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){gi("Abstract method `_createCanvas` called.")}}N2=new WeakMap;class TF extends CE{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class AE{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){gi("Abstract method `_fetch` called.")}}class y_ extends AE{async _fetch(e){const t=await ix(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):nx(t)}}class SE{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,s,r){return"none"}destroy(e=!1){}}var Hu,k1,Rc,Mc,yr,zu,ju,Nt,br,Vm,yf,A9,wf,IE,_8,vf,qm,Wm,k8,Km;class RF extends SE{constructor({docId:t,ownerDocument:i=globalThis.document}){super();B(this,Nt);B(this,Hu);B(this,k1);B(this,Rc);B(this,Mc);B(this,yr);B(this,zu);B(this,ju,0);N(this,Mc,t),N(this,yr,i)}addFilter(t){if(!t)return"none";let i=b(this,Nt,br).get(t);if(i)return i;const[s,r,a]=L(this,Nt,A9).call(this,t),o=t.length===1?s:`${s}${r}${a}`;if(i=b(this,Nt,br).get(o),i)return b(this,Nt,br).set(t,i),i;const l=`g_${b(this,Mc)}_transfer_map_${Rr(this,ju)._++}`,c=L(this,Nt,wf).call(this,l);b(this,Nt,br).set(t,c),b(this,Nt,br).set(o,c);const h=L(this,Nt,vf).call(this,l);return L(this,Nt,Wm).call(this,s,r,a,h),c}addHCMFilter(t,i){var g;const s=`${t}-${i}`,r="base";let a=b(this,Nt,Vm).get(r);if((a==null?void 0:a.key)===s||(a?((g=a.filter)==null||g.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},b(this,Nt,Vm).set(r,a)),!t||!i))return a.url;const o=L(this,Nt,Km).call(this,t);t=en.makeHexColor(...o);const l=L(this,Nt,Km).call(this,i);if(i=en.makeHexColor(...l),b(this,Nt,yf).style.color="",t==="#000000"&&i==="#ffffff"||t===i)return a.url;const c=new Array(256);for(let m=0;m<=255;m++){const x=m/255;c[m]=x<=.03928?x/12.92:((x+.055)/1.055)**2.4}const h=c.join(","),u=`g_${b(this,Mc)}_hcm_filter`,d=a.filter=L(this,Nt,vf).call(this,u);L(this,Nt,Wm).call(this,h,h,h,d),L(this,Nt,_8).call(this,d);const f=(m,x)=>{const p=o[m]/255,y=l[m]/255,w=new Array(x+1);for(let v=0;v<=x;v++)w[v]=p+v/x*(y-p);return w.join(",")};return L(this,Nt,Wm).call(this,f(0,5),f(1,5),f(2,5),d),a.url=L(this,Nt,wf).call(this,u),a.url}addAlphaFilter(t){let i=b(this,Nt,br).get(t);if(i)return i;const[s]=L(this,Nt,A9).call(this,[t]),r=`alpha_${s}`;if(i=b(this,Nt,br).get(r),i)return b(this,Nt,br).set(t,i),i;const a=`g_${b(this,Mc)}_alpha_map_${Rr(this,ju)._++}`,o=L(this,Nt,wf).call(this,a);b(this,Nt,br).set(t,o),b(this,Nt,br).set(r,o);const l=L(this,Nt,vf).call(this,a);return L(this,Nt,k8).call(this,s,l),o}addLuminosityFilter(t){let i=b(this,Nt,br).get(t||"luminosity");if(i)return i;let s,r;if(t?([s]=L(this,Nt,A9).call(this,[t]),r=`luminosity_${s}`):r="luminosity",i=b(this,Nt,br).get(r),i)return b(this,Nt,br).set(t,i),i;const a=`g_${b(this,Mc)}_luminosity_map_${Rr(this,ju)._++}`,o=L(this,Nt,wf).call(this,a);b(this,Nt,br).set(t,o),b(this,Nt,br).set(r,o);const l=L(this,Nt,vf).call(this,a);return L(this,Nt,IE).call(this,l),t&&L(this,Nt,k8).call(this,s,l),o}addHighlightHCMFilter(t,i,s,r,a){var y;const o=`${i}-${s}-${r}-${a}`;let l=b(this,Nt,Vm).get(t);if((l==null?void 0:l.key)===o||(l?((y=l.filter)==null||y.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},b(this,Nt,Vm).set(t,l)),!i||!s))return l.url;const[c,h]=[i,s].map(L(this,Nt,Km).bind(this));let u=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),d=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[f,g]=[r,a].map(L(this,Nt,Km).bind(this));d<u&&([u,d,f,g]=[d,u,g,f]),b(this,Nt,yf).style.color="";const m=(w,v,_)=>{const C=new Array(256),k=(d-u)/_,I=w/255,S=(v-w)/(255*_);let R=0;for(let P=0;P<=_;P++){const D=Math.round(u+P*k),U=I+P*S;for(let T=R;T<=D;T++)C[T]=U;R=D+1}for(let P=R;P<256;P++)C[P]=C[R-1];return C.join(",")},x=`g_${b(this,Mc)}_hcm_${t}_filter`,p=l.filter=L(this,Nt,vf).call(this,x);return L(this,Nt,_8).call(this,p),L(this,Nt,Wm).call(this,m(f[0],g[0],5),m(f[1],g[1],5),m(f[2],g[2],5),p),l.url=L(this,Nt,wf).call(this,x),l.url}destroy(t=!1){var i,s,r,a;t&&((i=b(this,zu))!=null&&i.size)||((s=b(this,Rc))==null||s.parentNode.parentNode.remove(),N(this,Rc,null),(r=b(this,k1))==null||r.clear(),N(this,k1,null),(a=b(this,zu))==null||a.clear(),N(this,zu,null),N(this,ju,0))}}Hu=new WeakMap,k1=new WeakMap,Rc=new WeakMap,Mc=new WeakMap,yr=new WeakMap,zu=new WeakMap,ju=new WeakMap,Nt=new WeakSet,br=function(){return b(this,k1)||N(this,k1,new Map)},Vm=function(){return b(this,zu)||N(this,zu,new Map)},yf=function(){if(!b(this,Rc)){const t=b(this,yr).createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=b(this,yr).createElementNS(hc,"svg");s.setAttribute("width",0),s.setAttribute("height",0),N(this,Rc,b(this,yr).createElementNS(hc,"defs")),t.append(s),s.append(b(this,Rc)),b(this,yr).body.append(t)}return b(this,Rc)},A9=function(t){if(t.length===1){const c=t[0],h=new Array(256);for(let d=0;d<256;d++)h[d]=c[d]/255;const u=h.join(",");return[u,u,u]}const[i,s,r]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let c=0;c<256;c++)a[c]=i[c]/255,o[c]=s[c]/255,l[c]=r[c]/255;return[a.join(","),o.join(","),l.join(",")]},wf=function(t){if(b(this,Hu)===void 0){N(this,Hu,"");const i=b(this,yr).URL;i!==b(this,yr).baseURI&&(X5(i)?wn('#createUrl: ignore "data:"-URL for performance reasons.'):N(this,Hu,BI(i,"")))}return`url(${b(this,Hu)}#${t})`},IE=function(t){const i=b(this,yr).createElementNS(hc,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)},_8=function(t){const i=b(this,yr).createElementNS(hc,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)},vf=function(t){const i=b(this,yr).createElementNS(hc,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),b(this,Nt,yf).append(i),i},qm=function(t,i,s){const r=b(this,yr).createElementNS(hc,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)},Wm=function(t,i,s,r){const a=b(this,yr).createElementNS(hc,"feComponentTransfer");r.append(a),L(this,Nt,qm).call(this,a,"feFuncR",t),L(this,Nt,qm).call(this,a,"feFuncG",i),L(this,Nt,qm).call(this,a,"feFuncB",s)},k8=function(t,i){const s=b(this,yr).createElementNS(hc,"feComponentTransfer");i.append(s),L(this,Nt,qm).call(this,s,"feFuncA",t)},Km=function(t){return b(this,Nt,yf).style.color=t,a4(getComputedStyle(b(this,Nt,yf)).getPropertyValue("color"))};class EE{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){gi("Abstract method `_fetch` called.")}}class w_ extends EE{async _fetch(e){const t=await ix(e,"arraybuffer");return new Uint8Array(t)}}class TE{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){gi("Abstract method `_fetch` called.")}}class v_ extends TE{async _fetch(e){const t=await ix(e,"arraybuffer");return new Uint8Array(t)}}Br&&wn("Please use the `legacy` build in Node.js environments.");async function l4(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class MF extends SE{}class PF extends CE{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class NF extends AE{async _fetch(e){return l4(e)}}class OF extends EE{async _fetch(e){return l4(e)}}class DF extends TE{async _fetch(e){return l4(e)}}const ar={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function C8(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,i),n.clip(s)}class c4{isModifyingCurrentTransform(){return!1}getPattern(){gi("Abstract method `getPattern` called.")}}class LF extends c4{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,s){let r;if(s===ar.STROKE||s===ar.FILL){const a=t.current.getClippedPathBoundingBox(s,Vi(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=t.cachedCanvases.getCanvas("pattern",o,l),h=c.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),i=en.transform(i,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),C8(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=e.createPattern(c.canvas,"no-repeat");const u=new DOMMatrix(i);r.setTransform(u)}else C8(e,this._bbox),r=this._createGradient(e);return r}}function ow(n,e,t,i,s,r,a,o){const l=e.coords,c=e.colors,h=n.data,u=n.width*4;let d;l[t+1]>l[i+1]&&(d=t,t=i,i=d,d=r,r=a,a=d),l[i+1]>l[s+1]&&(d=i,i=s,s=d,d=a,a=o,o=d),l[t+1]>l[i+1]&&(d=t,t=i,i=d,d=r,r=a,a=d);const f=(l[t]+e.offsetX)*e.scaleX,g=(l[t+1]+e.offsetY)*e.scaleY,m=(l[i]+e.offsetX)*e.scaleX,x=(l[i+1]+e.offsetY)*e.scaleY,p=(l[s]+e.offsetX)*e.scaleX,y=(l[s+1]+e.offsetY)*e.scaleY;if(g>=y)return;const w=c[r],v=c[r+1],_=c[r+2],C=c[a],k=c[a+1],I=c[a+2],S=c[o],R=c[o+1],P=c[o+2],D=Math.round(g),U=Math.round(y);let T,G,M,F,X,z,K,j;for(let ae=D;ae<=U;ae++){if(ae<x){const O=ae<g?0:(g-ae)/(g-x);T=f-(f-m)*O,G=w-(w-C)*O,M=v-(v-k)*O,F=_-(_-I)*O}else{let O;ae>y?O=1:x===y?O=0:O=(x-ae)/(x-y),T=m-(m-p)*O,G=C-(C-S)*O,M=k-(k-R)*O,F=I-(I-P)*O}let ge;ae<g?ge=0:ae>y?ge=1:ge=(g-ae)/(g-y),X=f-(f-p)*ge,z=w-(w-S)*ge,K=v-(v-R)*ge,j=_-(_-P)*ge;const ue=Math.round(Math.min(T,X)),pe=Math.round(Math.max(T,X));let de=u*ae+ue*4;for(let O=ue;O<=pe;O++)ge=(T-O)/(T-X),ge<0?ge=0:ge>1&&(ge=1),h[de++]=G-(G-z)*ge|0,h[de++]=M-(M-K)*ge|0,h[de++]=F-(F-j)*ge|0,h[de++]=255}}function FF(n,e,t){const i=e.coords,s=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(r=0;r<l;r++){let h=r*o;for(let u=0;u<c;u++,h++)ow(n,t,i[h],i[h+1],i[h+o],s[h],s[h+1],s[h+o]),ow(n,t,i[h+o+1],i[h+1],i[h+o],s[h+o+1],s[h+1],s[h+o])}break;case"triangles":for(r=0,a=i.length;r<a;r+=3)ow(n,t,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class BF extends c4{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,i){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-l,u=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),d=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),f=c/u,g=h/d,m={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/f,scaleY:1/g},x=u+2*2,p=d+2*2,y=i.getCanvas("mesh",x,p),w=y.context,v=w.createImageData(u,d);if(t){const C=v.data;for(let k=0,I=C.length;k<I;k+=4)C[k]=t[0],C[k+1]=t[1],C[k+2]=t[2],C[k+3]=255}for(const C of this._figures)FF(v,C,m);return w.putImageData(v,2,2),{canvas:y.canvas,offsetX:o-2*f,offsetY:l-2*g,scaleX:f,scaleY:g}}isModifyingCurrentTransform(){return!0}getPattern(e,t,i,s){C8(e,this._bbox);const r=new Float32Array(2);if(s===ar.SHADING)en.singularValueDecompose2dScale(Vi(e),r);else if(this.matrix){en.singularValueDecompose2dScale(this.matrix,r);const[o,l]=r;en.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=o,r[1]*=l}else en.singularValueDecompose2dScale(t.baseTransform,r);const a=this._createMeshCanvas(r,s===ar.SHADING?null:this._background,t.cachedCanvases);return s!==ar.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class UF extends c4{getPattern(){return"hotpink"}}function HF(n){switch(n[0]){case"RadialAxial":return new LF(n);case"Mesh":return new BF(n);case"Dummy":return new UF}throw new Error(`Unknown IR type: ${n[0]}`)}const __={COLORED:1,UNCOLORED:2},b5=class b5{constructor(e,t,i,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(e){const{bbox:t,operatorList:i,paintType:s,tilingType:r,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),K5("TilingType: "+r);const h=t[0],u=t[1],d=t[2],f=t[3],g=d-h,m=f-u,x=new Float32Array(2);en.singularValueDecompose2dScale(this.matrix,x);const[p,y]=x;en.singularValueDecompose2dScale(this.baseTransform,x);const w=p*x[0],v=y*x[1];let _=g,C=m,k=!1,I=!1;const S=Math.ceil(l*w),R=Math.ceil(c*v),P=Math.ceil(g*w),D=Math.ceil(m*v);S>=P?_=l:k=!0,R>=D?C=c:I=!0;const U=this.getSizeAndScale(_,this.ctx.canvas.width,w),T=this.getSizeAndScale(C,this.ctx.canvas.height,v),G=e.cachedCanvases.getCanvas("pattern",U.size,T.size),M=G.context,F=o.createCanvasGraphics(M);if(F.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(F,s,a),M.translate(-U.scale*h,-T.scale*u),F.transform(U.scale,0,0,T.scale,0,0),M.save(),this.clipBbox(F,h,u,d,f),F.baseTransform=Vi(F.ctx),F.executeOperatorList(i),F.endDrawing(),M.restore(),k||I){const X=G.canvas;k&&(_=l),I&&(C=c);const z=this.getSizeAndScale(_,this.ctx.canvas.width,w),K=this.getSizeAndScale(C,this.ctx.canvas.height,v),j=z.size,ae=K.size,ge=e.cachedCanvases.getCanvas("pattern-workaround",j,ae),ue=ge.context,pe=k?Math.floor(g/l):0,de=I?Math.floor(m/c):0;for(let O=0;O<=pe;O++)for(let Y=0;Y<=de;Y++)ue.drawImage(X,j*O,ae*Y,j,ae,0,0,j,ae);return{canvas:ge.canvas,scaleX:z.scale,scaleY:K.scale,offsetX:h,offsetY:u}}return{canvas:G.canvas,scaleX:U.scale,scaleY:T.scale,offsetX:h,offsetY:u}}getSizeAndScale(e,t,i){const s=Math.max(b5.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*i);return r>=s?r=s:i=r/e,{scale:i,size:r}}clipBbox(e,t,i,s,r){const a=s-t,o=r-i;e.ctx.rect(t,i,a,o),en.axialAlignedBoundingBox([t,i,s,r],Vi(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const s=e.ctx,r=e.current;switch(t){case __.COLORED:const{fillStyle:a,strokeStyle:o}=this.ctx;s.fillStyle=r.fillColor=a,s.strokeStyle=r.strokeColor=o;break;case __.UNCOLORED:s.fillStyle=s.strokeStyle=i,r.fillColor=r.strokeColor=i;break;default:throw new rF(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,i,s){let r=i;s!==ar.SHADING&&(r=en.transform(r,t.baseTransform),this.matrix&&(r=en.transform(r,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(r);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=e.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};ze(b5,"MAX_PATTERN_SIZE",3e3);let A8=b5;function zF({src:n,srcPos:e=0,dest:t,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=ur.isLittleEndian?4278190080:255,[l,c]=a?[r,o]:[o,r],h=i>>3,u=i&7,d=n.length;t=new Uint32Array(t.buffer);let f=0;for(let g=0;g<s;g++){for(const x=e+h;e<x;e++){const p=e<d?n[e]:255;t[f++]=p&128?c:l,t[f++]=p&64?c:l,t[f++]=p&32?c:l,t[f++]=p&16?c:l,t[f++]=p&8?c:l,t[f++]=p&4?c:l,t[f++]=p&2?c:l,t[f++]=p&1?c:l}if(u===0)continue;const m=e<d?n[e++]:255;for(let x=0;x<u;x++)t[f++]=m&1<<7-x?c:l}return{srcPos:e,destPos:f}}const k_=16,C_=100,jF=15,A_=10,aa=16,lw=new DOMMatrix,La=new Float32Array(2),Df=new Float32Array([1/0,1/0,-1/0,-1/0]);function GF(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,i){e.translate(t,i),this.__originalTranslate(t,i)},n.scale=function(t,i){e.scale(t,i),this.__originalScale(t,i)},n.transform=function(t,i,s,r,a,o){e.transform(t,i,s,r,a,o),this.__originalTransform(t,i,s,r,a,o)},n.setTransform=function(t,i,s,r,a,o){e.setTransform(t,i,s,r,a,o),this.__originalSetTransform(t,i,s,r,a,o)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,s,r,a,o){e.bezierCurveTo(t,i,s,r,a,o),this.__originalBezierCurveTo(t,i,s,r,a,o)},n.rect=function(t,i,s,r){e.rect(t,i,s,r),this.__originalRect(t,i,s,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class VF{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,i)):(s=this.canvasFactory.create(t,i),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Px(n,e,t,i,s,r,a,o,l,c){const[h,u,d,f,g,m]=Vi(n);if(u===0&&d===0){const y=a*h+g,w=Math.round(y),v=o*f+m,_=Math.round(v),C=(a+l)*h+g,k=Math.abs(Math.round(C)-w)||1,I=(o+c)*f+m,S=Math.abs(Math.round(I)-_)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(f),w,_),n.drawImage(e,t,i,s,r,0,0,k,S),n.setTransform(h,u,d,f,g,m),[k,S]}if(h===0&&f===0){const y=o*d+g,w=Math.round(y),v=a*u+m,_=Math.round(v),C=(o+c)*d+g,k=Math.abs(Math.round(C)-w)||1,I=(a+l)*u+m,S=Math.abs(Math.round(I)-_)||1;return n.setTransform(0,Math.sign(u),Math.sign(d),0,w,_),n.drawImage(e,t,i,s,r,0,0,S,k),n.setTransform(h,u,d,f,g,m),[S,k]}n.drawImage(e,t,i,s,r,a,o,l,c);const x=Math.hypot(h,u),p=Math.hypot(d,f);return[x*l,p*c]}class S_{constructor(e,t){ze(this,"alphaIsShape",!1);ze(this,"fontSize",0);ze(this,"fontSizeScale",1);ze(this,"textMatrix",null);ze(this,"textMatrixScale",1);ze(this,"fontMatrix",e8);ze(this,"leading",0);ze(this,"x",0);ze(this,"y",0);ze(this,"lineX",0);ze(this,"lineY",0);ze(this,"charSpacing",0);ze(this,"wordSpacing",0);ze(this,"textHScale",1);ze(this,"textRenderingMode",pr.FILL);ze(this,"textRise",0);ze(this,"fillColor","#000000");ze(this,"strokeColor","#000000");ze(this,"patternFill",!1);ze(this,"patternStroke",!1);ze(this,"fillAlpha",1);ze(this,"strokeAlpha",1);ze(this,"lineWidth",1);ze(this,"activeSMask",null);ze(this,"transferMaps","none");this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Df.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=ar.FILL,t=null){const i=this.minMax.slice();if(e===ar.STROKE){t||gi("Stroke bounding box must include transform."),en.singularValueDecompose2dScale(t,La);const s=La[0]*this.lineWidth/2,r=La[1]*this.lineWidth/2;i[0]-=s,i[1]-=r,i[2]+=s,i[3]+=r}return i}updateClipFromPath(){const e=en.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Df,0)}getClippedPathBoundingBox(e=ar.FILL,t=null){return en.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function I_(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,s=t%aa,r=(t-s)/aa,a=s===0?r:r+1,o=n.createImageData(i,aa);let l=0,c;const h=e.data,u=o.data;let d,f,g,m;if(e.kind===m9.GRAYSCALE_1BPP){const x=h.byteLength,p=new Uint32Array(u.buffer,0,u.byteLength>>2),y=p.length,w=i+7>>3,v=4294967295,_=ur.isLittleEndian?4278190080:255;for(d=0;d<a;d++){for(g=d<r?aa:s,c=0,f=0;f<g;f++){const C=x-l;let k=0;const I=C>w?i:C*8-7,S=I&-8;let R=0,P=0;for(;k<S;k+=8)P=h[l++],p[c++]=P&128?v:_,p[c++]=P&64?v:_,p[c++]=P&32?v:_,p[c++]=P&16?v:_,p[c++]=P&8?v:_,p[c++]=P&4?v:_,p[c++]=P&2?v:_,p[c++]=P&1?v:_;for(;k<I;k++)R===0&&(P=h[l++],R=128),p[c++]=P&R?v:_,R>>=1}for(;c<y;)p[c++]=0;n.putImageData(o,0,d*aa)}}else if(e.kind===m9.RGBA_32BPP){for(f=0,m=i*aa*4,d=0;d<r;d++)u.set(h.subarray(l,l+m)),l+=m,n.putImageData(o,0,f),f+=aa;d<a&&(m=i*s*4,u.set(h.subarray(l,l+m)),n.putImageData(o,0,f))}else if(e.kind===m9.RGB_24BPP)for(g=aa,m=i*g,d=0;d<a;d++){for(d>=r&&(g=s,m=i*g),c=0,f=m;f--;)u[c++]=h[l++],u[c++]=h[l++],u[c++]=h[l++],u[c++]=255;n.putImageData(o,0,d*aa)}else throw new Error(`bad image kind: ${e.kind}`)}function E_(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,s=t%aa,r=(t-s)/aa,a=s===0?r:r+1,o=n.createImageData(i,aa);let l=0;const c=e.data,h=o.data;for(let u=0;u<a;u++){const d=u<r?aa:s;({srcPos:l}=zF({src:c,srcPos:l,dest:h,width:i,height:d,nonBlackColor:0})),n.putImageData(o,0,u*aa)}}function xm(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Nx(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function T_(n,e){if(e)return!0;en.singularValueDecompose2dScale(n,La);const t=Math.fround(nc.pixelRatio*Dh.PDF_TO_CSS_UNITS);return La[0]<=t&&La[1]<=t}const qF=["butt","round","square"],WF=["miter","round","bevel"],KF={},R_={};var al,S8,I8,E8;const zv=class zv{constructor(e,t,i,s,r,{optionalContentConfig:a,markedContentStack:o=null},l,c){B(this,al);this.ctx=e,this.current=new S_(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=s,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new VF(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:s=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,i){const l=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Vi(this.compositeCtx))}this.ctx.save(),Nx(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Vi(this.ctx)}executeOperatorList(e,t,i,s){const r=e.argsArray,a=e.fnArray;let o=t||0;const l=r.length;if(l===o)return o;const c=l-o>A_&&typeof i=="function",h=c?Date.now()+jF:0;let u=0;const d=this.commonObjs,f=this.objs;let g;for(;;){if(s!==void 0&&o===s.nextBreakPoint)return s.breakIt(o,i),o;if(g=a[o],g!==f3.dependency)this[g].apply(this,r[o]);else for(const m of r[o]){const x=m.startsWith("g_")?d:f;if(!x.has(m))return x.get(m,i),o}if(o++,o===l)return o;if(c&&++u>A_){if(Date.now()>h)return i(),o;u=0}}}endDrawing(){L(this,al,S8).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),L(this,al,I8).call(this)}_scaleImage(e,t){const i=e.width??e.displayWidth,s=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=i,l=s,c="prescale1",h,u;for(;r>2&&o>1||a>2&&l>1;){let d=o,f=l;r>2&&o>1&&(d=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/d),a>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/f),h=this.cachedCanvases.getCanvas(c,d,f),u=h.context,u.clearRect(0,0,d,f),u.drawImage(e,0,0,o,l,0,0,d,f),e=h.canvas,o=d,l=f,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:i,height:s}=e,r=this.current.fillColor,a=this.current.patternFill,o=Vi(t);let l,c,h,u;if((e.bitmap||e.data)&&e.count>1){const S=e.bitmap||e.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),r]),l=this._cachedBitmapsMap.get(S),l||(l=new Map,this._cachedBitmapsMap.set(S,l));const R=l.get(c);if(R&&!a){const P=Math.round(Math.min(o[0],o[2])+o[4]),D=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:R,offsetX:P,offsetY:D}}h=R}h||(u=this.cachedCanvases.getCanvas("maskCanvas",i,s),E_(u.context,e));let d=en.transform(o,[1/i,0,0,-1/s,0,0]);d=en.transform(d,[1,0,0,1,0,-s]);const f=Df.slice();en.axialAlignedBoundingBox([0,0,i,s],d,f);const[g,m,x,p]=f,y=Math.round(x-g)||1,w=Math.round(p-m)||1,v=this.cachedCanvases.getCanvas("fillCanvas",y,w),_=v.context,C=g,k=m;_.translate(-C,-k),_.transform(...d),h||(h=this._scaleImage(u.canvas,gl(_)),h=h.img,l&&a&&l.set(c,h)),_.imageSmoothingEnabled=T_(Vi(_),e.interpolate),Px(_,h,0,0,h.width,h.height,0,0,i,s),_.globalCompositeOperation="source-in";const I=en.transform(gl(_),[1,0,0,1,-C,-k]);return _.fillStyle=a?r.getPattern(t,this,I,ar.FILL):r,_.fillRect(0,0,i,s),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,v.canvas)),{canvas:v.canvas,offsetX:Math.round(C),offsetY:Math.round(k)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=qF[e]}setLineJoin(e){this.ctx.lineJoin=WF[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,i]of e)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,e,t);this.suspendedCtx=this.ctx;const r=this.ctx=s.context;r.setTransform(this.suspendedCtx.getTransform()),xm(this.suspendedCtx,r),GF(r,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),xm(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,s){const r=s[0],a=s[1],o=s[2]-r,l=s[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,i,o,l,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,s,r,a,o,l,c,h,u){let d=e.canvas,f=l-h,g=c-u;if(a)if(f<0||g<0||f+i>d.width||g+s>d.height){const x=this.cachedCanvases.getCanvas("maskExtension",i,s),p=x.context;p.drawImage(d,-f,-g),p.globalCompositeOperation="destination-atop",p.fillStyle=a,p.fillRect(0,0,i,s),p.globalCompositeOperation="source-over",d=x.canvas,f=g=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const x=new Path2D;x.rect(f,g,i,s),e.clip(x),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(f,g,i,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const m=new Path2D;m.rect(l,c,i,s),t.clip(m),t.globalCompositeOperation="destination-in",t.drawImage(d,f,g,i,s,l,c,i,s),t.restore()}save(){this.inSMaskMode&&xm(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&xm(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,i,s,r,a){this.ctx.transform(e,t,i,s,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i){let[s]=t;if(!i){s||(s=t[0]=new Path2D),this[e](s);return}if(!(s instanceof Path2D)){const r=t[0]=new Path2D;for(let a=0,o=s.length;a<o;)switch(s[a++]){case Tx.moveTo:r.moveTo(s[a++],s[a++]);break;case Tx.lineTo:r.lineTo(s[a++],s[a++]);break;case Tx.curveTo:r.bezierCurveTo(s[a++],s[a++],s[a++],s[a++],s[a++],s[a++]);break;case Tx.closePath:r.closePath();break;default:wn(`Unrecognized drawing path operator: ${s[a-1]}`);break}s=r}en.axialAlignedBoundingBox(i,Vi(this.ctx),this.current.minMax),this[e](s)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const i=this.ctx,s=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&(s!=null&&s.getPattern)){const r=s.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=s.getPattern(i,this,gl(i),ar.STROKE),r){const a=new Path2D;a.addPath(e,i.getTransform().invertSelf().multiplySelf(r)),e=a}this.rescaleAndStroke(e,!1),i.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(ar.STROKE,Vi(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const i=this.ctx,s=this.current.fillColor,r=this.current.patternFill;let a=!1;if(r){const l=s.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.fillStyle=s.getPattern(i,this,gl(i),ar.FILL),l){const c=new Path2D;c.addPath(e,i.getTransform().invertSelf().multiplySelf(l)),e=c}a=!0}const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(i.fill(e,"evenodd"),this.pendingEOFill=!1):i.fill(e)),a&&i.restore(),t&&this.consumePath(e,o)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=KF}eoClip(){this.pendingClip=R_}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0)return;const i=new Path2D,s=t.getTransform().invertSelf();for(const{transform:r,x:a,y:o,fontSize:l,path:c}of e)i.addPath(c,new DOMMatrix(r).preMultiplySelf(s).translate(a,o).scale(l,-l));t.clip(i),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const i=this.commonObjs.get(e),s=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=i.fontMatrix||e8,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&wn("Invalid font matrix for font "+e),t<0?(t=-t,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const r=i.loadedName||"sans-serif",a=((h=i.systemFontInfo)==null?void 0:h.css)||`"${r}", ${i.fallbackName}`;let o="normal";i.black?o="900":i.bold&&(o="bold");const l=i.italic?"italic":"normal";let c=t;t<k_?c=k_:t>C_&&(c=C_),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,i,s,r){const a=this.ctx,o=this.current,l=o.font,c=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,u=c&pr.FILL_STROKE_MASK,d=!!(c&pr.ADD_TO_PATH_FLAG),f=o.patternFill&&!l.missingFile,g=o.patternStroke&&!l.missingFile;let m;if((l.disableFontFace||d||f||g)&&(m=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||f||g){a.save(),a.translate(t,i),a.scale(h,-h);let x;if((u===pr.FILL||u===pr.FILL_STROKE)&&(s?(x=a.getTransform(),a.setTransform(...s),a.fill(L(this,al,E8).call(this,m,x,s))):a.fill(m)),u===pr.STROKE||u===pr.FILL_STROKE)if(r){x||(x=a.getTransform()),a.setTransform(...r);const{a:p,b:y,c:w,d:v}=x,_=en.inverseTransform(r),C=en.transform([p,y,w,v,0,0],_);en.singularValueDecompose2dScale(C,La),a.lineWidth*=Math.max(La[0],La[1])/h,a.stroke(L(this,al,E8).call(this,m,x,r))}else a.lineWidth/=h,a.stroke(m);a.restore()}else(u===pr.FILL||u===pr.FILL_STROKE)&&a.fillText(e,t,i),(u===pr.STROKE||u===pr.FILL_STROKE)&&a.strokeText(e,t,i);d&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Vi(a),x:t,y:i,fontSize:h,path:m})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){i=!0;break}return Hn(this,"isFontSubpixelAAEnabled",i)}showText(e){const t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);const s=t.fontSize;if(s===0)return;const r=this.ctx,a=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,h=t.textHScale*c,u=e.length,d=i.vertical,f=d?1:-1,g=i.defaultVMetrics,m=s*t.fontMatrix[0],x=t.textRenderingMode===pr.FILL&&!i.disableFontFace&&!t.patternFill;r.save(),t.textMatrix&&r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),c>0?r.scale(h,-1):r.scale(h,1);let p,y;if(t.patternFill){r.save();const k=t.fillColor.getPattern(r,this,gl(r),ar.FILL);p=Vi(r),r.restore(),r.fillStyle=k}if(t.patternStroke){r.save();const k=t.strokeColor.getPattern(r,this,gl(r),ar.STROKE);y=Vi(r),r.restore(),r.strokeStyle=k}let w=t.lineWidth;const v=t.textMatrixScale;if(v===0||w===0){const k=t.textRenderingMode&pr.FILL_STROKE_MASK;(k===pr.STROKE||k===pr.FILL_STROKE)&&(w=this.getSinglePixelWidth())}else w/=v;if(a!==1&&(r.scale(a,a),w/=a),r.lineWidth=w,i.isInvalidPDFjsFont){const k=[];let I=0;for(const S of e)k.push(S.unicode),I+=S.width;r.fillText(k.join(""),0,0),t.x+=I*m*h,r.restore(),this.compose();return}let _=0,C;for(C=0;C<u;++C){const k=e[C];if(typeof k=="number"){_+=f*k*s/1e3;continue}let I=!1;const S=(k.isSpace?l:0)+o,R=k.fontChar,P=k.accent;let D,U,T=k.width;if(d){const M=k.vmetric||g,F=-(k.vmetric?M[1]:T*.5)*m,X=M[2]*m;T=M?-M[0]:T,D=F/a,U=(_+X)/a}else D=_/a,U=0;if(i.remeasure&&T>0){const M=r.measureText(R).width*1e3/s*a;if(T<M&&this.isFontSubpixelAAEnabled){const F=T/M;I=!0,r.save(),r.scale(F,1),D/=F}else T!==M&&(D+=(T-M)/2e3*s/a)}if(this.contentVisible&&(k.isInFont||i.missingFile)){if(x&&!P)r.fillText(R,D,U);else if(this.paintChar(R,D,U,p,y),P){const M=D+s*P.offset.x/a,F=U-s*P.offset.y/a;this.paintChar(P.fontChar,M,F,p,y)}}const G=d?T*m-S*c:T*m+S*c;_+=G,I&&r.restore()}d?t.y-=_:t.x+=_*h,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,i=this.current,s=i.font,r=i.fontSize,a=i.fontDirection,o=s.vertical?1:-1,l=i.charSpacing,c=i.wordSpacing,h=i.textHScale*a,u=i.fontMatrix||e8,d=e.length,f=i.textRenderingMode===pr.INVISIBLE;let g,m,x,p;if(!(f||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),i.textMatrix&&t.transform(...i.textMatrix),t.translate(i.x,i.y+i.textRise),t.scale(h,a),g=0;g<d;++g){if(m=e[g],typeof m=="number"){p=o*m*r/1e3,this.ctx.translate(p,0),i.x+=p*h;continue}const y=(m.isSpace?c:0)+l,w=s.charProcOperatorList[m.operatorListId];w?this.contentVisible&&(this.save(),t.scale(r,r),t.transform(...u),this.executeOperatorList(w),this.restore()):wn(`Type3 character "${m.operatorListId}" is not available.`);const v=[m.width,0];en.applyTransform(v,u),x=v[0]*r+y,t.translate(x,0),i.x+=x*h}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,i,s,r,a){const o=new Path2D;o.rect(i,s,r-i,a-s),this.ctx.clip(o),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const i=this.baseTransform||Vi(this.ctx),s={createCanvasGraphics:r=>new zv(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new A8(e,this.ctx,s,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=HF(this.getObject(e)),this.cachedPatterns.set(e,i)),t&&(i.matrix=t),i}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const i=this._getPattern(e);t.fillStyle=i.getPattern(t,this,gl(t),ar.SHADING);const s=gl(t);if(s){const{width:r,height:a}=t.canvas,o=Df.slice();en.axialAlignedBoundingBox([0,0,r,a],s,o);const[l,c,h,u]=o;this.ctx.fillRect(l,c,h-l,u-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){gi("Should not call beginInlineImage")}beginImageData(){gi("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Vi(this.ctx),t)){en.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[i,s,r,a]=t,o=new Path2D;o.rect(i,s,r-i,a-s),this.ctx.clip(o),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||K5("TODO: Support non-isolated groups."),e.knockout&&wn("Knockout groups not supported.");const i=Vi(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=Df.slice();en.axialAlignedBoundingBox(e.bbox,Vi(t),s);const r=[0,0,t.canvas.width,t.canvas.height];s=en.intersect(s,r)||[0,0,0,0];const a=Math.floor(s[0]),o=Math.floor(s[1]),l=Math.max(Math.ceil(s[2])-a,1),c=Math.max(Math.ceil(s[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const u=this.cachedCanvases.getCanvas(h,l,c),d=u.context;d.translate(-a,-o),d.transform(...i);let f=new Path2D;const[g,m,x,p]=e.bbox;if(f.rect(g,m,x-g,p-m),e.matrix){const y=new Path2D;y.addPath(f,new DOMMatrix(e.matrix)),f=y}d.clip(f),e.smask?this.smaskStack.push({canvas:u.canvas,context:d,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),xm(t,d),this.ctx=d,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=Vi(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const r=Df.slice();en.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],s,r),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,i,s,r){if(L(this,al,S8).call(this),Nx(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(r&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o,en.singularValueDecompose2dScale(Vi(this.ctx),La);const{viewportScale:l}=this,c=Math.ceil(a*this.outputScaleX*l),h=Math.ceil(o*this.outputScaleY*l);this.annotationCanvas=this.canvasFactory.create(c,h);const{canvas:u,context:d}=this.annotationCanvas;this.annotationCanvasMap.set(e,u),this.annotationCanvas.savedCtx=this.ctx,this.ctx=d,this.ctx.save(),this.ctx.setTransform(La[0],0,0,-La[1],0,o*La[1]),Nx(this.ctx)}else{Nx(this.ctx),this.endPath();const l=new Path2D;l.rect(t[0],t[1],a,o),this.ctx.clip(l)}}this.current=new S_(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),L(this,al,I8).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const i=this.ctx,s=this._createMaskCanvas(e),r=s.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(r,s.offsetX,s.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i=0,s=0,r,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const l=Vi(o);o.transform(t,i,s,r,0,0);const c=this._createMaskCanvas(e);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let h=0,u=a.length;h<u;h+=2){const d=en.transform(l,[t,i,s,r,a[h],a[h+1]]);o.drawImage(c.canvas,d[4],d[5])}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(const r of e){const{data:a,width:o,height:l,transform:c}=r,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),u=h.context;u.save();const d=this.getObject(a,r);E_(u,d),u.globalCompositeOperation="source-in",u.fillStyle=s?i.getPattern(u,this,gl(t),ar.FILL):i,u.fillRect(0,0,o,l),u.restore(),t.save(),t.transform(...c),t.scale(1,-1),Px(t,h.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){wn("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,i,s){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){wn("Dependent image isn't ready yet");return}const a=r.width,o=r.height,l=[];for(let c=0,h=s.length;c<h;c+=2)l.push({transform:[t,0,0,i,s[c],s[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(r,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:s}=e,r=this.cachedCanvases.getCanvas("inlineImage",i,s),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,i=e.height,s=this.ctx;this.save();const{filter:r}=s;r!=="none"&&r!==""&&(s.filter="none"),s.scale(1/t,-1/i);let a;if(e.bitmap)a=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)a=e;else{const c=this.cachedCanvases.getCanvas("inlineImage",t,i).context;I_(c,e),a=this.applyTransferMapsToCanvas(c)}const o=this._scaleImage(a,gl(s));s.imageSmoothingEnabled=T_(Vi(s),e.interpolate),Px(s,o.img,0,0,o.paintWidth,o.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const i=this.ctx;let s;if(e.bitmap)s=e.bitmap;else{const r=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",r,a).context;I_(l,e),s=this.applyTransferMapsToCanvas(l)}for(const r of t)i.save(),i.transform(...r.transform),i.scale(1,-1),Px(i,s,r.x,r.y,r.w,r.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const s=this.ctx;this.pendingClip&&(i||(this.pendingClip===R_?s.clip(e,"evenodd"):s.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Vi(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:s,d:r}=this.ctx.getTransform();let a,o;if(i===0&&s===0){const l=Math.abs(t),c=Math.abs(r);if(l===c)if(e===0)a=o=1/l;else{const h=l*e;a=o=h<1?1/h:1}else if(e===0)a=1/l,o=1/c;else{const h=l*e,u=c*e;a=h<1?1/h:1,o=u<1?1/u:1}}else{const l=Math.abs(t*r-i*s),c=Math.hypot(t,i),h=Math.hypot(s,r);if(e===0)a=h/l,o=c/l;else{const u=e*l;a=h>u?h/u:1,o=c>u?c/u:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:i,current:{lineWidth:s}}=this,[r,a]=this.getScaleForStroking();if(r===a){i.lineWidth=(s||1)*r,i.stroke(e);return}const o=i.getLineDash();t&&i.save(),i.scale(r,a),lw.a=1/r,lw.d=1/a;const l=new Path2D;if(l.addPath(e,lw),o.length>0){const c=Math.max(r,a);i.setLineDash(o.map(h=>h/c)),i.lineDashOffset/=c}i.lineWidth=s||1,i.stroke(l),t&&i.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};al=new WeakSet,S8=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},I8=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},E8=function(e,t,i){const s=new Path2D;return s.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),s};let Yf=zv;for(const n in f3)Yf.prototype[n]!==void 0&&(Yf.prototype[f3[n]]=Yf.prototype[n]);var O2,D2;class ql{static get workerPort(){return b(this,O2)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");N(this,O2,e)}static get workerSrc(){return b(this,D2)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");N(this,D2,e)}}O2=new WeakMap,D2=new WeakMap,B(ql,O2,null),B(ql,D2,"");var C1,L2;class XF{constructor({parsedData:e,rawData:t}){B(this,C1);B(this,L2);N(this,C1,e),N(this,L2,t)}getRaw(){return b(this,L2)}get(e){return b(this,C1).get(e)??null}[Symbol.iterator](){return b(this,C1).entries()}}C1=new WeakMap,L2=new WeakMap;const _f=Symbol("INTERNAL");var F2,B2,U2,A1;class YF{constructor(e,{name:t,intent:i,usage:s,rbGroups:r}){B(this,F2,!1);B(this,B2,!1);B(this,U2,!1);B(this,A1,!0);N(this,F2,!!(e&Da.DISPLAY)),N(this,B2,!!(e&Da.PRINT)),this.name=t,this.intent=i,this.usage=s,this.rbGroups=r}get visible(){if(b(this,U2))return b(this,A1);if(!b(this,A1))return!1;const{print:e,view:t}=this.usage;return b(this,F2)?(t==null?void 0:t.viewState)!=="OFF":b(this,B2)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,i=!1){e!==_f&&gi("Internal method `_setVisible` called."),N(this,U2,i),N(this,A1,t)}}F2=new WeakMap,B2=new WeakMap,U2=new WeakMap,A1=new WeakMap;var K0,ui,S1,I1,H2,T8;class JF{constructor(e,t=Da.DISPLAY){B(this,H2);B(this,K0,null);B(this,ui,new Map);B(this,S1,null);B(this,I1,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,N(this,I1,e.order);for(const i of e.groups)b(this,ui).set(i.id,new YF(t,i));if(e.baseState==="OFF")for(const i of b(this,ui).values())i._setVisible(_f,!1);for(const i of e.on)b(this,ui).get(i)._setVisible(_f,!0);for(const i of e.off)b(this,ui).get(i)._setVisible(_f,!1);N(this,S1,this.getHash())}}isVisible(e){if(b(this,ui).size===0)return!0;if(!e)return K5("Optional content group not defined."),!0;if(e.type==="OCG")return b(this,ui).has(e.id)?b(this,ui).get(e.id).visible:(wn(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return L(this,H2,T8).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!b(this,ui).has(t))return wn(`Optional content group not found: ${t}`),!0;if(b(this,ui).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!b(this,ui).has(t))return wn(`Optional content group not found: ${t}`),!0;if(!b(this,ui).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!b(this,ui).has(t))return wn(`Optional content group not found: ${t}`),!0;if(!b(this,ui).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!b(this,ui).has(t))return wn(`Optional content group not found: ${t}`),!0;if(b(this,ui).get(t).visible)return!1}return!0}return wn(`Unknown optional content policy ${e.policy}.`),!0}return wn(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){var r;const s=b(this,ui).get(e);if(!s){wn(`Optional content group not found: ${e}`);return}if(i&&t&&s.rbGroups.length)for(const a of s.rbGroups)for(const o of a)o!==e&&((r=b(this,ui).get(o))==null||r._setVisible(_f,!1,!0));s._setVisible(_f,!!t,!0),N(this,K0,null)}setOCGState({state:e,preserveRB:t}){let i;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const r=b(this,ui).get(s);if(r)switch(i){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!r.visible,t);break}}N(this,K0,null)}get hasInitialVisibility(){return b(this,S1)===null||this.getHash()===b(this,S1)}getOrder(){return b(this,ui).size?b(this,I1)?b(this,I1).slice():[...b(this,ui).keys()]:null}getGroup(e){return b(this,ui).get(e)||null}getHash(){if(b(this,K0)!==null)return b(this,K0);const e=new xE;for(const[t,i]of b(this,ui))e.update(`${t}:${i.visible}`);return N(this,K0,e.hexdigest())}[Symbol.iterator](){return b(this,ui).entries()}}K0=new WeakMap,ui=new WeakMap,S1=new WeakMap,I1=new WeakMap,H2=new WeakSet,T8=function(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let s=1;s<t;s++){const r=e[s];let a;if(Array.isArray(r))a=L(this,H2,T8).call(this,r);else if(b(this,ui).has(r))a=b(this,ui).get(r).visible;else return wn(`Optional content group not found: ${r}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"};class ZF{constructor(e,{disableRange:t=!1,disableStream:i=!1}){gs(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:r,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(r==null?void 0:r.length)>0){const l=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(i),!0)});gs(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,i,s,r;e.total===void 0?(i=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||i.call(t,{loaded:e.loaded}):(r=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||r.call(s,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){gs(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new QF(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new $F(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeReaders.slice(0))i.cancel(e);this._pdfDataRangeTransport.abort()}}class QF{constructor(e,t,i=!1,s=null){this._stream=e,this._done=i||!1,this._filename=s4(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class $F{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function eB(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let h=o(t);return h=unescape(h),h=l(h),h=c(h),r(h)}if(t=a(n),t){const h=c(t);return r(h)}if(t=i("filename","i").exec(n),t){t=t[1];let h=o(t);return h=c(h),r(h)}function i(h,u){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function s(h,u){if(h){if(!/^[\x00-\xFF]+$/.test(u))return u;try{const d=new TextDecoder(h,{fatal:!0}),f=nx(u);u=d.decode(f),e=!1}catch{}}return u}function r(h){return e&&/[\x80-\xff]/.test(h)&&(h=s("utf-8",h),e&&(h=s("iso-8859-1",h))),h}function a(h){const u=[];let d;const f=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(d=f.exec(h))!==null;){let[,m,x,p]=d;if(m=parseInt(m,10),m in u){if(m===0)break;continue}u[m]=[x,p]}const g=[];for(let m=0;m<u.length&&m in u;++m){let[x,p]=u[m];p=o(p),x&&(p=unescape(p),m===0&&(p=l(p))),g.push(p)}return g.join("")}function o(h){if(h.startsWith('"')){const u=h.slice(1).split('\\"');for(let d=0;d<u.length;++d){const f=u[d].indexOf('"');f!==-1&&(u[d]=u[d].slice(0,f),u.length=d+1),u[d]=u[d].replaceAll(/\\(.)/g,"$1")}h=u.join('"')}return h}function l(h){const u=h.indexOf("'");if(u===-1)return h;const d=h.slice(0,u),g=h.slice(u+1).replace(/^[^']*'/,"");return s(d,g)}function c(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,d,f,g){if(f==="q"||f==="Q")return g=g.replaceAll("_"," "),g=g.replaceAll(/=([0-9a-fA-F]{2})/g,function(m,x){return String.fromCharCode(parseInt(x,16))}),s(d,g);try{g=atob(g)}catch{}return s(d,g)})}return""}function RE(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const s=e[i];s!==void 0&&t.append(i,s)}return t}function Y5(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function ME({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(s.suggestedLength=r,r<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function PE(n){const e=n.get("Content-Disposition");if(e){let t=eB(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(s4(t))return t}return null}function ax(n,e){return new g3(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function NE(n){return n===200||n===206}function OE(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function DE(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(wn(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class tB{constructor(e){ze(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=RE(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return gs(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new nB(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new iB(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class nB{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),s=t.url;fetch(s,OE(i,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=Y5(r.url),!NE(r.status))throw ax(r.status,s);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:o,suggestedLength:l}=ME({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=PE(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Oh("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:DE(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class iB{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${i-1}`);const a=s.url;fetch(a,OE(r,this._withCredentials,this._abortController)).then(o=>{const l=Y5(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!NE(o.status))throw ax(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:DE(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const cw=200,hw=206;function sB(n){const e=n.response;return typeof e!="string"?e:nx(e).buffer}class rB{constructor({url:e,httpHeaders:t,withCredentials:i}){ze(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=RE(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,a]of this.headers)t.setRequestHeader(r,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=hw):s.expectedStatus=cw,t.responseType="arraybuffer",gs(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){var s;const i=this.pendingRequests[e];i&&((s=i.onProgress)==null||s.call(i,t))}onStateChange(e,t){const i=this.pendingRequests[e];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){i.onError(s.status);return}const r=s.status||cw;if(!(r===cw&&i.expectedStatus===hw)&&r!==i.expectedStatus){i.onError(s.status);return}const o=sB(s);if(r===hw){const l=s.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?i.onDone({begin:parseInt(c[1],10),chunk:o}):(wn('Missing or invalid "Content-Range" header.'),i.onError(0))}else o?i.onDone({begin:0,chunk:o}):i.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class aB{constructor(e){this._source=e,this._manager=new rB(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return gs(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new oB(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new lB(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class oB{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Y5(t.responseURL);const i=t.getAllResponseHeaders(),s=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...c]=o.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=ME({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=PE(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=ax(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class lB{constructor(e,t,i){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Y5((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=ax(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const cB=/^[a-z][a-z0-9\-+.]+:/i;function hB(n){if(cB.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class uB{constructor(e){this.source=e,this.url=hB(e.url),gs(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return gs(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new dB(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new fB(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class dB{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=ax(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Oh("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class fB{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const ym=Symbol("INITIAL_DATA");var ka,z2,R8;class LE{constructor(){B(this,z2);B(this,ka,Object.create(null))}get(e,t=null){if(t){const s=L(this,z2,R8).call(this,e);return s.promise.then(()=>t(s.data)),null}const i=b(this,ka)[e];if(!i||i.data===ym)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=b(this,ka)[e];return!!t&&t.data!==ym}delete(e){const t=b(this,ka)[e];return!t||t.data===ym?!1:(delete b(this,ka)[e],!0)}resolve(e,t=null){const i=L(this,z2,R8).call(this,e);i.data=t,i.resolve()}clear(){var e;for(const t in b(this,ka)){const{data:i}=b(this,ka)[t];(e=i==null?void 0:i.bitmap)==null||e.close()}N(this,ka,Object.create(null))}*[Symbol.iterator](){for(const e in b(this,ka)){const{data:t}=b(this,ka)[e];t!==ym&&(yield[e,t])}}}ka=new WeakMap,z2=new WeakSet,R8=function(e){var t;return(t=b(this,ka))[e]||(t[e]={...Promise.withResolvers(),data:ym})};const gB=1e5,M_=30;var xI,X0,ia,j2,G2,Gu,Pc,V2,q2,Vu,E1,T1,Y0,R1,W2,M1,qu,K2,X2,P1,Wu,Y2,J0,N1,y0,FE,BE,M8,qa,S9,P8,UE,HE;const ws=class ws{constructor({textContentSource:e,container:t,viewport:i}){B(this,y0);B(this,X0,Promise.withResolvers());B(this,ia,null);B(this,j2,!1);B(this,G2,!!((xI=globalThis.FontInspector)!=null&&xI.enabled));B(this,Gu,null);B(this,Pc,null);B(this,V2,0);B(this,q2,0);B(this,Vu,null);B(this,E1,null);B(this,T1,0);B(this,Y0,0);B(this,R1,Object.create(null));B(this,W2,[]);B(this,M1,null);B(this,qu,[]);B(this,K2,new WeakMap);B(this,X2,null);var l;if(e instanceof ReadableStream)N(this,M1,e);else if(typeof e=="object")N(this,M1,new ReadableStream({start(c){c.enqueue(e),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');N(this,ia,N(this,E1,t)),N(this,Y0,i.scale*nc.pixelRatio),N(this,T1,i.rotation),N(this,Pc,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:r,pageX:a,pageY:o}=i.rawDims;N(this,X2,[1,0,0,-1,-a,o+r]),N(this,q2,s),N(this,V2,r),L(l=ws,qa,UE).call(l),jd(t,i),b(this,X0).promise.finally(()=>{b(ws,N1).delete(this),N(this,Pc,null),N(this,R1,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=ur.platform;return Hn(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{b(this,Vu).read().then(({value:t,done:i})=>{if(i){b(this,X0).resolve();return}b(this,Gu)??N(this,Gu,t.lang),Object.assign(b(this,R1),t.styles),L(this,y0,FE).call(this,t.items),e()},b(this,X0).reject)};return N(this,Vu,b(this,M1).getReader()),b(ws,N1).add(this),e(),b(this,X0).promise}update({viewport:e,onBefore:t=null}){var r;const i=e.scale*nc.pixelRatio,s=e.rotation;if(s!==b(this,T1)&&(t==null||t(),N(this,T1,s),jd(b(this,E1),{rotation:s})),i!==b(this,Y0)){t==null||t(),N(this,Y0,i);const a={div:null,properties:null,ctx:L(r=ws,qa,S9).call(r,b(this,Gu))};for(const o of b(this,qu))a.properties=b(this,K2).get(o),a.div=o,L(this,y0,M8).call(this,a)}}cancel(){var t;const e=new Oh("TextLayer task cancelled.");(t=b(this,Vu))==null||t.cancel(e).catch(()=>{}),N(this,Vu,null),b(this,X0).reject(e)}get textDivs(){return b(this,qu)}get textContentItemsStr(){return b(this,W2)}static cleanup(){if(!(b(this,N1).size>0)){b(this,P1).clear();for(const{canvas:e}of b(this,Wu).values())e.remove();b(this,Wu).clear()}}};X0=new WeakMap,ia=new WeakMap,j2=new WeakMap,G2=new WeakMap,Gu=new WeakMap,Pc=new WeakMap,V2=new WeakMap,q2=new WeakMap,Vu=new WeakMap,E1=new WeakMap,T1=new WeakMap,Y0=new WeakMap,R1=new WeakMap,W2=new WeakMap,M1=new WeakMap,qu=new WeakMap,K2=new WeakMap,X2=new WeakMap,P1=new WeakMap,Wu=new WeakMap,Y2=new WeakMap,J0=new WeakMap,N1=new WeakMap,y0=new WeakSet,FE=function(e){var s,r;if(b(this,j2))return;(r=b(this,Pc)).ctx??(r.ctx=L(s=ws,qa,S9).call(s,b(this,Gu)));const t=b(this,qu),i=b(this,W2);for(const a of e){if(t.length>gB){wn("Ignoring additional textDivs for performance reasons."),N(this,j2,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=b(this,ia);N(this,ia,document.createElement("span")),b(this,ia).classList.add("markedContent"),a.id!==null&&b(this,ia).setAttribute("id",`${a.id}`),o.append(b(this,ia))}else a.type==="endMarkedContent"&&N(this,ia,b(this,ia).parentNode);continue}i.push(a.str),L(this,y0,BE).call(this,a)}},BE=function(e){var m;const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};b(this,qu).push(t);const s=en.transform(b(this,X2),e.transform);let r=Math.atan2(s[1],s[0]);const a=b(this,R1)[e.fontName];a.vertical&&(r+=Math.PI/2);let o=b(this,G2)&&a.fontSubstitution||a.fontFamily;o=ws.fontFamilyMap.get(o)||o;const l=Math.hypot(s[2],s[3]),c=l*L(m=ws,qa,HE).call(m,o,a,b(this,Gu));let h,u;r===0?(h=s[4],u=s[5]-c):(h=s[4]+c*Math.sin(r),u=s[5]-c*Math.cos(r));const d="calc(var(--total-scale-factor) *",f=t.style;b(this,ia)===b(this,E1)?(f.left=`${(100*h/b(this,q2)).toFixed(2)}%`,f.top=`${(100*u/b(this,V2)).toFixed(2)}%`):(f.left=`${d}${h.toFixed(2)}px)`,f.top=`${d}${u.toFixed(2)}px)`),f.fontSize=`${d}${(b(ws,J0)*l).toFixed(2)}px)`,f.fontFamily=o,i.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,b(this,G2)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(i.angle=r*(180/Math.PI));let g=!1;if(e.str.length>1)g=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const x=Math.abs(e.transform[0]),p=Math.abs(e.transform[3]);x!==p&&Math.max(x,p)/Math.min(x,p)>1.5&&(g=!0)}if(g&&(i.canvasWidth=a.vertical?e.height:e.width),b(this,K2).set(t,i),b(this,Pc).div=t,b(this,Pc).properties=i,L(this,y0,M8).call(this,b(this,Pc)),i.hasText&&b(this,ia).append(t),i.hasEOL){const x=document.createElement("br");x.setAttribute("role","presentation"),b(this,ia).append(x)}},M8=function(e){var o;const{div:t,properties:i,ctx:s}=e,{style:r}=t;let a="";if(b(ws,J0)>1&&(a=`scale(${1/b(ws,J0)})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:l}=r,{canvasWidth:c,fontSize:h}=i;L(o=ws,qa,P8).call(o,s,h*b(this,Y0),l);const{width:u}=s.measureText(t.textContent);u>0&&(a=`scaleX(${c*b(this,Y0)/u}) ${a}`)}i.angle!==0&&(a=`rotate(${i.angle}deg) ${a}`),a.length>0&&(r.transform=a)},qa=new WeakSet,S9=function(e=null){let t=b(this,Wu).get(e||(e=""));if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),b(this,Wu).set(e,t),b(this,Y2).set(t,{size:0,family:""})}return t},P8=function(e,t,i){const s=b(this,Y2).get(e);t===s.size&&i===s.family||(e.font=`${t}px ${i}`,s.size=t,s.family=i)},UE=function(){if(b(this,J0)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),N(this,J0,e.getBoundingClientRect().height),e.remove()},HE=function(e,t,i){const s=b(this,P1).get(e);if(s)return s;const r=L(this,qa,S9).call(this,i);r.canvas.width=r.canvas.height=M_,L(this,qa,P8).call(this,r,M_,e);const a=r.measureText(""),o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let c=.8;return o?c=o/(o+l):(ur.platform.isFirefox&&wn("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?c=t.ascent:t.descent&&(c=1+t.descent)),b(this,P1).set(e,c),c},B(ws,qa),B(ws,P1,new Map),B(ws,Wu,new Map),B(ws,Y2,new WeakMap),B(ws,J0,null),B(ws,N1,new Set);let Rp=ws;class Mp{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function s(r){var l;if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(Mp.shouldBuildText(o))(l=r==null?void 0:r.attributes)!=null&&l.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const c of r.children)s(c)}return s(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const mB=100;function pB(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new N8,{docId:t}=e,i=n.url?CF(n.url):null,s=n.data?AF(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof zE?n.range:null,c=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let h=n.worker instanceof Pp?n.worker:null;const u=n.verbosity,d=typeof n.docBaseUrl=="string"&&!X5(n.docBaseUrl)?n.docBaseUrl:null,f=Rx(n.cMapUrl),g=n.cMapPacked!==!1,m=n.CMapReaderFactory||(Br?NF:y_),x=Rx(n.iccUrl),p=Rx(n.standardFontDataUrl),y=n.StandardFontDataFactory||(Br?OF:w_),w=Rx(n.wasmUrl),v=n.WasmFactory||(Br?DF:v_),_=n.stopAtErrors!==!0,C=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,k=n.isEvalSupported!==!1,I=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Br,S=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Br&&(ur.platform.isFirefox||!globalThis.chrome),R=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,P=typeof n.disableFontFace=="boolean"?n.disableFontFace:Br,D=n.fontExtraProperties===!0,U=n.enableXfa===!0,T=n.ownerDocument||globalThis.document,G=n.disableRange===!0,M=n.disableStream===!0,F=n.disableAutoFetch===!0,X=n.pdfBug===!0,z=n.CanvasFactory||(Br?PF:TF),K=n.FilterFactory||(Br?MF:RF),j=n.enableHWA===!0,ae=n.useWasm!==!1,ge=l?l.length:n.length??NaN,ue=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Br&&!P,pe=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(m===y_&&y===w_&&v===v_&&f&&p&&w&&Bm(f,document.baseURI)&&Bm(p,document.baseURI)&&Bm(w,document.baseURI)),de=null;nF(u);const O={canvasFactory:new z({ownerDocument:T,enableHWA:j}),filterFactory:new K({docId:t,ownerDocument:T}),cMapReaderFactory:pe?null:new m({baseUrl:f,isCompressed:g}),standardFontDataFactory:pe?null:new y({baseUrl:p}),wasmFactory:pe?null:new v({baseUrl:w})};h||(h=Pp.create({verbosity:u,port:ql.workerPort}),e._worker=h);const Y={docId:t,apiVersion:"5.3.93",data:s,password:o,disableAutoFetch:F,rangeChunkSize:c,length:ge,docBaseUrl:d,enableXfa:U,evaluatorOptions:{maxImageSize:C,disableFontFace:P,ignoreErrors:_,isEvalSupported:k,isOffscreenCanvasSupported:I,isImageDecoderSupported:S,canvasMaxAreaInBytes:R,fontExtraProperties:D,useSystemFonts:ue,useWasm:ae,useWorkerFetch:pe,cMapUrl:f,iccUrl:x,standardFontDataUrl:p,wasmUrl:w}},le={ownerDocument:T,pdfBug:X,styleElement:de,loadingParams:{disableAutoFetch:F,enableXfa:U}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const $=h.messageHandler.sendWithPromise("GetDocRequest",Y,s?[s.buffer]:null);let re;if(l)re=new ZF(l,{disableRange:G,disableStream:M});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");const oe=Bm(i)?tB:Br?uB:aB;re=new oe({url:i,length:ge,httpHeaders:r,withCredentials:a,rangeChunkSize:c,disableRange:G,disableStream:M})}return $.then(oe=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const ee=new Gm(t,oe,h.port),Q=new yB(ee,e,re,le,O);e._transport=Q,ee.send("Ready",null)})}).catch(e._capability.reject),e}var x5;const y5=class y5{constructor(){ze(this,"_capability",Promise.withResolvers());ze(this,"_transport",null);ze(this,"_worker",null);ze(this,"docId",`d${Rr(y5,x5)._++}`);ze(this,"destroyed",!1);ze(this,"onPassword",null);ze(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,i,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,r}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}async getData(){return this._transport.getData()}};x5=new WeakMap,B(y5,x5,0);let N8=y5;var Ku,J2,Z2,Q2,$2;class zE{constructor(e,t,i=!1,s=null){B(this,Ku,Promise.withResolvers());B(this,J2,[]);B(this,Z2,[]);B(this,Q2,[]);B(this,$2,[]);this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=s}addRangeListener(e){b(this,$2).push(e)}addProgressListener(e){b(this,Q2).push(e)}addProgressiveReadListener(e){b(this,Z2).push(e)}addProgressiveDoneListener(e){b(this,J2).push(e)}onDataRange(e,t){for(const i of b(this,$2))i(e,t)}onDataProgress(e,t){b(this,Ku).promise.then(()=>{for(const i of b(this,Q2))i(e,t)})}onDataProgressiveRead(e){b(this,Ku).promise.then(()=>{for(const t of b(this,Z2))t(e)})}onDataProgressiveDone(){b(this,Ku).promise.then(()=>{for(const e of b(this,J2))e()})}transportReady(){b(this,Ku).resolve()}requestDataRange(e,t){gi("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}Ku=new WeakMap,J2=new WeakMap,Z2=new WeakMap,Q2=new WeakMap,$2=new WeakMap;class bB{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Hn(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Nc,Xu,Xm;class xB{constructor(e,t,i,s=!1){B(this,Xu);B(this,Nc,!1);this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=s?new p_:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new LE,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:r=!1}={}){return new sx({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Hn(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:i="display",annotationMode:s=T0.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:h=null,isEditing:u=!1}){var v,_;(v=this._stats)==null||v.time("Overall");const d=this._transport.getRenderingIntent(i,s,h,u),{renderingIntent:f,cacheKey:g}=d;N(this,Nc,!1),o||(o=this._transport.getOptionalContentConfig(f));let m=this._intentStates.get(g);m||(m=Object.create(null),this._intentStates.set(g,m)),m.streamReaderCancelTimeout&&(clearTimeout(m.streamReaderCancelTimeout),m.streamReaderCancelTimeout=null);const x=!!(f&Da.PRINT);m.displayReadyCapability||(m.displayReadyCapability=Promise.withResolvers(),m.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(_=this._stats)==null||_.time("Page Request"),this._pumpOperatorList(d));const p=C=>{var k;m.renderTasks.delete(y),x&&N(this,Nc,!0),L(this,Xu,Xm).call(this),C?(y.capability.reject(C),this._abortOperatorList({intentState:m,reason:C instanceof Error?C:new Error(C)})):y.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(k=globalThis.Stats)!=null&&k.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},y=new O8({callback:p,params:{canvasContext:e,viewport:t,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:m.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!x,pdfBug:this._pdfBug,pageColors:c});(m.renderTasks||(m.renderTasks=new Set)).add(y);const w=y.task;return Promise.all([m.displayReadyCapability.promise,o]).then(([C,k])=>{var I;if(this.destroyed){p();return}if((I=this._stats)==null||I.time("Rendering"),!(k.renderingIntent&f))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");y.initializeGraphics({transparency:C,optionalContentConfig:k}),y.operatorListChanged()}).catch(p),w}getOperatorList({intent:e="display",annotationMode:t=T0.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){var c;function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,i,s,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Mp.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,s){function r(){a.read().then(function({value:l,done:c}){if(c){i(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),r()},s)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),N(this,Nc,!1),Promise.all(e)}cleanup(e=!1){N(this,Nc,!0);const t=L(this,Xu,Xm).call(this);return e&&t&&this._stats&&(this._stats=new p_),t}_startRenderPage(e,t){var s,r;const i=this._intentStates.get(t);i&&((s=this._stats)==null||s.timeEnd("Page Request"),(r=i.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let i=0,s=e.length;i<s;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&L(this,Xu,Xm).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:s}){const{map:r,transfer:a}=i,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:s},a).getReader(),c=this._intentStates.get(t);c.streamReader=l;const h=()=>{l.read().then(({value:u,done:d})=>{if(d){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(u,c),h())},u=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const d of c.renderTasks)d.operatorListChanged();L(this,Xu,Xm).call(this)}if(c.displayReadyCapability)c.displayReadyCapability.reject(u);else if(c.opListReadCapability)c.opListReadCapability.reject(u);else throw u}})};h()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof i4){let s=mB;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new Oh(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,r]of this._intentStates)if(r===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}Nc=new WeakMap,Xu=new WeakSet,Xm=function(){if(!b(this,Nc)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),N(this,Nc,!1),!0};var Z0,Oo,Oc,Yu,w5,Ju,Zu,qr,I9,jE,GE,Ym,O1,E9;const Ei=class Ei{constructor({name:e=null,port:t=null,verbosity:i=iF()}={}){B(this,qr);B(this,Z0,Promise.withResolvers());B(this,Oo,null);B(this,Oc,null);B(this,Yu,null);if(this.name=e,this.destroyed=!1,this.verbosity=i,t){if(b(Ei,Zu).has(t))throw new Error("Cannot use more than one PDFWorker per port.");b(Ei,Zu).set(t,this),L(this,qr,jE).call(this,t)}else L(this,qr,GE).call(this)}get promise(){return b(this,Z0).promise}get port(){return b(this,Oc)}get messageHandler(){return b(this,Oo)}destroy(){var e,t;this.destroyed=!0,(e=b(this,Yu))==null||e.terminate(),N(this,Yu,null),b(Ei,Zu).delete(b(this,Oc)),N(this,Oc,null),(t=b(this,Oo))==null||t.destroy(),N(this,Oo,null)}static create(e){const t=b(this,Zu).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Ei(e)}static get workerSrc(){if(ql.workerSrc)return ql.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Hn(this,"_setupFakeWorkerGlobal",(async()=>b(this,O1,E9)?b(this,O1,E9):(await import(this.workerSrc)).WorkerMessageHandler)())}};Z0=new WeakMap,Oo=new WeakMap,Oc=new WeakMap,Yu=new WeakMap,w5=new WeakMap,Ju=new WeakMap,Zu=new WeakMap,qr=new WeakSet,I9=function(){b(this,Z0).resolve(),b(this,Oo).send("configure",{verbosity:this.verbosity})},jE=function(e){N(this,Oc,e),N(this,Oo,new Gm("main","worker",e)),b(this,Oo).on("ready",()=>{}),L(this,qr,I9).call(this)},GE=function(){if(b(Ei,Ju)||b(Ei,O1,E9)){L(this,qr,Ym).call(this);return}let{workerSrc:e}=Ei;try{Ei._isSameOrigin(window.location,e)||(e=Ei._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new Gm("main","worker",t),s=()=>{r.abort(),i.destroy(),t.terminate(),this.destroyed?b(this,Z0).reject(new Error("Worker was destroyed")):L(this,qr,Ym).call(this)},r=new AbortController;t.addEventListener("error",()=>{b(this,Yu)||s()},{signal:r.signal}),i.on("test",o=>{if(r.abort(),this.destroyed||!o){s();return}N(this,Oo,i),N(this,Oc,t),N(this,Yu,t),L(this,qr,I9).call(this)}),i.on("ready",o=>{if(r.abort(),this.destroyed){s();return}try{a()}catch{L(this,qr,Ym).call(this)}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{K5("The worker has been disabled.")}L(this,qr,Ym).call(this)},Ym=function(){b(Ei,Ju)||(wn("Setting up fake worker."),N(Ei,Ju,!0)),Ei._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){b(this,Z0).reject(new Error("Worker was destroyed"));return}const t=new EF;N(this,Oc,t);const i=`fake${Rr(Ei,w5)._++}`,s=new Gm(i+"_worker",i,t);e.setup(s,t),N(this,Oo,new Gm(i,i+"_worker",t)),L(this,qr,I9).call(this)}).catch(e=>{b(this,Z0).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},O1=new WeakSet,E9=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},B(Ei,O1),B(Ei,w5,0),B(Ei,Ju,!1),B(Ei,Zu,new WeakMap),Br&&(N(Ei,Ju,!0),ql.workerSrc||(ql.workerSrc="./pdf.worker.mjs")),Ei._isSameOrigin=(e,t)=>{const i=URL.parse(e);if(!(i!=null&&i.origin)||i.origin==="null")return!1;const s=new URL(t,i);return i.origin===s.origin},Ei._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Ei.fromPort=e=>{if(mF("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Ei.create(e)};let Pp=Ei;var Dc,Ol,D1,L1,Lc,Qu,Jm;class yB{constructor(e,t,i,s,r){B(this,Qu);B(this,Dc,new Map);B(this,Ol,new Map);B(this,D1,new Map);B(this,L1,new Map);B(this,Lc,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new LE,this.fontLoader=new _F({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Hn(this,"annotationStorage",new o4)}getRenderingIntent(e,t=T0.ENABLE,i=null,s=!1,r=!1){let a=Da.DISPLAY,o=w8;switch(e){case"any":a=Da.ANY;break;case"display":break;case"print":a=Da.PRINT;break;default:wn(`getRenderingIntent - invalid intent: ${e}`)}const l=a&Da.PRINT&&i instanceof wE?i:this.annotationStorage;switch(t){case T0.DISABLE:a+=Da.ANNOTATIONS_DISABLE;break;case T0.ENABLE:break;case T0.ENABLE_FORMS:a+=Da.ANNOTATIONS_FORMS;break;case T0.ENABLE_STORAGE:a+=Da.ANNOTATIONS_STORAGE,o=l.serializable;break;default:wn(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(a+=Da.IS_EDITING),r&&(a+=Da.OPLIST);const{ids:c,hash:h}=l.modifiedIds,u=[a,o.hash,h];return{renderingIntent:a,cacheKey:u.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=b(this,Lc))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of b(this,Ol).values())e.push(s._destroy());b(this,Ol).clear(),b(this,D1).clear(),b(this,L1).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var s,r;this.commonObjs.clear(),this.fontLoader.clear(),b(this,Dc).clear(),this.filterFactory.destroy(),Rp.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new Oh("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,s)=>{gs(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},s.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){s.close();return}gs(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{s.error(r)})},s.onCancel=r=>{this._fullReader.cancel(r),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async i=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:r,contentLength:a}=this._fullReader;return(!s||!r)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var c;(c=t.onProgress)==null||c.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:s,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(i,s)=>{gs(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(i.begin,i.end);if(!r){s.close();return}s.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){s.close();return}gs(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{r.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new bB(i,this))}),e.on("DocException",i=>{t._capability.reject(ea(i))}),e.on("PasswordRequest",i=>{N(this,Lc,Promise.withResolvers());try{if(!t.onPassword)throw ea(i);const s=r=>{r instanceof Error?b(this,Lc).reject(r):b(this,Lc).resolve({password:r})};t.onPassword(s,i.code)}catch(s){b(this,Lc).reject(s)}return b(this,Lc).promise}),e.on("DataLoaded",i=>{var s;(s=t.onProgress)==null||s.call(t,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;b(this,Ol).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,s,r])=>{var a;if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":if("error"in r){const h=r.error;wn(`Error during font loading: ${h}`),this.commonObjs.resolve(i,h);break}const o=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(h,u)=>globalThis.FontInspector.fontAdded(h,u):null,l=new kF(r,o);this.fontLoader.bind(l).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!l.fontExtraProperties&&l.data&&(l.data=null),this.commonObjs.resolve(i,l)});break;case"CopyLocalImage":const{imageRef:c}=r;gs(c,"The imageRef must be defined.");for(const h of b(this,Ol).values())for(const[,u]of h.objs)if((u==null?void 0:u.ref)===c)return u.dataLen?(this.commonObjs.resolve(i,structuredClone(u)),u.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,r);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([i,s,r,a])=>{var l;if(this.destroyed)return;const o=b(this,Ol).get(s);if(!o.objs.has(i)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(r){case"Image":case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",i=>{var s;this.destroyed||(s=t.onProgress)==null||s.call(t,{loaded:i.loaded,total:i.total})}),e.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[i.type];if(!s)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&wn("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((i=this._fullReader)==null?void 0:i.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=b(this,D1).get(t);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&b(this,L1).set(r.refStr,e);const a=new xB(t,r,this,this._params.pdfBug);return b(this,Ol).set(t,a),a});return b(this,D1).set(t,s),s}getPageIndex(e){return v8(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return L(this,Qu,Jm).call(this,"GetFieldObjects")}hasJSActions(){return L(this,Qu,Jm).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return L(this,Qu,Jm).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return L(this,Qu,Jm).call(this,"GetOptionalContentConfig").then(t=>new JF(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=b(this,Dc).get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(s=>{var r,a;return{info:s[0],metadata:s[1]?new XF(s[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return b(this,Dc).set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of b(this,Ol).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),b(this,Dc).clear(),this.filterFactory.destroy(!0),Rp.cleanup()}}cachedPageNumber(e){if(!v8(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return b(this,L1).get(t)??null}}Dc=new WeakMap,Ol=new WeakMap,D1=new WeakMap,L1=new WeakMap,Lc=new WeakMap,Qu=new WeakSet,Jm=function(e,t=null){const i=b(this,Dc).get(e);if(i)return i;const s=this.messageHandler.sendWithPromise(e,t);return b(this,Dc).set(e,s),s};var Q0;class wB{constructor(e){B(this,Q0,null);ze(this,"onContinue",null);ze(this,"onError",null);N(this,Q0,e)}get promise(){return b(this,Q0).capability.promise}cancel(e=0){b(this,Q0).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=b(this,Q0).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=b(this,Q0);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Q0=new WeakMap;var $0,$u;const gu=class gu{constructor({callback:e,params:t,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:h=!1,pdfBug:u=!1,pageColors:d=null}){B(this,$0,null);this.callback=e,this.params=t,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=u,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new wB(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,l;if(this.cancelled)return;if(this._canvas){if(b(gu,$u).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");b(gu,$u).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:r,background:a}=this.params;this.gfx=new Yf(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:s,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(e=null,t=0){var i,s,r;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),b(this,$0)&&(window.cancelAnimationFrame(b(this,$0)),N(this,$0,null)),b(gu,$u).delete(this._canvas),e||(e=new i4(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(r=(s=this.task).onError)==null||r.call(s,e)}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?N(this,$0,window.requestAnimationFrame(()=>{N(this,$0,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),b(gu,$u).delete(this._canvas),this.callback())))}};$0=new WeakMap,$u=new WeakMap,B(gu,$u,new WeakSet);let O8=gu;const vB="5.3.93",_B="cbeef3233";function P_(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function wm(n){return Math.max(0,Math.min(255,255*n))}class N_{static CMYK_G([e,t,i,s]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=wm(e),[e,e,e]}static G_HTML([e]){const t=P_(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(wm)}static RGB_HTML(e){return`#${e.map(P_).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,i+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,i,s]){return[wm(1-Math.min(1,e+s)),wm(1-Math.min(1,i+s)),wm(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const s=1-e,r=1-t,a=1-i,o=Math.min(s,r,a);return["CMYK",s,r,a,o]}}class kB{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){gi("Abstract method `_createSVG` called.")}}class b3 extends kB{_createSVG(e){return document.createElementNS(hc,e)}}class VE{static setupStorage(e,t,i,s,r){const a=s.getValue(t,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?e.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",o=>{s.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:s,linkService:r}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${s}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}o&&r.addLinkAttributes(e,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(e,a.dataId,t,i)}static render(e){var u,d;const t=e.annotationStorage,i=e.linkService,s=e.xfaHtml,r=e.intent||"display",a=document.createElement(s.name);s.attributes&&this.setAttributes({html:a,element:s,intent:r,linkService:i});const o=r!=="richText",l=e.div;if(l.append(a),e.viewport){const f=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=f}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(s.children.length===0){if(s.value){const f=document.createTextNode(s.value);a.append(f),o&&Mp.shouldBuildText(s.name)&&c.push(f)}return{textDivs:c}}const h=[[s,-1,a]];for(;h.length>0;){const[f,g,m]=h.at(-1);if(g+1===f.children.length){h.pop();continue}const x=f.children[++h.at(-1)[1]];if(x===null)continue;const{name:p}=x;if(p==="#text"){const w=document.createTextNode(x.value);c.push(w),m.append(w);continue}const y=(u=x==null?void 0:x.attributes)!=null&&u.xmlns?document.createElementNS(x.attributes.xmlns,p):document.createElement(p);if(m.append(y),x.attributes&&this.setAttributes({html:y,element:x,storage:t,intent:r,linkService:i}),((d=x.children)==null?void 0:d.length)>0)h.push([x,-1,y]);else if(x.value){const w=document.createTextNode(x.value);o&&Mp.shouldBuildText(p)&&c.push(w),y.append(w)}}for(const f of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const CB=9,Vd=new WeakSet;class O_{static create(e){switch(e.data.annotationType){case us.LINK:return new qE(e);case us.TEXT:return new AB(e);case us.WIDGET:switch(e.data.fieldType){case"Tx":return new SB(e);case"Btn":return e.data.radioButton?new XE(e):e.data.checkBox?new EB(e):new TB(e);case"Ch":return new RB(e);case"Sig":return new IB(e)}return new rf(e);case us.POPUP:return new L8(e);case us.FREETEXT:return new $E(e);case us.LINE:return new PB(e);case us.SQUARE:return new NB(e);case us.CIRCLE:return new OB(e);case us.POLYLINE:return new eT(e);case us.CARET:return new LB(e);case us.INK:return new h4(e);case us.POLYGON:return new DB(e);case us.HIGHLIGHT:return new tT(e);case us.UNDERLINE:return new FB(e);case us.SQUIGGLY:return new BB(e);case us.STRIKEOUT:return new UB(e);case us.STAMP:return new nT(e);case us.FILEATTACHMENT:return new HB(e);default:return new rs(e)}}}var ed,F1,B1,eb,D8;const jv=class jv{constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){B(this,eb);B(this,ed,null);B(this,F1,!1);B(this,B1,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return jv._hasPopupData(this.data)}updateEdited(e){var i;if(!this.container)return;b(this,ed)||N(this,ed,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&L(this,eb,D8).call(this,t),(i=b(this,B1))==null||i.popup.updateEdited(e)}resetEdited(){var e;b(this,ed)&&(L(this,eb,D8).call(this,b(this,ed).rect),(e=b(this,B1))==null||e.popup.resetEdited(),N(this,ed,null))}_createContainer(e){const{data:t,parent:{page:i,viewport:s}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof rf||(r.tabIndex=0);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof L8){const{rotation:m}=t;return!t.hasOwnCanvas&&m!==0&&this.setRotation(m,r),r}const{width:o,height:l}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const m=t.borderStyle.horizontalCornerRadius,x=t.borderStyle.verticalCornerRadius;if(m>0||x>0){const y=`calc(${m}px * var(--total-scale-factor)) / calc(${x}px * var(--total-scale-factor))`;a.borderRadius=y}else if(this instanceof XE){const y=`calc(${o}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;a.borderRadius=y}switch(t.borderStyle.style){case xf.SOLID:a.borderStyle="solid";break;case xf.DASHED:a.borderStyle="dashed";break;case xf.BEVELED:wn("Unimplemented border style: beveled");break;case xf.INSET:wn("Unimplemented border style: inset");break;case xf.UNDERLINE:a.borderBottomStyle="solid";break}const p=t.borderColor||null;p?(N(this,F1,!0),a.borderColor=en.makeHexColor(p[0]|0,p[1]|0,p[2]|0)):a.borderWidth=0}const c=en.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:h,pageHeight:u,pageX:d,pageY:f}=s.rawDims;a.left=`${100*(c[0]-d)/h}%`,a.top=`${100*(c[1]-f)/u}%`;const{rotation:g}=t;return t.hasOwnCanvas||g===0?(a.width=`${100*o/h}%`,a.height=`${100*l/u}%`):this.setRotation(g,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims;let{width:r,height:a}=this;e%180!==0&&([r,a]=[a,r]),t.style.width=`${100*r/i}%`,t.style.height=`${100*a/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,s)=>{const r=s.detail[t],a=r[0],o=r.slice(1);s.target.style[i]=N_[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:N_[`${a}_rgb`](o)})};return Hn(this,"_commonActions",{display:t=>{const{display:i}=t.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const s of Object.keys(t.detail)){const r=e[s]||i[s];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[s,r]of Object.entries(t)){const a=i[s];if(a){const o={detail:{[s]:r},target:e};a(o),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,s,r]=this.data.rect.map(m=>Math.fround(m));if(e.length===8){const[m,x,p,y]=e.subarray(2,6);if(s===m&&r===x&&t===p&&i===y)return}const{style:a}=this.container;let o;if(b(this,F1)){const{borderColor:m,borderWidth:x}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${m}" stroke-width="${x}">`],this.container.classList.add("hasBorder")}const l=s-t,c=r-i,{svgFactory:h}=this,u=h.createElement("svg");u.classList.add("quadrilateralsContainer"),u.setAttribute("width",0),u.setAttribute("height",0),u.role="none";const d=h.createElement("defs");u.append(d);const f=h.createElement("clipPath"),g=`clippath_${this.data.id}`;f.setAttribute("id",g),f.setAttribute("clipPathUnits","objectBoundingBox"),d.append(f);for(let m=2,x=e.length;m<x;m+=8){const p=e[m],y=e[m+1],w=e[m+2],v=e[m+3],_=h.createElement("rect"),C=(w-t)/l,k=(r-y)/c,I=(p-w)/l,S=(y-v)/c;_.setAttribute("x",C),_.setAttribute("y",k),_.setAttribute("width",I),_.setAttribute("height",S),f.append(_),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${C}" y="${k}" width="${I}" height="${S}"/>`)}b(this,F1)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(u),this.container.style.clipPath=`url(#${g})`}_createPopup(){const{data:e}=this,t=N(this,B1,new L8({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){gi("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:r,id:a,exportValues:o}of s){if(r===-1||a===t)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!Vd.has(c)){wn(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:l,domElement:c})}return i}for(const s of document.getElementsByName(e)){const{exportValue:r}=s,a=s.getAttribute("data-element-id");a!==t&&Vd.has(s)&&i.push({id:a,exportValue:r,domElement:s})}return i}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};ed=new WeakMap,F1=new WeakMap,B1=new WeakMap,eb=new WeakSet,D8=function(e){const{container:{style:t},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}}}=this;i==null||i.splice(0,4,...e),t.left=`${100*(e[0]-o)/r}%`,t.top=`${100*(a-e[3]+l)/a}%`,s===0?(t.width=`${100*(e[2]-e[0])/r}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(s)};let rs=jv;var za,nu,WE,KE;class qE extends rs{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});B(this,za);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action),r=!0):t.attachment?(L(this,za,WE).call(this,s,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(L(this,za,KE).call(this,s,t.setOCGState),r=!0):t.dest?(this._bindLink(s,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(s),this.container}_bindLink(t,i){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&L(this,za,nu).call(this)}_bindNamedAction(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),L(this,za,nu).call(this)}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const a=s.get(r);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),L(this,za,nu).call(this)}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),L(this,za,nu).call(this),!this._fieldObjects){wn('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{var u;s==null||s();const{fields:r,refs:a,include:o}=i,l=[];if(r.length!==0||a.length!==0){const d=new Set(a);for(const f of r){const g=this._fieldObjects[f]||[];for(const{id:m}of g)d.add(m)}for(const f of Object.values(this._fieldObjects))for(const g of f)d.has(g.id)===o&&l.push(g)}else for(const d of Object.values(this._fieldObjects))l.push(...d);const c=this.annotationStorage,h=[];for(const d of l){const{id:f}=d;switch(h.push(f),d.type){case"text":{const m=d.defaultValue||"";c.setValue(f,{value:m});break}case"checkbox":case"radiobutton":{const m=d.defaultValue===d.exportValues;c.setValue(f,{value:m});break}case"combobox":case"listbox":{const m=d.defaultValue||"";c.setValue(f,{value:m});break}default:continue}const g=document.querySelector(`[data-element-id="${f}"]`);if(g){if(!Vd.has(g)){wn(`_bindResetFormAction - element not allowed: ${f}`);continue}}else continue;g.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((u=this.linkService.eventBus)==null||u.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}za=new WeakSet,nu=function(){this.container.setAttribute("data-internal-link","")},WE=function(t,i,s=null){t.href=this.linkService.getAnchorUrl(""),i.description&&(t.title=i.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(i.content,i.filename,s),!1},L(this,za,nu).call(this)},KE=function(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),L(this,za,nu).call(this)};class AB extends rs{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class rf extends rs{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return ur.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,s,r){i.includes("mouse")?e.addEventListener(i,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(i,a=>{var o;if(i==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a)}}))})}_setEventListeners(e,t,i,s){var r,a,o;for(const[l,c]of i)(c==="Action"||(r=this.data.actions)!=null&&r[c])&&((c==="Focus"||c==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,c,s),c==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":en.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||CB,r=e.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(c/(iw*s))||1,u=c/h;a=Math.min(s,l(u/iw))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(s,l(c/iw))}r.fontSize=`calc(${a}px * var(--total-scale-factor))`,r.color=en.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class SB extends rf{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,s){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=i),r.setValue(a.id,{[s]:i})}render(){var s,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=a.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=c??o,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",c??o),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Vd.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const u=this.data.dateFormat||this.data.timeFormat;u&&(i.title=u),this._setRequired(i,this.data.required),l&&(i.maxLength=l),i.addEventListener("input",f=>{e.setValue(t,{value:f.target.value}),this.setPropertyOnSiblings(i,"value",f.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",f=>{const g=this.data.defaultFieldValue??"";i.value=h.userValue=g,h.formattedValue=null});let d=f=>{const{formattedValue:g}=h;g!=null&&(f.target.value=g),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",g=>{var x;if(h.focused)return;const{target:m}=g;h.userValue&&(m.value=h.userValue),h.lastCommittedValue=m.value,h.commitKey=1,(x=this.data.actions)!=null&&x.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",g=>{this.showElementAndHideCanvas(g.target);const m={value(x){h.userValue=x.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),x.target.value=h.userValue},formattedValue(x){const{formattedValue:p}=x.detail;h.formattedValue=p,p!=null&&x.target!==document.activeElement&&(x.target.value=p),e.setValue(t,{formattedValue:p})},selRange(x){x.target.setSelectionRange(...x.detail.selRange)},charLimit:x=>{var v;const{charLimit:p}=x.detail,{target:y}=x;if(p===0){y.removeAttribute("maxLength");return}y.setAttribute("maxLength",p);let w=h.userValue;!w||w.length<=p||(w=w.slice(0,p),y.value=h.userValue=w,e.setValue(t,{value:w}),(v=this.linkService.eventBus)==null||v.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:1,selStart:y.selectionStart,selEnd:y.selectionEnd}}))}};this._dispatchEventFromSandbox(m,g)}),i.addEventListener("keydown",g=>{var p;h.commitKey=1;let m=-1;if(g.key==="Escape"?m=0:g.key==="Enter"&&!this.data.multiLine?m=2:g.key==="Tab"&&(h.commitKey=3),m===-1)return;const{value:x}=g.target;h.lastCommittedValue!==x&&(h.lastCommittedValue=x,h.userValue=x,(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:m,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}))});const f=d;d=null,i.addEventListener("blur",g=>{var x,p;if(!h.focused||!g.relatedTarget)return;(x=this.data.actions)!=null&&x.Blur||(h.focused=!1);const{value:m}=g.target;h.userValue=m,h.lastCommittedValue!==m&&((p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:m,willCommit:!0,commitKey:h.commitKey,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}})),f(g)}),(r=this.data.actions)!=null&&r.Keystroke&&i.addEventListener("beforeinput",g=>{var C;h.lastCommittedValue=null;const{data:m,target:x}=g,{value:p,selectionStart:y,selectionEnd:w}=x;let v=y,_=w;switch(g.inputType){case"deleteWordBackward":{const k=p.substring(0,y).match(/\w*[^\w]*$/);k&&(v-=k[0].length);break}case"deleteWordForward":{const k=p.substring(y).match(/^[^\w]*\w*/);k&&(_+=k[0].length);break}case"deleteContentBackward":y===w&&(v-=1);break;case"deleteContentForward":y===w&&(_+=1);break}g.preventDefault(),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:p,change:m||"",willCommit:!1,selStart:v,selEnd:_}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],g=>g.target.value)}if(d&&i.addEventListener("blur",d),this.data.comb){const g=(this.data.rect[2]-this.data.rect[0])/l;i.classList.add("comb"),i.style.letterSpacing=`calc(${g}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class IB extends rf{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class EB extends rf{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Vd.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=0,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i)){const h=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=h),e.setValue(c.id,{value:h})}e.setValue(i,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class XE extends rf{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(i,{value:s})),s)for(const a of this._getElementsByName(t.fieldName,i))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(Vd.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i))e.setValue(c.id,{value:!1});e.setValue(i,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const h=a===c.detail.value;for(const u of this._getElementsByName(c.target.name)){const d=h&&u.id===i;u.domElement&&(u.domElement.checked=d),e.setValue(u.id,{value:d})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class TB extends qE{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class RB extends rf{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");Vd.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",h=>{const u=this.data.defaultFieldValue;for(const d of s.options)d.selected=d.value===u});for(const h of this.data.options){const u=document.createElement("option");u.textContent=h.displayValue,u.value=h.exportValue,i.value.includes(h.exportValue)&&(u.setAttribute("selected",!0),r=!1),s.append(u)}let a=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),s.prepend(h),a=()=>{h.remove(),s.removeEventListener("input",a),a=null},s.addEventListener("input",a)}const o=h=>{const u=h?"value":"textContent",{options:d,multiple:f}=s;return f?Array.prototype.filter.call(d,g=>g.selected).map(g=>g[u]):d.selectedIndex===-1?null:d[d.selectedIndex][u]};let l=o(!1);const c=h=>{const u=h.target.options;return Array.prototype.map.call(u,d=>({displayValue:d.textContent,exportValue:d.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",h=>{const u={value(d){a==null||a();const f=d.detail.value,g=new Set(Array.isArray(f)?f:[f]);for(const m of s.options)m.selected=g.has(m.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(d){s.multiple=!0},remove(d){const f=s.options,g=d.detail.remove;f[g].selected=!1,s.remove(g),f.length>0&&Array.prototype.findIndex.call(f,x=>x.selected)===-1&&(f[0].selected=!0),e.setValue(t,{value:o(!0),items:c(d)}),l=o(!1)},clear(d){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(d){const{index:f,displayValue:g,exportValue:m}=d.detail.insert,x=s.children[f],p=document.createElement("option");p.textContent=g,p.value=m,x?x.before(p):s.append(p),e.setValue(t,{value:o(!0),items:c(d)}),l=o(!1)},items(d){const{items:f}=d.detail;for(;s.length!==0;)s.remove(0);for(const g of f){const{displayValue:m,exportValue:x}=g,p=document.createElement("option");p.textContent=m,p.value=x,s.append(p)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:o(!0),items:c(d)}),l=o(!1)},indices(d){const f=new Set(d.detail.indices);for(const g of d.target.options)g.selected=f.has(g.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(d){d.target.disabled=!d.detail.editable}};this._dispatchEventFromSandbox(u,h)}),s.addEventListener("input",h=>{var f;const u=o(!0),d=o(!1);e.setValue(t,{value:u}),h.preventDefault(),(f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:d,changeEx:u,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):s.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class L8 extends rs{constructor(e){const{data:t,elements:i}=e;super(e,{isRenderable:rs._hasPopupData(t)}),this.elements=i,this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=new MB({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),i=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",i.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(s=>`${n4}${s}`).join(",")),this.container}}var U1,v5,_5,H1,z1,Wi,Fc,td,tb,nb,j1,Bc,Do,Uc,ib,Hc,sb,nd,id,mi,T9,F8,YE,JE,ZE,QE,R9,M9,B8;class MB{constructor({container:e,color:t,elements:i,titleObj:s,modificationDate:r,contentsObj:a,richText:o,parent:l,rect:c,parentRect:h,open:u}){B(this,mi);B(this,U1,L(this,mi,ZE).bind(this));B(this,v5,L(this,mi,B8).bind(this));B(this,_5,L(this,mi,M9).bind(this));B(this,H1,L(this,mi,R9).bind(this));B(this,z1,null);B(this,Wi,null);B(this,Fc,null);B(this,td,null);B(this,tb,null);B(this,nb,null);B(this,j1,null);B(this,Bc,!1);B(this,Do,null);B(this,Uc,null);B(this,ib,null);B(this,Hc,null);B(this,sb,null);B(this,nd,null);B(this,id,!1);var d;N(this,Wi,e),N(this,sb,s),N(this,Fc,a),N(this,Hc,o),N(this,nb,l),N(this,z1,t),N(this,ib,c),N(this,j1,h),N(this,tb,i),N(this,td,r4.toDateObject(r)),this.trigger=i.flatMap(f=>f.getElementsToTriggerPopup());for(const f of this.trigger)f.addEventListener("click",b(this,H1)),f.addEventListener("mouseenter",b(this,_5)),f.addEventListener("mouseleave",b(this,v5)),f.classList.add("popupTriggerArea");for(const f of i)(d=f.container)==null||d.addEventListener("keydown",b(this,U1));b(this,Wi).hidden=!0,u&&L(this,mi,R9).call(this)}render(){if(b(this,Do))return;const e=N(this,Do,document.createElement("div"));if(e.className="popup",b(this,z1)){const r=e.style.outlineColor=en.makeHexColor(...b(this,z1));e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const t=document.createElement("span");t.className="header";const i=document.createElement("h1");if(t.append(i),{dir:i.dir,str:i.textContent}=b(this,sb),e.append(t),b(this,td)){const r=document.createElement("time");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:b(this,td).valueOf()})),r.dateTime=b(this,td).toISOString(),t.append(r)}const s=b(this,mi,T9);if(s)VE.render({xfaHtml:s,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(b(this,Fc));e.append(r)}b(this,Wi).append(e)}_formatContents({str:e,dir:t}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=t;const s=e.split(/(?:\r\n?|\n)/);for(let r=0,a=s.length;r<a;++r){const o=s[r];i.append(document.createTextNode(o)),r<a-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:e,popupContent:t}){var i;b(this,nd)||N(this,nd,{contentsObj:b(this,Fc),richText:b(this,Hc)}),e&&N(this,Uc,null),t&&(N(this,Hc,L(this,mi,JE).call(this,t)),N(this,Fc,null)),(i=b(this,Do))==null||i.remove(),N(this,Do,null)}resetEdited(){var e;b(this,nd)&&({contentsObj:Rr(this,Fc)._,richText:Rr(this,Hc)._}=b(this,nd),N(this,nd,null),(e=b(this,Do))==null||e.remove(),N(this,Do,null),N(this,Uc,null))}forceHide(){N(this,id,this.isVisible),b(this,id)&&(b(this,Wi).hidden=!0)}maybeShow(){b(this,id)&&(b(this,Do)||L(this,mi,M9).call(this),N(this,id,!1),b(this,Wi).hidden=!1)}get isVisible(){return b(this,Wi).hidden===!1}}U1=new WeakMap,v5=new WeakMap,_5=new WeakMap,H1=new WeakMap,z1=new WeakMap,Wi=new WeakMap,Fc=new WeakMap,td=new WeakMap,tb=new WeakMap,nb=new WeakMap,j1=new WeakMap,Bc=new WeakMap,Do=new WeakMap,Uc=new WeakMap,ib=new WeakMap,Hc=new WeakMap,sb=new WeakMap,nd=new WeakMap,id=new WeakMap,mi=new WeakSet,T9=function(){const e=b(this,Hc),t=b(this,Fc);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&b(this,Hc).html||null},F8=function(){var e,t,i;return((i=(t=(e=b(this,mi,T9))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.fontSize)||0},YE=function(){var e,t,i;return((i=(t=(e=b(this,mi,T9))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.color)||null},JE=function(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:b(this,mi,YE),fontSize:b(this,mi,F8)?`calc(${b(this,mi,F8)}px * var(--total-scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:s});return i},ZE=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&b(this,Bc))&&L(this,mi,R9).call(this)},QE=function(){if(b(this,Uc)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:s,pageY:r}}}=b(this,nb);let a=!!b(this,j1),o=a?b(this,j1):b(this,ib);for(const g of b(this,tb))if(!o||en.intersect(g.data.rect,o)!==null){o=g.data.rect,a=!0;break}const l=en.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=a?o[2]-o[0]+5:0,u=l[0]+h,d=l[1];N(this,Uc,[100*(u-s)/t,100*(d-r)/i]);const{style:f}=b(this,Wi);f.left=`${b(this,Uc)[0]}%`,f.top=`${b(this,Uc)[1]}%`},R9=function(){N(this,Bc,!b(this,Bc)),b(this,Bc)?(L(this,mi,M9).call(this),b(this,Wi).addEventListener("click",b(this,H1)),b(this,Wi).addEventListener("keydown",b(this,U1))):(L(this,mi,B8).call(this),b(this,Wi).removeEventListener("click",b(this,H1)),b(this,Wi).removeEventListener("keydown",b(this,U1)))},M9=function(){b(this,Do)||this.render(),this.isVisible?b(this,Bc)&&b(this,Wi).classList.add("focused"):(L(this,mi,QE).call(this),b(this,Wi).hidden=!1,b(this,Wi).style.zIndex=parseInt(b(this,Wi).style.zIndex)+1e3)},B8=function(){b(this,Wi).classList.remove("focused"),!(b(this,Bc)||!this.isVisible)&&(b(this,Wi).hidden=!0,b(this,Wi).style.zIndex=parseInt(b(this,Wi).style.zIndex)-1e3)};class $E extends rs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=yn.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var rb;class PB extends rs{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});B(this,rb,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),a=N(this,rb,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return b(this,rb)}addHighlightArea(){this.container.classList.add("highlightArea")}}rb=new WeakMap;var ab;class NB extends rs{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});B(this,ab,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),a=t.borderStyle.width,o=N(this,ab,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",i-a),o.setAttribute("height",s-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return b(this,ab)}addHighlightArea(){this.container.classList.add("highlightArea")}}ab=new WeakMap;var ob;class OB extends rs{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});B(this,ob,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),a=t.borderStyle.width,o=N(this,ob,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",i/2),o.setAttribute("cy",s/2),o.setAttribute("rx",i/2-a/2),o.setAttribute("ry",s/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return b(this,ob)}addHighlightArea(){this.container.classList.add("highlightArea")}}ob=new WeakMap;var lb;class eT extends rs{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});B(this,lb,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:r},width:a,height:o}=this;if(!i)return this.container;const l=this.svgFactory.create(a,o,!0);let c=[];for(let u=0,d=i.length;u<d;u+=2){const f=i[u]-t[0],g=t[3]-i[u+1];c.push(`${f},${g}`)}c=c.join(" ");const h=N(this,lb,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",c),h.setAttribute("stroke-width",s.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return b(this,lb)}addHighlightArea(){this.container.classList.add("highlightArea")}}lb=new WeakMap;class DB extends eT{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class LB extends rs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var cb,sd,hb,U8;class h4 extends rs{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});B(this,hb);B(this,cb,null);B(this,sd,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?yn.HIGHLIGHT:yn.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:r,popupRef:a}}=this,{transform:o,width:l,height:c}=L(this,hb,U8).call(this,i,t),h=this.svgFactory.create(l,c,!0),u=N(this,cb,this.svgFactory.createElement("svg:g"));h.append(u),u.setAttribute("stroke-width",r.width||1),u.setAttribute("stroke-linecap","round"),u.setAttribute("stroke-linejoin","round"),u.setAttribute("stroke-miterlimit",10),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),u.setAttribute("transform",o);for(let d=0,f=s.length;d<f;d++){const g=this.svgFactory.createElement(this.svgElementName);b(this,sd).push(g),g.setAttribute("points",s[d].join(",")),u.append(g)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:r}=t,a=b(this,cb);if(i>=0&&a.setAttribute("stroke-width",i||1),s)for(let o=0,l=b(this,sd).length;o<l;o++)b(this,sd)[o].setAttribute("points",s[o].join(","));if(r){const{transform:o,width:l,height:c}=L(this,hb,U8).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return b(this,sd)}addHighlightArea(){this.container.classList.add("highlightArea")}}cb=new WeakMap,sd=new WeakMap,hb=new WeakSet,U8=function(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}};class tT extends rs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=yn.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class FB extends rs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class BB extends rs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class UB extends rs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class nT extends rs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=yn.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var ub,db,H8;class HB extends rs{constructor(t){var s;super(t,{isRenderable:!0});B(this,db);B(this,ub,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",L(this,db,H8).bind(this)),N(this,ub,s);const{isMac:r}=ur.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&L(this,db,H8).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return b(this,ub)}addHighlightArea(){this.container.classList.add("highlightArea")}}ub=new WeakMap,db=new WeakSet,H8=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var fb,rd,eh,gb,jh,j8,G8;const Gv=class Gv{constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:s,page:r,viewport:a,structTreeLayer:o}){B(this,jh);B(this,fb,null);B(this,rd,null);B(this,eh,new Map);B(this,gb,null);this.div=e,N(this,fb,t),N(this,rd,i),N(this,gb,o||null),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return b(this,eh).size>0}async render(e){var a;const{annotations:t}=e,i=this.div;jd(i,this.viewport);const s=new Map,r={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new b3,annotationStorage:e.annotationStorage||new o4,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const l=o.annotationType===us.POPUP;if(l){const u=s.get(o.id);if(!u)continue;r.elements=u}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;r.data=o;const c=O_.create(r);if(!c.isRenderable)continue;if(!l&&o.popupRef){const u=s.get(o.popupRef);u?u.push(c):s.set(o.popupRef,[c])}const h=c.render();o.hidden&&(h.style.visibility="hidden"),await L(this,jh,j8).call(this,h,o.id,r.elements),c._isEditable&&(b(this,eh).set(c.data.id,c),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(c))}L(this,jh,G8).call(this)}async addLinkAnnotations(e,t){const i={data:null,layer:this.div,linkService:t,svgFactory:new b3,parent:this};for(const s of e){s.borderStyle||(s.borderStyle=Gv._defaultBorderStyle),i.data=s;const r=O_.create(i);if(!r.isRenderable)continue;const a=r.render();await L(this,jh,j8).call(this,a,s.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,jd(t,{rotation:e.rotation}),L(this,jh,G8).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(b(this,eh).values())}getEditableAnnotation(e){return b(this,eh).get(e)}static get _defaultBorderStyle(){return Hn(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:xf.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};fb=new WeakMap,rd=new WeakMap,eh=new WeakMap,gb=new WeakMap,jh=new WeakSet,j8=async function(e,t,i){var o,l;const s=e.firstChild||e,r=s.id=`${n4}${t}`,a=await((o=b(this,gb))==null?void 0:o.getAriaAttributes(r));if(a)for(const[c,h]of a)s.setAttribute(c,h);i?i.at(-1).container.after(e):(this.div.append(e),(l=b(this,fb))==null||l.moveElementInDOM(this.div,e,s,!1))},G8=function(){var t;if(!b(this,rd))return;const e=this.div;for(const[i,s]of b(this,rd)){const r=e.querySelector(`[data-annotation-id="${i}"]`);if(!r)continue;s.className="annotationContent";const{firstChild:a}=r;a?a.nodeName==="CANVAS"?a.replaceWith(s):a.classList.contains("annotationContent")?a.after(s):a.before(s):r.append(s);const o=b(this,eh).get(i);o&&(o._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(i,r.id,s),o._hasNoCanvas=!1):o.canvas=s)}b(this,rd).clear()};let z8=Gv;const Ox=/\r\n?|\n/g;var Lo,Ca,mb,ad,Aa,ps,iT,sT,rT,P9,d0,N9,O9,aT,q8,oT;const wi=class wi extends _i{constructor(t){super({...t,name:"freeTextEditor"});B(this,ps);B(this,Lo);B(this,Ca,"");B(this,mb,`${this.id}-editor`);B(this,ad,null);B(this,Aa);N(this,Lo,t.color||wi._defaultColor||_i._defaultLineColor),N(this,Aa,t.fontSize||wi._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=wi.prototype,i=a=>a.isEmpty(),s=Gd.TRANSLATE_SMALL,r=Gd.TRANSLATE_BIG;return Hn(this,"_keyboardManager",new rx([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static initialize(t,i){_i.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Vn.FREETEXT_SIZE:wi._defaultFontSize=i;break;case Vn.FREETEXT_COLOR:wi._defaultColor=i;break}}updateParams(t,i){switch(t){case Vn.FREETEXT_SIZE:L(this,ps,iT).call(this,i);break;case Vn.FREETEXT_COLOR:L(this,ps,sT).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Vn.FREETEXT_SIZE,wi._defaultFontSize],[Vn.FREETEXT_COLOR,wi._defaultColor||_i._defaultLineColor]]}get propertiesToUpdate(){return[[Vn.FREETEXT_SIZE,b(this,Aa)],[Vn.FREETEXT_COLOR,b(this,Lo)]]}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-wi._internalPadding*t,-(wi._internalPadding+b(this,Aa))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),N(this,ad,new AbortController);const t=this._uiManager.combinedSignal(b(this,ad));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",b(this,mb)),this._isDraggable=!0,(t=b(this,ad))==null||t.abort(),N(this,ad,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var i;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(i=this._initialOptions)!=null&&i.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=b(this,Ca),i=N(this,Ca,L(this,ps,rT).call(this).trimEnd());if(t===i)return;const s=r=>{if(N(this,Ca,r),!r){this.remove();return}L(this,ps,O9).call(this),this._uiManager.rebuild(this),L(this,ps,P9).call(this)};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),L(this,ps,P9).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){wi._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",b(this,mb)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${b(this,Aa)}px * var(--total-scale-factor))`,s.color=b(this,Lo),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[h,u]=this.pageDimensions,[d,f]=this.pageTranslation;let g,m;switch(this.rotation){case 0:g=t+(o[0]-d)/h,m=i+this.height-(o[1]-f)/u;break;case 90:g=t+(o[0]-d)/h,m=i-(o[1]-f)/u,[l,c]=[c,-l];break;case 180:g=t-this.width+(o[0]-d)/h,m=i-(o[1]-f)/u,[l,c]=[-l,-c];break;case 270:g=t+(o[0]-d-this.height*u)/h,m=i+(o[1]-f-this.width*h)/u,[l,c]=[-c,l];break}this.setAt(g*r,m*a,l,c)}else this._moveAfterPaste(t,i);L(this,ps,O9).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var g,m,x;const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=L(g=wi,d0,q8).call(g,i.getData("text")||"").replaceAll(Ox,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:c}=o,h=[],u=[];if(l.nodeType===Node.TEXT_NODE){const p=l.parentElement;if(u.push(l.nodeValue.slice(c).replaceAll(Ox,"")),p!==this.editorDiv){let y=h;for(const w of this.editorDiv.childNodes){if(w===p){y=u;continue}y.push(L(m=wi,d0,N9).call(m,w))}}h.push(l.nodeValue.slice(0,c).replaceAll(Ox,""))}else if(l===this.editorDiv){let p=h,y=0;for(const w of this.editorDiv.childNodes)y++===c&&(p=u),p.push(L(x=wi,d0,N9).call(x,w))}N(this,Ca,`${h.join(`
`)}${r}${u.join(`
`)}`),L(this,ps,O9).call(this);const d=new Range;let f=Math.sumPrecise(h.map(p=>p.length));for(const{firstChild:p}of this.editorDiv.childNodes)if(p.nodeType===Node.TEXT_NODE){const y=p.nodeValue.length;if(f<=y){d.setStart(p,f),d.setEnd(p,f);break}f-=y}a.removeAllRanges(),a.addRange(d)}get contentDiv(){return this.editorDiv}static async deserialize(t,i,s){var o;let r=null;if(t instanceof $E){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:h,rotation:u,id:d,popupRef:f},textContent:g,textPosition:m,parent:{page:{pageNumber:x}}}=t;if(!g||g.length===0)return null;r=t={annotationType:yn.FREETEXT,color:Array.from(c),fontSize:l,value:g.join(`
`),position:m,pageIndex:x-1,rect:h.slice(0),rotation:u,annotationElementId:d,id:d,deleted:!1,popupRef:f}}const a=await super.deserialize(t,i,s);return N(a,Aa,t.fontSize),N(a,Lo,en.makeHexColor(...t.color)),N(a,Ca,L(o=wi,d0,q8).call(o,t.value)),a._initialData=r,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=wi._internalPadding*this.parentScale,s=this.getRect(i,i),r=_i._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:b(this,Lo)),a={annotationType:yn.FREETEXT,color:r,fontSize:b(this,Aa),value:L(this,ps,aT).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(a.isCopy=!0,a):this.annotationElementId&&!L(this,ps,oT).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(this.deleted)return i;const{style:s}=i;s.fontSize=`calc(${b(this,Aa)}px * var(--total-scale-factor))`,s.color=b(this,Lo),i.replaceChildren();for(const a of b(this,Ca).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),i.append(o)}const r=wi._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:b(this,Ca)}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Lo=new WeakMap,Ca=new WeakMap,mb=new WeakMap,ad=new WeakMap,Aa=new WeakMap,ps=new WeakSet,iT=function(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-b(this,Aa))*this.parentScale),N(this,Aa,r),L(this,ps,P9).call(this)},s=b(this,Aa);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vn.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},sT=function(t){const i=r=>{N(this,Lo,this.editorDiv.style.color=r)},s=b(this,Lo);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vn.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},rT=function(){var s;const t=[];this.editorDiv.normalize();let i=null;for(const r of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(L(s=wi,d0,N9).call(s,r)),i=r);return t.join(`
`)},P9=function(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),s=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()},d0=new WeakSet,N9=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Ox,"")},O9=function(){if(this.editorDiv.replaceChildren(),!!b(this,Ca))for(const t of b(this,Ca).split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}},aT=function(){return b(this,Ca).replaceAll(" "," ")},q8=function(t){return t.replaceAll(" "," ")},oT=function(t){const{value:i,fontSize:s,color:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((o,l)=>o!==r[l])||t.pageIndex!==a},B(wi,d0),ze(wi,"_freeTextDefaultContent",""),ze(wi,"_internalPadding",0),ze(wi,"_defaultColor",null),ze(wi,"_defaultFontSize",10),ze(wi,"_type","freetext"),ze(wi,"_editorType",yn.FREETEXT);let V8=wi;class Lt{toSVGPath(){gi("Abstract method `toSVGPath` must be implemented.")}get box(){gi("Abstract getter `box` must be implemented.")}serialize(e,t){gi("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,s,r,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*s,a[o+1]=i+e[o+1]*r;return a}static _rescaleAndSwap(e,t,i,s,r,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*s,a[o+1]=i+e[o]*r;return a}static _translate(e,t,i,s){s||(s=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)s[r]=t+e[r],s[r+1]=i+e[r+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,s,r){switch(r){case 90:return[1-t/i,e/s];case 180:return[1-e/i,1-t/s];case 270:return[t/i,1-e/s];default:return[e/i,t/s]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,s,r,a){return[(e+5*i)/6,(t+5*s)/6,(5*i+r)/6,(5*s+a)/6,(i+r)/2,(s+a)/2]}}ze(Lt,"PRECISION",1e-4);var Sa,Fo,G1,V1,Dl,Mn,od,ld,pb,bb,q1,W1,th,xb,k5,C5,As,Zm,lT,cT,hT,uT,dT,fT;const pc=class pc{constructor({x:e,y:t},i,s,r,a,o=0){B(this,As);B(this,Sa);B(this,Fo,[]);B(this,G1);B(this,V1);B(this,Dl,[]);B(this,Mn,new Float32Array(18));B(this,od);B(this,ld);B(this,pb);B(this,bb);B(this,q1);B(this,W1);B(this,th,[]);N(this,Sa,i),N(this,W1,r*s),N(this,V1,a),b(this,Mn).set([NaN,NaN,NaN,NaN,e,t],6),N(this,G1,o),N(this,bb,b(pc,xb)*s),N(this,pb,b(pc,C5)*s),N(this,q1,s),b(this,th).push(e,t)}isEmpty(){return isNaN(b(this,Mn)[8])}add({x:e,y:t}){var S;N(this,od,e),N(this,ld,t);const[i,s,r,a]=b(this,Sa);let[o,l,c,h]=b(this,Mn).subarray(8,12);const u=e-c,d=t-h,f=Math.hypot(u,d);if(f<b(this,pb))return!1;const g=f-b(this,bb),m=g/f,x=m*u,p=m*d;let y=o,w=l;o=c,l=h,c+=x,h+=p,(S=b(this,th))==null||S.push(e,t);const v=-p/g,_=x/g,C=v*b(this,W1),k=_*b(this,W1);return b(this,Mn).set(b(this,Mn).subarray(2,8),0),b(this,Mn).set([c+C,h+k],4),b(this,Mn).set(b(this,Mn).subarray(14,18),12),b(this,Mn).set([c-C,h-k],16),isNaN(b(this,Mn)[6])?(b(this,Dl).length===0&&(b(this,Mn).set([o+C,l+k],2),b(this,Dl).push(NaN,NaN,NaN,NaN,(o+C-i)/r,(l+k-s)/a),b(this,Mn).set([o-C,l-k],14),b(this,Fo).push(NaN,NaN,NaN,NaN,(o-C-i)/r,(l-k-s)/a)),b(this,Mn).set([y,w,o,l,c,h],6),!this.isEmpty()):(b(this,Mn).set([y,w,o,l,c,h],6),Math.abs(Math.atan2(w-l,y-o)-Math.atan2(p,x))<Math.PI/2?([o,l,c,h]=b(this,Mn).subarray(2,6),b(this,Dl).push(NaN,NaN,NaN,NaN,((o+c)/2-i)/r,((l+h)/2-s)/a),[o,l,y,w]=b(this,Mn).subarray(14,18),b(this,Fo).push(NaN,NaN,NaN,NaN,((y+o)/2-i)/r,((w+l)/2-s)/a),!0):([y,w,o,l,c,h]=b(this,Mn).subarray(0,6),b(this,Dl).push(((y+5*o)/6-i)/r,((w+5*l)/6-s)/a,((5*o+c)/6-i)/r,((5*l+h)/6-s)/a,((o+c)/2-i)/r,((l+h)/2-s)/a),[c,h,o,l,y,w]=b(this,Mn).subarray(12,18),b(this,Fo).push(((y+5*o)/6-i)/r,((w+5*l)/6-s)/a,((5*o+c)/6-i)/r,((5*l+h)/6-s)/a,((o+c)/2-i)/r,((l+h)/2-s)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=b(this,Dl),t=b(this,Fo);if(isNaN(b(this,Mn)[6])&&!this.isEmpty())return L(this,As,lT).call(this);const i=[];i.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);L(this,As,hT).call(this,i);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return L(this,As,cT).call(this,i),i.join(" ")}newFreeDrawOutline(e,t,i,s,r,a){return new gT(e,t,i,s,r,a)}getOutlines(){var u;const e=b(this,Dl),t=b(this,Fo),i=b(this,Mn),[s,r,a,o]=b(this,Sa),l=new Float32Array((((u=b(this,th))==null?void 0:u.length)??0)+2);for(let d=0,f=l.length-2;d<f;d+=2)l[d]=(b(this,th)[d]-s)/a,l[d+1]=(b(this,th)[d+1]-r)/o;if(l[l.length-2]=(b(this,od)-s)/a,l[l.length-1]=(b(this,ld)-r)/o,isNaN(i[6])&&!this.isEmpty())return L(this,As,uT).call(this,l);const c=new Float32Array(b(this,Dl).length+24+b(this,Fo).length);let h=e.length;for(let d=0;d<h;d+=2){if(isNaN(e[d])){c[d]=c[d+1]=NaN;continue}c[d]=e[d],c[d+1]=e[d+1]}h=L(this,As,fT).call(this,c,h);for(let d=t.length-6;d>=6;d-=6)for(let f=0;f<6;f+=2){if(isNaN(t[d+f])){c[h]=c[h+1]=NaN,h+=2;continue}c[h]=t[d+f],c[h+1]=t[d+f+1],h+=2}return L(this,As,dT).call(this,c,h),this.newFreeDrawOutline(c,l,b(this,Sa),b(this,q1),b(this,G1),b(this,V1))}};Sa=new WeakMap,Fo=new WeakMap,G1=new WeakMap,V1=new WeakMap,Dl=new WeakMap,Mn=new WeakMap,od=new WeakMap,ld=new WeakMap,pb=new WeakMap,bb=new WeakMap,q1=new WeakMap,W1=new WeakMap,th=new WeakMap,xb=new WeakMap,k5=new WeakMap,C5=new WeakMap,As=new WeakSet,Zm=function(){const e=b(this,Mn).subarray(4,6),t=b(this,Mn).subarray(16,18),[i,s,r,a]=b(this,Sa);return[(b(this,od)+(e[0]-t[0])/2-i)/r,(b(this,ld)+(e[1]-t[1])/2-s)/a,(b(this,od)+(t[0]-e[0])/2-i)/r,(b(this,ld)+(t[1]-e[1])/2-s)/a]},lT=function(){const[e,t,i,s]=b(this,Sa),[r,a,o,l]=L(this,As,Zm).call(this);return`M${(b(this,Mn)[2]-e)/i} ${(b(this,Mn)[3]-t)/s} L${(b(this,Mn)[4]-e)/i} ${(b(this,Mn)[5]-t)/s} L${r} ${a} L${o} ${l} L${(b(this,Mn)[16]-e)/i} ${(b(this,Mn)[17]-t)/s} L${(b(this,Mn)[14]-e)/i} ${(b(this,Mn)[15]-t)/s} Z`},cT=function(e){const t=b(this,Fo);e.push(`L${t[4]} ${t[5]} Z`)},hT=function(e){const[t,i,s,r]=b(this,Sa),a=b(this,Mn).subarray(4,6),o=b(this,Mn).subarray(16,18),[l,c,h,u]=L(this,As,Zm).call(this);e.push(`L${(a[0]-t)/s} ${(a[1]-i)/r} L${l} ${c} L${h} ${u} L${(o[0]-t)/s} ${(o[1]-i)/r}`)},uT=function(e){const t=b(this,Mn),[i,s,r,a]=b(this,Sa),[o,l,c,h]=L(this,As,Zm).call(this),u=new Float32Array(36);return u.set([NaN,NaN,NaN,NaN,(t[2]-i)/r,(t[3]-s)/a,NaN,NaN,NaN,NaN,(t[4]-i)/r,(t[5]-s)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,(t[16]-i)/r,(t[17]-s)/a,NaN,NaN,NaN,NaN,(t[14]-i)/r,(t[15]-s)/a],0),this.newFreeDrawOutline(u,e,b(this,Sa),b(this,q1),b(this,G1),b(this,V1))},dT=function(e,t){const i=b(this,Fo);return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6},fT=function(e,t){const i=b(this,Mn).subarray(4,6),s=b(this,Mn).subarray(16,18),[r,a,o,l]=b(this,Sa),[c,h,u,d]=L(this,As,Zm).call(this);return e.set([NaN,NaN,NaN,NaN,(i[0]-r)/o,(i[1]-a)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/l],t),t+=24},B(pc,xb,8),B(pc,k5,2),B(pc,C5,b(pc,xb)+b(pc,k5));let x3=pc;var K1,cd,zc,yb,Ia,wb,ns,A5,mT;class gT extends Lt{constructor(t,i,s,r,a,o){super();B(this,A5);B(this,K1);B(this,cd,new Float32Array(4));B(this,zc);B(this,yb);B(this,Ia);B(this,wb);B(this,ns);N(this,ns,t),N(this,Ia,i),N(this,K1,s),N(this,wb,r),N(this,zc,a),N(this,yb,o),this.lastPoint=[NaN,NaN],L(this,A5,mT).call(this,o);const[l,c,h,u]=b(this,cd);for(let d=0,f=t.length;d<f;d+=2)t[d]=(t[d]-l)/h,t[d+1]=(t[d+1]-c)/u;for(let d=0,f=i.length;d<f;d+=2)i[d]=(i[d]-l)/h,i[d+1]=(i[d+1]-c)/u}toSVGPath(){const t=[`M${b(this,ns)[4]} ${b(this,ns)[5]}`];for(let i=6,s=b(this,ns).length;i<s;i+=6){if(isNaN(b(this,ns)[i])){t.push(`L${b(this,ns)[i+4]} ${b(this,ns)[i+5]}`);continue}t.push(`C${b(this,ns)[i]} ${b(this,ns)[i+1]} ${b(this,ns)[i+2]} ${b(this,ns)[i+3]} ${b(this,ns)[i+4]} ${b(this,ns)[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,r],a){const o=s-t,l=r-i;let c,h;switch(a){case 0:c=Lt._rescale(b(this,ns),t,r,o,-l),h=Lt._rescale(b(this,Ia),t,r,o,-l);break;case 90:c=Lt._rescaleAndSwap(b(this,ns),t,i,o,l),h=Lt._rescaleAndSwap(b(this,Ia),t,i,o,l);break;case 180:c=Lt._rescale(b(this,ns),s,i,-o,l),h=Lt._rescale(b(this,Ia),s,i,-o,l);break;case 270:c=Lt._rescaleAndSwap(b(this,ns),s,r,-o,-l),h=Lt._rescaleAndSwap(b(this,Ia),s,r,-o,-l);break}return{outline:Array.from(c),points:[Array.from(h)]}}get box(){return b(this,cd)}newOutliner(t,i,s,r,a,o=0){return new x3(t,i,s,r,a,o)}getNewOutline(t,i){const[s,r,a,o]=b(this,cd),[l,c,h,u]=b(this,K1),d=a*h,f=o*u,g=s*h+l,m=r*u+c,x=this.newOutliner({x:b(this,Ia)[0]*d+g,y:b(this,Ia)[1]*f+m},b(this,K1),b(this,wb),t,b(this,yb),i??b(this,zc));for(let p=2;p<b(this,Ia).length;p+=2)x.add({x:b(this,Ia)[p]*d+g,y:b(this,Ia)[p+1]*f+m});return x.getOutlines()}}K1=new WeakMap,cd=new WeakMap,zc=new WeakMap,yb=new WeakMap,Ia=new WeakMap,wb=new WeakMap,ns=new WeakMap,A5=new WeakSet,mT=function(t){const i=b(this,ns);let s=i[4],r=i[5];const a=[s,r,s,r];let o=s,l=r;const c=t?Math.max:Math.min;for(let u=6,d=i.length;u<d;u+=6){const f=i[u+4],g=i[u+5];if(isNaN(i[u]))en.pointBoundingBox(f,g,a),l<g?(o=f,l=g):l===g&&(o=c(o,f));else{const m=[1/0,1/0,-1/0,-1/0];en.bezierBoundingBox(s,r,...i.slice(u,u+6),m),en.rectBoundingBox(...m,a),l<m[3]?(o=m[2],l=m[3]):l===m[3]&&(o=c(o,m[2]))}s=f,r=g}const h=b(this,cd);h[0]=a[0]-b(this,zc),h[1]=a[1]-b(this,zc),h[2]=a[2]-a[0]+2*b(this,zc),h[3]=a[3]-a[1]+2*b(this,zc),this.lastPoint=[o,l]};var vb,_b,nh,Bo,Xr,pT,D9,bT,xT,K8;class W8{constructor(e,t=0,i=0,s=!0){B(this,Xr);B(this,vb);B(this,_b);B(this,nh,[]);B(this,Bo,[]);const r=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:g,y:m,width:x,height:p}of e){const y=Math.floor((g-t)/o)*o,w=Math.ceil((g+x+t)/o)*o,v=Math.floor((m-t)/o)*o,_=Math.ceil((m+p+t)/o)*o,C=[y,v,_,!0],k=[w,v,_,!1];b(this,nh).push(C,k),en.rectBoundingBox(y,v,w,_,r)}const l=r[2]-r[0]+2*i,c=r[3]-r[1]+2*i,h=r[0]-i,u=r[1]-i,d=b(this,nh).at(s?-1:-2),f=[d[0],d[2]];for(const g of b(this,nh)){const[m,x,p]=g;g[0]=(m-h)/l,g[1]=(x-u)/c,g[2]=(p-u)/c}N(this,vb,new Float32Array([h,u,l,c])),N(this,_b,f)}getOutlines(){b(this,nh).sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of b(this,nh))t[3]?(e.push(...L(this,Xr,K8).call(this,t)),L(this,Xr,bT).call(this,t)):(L(this,Xr,xT).call(this,t),e.push(...L(this,Xr,K8).call(this,t)));return L(this,Xr,pT).call(this,e)}}vb=new WeakMap,_b=new WeakMap,nh=new WeakMap,Bo=new WeakMap,Xr=new WeakSet,pT=function(e){const t=[],i=new Set;for(const a of e){const[o,l,c]=a;t.push([o,l,a],[o,c,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],c=t[a+1][2];l.push(c),c.push(l),i.add(l),i.add(c)}const s=[];let r;for(;i.size>0;){const a=i.values().next().value;let[o,l,c,h,u]=a;i.delete(a);let d=o,f=l;for(r=[o,c],s.push(r);;){let g;if(i.has(h))g=h;else if(i.has(u))g=u;else break;i.delete(g),[o,l,c,h,u]=g,d!==o&&(r.push(d,f,o,f===l?l:c),d=o),f=f===l?c:l}r.push(d,f)}return new zB(s,b(this,vb),b(this,_b))},D9=function(e){const t=b(this,Bo);let i=0,s=t.length-1;for(;i<=s;){const r=i+s>>1,a=t[r][0];if(a===e)return r;a<e?i=r+1:s=r-1}return s+1},bT=function([,e,t]){const i=L(this,Xr,D9).call(this,e);b(this,Bo).splice(i,0,[e,t])},xT=function([,e,t]){const i=L(this,Xr,D9).call(this,e);for(let s=i;s<b(this,Bo).length;s++){const[r,a]=b(this,Bo)[s];if(r!==e)break;if(r===e&&a===t){b(this,Bo).splice(s,1);return}}for(let s=i-1;s>=0;s--){const[r,a]=b(this,Bo)[s];if(r!==e)break;if(r===e&&a===t){b(this,Bo).splice(s,1);return}}},K8=function(e){const[t,i,s]=e,r=[[t,i,s]],a=L(this,Xr,D9).call(this,s);for(let o=0;o<a;o++){const[l,c]=b(this,Bo)[o];for(let h=0,u=r.length;h<u;h++){const[,d,f]=r[h];if(!(c<=d||f<=l)){if(d>=l){if(f>c)r[h][1]=c;else{if(u===1)return[];r.splice(h,1),h--,u--}continue}r[h][2]=l,f>c&&r.push([t,c,f])}}}return r};var kb,X1;class zB extends Lt{constructor(t,i,s){super();B(this,kb);B(this,X1);N(this,X1,t),N(this,kb,i),this.lastPoint=s}toSVGPath(){const t=[];for(const i of b(this,X1)){let[s,r]=i;t.push(`M${s} ${r}`);for(let a=2;a<i.length;a+=2){const o=i[a],l=i[a+1];o===s?(t.push(`V${l}`),r=l):l===r&&(t.push(`H${o}`),s=o)}t.push("Z")}return t.join(" ")}serialize([t,i,s,r],a){const o=[],l=s-t,c=r-i;for(const h of b(this,X1)){const u=new Array(h.length);for(let d=0;d<h.length;d+=2)u[d]=t+h[d]*l,u[d+1]=r-h[d+1]*c;o.push(u)}return o}get box(){return b(this,kb)}get classNamesForOutlining(){return["highlightOutline"]}}kb=new WeakMap,X1=new WeakMap;class X8 extends x3{newFreeDrawOutline(e,t,i,s,r,a){return new jB(e,t,i,s,r,a)}}class jB extends gT{newOutliner(e,t,i,s,r,a=0){return new X8(e,t,i,s,r,a)}}var Ea,hd,Y1,ks,Cb,J1,jc,Ab,ih,Uo,Z1,Sb,di,Y8,J8,Z8,iu,yT,C0;const ta=class ta{constructor({editor:e=null,uiManager:t=null}){B(this,di);B(this,Ea,null);B(this,hd,null);B(this,Y1);B(this,ks,null);B(this,Cb,!1);B(this,J1,!1);B(this,jc,null);B(this,Ab);B(this,ih,null);B(this,Uo,null);B(this,Z1);var i,s;e?(N(this,J1,!1),N(this,Z1,Vn.HIGHLIGHT_COLOR),N(this,jc,e)):(N(this,J1,!0),N(this,Z1,Vn.HIGHLIGHT_DEFAULT_COLOR)),N(this,Uo,(e==null?void 0:e._uiManager)||t),N(this,Ab,b(this,Uo)._eventBus),N(this,Y1,((i=e==null?void 0:e.color)==null?void 0:i.toUpperCase())||((s=b(this,Uo))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),b(ta,Sb)||N(ta,Sb,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Hn(this,"_keyboardManager",new rx([[["Escape","mac+Escape"],ta.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ta.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ta.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ta.prototype._moveToPrevious],[["Home","mac+Home"],ta.prototype._moveToBeginning],[["End","mac+End"],ta.prototype._moveToEnd]]))}renderButton(){const e=N(this,Ea,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",b(this,jc)&&(e.ariaControls=`${b(this,jc).id}_colorpicker_dropdown`);const t=b(this,Uo)._signal;e.addEventListener("click",L(this,di,iu).bind(this),{signal:t}),e.addEventListener("keydown",L(this,di,Z8).bind(this),{signal:t});const i=N(this,hd,document.createElement("span"));return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=b(this,Y1),e.append(i),e}renderMainDropdown(){const e=N(this,ks,L(this,di,Y8).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===b(this,Ea)){L(this,di,iu).call(this,e);return}const t=e.target.getAttribute("data-color");t&&L(this,di,J8).call(this,t,e)}_moveToNext(e){var t,i;if(!b(this,di,C0)){L(this,di,iu).call(this,e);return}if(e.target===b(this,Ea)){(t=b(this,ks).firstChild)==null||t.focus();return}(i=e.target.nextSibling)==null||i.focus()}_moveToPrevious(e){var t,i;if(e.target===((t=b(this,ks))==null?void 0:t.firstChild)||e.target===b(this,Ea)){b(this,di,C0)&&this._hideDropdownFromKeyboard();return}b(this,di,C0)||L(this,di,iu).call(this,e),(i=e.target.previousSibling)==null||i.focus()}_moveToBeginning(e){var t;if(!b(this,di,C0)){L(this,di,iu).call(this,e);return}(t=b(this,ks).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!b(this,di,C0)){L(this,di,iu).call(this,e);return}(t=b(this,ks).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=b(this,ks))==null||e.classList.add("hidden"),b(this,Ea).ariaExpanded="false",(t=b(this,ih))==null||t.abort(),N(this,ih,null)}_hideDropdownFromKeyboard(){var e;if(!b(this,J1)){if(!b(this,di,C0)){(e=b(this,jc))==null||e.unselect();return}this.hideDropdown(),b(this,Ea).focus({preventScroll:!0,focusVisible:b(this,Cb)})}}updateColor(e){if(b(this,hd)&&(b(this,hd).style.backgroundColor=e),!b(this,ks))return;const t=b(this,Uo).highlightColors.values();for(const i of b(this,ks).children)i.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=b(this,Ea))==null||e.remove(),N(this,Ea,null),N(this,hd,null),(t=b(this,ks))==null||t.remove(),N(this,ks,null)}};Ea=new WeakMap,hd=new WeakMap,Y1=new WeakMap,ks=new WeakMap,Cb=new WeakMap,J1=new WeakMap,jc=new WeakMap,Ab=new WeakMap,ih=new WeakMap,Uo=new WeakMap,Z1=new WeakMap,Sb=new WeakMap,di=new WeakSet,Y8=function(){const e=document.createElement("div"),t=b(this,Uo)._signal;e.addEventListener("contextmenu",nl,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),b(this,jc)&&(e.id=`${b(this,jc).id}_colorpicker_dropdown`);for(const[i,s]of b(this,Uo).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",s),r.title=i,r.setAttribute("data-l10n-id",b(ta,Sb)[i]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=s,r.ariaSelected=s===b(this,Y1),r.addEventListener("click",L(this,di,J8).bind(this,s),{signal:t}),e.append(r)}return e.addEventListener("keydown",L(this,di,Z8).bind(this),{signal:t}),e},J8=function(e,t){t.stopPropagation(),b(this,Ab).dispatch("switchannotationeditorparams",{source:this,type:b(this,Z1),value:e})},Z8=function(e){ta._keyboardManager.exec(this,e)},iu=function(e){if(b(this,di,C0)){this.hideDropdown();return}if(N(this,Cb,e.detail===0),b(this,ih)||(N(this,ih,new AbortController),window.addEventListener("pointerdown",L(this,di,yT).bind(this),{signal:b(this,Uo).combinedSignal(b(this,ih))})),b(this,Ea).ariaExpanded="true",b(this,ks)){b(this,ks).classList.remove("hidden");return}const t=N(this,ks,L(this,di,Y8).call(this));b(this,Ea).append(t)},yT=function(e){var t;(t=b(this,ks))!=null&&t.contains(e.target)||this.hideDropdown()},C0=function(){return b(this,ks)&&!b(this,ks).classList.contains("hidden")},B(ta,Sb,null);let y3=ta;var Q1,Ib,Gc,ud,Eb,sa,Tb,Rb,dd,no,Ta,nr,$1,Vc,wr,eg,io,Mb,Sn,Q8,L9,wT,vT,_T,$8,su,mo,kf,kT,F9,Qm,CT,AT,ST,IT,ET;const ii=class ii extends _i{constructor(t){super({...t,name:"highlightEditor"});B(this,Sn);B(this,Q1,null);B(this,Ib,0);B(this,Gc);B(this,ud,null);B(this,Eb,null);B(this,sa,null);B(this,Tb,null);B(this,Rb,0);B(this,dd,null);B(this,no,null);B(this,Ta,null);B(this,nr,!1);B(this,$1,null);B(this,Vc);B(this,wr,null);B(this,eg,"");B(this,io);B(this,Mb,"");this.color=t.color||ii._defaultColor,N(this,io,t.thickness||ii._defaultThickness),N(this,Vc,t.opacity||ii._defaultOpacity),N(this,Gc,t.boxes||null),N(this,Mb,t.methodOfCreation||""),N(this,eg,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(N(this,nr,!0),L(this,Sn,L9).call(this,t),L(this,Sn,su).call(this)):b(this,Gc)&&(N(this,Q1,t.anchorNode),N(this,Ib,t.anchorOffset),N(this,Tb,t.focusNode),N(this,Rb,t.focusOffset),L(this,Sn,Q8).call(this),L(this,Sn,su).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=ii.prototype;return Hn(this,"_keyboardManager",new rx([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:b(this,nr)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:b(this,io),methodOfCreation:b(this,Mb)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,i){var s;_i.initialize(t,i),ii._defaultColor||(ii._defaultColor=((s=i.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(t,i){switch(t){case Vn.HIGHLIGHT_DEFAULT_COLOR:ii._defaultColor=i;break;case Vn.HIGHLIGHT_THICKNESS:ii._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return b(this,$1)}updateParams(t,i){switch(t){case Vn.HIGHLIGHT_COLOR:L(this,Sn,wT).call(this,i);break;case Vn.HIGHLIGHT_THICKNESS:L(this,Sn,vT).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Vn.HIGHLIGHT_DEFAULT_COLOR,ii._defaultColor],[Vn.HIGHLIGHT_THICKNESS,ii._defaultThickness]]}get propertiesToUpdate(){return[[Vn.HIGHLIGHT_COLOR,this.color||ii._defaultColor],[Vn.HIGHLIGHT_THICKNESS,b(this,io)||ii._defaultThickness],[Vn.HIGHLIGHT_FREE,b(this,nr)]]}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",N(this,Eb,new y3({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(L(this,Sn,Qm).call(this))}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,L(this,Sn,Qm).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){L(this,Sn,$8).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(L(this,Sn,su).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?L(this,Sn,$8).call(this):t&&(L(this,Sn,su).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),i&&this.select()}rotate(t){var r,a,o;const{drawLayer:i}=this.parent;let s;b(this,nr)?(t=(t-this.rotation+360)%360,s=L(r=ii,mo,kf).call(r,b(this,no).box,t)):s=L(a=ii,mo,kf).call(a,[this.x,this.y,this.width,this.height],t),i.updateProperties(b(this,Ta),{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(b(this,wr),{bbox:L(o=ii,mo,kf).call(o,b(this,sa).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();b(this,eg)&&(t.setAttribute("aria-label",b(this,eg)),t.setAttribute("role","mark")),b(this,nr)?t.classList.add("free"):this.div.addEventListener("keydown",L(this,Sn,kT).bind(this),{signal:this._uiManager._signal});const i=N(this,dd,document.createElement("div"));t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=b(this,ud);const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),XI(this,b(this,dd),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(b(this,wr),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(b(this,wr),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:L(this,Sn,F9).call(this,!0);break;case 1:case 3:L(this,Sn,F9).call(this,!1);break}}select(){var t;super.select(),b(this,wr)&&((t=this.parent)==null||t.drawLayer.updateProperties(b(this,wr),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),b(this,wr)&&((t=this.parent)==null||t.drawLayer.updateProperties(b(this,wr),{rootClass:{selected:!1}}),b(this,nr)||L(this,Sn,F9).call(this,!1))}get _mustFixPosition(){return!b(this,nr)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(b(this,Ta),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(b(this,wr),{rootClass:{hidden:!t}}))}static startHighlighting(t,i,{target:s,x:r,y:a}){const{x:o,y:l,width:c,height:h}=s.getBoundingClientRect(),u=new AbortController,d=t.combinedSignal(u),f=g=>{u.abort(),L(this,mo,IT).call(this,t,g)};window.addEventListener("blur",f,{signal:d}),window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("pointerdown",fs,{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",nl,{signal:d}),s.addEventListener("pointermove",L(this,mo,ST).bind(this,t),{signal:d}),this._freeHighlight=new X8({x:r,y:a},[o,l,c,h],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,i,s){var m,x,p,y;let r=null;if(t instanceof tT){const{data:{quadPoints:w,rect:v,rotation:_,id:C,color:k,opacity:I,popupRef:S},parent:{page:{pageNumber:R}}}=t;r=t={annotationType:yn.HIGHLIGHT,color:Array.from(k),opacity:I,quadPoints:w,boxes:null,pageIndex:R-1,rect:v.slice(0),rotation:_,annotationElementId:C,id:C,deleted:!1,popupRef:S}}else if(t instanceof h4){const{data:{inkLists:w,rect:v,rotation:_,id:C,color:k,borderStyle:{rawWidth:I},popupRef:S},parent:{page:{pageNumber:R}}}=t;r=t={annotationType:yn.HIGHLIGHT,color:Array.from(k),thickness:I,inkLists:w,boxes:null,pageIndex:R-1,rect:v.slice(0),rotation:_,annotationElementId:C,id:C,deleted:!1,popupRef:S}}const{color:a,quadPoints:o,inkLists:l,opacity:c}=t,h=await super.deserialize(t,i,s);h.color=en.makeHexColor(...a),N(h,Vc,c||1),l&&N(h,io,t.thickness),h._initialData=r;const[u,d]=h.pageDimensions,[f,g]=h.pageTranslation;if(o){const w=N(h,Gc,[]);for(let v=0;v<o.length;v+=8)w.push({x:(o[v]-f)/u,y:1-(o[v+1]-g)/d,width:(o[v+2]-o[v])/u,height:(o[v+1]-o[v+5])/d});L(m=h,Sn,Q8).call(m),L(x=h,Sn,su).call(x),h.rotate(h.rotation)}else if(l){N(h,nr,!0);const w=l[0],v={x:w[0]-f,y:d-(w[1]-g)},_=new X8(v,[0,0,u,d],1,b(h,io)/2,!0,.001);for(let I=0,S=w.length;I<S;I+=2)v.x=w[I]-f,v.y=d-(w[I+1]-g),_.add(v);const{id:C,clipPathId:k}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:_.toSVGPath()}},!0,!0);L(p=h,Sn,L9).call(p,{highlightOutlines:_.getOutlines(),highlightId:C,clipPathId:k}),L(y=h,Sn,su).call(y),h.rotate(h.parentRotation)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=this.getRect(0,0),s=_i._colorManager.convert(this.color),r={annotationType:yn.HIGHLIGHT,color:s,opacity:b(this,Vc),thickness:b(this,io),quadPoints:L(this,Sn,CT).call(this),outlines:L(this,Sn,AT).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:L(this,Sn,Qm).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!L(this,Sn,ET).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Q1=new WeakMap,Ib=new WeakMap,Gc=new WeakMap,ud=new WeakMap,Eb=new WeakMap,sa=new WeakMap,Tb=new WeakMap,Rb=new WeakMap,dd=new WeakMap,no=new WeakMap,Ta=new WeakMap,nr=new WeakMap,$1=new WeakMap,Vc=new WeakMap,wr=new WeakMap,eg=new WeakMap,io=new WeakMap,Mb=new WeakMap,Sn=new WeakSet,Q8=function(){const t=new W8(b(this,Gc),.001);N(this,no,t.getOutlines()),[this.x,this.y,this.width,this.height]=b(this,no).box;const i=new W8(b(this,Gc),.0025,.001,this._uiManager.direction==="ltr");N(this,sa,i.getOutlines());const{lastPoint:s}=b(this,sa);N(this,$1,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},L9=function({highlightOutlines:t,highlightId:i,clipPathId:s}){var u,d;if(N(this,no,t),N(this,sa,t.getNewOutline(b(this,io)/2+1.5,.0025)),i>=0)N(this,Ta,i),N(this,ud,s),this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),N(this,wr,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:b(this,sa).box,path:{d:b(this,sa).toSVGPath()}},!0));else if(this.parent){const f=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(b(this,Ta),{bbox:L(u=ii,mo,kf).call(u,b(this,no).box,(f-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(b(this,wr),{bbox:L(d=ii,mo,kf).call(d,b(this,sa).box,f),path:{d:b(this,sa).toSVGPath()}})}const[a,o,l,c]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=c;break;case 90:{const[f,g]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*g/f,this.height=c*f/g;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=c;break;case 270:{const[f,g]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*g/f,this.height=c*f/g;break}}const{lastPoint:h}=b(this,sa);N(this,$1,[(h[0]-a)/l,(h[1]-o)/c])},wT=function(t){const i=(a,o)=>{var l,c;this.color=a,N(this,Vc,o),(l=this.parent)==null||l.drawLayer.updateProperties(b(this,Ta),{root:{fill:a,"fill-opacity":o}}),(c=b(this,Eb))==null||c.updateColor(a)},s=this.color,r=b(this,Vc);this.addCommands({cmd:i.bind(this,t,ii._defaultOpacity),undo:i.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vn.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},vT=function(t){const i=b(this,io),s=r=>{N(this,io,r),L(this,Sn,_T).call(this,r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vn.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},_T=function(t){if(!b(this,nr))return;L(this,Sn,L9).call(this,{highlightOutlines:b(this,no).getNewOutline(t/2)}),this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)},$8=function(){b(this,Ta)===null||!this.parent||(this.parent.drawLayer.remove(b(this,Ta)),N(this,Ta,null),this.parent.drawLayer.remove(b(this,wr)),N(this,wr,null))},su=function(t=this.parent){b(this,Ta)===null&&({id:Rr(this,Ta)._,clipPathId:Rr(this,ud)._}=t.drawLayer.draw({bbox:b(this,no).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":b(this,Vc)},rootClass:{highlight:!0,free:b(this,nr)},path:{d:b(this,no).toSVGPath()}},!1,!0),N(this,wr,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:b(this,nr)},bbox:b(this,sa).box,path:{d:b(this,sa).toSVGPath()}},b(this,nr))),b(this,dd)&&(b(this,dd).style.clipPath=b(this,ud)))},mo=new WeakSet,kf=function([t,i,s,r],a){switch(a){case 90:return[1-i-r,t,r,s];case 180:return[1-t-s,1-i-r,s,r];case 270:return[i,1-t-s,r,s]}return[t,i,s,r]},kT=function(t){ii._keyboardManager.exec(this,t)},F9=function(t){if(!b(this,Q1))return;const i=window.getSelection();t?i.setPosition(b(this,Q1),b(this,Ib)):i.setPosition(b(this,Tb),b(this,Rb))},Qm=function(){return b(this,nr)?this.rotation:0},CT=function(){if(b(this,nr))return null;const[t,i]=this.pageDimensions,[s,r]=this.pageTranslation,a=b(this,Gc),o=new Float32Array(a.length*8);let l=0;for(const{x:c,y:h,width:u,height:d}of a){const f=c*t+s,g=(1-h)*i+r;o[l]=o[l+4]=f,o[l+1]=o[l+3]=g,o[l+2]=o[l+6]=f+u*t,o[l+5]=o[l+7]=g-d*i,l+=8}return o},AT=function(t){return b(this,no).serialize(t,L(this,Sn,Qm).call(this))},ST=function(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},IT=function(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},ET=function(t){const{color:i}=this._initialData;return t.color.some((s,r)=>s!==i[r])},B(ii,mo),ze(ii,"_defaultColor",null),ze(ii,"_defaultOpacity",1),ze(ii,"_defaultThickness",12),ze(ii,"_type","highlight"),ze(ii,"_editorType",yn.HIGHLIGHT),ze(ii,"_freeHighlightId",-1),ze(ii,"_freeHighlight",null),ze(ii,"_freeHighlightClipId","");let w3=ii;var fd;class TT{constructor(){B(this,fd,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,i)}updateSVGProperty(e,t){b(this,fd)[e]=t}toSVGProperties(){const e=b(this,fd);return N(this,fd,Object.create(null)),{root:e}}reset(){N(this,fd,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){gi("Not implemented")}}fd=new WeakMap;var Ra,tg,Ts,gd,md,sh,rh,ah,pd,Qn,e7,t7,n7,$m,RT,B9,ep,Cf;const Ut=class Ut extends _i{constructor(t){super(t);B(this,Qn);B(this,Ra,null);B(this,tg);ze(this,"_drawId",null);N(this,tg,t.mustBeCommitted||!1),this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(L(this,Qn,e7).call(this,t),L(this,Qn,$m).call(this))}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[r,a]of Object.entries(i))s.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){gi("Not implemented")}static get typesMap(){gi("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(b(Ut,Ts).updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,i[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,i[r]]);return t}_updateProperty(t,i,s){const r=this._drawingOptions,a=r[i],o=l=>{var h;r.updateProperty(i,l);const c=b(this,Ra).updateProperty(i,l);c&&L(this,Qn,ep).call(this,c),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:o.bind(this,s),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ut._mergeSVGProperties(b(this,Ra).getPathResizingSVGProperties(L(this,Qn,B9).call(this)),{bbox:L(this,Qn,Cf).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ut._mergeSVGProperties(b(this,Ra).getPathResizedSVGProperties(L(this,Qn,B9).call(this)),{bbox:L(this,Qn,Cf).call(this)}))}_onTranslating(t,i){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:L(this,Qn,Cf).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ut._mergeSVGProperties(b(this,Ra).getPathTranslatedSVGProperties(L(this,Qn,B9).call(this),this.parentDimensions),{bbox:L(this,Qn,Cf).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,b(this,tg)&&(N(this,tg,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){L(this,Qn,n7).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(L(this,Qn,$m).call(this),L(this,Qn,ep).call(this,b(this,Ra).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),L(this,Qn,n7).call(this)):t&&(this._uiManager.addShouldRescale(this),L(this,Qn,$m).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),i&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Ut._mergeSVGProperties({bbox:L(this,Qn,Cf).call(this)},b(this,Ra).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&L(this,Qn,ep).call(this,b(this,Ra).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const s=super.render();s.classList.add("draw");const r=document.createElement("div");s.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[a,o]=this.parentDimensions;return this.setDims(this.width*a,this.height*o),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),s}static createDrawerInstance(t,i,s,r,a){gi("Not implemented")}static startDrawing(t,i,s,r){var x;const{target:a,offsetX:o,offsetY:l,pointerId:c,pointerType:h}=r;if(b(Ut,rh)&&b(Ut,rh)!==h)return;const{viewport:{rotation:u}}=t,{width:d,height:f}=a.getBoundingClientRect(),g=N(Ut,gd,new AbortController),m=t.combinedSignal(g);if(b(Ut,sh)||N(Ut,sh,c),b(Ut,rh)??N(Ut,rh,h),window.addEventListener("pointerup",p=>{var y;b(Ut,sh)===p.pointerId?this._endDraw(p):(y=b(Ut,ah))==null||y.delete(p.pointerId)},{signal:m}),window.addEventListener("pointercancel",p=>{var y;b(Ut,sh)===p.pointerId?this._currentParent.endDrawingSession():(y=b(Ut,ah))==null||y.delete(p.pointerId)},{signal:m}),window.addEventListener("pointerdown",p=>{b(Ut,rh)===p.pointerType&&((b(Ut,ah)||N(Ut,ah,new Set)).add(p.pointerId),b(Ut,Ts).isCancellable()&&(b(Ut,Ts).removeLastElement(),b(Ut,Ts).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",nl,{signal:m}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:m}),a.addEventListener("touchmove",p=>{p.timeStamp===b(Ut,pd)&&fs(p)},{signal:m}),t.toggleDrawing(),(x=i._editorUndoBar)==null||x.hide(),b(Ut,Ts)){t.drawLayer.updateProperties(this._currentDrawId,b(Ut,Ts).startNew(o,l,d,f,u));return}i.updateUIForDefaultProperties(this),N(Ut,Ts,this.createDrawerInstance(o,l,d,f,u)),N(Ut,md,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(b(Ut,md).toSVGProperties(),b(Ut,Ts).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(N(Ut,pd,-1),!b(Ut,Ts))return;const{offsetX:i,offsetY:s,pointerId:r}=t;if(b(Ut,sh)===r){if(((a=b(Ut,ah))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,b(Ut,Ts).add(i,s)),N(Ut,pd,t.timeStamp),fs(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,N(Ut,Ts,null),N(Ut,md,null),N(Ut,rh,null),N(Ut,pd,NaN)),b(Ut,gd)&&(b(Ut,gd).abort(),N(Ut,gd,null),N(Ut,sh,NaN),N(Ut,ah,null))}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===i.div&&i.drawLayer.updateProperties(this._currentDrawId,b(Ut,Ts).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=b(Ut,Ts),r=this._currentDrawId,a=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(r,s.setLastElement(a))},undo:()=>{i.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:Vn.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Vn.DRAW_STEP),!b(Ut,Ts).isEmpty()){const{pageDimensions:[s,r],scale:a}=i,o=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:b(Ut,Ts).getOutlines(s*a,r*a,a,this._INNER_MARGIN),drawingOptions:b(Ut,md),mustBeCommitted:!t});return this._cleanup(!0),o}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,r,a,o){gi("Not implemented")}static async deserialize(t,i,s){var u,d;const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}=i.viewport,c=this.deserializeDraw(o,l,r,a,this._INNER_MARGIN,t),h=await super.deserialize(t,i,s);return h.createDrawingOptions(t),L(u=h,Qn,e7).call(u,{drawOutlines:c}),L(d=h,Qn,$m).call(d),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[i,s]=this.pageTranslation,[r,a]=this.pageDimensions;return b(this,Ra).serialize([i,s,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ra=new WeakMap,tg=new WeakMap,Ts=new WeakMap,gd=new WeakMap,md=new WeakMap,sh=new WeakMap,rh=new WeakMap,ah=new WeakMap,pd=new WeakMap,Qn=new WeakSet,e7=function({drawOutlines:t,drawId:i,drawingOptions:s}){N(this,Ra,t),this._drawingOptions||(this._drawingOptions=s),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=L(this,Qn,t7).call(this,t,this.parent),L(this,Qn,ep).call(this,t.box)},t7=function(t,i){const{id:s}=i.drawLayer.draw(Ut._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s},n7=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},$m=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=L(this,Qn,t7).call(this,b(this,Ra),t)}},RT=function([t,i,s,r]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[i,1-t,s*(o/a),r*(a/o)];case 180:return[1-t,1-i,s,r];case 270:return[1-i,t,s*(o/a),r*(a/o)];default:return[t,i,s,r]}},B9=function(){const{x:t,y:i,width:s,height:r,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-i,t,s*(a/o),r*(o/a)];case 180:return[1-t,1-i,s,r];case 270:return[i,1-t,s*(a/o),r*(o/a)];default:return[t,i,s,r]}},ep=function(t){if([this.x,this.y,this.width,this.height]=L(this,Qn,RT).call(this,t),this.div){this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)}this._onResized()},Cf=function(){const{x:t,y:i,width:s,height:r,rotation:a,parentRotation:o,parentDimensions:[l,c]}=this;switch((a*4+o)/90){case 1:return[1-i-r,t,r,s];case 2:return[1-t-s,1-i-r,s,r];case 3:return[i,1-t-s,r,s];case 4:return[t,i-s*(l/c),r*(c/l),s*(l/c)];case 5:return[1-i,t,s*(l/c),r*(c/l)];case 6:return[1-t-r*(c/l),1-i,r*(c/l),s*(l/c)];case 7:return[i-s*(l/c),1-t-r*(c/l),s*(l/c),r*(c/l)];case 8:return[t-s,i-r,s,r];case 9:return[1-i,t-s,r,s];case 10:return[1-t,1-i,s,r];case 11:return[i-r,1-t,r,s];case 12:return[t-r*(c/l),i,r*(c/l),s*(l/c)];case 13:return[1-i-s*(l/c),t-r*(c/l),s*(l/c),r*(c/l)];case 14:return[1-t,1-i-s*(l/c),r*(c/l),s*(l/c)];case 15:return[i,1-t,s*(l/c),r*(c/l)];default:return[t,i,s,r]}},ze(Ut,"_currentDrawId",-1),ze(Ut,"_currentParent",null),B(Ut,Ts,null),B(Ut,gd,null),B(Ut,md,null),B(Ut,sh,NaN),B(Ut,rh,null),B(Ut,ah,null),B(Ut,pd,NaN),ze(Ut,"_INNER_MARGIN",3);let v3=Ut;var Ll,Rs,Ms,bd,ng,Dr,ir,so,xd,yd,wd,ig,U9;class GB{constructor(e,t,i,s,r,a){B(this,ig);B(this,Ll,new Float64Array(6));B(this,Rs);B(this,Ms);B(this,bd);B(this,ng);B(this,Dr);B(this,ir,"");B(this,so,0);B(this,xd,new ox);B(this,yd);B(this,wd);N(this,yd,i),N(this,wd,s),N(this,bd,r),N(this,ng,a),[e,t]=L(this,ig,U9).call(this,e,t);const o=N(this,Rs,[NaN,NaN,NaN,NaN,e,t]);N(this,Dr,[e,t]),N(this,Ms,[{line:o,points:b(this,Dr)}]),b(this,Ll).set(o,0)}updateProperty(e,t){e==="stroke-width"&&N(this,ng,t)}isEmpty(){return!b(this,Ms)||b(this,Ms).length===0}isCancellable(){return b(this,Dr).length<=10}add(e,t){[e,t]=L(this,ig,U9).call(this,e,t);const[i,s,r,a]=b(this,Ll).subarray(2,6),o=e-r,l=t-a;return Math.hypot(b(this,yd)*o,b(this,wd)*l)<=2?null:(b(this,Dr).push(e,t),isNaN(i)?(b(this,Ll).set([r,a,e,t],2),b(this,Rs).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(b(this,Ll)[0])&&b(this,Rs).splice(6,6),b(this,Ll).set([i,s,r,a,e,t],0),b(this,Rs).push(...Lt.createBezierPoints(i,s,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(b(this,Dr).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,s,r){N(this,yd,i),N(this,wd,s),N(this,bd,r),[e,t]=L(this,ig,U9).call(this,e,t);const a=N(this,Rs,[NaN,NaN,NaN,NaN,e,t]);N(this,Dr,[e,t]);const o=b(this,Ms).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),b(this,Ms).push({line:a,points:b(this,Dr)}),b(this,Ll).set(a,0),N(this,so,0),this.toSVGPath(),null}getLastElement(){return b(this,Ms).at(-1)}setLastElement(e){return b(this,Ms)?(b(this,Ms).push(e),N(this,Rs,e.line),N(this,Dr,e.points),N(this,so,0),{path:{d:this.toSVGPath()}}):b(this,xd).setLastElement(e)}removeLastElement(){if(!b(this,Ms))return b(this,xd).removeLastElement();b(this,Ms).pop(),N(this,ir,"");for(let e=0,t=b(this,Ms).length;e<t;e++){const{line:i,points:s}=b(this,Ms)[e];N(this,Rs,i),N(this,Dr,s),N(this,so,0),this.toSVGPath()}return{path:{d:b(this,ir)}}}toSVGPath(){const e=Lt.svgRound(b(this,Rs)[4]),t=Lt.svgRound(b(this,Rs)[5]);if(b(this,Dr).length===2)return N(this,ir,`${b(this,ir)} M ${e} ${t} Z`),b(this,ir);if(b(this,Dr).length<=6){const s=b(this,ir).lastIndexOf("M");N(this,ir,`${b(this,ir).slice(0,s)} M ${e} ${t}`),N(this,so,6)}if(b(this,Dr).length===4){const s=Lt.svgRound(b(this,Rs)[10]),r=Lt.svgRound(b(this,Rs)[11]);return N(this,ir,`${b(this,ir)} L ${s} ${r}`),N(this,so,12),b(this,ir)}const i=[];b(this,so)===0&&(i.push(`M ${e} ${t}`),N(this,so,6));for(let s=b(this,so),r=b(this,Rs).length;s<r;s+=6){const[a,o,l,c,h,u]=b(this,Rs).slice(s,s+6).map(Lt.svgRound);i.push(`C${a} ${o} ${l} ${c} ${h} ${u}`)}return N(this,ir,b(this,ir)+i.join(" ")),N(this,so,b(this,Rs).length),b(this,ir)}getOutlines(e,t,i,s){const r=b(this,Ms).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),b(this,xd).build(b(this,Ms),e,t,i,b(this,bd),b(this,ng),s),N(this,Ll,null),N(this,Rs,null),N(this,Ms,null),N(this,ir,null),b(this,xd)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Ll=new WeakMap,Rs=new WeakMap,Ms=new WeakMap,bd=new WeakMap,ng=new WeakMap,Dr=new WeakMap,ir=new WeakMap,so=new WeakMap,xd=new WeakMap,yd=new WeakMap,wd=new WeakMap,ig=new WeakSet,U9=function(e,t){return Lt._normalizePoint(e,t,b(this,yd),b(this,wd),b(this,bd))};var Lr,Pb,Nb,Ma,Fl,Bl,sg,rg,vd,or,dc,MT,PT,NT;class ox extends Lt{constructor(){super(...arguments);B(this,or);B(this,Lr);B(this,Pb,0);B(this,Nb);B(this,Ma);B(this,Fl);B(this,Bl);B(this,sg);B(this,rg);B(this,vd)}build(t,i,s,r,a,o,l){N(this,Fl,i),N(this,Bl,s),N(this,sg,r),N(this,rg,a),N(this,vd,o),N(this,Nb,l??0),N(this,Ma,t),L(this,or,PT).call(this)}get thickness(){return b(this,vd)}setLastElement(t){return b(this,Ma).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return b(this,Ma).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of b(this,Ma)){if(t.push(`M${Lt.svgRound(i[4])} ${Lt.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${Lt.svgRound(i[10])} ${Lt.svgRound(i[11])}`);continue}for(let s=6,r=i.length;s<r;s+=6){const[a,o,l,c,h,u]=i.subarray(s,s+6).map(Lt.svgRound);t.push(`C${a} ${o} ${l} ${c} ${h} ${u}`)}}return t.join("")}serialize([t,i,s,r],a){const o=[],l=[],[c,h,u,d]=L(this,or,MT).call(this);let f,g,m,x,p,y,w,v,_;switch(b(this,rg)){case 0:_=Lt._rescale,f=t,g=i+r,m=s,x=-r,p=t+c*s,y=i+(1-h-d)*r,w=t+(c+u)*s,v=i+(1-h)*r;break;case 90:_=Lt._rescaleAndSwap,f=t,g=i,m=s,x=r,p=t+h*s,y=i+c*r,w=t+(h+d)*s,v=i+(c+u)*r;break;case 180:_=Lt._rescale,f=t+s,g=i,m=-s,x=r,p=t+(1-c-u)*s,y=i+h*r,w=t+(1-c)*s,v=i+(h+d)*r;break;case 270:_=Lt._rescaleAndSwap,f=t+s,g=i+r,m=-s,x=-r,p=t+(1-h-d)*s,y=i+(1-c-u)*r,w=t+(1-h)*s,v=i+(1-c)*r;break}for(const{line:C,points:k}of b(this,Ma))o.push(_(C,f,g,m,x,a?new Array(C.length):null)),l.push(_(k,f,g,m,x,a?new Array(k.length):null));return{lines:o,points:l,rect:[p,y,w,v]}}static deserialize(t,i,s,r,a,{paths:{lines:o,points:l},rotation:c,thickness:h}){const u=[];let d,f,g,m,x;switch(c){case 0:x=Lt._rescale,d=-t/s,f=i/r+1,g=1/s,m=-1/r;break;case 90:x=Lt._rescaleAndSwap,d=-i/r,f=-t/s,g=1/r,m=1/s;break;case 180:x=Lt._rescale,d=t/s+1,f=-i/r,g=-1/s,m=1/r;break;case 270:x=Lt._rescaleAndSwap,d=i/r+1,f=t/s+1,g=-1/r,m=-1/s;break}if(!o){o=[];for(const y of l){const w=y.length;if(w===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,y[0],y[1]]));continue}if(w===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,y[0],y[1],NaN,NaN,NaN,NaN,y[2],y[3]]));continue}const v=new Float32Array(3*(w-2));o.push(v);let[_,C,k,I]=y.subarray(0,4);v.set([NaN,NaN,NaN,NaN,_,C],0);for(let S=4;S<w;S+=2){const R=y[S],P=y[S+1];v.set(Lt.createBezierPoints(_,C,k,I,R,P),(S-2)*3),[_,C,k,I]=[k,I,R,P]}}}for(let y=0,w=o.length;y<w;y++)u.push({line:x(o[y].map(v=>v??NaN),d,f,g,m),points:x(l[y].map(v=>v??NaN),d,f,g,m)});const p=new this.prototype.constructor;return p.build(u,s,r,1,c,h,a),p}get box(){return b(this,Lr)}updateProperty(t,i){return t==="stroke-width"?L(this,or,NT).call(this,i):null}updateParentDimensions([t,i],s){const[r,a]=L(this,or,dc).call(this);N(this,Fl,t),N(this,Bl,i),N(this,sg,s);const[o,l]=L(this,or,dc).call(this),c=o-r,h=l-a,u=b(this,Lr);return u[0]-=c,u[1]-=h,u[2]+=2*c,u[3]+=2*h,u}updateRotation(t){return N(this,Pb,t),{path:{transform:this.rotationTransform}}}get viewBox(){return b(this,Lr).map(Lt.svgRound).join(" ")}get defaultProperties(){const[t,i]=b(this,Lr);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Lt.svgRound(t)} ${Lt.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=b(this,Lr);let s=0,r=0,a=0,o=0,l=0,c=0;switch(b(this,Pb)){case 90:r=i/t,a=-t/i,l=t;break;case 180:s=-1,o=-1,l=t,c=i;break;case 270:r=-i/t,a=t/i,c=i;break;default:return""}return`matrix(${s} ${r} ${a} ${o} ${Lt.svgRound(l)} ${Lt.svgRound(c)})`}getPathResizingSVGProperties([t,i,s,r]){const[a,o]=L(this,or,dc).call(this),[l,c,h,u]=b(this,Lr);if(Math.abs(h-a)<=Lt.PRECISION||Math.abs(u-o)<=Lt.PRECISION){const x=t+s/2-(l+h/2),p=i+r/2-(c+u/2);return{path:{"transform-origin":`${Lt.svgRound(t)} ${Lt.svgRound(i)}`,transform:`${this.rotationTransform} translate(${x} ${p})`}}}const d=(s-2*a)/(h-2*a),f=(r-2*o)/(u-2*o),g=h/s,m=u/r;return{path:{"transform-origin":`${Lt.svgRound(l)} ${Lt.svgRound(c)}`,transform:`${this.rotationTransform} scale(${g} ${m}) translate(${Lt.svgRound(a)} ${Lt.svgRound(o)}) scale(${d} ${f}) translate(${Lt.svgRound(-a)} ${Lt.svgRound(-o)})`}}}getPathResizedSVGProperties([t,i,s,r]){const[a,o]=L(this,or,dc).call(this),l=b(this,Lr),[c,h,u,d]=l;if(l[0]=t,l[1]=i,l[2]=s,l[3]=r,Math.abs(u-a)<=Lt.PRECISION||Math.abs(d-o)<=Lt.PRECISION){const p=t+s/2-(c+u/2),y=i+r/2-(h+d/2);for(const{line:w,points:v}of b(this,Ma))Lt._translate(w,p,y,w),Lt._translate(v,p,y,v);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Lt.svgRound(t)} ${Lt.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const f=(s-2*a)/(u-2*a),g=(r-2*o)/(d-2*o),m=-f*(c+a)+t+a,x=-g*(h+o)+i+o;if(f!==1||g!==1||m!==0||x!==0)for(const{line:p,points:y}of b(this,Ma))Lt._rescale(p,m,x,f,g,p),Lt._rescale(y,m,x,f,g,y);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Lt.svgRound(t)} ${Lt.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[r,a]=s,o=b(this,Lr),l=t-o[0],c=i-o[1];if(b(this,Fl)===r&&b(this,Bl)===a)for(const{line:h,points:u}of b(this,Ma))Lt._translate(h,l,c,h),Lt._translate(u,l,c,u);else{const h=b(this,Fl)/r,u=b(this,Bl)/a;N(this,Fl,r),N(this,Bl,a);for(const{line:d,points:f}of b(this,Ma))Lt._rescale(d,l,c,h,u,d),Lt._rescale(f,l,c,h,u,f);o[2]*=h,o[3]*=u}return o[0]=t,o[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Lt.svgRound(t)} ${Lt.svgRound(i)}`}}}get defaultSVGProperties(){const t=b(this,Lr);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Lt.svgRound(t[0])} ${Lt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}Lr=new WeakMap,Pb=new WeakMap,Nb=new WeakMap,Ma=new WeakMap,Fl=new WeakMap,Bl=new WeakMap,sg=new WeakMap,rg=new WeakMap,vd=new WeakMap,or=new WeakSet,dc=function(t=b(this,vd)){const i=b(this,Nb)+t/2*b(this,sg);return b(this,rg)%180===0?[i/b(this,Fl),i/b(this,Bl)]:[i/b(this,Bl),i/b(this,Fl)]},MT=function(){const[t,i,s,r]=b(this,Lr),[a,o]=L(this,or,dc).call(this,0);return[t+a,i+o,s-2*a,r-2*o]},PT=function(){const t=N(this,Lr,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of b(this,Ma)){if(r.length<=12){for(let l=4,c=r.length;l<c;l+=6)en.pointBoundingBox(r[l],r[l+1],t);continue}let a=r[4],o=r[5];for(let l=6,c=r.length;l<c;l+=6){const[h,u,d,f,g,m]=r.subarray(l,l+6);en.bezierBoundingBox(a,o,h,u,d,f,g,m,t),a=g,o=m}}const[i,s]=L(this,or,dc).call(this);t[0]=Ur(t[0]-i,0,1),t[1]=Ur(t[1]-s,0,1),t[2]=Ur(t[2]+i,0,1),t[3]=Ur(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]},NT=function(t){const[i,s]=L(this,or,dc).call(this);N(this,vd,t);const[r,a]=L(this,or,dc).call(this),[o,l]=[r-i,a-s],c=b(this,Lr);return c[0]-=o,c[1]-=l,c[2]+=2*o,c[3]+=2*l,c};class J5 extends TT{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:_i._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new J5(this._viewParameters);return e.updateAll(this),e}}var S5,OT;const jf=class jf extends v3{constructor(t){super({...t,name:"inkEditor"});B(this,S5);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){_i.initialize(t,i),this._defaultDrawingOptions=new J5(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return Hn(this,"typesMap",new Map([[Vn.INK_THICKNESS,"stroke-width"],[Vn.INK_COLOR,"stroke"],[Vn.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,r,a){return new GB(t,i,s,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,r,a,o){return ox.deserialize(t,i,s,r,a,o)}static async deserialize(t,i,s){let r=null;if(t instanceof h4){const{data:{inkLists:o,rect:l,rotation:c,id:h,color:u,opacity:d,borderStyle:{rawWidth:f},popupRef:g},parent:{page:{pageNumber:m}}}=t;r=t={annotationType:yn.INK,color:Array.from(u),thickness:f,opacity:d,paths:{points:o},boxes:null,pageIndex:m-1,rect:l.slice(0),rotation:c,annotationElementId:h,id:h,deleted:!1,popupRef:g}}const a=await super.deserialize(t,i,s);return a._initialData=r,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=jf.getDefaultDrawingOptions({stroke:en.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,c={annotationType:yn.INK,color:_i._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:i,points:s},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(c.isCopy=!0,c):this.annotationElementId&&!L(this,S5,OT).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i}),null}};S5=new WeakSet,OT=function(t){const{color:i,thickness:s,opacity:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==i[l])||t.thickness!==s||t.opacity!==r||t.pageIndex!==a},ze(jf,"_type","ink"),ze(jf,"_editorType",yn.INK),ze(jf,"_defaultDrawingOptions",null);let i7=jf;class s7 extends ox{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Dx=8,vm=3;var _d,ri,r7,Ho,DT,LT,a7,H9,FT,BT,UT,o7,l7,HT;class Zc{static extractContoursFromText(e,{fontFamily:t,fontStyle:i,fontWeight:s},r,a,o,l){let c=new OffscreenCanvas(1,1),h=c.getContext("2d",{alpha:!1});const u=200,d=h.font=`${i} ${s} ${u}px ${t}`,{actualBoundingBoxLeft:f,actualBoundingBoxRight:g,actualBoundingBoxAscent:m,actualBoundingBoxDescent:x,fontBoundingBoxAscent:p,fontBoundingBoxDescent:y,width:w}=h.measureText(e),v=1.5,_=Math.ceil(Math.max(Math.abs(f)+Math.abs(g)||0,w)*v),C=Math.ceil(Math.max(Math.abs(m)+Math.abs(x)||u,Math.abs(p)+Math.abs(y)||u)*v);c=new OffscreenCanvas(_,C),h=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),h.font=d,h.filter="grayscale(1)",h.fillStyle="white",h.fillRect(0,0,_,C),h.fillStyle="black",h.fillText(e,_*(v-1)/2,C*(3-v)/2);const k=L(this,ri,o7).call(this,h.getImageData(0,0,_,C).data),I=L(this,ri,UT).call(this,k),S=L(this,ri,l7).call(this,I),R=L(this,ri,a7).call(this,k,_,C,S);return this.processDrawnLines({lines:{curves:R,width:_,height:C},pageWidth:r,pageHeight:a,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,i,s,r){const[a,o,l]=L(this,ri,HT).call(this,e),[c,h]=L(this,ri,BT).call(this,a,o,l,Math.hypot(o,l)*b(this,_d).sigmaSFactor,b(this,_d).sigmaR,b(this,_d).kernelSize),u=L(this,ri,l7).call(this,h),d=L(this,ri,a7).call(this,c,o,l,u);return this.processDrawnLines({lines:{curves:d,width:o,height:l},pageWidth:t,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:a,areContours:o}){s%180!==0&&([t,i]=[i,t]);const{curves:l,width:c,height:h}=e,u=e.thickness??0,d=[],f=Math.min(t/c,i/h),g=f/t,m=f/i,x=[];for(const{points:y}of l){const w=a?L(this,ri,FT).call(this,y):y;if(!w)continue;x.push(w);const v=w.length,_=new Float32Array(v),C=new Float32Array(3*(v===2?2:v-2));if(d.push({line:C,points:_}),v===2){_[0]=w[0]*g,_[1]=w[1]*m,C.set([NaN,NaN,NaN,NaN,_[0],_[1]],0);continue}let[k,I,S,R]=w;k*=g,I*=m,S*=g,R*=m,_.set([k,I,S,R],0),C.set([NaN,NaN,NaN,NaN,k,I],0);for(let P=4;P<v;P+=2){const D=_[P]=w[P]*g,U=_[P+1]=w[P+1]*m;C.set(Lt.createBezierPoints(k,I,S,R,D,U),(P-2)*3),[k,I,S,R]=[S,R,D,U]}}if(d.length===0)return null;const p=o?new s7:new ox;return p.build(d,t,i,1,s,o?0:u,r),{outline:p,newCurves:x,areContours:o,thickness:u,width:c,height:h}}static async compressSignature({outlines:e,areContours:t,thickness:i,width:s,height:r}){let a=1/0,o=-1/0,l=0;for(const w of e){l+=w.length;for(let v=2,_=w.length;v<_;v++){const C=w[v]-w[v-2];a=Math.min(a,C),o=Math.max(o,C)}}let c;a>=-128&&o<=127?c=Int8Array:a>=-32768&&o<=32767?c=Int16Array:c=Int32Array;const h=e.length,u=Dx+vm*h,d=new Uint32Array(u);let f=0;d[f++]=u*Uint32Array.BYTES_PER_ELEMENT+(l-2*h)*c.BYTES_PER_ELEMENT,d[f++]=0,d[f++]=s,d[f++]=r,d[f++]=t?0:1,d[f++]=Math.max(0,Math.floor(i??0)),d[f++]=h,d[f++]=c.BYTES_PER_ELEMENT;for(const w of e)d[f++]=w.length-2,d[f++]=w[0],d[f++]=w[1];const g=new CompressionStream("deflate-raw"),m=g.writable.getWriter();await m.ready,m.write(d);const x=c.prototype.constructor;for(const w of e){const v=new x(w.length-2);for(let _=2,C=w.length;_<C;_++)v[_-2]=w[_]-w[_-2];m.write(v)}m.close();const p=await new Response(g.readable).arrayBuffer(),y=new Uint8Array(p);return zI(y)}static async decompressSignature(e){try{const t=dF(e),{readable:i,writable:s}=new DecompressionStream("deflate-raw"),r=s.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let a=null,o=0;for await(const w of i)a||(a=new Uint8Array(new Uint32Array(w.buffer,0,4)[0])),a.set(w,o),o+=w.length;const l=new Uint32Array(a.buffer,0,a.length>>2),c=l[1];if(c!==0)throw new Error(`Invalid version: ${c}`);const h=l[2],u=l[3],d=l[4]===0,f=l[5],g=l[6],m=l[7],x=[],p=(Dx+vm*g)*Uint32Array.BYTES_PER_ELEMENT;let y;switch(m){case Int8Array.BYTES_PER_ELEMENT:y=new Int8Array(a.buffer,p);break;case Int16Array.BYTES_PER_ELEMENT:y=new Int16Array(a.buffer,p);break;case Int32Array.BYTES_PER_ELEMENT:y=new Int32Array(a.buffer,p);break}o=0;for(let w=0;w<g;w++){const v=l[vm*w+Dx],_=new Float32Array(v+2);x.push(_);for(let C=0;C<vm-1;C++)_[C]=l[vm*w+Dx+C+1];for(let C=0;C<v;C++)_[C+2]=_[C]+y[o++]}return{areContours:d,thickness:f,outlines:x,width:h,height:u}}catch(t){return wn(`decompressSignature: ${t}`),null}}}_d=new WeakMap,ri=new WeakSet,r7=function(e,t,i,s){return i-=e,s-=t,i===0?s>0?0:4:i===1?s+6:2-s},Ho=new WeakMap,DT=function(e,t,i,s,r,a,o){const l=L(this,ri,r7).call(this,i,s,r,a);for(let c=0;c<8;c++){const h=(-c+l-o+16)%8,u=b(this,Ho)[2*h],d=b(this,Ho)[2*h+1];if(e[(i+u)*t+(s+d)]!==0)return h}return-1},LT=function(e,t,i,s,r,a,o){const l=L(this,ri,r7).call(this,i,s,r,a);for(let c=0;c<8;c++){const h=(c+l+o+16)%8,u=b(this,Ho)[2*h],d=b(this,Ho)[2*h+1];if(e[(i+u)*t+(s+d)]!==0)return h}return-1},a7=function(e,t,i,s){const r=e.length,a=new Int32Array(r);for(let h=0;h<r;h++)a[h]=e[h]<=s?1:0;for(let h=1;h<i-1;h++)a[h*t]=a[h*t+t-1]=0;for(let h=0;h<t;h++)a[h]=a[t*i-1-h]=0;let o=1,l;const c=[];for(let h=1;h<i-1;h++){l=1;for(let u=1;u<t-1;u++){const d=h*t+u,f=a[d];if(f===0)continue;let g=h,m=u;if(f===1&&a[d-1]===0)o+=1,m-=1;else if(f>=1&&a[d+1]===0)o+=1,m+=1,f>1&&(l=f);else{f!==1&&(l=Math.abs(f));continue}const x=[u,h],p=m===u+1,y={isHole:p,points:x,id:o,parent:0};c.push(y);let w;for(const P of c)if(P.id===l){w=P;break}w?w.isHole?y.parent=p?w.parent:l:y.parent=p?l:w.parent:y.parent=p?l:0;const v=L(this,ri,DT).call(this,a,t,h,u,g,m,0);if(v===-1){a[d]=-o,a[d]!==1&&(l=Math.abs(a[d]));continue}let _=b(this,Ho)[2*v],C=b(this,Ho)[2*v+1];const k=h+_,I=u+C;g=k,m=I;let S=h,R=u;for(;;){const P=L(this,ri,LT).call(this,a,t,S,R,g,m,1);_=b(this,Ho)[2*P],C=b(this,Ho)[2*P+1];const D=S+_,U=R+C;x.push(U,D);const T=S*t+R;if(a[T+1]===0?a[T]=-o:a[T]===1&&(a[T]=o),D===h&&U===u&&S===k&&R===I){a[d]!==1&&(l=Math.abs(a[d]));break}else g=S,m=R,S=D,R=U}}}return c},H9=function(e,t,i,s){if(i-t<=4){for(let k=t;k<i-2;k+=2)s.push(e[k],e[k+1]);return}const r=e[t],a=e[t+1],o=e[i-4]-r,l=e[i-3]-a,c=Math.hypot(o,l),h=o/c,u=l/c,d=h*a-u*r,f=l/o,g=1/c,m=Math.atan(f),x=Math.cos(m),p=Math.sin(m),y=g*(Math.abs(x)+Math.abs(p)),w=g*(1-y+y**2),v=Math.max(Math.atan(Math.abs(p+x)*w),Math.atan(Math.abs(p-x)*w));let _=0,C=t;for(let k=t+2;k<i-2;k+=2){const I=Math.abs(d-h*e[k+1]+u*e[k]);I>_&&(C=k,_=I)}_>(c*v)**2?(L(this,ri,H9).call(this,e,t,C+2,s),L(this,ri,H9).call(this,e,C,i,s)):s.push(r,a)},FT=function(e){const t=[],i=e.length;return L(this,ri,H9).call(this,e,0,i,t),t.push(e[i-2],e[i-1]),t.length<=4?null:t},BT=function(e,t,i,s,r,a){const o=new Float32Array(a**2),l=-2*s**2,c=a>>1;for(let m=0;m<a;m++){const x=(m-c)**2;for(let p=0;p<a;p++)o[m*a+p]=Math.exp((x+(p-c)**2)/l)}const h=new Float32Array(256),u=-2*r**2;for(let m=0;m<256;m++)h[m]=Math.exp(m**2/u);const d=e.length,f=new Uint8Array(d),g=new Uint32Array(256);for(let m=0;m<i;m++)for(let x=0;x<t;x++){const p=m*t+x,y=e[p];let w=0,v=0;for(let C=0;C<a;C++){const k=m+C-c;if(!(k<0||k>=i))for(let I=0;I<a;I++){const S=x+I-c;if(S<0||S>=t)continue;const R=e[k*t+S],P=o[C*a+I]*h[Math.abs(R-y)];w+=R*P,v+=P}}const _=f[p]=Math.round(w/v);g[_]++}return[f,g]},UT=function(e){const t=new Uint32Array(256);for(const i of e)t[i]++;return t},o7=function(e){const t=e.length,i=new Uint8ClampedArray(t>>2);let s=-1/0,r=1/0;for(let o=0,l=i.length;o<l;o++){if(e[(o<<2)+3]===0){s=i[o]=255;continue}const h=i[o]=e[o<<2];h>s&&(s=h),h<r&&(r=h)}const a=255/(s-r);for(let o=0;o<t;o++)i[o]=(i[o]-r)*a;return i},l7=function(e){let t,i=-1/0,s=-1/0;const r=e.findIndex(l=>l!==0);let a=r,o=r;for(t=r;t<256;t++){const l=e[t];l>i&&(t-a>s&&(s=t-a,o=t-1),i=l,a=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t},HT=function(e){const t=e,{width:i,height:s}=e,{maxDim:r}=b(this,_d);let a=i,o=s;if(i>r||s>r){let d=i,f=s,g=Math.log2(Math.max(i,s)/r);const m=Math.floor(g);g=g===m?m-1:m;for(let p=0;p<g;p++){a=Math.ceil(d/2),o=Math.ceil(f/2);const y=new OffscreenCanvas(a,o);y.getContext("2d").drawImage(e,0,0,d,f,0,0,a,o),d=a,f=o,e!==t&&e.close(),e=y.transferToImageBitmap()}const x=Math.min(r/a,r/o);a=Math.round(a*x),o=Math.round(o*x)}const c=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});c.filter="grayscale(1)",c.drawImage(e,0,0,e.width,e.height,0,0,a,o);const h=c.getImageData(0,0,a,o).data;return[L(this,ri,o7).call(this,h),a,o]},B(Zc,ri),B(Zc,_d,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),B(Zc,Ho,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class u4 extends TT{constructor(){super(),super.updateProperties({fill:_i._defaultLineColor,"stroke-width":0})}clone(){const e=new u4;return e.updateAll(this),e}}class d4 extends J5{constructor(e){super(e),super.updateProperties({stroke:_i._defaultLineColor,"stroke-width":1})}clone(){const e=new d4(this._viewParameters);return e.updateAll(this),e}}var oh,Ul,lh,kd;const xa=class xa extends v3{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});B(this,oh,!1);B(this,Ul,null);B(this,lh,null);B(this,kd,null);this._willKeepAspectRatio=!0,N(this,lh,t.signatureData||null),N(this,Ul,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){_i.initialize(t,i),this._defaultDrawingOptions=new u4,this._defaultDrawnSignatureOptions=new d4(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return Hn(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!b(this,Ul)}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(b(this,lh)){const{lines:r,mustSmooth:a,areContours:o,description:l,uuid:c,heightInPage:h}=b(this,lh),{rawDims:{pageWidth:u,pageHeight:d},rotation:f}=this.parent.viewport,g=Zc.processDrawnLines({lines:r,pageWidth:u,pageHeight:d,rotation:f,innerMargin:xa._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(g,h,l,c)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return s&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){N(this,kd,t),this.addEditToolbar()}getUuid(){return b(this,kd)}get description(){return b(this,Ul)}set description(t){N(this,Ul,t),super.addEditToolbar().then(i=>{i==null||i.updateEditSignatureButton(t)})}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:s,width:r,height:a}=b(this,lh),o=Math.max(r,a),l=Zc.processDrawnLines({lines:{curves:t.map(c=>({points:c})),thickness:s,width:r,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,s,r){const{x:a,y:o}=this,{outline:l}=N(this,lh,t);N(this,oh,l instanceof s7),this.description=s,this.div.setAttribute("data-l10n-args",JSON.stringify({description:s}));let c;b(this,oh)?c=xa.getDefaultDrawingOptions():(c=xa._defaultDrawnSignatureOptions.clone(),c.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:c});const[h,u]=this.parentDimensions,[,d]=this.pageDimensions;let f=i/d;f=f>=1?.5:f,this.width*=f/this.height,this.width>=1&&(f*=.9/this.width,this.width=.9),this.height=f,this.setDims(h*this.width,u*this.height),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return Zc.process(t,i,s,r,xa._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:s,pageHeight:r},rotation:a}=this.parent.viewport;return Zc.extractContoursFromText(t,i,s,r,a,xa._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return Zc.processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:r,innerMargin:xa._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=xa.getDefaultDrawingOptions():(this._drawingOptions=xa._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:s,rect:r}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,o={annotationType:yn.SIGNATURE,isSignature:!0,areContours:b(this,oh),color:[0,0,0],thickness:b(this,oh)?0:a,pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(o.paths={lines:i,points:s},o.uuid=b(this,kd),o.isCopy=!0):o.lines=i,b(this,Ul)&&(o.accessibilityData={type:"Figure",alt:b(this,Ul)}),o}static deserializeDraw(t,i,s,r,a,o){return o.areContours?s7.deserialize(t,i,s,r,a,o):ox.deserialize(t,i,s,r,a,o)}static async deserialize(t,i,s){var a;const r=await super.deserialize(t,i,s);return N(r,oh,t.areContours),N(r,Ul,((a=t.accessibilityData)==null?void 0:a.alt)||""),N(r,kd,t.uuid),r}};oh=new WeakMap,Ul=new WeakMap,lh=new WeakMap,kd=new WeakMap,ze(xa,"_type","signature"),ze(xa,"_editorType",yn.SIGNATURE),ze(xa,"_defaultDrawingOptions",null);let c7=xa;var Mi,Ps,ch,qc,hh,ag,Wc,Cd,Hl,Pa,og,$n,tp,np,z9,j9,G9,u7,V9,zT;class h7 extends _i{constructor(t){super({...t,name:"stampEditor"});B(this,$n);B(this,Mi,null);B(this,Ps,null);B(this,ch,null);B(this,qc,null);B(this,hh,null);B(this,ag,"");B(this,Wc,null);B(this,Cd,!1);B(this,Hl,null);B(this,Pa,!1);B(this,og,!1);N(this,qc,t.bitmapUrl),N(this,hh,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){_i.initialize(t,i)}static isHandlingMimeForPasting(t){return i8.includes(t)}static paste(t,i){i.pasteEditor({mode:yn.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await s.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),i&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var t;b(this,Ps)&&(N(this,Mi,null),this._uiManager.imageManager.deleteId(b(this,Ps)),(t=b(this,Wc))==null||t.remove(),N(this,Wc,null),b(this,Hl)&&(clearTimeout(b(this,Hl)),N(this,Hl,null))),super.remove()}rebuild(){if(!this.parent){b(this,Ps)&&L(this,$n,z9).call(this);return}super.rebuild(),this.div!==null&&(b(this,Ps)&&b(this,Wc)===null&&L(this,$n,z9).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(b(this,ch)||b(this,Mi)||b(this,qc)||b(this,hh)||b(this,Ps)||b(this,Cd))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),b(this,Cd)||(b(this,Mi)?L(this,$n,j9).call(this):L(this,$n,z9).call(this)),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:s,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(N(this,Ps,s),r&&N(this,Mi,r),N(this,Cd,!1),L(this,$n,j9).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;b(this,Hl)!==null&&clearTimeout(b(this,Hl)),N(this,Hl,setTimeout(()=>{N(this,Hl,null),L(this,$n,u7).call(this)},200))}copyCanvas(t,i,s=!1){var f;t||(t=224);const{width:r,height:a}=b(this,Mi),o=new nc;let l=b(this,Mi),c=r,h=a,u=null;if(i){if(r>i||a>i){const I=Math.min(i/r,i/a);c=Math.floor(r*I),h=Math.floor(a*I)}u=document.createElement("canvas");const g=u.width=Math.ceil(c*o.sx),m=u.height=Math.ceil(h*o.sy);b(this,Pa)||(l=L(this,$n,G9).call(this,g,m));const x=u.getContext("2d");x.filter=this._uiManager.hcmFilter;let p="white",y="#cfcfd8";this._uiManager.hcmFilter!=="none"?y="black":(f=window.matchMedia)!=null&&f.call(window,"(prefers-color-scheme: dark)").matches&&(p="#8f8f9d",y="#42414d");const w=15,v=w*o.sx,_=w*o.sy,C=new OffscreenCanvas(v*2,_*2),k=C.getContext("2d");k.fillStyle=p,k.fillRect(0,0,v*2,_*2),k.fillStyle=y,k.fillRect(0,0,v,_),k.fillRect(v,_,v,_),x.fillStyle=x.createPattern(C,"repeat"),x.fillRect(0,0,g,m),x.drawImage(l,0,0,l.width,l.height,0,0,g,m)}let d=null;if(s){let g,m;if(o.symmetric&&l.width<t&&l.height<t)g=l.width,m=l.height;else if(l=b(this,Mi),r>t||a>t){const y=Math.min(t/r,t/a);g=Math.floor(r*y),m=Math.floor(a*y),b(this,Pa)||(l=L(this,$n,G9).call(this,g,m))}const p=new OffscreenCanvas(g,m).getContext("2d",{willReadFrequently:!0});p.drawImage(l,0,0,l.width,l.height,0,0,g,m),d={width:g,height:m,data:p.getImageData(0,0,g,m).data}}return{canvas:u,width:c,height:h,imageData:d}}static async deserialize(t,i,s){var x;let r=null,a=!1;if(t instanceof nT){const{data:{rect:p,rotation:y,id:w,structParent:v,popupRef:_},container:C,parent:{page:{pageNumber:k}},canvas:I}=t;let S,R;I?(delete t.canvas,{id:S,bitmap:R}=s.imageManager.getFromCanvas(C.id,I),I.remove()):(a=!0,t._hasNoCanvas=!0);const P=((x=await i._structTree.getAriaAttributes(`${n4}${w}`))==null?void 0:x.get("aria-label"))||"";r=t={annotationType:yn.STAMP,bitmapId:S,bitmap:R,pageIndex:k-1,rect:p.slice(0),rotation:y,annotationElementId:w,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:P},isSvg:!1,structParent:v,popupRef:_}}const o=await super.deserialize(t,i,s),{rect:l,bitmap:c,bitmapUrl:h,bitmapId:u,isSvg:d,accessibilityData:f}=t;a?(s.addMissingCanvas(t.id,o),N(o,Cd,!0)):u&&s.imageManager.isValidId(u)?(N(o,Ps,u),c&&N(o,Mi,c)):N(o,qc,h),N(o,Pa,d);const[g,m]=o.pageDimensions;return o.width=(l[2]-l[0])/g,o.height=(l[3]-l[1])/m,f&&(o.altTextData=f),o._initialData=r,N(o,og,!!r),o}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:yn.STAMP,bitmapId:b(this,Ps),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:b(this,Pa),structTreeParentId:this._structTreeParentId};if(t)return s.bitmapUrl=L(this,$n,V9).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(s.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=L(this,$n,zT).call(this,s);if(l.isSame)return null;l.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,i===null)return s;i.stamps||(i.stamps=new Map);const o=b(this,Pa)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(b(this,Ps)))i.stamps.set(b(this,Ps),{area:o,serialized:s}),s.bitmap=L(this,$n,V9).call(this,!1);else if(b(this,Pa)){const l=i.stamps.get(b(this,Ps));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=L(this,$n,V9).call(this,!1))}return s}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}Mi=new WeakMap,Ps=new WeakMap,ch=new WeakMap,qc=new WeakMap,hh=new WeakMap,ag=new WeakMap,Wc=new WeakMap,Cd=new WeakMap,Hl=new WeakMap,Pa=new WeakMap,og=new WeakMap,$n=new WeakSet,tp=function(t,i=!1){if(!t){this.remove();return}N(this,Mi,t.bitmap),i||(N(this,Ps,t.id),N(this,Pa,t.isSvg)),t.file&&N(this,ag,t.file.name),L(this,$n,j9).call(this)},np=function(){if(N(this,ch,null),this._uiManager.enableWaiting(!1),!!b(this,Wc)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&b(this,Mi)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&b(this,Mi)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},z9=function(){if(b(this,Ps)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(b(this,Ps)).then(s=>L(this,$n,tp).call(this,s,!0)).finally(()=>L(this,$n,np).call(this));return}if(b(this,qc)){const s=b(this,qc);N(this,qc,null),this._uiManager.enableWaiting(!0),N(this,ch,this._uiManager.imageManager.getFromUrl(s).then(r=>L(this,$n,tp).call(this,r)).finally(()=>L(this,$n,np).call(this)));return}if(b(this,hh)){const s=b(this,hh);N(this,hh,null),this._uiManager.enableWaiting(!0),N(this,ch,this._uiManager.imageManager.getFromFile(s).then(r=>L(this,$n,tp).call(this,r)).finally(()=>L(this,$n,np).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=i8.join(",");const i=this._uiManager._signal;N(this,ch,new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),L(this,$n,tp).call(this,r)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>L(this,$n,np).call(this))),t.click()},j9=function(){var u;const{div:t}=this;let{width:i,height:s}=b(this,Mi);const[r,a]=this.pageDimensions,o=.75;if(this.width)i=this.width*r,s=this.height*a;else if(i>o*r||s>o*a){const d=Math.min(o*r/i,o*a/s);i*=d,s*=d}const[l,c]=this.parentDimensions;this.setDims(i*l/r,s*c/a),this._uiManager.enableWaiting(!1);const h=N(this,Wc,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=i/r,this.height=s/a,(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),L(this,$n,u7).call(this),b(this,og)||(this.parent.addUndoableEditor(this),N(this,og,!0)),this._reportTelemetry({action:"inserted_image"}),b(this,ag)&&this.div.setAttribute("aria-description",b(this,ag)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},G9=function(t,i){const{width:s,height:r}=b(this,Mi);let a=s,o=r,l=b(this,Mi);for(;a>2*t||o>2*i;){const c=a,h=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*i&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const u=new OffscreenCanvas(a,o);u.getContext("2d").drawImage(l,0,0,c,h,0,0,a,o),l=u.transferToImageBitmap()}return l},u7=function(){const[t,i]=this.parentDimensions,{width:s,height:r}=this,a=new nc,o=Math.ceil(s*t*a.sx),l=Math.ceil(r*i*a.sy),c=b(this,Wc);if(!c||c.width===o&&c.height===l)return;c.width=o,c.height=l;const h=b(this,Pa)?b(this,Mi):L(this,$n,G9).call(this,o,l),u=c.getContext("2d");u.filter=this._uiManager.hcmFilter,u.drawImage(h,0,0,h.width,h.height,0,0,o,l)},V9=function(t){if(t){if(b(this,Pa)){const r=this._uiManager.imageManager.getSvgUrl(b(this,Ps));if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=b(this,Mi),i.getContext("2d").drawImage(b(this,Mi),0,0),i.toDataURL()}if(b(this,Pa)){const[i,s]=this.pageDimensions,r=Math.round(this.width*i*Dh.PDF_TO_CSS_UNITS),a=Math.round(this.height*s*Dh.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(b(this,Mi),0,0,b(this,Mi).width,b(this,Mi).height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(b(this,Mi))},zT=function(t){var o;const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===i,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},ze(h7,"_type","stamp"),ze(h7,"_editorType",yn.STAMP);var Ad,lg,zl,uh,Kc,Na,dh,cg,Sd,zo,Xc,Ns,Yc,fh,hg,Yt,gh,Ni,jT,wl,f7,g7,q9;const Eo=class Eo{constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:s,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:h}){B(this,Ni);B(this,Ad);B(this,lg,!1);B(this,zl,null);B(this,uh,null);B(this,Kc,null);B(this,Na,new Map);B(this,dh,!1);B(this,cg,!1);B(this,Sd,!1);B(this,zo,null);B(this,Xc,null);B(this,Ns,null);B(this,Yc,null);B(this,fh,null);B(this,hg,-1);B(this,Yt);const u=[...b(Eo,gh).values()];if(!Eo._initialized){Eo._initialized=!0;for(const d of u)d.initialize(h,e)}e.registerEditorTypes(u),N(this,Yt,e),this.pageIndex=t,this.div=i,N(this,Ad,r),N(this,zl,a),this.viewport=c,N(this,Ns,l),this.drawLayer=o,this._structTree=s,b(this,Yt).addLayer(this)}get isEmpty(){return b(this,Na).size===0}get isInvisible(){return this.isEmpty&&b(this,Yt).getMode()===yn.NONE}updateToolbar(e){b(this,Yt).updateToolbar(e)}updateMode(e=b(this,Yt).getMode()){switch(L(this,Ni,q9).call(this),e){case yn.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case yn.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case yn.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const i of b(Eo,gh).values())t.toggle(`${i._type}Editing`,e===i._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=b(this,Ns))==null?void 0:t.div)}setEditingState(e){b(this,Yt).setEditingState(e)}addCommands(e){b(this,Yt).addCommands(e)}cleanUndoStack(e){b(this,Yt).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=b(this,zl))==null||t.div.classList.toggle("disabled",!e)}async enable(){var i;N(this,Sd,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),(i=b(this,fh))==null||i.abort(),N(this,fh,null);const e=new Set;for(const s of b(this,Na).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(b(this,Yt).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!b(this,zl)){N(this,Sd,!1);return}const t=b(this,zl).getEditableAnnotations();for(const s of t){if(s.hide(),b(this,Yt).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const r=await this.deserialize(s);r&&(this.addOrRebuild(r),r.enableEditing())}N(this,Sd,!1)}disable(){var s;if(N(this,cg,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),b(this,Ns)&&!b(this,fh)){N(this,fh,new AbortController);const r=b(this,Yt).combinedSignal(b(this,fh));b(this,Ns).div.addEventListener("pointerdown",a=>{const{clientX:l,clientY:c,timeStamp:h}=a,u=b(this,hg);if(h-u>500){N(this,hg,h);return}N(this,hg,-1);const{classList:d}=this.div;d.toggle("getElements",!0);const f=document.elementsFromPoint(l,c);if(d.toggle("getElements",!1),!this.div.contains(f[0]))return;let g;const m=new RegExp(`^${LI}[0-9]+$`);for(const p of f)if(m.test(p.id)){g=p.id;break}if(!g)return;const x=b(this,Na).get(g);(x==null?void 0:x.annotationElementId)===null&&(a.stopPropagation(),a.preventDefault(),x.dblclick())},{signal:r,capture:!0})}const e=new Map,t=new Map;for(const r of b(this,Na).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(s=this.getEditableAnnotation(r.annotationElementId))==null||s.show(),r.remove()}if(b(this,zl)){const r=b(this,zl).getEditableAnnotations();for(const a of r){const{id:o}=a.data;if(b(this,Yt).isDeletedAnnotationElement(o))continue;let l=t.get(o);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=e.get(o),l&&(b(this,Yt).addChangedExistingAnnotation(l),l.renderAnnotationElement(a)&&l.show(!1)),a.show()}}L(this,Ni,q9).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of b(Eo,gh).values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),N(this,cg,!1)}getEditableAnnotation(e){var t;return((t=b(this,zl))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){b(this,Yt).getActive()!==e&&b(this,Yt).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=b(this,Ns))!=null&&e.div&&!b(this,Yc)){N(this,Yc,new AbortController);const t=b(this,Yt).combinedSignal(b(this,Yc));b(this,Ns).div.addEventListener("pointerdown",L(this,Ni,jT).bind(this),{signal:t}),b(this,Ns).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=b(this,Ns))!=null&&e.div&&b(this,Yc)&&(b(this,Yc).abort(),N(this,Yc,null),b(this,Ns).div.classList.remove("highlighting"))}enableClick(){if(b(this,uh))return;N(this,uh,new AbortController);const e=b(this,Yt).combinedSignal(b(this,uh));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=b(this,uh))==null||e.abort(),N(this,uh,null)}attach(e){b(this,Na).set(e.id,e);const{annotationElementId:t}=e;t&&b(this,Yt).isDeletedAnnotationElement(t)&&b(this,Yt).removeDeletedAnnotationElement(e)}detach(e){var t;b(this,Na).delete(e.id),(t=b(this,Ad))==null||t.removePointerInTextLayer(e.contentDiv),!b(this,cg)&&e.annotationElementId&&b(this,Yt).addDeletedAnnotationElement(e)}remove(e){this.detach(e),b(this,Yt).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(b(this,Yt).addDeletedAnnotationElement(e.annotationElementId),_i.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),b(this,Yt).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!b(this,Sd)),b(this,Yt).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var i;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!b(this,Kc)&&(e._focusEventsAllowed=!1,N(this,Kc,setTimeout(()=>{N(this,Kc,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:b(this,Yt)._signal}),t.focus())},0))),e._structTreeParentId=(i=b(this,Ad))==null?void 0:i.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getNextId(){return b(this,Yt).getId()}combinedSignal(e){return b(this,Yt).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=b(this,Ni,wl))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await b(this,Yt).updateMode(e.mode);const{offsetX:i,offsetY:s}=L(this,Ni,g7).call(this),r=this.getNextId(),a=L(this,Ni,f7).call(this,{parent:this,id:r,x:i,y:s,uiManager:b(this,Yt),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=b(Eo,gh).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,b(this,Yt)))||null}createAndAddNewEditor(e,t,i={}){const s=this.getNextId(),r=L(this,Ni,f7).call(this,{parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:b(this,Yt),isCentered:t,...i});return r&&this.add(r),r}addNewEditor(e={}){this.createAndAddNewEditor(L(this,Ni,g7).call(this),!0,e)}setSelected(e){b(this,Yt).setSelected(e)}toggleSelected(e){b(this,Yt).toggleSelected(e)}unselect(e){b(this,Yt).unselect(e)}pointerup(e){var s;const{isMac:t}=ur.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!b(this,dh)||(N(this,dh,!1),(s=b(this,Ni,wl))!=null&&s.isDrawer&&b(this,Ni,wl).supportMultipleDrawings))return;if(!b(this,lg)){N(this,lg,!0);return}const i=b(this,Yt).getMode();if(i===yn.STAMP||i===yn.SIGNATURE){b(this,Yt).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var s;if(b(this,Yt).getMode()===yn.HIGHLIGHT&&this.enableTextSelection(),b(this,dh)){N(this,dh,!1);return}const{isMac:t}=ur.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(N(this,dh,!0),(s=b(this,Ni,wl))!=null&&s.isDrawer){this.startDrawingSession(e);return}const i=b(this,Yt).getActive();N(this,lg,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),b(this,zo)){b(this,Ni,wl).startDrawing(this,b(this,Yt),!1,e);return}b(this,Yt).setCurrentDrawingSession(this),N(this,zo,new AbortController);const t=b(this,Yt).combinedSignal(b(this,zo));this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(N(this,Xc,null),this.commitOrRemove())},{signal:t}),b(this,Ni,wl).startDrawing(this,b(this,Yt),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&N(this,Xc,t);return}b(this,Xc)&&setTimeout(()=>{var t;(t=b(this,Xc))==null||t.focus(),N(this,Xc,null)},0)}endDrawingSession(e=!1){return b(this,zo)?(b(this,Yt).setCurrentDrawingSession(null),b(this,zo).abort(),N(this,zo,null),N(this,Xc,null),b(this,Ni,wl).endDrawing(e)):null}findNewParent(e,t,i){const s=b(this,Yt).findParent(t,i);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return b(this,zo)?(this.endDrawingSession(),!0):!1}onScaleChanging(){b(this,zo)&&b(this,Ni,wl).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=b(this,Yt).getActive())==null?void 0:e.parent)===this&&(b(this,Yt).commitOrRemove(),b(this,Yt).setActiveEditor(null)),b(this,Kc)&&(clearTimeout(b(this,Kc)),N(this,Kc,null));for(const i of b(this,Na).values())(t=b(this,Ad))==null||t.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,b(this,Na).clear(),b(this,Yt).removeLayer(this)}render({viewport:e}){this.viewport=e,jd(this.div,e);for(const t of b(this,Yt).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){b(this,Yt).commitOrRemove(),L(this,Ni,q9).call(this);const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,jd(this.div,{rotation:i}),t!==i)for(const s of b(this,Na).values())s.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return b(this,Yt).viewParameters.realScale}};Ad=new WeakMap,lg=new WeakMap,zl=new WeakMap,uh=new WeakMap,Kc=new WeakMap,Na=new WeakMap,dh=new WeakMap,cg=new WeakMap,Sd=new WeakMap,zo=new WeakMap,Xc=new WeakMap,Ns=new WeakMap,Yc=new WeakMap,fh=new WeakMap,hg=new WeakMap,Yt=new WeakMap,gh=new WeakMap,Ni=new WeakSet,jT=function(e){b(this,Yt).unselectAll();const{target:t}=e;if(t===b(this,Ns).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&b(this,Ns).div.contains(t)){const{isMac:i}=ur.platform;if(e.button!==0||e.ctrlKey&&i)return;b(this,Yt).showAllEditors("highlight",!0,!0),b(this,Ns).div.classList.add("free"),this.toggleDrawing(),w3.startHighlighting(this,b(this,Yt).direction==="ltr",{target:b(this,Ns).div,x:e.x,y:e.y}),b(this,Ns).div.addEventListener("pointerup",()=>{b(this,Ns).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:b(this,Yt)._signal}),e.preventDefault()}},wl=function(){return b(Eo,gh).get(b(this,Yt).getMode())},f7=function(e){const t=b(this,Ni,wl);return t?new t.prototype.constructor(e):null},g7=function(){const{x:e,y:t,width:i,height:s}=this.div.getBoundingClientRect(),r=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+i),l=Math.min(window.innerHeight,t+s),c=(r+o)/2-e,h=(a+l)/2-t,[u,d]=this.viewport.rotation%180===0?[c,h]:[h,c];return{offsetX:u,offsetY:d}},q9=function(){for(const e of b(this,Na).values())e.isEmpty()&&e.remove()},ze(Eo,"_initialized",!1),B(Eo,gh,new Map([V8,i7,h7,w3,c7].map(e=>[e._editorType,e])));let d7=Eo;var jo,Fr,Id,Ob,I5,GT,ac,p7,VT,b7;const vs=class vs{constructor({pageIndex:e}){B(this,ac);B(this,jo,null);B(this,Fr,new Map);B(this,Id,new Map);this.pageIndex=e}setParent(e){if(!b(this,jo)){N(this,jo,e);return}if(b(this,jo)!==e){if(b(this,Fr).size>0)for(const t of b(this,Fr).values())t.remove(),e.append(t);N(this,jo,e)}}static get _svgFactory(){return Hn(this,"_svgFactory",new b3)}draw(e,t=!1,i=!1){const s=Rr(vs,Ob)._++,r=L(this,ac,p7).call(this),a=vs._svgFactory.createElement("defs");r.append(a);const o=vs._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&b(this,Id).set(s,o);const c=i?L(this,ac,VT).call(this,a,l):null,h=vs._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(r,e),b(this,Fr).set(s,r),{id:s,clipPathId:`url(#${c})`}}drawOutline(e,t){const i=Rr(vs,Ob)._++,s=L(this,ac,p7).call(this),r=vs._svgFactory.createElement("defs");s.append(r);const a=vs._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const u=vs._svgFactory.createElement("mask");r.append(u),l=`mask_p${this.pageIndex}_${i}`,u.setAttribute("id",l),u.setAttribute("maskUnits","objectBoundingBox");const d=vs._svgFactory.createElement("rect");u.append(d),d.setAttribute("width","1"),d.setAttribute("height","1"),d.setAttribute("fill","white");const f=vs._svgFactory.createElement("use");u.append(f),f.setAttribute("href",`#${o}`),f.setAttribute("stroke","none"),f.setAttribute("fill","black"),f.setAttribute("fill-rule","nonzero"),f.classList.add("mask")}const c=vs._svgFactory.createElement("use");s.append(c),c.setAttribute("href",`#${o}`),l&&c.setAttribute("mask",`url(#${l})`);const h=c.cloneNode();return s.append(h),c.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(s,e),b(this,Fr).set(i,s),i}finalizeDraw(e,t){b(this,Id).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:i,bbox:s,rootClass:r,path:a}=t,o=typeof e=="number"?b(this,Fr).get(e):e;if(o){if(i&&L(this,ac,b7).call(this,o,i),s&&L(l=vs,I5,GT).call(l,o,s),r){const{classList:c}=o;for(const[h,u]of Object.entries(r))c.toggle(h,u)}if(a){const h=o.firstChild.firstChild;L(this,ac,b7).call(this,h,a)}}}updateParent(e,t){if(t===this)return;const i=b(this,Fr).get(e);i&&(b(t,jo).append(i),b(this,Fr).delete(e),b(t,Fr).set(e,i))}remove(e){b(this,Id).delete(e),b(this,jo)!==null&&(b(this,Fr).get(e).remove(),b(this,Fr).delete(e))}destroy(){N(this,jo,null);for(const e of b(this,Fr).values())e.remove();b(this,Fr).clear(),b(this,Id).clear()}};jo=new WeakMap,Fr=new WeakMap,Id=new WeakMap,Ob=new WeakMap,I5=new WeakSet,GT=function(e,[t,i,s,r]){const{style:a}=e;a.top=`${100*i}%`,a.left=`${100*t}%`,a.width=`${100*s}%`,a.height=`${100*r}%`},ac=new WeakSet,p7=function(){const e=vs._svgFactory.create(1,1,!0);return b(this,jo).append(e),e.setAttribute("aria-hidden",!0),e},VT=function(e,t){const i=vs._svgFactory.createElement("clipPath");e.append(i);const s=`clip_${t}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const r=vs._svgFactory.createElement("use");return i.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),s},b7=function(e,t){for(const[i,s]of Object.entries(t))s===null?e.removeAttribute(i):e.setAttribute(i,s)},B(vs,I5),B(vs,Ob,0);let m7=vs;globalThis._pdfjsTestingUtils={HighlightOutliner:W8};globalThis.pdfjsLib={AbortException:Oh,AnnotationEditorLayer:d7,AnnotationEditorParamsType:Vn,AnnotationEditorType:yn,AnnotationEditorUIManager:Gd,AnnotationLayer:z8,AnnotationMode:T0,AnnotationType:us,build:_B,ColorPicker:y3,createValidAbsoluteUrl:FI,DOMSVGFactory:b3,DrawLayer:m7,FeatureTest:ur,fetchData:ix,getDocument:pB,getFilenameFromUrl:fF,getPdfFilenameFromUrl:gF,getUuid:HI,getXfaPageViewport:pF,GlobalWorkerOptions:ql,ImageKind:m9,InvalidPDFException:t8,isDataScheme:X5,isPdfFile:s4,isValidExplicitDest:IF,MathClamp:Ur,noContextMenu:nl,normalizeUnicode:hF,OPS:f3,OutputScale:nc,PasswordResponses:tF,PDFDataRangeTransport:zE,PDFDateString:r4,PDFWorker:Pp,PermissionFlag:eF,PixelsPerInch:Dh,RenderingCancelledException:i4,ResponseException:g3,setLayerDimensions:jd,shadow:Hn,SignatureExtractor:Zc,stopEvent:fs,SupportedImageMimeTypes:i8,TextLayer:Rp,TouchManager:p3,updateUrlHash:BI,Util:en,VerbosityLevel:q5,version:vB,XfaLayer:VE};const VB=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Dd=[.001,0,0,.001,0,0],i0=1.35,_3=.35,D_=_3/i0,Hr={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},qT="pdfjs_internal_editor_",pl={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},L_={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},WT={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Os={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Ws={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},x7={GROUP:"Group",REPLY:"R"},pi={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},Jo={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},hf={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},KT={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"},qB={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"},WB={O:"PageOpen",C:"PageClose"},Np={ERRORS:0,WARNINGS:1,INFOS:5},ne={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},ds={moveTo:0,lineTo:1,curveTo:2,closePath:3},F_={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Z5=Np.WARNINGS;function KB(n){Number.isInteger(n)&&(Z5=n)}function XB(){return Z5}function gn(n){Z5>=Np.INFOS&&`${n}`}function he(n){Z5>=Np.WARNINGS&&`${n}`}function kn(n){throw new Error(n)}function Bs(n,e){n||kn(e)}function YB(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function k3(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=Lp(n)}catch{}}const i=e?URL.parse(n,e):URL.parse(n);return YB(i)?i:null}function Ze(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const Qr=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();class Op extends Qr{constructor(e,t){super(e,"PasswordException"),this.code=t}}class uw extends Qr{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Dp extends Qr{constructor(e){super(e,"InvalidPDFException")}}class B_ extends Qr{constructor(e,t,i){super(e,"ResponseException"),this.status=t,this.missing=i}}class Ee extends Qr{constructor(e){super(e,"FormatError")}}class sr extends Qr{constructor(e){super(e,"AbortException")}}function ua(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&kn("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<e;s+=t){const r=Math.min(s+t,e),a=n.subarray(s,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function lr(n){typeof n!="string"&&kn("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function rr(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function f4(n){return Object.keys(n).length}function JB(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function ZB(){try{return new Function(""),!0}catch{return!1}}class da{static get isLittleEndian(){return Ze(this,"isLittleEndian",JB())}static get isEvalSupported(){return Ze(this,"isEvalSupported",ZB())}static get isOffscreenCanvasSupported(){return Ze(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ze(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Ze(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Ze(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Jf=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var f0,W9,y7;class Dn{static makeHexColor(e,t,i){return`#${Jf[e]}${Jf[t]}${Jf[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,i=0){const s=e[i],r=e[i+1];e[i]=s*t[0]+r*t[2]+t[4],e[i+1]=s*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,i=0){const s=t[0],r=t[1],a=t[2],o=t[3],l=t[4],c=t[5];for(let h=0;h<6;h+=2){const u=e[i+h],d=e[i+h+1];e[i+h]=u*s+d*a+l,e[i+h+1]=u*r+d*o+c}}static applyInverseTransform(e,t){const i=e[0],s=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(i*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-i*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,i){const s=t[0],r=t[1],a=t[2],o=t[3],l=t[4],c=t[5],h=e[0],u=e[1],d=e[2],f=e[3];let g=s*h+l,m=g,x=s*d+l,p=x,y=o*u+c,w=y,v=o*f+c,_=v;if(r!==0||a!==0){const C=r*h,k=r*d,I=a*u,S=a*f;g+=I,p+=I,x+=S,m+=S,y+=C,_+=C,v+=k,w+=k}i[0]=Math.min(i[0],g,x,m,p),i[1]=Math.min(i[1],y,v,w,_),i[2]=Math.max(i[2],g,x,m,p),i[3]=Math.max(i[3],y,v,w,_)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const i=e[0],s=e[1],r=e[2],a=e[3],o=i**2+s**2,l=i*r+s*a,c=r**2+a**2,h=(o+c)/2,u=Math.sqrt(h**2-(o*c-l**2));t[0]=Math.sqrt(h+u||1),t[1]=Math.sqrt(h-u||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>s)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[i,r,s,a]}static pointBoundingBox(e,t,i){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}static rectBoundingBox(e,t,i,s,r){r[0]=Math.min(r[0],e,i),r[1]=Math.min(r[1],t,s),r[2]=Math.max(r[2],e,i),r[3]=Math.max(r[3],t,s)}static bezierBoundingBox(e,t,i,s,r,a,o,l,c){c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l),L(this,f0,y7).call(this,e,i,r,o,t,s,a,l,3*(-e+3*(i-r)+o),6*(e-2*i+r),3*(i-e),c),L(this,f0,y7).call(this,e,i,r,o,t,s,a,l,3*(-t+3*(s-a)+l),6*(t-2*s+a),3*(s-t),c)}}f0=new WeakSet,W9=function(e,t,i,s,r,a,o,l,c,h){if(c<=0||c>=1)return;const u=1-c,d=c*c,f=d*c,g=u*(u*(u*e+3*c*t)+3*d*i)+f*s,m=u*(u*(u*r+3*c*a)+3*d*o)+f*l;h[0]=Math.min(h[0],g),h[1]=Math.min(h[1],m),h[2]=Math.max(h[2],g),h[3]=Math.max(h[3],m)},y7=function(e,t,i,s,r,a,o,l,c,h,u,d){if(Math.abs(c)<1e-12){Math.abs(h)>=1e-12&&L(this,f0,W9).call(this,e,t,i,s,r,a,o,l,-u/h,d);return}const f=h**2-4*u*c;if(f<0)return;const g=Math.sqrt(f),m=2*c;L(this,f0,W9).call(this,e,t,i,s,r,a,o,l,(-h+g)/m,d),L(this,f0,W9).call(this,e,t,i,s,r,a,o,l,(-h-g)/m,d)},B(Dn,f0);const QB=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Tn(n,e=!1){if(n[0]>="ï"){let i;if(n[0]==="þ"&&n[1]==="ÿ"?(i="utf-16be",n.length%2===1&&(n=n.slice(0,-1))):n[0]==="ÿ"&&n[1]==="þ"?(i="utf-16le",n.length%2===1&&(n=n.slice(0,-1))):n[0]==="ï"&&n[1]==="»"&&n[2]==="¿"&&(i="utf-8"),i)try{const s=new TextDecoder(i,{fatal:!0}),r=lr(n),a=s.decode(r);return e||!a.includes("\x1B")?a:a.replaceAll(/\x1b[^\x1b]*(?:\x1b|$)/g,"")}catch(s){he(`stringToPDFString: "${s}".`)}}const t=[];for(let i=0,s=n.length;i<s;i++){const r=n.charCodeAt(i);if(!e&&r===27){for(;++i<s&&n.charCodeAt(i)!==27;);continue}const a=QB[r];t.push(a?String.fromCharCode(a):n.charAt(i))}return t.join("")}function Lp(n){return decodeURIComponent(escape(n))}function w7(n){return unescape(encodeURIComponent(n))}function Fp(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function m0(n=new Date){return[n.getUTCFullYear().toString(),(n.getUTCMonth()+1).toString().padStart(2,"0"),n.getUTCDate().toString().padStart(2,"0"),n.getUTCHours().toString().padStart(2,"0"),n.getUTCMinutes().toString().padStart(2,"0"),n.getUTCSeconds().toString().padStart(2,"0")].join("")}let dw=null,U_=null;function $B(n){return dw||(dw=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,U_=new Map([["ﬅ","ſt"]])),n.replaceAll(dw,(e,t,i)=>t?t.normalize("NFKC"):U_.get(i))}const eU="pdfjs_internal_id_";function tU(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[i,s,...r]=t;if(!n(i)&&!Number.isInteger(i)||!e(s))return!1;const a=r.length;let o=!0;switch(s.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of r)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function Us(n,e,t){return Math.min(Math.max(n,e),t)}function H_(n){return Uint8Array.prototype.toHex?n.toHex():Array.from(n,e=>Jf[e]).join("")}function nU(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):lr(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});const iU=Symbol("CIRCULAR_REF"),Ls=Symbol("EOF");let K9=Object.create(null),X9=Object.create(null),Af=Object.create(null);function sU(){K9=Object.create(null),X9=Object.create(null),Af=Object.create(null)}class _e{constructor(e){this.name=e}static get(e){return X9[e]||(X9[e]=new _e(e))}}class is{constructor(e){this.cmd=e}static get(e){return K9[e]||(K9[e]=new is(e))}}const XT=function(){return XT};class fe{constructor(e=null){this._map=new Map,this.xref=e,this.objId=null,this.suppressEncryption=!1,this.__nonSerializable__=XT}assignXref(e){this.xref=e}get size(){return this._map.size}get(e,t,i){let s=this._map.get(e);return s===void 0&&t!==void 0&&(s=this._map.get(t),s===void 0&&i!==void 0&&(s=this._map.get(i))),s instanceof st&&this.xref?this.xref.fetch(s,this.suppressEncryption):s}async getAsync(e,t,i){let s=this._map.get(e);return s===void 0&&t!==void 0&&(s=this._map.get(t),s===void 0&&i!==void 0&&(s=this._map.get(i))),s instanceof st&&this.xref?this.xref.fetchAsync(s,this.suppressEncryption):s}getArray(e,t,i){let s=this._map.get(e);if(s===void 0&&t!==void 0&&(s=this._map.get(t),s===void 0&&i!==void 0&&(s=this._map.get(i))),s instanceof st&&this.xref&&(s=this.xref.fetch(s,this.suppressEncryption)),Array.isArray(s)){s=s.slice();for(let r=0,a=s.length;r<a;r++)s[r]instanceof st&&this.xref&&(s[r]=this.xref.fetch(s[r],this.suppressEncryption))}return s}getRaw(e){return this._map.get(e)}getKeys(){return[...this._map.keys()]}getRawValues(){return[...this._map.values()]}set(e,t){this._map.set(e,t)}has(e){return this._map.has(e)}*[Symbol.iterator](){for(const[e,t]of this._map)yield[e,t instanceof st&&this.xref?this.xref.fetch(t,this.suppressEncryption):t]}static get empty(){const e=new fe(null);return e.set=(t,i)=>{kn("Should not call `set` on the empty dictionary.")},Ze(this,"empty",e)}static merge({xref:e,dictArray:t,mergeSubDicts:i=!1}){const s=new fe(e),r=new Map;for(const a of t)if(a instanceof fe)for(const[o,l]of a._map){let c=r.get(o);if(c===void 0)c=[],r.set(o,c);else if(!i||!(l instanceof fe))continue;c.push(l)}for(const[a,o]of r){if(o.length===1||!(o[0]instanceof fe)){s._map.set(a,o[0]);continue}const l=new fe(e);for(const c of o)for(const[h,u]of c._map)l._map.has(h)||l._map.set(h,u);l.size>0&&s._map.set(a,l)}return r.clear(),s.size>0?s:fe.empty}clone(){const e=new fe(this.xref);for(const t of this.getKeys())e.set(t,this.getRaw(t));return e}delete(e){delete this._map[e]}}class st{constructor(e,t){this.num=e,this.gen=t}toString(){return this.gen===0?`${this.num}R`:`${this.num}R${this.gen}`}static fromString(e){const t=Af[e];if(t)return t;const i=/^(\d+)R(\d*)$/.exec(e);return!i||i[1]==="0"?null:Af[e]=new st(parseInt(i[1]),i[2]?parseInt(i[2]):0)}static get(e,t){const i=t===0?`${e}R`:`${e}R${t}`;return Af[i]||(Af[i]=new st(e,t))}}class Ji{constructor(e=null){this._set=new Set(e==null?void 0:e._set)}has(e){return this._set.has(e.toString())}put(e){this._set.add(e.toString())}remove(e){this._set.delete(e.toString())}[Symbol.iterator](){return this._set.values()}clear(){this._set.clear()}}class la{constructor(){this._map=new Map}get size(){return this._map.size}get(e){return this._map.get(e.toString())}has(e){return this._map.has(e.toString())}put(e,t){this._map.set(e.toString(),t)}putAlias(e,t){this._map.set(e.toString(),this.get(t))}[Symbol.iterator](){return this._map.values()}clear(){this._map.clear()}*values(){yield*this._map.values()}*items(){for(const[e,t]of this._map)yield[st.fromString(e),t]}}function Oi(n,e){return n instanceof _e&&(e===void 0||n.name===e)}function Cs(n,e){return n instanceof is&&(e===void 0||n.cmd===e)}function YT(n,e){return n instanceof fe&&(e===void 0||Oi(n.get("Type"),e))}function C3(n,e){return n.num===e.num&&n.gen===e.gen}class hn{get length(){kn("Abstract getter `length` accessed")}get isEmpty(){kn("Abstract getter `isEmpty` accessed")}get isDataLoaded(){return Ze(this,"isDataLoaded",!0)}getByte(){kn("Abstract method `getByte` called")}getBytes(e){kn("Abstract method `getBytes` called")}async getImageData(e,t){return this.getBytes(e,t)}async asyncGetBytes(){kn("Abstract method `asyncGetBytes` called")}get isAsync(){return!1}get isAsyncDecoder(){return!1}get canAsyncDecodeImageFromBuffer(){return!1}async getTransferableImage(){return null}peekByte(){const e=this.getByte();return e!==-1&&this.pos--,e}peekBytes(e){const t=this.getBytes(e);return this.pos-=t.length,t}getUint16(){const e=this.getByte(),t=this.getByte();return e===-1||t===-1?-1:(e<<8)+t}getInt32(){const e=this.getByte(),t=this.getByte(),i=this.getByte(),s=this.getByte();return(e<<24)+(t<<16)+(i<<8)+s}getByteRange(e,t){kn("Abstract method `getByteRange` called")}getString(e){return ua(this.getBytes(e))}skip(e){this.pos+=e||1}reset(){kn("Abstract method `reset` called")}moveStart(){kn("Abstract method `moveStart` called")}makeSubStream(e,t,i=null){kn("Abstract method `makeSubStream` called")}getBaseStreams(){return null}}const JT=/^[1-9]\.\d$/,v7=2**31-1,rU=-(2**31),el=[1,0,0,1,0,0],_7=["ColorSpace","ExtGState","Font","Pattern","Properties","Shading","XObject"],k7=["ExtGState","Font","Properties","XObject"];function Ai(n){let e;return function(){return n&&(e=Object.create(null),n(e),n=null),e}}class bi extends Qr{constructor(e,t){super(`Missing data [${e}, ${t})`,"MissingDataException"),this.begin=e,this.end=t}}class C7 extends Qr{constructor(e){super(e,"ParserEOFException")}}class kh extends Qr{constructor(e){super(e,"XRefEntryException")}}class Zf extends Qr{constructor(e){super(e,"XRefParseException")}}function ZT(n){const e=n.length;if(e===0)return new Uint8Array(0);if(e===1)return new Uint8Array(n[0]);let t=0;for(let r=0;r<e;r++)t+=n[r].byteLength;const i=new Uint8Array(t);let s=0;for(let r=0;r<e;r++){const a=new Uint8Array(n[r]);i.set(a,s),s+=a.byteLength}return i}async function A7(n){const e=await fetch(n);if(!e.ok)throw new Error(`Failed to fetch file "${n}" with "${e.statusText}".`);return new Uint8Array(await e.arrayBuffer())}function uo({dict:n,key:e,getArray:t=!1,stopWhenFound:i=!0}){let s;const r=new Ji;for(;n instanceof fe&&!(n.objId&&r.has(n.objId));){n.objId&&r.put(n.objId);const a=t?n.getArray(e):n.get(e);if(a!==void 0){if(i)return a;(s||(s=[])).push(a)}n=n.get("Parent")}return s}function aU(n,e,t){const i=new Ji,s=n,r={dict:null,ref:null};for(;n instanceof fe&&!i.has(e)&&(i.put(e),!n.has("T"));){if(e=n.getRaw("Parent"),!(e instanceof st))return r;n=t.fetch(e)}return n instanceof fe&&n!==s&&(r.dict=n,r.ref=e),r}const fw=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];function oU(n,e=!1){Bs(Number.isInteger(n)&&n>0,"The number should be a positive integer.");const t="M".repeat(n/1e3|0)+fw[n%1e3/100|0]+fw[10+(n%100/10|0)]+fw[20+n%10];return e?t.toLowerCase():t}function g4(n){return n>0?Math.ceil(Math.log2(n)):0}function vl(n,e){return n[e]<<24>>24}function Qc(n,e){return(n[e]<<24|n[e+1]<<16)>>16}function xn(n,e){return n[e]<<8|n[e+1]}function Jn(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}function Va(n){return n===32||n===9||n===13||n===10}function lU(n,e){return Array.isArray(n)&&n.length===e&&n.every(t=>typeof t=="boolean")}function Gr(n,e){return Array.isArray(n)?(e===null||n.length===e)&&n.every(t=>typeof t=="number"):ArrayBuffer.isView(n)&&!(n instanceof BigInt64Array||n instanceof BigUint64Array)&&(e===null||n.length===e)}function Ch(n,e){return Gr(n,6)?n:e}function S7(n,e){return Gr(n,4)?n:e}function p0(n,e){return Gr(n,4)?Dn.normalizeRect(n):e}function QT(n){const e=/(.+)\[(\d+)\]$/;return n.split(".").map(t=>{const i=t.match(e);return i?{name:i[1],pos:parseInt(i[2],10)}:{name:t,pos:0}})}function m4(n){const e=[];let t=0;for(let i=0,s=n.length;i<s;i++){const r=n.charCodeAt(i);(r<33||r>126||r===35||r===40||r===41||r===60||r===62||r===91||r===93||r===123||r===125||r===47||r===37)&&(t<i&&e.push(n.substring(t,i)),e.push(`#${r.toString(16)}`),t=i+1)}return e.length===0?n:(t<n.length&&e.push(n.substring(t,n.length)),e.join(""))}function kg(n){return n.replaceAll(/([()\\\n\r])/g,e=>e===`
`?"\\n":e==="\r"?"\\r":`\\${e}`)}function A3(n,e,t,i){if(!n)return;let s=null;if(n instanceof st){if(i.has(n))return;s=n,i.put(s),n=e.fetch(n)}if(Array.isArray(n))for(const r of n)A3(r,e,t,i);else if(n instanceof fe){if(Oi(n.get("S"),"JavaScript")){const r=n.get("JS");let a;r instanceof hn?a=r.getString():typeof r=="string"&&(a=r),a&&(a=Tn(a,!0).replaceAll("\0","")),a&&t.push(a)}A3(n.getRaw("Next"),e,t,i)}s&&i.remove(s)}function Q5(n,e,t){const i=Object.create(null),s=uo({dict:e,key:"AA",stopWhenFound:!1});if(s)for(let r=s.length-1;r>=0;r--){const a=s[r];if(a instanceof fe)for(const o of a.getKeys()){const l=t[o];if(!l)continue;const c=a.getRaw(o),h=new Ji,u=[];A3(c,n,u,h),u.length>0&&(i[l]=u)}}if(e.has("A")){const r=e.get("A"),a=new Ji,o=[];A3(r,n,o,a),o.length>0&&(i.Action=o)}return f4(i)>0?i:null}const cU={60:"&lt;",62:"&gt;",38:"&amp;",34:"&quot;",39:"&apos;"};function*hU(n){for(let e=0,t=n.length;e<t;e++){const i=n.codePointAt(e);i>55295&&(i<57344||i>65533)&&e++,yield i}}function Qf(n){const e=[];let t=0;for(let i=0,s=n.length;i<s;i++){const r=n.codePointAt(i);if(32<=r&&r<=126){const a=cU[r];a&&(t<i&&e.push(n.substring(t,i)),e.push(a),t=i+1)}else t<i&&e.push(n.substring(t,i)),e.push(`&#x${r.toString(16).toUpperCase()};`),r>55295&&(r<57344||r>65533)&&i++,t=i+1}return e.length===0?n:(t<n.length&&e.push(n.substring(t,n.length)),e.join(""))}function I7(n,e=!1){const t=/^("|').*("|')$/.exec(n);if(t&&t[1]===t[2]){if(new RegExp(`[^\\\\]${t[1]}`).test(n.slice(1,-1)))return e&&he(`FontFamily contains unescaped ${t[1]}: ${n}.`),!1}else for(const i of n.split(/[ \t]+/))if(/^(\d|(-(\d|-)))/.test(i)||!/^[\w-\\]+$/.test(i))return e&&he(`FontFamily contains invalid <custom-ident>: ${n}.`),!1;return!0}function uU(n){const e="14",t="400",i=new Set(["100","200","300","400","500","600","700","800","900","1000","normal","bold","bolder","lighter"]),{fontFamily:s,fontWeight:r,italicAngle:a}=n;if(!I7(s,!0))return!1;const o=r?r.toString():"";n.fontWeight=i.has(o)?o:t;const l=parseFloat(a);return n.italicAngle=isNaN(l)||l<-90||l>90?e:a.toString(),!0}function $T(n){const e=["app.launchURL","window.open","xfa.host.gotoURL"],i=new RegExp("^\\s*("+e.join("|").replaceAll(".","\\.")+`)\\((?:'|")([^'"]*)(?:'|")(?:,\\s*(\\w+)\\)|\\))`,"i").exec(n);return i!=null&&i[2]?{url:i[2],newWindow:i[1]==="app.launchURL"&&i[3]==="true"}:null}function _n(n){if(Number.isInteger(n))return n.toString();const e=Math.round(n*100);return e%100===0?(e/100).toString():e%10===0?n.toFixed(1):n.toFixed(2)}function eR(n){if(!n)return null;const e=new Map;for(const[t,i]of n){if(!t.startsWith(qT))continue;let s=e.get(i.pageIndex);s||(s=[],e.set(i.pageIndex,s)),s.push(i)}return e.size>0?e:null}function fo(n){return dU(n)?n:tR(n,!0)}function dU(n){return/^[\x00-\x7F]*$/.test(n)}function fU(n){const e=[];for(let t=0,i=n.length;t<i;t++){const s=n.charCodeAt(t);e.push(Jf[s>>8&255],Jf[s&255])}return e.join("")}function tR(n,e=!1){const t=[];e&&t.push("þÿ");for(let i=0,s=n.length;i<s;i++){const r=n.charCodeAt(i);t.push(String.fromCharCode(r>>8&255),String.fromCharCode(r&255))}return t.join("")}function S3(n,e,t){switch(n){case 90:return[0,1,-1,0,e,0];case 180:return[-1,0,0,-1,e,t];case 270:return[0,-1,1,0,0,t];default:throw new Error("Invalid rotation")}}function z_(n){return Math.ceil(Math.ceil(Math.log2(1+n))/8)}var Db;class vi{static get _memoryArray(){const e=b(this,Db);return e!=null&&e.byteLength?e:N(this,Db,new Uint8Array(this._memory.buffer))}}Db=new WeakMap,B(vi,Db,null),ze(vi,"_memory",null),ze(vi,"_mustAddAlpha",!1),ze(vi,"_destBuffer",null),ze(vi,"_destOffset",0),ze(vi,"_destLength",0),ze(vi,"_cssColor",""),ze(vi,"_makeHexColor",null);function gU(n,e){const{_mustAddAlpha:t,_destBuffer:i,_destOffset:s,_destLength:r,_memoryArray:a}=vi;if(e===r){i.set(a.subarray(n,n+e),s);return}if(t)for(let o=n,l=n+e,c=s;o<l;o+=3,c+=4)i[c]=a[o],i[c+1]=a[o+1],i[c+2]=a[o+2],i[c+3]=255;else for(let o=n,l=n+e,c=s;o<l;o+=3,c+=4)i[c]=a[o],i[c+1]=a[o+1],i[c+2]=a[o+2]}function mU(n){const{_destBuffer:e,_destOffset:t,_memoryArray:i}=vi;e[t]=i[n],e[t+1]=i[n+1],e[t+2]=i[n+2]}function pU(n){const{_memoryArray:e}=vi;vi._cssColor=vi._makeHexColor(e[n],e[n+1],e[n+2])}let Wr;const nR=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&nR.decode();let ip=null;function iR(){return(ip===null||ip.byteLength===0)&&(ip=new Uint8Array(Wr.memory.buffer)),ip}function bU(n,e){return n=n>>>0,nR.decode(iR().subarray(n,n+e))}let p4=0;function sR(n,e){const t=e(n.length*1,1)>>>0;return iR().set(n,t/1),p4=n.length,t}function xU(n,e){const t=sR(e,Wr.__wbindgen_malloc),i=p4;Wr.qcms_convert_array(n,t,i)}function yU(n,e,t){Wr.qcms_convert_one(n,e,t)}function wU(n,e,t,i,s){Wr.qcms_convert_three(n,e,t,i,s)}function vU(n,e,t,i,s,r){Wr.qcms_convert_four(n,e,t,i,s,r)}function _U(n,e,t){const i=sR(n,Wr.__wbindgen_malloc),s=p4;return Wr.qcms_transformer_from_memory(i,s,e,t)>>>0}function kU(n){Wr.qcms_drop_transformer(n)}const gw=Object.freeze({RGB8:0,0:"RGB8",RGBA8:1,1:"RGBA8",BGRA8:2,2:"BGRA8",Gray8:3,3:"Gray8",GrayA8:4,4:"GrayA8",CMYK:5,5:"CMYK"}),CU=Object.freeze({Perceptual:0,0:"Perceptual",RelativeColorimetric:1,1:"RelativeColorimetric",Saturation:2,2:"Saturation",AbsoluteColorimetric:3,3:"AbsoluteColorimetric"});function AU(){const n={};return n.wbg={},n.wbg.__wbg_copyresult_b08ee7d273f295dd=function(e,t){gU(e>>>0,t>>>0)},n.wbg.__wbg_copyrgb_d60ce17bb05d9b67=function(e){mU(e>>>0)},n.wbg.__wbg_makecssRGB_893bf0cd9fdb302d=function(e){pU(e>>>0)},n.wbg.__wbindgen_init_externref_table=function(){const e=Wr.__wbindgen_export_0,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},n.wbg.__wbindgen_throw=function(e,t){throw new Error(bU(e,t))},n}function SU(n,e){return Wr=n.exports,ip=null,Wr.__wbindgen_start(),Wr}function IU(n){if(Wr!==void 0)return Wr;typeof n<"u"&&(Object.getPrototypeOf(n)===Object.prototype?{module:n}=n:console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));const e=AU();n instanceof WebAssembly.Module||(n=new WebAssembly.Module(n));const t=new WebAssembly.Instance(n,e);return SU(t)}function EU(n,e,t,i,s,r,a){a=a!==1?0:a;const l=t/s,c=i/r;let h=0,u;const d=new Uint16Array(s),f=t*3;for(let g=0;g<s;g++)d[g]=Math.floor(g*l)*3;for(let g=0;g<r;g++){const m=Math.floor(g*c)*f;for(let x=0;x<s;x++)u=m+d[x],e[h++]=n[u++],e[h++]=n[u++],e[h++]=n[u++],h+=a}}function TU(n,e,t,i,s,r,a){const o=t/s,l=i/r;let c=0;const h=new Uint16Array(s);if(a===1){for(let g=0;g<s;g++)h[g]=Math.floor(g*o);const u=new Uint32Array(n.buffer),d=new Uint32Array(e.buffer),f=da.isLittleEndian?16777215:4294967040;for(let g=0;g<r;g++){const m=u.subarray(Math.floor(g*l)*t);for(let x=0;x<s;x++)d[c++]|=m[h[x]]&f}}else{const d=t*4;for(let f=0;f<s;f++)h[f]=Math.floor(f*o)*4;for(let f=0;f<r;f++){const g=n.subarray(Math.floor(f*l)*d);for(let m=0;m<s;m++){const x=h[m];e[c++]=g[x],e[c++]=g[x+1],e[c++]=g[x+2]}}}}function RU(n,e,t){if(t===1){const i=new Uint32Array(n.buffer),s=new Uint32Array(e.buffer),r=da.isLittleEndian?16777215:4294967040;for(let a=0,o=i.length;a<o;a++)s[a]|=i[a]&r}else{let i=0;for(let s=0,r=n.length;s<r;s+=4)e[i++]=n[s],e[i++]=n[s+1],e[i++]=n[s+2]}}var E5;const Ap=class Ap{constructor(e,t){this.name=e,this.numComps=t}getRgb(e,t,i=new Uint8ClampedArray(3)){return this.getRgbItem(e,t,i,0),i}getRgbHex(e,t){const i=this.getRgb(e,t,b(Ap,E5));return Dn.makeHexColor(i[0],i[1],i[2])}getRgbItem(e,t,i,s){kn("Should not call ColorSpace.getRgbItem")}getRgbBuffer(e,t,i,s,r,a,o){kn("Should not call ColorSpace.getRgbBuffer")}getOutputLength(e,t){kn("Should not call ColorSpace.getOutputLength")}isPassthrough(e){return!1}isDefaultDecode(e,t){return Ap.isDefaultDecode(e,this.numComps)}fillRgb(e,t,i,s,r,a,o,l,c){const h=t*i;let u=null;const d=1<<o,f=i!==r||t!==s;if(this.isPassthrough(o))u=l;else if(this.numComps===1&&h>d&&this.name!=="DeviceGray"&&this.name!=="DeviceRGB"){const g=o<=8?new Uint8Array(d):new Uint16Array(d);for(let x=0;x<d;x++)g[x]=x;const m=new Uint8ClampedArray(d*3);if(this.getRgbBuffer(g,0,d,m,0,o,0),f){u=new Uint8Array(h*3);let x=0;for(let p=0;p<h;++p){const y=l[p]*3;u[x++]=m[y],u[x++]=m[y+1],u[x++]=m[y+2]}}else{let x=0;for(let p=0;p<h;++p){const y=l[p]*3;e[x++]=m[y],e[x++]=m[y+1],e[x++]=m[y+2],x+=c}}}else f?(u=new Uint8ClampedArray(h*3),this.getRgbBuffer(l,0,h,u,0,o,0)):this.getRgbBuffer(l,0,s*a,e,0,o,c);if(u)if(f)EU(u,e,t,i,s,r,c);else{let g=0,m=0;for(let x=0,p=s*a;x<p;x++)e[g++]=u[m++],e[g++]=u[m++],e[g++]=u[m++],g+=c}}get usesZeroToOneRange(){return Ze(this,"usesZeroToOneRange",!0)}static isDefaultDecode(e,t){if(!Array.isArray(e))return!0;if(t*2!==e.length)return he("The decode map is not the correct length"),!0;for(let i=0,s=e.length;i<s;i+=2)if(e[i]!==0||e[i+1]!==1)return!1;return!0}};E5=new WeakMap,B(Ap,E5,new Uint8ClampedArray(3));let dr=Ap;class MU extends dr{constructor(e,t,i){super("Alternate",e),this.base=t,this.tintFn=i,this.tmpBuf=new Float32Array(t.numComps)}getRgbItem(e,t,i,s){const r=this.tmpBuf;this.tintFn(e,t,r,0),this.base.getRgbItem(r,0,i,s)}getRgbBuffer(e,t,i,s,r,a,o){const l=this.tintFn,c=this.base,h=1/((1<<a)-1),u=c.numComps,d=c.usesZeroToOneRange,f=(c.isPassthrough(8)||!d)&&o===0;let g=f?r:0;const m=f?s:new Uint8ClampedArray(u*i),x=this.numComps,p=new Float32Array(x),y=new Float32Array(u);let w,v;for(w=0;w<i;w++){for(v=0;v<x;v++)p[v]=e[t++]*h;if(l(p,0,y,0),d)for(v=0;v<u;v++)m[g++]=y[v]*255;else c.getRgbItem(y,0,m,g),g+=u}f||c.getRgbBuffer(m,0,i,s,r,8,o)}getOutputLength(e,t){return this.base.getOutputLength(e*this.base.numComps/this.numComps,t)}}class j_ extends dr{constructor(e){super("Pattern",null),this.base=e}isDefaultDecode(e,t){kn("Should not call PatternCS.isDefaultDecode")}}class PU extends dr{constructor(e,t,i){super("Indexed",1),this.base=e,this.highVal=t;const s=e.numComps*(t+1);if(this.lookup=new Uint8Array(s),i instanceof hn){const r=i.getBytes(s);this.lookup.set(r)}else if(typeof i=="string")for(let r=0;r<s;++r)this.lookup[r]=i.charCodeAt(r)&255;else throw new Ee(`IndexedCS - unrecognized lookup table: ${i}`)}getRgbItem(e,t,i,s){const{base:r,highVal:a,lookup:o}=this,l=Us(Math.round(e[t]),0,a)*r.numComps;r.getRgbBuffer(o,l,1,i,s,8,0)}getRgbBuffer(e,t,i,s,r,a,o){const{base:l,highVal:c,lookup:h}=this,{numComps:u}=l,d=l.getOutputLength(u,o);for(let f=0;f<i;++f){const g=Us(Math.round(e[t++]),0,c)*u;l.getRgbBuffer(h,g,1,s,r,8,o),r+=d}}getOutputLength(e,t){return this.base.getOutputLength(e*this.base.numComps,t)}isDefaultDecode(e,t){return Array.isArray(e)?e.length!==2?(he("Decode map length is not correct"),!0):!Number.isInteger(t)||t<1?(he("Bits per component is not correct"),!0):e[0]===0&&e[1]===(1<<t)-1:!0}}class NU extends dr{constructor(){super("DeviceGray",1)}getRgbItem(e,t,i,s){const r=e[t]*255;i[s]=i[s+1]=i[s+2]=r}getRgbBuffer(e,t,i,s,r,a,o){const l=255/((1<<a)-1);let c=t,h=r;for(let u=0;u<i;++u){const d=l*e[c++];s[h++]=d,s[h++]=d,s[h++]=d,h+=o}}getOutputLength(e,t){return e*(3+t)}}class OU extends dr{constructor(){super("DeviceRGB",3)}getRgbItem(e,t,i,s){i[s]=e[t]*255,i[s+1]=e[t+1]*255,i[s+2]=e[t+2]*255}getRgbBuffer(e,t,i,s,r,a,o){if(a===8&&o===0){s.set(e.subarray(t,t+i*3),r);return}const l=255/((1<<a)-1);let c=t,h=r;for(let u=0;u<i;++u)s[h++]=l*e[c++],s[h++]=l*e[c++],s[h++]=l*e[c++],h+=o}getOutputLength(e,t){return e*(3+t)/3|0}isPassthrough(e){return e===8}}class DU extends dr{constructor(){super("DeviceRGBA",4)}getOutputLength(e,t){return e*4}isPassthrough(e){return e===8}fillRgb(e,t,i,s,r,a,o,l,c){i!==r||t!==s?TU(l,e,t,i,s,r,c):RU(l,e,c)}}var Lb,E7;class rR extends dr{constructor(){super("DeviceCMYK",4);B(this,Lb)}getRgbItem(t,i,s,r){L(this,Lb,E7).call(this,t,i,1,s,r)}getRgbBuffer(t,i,s,r,a,o,l){const c=1/((1<<o)-1);for(let h=0;h<s;h++)L(this,Lb,E7).call(this,t,i,c,r,a),i+=4,a+=3+l}getOutputLength(t,i){return t/4*(3+i)|0}}Lb=new WeakSet,E7=function(t,i,s,r,a){const o=t[i]*s,l=t[i+1]*s,c=t[i+2]*s,h=t[i+3]*s;r[a]=255+o*(-4.387332384609988*o+54.48615194189176*l+18.82290502165302*c+212.25662451639585*h+-285.2331026137004)+l*(1.7149763477362134*l-5.6096736904047315*c+-17.873870861415444*h-5.497006427196366)+c*(-2.5217340131683033*c-21.248923337353073*h+17.5119270841813)+h*(-21.86122147463605*h-189.48180835922747),r[a+1]=255+o*(8.841041422036149*o+60.118027045597366*l+6.871425592049007*c+31.159100130055922*h+-79.2970844816548)+l*(-15.310361306967817*l+17.575251261109482*c+131.35250912493976*h-190.9453302588951)+c*(4.444339102852739*c+9.8632861493405*h-24.86741582555878)+h*(-20.737325471181034*h-187.80453709719578),r[a+2]=255+o*(.8842522430003296*o+8.078677503112928*l+30.89978309703729*c-.23883238689178934*h+-14.183576799673286)+l*(10.49593273432072*l+63.02378494754052*c+50.606957656360734*h-112.23884253719248)+c*(.03296041114873217*c+115.60384449646641*h+-193.58209356861505)+h*(-22.33816807309886*h-180.12613974708367)};var Fb,T7;class LU extends dr{constructor(t,i,s){super("CalGray",1);B(this,Fb);if(!t)throw new Ee("WhitePoint missing - required for color space CalGray");if([this.XW,this.YW,this.ZW]=t,[this.XB,this.YB,this.ZB]=i||[0,0,0],this.G=s||1,this.XW<0||this.ZW<0||this.YW!==1)throw new Ee(`Invalid WhitePoint components for ${this.name}, no fallback available`);(this.XB<0||this.YB<0||this.ZB<0)&&(gn(`Invalid BlackPoint for ${this.name}, falling back to default.`),this.XB=this.YB=this.ZB=0),(this.XB!==0||this.YB!==0||this.ZB!==0)&&he(`${this.name}, BlackPoint: XB: ${this.XB}, YB: ${this.YB}, ZB: ${this.ZB}, only default values are supported.`),this.G<1&&(gn(`Invalid Gamma: ${this.G} for ${this.name}, falling back to default.`),this.G=1)}getRgbItem(t,i,s,r){L(this,Fb,T7).call(this,t,i,s,r,1)}getRgbBuffer(t,i,s,r,a,o,l){const c=1/((1<<o)-1);for(let h=0;h<s;++h)L(this,Fb,T7).call(this,t,i,r,a,c),i+=1,a+=3+l}getOutputLength(t,i){return t*(3+i)}}Fb=new WeakSet,T7=function(t,i,s,r,a){const l=(t[i]*a)**this.G,c=this.YW*l,h=Math.max(295.8*c**.3333333333333333-40.8,0);s[r]=h,s[r+1]=h,s[r+2]=h};var Bb,Ub,T5,R5,Hb,ug,zb,M5,si,Sf,aR,oR,Y9,If,lR,cR,hR,M7;const Ti=class Ti extends dr{constructor(t,i,s,r){super("CalRGB",3);B(this,si);if(!t)throw new Ee("WhitePoint missing - required for color space CalRGB");const[a,o,l]=this.whitePoint=t,[c,h,u]=this.blackPoint=i||new Float32Array(3);if([this.GR,this.GG,this.GB]=s||new Float32Array([1,1,1]),[this.MXA,this.MYA,this.MZA,this.MXB,this.MYB,this.MZB,this.MXC,this.MYC,this.MZC]=r||new Float32Array([1,0,0,0,1,0,0,0,1]),a<0||l<0||o!==1)throw new Ee(`Invalid WhitePoint components for ${this.name}, no fallback available`);(c<0||h<0||u<0)&&(gn(`Invalid BlackPoint for ${this.name} [${c}, ${h}, ${u}], falling back to default.`),this.blackPoint=new Float32Array(3)),(this.GR<0||this.GG<0||this.GB<0)&&(gn(`Invalid Gamma [${this.GR}, ${this.GG}, ${this.GB}] for ${this.name}, falling back to default.`),this.GR=this.GG=this.GB=1)}getRgbItem(t,i,s,r){L(this,si,M7).call(this,t,i,s,r,1)}getRgbBuffer(t,i,s,r,a,o,l){const c=1/((1<<o)-1);for(let h=0;h<s;++h)L(this,si,M7).call(this,t,i,r,a,c),i+=3,a+=3+l}getOutputLength(t,i){return t*(3+i)/3|0}};Bb=new WeakMap,Ub=new WeakMap,T5=new WeakMap,R5=new WeakMap,Hb=new WeakMap,ug=new WeakMap,zb=new WeakMap,M5=new WeakMap,si=new WeakSet,Sf=function(t,i,s){s[0]=t[0]*i[0]+t[1]*i[1]+t[2]*i[2],s[1]=t[3]*i[0]+t[4]*i[1]+t[5]*i[2],s[2]=t[6]*i[0]+t[7]*i[1]+t[8]*i[2]},aR=function(t,i,s){s[0]=i[0]*1/t[0],s[1]=i[1]*1/t[1],s[2]=i[2]*1/t[2]},oR=function(t,i,s){s[0]=i[0]*.95047/t[0],s[1]=i[1]*1/t[1],s[2]=i[2]*1.08883/t[2]},Y9=function(t){return t<=.0031308?Us(12.92*t,0,1):t>=.99554525?1:Us((1+.055)*t**(1/2.4)-.055,0,1)},If=function(t){return t<0?-L(this,si,If).call(this,-t):t>8?((t+16)/116)**3:t*b(Ti,M5)},lR=function(t,i,s){if(t[0]===0&&t[1]===0&&t[2]===0){s[0]=i[0],s[1]=i[1],s[2]=i[2];return}const r=L(this,si,If).call(this,0),a=r,o=L(this,si,If).call(this,t[0]),l=r,c=L(this,si,If).call(this,t[1]),h=r,u=L(this,si,If).call(this,t[2]),d=(1-a)/(1-o),f=1-d,g=(1-l)/(1-c),m=1-g,x=(1-h)/(1-u),p=1-x;s[0]=i[0]*d+f,s[1]=i[1]*g+m,s[2]=i[2]*x+p},cR=function(t,i,s){if(t[0]===1&&t[2]===1){s[0]=i[0],s[1]=i[1],s[2]=i[2];return}const r=s;L(this,si,Sf).call(this,b(Ti,Bb),i,r);const a=b(Ti,Hb);L(this,si,aR).call(this,t,r,a),L(this,si,Sf).call(this,b(Ti,Ub),a,s)},hR=function(t,i,s){const r=s;L(this,si,Sf).call(this,b(Ti,Bb),i,r);const a=b(Ti,Hb);L(this,si,oR).call(this,t,r,a),L(this,si,Sf).call(this,b(Ti,Ub),a,s)},M7=function(t,i,s,r,a){const o=Us(t[i]*a,0,1),l=Us(t[i+1]*a,0,1),c=Us(t[i+2]*a,0,1),h=o===1?1:o**this.GR,u=l===1?1:l**this.GG,d=c===1?1:c**this.GB,f=this.MXA*h+this.MXB*u+this.MXC*d,g=this.MYA*h+this.MYB*u+this.MYC*d,m=this.MZA*h+this.MZB*u+this.MZC*d,x=b(Ti,ug);x[0]=f,x[1]=g,x[2]=m;const p=b(Ti,zb);L(this,si,cR).call(this,this.whitePoint,x,p);const y=b(Ti,ug);L(this,si,lR).call(this,this.blackPoint,p,y);const w=b(Ti,zb);L(this,si,hR).call(this,b(Ti,R5),y,w);const v=b(Ti,ug);L(this,si,Sf).call(this,b(Ti,T5),w,v),s[r]=L(this,si,Y9).call(this,v[0])*255,s[r+1]=L(this,si,Y9).call(this,v[1])*255,s[r+2]=L(this,si,Y9).call(this,v[2])*255},B(Ti,Bb,new Float32Array([.8951,.2664,-.1614,-.7502,1.7135,.0367,.0389,-.0685,1.0296])),B(Ti,Ub,new Float32Array([.9869929,-.1470543,.1599627,.4323053,.5183603,.0492912,-.0085287,.0400428,.9684867])),B(Ti,T5,new Float32Array([3.2404542,-1.5371385,-.4985314,-.969266,1.8760108,.041556,.0556434,-.2040259,1.0572252])),B(Ti,R5,new Float32Array([1,1,1])),B(Ti,Hb,new Float32Array(3)),B(Ti,ug,new Float32Array(3)),B(Ti,zb,new Float32Array(3)),B(Ti,M5,(24/116)**3/8);let R7=Ti;var Wa,J9,Z9,P7;class FU extends dr{constructor(t,i,s){super("Lab",3);B(this,Wa);if(!t)throw new Ee("WhitePoint missing - required for color space Lab");if([this.XW,this.YW,this.ZW]=t,[this.amin,this.amax,this.bmin,this.bmax]=s||[-100,100,-100,100],[this.XB,this.YB,this.ZB]=i||[0,0,0],this.XW<0||this.ZW<0||this.YW!==1)throw new Ee("Invalid WhitePoint components, no fallback available");(this.XB<0||this.YB<0||this.ZB<0)&&(gn("Invalid BlackPoint, falling back to default"),this.XB=this.YB=this.ZB=0),(this.amin>this.amax||this.bmin>this.bmax)&&(gn("Invalid Range, falling back to defaults"),this.amin=-100,this.amax=100,this.bmin=-100,this.bmax=100)}getRgbItem(t,i,s,r){L(this,Wa,P7).call(this,t,i,!1,s,r)}getRgbBuffer(t,i,s,r,a,o,l){const c=(1<<o)-1;for(let h=0;h<s;h++)L(this,Wa,P7).call(this,t,i,c,r,a),i+=3,a+=3+l}getOutputLength(t,i){return t*(3+i)/3|0}isDefaultDecode(t,i){return!0}get usesZeroToOneRange(){return Ze(this,"usesZeroToOneRange",!1)}}Wa=new WeakSet,J9=function(t){return t>=6/29?t**3:108/841*(t-4/29)},Z9=function(t,i,s,r){return s+t*(r-s)/i},P7=function(t,i,s,r,a){let o=t[i],l=t[i+1],c=t[i+2];s!==!1&&(o=L(this,Wa,Z9).call(this,o,s,0,100),l=L(this,Wa,Z9).call(this,l,s,this.amin,this.amax),c=L(this,Wa,Z9).call(this,c,s,this.bmin,this.bmax)),l>this.amax?l=this.amax:l<this.amin&&(l=this.amin),c>this.bmax?c=this.bmax:c<this.bmin&&(c=this.bmin);const h=(o+16)/116,u=h+l/500,d=h-c/200,f=this.XW*L(this,Wa,J9).call(this,u),g=this.YW*L(this,Wa,J9).call(this,h),m=this.ZW*L(this,Wa,J9).call(this,d);let x,p,y;this.ZW<1?(x=f*3.1339+g*-1.617+m*-.4906,p=f*-.9785+g*1.916+m*.0333,y=f*.072+g*-.229+m*1.4057):(x=f*3.2406+g*-1.5372+m*-.4986,p=f*-.9689+g*1.8758+m*.0415,y=f*.0557+g*-.204+m*1.057),r[a]=Math.sqrt(x)*255,r[a+1]=Math.sqrt(p)*255,r[a+2]=Math.sqrt(y)*255};function uR(n){const e=new XMLHttpRequest;return e.open("GET",n,!1),e.responseType="arraybuffer",e.send(null),e.response}var jl,mh,dg,fg,P5;const mu=class mu extends dr{constructor(t,i,s){if(!mu.isUsable)throw new Error("No ICC color space support");super(i,s);B(this,jl);B(this,mh);let r;switch(s){case 1:r=gw.Gray8,N(this,mh,(a,o,l)=>yU(b(this,jl),a[o]*255,l));break;case 3:r=gw.RGB8,N(this,mh,(a,o,l)=>wU(b(this,jl),a[o]*255,a[o+1]*255,a[o+2]*255,l));break;case 4:r=gw.CMYK,N(this,mh,(a,o,l)=>vU(b(this,jl),a[o]*255,a[o+1]*255,a[o+2]*255,a[o+3]*255,l));break;default:throw new Error(`Unsupported number of components: ${s}`)}if(N(this,jl,_U(t,r,CU.Perceptual)),!b(this,jl))throw new Error("Failed to create ICC color space");b(mu,P5).register(this,b(this,jl))}getRgbHex(t,i){return b(this,mh).call(this,t,i,!0),vi._cssColor}getRgbItem(t,i,s,r){vi._destBuffer=s,vi._destOffset=r,vi._destLength=3,b(this,mh).call(this,t,i,!1),vi._destBuffer=null}getRgbBuffer(t,i,s,r,a,o,l){if(t=t.subarray(i,i+s*this.numComps),o!==8){const c=255/((1<<o)-1);for(let h=0,u=t.length;h<u;h++)t[h]*=c}vi._mustAddAlpha=l&&r.buffer===t.buffer,vi._destBuffer=r,vi._destOffset=a,vi._destLength=s*(3+l),xU(b(this,jl),t),vi._mustAddAlpha=!1,vi._destBuffer=null}getOutputLength(t,i){return t/this.numComps*(3+i)|0}static setOptions({useWasm:t,useWorkerFetch:i,wasmUrl:s}){if(!i){N(this,dg,!1);return}N(this,dg,t),N(this,fg,s)}static get isUsable(){let t=!1;if(b(this,dg))if(b(this,fg))try{this._module=IU({module:uR(`${b(this,fg)}qcms_bg.wasm`)}),t=!!this._module,vi._memory=this._module.memory,vi._makeHexColor=Dn.makeHexColor}catch(i){he(`ICCBased color space: "${i}".`)}else he("No ICC color space support due to missing `wasmUrl` API option");return Ze(this,"isUsable",t)}};jl=new WeakMap,mh=new WeakMap,dg=new WeakMap,fg=new WeakMap,P5=new WeakMap,B(mu,dg,!0),B(mu,fg,null),B(mu,P5,new FinalizationRegistry(t=>{kU(t)}));let qd=mu;var gg;const N5=class N5 extends qd{constructor(){const e=new Uint8Array(uR(`${b(N5,gg)}CGATS001Compat-v2-micro.icc`));super(e,"DeviceCMYK",4)}static setOptions({iccUrl:e}){N(this,gg,e)}static get isUsable(){let e=!1;return qd.isUsable&&(b(this,gg)?e=!0:he("No CMYK ICC profile support due to missing `iccUrl` API option")),Ze(this,"isUsable",e)}};gg=new WeakMap,B(N5,gg);let Bp=N5;class Ui extends hn{constructor(e,t,i,s){super(),this.bytes=e instanceof Uint8Array?e:new Uint8Array(e),this.start=t||0,this.pos=this.start,this.end=t+i||this.bytes.length,this.dict=s}get length(){return this.end-this.start}get isEmpty(){return this.length===0}getByte(){return this.pos>=this.end?-1:this.bytes[this.pos++]}getBytes(e){const t=this.bytes,i=this.pos,s=this.end;if(!e)return t.subarray(i,s);let r=i+e;return r>s&&(r=s),this.pos=r,t.subarray(i,r)}getByteRange(e,t){return e<0&&(e=0),t>this.end&&(t=this.end),this.bytes.subarray(e,t)}reset(){this.pos=this.start}moveStart(){this.start=this.pos}makeSubStream(e,t,i=null){return new Ui(this.bytes.buffer,e,t,i)}}class Yr extends Ui{constructor(e){super(lr(e))}}class N7 extends Ui{constructor(){super(new Uint8Array(0))}}class BU extends Ui{constructor(e,t,i){super(new Uint8Array(e),0,e,null),this.chunkSize=t,this._loadedChunks=new Set,this.numChunks=Math.ceil(e/t),this.manager=i,this.progressiveDataLength=0,this.lastSuccessfulEnsureByteChunk=-1}getMissingChunks(){const e=[];for(let t=0,i=this.numChunks;t<i;++t)this._loadedChunks.has(t)||e.push(t);return e}get numChunksLoaded(){return this._loadedChunks.size}get isDataLoaded(){return this.numChunksLoaded===this.numChunks}onReceiveData(e,t){const i=this.chunkSize;if(e%i!==0)throw new Error(`Bad begin offset: ${e}`);const s=e+t.byteLength;if(s%i!==0&&s!==this.bytes.length)throw new Error(`Bad end offset: ${s}`);this.bytes.set(new Uint8Array(t),e);const r=Math.floor(e/i),a=Math.floor((s-1)/i)+1;for(let o=r;o<a;++o)this._loadedChunks.add(o)}onReceiveProgressiveData(e){let t=this.progressiveDataLength;const i=Math.floor(t/this.chunkSize);this.bytes.set(new Uint8Array(e),t),t+=e.byteLength,this.progressiveDataLength=t;const s=t>=this.end?this.numChunks:Math.floor(t/this.chunkSize);for(let r=i;r<s;++r)this._loadedChunks.add(r)}ensureByte(e){if(e<this.progressiveDataLength)return;const t=Math.floor(e/this.chunkSize);if(!(t>this.numChunks)&&t!==this.lastSuccessfulEnsureByteChunk){if(!this._loadedChunks.has(t))throw new bi(e,e+1);this.lastSuccessfulEnsureByteChunk=t}}ensureRange(e,t){if(e>=t||t<=this.progressiveDataLength)return;const i=Math.floor(e/this.chunkSize);if(i>this.numChunks)return;const s=Math.min(Math.floor((t-1)/this.chunkSize)+1,this.numChunks);for(let r=i;r<s;++r)if(!this._loadedChunks.has(r))throw new bi(e,t)}nextEmptyChunk(e){const t=this.numChunks;for(let i=0;i<t;++i){const s=(e+i)%t;if(!this._loadedChunks.has(s))return s}return null}hasChunk(e){return this._loadedChunks.has(e)}getByte(){const e=this.pos;return e>=this.end?-1:(e>=this.progressiveDataLength&&this.ensureByte(e),this.bytes[this.pos++])}getBytes(e){const t=this.bytes,i=this.pos,s=this.end;if(!e)return s>this.progressiveDataLength&&this.ensureRange(i,s),t.subarray(i,s);let r=i+e;return r>s&&(r=s),r>this.progressiveDataLength&&this.ensureRange(i,r),this.pos=r,t.subarray(i,r)}getByteRange(e,t){return e<0&&(e=0),t>this.end&&(t=this.end),t>this.progressiveDataLength&&this.ensureRange(e,t),this.bytes.subarray(e,t)}makeSubStream(e,t,i=null){t?e+t>this.progressiveDataLength&&this.ensureRange(e,e+t):e>=this.progressiveDataLength&&this.ensureByte(e);function s(){}s.prototype=Object.create(this),s.prototype.getMissingChunks=function(){const a=this.chunkSize,o=Math.floor(this.start/a),l=Math.floor((this.end-1)/a)+1,c=[];for(let h=o;h<l;++h)this._loadedChunks.has(h)||c.push(h);return c},Object.defineProperty(s.prototype,"isDataLoaded",{get(){return this.numChunksLoaded===this.numChunks?!0:this.getMissingChunks().length===0},configurable:!0});const r=new s;return r.pos=r.start=e,r.end=e+t||this.end,r.dict=i,r}getBaseStreams(){return[this]}}class UU{constructor(e,t){this.length=t.length,this.chunkSize=t.rangeChunkSize,this.stream=new BU(this.length,this.chunkSize,this),this.pdfNetworkStream=e,this.disableAutoFetch=t.disableAutoFetch,this.msgHandler=t.msgHandler,this.currRequestId=0,this._chunksNeededByRequest=new Map,this._requestsByChunk=new Map,this._promisesByRequest=new Map,this.progressiveDataLength=0,this.aborted=!1,this._loadedStreamCapability=Promise.withResolvers()}sendRequest(e,t){const i=this.pdfNetworkStream.getRangeReader(e,t);i.isStreamingSupported||(i.onProgress=this.onProgress.bind(this));let s=[],r=0;return new Promise((a,o)=>{const l=({value:c,done:h})=>{try{if(h){const u=ZT(s);s=null,a(u);return}r+=c.byteLength,i.isStreamingSupported&&this.onProgress({loaded:r}),s.push(c),i.read().then(l,o)}catch(u){o(u)}};i.read().then(l,o)}).then(a=>{this.aborted||this.onReceiveData({chunk:a,begin:e})})}requestAllChunks(e=!1){if(!e){const t=this.stream.getMissingChunks();this._requestChunks(t)}return this._loadedStreamCapability.promise}_requestChunks(e){const t=this.currRequestId++,i=new Set;this._chunksNeededByRequest.set(t,i);for(const a of e)this.stream.hasChunk(a)||i.add(a);if(i.size===0)return Promise.resolve();const s=Promise.withResolvers();this._promisesByRequest.set(t,s);const r=[];for(const a of i){let o=this._requestsByChunk.get(a);o||(o=[],this._requestsByChunk.set(a,o),r.push(a)),o.push(t)}if(r.length>0){const a=this.groupChunks(r);for(const o of a){const l=o.beginChunk*this.chunkSize,c=Math.min(o.endChunk*this.chunkSize,this.length);this.sendRequest(l,c).catch(s.reject)}}return s.promise.catch(a=>{if(!this.aborted)throw a})}getStream(){return this.stream}requestRange(e,t){t=Math.min(t,this.length);const i=this.getBeginChunk(e),s=this.getEndChunk(t),r=[];for(let a=i;a<s;++a)r.push(a);return this._requestChunks(r)}requestRanges(e=[]){const t=[];for(const i of e){const s=this.getBeginChunk(i.begin),r=this.getEndChunk(i.end);for(let a=s;a<r;++a)t.includes(a)||t.push(a)}return t.sort((i,s)=>i-s),this._requestChunks(t)}groupChunks(e){const t=[];let i=-1,s=-1;for(let r=0,a=e.length;r<a;++r){const o=e[r];i<0&&(i=o),s>=0&&s+1!==o&&(t.push({beginChunk:i,endChunk:s+1}),i=o),r+1===e.length&&t.push({beginChunk:i,endChunk:o+1}),s=o}return t}onProgress(e){this.msgHandler.send("DocProgress",{loaded:this.stream.numChunksLoaded*this.chunkSize+e.loaded,total:this.length})}onReceiveData(e){const t=e.chunk,i=e.begin===void 0,s=i?this.progressiveDataLength:e.begin,r=s+t.byteLength,a=Math.floor(s/this.chunkSize),o=r<this.length?Math.floor(r/this.chunkSize):Math.ceil(r/this.chunkSize);i?(this.stream.onReceiveProgressiveData(t),this.progressiveDataLength=r):this.stream.onReceiveData(s,t),this.stream.isDataLoaded&&this._loadedStreamCapability.resolve(this.stream);const l=[];for(let c=a;c<o;++c){const h=this._requestsByChunk.get(c);if(h){this._requestsByChunk.delete(c);for(const u of h){const d=this._chunksNeededByRequest.get(u);d.has(c)&&d.delete(c),!(d.size>0)&&l.push(u)}}}if(!this.disableAutoFetch&&this._requestsByChunk.size===0){let c;if(this.stream.numChunksLoaded===1){const h=this.stream.numChunks-1;this.stream.hasChunk(h)||(c=h)}else c=this.stream.nextEmptyChunk(o);Number.isInteger(c)&&this._requestChunks([c])}for(const c of l){const h=this._promisesByRequest.get(c);this._promisesByRequest.delete(c),h.resolve()}this.msgHandler.send("DocProgress",{loaded:this.stream.numChunksLoaded*this.chunkSize,total:this.length})}onError(e){this._loadedStreamCapability.reject(e)}getBeginChunk(e){return Math.floor(e/this.chunkSize)}getEndChunk(e){return Math.floor((e-1)/this.chunkSize)+1}abort(e){var t;this.aborted=!0,(t=this.pdfNetworkStream)==null||t.cancelAllRequests(e);for(const i of this._promisesByRequest.values())i.reject(e)}}function dR(n){switch(n.kind){case Os.GRAYSCALE_1BPP:return O7(n);case Os.RGB_24BPP:return HU(n)}return null}function O7({src:n,srcPos:e=0,dest:t,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=da.isLittleEndian?4278190080:255,[l,c]=a?[r,o]:[o,r],h=i>>3,u=i&7,d=n.length;t=new Uint32Array(t.buffer);let f=0;for(let g=0;g<s;g++){for(const x=e+h;e<x;e++){const p=e<d?n[e]:255;t[f++]=p&128?c:l,t[f++]=p&64?c:l,t[f++]=p&32?c:l,t[f++]=p&16?c:l,t[f++]=p&8?c:l,t[f++]=p&4?c:l,t[f++]=p&2?c:l,t[f++]=p&1?c:l}if(u===0)continue;const m=e<d?n[e++]:255;for(let x=0;x<u;x++)t[f++]=m&1<<7-x?c:l}return{srcPos:e,destPos:f}}function HU({src:n,srcPos:e=0,dest:t,destPos:i=0,width:s,height:r}){let a=0;const o=s*r*3,l=o>>2,c=new Uint32Array(n.buffer,e,l);if(da.isLittleEndian){for(;a<l-2;a+=3,i+=4){const h=c[a],u=c[a+1],d=c[a+2];t[i]=h|4278190080,t[i+1]=h>>>24|u<<8|4278190080,t[i+2]=u>>>16|d<<16|4278190080,t[i+3]=d>>>8|4278190080}for(let h=a*4,u=e+o;h<u;h+=3)t[i++]=n[h]|n[h+1]<<8|n[h+2]<<16|4278190080}else{for(;a<l-2;a+=3,i+=4){const h=c[a],u=c[a+1],d=c[a+2];t[i]=h|255,t[i+1]=h<<24|u>>>8|255,t[i+2]=u<<16|d>>>16|255,t[i+3]=d<<8|255}for(let h=a*4,u=e+o;h<u;h+=3)t[i++]=n[h]<<24|n[h+1]<<16|n[h+2]<<8|255}return{srcPos:e+o,destPos:i}}function zU(n,e){if(da.isLittleEndian)for(let t=0,i=n.length;t<i;t++)e[t]=n[t]*65793|4278190080;else for(let t=0,i=n.length;t<i;t++)e[t]=n[t]*16843008|255}const G_=2048,jU=65537,V_=128;var ro,jb,O5,fR;const E0=class E0{constructor(e,t){B(this,O5);this._imgData=e,this._isMask=t}static get canUseImageDecoder(){return Ze(this,"canUseImageDecoder",b(this,jb)?ImageDecoder.isTypeSupported("image/bmp"):Promise.resolve(!1))}static needsToBeResized(e,t){if(e<=b(this,ro)&&t<=b(this,ro))return!1;const{MAX_DIM:i}=this;if(e>i||t>i)return!0;const s=e*t;if(this._hasMaxArea)return s>this.MAX_AREA;if(s<b(this,ro)**2)return!1;if(this._areGoodDims(e,t))return N(this,ro,Math.max(b(this,ro),Math.floor(Math.sqrt(e*t)))),!1;N(this,ro,this._guessMax(b(this,ro),i,V_,0));const r=this.MAX_AREA=b(this,ro)**2;return s>r}static getReducePowerForJPX(e,t,i){const s=e*t,r=2**30/(i*4);if(!this.needsToBeResized(e,t))return s>r?Math.ceil(Math.log2(s/r)):0;const{MAX_DIM:a,MAX_AREA:o}=this,l=Math.max(e/a,t/a,Math.sqrt(s/Math.min(r,o)));return Math.ceil(Math.log2(l))}static get MAX_DIM(){return Ze(this,"MAX_DIM",this._guessMax(G_,jU,0,1))}static get MAX_AREA(){return this._hasMaxArea=!0,Ze(this,"MAX_AREA",this._guessMax(b(this,ro),this.MAX_DIM,V_,0)**2)}static set MAX_AREA(e){e>=0&&(this._hasMaxArea=!0,Ze(this,"MAX_AREA",e))}static setOptions({canvasMaxAreaInBytes:e=-1,isImageDecoderSupported:t=!1}){this._hasMaxArea||(this.MAX_AREA=e>>2),N(this,jb,t)}static _areGoodDims(e,t){try{const i=new OffscreenCanvas(e,t),s=i.getContext("2d");s.fillRect(0,0,1,1);const r=s.getImageData(0,0,1,1).data[3];return i.width=i.height=1,r!==0}catch{return!1}}static _guessMax(e,t,i,s){for(;e+i+1<t;){const r=Math.floor((e+t)/2),a=s||r;this._areGoodDims(r,a)?e=r:t=r}return e}static async createImage(e,t=!1){return new E0(e,t)._createImage()}async _createImage(){const{_imgData:e}=this,{width:t,height:i}=e;if(t*i*4>v7){const y=L(this,O5,fR).call(this);if(y)return y}const s=this._encodeBMP();let r,a;await E0.canUseImageDecoder?(r=new ImageDecoder({data:s,type:"image/bmp",preferAnimation:!1,transfer:[s.buffer]}),a=r.decode().catch(y=>(he(`BMP image decoding failed: ${y}`),createImageBitmap(new Blob([this._encodeBMP().buffer],{type:"image/bmp"})))).finally(()=>{r.close()})):a=createImageBitmap(new Blob([s.buffer],{type:"image/bmp"}));const{MAX_AREA:o,MAX_DIM:l}=E0,c=Math.max(t/l,i/l,Math.sqrt(t*i/o)),h=Math.max(c,2),u=Math.round(10*(c+1.25))/10/h,d=Math.floor(Math.log2(u)),f=new Array(d+2).fill(2);f[0]=h,f.splice(-1,1,u/(1<<d));let g=t,m=i;const x=await a;let p=x.image||x;for(const y of f){const w=g,v=m;g=Math.floor(g/y)-1,m=Math.floor(m/y)-1;const _=new OffscreenCanvas(g,m);_.getContext("2d").drawImage(p,0,0,w,v,0,0,g,m),p.close(),p=_.transferToImageBitmap()}return e.data=null,e.bitmap=p,e.width=g,e.height=m,e}_encodeBMP(){const{width:e,height:t,kind:i}=this._imgData;let s=this._imgData.data,r,a=new Uint8Array(0),o=a,l=0;switch(i){case Os.GRAYSCALE_1BPP:{r=1,a=new Uint8Array(this._isMask?[255,255,255,255,0,0,0,0]:[0,0,0,0,255,255,255,255]);const m=e+7>>3,x=m+3&-4;if(m!==x){const p=new Uint8Array(x*t);let y=0;for(let w=0,v=t*m;w<v;w+=m,y+=x)p.set(s.subarray(w,w+m),y);s=p}break}case Os.RGB_24BPP:{if(r=24,e&3){const m=3*e,x=m+3&-4,p=x-m,y=new Uint8Array(x*t);let w=0;for(let v=0,_=t*m;v<_;v+=m){const C=s.subarray(v,v+m);for(let k=0;k<m;k+=3)y[w++]=C[k+2],y[w++]=C[k+1],y[w++]=C[k];w+=p}s=y}else for(let m=0,x=s.length;m<x;m+=3){const p=s[m];s[m]=s[m+2],s[m+2]=p}break}case Os.RGBA_32BPP:r=32,l=3,o=new Uint8Array(68);const g=new DataView(o.buffer);da.isLittleEndian?(g.setUint32(0,255,!0),g.setUint32(4,65280,!0),g.setUint32(8,16711680,!0),g.setUint32(12,4278190080,!0)):(g.setUint32(0,4278190080,!0),g.setUint32(4,16711680,!0),g.setUint32(8,65280,!0),g.setUint32(12,255,!0));break;default:throw new Error("invalid format")}let c=0;const h=40+o.length,u=14+h+a.length+s.length,d=new Uint8Array(u),f=new DataView(d.buffer);return f.setUint16(c,19778,!0),c+=2,f.setUint32(c,u,!0),c+=4,f.setUint32(c,0,!0),c+=4,f.setUint32(c,14+h+a.length,!0),c+=4,f.setUint32(c,h,!0),c+=4,f.setInt32(c,e,!0),c+=4,f.setInt32(c,-t,!0),c+=4,f.setUint16(c,1,!0),c+=2,f.setUint16(c,r,!0),c+=2,f.setUint32(c,l,!0),c+=4,f.setUint32(c,0,!0),c+=4,f.setInt32(c,0,!0),c+=4,f.setInt32(c,0,!0),c+=4,f.setUint32(c,a.length/4,!0),c+=4,f.setUint32(c,0,!0),c+=4,d.set(o,c),c+=o.length,d.set(a,c),c+=a.length,d.set(s,c),d}};ro=new WeakMap,jb=new WeakMap,O5=new WeakSet,fR=function(){const{_imgData:e}=this,{data:t,width:i,height:s,kind:r}=e,a=i*s*4,o=Math.ceil(Math.log2(a/v7)),l=i>>o,c=s>>o;let h,u=s;try{h=new Uint8Array(a)}catch{let v=Math.floor(Math.log2(a+1));for(;;)try{h=new Uint8Array(2**v-1);break}catch{v-=1}u=Math.floor((2**v-1)/(i*4));const _=i*u*4;_<h.length&&(h=new Uint8Array(_))}const d=new Uint32Array(h.buffer),f=new Uint32Array(l*c);let g=0,m=0;const x=Math.ceil(s/u),p=s%u===0?s:s%u;for(let v=0;v<x;v++){const _=v<x-1?u:p;({srcPos:g}=dR({kind:r,src:t,dest:d,width:i,height:_,inverseDecode:this._isMask,srcPos:g}));for(let C=0,k=_>>o;C<k;C++){const I=d.subarray((C<<o)*i);for(let S=0;S<l;S++)f[m++]=I[S<<o]}}if(E0.needsToBeResized(l,c))return e.data=f,e.width=l,e.height=c,e.kind=Os.RGBA_32BPP,null;const y=new OffscreenCanvas(l,c);return y.getContext("2d",{willReadFrequently:!0}).putImageData(new ImageData(new Uint8ClampedArray(f.buffer),l,c),0,0),e.data=null,e.bitmap=y.transferToImageBitmap(),e.width=l,e.height=c,e},B(E0,ro,G_),B(E0,jb,da.isImageDecoderSupported);let Ro=E0;const GU=new Uint8Array(0);class Jr extends hn{constructor(e){if(super(),this._rawMinBufferLength=e||0,this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=GU,this.minBufferLength=512,e)for(;this.minBufferLength<e;)this.minBufferLength*=2}get isEmpty(){for(;!this.eof&&this.bufferLength===0;)this.readBlock();return this.bufferLength===0}ensureBuffer(e){const t=this.buffer;if(e<=t.byteLength)return t;let i=this.minBufferLength;for(;i<e;)i*=2;const s=new Uint8Array(i);return s.set(t),this.buffer=s}getByte(){const e=this.pos;for(;this.bufferLength<=e;){if(this.eof)return-1;this.readBlock()}return this.buffer[this.pos++]}getBytes(e,t=null){const i=this.pos;let s;if(e){for(this.ensureBuffer(i+e),s=i+e;!this.eof&&this.bufferLength<s;)this.readBlock(t);const r=this.bufferLength;s>r&&(s=r)}else{for(;!this.eof;)this.readBlock(t);s=this.bufferLength}return this.pos=s,this.buffer.subarray(i,s)}async getImageData(e,t){if(!this.canAsyncDecodeImageFromBuffer)return this.isAsyncDecoder?this.decodeImage(null,t):this.getBytes(e,t);const i=await this.stream.asyncGetBytes();return this.decodeImage(i,t)}reset(){this.pos=0}makeSubStream(e,t,i=null){if(t===void 0)for(;!this.eof;)this.readBlock();else{const s=e+t;for(;this.bufferLength<=s&&!this.eof;)this.readBlock()}return new Ui(this.buffer,e,t,i)}getBaseStreams(){return this.str?this.str.getBaseStreams():null}}class VU extends Jr{constructor(e,t=null){e=e.filter(s=>s instanceof hn);let i=0;for(const s of e)i+=s instanceof Jr?s._rawMinBufferLength:s.length;super(i),this.streams=e,this._onError=t}readBlock(){var o;const e=this.streams;if(e.length===0){this.eof=!0;return}const t=e.shift();let i;try{i=t.getBytes()}catch(l){if(this._onError){this._onError(l,(o=t.dict)==null?void 0:o.objId);return}throw l}const s=this.bufferLength,r=s+i.length;this.ensureBuffer(r).set(i,s),this.bufferLength=r}getBaseStreams(){const e=[];for(const t of this.streams){const i=t.getBaseStreams();i&&e.push(...i)}return e.length>0?e:null}}var $o,sp,Q9;class Nn{static parse({cs:e,xref:t,resources:i=null,pdfFunctionFactory:s,globalColorSpaceCache:r,localColorSpaceCache:a,asyncIfNotCached:o=!1}){const l={xref:t,resources:i,pdfFunctionFactory:s,globalColorSpaceCache:r,localColorSpaceCache:a};let c,h,u;if(e instanceof st){h=e;const d=r.getByRef(h)||a.getByRef(h);if(d)return d;e=t.fetch(e)}if(e instanceof _e){c=e.name;const d=a.getByName(c);if(d)return d}try{u=L(this,$o,Q9).call(this,e,l)}catch(d){if(o&&!(d instanceof bi))return Promise.reject(d);throw d}return(c||h)&&(a.set(c,h,u),h&&r.set(null,h,u)),o?Promise.resolve(u):u}static get gray(){return Ze(this,"gray",new NU)}static get rgb(){return Ze(this,"rgb",new OU)}static get rgba(){return Ze(this,"rgba",new DU)}static get cmyk(){if(Bp.isUsable)try{return Ze(this,"cmyk",new Bp)}catch{he("CMYK fallback: DeviceCMYK")}return Ze(this,"cmyk",new rR)}}$o=new WeakSet,sp=function(e,t){const{globalColorSpaceCache:i}=t;let s;if(e instanceof st){s=e;const a=i.getByRef(s);if(a)return a}const r=L(this,$o,Q9).call(this,e,t);return s&&i.set(null,s,r),r},Q9=function(e,t){const{xref:i,resources:s,pdfFunctionFactory:r,globalColorSpaceCache:a}=t;if(e=i.fetchIfRef(e),e instanceof _e)switch(e.name){case"G":case"DeviceGray":return this.gray;case"RGB":case"DeviceRGB":return this.rgb;case"DeviceRGBA":return this.rgba;case"CMYK":case"DeviceCMYK":return this.cmyk;case"Pattern":return new j_(null);default:if(s instanceof fe){const o=s.get("ColorSpace");if(o instanceof fe){const l=o.get(e.name);if(l){if(l instanceof _e)return L(this,$o,Q9).call(this,l,t);e=l;break}}}return he(`Unrecognized ColorSpace: ${e.name}`),this.gray}if(Array.isArray(e)){const o=i.fetchIfRef(e[0]).name;let l,c,h,u,d,f;switch(o){case"G":case"DeviceGray":return this.gray;case"RGB":case"DeviceRGB":return this.rgb;case"CMYK":case"DeviceCMYK":return this.cmyk;case"CalGray":return l=i.fetchIfRef(e[1]),u=l.getArray("WhitePoint"),d=l.getArray("BlackPoint"),f=l.get("Gamma"),new LU(u,d,f);case"CalRGB":l=i.fetchIfRef(e[1]),u=l.getArray("WhitePoint"),d=l.getArray("BlackPoint"),f=l.getArray("Gamma");const g=l.getArray("Matrix");return new R7(u,d,f,g);case"ICCBased":const m=e[1]instanceof st;if(m){const I=a.getByRef(e[1]);if(I)return I}const x=i.fetchIfRef(e[1]),p=x.dict;if(c=p.get("N"),qd.isUsable)try{const I=new qd(x.getBytes(),"ICCBased",c);return m&&a.set(null,e[1],I),I}catch(I){if(I instanceof bi)throw I;he(`ICCBased color space (${e[1]}): "${I}".`)}const y=p.getRaw("Alternate");if(y){const I=L(this,$o,sp).call(this,y,t);if(I.numComps===c)return I;he("ICCBased color space: Ignoring incorrect /Alternate entry.")}if(c===1)return this.gray;if(c===3)return this.rgb;if(c===4)return this.cmyk;break;case"Pattern":return h=e[1]||null,h&&(h=L(this,$o,sp).call(this,h,t)),new j_(h);case"I":case"Indexed":h=L(this,$o,sp).call(this,e[1],t);const w=Us(i.fetchIfRef(e[2]),0,255),v=i.fetchIfRef(e[3]);return new PU(h,w,v);case"Separation":case"DeviceN":const _=i.fetchIfRef(e[1]);c=Array.isArray(_)?_.length:1,h=L(this,$o,sp).call(this,e[2],t);const C=r.create(e[3]);return new MU(c,h,C);case"Lab":l=i.fetchIfRef(e[1]),u=l.getArray("WhitePoint"),d=l.getArray("BlackPoint");const k=l.getArray("Range");return new FU(u,d,k);default:return he(`Unimplemented ColorSpace object: ${o}`),this.gray}}return he(`Unrecognized ColorSpace object: ${e}`),this.gray},B(Nn,$o);class ao extends Qr{constructor(e){super(e,"JpegError")}}class D7 extends Qr{constructor(e,t){super(e,"DNLMarkerError"),this.scanLines=t}}class gR extends Qr{constructor(e){super(e,"EOIMarkerError")}}const fp=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),Lx=4017,Fx=799,Bx=3406,Ux=2276,Hx=1567,zx=3784,uf=5793,jx=2896;function qU(n,e){let t=0,i,s,r=16;for(;r>0&&!n[r-1];)r--;const a=[{children:[],index:0}];let o=a[0],l;for(i=0;i<r;i++){for(s=0;s<n[i];s++){for(o=a.pop(),o.children[o.index]=e[t];o.index>0;)o=a.pop();for(o.index++,a.push(o);a.length<=i;)a.push(l={children:[],index:0}),o.children[o.index]=l.children,o=l;t++}i+1<r&&(a.push(l={children:[],index:0}),o.children[o.index]=l.children,o=l)}return a[0].children}function L7(n,e,t){return 64*((n.blocksPerLine+1)*e+t)}function WU(n,e,t,i,s,r,a,o,l,c=!1){const h=t.mcusPerLine,u=t.progressive,d=e;let f=0,g=0;function m(){if(g>0)return g--,f>>g&1;if(f=n[e++],f===255){const de=n[e++];if(de){if(de===220&&c){e+=2;const O=xn(n,e);if(e+=2,O>0&&O!==t.scanLines)throw new D7("Found DNL marker (0xFFDC) while parsing scan data",O)}else if(de===217){if(c){const O=P*(t.precision===8?8:0);if(O>0&&Math.round(t.scanLines/O)>=5)throw new D7("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",O)}throw new gR("Found EOI marker (0xFFD9) while parsing scan data")}throw new ao(`unexpected marker ${(f<<8|de).toString(16)}`)}}return g=7,f>>>7}function x(de){let O=de;for(;;){switch(O=O[m()],typeof O){case"number":return O;case"object":continue}throw new ao("invalid huffman sequence")}}function p(de){let O=0;for(;de>0;)O=O<<1|m(),de--;return O}function y(de){if(de===1)return m()===1?1:-1;const O=p(de);return O>=1<<de-1?O:O+(-1<<de)+1}function w(de,O){const Y=x(de.huffmanTableDC),le=Y===0?0:y(Y);de.blockData[O]=de.pred+=le;let $=1;for(;$<64;){const re=x(de.huffmanTableAC),oe=re&15,ee=re>>4;if(oe===0){if(ee<15)break;$+=16;continue}$+=ee;const Q=fp[$];de.blockData[O+Q]=y(oe),$++}}function v(de,O){const Y=x(de.huffmanTableDC),le=Y===0?0:y(Y)<<l;de.blockData[O]=de.pred+=le}function _(de,O){de.blockData[O]|=m()<<l}let C=0;function k(de,O){if(C>0){C--;return}let Y=r;const le=a;for(;Y<=le;){const $=x(de.huffmanTableAC),re=$&15,oe=$>>4;if(re===0){if(oe<15){C=p(oe)+(1<<oe)-1;break}Y+=16;continue}Y+=oe;const ee=fp[Y];de.blockData[O+ee]=y(re)*(1<<l),Y++}}let I=0,S;function R(de,O){let Y=r;const le=a;let $=0,re,oe;for(;Y<=le;){const ee=O+fp[Y],Q=de.blockData[ee]<0?-1:1;switch(I){case 0:if(oe=x(de.huffmanTableAC),re=oe&15,$=oe>>4,re===0)$<15?(C=p($)+(1<<$),I=4):($=16,I=1);else{if(re!==1)throw new ao("invalid ACn encoding");S=y(re),I=$?2:3}continue;case 1:case 2:de.blockData[ee]?de.blockData[ee]+=Q*(m()<<l):($--,$===0&&(I=I===2?3:0));break;case 3:de.blockData[ee]?de.blockData[ee]+=Q*(m()<<l):(de.blockData[ee]=S<<l,I=0);break;case 4:de.blockData[ee]&&(de.blockData[ee]+=Q*(m()<<l));break}Y++}I===4&&(C--,C===0&&(I=0))}let P=0;function D(de,O,Y,le,$){const re=Y/h|0,oe=Y%h;P=re*de.v+le;const ee=oe*de.h+$,Q=L7(de,P,ee);O(de,Q)}function U(de,O,Y){P=Y/de.blocksPerLine|0;const le=Y%de.blocksPerLine,$=L7(de,P,le);O(de,$)}const T=i.length;let G,M,F,X,z,K;u?r===0?K=o===0?v:_:K=o===0?k:R:K=w;let j=0,ae;const ge=T===1?i[0].blocksPerLine*i[0].blocksPerColumn:h*t.mcusPerColumn;let ue,pe;for(;j<=ge;){const de=s?Math.min(ge-j,s):ge;if(de>0){for(M=0;M<T;M++)i[M].pred=0;if(C=0,T===1)for(G=i[0],z=0;z<de;z++)U(G,K,j),j++;else for(z=0;z<de;z++){for(M=0;M<T;M++)for(G=i[M],ue=G.h,pe=G.v,F=0;F<pe;F++)for(X=0;X<ue;X++)D(G,K,j,F,X);j++}}if(g=0,ae=$5(n,e),!ae)break;if(ae.invalid){const O=de>0?"unexpected":"excessive";he(`decodeScan - ${O} MCU data, current marker is: ${ae.invalid}`),e=ae.offset}if(ae.marker>=65488&&ae.marker<=65495)e+=2;else break}return e-d}function KU(n,e,t){const i=n.quantizationTable,s=n.blockData;let r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,v,_;if(!i)throw new ao("missing required Quantization Table.");for(let C=0;C<64;C+=8){if(f=s[e+C],g=s[e+C+1],m=s[e+C+2],x=s[e+C+3],p=s[e+C+4],y=s[e+C+5],w=s[e+C+6],v=s[e+C+7],f*=i[C],!(g|m|x|p|y|w|v)){_=uf*f+512>>10,t[C]=_,t[C+1]=_,t[C+2]=_,t[C+3]=_,t[C+4]=_,t[C+5]=_,t[C+6]=_,t[C+7]=_;continue}g*=i[C+1],m*=i[C+2],x*=i[C+3],p*=i[C+4],y*=i[C+5],w*=i[C+6],v*=i[C+7],r=uf*f+128>>8,a=uf*p+128>>8,o=m,l=w,c=jx*(g-v)+128>>8,d=jx*(g+v)+128>>8,h=x<<4,u=y<<4,r=r+a+1>>1,a=r-a,_=o*zx+l*Hx+128>>8,o=o*Hx-l*zx+128>>8,l=_,c=c+u+1>>1,u=c-u,d=d+h+1>>1,h=d-h,r=r+l+1>>1,l=r-l,a=a+o+1>>1,o=a-o,_=c*Ux+d*Bx+2048>>12,c=c*Bx-d*Ux+2048>>12,d=_,_=h*Fx+u*Lx+2048>>12,h=h*Lx-u*Fx+2048>>12,u=_,t[C]=r+d,t[C+7]=r-d,t[C+1]=a+u,t[C+6]=a-u,t[C+2]=o+h,t[C+5]=o-h,t[C+3]=l+c,t[C+4]=l-c}for(let C=0;C<8;++C){if(f=t[C],g=t[C+8],m=t[C+16],x=t[C+24],p=t[C+32],y=t[C+40],w=t[C+48],v=t[C+56],!(g|m|x|p|y|w|v)){_=uf*f+8192>>14,_<-2040?_=0:_>=2024?_=255:_=_+2056>>4,s[e+C]=_,s[e+C+8]=_,s[e+C+16]=_,s[e+C+24]=_,s[e+C+32]=_,s[e+C+40]=_,s[e+C+48]=_,s[e+C+56]=_;continue}r=uf*f+2048>>12,a=uf*p+2048>>12,o=m,l=w,c=jx*(g-v)+2048>>12,d=jx*(g+v)+2048>>12,h=x,u=y,r=(r+a+1>>1)+4112,a=r-a,_=o*zx+l*Hx+2048>>12,o=o*Hx-l*zx+2048>>12,l=_,c=c+u+1>>1,u=c-u,d=d+h+1>>1,h=d-h,r=r+l+1>>1,l=r-l,a=a+o+1>>1,o=a-o,_=c*Ux+d*Bx+2048>>12,c=c*Bx-d*Ux+2048>>12,d=_,_=h*Fx+u*Lx+2048>>12,h=h*Lx-u*Fx+2048>>12,u=_,f=r+d,v=r-d,g=a+u,w=a-u,m=o+h,y=o-h,x=l+c,p=l-c,f<16?f=0:f>=4080?f=255:f>>=4,g<16?g=0:g>=4080?g=255:g>>=4,m<16?m=0:m>=4080?m=255:m>>=4,x<16?x=0:x>=4080?x=255:x>>=4,p<16?p=0:p>=4080?p=255:p>>=4,y<16?y=0:y>=4080?y=255:y>>=4,w<16?w=0:w>=4080?w=255:w>>=4,v<16?v=0:v>=4080?v=255:v>>=4,s[e+C]=f,s[e+C+8]=g,s[e+C+16]=m,s[e+C+24]=x,s[e+C+32]=p,s[e+C+40]=y,s[e+C+48]=w,s[e+C+56]=v}}function XU(n,e){const t=e.blocksPerLine,i=e.blocksPerColumn,s=new Int16Array(64);for(let r=0;r<i;r++)for(let a=0;a<t;a++){const o=L7(e,r,a);KU(e,o,s)}return e.blockData}function $5(n,e,t=e){const i=n.length-1;let s=t<e?t:e;if(e>=i)return null;const r=xn(n,e);if(r>=65472&&r<=65534)return{invalid:null,marker:r,offset:e};let a=xn(n,s);for(;!(a>=65472&&a<=65534);){if(++s>=i)return null;a=xn(n,s)}return{invalid:r.toString(16),marker:a,offset:s}}function YU(n){const e=Math.ceil(n.samplesPerLine/8/n.maxH),t=Math.ceil(n.scanLines/8/n.maxV);for(const i of n.components){const s=Math.ceil(Math.ceil(n.samplesPerLine/8)*i.h/n.maxH),r=Math.ceil(Math.ceil(n.scanLines/8)*i.v/n.maxV),a=e*i.h,l=64*(t*i.v)*(a+1);i.blockData=new Int16Array(l),i.blocksPerLine=s,i.blocksPerColumn=r}n.mcusPerLine=e,n.mcusPerColumn=t}function q_(n,e){const t=xn(n,e);e+=2;let i=e+t-2;const s=$5(n,i,e);s!=null&&s.invalid&&(he("readDataBlock - incorrect length, current marker is: "+s.invalid),i=s.offset);const r=n.subarray(e,i);return{appData:r,oldOffset:e,newOffset:e+r.length}}function JU(n,e){const t=xn(n,e);e+=2;const i=e+t-2,s=$5(n,i,e);return s!=null&&s.invalid?s.offset:i}class W_{constructor({decodeTransform:e=null,colorTransform:t=-1}={}){this._decodeTransform=e,this._colorTransform=t}static canUseImageDecoder(e,t=-1){let i=null,s=0,r=null,a=xn(e,s);if(s+=2,a!==65496)throw new ao("SOI not found");a=xn(e,s),s+=2;e:for(;a!==65497;){switch(a){case 65505:const{appData:o,oldOffset:l,newOffset:c}=q_(e,s);if(s=c,o[0]===69&&o[1]===120&&o[2]===105&&o[3]===102&&o[4]===0&&o[5]===0){if(i)throw new ao("Duplicate EXIF-blocks found.");i={exifStart:l+6,exifEnd:c}}a=xn(e,s),s+=2;continue;case 65472:case 65473:case 65474:r=e[s+7];break e;case 65535:e[s]!==255&&s--;break}s=JU(e,s),a=xn(e,s),s+=2}return r===4||r===3&&t===0?null:i||{}}parse(e,{dnlScanLines:t=null}={}){let i=0,s=null,r=null,a,o,l=0;const c=[],h=[],u=[];let d=xn(e,i);if(i+=2,d!==65496)throw new ao("SOI not found");d=xn(e,i),i+=2;e:for(;d!==65497;){let f,g,m;switch(d){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:const{appData:x,newOffset:p}=q_(e,i);i=p,d===65504&&x[0]===74&&x[1]===70&&x[2]===73&&x[3]===70&&x[4]===0&&(s={version:{major:x[5],minor:x[6]},densityUnits:x[7],xDensity:x[8]<<8|x[9],yDensity:x[10]<<8|x[11],thumbWidth:x[12],thumbHeight:x[13],thumbData:x.subarray(14,14+3*x[12]*x[13])}),d===65518&&x[0]===65&&x[1]===100&&x[2]===111&&x[3]===98&&x[4]===101&&(r={version:x[5]<<8|x[6],flags0:x[7]<<8|x[8],flags1:x[9]<<8|x[10],transformCode:x[11]});break;case 65499:const y=xn(e,i);i+=2;const w=y+i-2;let v;for(;i<w;){const F=e[i++],X=new Uint16Array(64);if(F>>4)if(F>>4===1)for(g=0;g<64;g++)v=fp[g],X[v]=xn(e,i),i+=2;else throw new ao("DQT - invalid table spec");else for(g=0;g<64;g++)v=fp[g],X[v]=e[i++];c[F&15]=X}break;case 65472:case 65473:case 65474:if(a)throw new ao("Only single frame JPEGs supported");i+=2,a={},a.extended=d===65473,a.progressive=d===65474,a.precision=e[i++];const _=xn(e,i);i+=2,a.scanLines=t||_,a.samplesPerLine=xn(e,i),i+=2,a.components=[],a.componentIds={};const C=e[i++];let k=0,I=0;for(f=0;f<C;f++){const F=e[i],X=e[i+1]>>4,z=e[i+1]&15;k<X&&(k=X),I<z&&(I=z);const K=e[i+2];m=a.components.push({h:X,v:z,quantizationId:K,quantizationTable:null}),a.componentIds[F]=m-1,i+=3}a.maxH=k,a.maxV=I,YU(a);break;case 65476:const S=xn(e,i);for(i+=2,f=2;f<S;){const F=e[i++],X=new Uint8Array(16);let z=0;for(g=0;g<16;g++,i++)z+=X[g]=e[i];const K=new Uint8Array(z);for(g=0;g<z;g++,i++)K[g]=e[i];f+=17+z,(F>>4?h:u)[F&15]=qU(X,K)}break;case 65501:i+=2,o=xn(e,i),i+=2;break;case 65498:const R=++l===1&&!t;i+=2;const P=e[i++],D=[];for(f=0;f<P;f++){const F=e[i++],X=a.componentIds[F],z=a.components[X];z.index=F;const K=e[i++];z.huffmanTableDC=u[K>>4],z.huffmanTableAC=h[K&15],D.push(z)}const U=e[i++],T=e[i++],G=e[i++];try{const F=WU(e,i,a,D,o,U,T,G>>4,G&15,R);i+=F}catch(F){if(F instanceof D7)return he(`${F.message} -- attempting to re-parse the JPEG image.`),this.parse(e,{dnlScanLines:F.scanLines});if(F instanceof gR){he(`${F.message} -- ignoring the rest of the image data.`);break e}throw F}break;case 65500:i+=4;break;case 65535:e[i]!==255&&i--;break;default:const M=$5(e,i-2,i-3);if(M!=null&&M.invalid){he("JpegImage.parse - unexpected data, current marker is: "+M.invalid),i=M.offset;break}if(!M||i>=e.length-1){he("JpegImage.parse - reached the end of the image data without finding an EOI marker (0xFFD9).");break e}throw new ao("JpegImage.parse - unknown marker: "+d.toString(16))}d=xn(e,i),i+=2}if(!a)throw new ao("JpegImage.parse - no frame data found.");this.width=a.samplesPerLine,this.height=a.scanLines,this.jfif=s,this.adobe=r,this.components=[];for(const f of a.components){const g=c[f.quantizationId];g&&(f.quantizationTable=g),this.components.push({index:f.index,output:XU(a,f),scaleX:f.h/a.maxH,scaleY:f.v/a.maxV,blocksPerLine:f.blocksPerLine,blocksPerColumn:f.blocksPerColumn})}this.numComponents=this.components.length}_getLinearizedBlockData(e,t,i=!1){const s=this.width/e,r=this.height/t;let a,o,l,c,h,u,d,f,g,m,x=0,p;const y=this.components.length,w=e*t*y,v=new Uint8ClampedArray(w),_=new Uint32Array(e),C=4294967288;let k;for(d=0;d<y;d++){if(a=this.components[d],o=a.scaleX*s,l=a.scaleY*r,x=d,p=a.output,c=a.blocksPerLine+1<<3,o!==k){for(h=0;h<e;h++)f=0|h*o,_[h]=(f&C)<<3|f&7;k=o}for(u=0;u<t;u++)for(f=0|u*l,m=c*(f&C)|(f&7)<<3,h=0;h<e;h++)v[x]=p[m+_[h]],x+=y}let I=this._decodeTransform;if(!i&&y===4&&!I&&(I=new Int32Array([-256,255,-256,255,-256,255,-256,255])),I)for(d=0;d<w;)for(f=0,g=0;f<y;f++,d++,g+=2)v[d]=(v[d]*I[g]>>8)+I[g+1];return v}get _isColorConversionNeeded(){return this.adobe?!!this.adobe.transformCode:this.numComponents===3?this._colorTransform===0?!1:!(this.components[0].index===82&&this.components[1].index===71&&this.components[2].index===66):this._colorTransform===1}_convertYccToRgb(e){let t,i,s;for(let r=0,a=e.length;r<a;r+=3)t=e[r],i=e[r+1],s=e[r+2],e[r]=t-179.456+1.402*s,e[r+1]=t+135.459-.344*i-.714*s,e[r+2]=t-226.816+1.772*i;return e}_convertYccToRgba(e,t){for(let i=0,s=0,r=e.length;i<r;i+=3,s+=4){const a=e[i],o=e[i+1],l=e[i+2];t[s]=a-179.456+1.402*l,t[s+1]=a+135.459-.344*o-.714*l,t[s+2]=a-226.816+1.772*o,t[s+3]=255}return t}_convertYcckToRgb(e){return this._convertYcckToCmyk(e),this._convertCmykToRgb(e)}_convertYcckToRgba(e){return this._convertYcckToCmyk(e),this._convertCmykToRgba(e)}_convertYcckToCmyk(e){let t,i,s;for(let r=0,a=e.length;r<a;r+=4)t=e[r],i=e[r+1],s=e[r+2],e[r]=434.456-t-1.402*s,e[r+1]=119.541-t+.344*i+.714*s,e[r+2]=481.816-t-1.772*i;return e}_convertCmykToRgb(e){const t=e.length/4;return Nn.cmyk.getRgbBuffer(e,0,t,e,0,8,0),e.subarray(0,t*3)}_convertCmykToRgba(e){if(Nn.cmyk.getRgbBuffer(e,0,e.length/4,e,0,8,1),Nn.cmyk instanceof rR)for(let t=3,i=e.length;t<i;t+=4)e[t]=255;return e}getData({width:e,height:t,forceRGBA:i=!1,forceRGB:s=!1,isSourcePDF:r=!1}){if(this.numComponents>4)throw new ao("Unsupported color mode");const a=this._getLinearizedBlockData(e,t,r);if(this.numComponents===1&&(i||s)){const o=a.length*(i?4:3),l=new Uint8ClampedArray(o);let c=0;if(i)zU(a,new Uint32Array(l.buffer));else for(const h of a)l[c++]=h,l[c++]=h,l[c++]=h;return l}else if(this.numComponents===3&&this._isColorConversionNeeded){if(i){const o=new Uint8ClampedArray(a.length/3*4);return this._convertYccToRgba(a,o)}return this._convertYccToRgb(a)}else if(this.numComponents===4){if(this._isColorConversionNeeded)return i?this._convertYcckToRgba(a):s?this._convertYcckToRgb(a):this._convertYcckToCmyk(a);if(i)return this._convertCmykToRgba(a);if(s)return this._convertCmykToRgb(a)}return a}}var Gb,Vb,F7;const D5=class D5 extends Jr{constructor(t,i,s){super(i);B(this,Vb);this.stream=t,this.dict=t.dict,this.maybeLength=i,this.params=s}static get canUseImageDecoder(){return Ze(this,"canUseImageDecoder",b(this,Gb)?ImageDecoder.isTypeSupported("image/jpeg"):Promise.resolve(!1))}static setOptions({isImageDecoderSupported:t=!1}){N(this,Gb,t)}get bytes(){return Ze(this,"bytes",this.stream.getBytes(this.maybeLength))}ensureBuffer(t){}readBlock(){this.decodeImage()}get jpegOptions(){const t={decodeTransform:void 0,colorTransform:void 0},i=this.dict.getArray("D","Decode");if((this.forceRGBA||this.forceRGB)&&Array.isArray(i)){const s=this.dict.get("BPC","BitsPerComponent")||8,r=i.length,a=new Int32Array(r);let o=!1;const l=(1<<s)-1;for(let c=0;c<r;c+=2)a[c]=(i[c+1]-i[c])*256|0,a[c+1]=i[c]*l|0,(a[c]!==256||a[c+1]!==0)&&(o=!0);o&&(t.decodeTransform=a)}if(this.params instanceof fe){const s=this.params.get("ColorTransform");Number.isInteger(s)&&(t.colorTransform=s)}return Ze(this,"jpegOptions",t)}decodeImage(t){if(this.eof)return this.buffer;t=L(this,Vb,F7).call(this,t||this.bytes);const i=new W_(this.jpegOptions);i.parse(t);const s=i.getData({width:this.drawWidth,height:this.drawHeight,forceRGBA:this.forceRGBA,forceRGB:this.forceRGB,isSourcePDF:!0});return this.buffer=s,this.bufferLength=s.length,this.eof=!0,this.buffer}get canAsyncDecodeImageFromBuffer(){return this.stream.isAsync}async getTransferableImage(){if(!await D5.canUseImageDecoder)return null;const t=this.jpegOptions;if(t.decodeTransform)return null;let i;try{const s=this.canAsyncDecodeImageFromBuffer&&await this.stream.asyncGetBytes()||this.bytes;if(!s)return null;let r=L(this,Vb,F7).call(this,s);const a=W_.canUseImageDecoder(r,t.colorTransform);return a?(a.exifStart&&(r=r.slice(),r.fill(0,a.exifStart,a.exifEnd)),i=new ImageDecoder({data:r,type:"image/jpeg",preferAnimation:!1}),(await i.decode()).image):null}catch(s){return he(`getTransferableImage - failed: "${s}".`),null}finally{i==null||i.close()}}};Gb=new WeakMap,Vb=new WeakSet,F7=function(t){for(let i=0,s=t.length-1;i<s;i++)if(t[i]===255&&t[i+1]===216){i>0&&(t=t.subarray(i));break}return t},B(D5,Gb,da.isImageDecoderSupported);let Cg=D5;var ZU=async function(n={}){var e,t=n,i,s,r=new Promise((De,qe)=>{i=De,s=qe}),a="./this.program",o=(De,qe)=>{throw qe},l=import.meta.url,c="";try{c=new URL(".",l).href}catch{}var h=console.log.bind(console),u=console.error.bind(console),d,f=!1,g,m,x,p,y;function w(){var De=d.buffer;m=new Int8Array(De),x=new Uint8Array(De),p=new Int32Array(De),y=new Uint32Array(De),new BigInt64Array(De),new BigUint64Array(De)}function v(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)z(t.preRun.shift());G(X)}function _(){ki.t()}function C(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)F(t.postRun.shift());G(M)}var k=0,I=null;function S(De){var qe;k++,(qe=t.monitorRunDependencies)==null||qe.call(t,k)}function R(De){var ft;if(k--,(ft=t.monitorRunDependencies)==null||ft.call(t,k),k==0&&I){var qe=I;I=null,qe()}}function P(De){var ft;(ft=t.onAbort)==null||ft.call(t,De),De="Aborted("+De+")",u(De),f=!0,De+=". Build with -sASSERTIONS for more info.";var qe=new WebAssembly.RuntimeError(De);throw s(qe),qe}function D(){return{a:ys}}async function U(){function De(ft,Vt){return ki=ft.exports,d=ki.s,w(),R(),ki}S();var qe=D();return new Promise((ft,Vt)=>{t.instantiateWasm(qe,(sn,Bn)=>{ft(De(sn))})})}class T{constructor(qe){ze(this,"name","ExitStatus");this.message=`Program terminated with exit(${qe})`,this.status=qe}}var G=De=>{for(;De.length>0;)De.shift()(t)},M=[],F=De=>M.push(De),X=[],z=De=>X.push(De),K=!0,j=()=>P(""),ae=0,ge=()=>{K=!1,ae=0},ue={},pe=De=>{if(De instanceof T||De=="unwind")return g;o(1,De)},de=()=>K||ae>0,O=De=>{var qe;g=De,de()||((qe=t.onExit)==null||qe.call(t,De),f=!0),o(De,new T(De))},Y=(De,qe)=>{g=De,O(De)},le=Y,$=()=>{if(!de())try{le(g)}catch(De){pe(De)}},re=De=>{if(!f)try{De(),$()}catch(qe){pe(qe)}},oe=()=>performance.now(),ee=(De,qe)=>{if(ue[De]&&(clearTimeout(ue[De].id),delete ue[De]),!qe)return 0;var ft=setTimeout(()=>{delete ue[De],re(()=>Tr(De,oe()))},qe);return ue[De]={id:ft,timeout_ms:qe},0};function Q(De,qe){De>>=2;const ft=t.imageData=new Uint8ClampedArray(qe),Vt=p.subarray(De,De+qe);ft.set(Vt)}function je(De,qe,ft,Vt){De>>=2,qe>>=2,ft>>=2;const sn=t.imageData=new Uint8ClampedArray(Vt*3),Bn=p.subarray(De,De+Vt),Cn=p.subarray(qe,qe+Vt),Un=p.subarray(ft,ft+Vt);for(let zn=0;zn<Vt;zn++)sn[3*zn]=Bn[zn],sn[3*zn+1]=Cn[zn],sn[3*zn+2]=Un[zn]}function Re(De,qe,ft,Vt,sn){De>>=2,qe>>=2,ft>>=2,Vt>>=2;const Bn=t.imageData=new Uint8ClampedArray(sn*4),Cn=p.subarray(De,De+sn),Un=p.subarray(qe,qe+sn),zn=p.subarray(ft,ft+sn),dl=p.subarray(Vt,Vt+sn);for(let fr=0;fr<sn;fr++)Bn[4*fr]=Cn[fr],Bn[4*fr+1]=Un[fr],Bn[4*fr+2]=zn[fr],Bn[4*fr+3]=dl[fr]}var Ne=()=>2147483648,He=(De,qe)=>Math.ceil(De/qe)*qe,Be=De=>{var qe=d.buffer,ft=(De-qe.byteLength+65535)/65536|0;try{return d.grow(ft),w(),1}catch{}},Je=De=>{var qe=x.length;De>>>=0;var ft=Ne();if(De>ft)return!1;for(var Vt=1;Vt<=4;Vt*=2){var sn=qe*(1+.2/Vt);sn=Math.min(sn,De+100663296);var Bn=Math.min(ft,He(Math.max(De,sn),65536)),Cn=Be(Bn);if(Cn)return!0}return!1},ht={},ot=()=>a||"./this.program",Ye=()=>{if(!Ye.strings){var De=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",qe={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:De,_:ot()};for(var ft in ht)ht[ft]===void 0?delete qe[ft]:qe[ft]=ht[ft];var Vt=[];for(var ft in qe)Vt.push(`${ft}=${qe[ft]}`);Ye.strings=Vt}return Ye.strings},rt=(De,qe,ft,Vt)=>{if(!(Vt>0))return 0;for(var sn=ft,Bn=ft+Vt-1,Cn=0;Cn<De.length;++Cn){var Un=De.charCodeAt(Cn);if(Un>=55296&&Un<=57343){var zn=De.charCodeAt(++Cn);Un=65536+((Un&1023)<<10)|zn&1023}if(Un<=127){if(ft>=Bn)break;qe[ft++]=Un}else if(Un<=2047){if(ft+1>=Bn)break;qe[ft++]=192|Un>>6,qe[ft++]=128|Un&63}else if(Un<=65535){if(ft+2>=Bn)break;qe[ft++]=224|Un>>12,qe[ft++]=128|Un>>6&63,qe[ft++]=128|Un&63}else{if(ft+3>=Bn)break;qe[ft++]=240|Un>>18,qe[ft++]=128|Un>>12&63,qe[ft++]=128|Un>>6&63,qe[ft++]=128|Un&63}}return qe[ft]=0,ft-sn},me=(De,qe,ft)=>rt(De,x,qe,ft),Mt=(De,qe)=>{var ft=0,Vt=0;for(var sn of Ye()){var Bn=qe+ft;y[De+Vt>>2]=Bn,ft+=me(sn,Bn,1/0)+1,Vt+=4}return 0},ut=De=>{for(var qe=0,ft=0;ft<De.length;++ft){var Vt=De.charCodeAt(ft);Vt<=127?qe++:Vt<=2047?qe+=2:Vt>=55296&&Vt<=57343?(qe+=4,++ft):qe+=3}return qe},dt=(De,qe)=>{var ft=Ye();y[De>>2]=ft.length;var Vt=0;for(var sn of ft)Vt+=ut(sn)+1;return y[qe>>2]=Vt,0},Ve=De=>52;function Ot(De,qe,ft,Vt){return 70}var rn=[null,[],[]],Me=typeof TextDecoder<"u"?new TextDecoder:void 0,Dt=(De,qe=0,ft=NaN)=>{for(var Vt=qe+ft,sn=qe;De[sn]&&!(sn>=Vt);)++sn;if(sn-qe>16&&De.buffer&&Me)return Me.decode(De.subarray(qe,sn));for(var Bn="";qe<sn;){var Cn=De[qe++];if(!(Cn&128)){Bn+=String.fromCharCode(Cn);continue}var Un=De[qe++]&63;if((Cn&224)==192){Bn+=String.fromCharCode((Cn&31)<<6|Un);continue}var zn=De[qe++]&63;if((Cn&240)==224?Cn=(Cn&15)<<12|Un<<6|zn:Cn=(Cn&7)<<18|Un<<12|zn<<6|De[qe++]&63,Cn<65536)Bn+=String.fromCharCode(Cn);else{var dl=Cn-65536;Bn+=String.fromCharCode(55296|dl>>10,56320|dl&1023)}}return Bn},gt=(De,qe)=>{var ft=rn[De];qe===0||qe===10?((De===1?h:u)(Dt(ft)),ft.length=0):ft.push(qe)},jt=(De,qe)=>De?Dt(x,De,qe):"",Fn=(De,qe,ft,Vt)=>{for(var sn=0,Bn=0;Bn<ft;Bn++){var Cn=y[qe>>2],Un=y[qe+4>>2];qe+=8;for(var zn=0;zn<Un;zn++)gt(De,x[Cn+zn]);sn+=Un}return y[Vt>>2]=sn,0};function Kn(De,qe){De>>=2;const ft=t.imageData=new Uint8ClampedArray(qe*4),Vt=p.subarray(De,De+qe);for(let sn=0;sn<qe;sn++)ft[4*sn]=ft[4*sn+1]=ft[4*sn+2]=Vt[sn],ft[4*sn+3]=255}function ci(De,qe,ft){De>>=2,qe>>=2;const Vt=t.imageData=new Uint8ClampedArray(ft*4),sn=p.subarray(De,De+ft),Bn=p.subarray(qe,qe+ft);for(let Cn=0;Cn<ft;Cn++)Vt[4*Cn]=Vt[4*Cn+1]=Vt[4*Cn+2]=sn[Cn],Vt[4*Cn+3]=Bn[Cn]}function ji(De){const qe=jt(De);(t.warn||console.warn)(`OpenJPEG: ${qe}`)}function xs(De,qe,ft,Vt){De>>=2,qe>>=2,ft>>=2;const sn=t.imageData=new Uint8ClampedArray(Vt*4),Bn=p.subarray(De,De+Vt),Cn=p.subarray(qe,qe+Vt),Un=p.subarray(ft,ft+Vt);for(let zn=0;zn<Vt;zn++)sn[4*zn]=Bn[zn],sn[4*zn+1]=Cn[zn],sn[4*zn+2]=Un[zn],sn[4*zn+3]=255}function hi(De){const qe=jt(De);t.errorMessages?t.errorMessages+=`
`+qe:t.errorMessages=qe}var qi=(De,qe)=>{m.set(De,qe)};t.noExitRuntime&&(K=t.noExitRuntime),t.print&&(h=t.print),t.printErr&&(u=t.printErr),t.wasmBinary&&t.wasmBinary,t.arguments&&t.arguments,t.thisProgram&&(a=t.thisProgram),t.writeArrayToMemory=qi;var ys={l:j,k:ge,m:ee,g:Q,f:je,e:Re,n:Je,p:Mt,q:dt,b:Ve,o:Ot,c:Fn,r:Kn,i:ci,d:ji,j:O,h:xs,a:hi},ki=await U();ki.t,t._malloc=ki.u,t._free=ki.v,t._jp2_decode=ki.w;var Tr=ki.x;function Ks(){if(k>0){I=Ks;return}if(v(),k>0){I=Ks;return}function De(){var qe;t.calledRun=!0,!f&&(_(),i(t),(qe=t.onRuntimeInitialized)==null||qe.call(t),C())}t.setStatus?(t.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>t.setStatus(""),1),De()},1)):De()}function Ss(){if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.shift()()}return Ss(),Ks(),e=r,e};const QU=ZU;class Gx extends Qr{constructor(e){super(e,"JpxError")}}var Ed,mg,Td,qb,Wb,pg,tf,B7,mR;class Go{static setOptions({handler:e,useWasm:t,useWorkerFetch:i,wasmUrl:s}){N(this,qb,t),N(this,Wb,i),N(this,pg,s),i||N(this,mg,e)}static async decode(e,{numComponents:t=4,isIndexedColormap:i=!1,smaskInData:s=!1,reducePower:r=0}={}){if(!b(this,Td)){const{promise:l,resolve:c}=Promise.withResolvers(),h=[l];b(this,qb)?h.push(QU({warn:he,instantiateWasm:L(this,tf,mR).bind(this,c)})):L(this,tf,B7).call(this,c),N(this,Td,Promise.race(h))}const a=await b(this,Td);if(!a)throw new Gx("OpenJPEG failed to initialize");let o;try{const l=e.length;if(o=a._malloc(l),a.writeArrayToMemory(e,o),a._jp2_decode(o,l,t>0?t:0,!!i,!!s,r)){const{errorMessages:u}=a;throw u?(delete a.errorMessages,new Gx(u)):new Gx("Unknown error")}const{imageData:h}=a;return a.imageData=null,h}finally{o&&a._free(o)}}static cleanup(){N(this,Td,null)}static parseImageProperties(e){let t=e.getByte();for(;t>=0;){const i=t;if(t=e.getByte(),(i<<8|t)===65361){e.skip(4);const r=e.getInt32()>>>0,a=e.getInt32()>>>0,o=e.getInt32()>>>0,l=e.getInt32()>>>0;e.skip(16);const c=e.getUint16();return{width:r-o,height:a-l,bitsPerComponent:8,componentsCount:c}}}throw new Gx("No size marker found in JPX stream")}}Ed=new WeakMap,mg=new WeakMap,Td=new WeakMap,qb=new WeakMap,Wb=new WeakMap,pg=new WeakMap,tf=new WeakSet,B7=async function(e){const t=`${b(this,pg)}openjpeg_nowasm_fallback.js`;let i=null;try{i=(await import(t)).default()}catch(s){he(`JpxImage#getJsModule: ${s}`)}e(i)},mR=async function(e,t,i){const s="openjpeg.wasm";try{b(this,Ed)||(b(this,Wb)?N(this,Ed,await A7(`${b(this,pg)}${s}`)):N(this,Ed,await b(this,mg).sendWithPromise("FetchBinaryData",{type:"wasmFactory",filename:s})));const r=await WebAssembly.instantiate(b(this,Ed),t);return i(r.instance)}catch(r){return he(`JpxImage#instantiateWasm: ${r}`),L(this,tf,B7).call(this,e),null}finally{N(this,mg,null)}},B(Go,tf),B(Go,Ed,null),B(Go,mg,null),B(Go,Td,null),B(Go,qb,!0),B(Go,Wb,!0),B(Go,pg,null);function lx(n,e,t,i,s){let r=n;for(let a=0,o=e.length-1;a<o;a++){const l=e[a];r=r[l]||(r[l]=[])}r[e.at(-1)]={checkFn:t,iterateFn:i,processFn:s}}const Wd=[];lx(Wd,[ne.save,ne.transform,ne.paintInlineImageXObject,ne.restore],null,function(e,t){const i=e.fnArray,s=e.iCurr-3,r=(t-s)%4;switch(r){case 0:return i[t]===ne.save;case 1:return i[t]===ne.transform;case 2:return i[t]===ne.paintInlineImageXObject;case 3:return i[t]===ne.restore}throw new Error(`iterateInlineImageGroup - invalid pos: ${r}`)},function(e,t){const o=e.fnArray,l=e.argsArray,c=e.iCurr,h=c-3,u=c-2,d=c-1,f=Math.min(Math.floor((t-h)/4),200);if(f<10)return t-(t-h)%4;let g=0;const m=[];let x=0,p=1,y=1;for(let I=0;I<f;I++){const S=l[u+(I<<2)],R=l[d+(I<<2)][0];p+R.width>1e3&&(g=Math.max(g,p),y+=x+2*1,p=0,x=0),m.push({transform:S,x:p,y,w:R.width,h:R.height}),p+=R.width+2*1,x=Math.max(x,R.height)}const w=Math.max(g,p)+1,v=y+x+1,_=new Uint8Array(w*v*4),C=w<<2;for(let I=0;I<f;I++){const S=l[d+(I<<2)][0].data,R=m[I].w<<2;let P=0,D=m[I].x+m[I].y*w<<2;_.set(S.subarray(0,R),D-C);for(let U=0,T=m[I].h;U<T;U++)_.set(S.subarray(P,P+R),D),P+=R,D+=C;for(_.set(S.subarray(P-R,P),D);D>=0;)S[D-4]=S[D],S[D-3]=S[D+1],S[D-2]=S[D+2],S[D-1]=S[D+3],S[D+R]=S[D+R-4],S[D+R+1]=S[D+R-3],S[D+R+2]=S[D+R-2],S[D+R+3]=S[D+R-1],D-=C}const k={width:w,height:v};if(e.isOffscreenCanvasSupported){const I=new OffscreenCanvas(w,v);I.getContext("2d").putImageData(new ImageData(new Uint8ClampedArray(_.buffer),w,v),0,0),k.bitmap=I.transferToImageBitmap(),k.data=null}else k.kind=Os.RGBA_32BPP,k.data=_;return o.splice(h,f*4,ne.paintInlineImageXObjectGroup),l.splice(h,f*4,[k,m]),h+1});lx(Wd,[ne.save,ne.transform,ne.paintImageMaskXObject,ne.restore],null,function(e,t){const i=e.fnArray,s=e.iCurr-3,r=(t-s)%4;switch(r){case 0:return i[t]===ne.save;case 1:return i[t]===ne.transform;case 2:return i[t]===ne.paintImageMaskXObject;case 3:return i[t]===ne.restore}throw new Error(`iterateImageMaskGroup - invalid pos: ${r}`)},function(e,t){const a=e.fnArray,o=e.argsArray,l=e.iCurr,c=l-3,h=l-2,u=l-1;let d=Math.floor((t-c)/4);if(d<10)return t-(t-c)%4;let f=!1,g,m;const x=o[u][0],p=o[h][0],y=o[h][1],w=o[h][2],v=o[h][3];if(y===w){f=!0,g=h+4;let _=u+4;for(let C=1;C<d;C++,g+=4,_+=4)if(m=o[g],o[_][0]!==x||m[0]!==p||m[1]!==y||m[2]!==w||m[3]!==v){C<10?f=!1:d=C;break}}if(f){d=Math.min(d,1e3);const _=new Float32Array(d*2);g=h;for(let C=0;C<d;C++,g+=4)m=o[g],_[C<<1]=m[4],_[(C<<1)+1]=m[5];a.splice(c,d*4,ne.paintImageMaskXObjectRepeat),o.splice(c,d*4,[x,p,y,w,v,_])}else{d=Math.min(d,100);const _=[];for(let C=0;C<d;C++){m=o[h+(C<<2)];const k=o[u+(C<<2)][0];_.push({data:k.data,width:k.width,height:k.height,interpolate:k.interpolate,count:k.count,transform:m})}a.splice(c,d*4,ne.paintImageMaskXObjectGroup),o.splice(c,d*4,[_])}return c+1});lx(Wd,[ne.save,ne.transform,ne.paintImageXObject,ne.restore],function(n){const e=n.argsArray,t=n.iCurr-2;return e[t][1]===0&&e[t][2]===0},function(e,t){const i=e.fnArray,s=e.argsArray,r=e.iCurr-3,a=(t-r)%4;switch(a){case 0:return i[t]===ne.save;case 1:if(i[t]!==ne.transform)return!1;const o=e.iCurr-2,l=s[o][0],c=s[o][3];return!(s[t][0]!==l||s[t][1]!==0||s[t][2]!==0||s[t][3]!==c);case 2:if(i[t]!==ne.paintImageXObject)return!1;const h=e.iCurr-1,u=s[h][0];return s[t][0]===u;case 3:return i[t]===ne.restore}throw new Error(`iterateImageGroup - invalid pos: ${a}`)},function(n,e){const s=n.fnArray,r=n.argsArray,a=n.iCurr,o=a-3,l=a-2,c=a-1,h=r[c][0],u=r[l][0],d=r[l][3],f=Math.min(Math.floor((e-o)/4),1e3);if(f<3)return e-(e-o)%4;const g=new Float32Array(f*2);let m=l;for(let p=0;p<f;p++,m+=4){const y=r[m];g[p<<1]=y[4],g[(p<<1)+1]=y[5]}const x=[h,u,d,g];return s.splice(o,f*4,ne.paintImageXObjectRepeat),r.splice(o,f*4,x),o+1});lx(Wd,[ne.beginText,ne.setFont,ne.setTextMatrix,ne.showText,ne.endText],null,function(e,t){const i=e.fnArray,s=e.argsArray,r=e.iCurr-4,a=(t-r)%5;switch(a){case 0:return i[t]===ne.beginText;case 1:return i[t]===ne.setFont;case 2:return i[t]===ne.setTextMatrix;case 3:if(i[t]!==ne.showText)return!1;const o=e.iCurr-3,l=s[o][0],c=s[o][1];return!(s[t][0]!==l||s[t][1]!==c);case 4:return i[t]===ne.endText}throw new Error(`iterateShowTextGroup - invalid pos: ${a}`)},function(n,e){const s=n.fnArray,r=n.argsArray,a=n.iCurr,o=a-4,l=a-3,c=a-2,h=a-1,u=a,d=r[l][0],f=r[l][1];let g=Math.min(Math.floor((e-o)/5),1e3);if(g<3)return e-(e-o)%5;let m=o;o>=4&&s[o-4]===s[l]&&s[o-3]===s[c]&&s[o-2]===s[h]&&s[o-1]===s[u]&&r[o-4][0]===d&&r[o-4][1]===f&&(g++,m-=5);let x=m+4;for(let p=1;p<g;p++)s.splice(x,3),r.splice(x,3),x+=2;return x+1});lx(Wd,[ne.save,ne.transform,ne.constructPath,ne.restore],n=>{const e=n.argsArray,t=n.iCurr-1,i=e[t][0];if(i!==ne.stroke&&i!==ne.closeStroke&&i!==ne.fillStroke&&i!==ne.eoFillStroke&&i!==ne.closeFillStroke&&i!==ne.closeEOFillStroke)return!0;const s=n.iCurr-2,r=e[s];return r[0]===1&&r[1]===0&&r[2]===0&&r[3]===1},()=>!1,(n,e)=>{const{fnArray:t,argsArray:i}=n,s=n.iCurr,r=s-3,a=s-2,o=s-1,l=i[o],c=i[a],[,[h],u]=l;if(u){Dn.scaleMinMax(c,u);for(let d=0,f=h.length;d<f;)switch(h[d++]){case ds.moveTo:case ds.lineTo:Dn.applyTransform(h,c,d),d+=2;break;case ds.curveTo:Dn.applyTransformToBezier(h,c,d),d+=6;break}}return t.splice(r,4,ne.constructPath),i.splice(r,4,l),r+1});class pR{constructor(e){this.queue=e}_optimize(){}push(e,t){this.queue.fnArray.push(e),this.queue.argsArray.push(t),this._optimize()}flush(){}reset(){}}class $U extends pR{constructor(e){super(e),this.state=null,this.context={iCurr:0,fnArray:e.fnArray,argsArray:e.argsArray,isOffscreenCanvasSupported:Ar.isOffscreenCanvasSupported},this.match=null,this.lastProcessed=0}_optimize(){const e=this.queue.fnArray;let t=this.lastProcessed,i=e.length,s=this.state,r=this.match;if(!s&&!r&&t+1===i&&!Wd[e[t]]){this.lastProcessed=i;return}const a=this.context;for(;t<i;){if(r){if((0,r.iterateFn)(a,t)){t++;continue}if(t=(0,r.processFn)(a,t+1),i=e.length,r=null,s=null,t>=i)break}if(s=(s||Wd)[e[t]],!s||Array.isArray(s)){t++;continue}if(a.iCurr=t,t++,s.checkFn&&!(0,s.checkFn)(a)){s=null;continue}r=s,s=null}this.state=s,this.match=r,this.lastProcessed=t}flush(){for(;this.match;){const e=this.queue.fnArray.length;this.lastProcessed=(0,this.match.processFn)(this.context,e),this.match=null,this.state=null,this._optimize()}}reset(){this.state=null,this.match=null,this.lastProcessed=0}}const bc=class bc{constructor(e=0,t){this._streamSink=t,this.fnArray=[],this.argsArray=[],this.optimizer=t&&!(e&Hr.OPLIST)?new $U(this):new pR(this),this.dependencies=new Set,this._totalLength=0,this.weight=0,this._resolved=t?null:Promise.resolve()}static setOptions({isOffscreenCanvasSupported:e}){this.isOffscreenCanvasSupported=e}get length(){return this.argsArray.length}get ready(){return this._resolved||this._streamSink.ready}get totalLength(){return this._totalLength+this.length}addOp(e,t){this.optimizer.push(e,t),this.weight++,this._streamSink&&(this.weight>=bc.CHUNK_SIZE?this.flush():this.weight>=bc.CHUNK_SIZE_ABOUT&&(e===ne.restore||e===ne.endText)&&this.flush())}addImageOps(e,t,i,s=!1){s&&(this.addOp(ne.save),this.addOp(ne.setGState,[[["SMask",!1]]])),i!==void 0&&this.addOp(ne.beginMarkedContentProps,["OC",i]),this.addOp(e,t),i!==void 0&&this.addOp(ne.endMarkedContent,[]),s&&this.addOp(ne.restore)}addDependency(e){this.dependencies.has(e)||(this.dependencies.add(e),this.addOp(ne.dependency,[e]))}addDependencies(e){for(const t of e)this.addDependency(t)}addOpList(e){if(!(e instanceof bc)){he('addOpList - ignoring invalid "opList" parameter.');return}for(const t of e.dependencies)this.dependencies.add(t);for(let t=0,i=e.length;t<i;t++)this.addOp(e.fnArray[t],e.argsArray[t])}getIR(){return{fnArray:this.fnArray,argsArray:this.argsArray,length:this.length}}get _transfers(){const e=[],{fnArray:t,argsArray:i,length:s}=this;for(let r=0;r<s;r++)switch(t[r]){case ne.paintInlineImageXObject:case ne.paintInlineImageXObjectGroup:case ne.paintImageMaskXObject:{const{bitmap:l,data:c}=i[r][0];(l||c!=null&&c.buffer)&&e.push(l||c.buffer);break}case ne.constructPath:{const[,[l],c]=i[r];l&&e.push(l.buffer,c.buffer);break}case ne.paintFormXObjectBegin:const[a,o]=i[r];a&&e.push(a.buffer),o&&e.push(o.buffer);break;case ne.setTextMatrix:e.push(i[r][0].buffer);break}return e}flush(e=!1,t=null){this.optimizer.flush();const i=this.length;this._totalLength+=i,this._streamSink.enqueue({fnArray:this.fnArray,argsArray:this.argsArray,lastChunk:e,separateAnnots:t,length:i},1,this._transfers),this.dependencies.clear(),this.fnArray.length=0,this.argsArray.length=0,this.weight=0,this.optimizer.reset()}};ze(bc,"CHUNK_SIZE",1e3),ze(bc,"CHUNK_SIZE_ABOUT",bc.CHUNK_SIZE-5),ze(bc,"isOffscreenCanvasSupported",!1);let Ar=bc;function mr(n,e){let t=0;for(let i=0;i<=e;i++)t=t<<8|n[i];return t>>>0}function Vx(n,e){return e===1?String.fromCharCode(n[0],n[1]):e===3?String.fromCharCode(n[0],n[1],n[2],n[3]):String.fromCharCode(...n.subarray(0,e+1))}function Mr(n,e,t){let i=0;for(let s=t;s>=0;s--)i+=n[s]+e[s],n[s]=i&255,i>>=8}function Yh(n,e){let t=1;for(let i=e;i>=0&&t>0;i--)t+=n[i],n[i]=t&255,t>>=8}const df=16,eH=19;class tH{constructor(e){this.buffer=e,this.pos=0,this.end=e.length,this.tmpBuf=new Uint8Array(eH)}readByte(){return this.pos>=this.end?-1:this.buffer[this.pos++]}readNumber(){let e=0,t;do{const i=this.readByte();if(i<0)throw new Ee("unexpected EOF in bcmap");t=!(i&128),e=e<<7|i&127}while(!t);return e}readSigned(){const e=this.readNumber();return e&1?~(e>>>1):e>>>1}readHex(e,t){e.set(this.buffer.subarray(this.pos,this.pos+t+1)),this.pos+=t+1}readHexNumber(e,t){let i;const s=this.tmpBuf;let r=0;do{const c=this.readByte();if(c<0)throw new Ee("unexpected EOF in bcmap");i=!(c&128),s[r++]=c&127}while(!i);let a=t,o=0,l=0;for(;a>=0;){for(;l<8&&s.length>0;)o|=s[--r]<<l,l+=7;e[a]=o&255,a--,o>>=8,l-=8}}readHexSigned(e,t){this.readHexNumber(e,t);const i=e[t]&1?255:0;let s=0;for(let r=0;r<=t;r++)s=(s&1)<<8|e[r],e[r]=s>>1^i}readString(){const e=this.readNumber(),t=new Array(e);for(let i=0;i<e;i++)t[i]=this.readNumber();return String.fromCharCode(...t)}}class nH{async process(e,t,i){const s=new tH(e),r=s.readByte();t.vertical=!!(r&1);let a=null;const o=new Uint8Array(df),l=new Uint8Array(df),c=new Uint8Array(df),h=new Uint8Array(df),u=new Uint8Array(df);let d,f;for(;(f=s.readByte())>=0;){const g=f>>5;if(g===7){switch(f&31){case 0:s.readString();break;case 1:a=s.readString();break}continue}const m=!!(f&16),x=f&15;if(x+1>df)throw new Error("BinaryCMapReader.process: Invalid dataSize.");const p=1,y=s.readNumber();switch(g){case 0:s.readHex(o,x),s.readHexNumber(l,x),Mr(l,o,x),t.addCodespaceRange(x+1,mr(o,x),mr(l,x));for(let w=1;w<y;w++)Yh(l,x),s.readHexNumber(o,x),Mr(o,l,x),s.readHexNumber(l,x),Mr(l,o,x),t.addCodespaceRange(x+1,mr(o,x),mr(l,x));break;case 1:s.readHex(o,x),s.readHexNumber(l,x),Mr(l,o,x),s.readNumber();for(let w=1;w<y;w++)Yh(l,x),s.readHexNumber(o,x),Mr(o,l,x),s.readHexNumber(l,x),Mr(l,o,x),s.readNumber();break;case 2:s.readHex(c,x),d=s.readNumber(),t.mapOne(mr(c,x),d);for(let w=1;w<y;w++)Yh(c,x),m||(s.readHexNumber(u,x),Mr(c,u,x)),d=s.readSigned()+(d+1),t.mapOne(mr(c,x),d);break;case 3:s.readHex(o,x),s.readHexNumber(l,x),Mr(l,o,x),d=s.readNumber(),t.mapCidRange(mr(o,x),mr(l,x),d);for(let w=1;w<y;w++)Yh(l,x),m?o.set(l):(s.readHexNumber(o,x),Mr(o,l,x)),s.readHexNumber(l,x),Mr(l,o,x),d=s.readNumber(),t.mapCidRange(mr(o,x),mr(l,x),d);break;case 4:s.readHex(c,p),s.readHex(h,x),t.mapOne(mr(c,p),Vx(h,x));for(let w=1;w<y;w++)Yh(c,p),m||(s.readHexNumber(u,p),Mr(c,u,p)),Yh(h,x),s.readHexSigned(u,x),Mr(h,u,x),t.mapOne(mr(c,p),Vx(h,x));break;case 5:s.readHex(o,p),s.readHexNumber(l,p),Mr(l,o,p),s.readHex(h,x),t.mapBfRange(mr(o,p),mr(l,p),Vx(h,x));for(let w=1;w<y;w++)Yh(l,p),m?o.set(l):(s.readHexNumber(o,p),Mr(o,l,p)),s.readHexNumber(l,p),Mr(l,o,p),s.readHex(h,x),t.mapBfRange(mr(o,p),mr(l,p),Vx(h,x));break;default:throw new Error(`BinaryCMapReader.process - unknown type: ${g}`)}}return a?i(a):t}}class iH extends Jr{constructor(e,t){t&&(t*=.8),super(t),this.str=e,this.dict=e.dict,this.input=new Uint8Array(5)}readBlock(){const s=this.str;let r=s.getByte();for(;Va(r);)r=s.getByte();if(r===-1||r===126){this.eof=!0;return}const a=this.bufferLength;let o,l;if(r===122){for(o=this.ensureBuffer(a+4),l=0;l<4;++l)o[a+l]=0;this.bufferLength+=4}else{const c=this.input;for(c[0]=r,l=1;l<5;++l){for(r=s.getByte();Va(r);)r=s.getByte();if(c[l]=r,r===-1||r===126)break}if(o=this.ensureBuffer(a+l-1),this.bufferLength+=l-1,l<5){for(;l<5;++l)c[l]=117;this.eof=!0}let h=0;for(l=0;l<5;++l)h=h*85+(c[l]-33);for(l=3;l>=0;--l)o[a+l]=h&255,h>>=8}}}class sH extends Jr{constructor(e,t){t&&(t*=.5),super(t),this.str=e,this.dict=e.dict,this.firstDigit=-1}readBlock(){const t=this.str.getBytes(8e3);if(!t.length){this.eof=!0;return}const i=t.length+1>>1,s=this.ensureBuffer(this.bufferLength+i);let r=this.bufferLength,a=this.firstDigit;for(const o of t){let l;if(o>=48&&o<=57)l=o&15;else if(o>=65&&o<=70||o>=97&&o<=102)l=(o&15)+9;else if(o===62){this.eof=!0;break}else continue;a<0?a=l:(s[r++]=a<<4|l,a=-1)}a>=0&&this.eof&&(s[r++]=a<<4,a=-1),this.firstDigit=a,this.bufferLength=r}}const U7=-2,oc=-1,fc=0,Ys=1,Bt=2,Js=3,Zs=4,H7=5,z7=6,bR=7,xR=8,K_=[[-1,-1],[-1,-1],[7,xR],[7,bR],[6,z7],[6,z7],[6,H7],[6,H7],[4,fc],[4,fc],[4,fc],[4,fc],[4,fc],[4,fc],[4,fc],[4,fc],[3,Ys],[3,Ys],[3,Ys],[3,Ys],[3,Ys],[3,Ys],[3,Ys],[3,Ys],[3,Ys],[3,Ys],[3,Ys],[3,Ys],[3,Ys],[3,Ys],[3,Ys],[3,Ys],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Zs],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[3,Js],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt],[1,Bt]],X_=[[-1,-1],[12,U7],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[11,1792],[11,1792],[12,1984],[12,2048],[12,2112],[12,2176],[12,2240],[12,2304],[11,1856],[11,1856],[11,1920],[11,1920],[12,2368],[12,2432],[12,2496],[12,2560]],Y_=[[-1,-1],[-1,-1],[-1,-1],[-1,-1],[8,29],[8,29],[8,30],[8,30],[8,45],[8,45],[8,46],[8,46],[7,22],[7,22],[7,22],[7,22],[7,23],[7,23],[7,23],[7,23],[8,47],[8,47],[8,48],[8,48],[6,13],[6,13],[6,13],[6,13],[6,13],[6,13],[6,13],[6,13],[7,20],[7,20],[7,20],[7,20],[8,33],[8,33],[8,34],[8,34],[8,35],[8,35],[8,36],[8,36],[8,37],[8,37],[8,38],[8,38],[7,19],[7,19],[7,19],[7,19],[8,31],[8,31],[8,32],[8,32],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,12],[6,12],[6,12],[6,12],[6,12],[6,12],[6,12],[6,12],[8,53],[8,53],[8,54],[8,54],[7,26],[7,26],[7,26],[7,26],[8,39],[8,39],[8,40],[8,40],[8,41],[8,41],[8,42],[8,42],[8,43],[8,43],[8,44],[8,44],[7,21],[7,21],[7,21],[7,21],[7,28],[7,28],[7,28],[7,28],[8,61],[8,61],[8,62],[8,62],[8,63],[8,63],[8,0],[8,0],[8,320],[8,320],[8,384],[8,384],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[7,27],[7,27],[7,27],[7,27],[8,59],[8,59],[8,60],[8,60],[9,1472],[9,1536],[9,1600],[9,1728],[7,18],[7,18],[7,18],[7,18],[7,24],[7,24],[7,24],[7,24],[8,49],[8,49],[8,50],[8,50],[8,51],[8,51],[8,52],[8,52],[7,25],[7,25],[7,25],[7,25],[8,55],[8,55],[8,56],[8,56],[8,57],[8,57],[8,58],[8,58],[6,192],[6,192],[6,192],[6,192],[6,192],[6,192],[6,192],[6,192],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[8,448],[8,448],[8,512],[8,512],[9,704],[9,768],[8,640],[8,640],[8,576],[8,576],[9,832],[9,896],[9,960],[9,1024],[9,1088],[9,1152],[9,1216],[9,1280],[9,1344],[9,1408],[7,256],[7,256],[7,256],[7,256],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[6,16],[6,16],[6,16],[6,16],[6,16],[6,16],[6,16],[6,16],[6,17],[6,17],[6,17],[6,17],[6,17],[6,17],[6,17],[6,17],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[6,14],[6,14],[6,14],[6,14],[6,14],[6,14],[6,14],[6,14],[6,15],[6,15],[6,15],[6,15],[6,15],[6,15],[6,15],[6,15],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7]],J_=[[-1,-1],[-1,-1],[12,U7],[12,U7],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[11,1792],[11,1792],[11,1792],[11,1792],[12,1984],[12,1984],[12,2048],[12,2048],[12,2112],[12,2112],[12,2176],[12,2176],[12,2240],[12,2240],[12,2304],[12,2304],[11,1856],[11,1856],[11,1856],[11,1856],[11,1920],[11,1920],[11,1920],[11,1920],[12,2368],[12,2368],[12,2432],[12,2432],[12,2496],[12,2496],[12,2560],[12,2560],[10,18],[10,18],[10,18],[10,18],[10,18],[10,18],[10,18],[10,18],[12,52],[12,52],[13,640],[13,704],[13,768],[13,832],[12,55],[12,55],[12,56],[12,56],[13,1280],[13,1344],[13,1408],[13,1472],[12,59],[12,59],[12,60],[12,60],[13,1536],[13,1600],[11,24],[11,24],[11,24],[11,24],[11,25],[11,25],[11,25],[11,25],[13,1664],[13,1728],[12,320],[12,320],[12,384],[12,384],[12,448],[12,448],[13,512],[13,576],[12,53],[12,53],[12,54],[12,54],[13,896],[13,960],[13,1024],[13,1088],[13,1152],[13,1216],[10,64],[10,64],[10,64],[10,64],[10,64],[10,64],[10,64],[10,64]],Z_=[[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[11,23],[11,23],[12,50],[12,51],[12,44],[12,45],[12,46],[12,47],[12,57],[12,58],[12,61],[12,256],[10,16],[10,16],[10,16],[10,16],[10,17],[10,17],[10,17],[10,17],[12,48],[12,49],[12,62],[12,63],[12,30],[12,31],[12,32],[12,33],[12,40],[12,41],[11,22],[11,22],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[9,15],[9,15],[9,15],[9,15],[9,15],[9,15],[9,15],[9,15],[12,128],[12,192],[12,26],[12,27],[12,28],[12,29],[11,19],[11,19],[11,20],[11,20],[12,34],[12,35],[12,36],[12,37],[12,38],[12,39],[11,21],[11,21],[12,42],[12,43],[10,0],[10,0],[10,0],[10,0],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12]],Q_=[[-1,-1],[-1,-1],[-1,-1],[-1,-1],[6,9],[6,8],[5,7],[5,7],[4,6],[4,6],[4,6],[4,6],[4,5],[4,5],[4,5],[4,5],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2]];class yR{constructor(e,t={}){if(typeof(e==null?void 0:e.next)!="function")throw new Error('CCITTFaxDecoder - invalid "source" parameter.');this.source=e,this.eof=!1,this.encoding=t.K||0,this.eoline=t.EndOfLine||!1,this.byteAlign=t.EncodedByteAlign||!1,this.columns=t.Columns||1728,this.rows=t.Rows||0,this.eoblock=t.EndOfBlock??!0,this.black=t.BlackIs1||!1,this.codingLine=new Uint32Array(this.columns+1),this.refLine=new Uint32Array(this.columns+2),this.codingLine[0]=this.columns,this.codingPos=0,this.row=0,this.nextLine2D=this.encoding<0,this.inputBits=0,this.inputBuf=0,this.outputBits=0,this.rowsDone=!1;let i;for(;(i=this._lookBits(12))===0;)this._eatBits(1);i===1&&this._eatBits(12),this.encoding>0&&(this.nextLine2D=!this._lookBits(1),this._eatBits(1))}readNextChar(){if(this.eof)return-1;const e=this.refLine,t=this.codingLine,i=this.columns;let s,r,a,o;if(this.outputBits===0){if(this.rowsDone&&(this.eof=!0),this.eof)return-1;this.err=!1;let c,h,u;if(this.nextLine2D){for(o=0;t[o]<i;++o)e[o]=t[o];for(e[o++]=i,e[o]=i,t[0]=0,this.codingPos=0,s=0,r=0;t[this.codingPos]<i;)switch(c=this._getTwoDimCode(),c){case fc:this._addPixels(e[s+1],r),e[s+1]<i&&(s+=2);break;case Ys:if(c=h=0,r){do c+=u=this._getBlackCode();while(u>=64);do h+=u=this._getWhiteCode();while(u>=64)}else{do c+=u=this._getWhiteCode();while(u>=64);do h+=u=this._getBlackCode();while(u>=64)}for(this._addPixels(t[this.codingPos]+c,r),t[this.codingPos]<i&&this._addPixels(t[this.codingPos]+h,r^1);e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case bR:if(this._addPixels(e[s]+3,r),r^=1,t[this.codingPos]<i)for(++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case H7:if(this._addPixels(e[s]+2,r),r^=1,t[this.codingPos]<i)for(++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case Js:if(this._addPixels(e[s]+1,r),r^=1,t[this.codingPos]<i)for(++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case Bt:if(this._addPixels(e[s],r),r^=1,t[this.codingPos]<i)for(++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case xR:if(this._addPixelsNeg(e[s]-3,r),r^=1,t[this.codingPos]<i)for(s>0?--s:++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case z7:if(this._addPixelsNeg(e[s]-2,r),r^=1,t[this.codingPos]<i)for(s>0?--s:++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case Zs:if(this._addPixelsNeg(e[s]-1,r),r^=1,t[this.codingPos]<i)for(s>0?--s:++s;e[s]<=t[this.codingPos]&&e[s]<i;)s+=2;break;case oc:this._addPixels(i,0),this.eof=!0;break;default:gn("bad 2d code"),this._addPixels(i,0),this.err=!0}}else for(t[0]=0,this.codingPos=0,r=0;t[this.codingPos]<i;){if(c=0,r)do c+=u=this._getBlackCode();while(u>=64);else do c+=u=this._getWhiteCode();while(u>=64);this._addPixels(t[this.codingPos]+c,r),r^=1}let d=!1;if(this.byteAlign&&(this.inputBits&=-8),!this.eoblock&&this.row===this.rows-1)this.rowsDone=!0;else{if(c=this._lookBits(12),this.eoline)for(;c!==oc&&c!==1;)this._eatBits(1),c=this._lookBits(12);else for(;c===0;)this._eatBits(1),c=this._lookBits(12);c===1?(this._eatBits(12),d=!0):c===oc&&(this.eof=!0)}if(!this.eof&&this.encoding>0&&!this.rowsDone&&(this.nextLine2D=!this._lookBits(1),this._eatBits(1)),this.eoblock&&d&&this.byteAlign){if(c=this._lookBits(12),c===1){if(this._eatBits(12),this.encoding>0&&(this._lookBits(1),this._eatBits(1)),this.encoding>=0)for(o=0;o<4;++o)c=this._lookBits(12),c!==1&&gn("bad rtc code: "+c),this._eatBits(12),this.encoding>0&&(this._lookBits(1),this._eatBits(1));this.eof=!0}}else if(this.err&&this.eoline){for(;;){if(c=this._lookBits(13),c===oc)return this.eof=!0,-1;if(c>>1===1)break;this._eatBits(1)}this._eatBits(12),this.encoding>0&&(this._eatBits(1),this.nextLine2D=!(c&1))}this.outputBits=t[0]>0?t[this.codingPos=0]:t[this.codingPos=1],this.row++}let l;if(this.outputBits>=8)l=this.codingPos&1?0:255,this.outputBits-=8,this.outputBits===0&&t[this.codingPos]<i&&(this.codingPos++,this.outputBits=t[this.codingPos]-t[this.codingPos-1]);else{a=8,l=0;do{if(typeof this.outputBits!="number")throw new Ee('Invalid /CCITTFaxDecode data, "outputBits" must be a number.');this.outputBits>a?(l<<=a,this.codingPos&1||(l|=255>>8-a),this.outputBits-=a,a=0):(l<<=this.outputBits,this.codingPos&1||(l|=255>>8-this.outputBits),a-=this.outputBits,this.outputBits=0,t[this.codingPos]<i?(this.codingPos++,this.outputBits=t[this.codingPos]-t[this.codingPos-1]):a>0&&(l<<=a,a=0))}while(a)}return this.black&&(l^=255),l}_addPixels(e,t){const i=this.codingLine;let s=this.codingPos;e>i[s]&&(e>this.columns&&(gn("row is wrong length"),this.err=!0,e=this.columns),s&1^t&&++s,i[s]=e),this.codingPos=s}_addPixelsNeg(e,t){const i=this.codingLine;let s=this.codingPos;if(e>i[s])e>this.columns&&(gn("row is wrong length"),this.err=!0,e=this.columns),s&1^t&&++s,i[s]=e;else if(e<i[s]){for(e<0&&(gn("invalid code"),this.err=!0,e=0);s>0&&e<i[s-1];)--s;i[s]=e}this.codingPos=s}_findTableCode(e,t,i,s){const r=s||0;for(let a=e;a<=t;++a){let o=this._lookBits(a);if(o===oc)return[!0,1,!1];if(a<t&&(o<<=t-a),!r||o>=r){const l=i[o-r];if(l[0]===a)return this._eatBits(a),[!0,l[1],!0]}}return[!1,0,!1]}_getTwoDimCode(){let e=0,t;if(this.eoblock){if(e=this._lookBits(7),t=K_[e],(t==null?void 0:t[0])>0)return this._eatBits(t[0]),t[1]}else{const i=this._findTableCode(1,7,K_);if(i[0]&&i[2])return i[1]}return gn("Bad two dim code"),oc}_getWhiteCode(){let e=0,t;if(this.eoblock){if(e=this._lookBits(12),e===oc)return 1;if(t=e>>5?Y_[e>>3]:X_[e],t[0]>0)return this._eatBits(t[0]),t[1]}else{let i=this._findTableCode(1,9,Y_);if(i[0]||(i=this._findTableCode(11,12,X_),i[0]))return i[1]}return gn("bad white code"),this._eatBits(1),1}_getBlackCode(){let e,t;if(this.eoblock){if(e=this._lookBits(13),e===oc)return 1;if(e>>7?!(e>>9)&&e>>7?t=Z_[(e>>1)-64]:t=Q_[e>>7]:t=J_[e],t[0]>0)return this._eatBits(t[0]),t[1]}else{let i=this._findTableCode(2,6,Q_);if(i[0]||(i=this._findTableCode(7,12,Z_,64),i[0])||(i=this._findTableCode(10,13,J_),i[0]))return i[1]}return gn("bad black code"),this._eatBits(1),1}_lookBits(e){let t;for(;this.inputBits<e;){if((t=this.source.next())===-1)return this.inputBits===0?oc:this.inputBuf<<e-this.inputBits&65535>>16-e;this.inputBuf=this.inputBuf<<8|t,this.inputBits+=8}return this.inputBuf>>this.inputBits-e&65535>>16-e}_eatBits(e){(this.inputBits-=e)<0&&(this.inputBits=0)}}class rH extends Jr{constructor(e,t,i){super(t),this.str=e,this.dict=e.dict,i instanceof fe||(i=fe.empty);const s={next(){return e.getByte()}};this.ccittFaxDecoder=new yR(s,{K:i.get("K"),EndOfLine:i.get("EndOfLine"),EncodedByteAlign:i.get("EncodedByteAlign"),Columns:i.get("Columns"),Rows:i.get("Rows"),EndOfBlock:i.get("EndOfBlock"),BlackIs1:i.get("BlackIs1")})}readBlock(){for(;!this.eof;){const e=this.ccittFaxDecoder.readNextChar();if(e===-1){this.eof=!0;return}this.ensureBuffer(this.bufferLength+1),this.buffer[this.bufferLength++]=e}}}const $_=new Int32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),aH=new Int32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),oH=new Int32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),lH=[new Int32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],cH=[new Int32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];var ph,Ef;class ek extends Jr{constructor(t,i){super(i);B(this,ph);this.str=t,this.dict=t.dict;const s=t.getByte(),r=t.getByte();if(s===-1||r===-1)throw new Ee(`Invalid header in flate stream: ${s}, ${r}`);if((s&15)!==8)throw new Ee(`Unknown compression method in flate stream: ${s}, ${r}`);if(((s<<8)+r)%31!==0)throw new Ee(`Bad FCHECK in flate stream: ${s}, ${r}`);if(r&32)throw new Ee(`FDICT bit set in flate stream: ${s}, ${r}`);this.codeSize=0,this.codeBuf=0}async getImageData(t,i){const s=await this.asyncGetBytes();return s?s.length<=t?s:s.subarray(0,t):this.getBytes(t)}async asyncGetBytes(){this.str.reset();const t=this.str.getBytes();try{const{readable:i,writable:s}=new DecompressionStream("deflate"),r=s.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});const a=[];let o=0;for await(const h of i)a.push(h),o+=h.byteLength;const l=new Uint8Array(o);let c=0;for(const h of a)l.set(h,c),c+=h.byteLength;return l}catch{return this.str=new Ui(t,2,t.length,this.str.dict),this.reset(),null}}get isAsync(){return!0}getBits(t){const i=this.str;let s=this.codeSize,r=this.codeBuf,a;for(;s<t;){if((a=i.getByte())===-1)throw new Ee("Bad encoding in flate stream");r|=a<<s,s+=8}return a=r&(1<<t)-1,this.codeBuf=r>>t,this.codeSize=s-=t,a}getCode(t){const i=this.str,s=t[0],r=t[1];let a=this.codeSize,o=this.codeBuf,l;for(;a<r&&(l=i.getByte())!==-1;)o|=l<<a,a+=8;const c=s[o&(1<<r)-1],h=c>>16,u=c&65535;if(h<1||a<h)throw new Ee("Bad encoding in flate stream");return this.codeBuf=o>>h,this.codeSize=a-h,u}generateHuffmanTable(t){const i=t.length;let s=0,r;for(r=0;r<i;++r)t[r]>s&&(s=t[r]);const a=1<<s,o=new Int32Array(a);for(let l=1,c=0,h=2;l<=s;++l,c<<=1,h<<=1)for(let u=0;u<i;++u)if(t[u]===l){let d=0,f=c;for(r=0;r<l;++r)d=d<<1|f&1,f>>=1;for(r=d;r<a;r+=h)o[r]=l<<16|u;++c}return[o,s]}readBlock(){let t,i,s;const r=this.str;try{i=this.getBits(3)}catch(h){L(this,ph,Ef).call(this,h.message);return}if(i&1&&(this.eof=!0),i>>=1,i===0){let h;if((h=r.getByte())===-1){L(this,ph,Ef).call(this,"Bad block header in flate stream");return}let u=h;if((h=r.getByte())===-1){L(this,ph,Ef).call(this,"Bad block header in flate stream");return}if(u|=h<<8,(h=r.getByte())===-1){L(this,ph,Ef).call(this,"Bad block header in flate stream");return}let d=h;if((h=r.getByte())===-1){L(this,ph,Ef).call(this,"Bad block header in flate stream");return}if(d|=h<<8,d!==(~u&65535)&&(u!==0||d!==0))throw new Ee("Bad uncompressed block length in flate stream");this.codeBuf=0,this.codeSize=0;const f=this.bufferLength,g=f+u;if(t=this.ensureBuffer(g),this.bufferLength=g,u===0)r.peekByte()===-1&&(this.eof=!0);else{const m=r.getBytes(u);t.set(m,f),m.length<u&&(this.eof=!0)}return}let a,o;if(i===1)a=lH,o=cH;else if(i===2){const h=this.getBits(5)+257,u=this.getBits(5)+1,d=this.getBits(4)+4,f=new Uint8Array($_.length);let g;for(g=0;g<d;++g)f[$_[g]]=this.getBits(3);const m=this.generateHuffmanTable(f);s=0,g=0;const x=h+u,p=new Uint8Array(x);let y,w,v;for(;g<x;){const _=this.getCode(m);if(_===16)y=2,w=3,v=s;else if(_===17)y=3,w=3,v=s=0;else if(_===18)y=7,w=11,v=s=0;else{p[g++]=s=_;continue}let C=this.getBits(y)+w;for(;C-- >0;)p[g++]=v}a=this.generateHuffmanTable(p.subarray(0,h)),o=this.generateHuffmanTable(p.subarray(h,x))}else throw new Ee("Unknown block type in flate stream");t=this.buffer;let l=t?t.length:0,c=this.bufferLength;for(;;){let h=this.getCode(a);if(h<256){c+1>=l&&(t=this.ensureBuffer(c+1),l=t.length),t[c++]=h;continue}if(h===256){this.bufferLength=c;return}h-=257,h=aH[h];let u=h>>16;u>0&&(u=this.getBits(u)),s=(h&65535)+u,h=this.getCode(o),h=oH[h],u=h>>16,u>0&&(u=this.getBits(u));const d=(h&65535)+u;c+s>=l&&(t=this.ensureBuffer(c+s),l=t.length);for(let f=0;f<s;++f,++c)t[c]=t[c-d]}}}ph=new WeakSet,Ef=function(t){gn(t),this.eof=!0};const hH=[{qe:22017,nmps:1,nlps:1,switchFlag:1},{qe:13313,nmps:2,nlps:6,switchFlag:0},{qe:6145,nmps:3,nlps:9,switchFlag:0},{qe:2753,nmps:4,nlps:12,switchFlag:0},{qe:1313,nmps:5,nlps:29,switchFlag:0},{qe:545,nmps:38,nlps:33,switchFlag:0},{qe:22017,nmps:7,nlps:6,switchFlag:1},{qe:21505,nmps:8,nlps:14,switchFlag:0},{qe:18433,nmps:9,nlps:14,switchFlag:0},{qe:14337,nmps:10,nlps:14,switchFlag:0},{qe:12289,nmps:11,nlps:17,switchFlag:0},{qe:9217,nmps:12,nlps:18,switchFlag:0},{qe:7169,nmps:13,nlps:20,switchFlag:0},{qe:5633,nmps:29,nlps:21,switchFlag:0},{qe:22017,nmps:15,nlps:14,switchFlag:1},{qe:21505,nmps:16,nlps:14,switchFlag:0},{qe:20737,nmps:17,nlps:15,switchFlag:0},{qe:18433,nmps:18,nlps:16,switchFlag:0},{qe:14337,nmps:19,nlps:17,switchFlag:0},{qe:13313,nmps:20,nlps:18,switchFlag:0},{qe:12289,nmps:21,nlps:19,switchFlag:0},{qe:10241,nmps:22,nlps:19,switchFlag:0},{qe:9217,nmps:23,nlps:20,switchFlag:0},{qe:8705,nmps:24,nlps:21,switchFlag:0},{qe:7169,nmps:25,nlps:22,switchFlag:0},{qe:6145,nmps:26,nlps:23,switchFlag:0},{qe:5633,nmps:27,nlps:24,switchFlag:0},{qe:5121,nmps:28,nlps:25,switchFlag:0},{qe:4609,nmps:29,nlps:26,switchFlag:0},{qe:4353,nmps:30,nlps:27,switchFlag:0},{qe:2753,nmps:31,nlps:28,switchFlag:0},{qe:2497,nmps:32,nlps:29,switchFlag:0},{qe:2209,nmps:33,nlps:30,switchFlag:0},{qe:1313,nmps:34,nlps:31,switchFlag:0},{qe:1089,nmps:35,nlps:32,switchFlag:0},{qe:673,nmps:36,nlps:33,switchFlag:0},{qe:545,nmps:37,nlps:34,switchFlag:0},{qe:321,nmps:38,nlps:35,switchFlag:0},{qe:273,nmps:39,nlps:36,switchFlag:0},{qe:133,nmps:40,nlps:37,switchFlag:0},{qe:73,nmps:41,nlps:38,switchFlag:0},{qe:37,nmps:42,nlps:39,switchFlag:0},{qe:21,nmps:43,nlps:40,switchFlag:0},{qe:9,nmps:44,nlps:41,switchFlag:0},{qe:5,nmps:45,nlps:42,switchFlag:0},{qe:1,nmps:45,nlps:43,switchFlag:0},{qe:22017,nmps:46,nlps:46,switchFlag:0}];class uH{constructor(e,t,i){this.data=e,this.bp=t,this.dataEnd=i,this.chigh=e[t],this.clow=0,this.byteIn(),this.chigh=this.chigh<<7&65535|this.clow>>9&127,this.clow=this.clow<<7&65535,this.ct-=7,this.a=32768}byteIn(){const e=this.data;let t=this.bp;e[t]===255?e[t+1]>143?(this.clow+=65280,this.ct=8):(t++,this.clow+=e[t]<<9,this.ct=7,this.bp=t):(t++,this.clow+=t<this.dataEnd?e[t]<<8:65280,this.ct=8,this.bp=t),this.clow>65535&&(this.chigh+=this.clow>>16,this.clow&=65535)}readBit(e,t){let i=e[t]>>1,s=e[t]&1;const r=hH[i],a=r.qe;let o,l=this.a-a;if(this.chigh<a)l<a?(l=a,o=s,i=r.nmps):(l=a,o=1^s,r.switchFlag===1&&(s=o),i=r.nlps);else{if(this.chigh-=a,l&32768)return this.a=l,s;l<a?(o=1^s,r.switchFlag===1&&(s=o),i=r.nlps):(o=s,i=r.nmps)}do this.ct===0&&this.byteIn(),l<<=1,this.chigh=this.chigh<<1&65535|this.clow>>15&1,this.clow=this.clow<<1&65535,this.ct--;while(!(l&32768));return this.a=l,e[t]=i<<1|s,o}}class Di extends Qr{constructor(e){super(e,"Jbig2Error")}}class dH{getContexts(e){return e in this?this[e]:this[e]=new Int8Array(65536)}}class _m{constructor(e,t,i){this.data=e,this.start=t,this.end=i}get decoder(){const e=new uH(this.data,this.start,this.end);return Ze(this,"decoder",e)}get contextCache(){const e=new dH;return Ze(this,"contextCache",e)}}function vr(n,e,t){const i=n.getContexts(e);let s=1;function r(c){let h=0;for(let u=0;u<c;u++){const d=t.readBit(i,s);s=s<256?s<<1|d:(s<<1|d)&511|256,h=h<<1|d}return h>>>0}const a=r(1),o=r(1)?r(1)?r(1)?r(1)?r(1)?r(32)+4436:r(12)+340:r(8)+84:r(6)+20:r(4)+4:r(2);let l;return a===0?l=o:o>0&&(l=-o),l>=rU&&l<=v7?l:null}function wR(n,e,t){const i=n.getContexts("IAID");let s=1;for(let r=0;r<t;r++){const a=e.readBit(i,s);s=s<<1|a}return t<31?s&(1<<t)-1:s&2147483647}const tk=["SymbolDictionary",null,null,null,"IntermediateTextRegion",null,"ImmediateTextRegion","ImmediateLosslessTextRegion",null,null,null,null,null,null,null,null,"PatternDictionary",null,null,null,"IntermediateHalftoneRegion",null,"ImmediateHalftoneRegion","ImmediateLosslessHalftoneRegion",null,null,null,null,null,null,null,null,null,null,null,null,"IntermediateGenericRegion",null,"ImmediateGenericRegion","ImmediateLosslessGenericRegion","IntermediateGenericRefinementRegion",null,"ImmediateGenericRefinementRegion","ImmediateLosslessGenericRefinementRegion",null,null,null,null,"PageInformation","EndOfPage","EndOfStripe","EndOfFile","Profiles","Tables",null,null,null,null,null,null,null,null,"Extension"],fH=[[{x:-1,y:-2},{x:0,y:-2},{x:1,y:-2},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:2,y:-1},{x:-4,y:0},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0}],[{x:-1,y:-2},{x:0,y:-2},{x:1,y:-2},{x:2,y:-2},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:2,y:-1},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0}],[{x:-1,y:-2},{x:0,y:-2},{x:1,y:-2},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-2,y:0},{x:-1,y:0}],[{x:-3,y:-1},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-4,y:0},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0}]],nk=[{coding:[{x:0,y:-1},{x:1,y:-1},{x:-1,y:0}],reference:[{x:0,y:-1},{x:1,y:-1},{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:-1,y:1},{x:0,y:1},{x:1,y:1}]},{coding:[{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-1,y:0}],reference:[{x:0,y:-1},{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1}]}],gH=[39717,1941,229,405];function mH(n,e,t){const i=t.decoder,s=t.contextCache.getContexts("GB"),r=[];let a,o,l,c,h,u,d;const f=31735;for(o=0;o<e;o++)for(h=r[o]=new Uint8Array(n),u=o<1?h:r[o-1],d=o<2?h:r[o-2],a=d[0]<<13|d[1]<<12|d[2]<<11|u[0]<<7|u[1]<<6|u[2]<<5|u[3]<<4,l=0;l<n;l++)h[l]=c=i.readBit(s,a),a=(a&f)<<1|(l+3<n?d[l+3]<<11:0)|(l+4<n?u[l+4]<<4:0)|c;return r}function ey(n,e,t,i,s,r,a,o){if(n){const ae=new Up(o.data,o.start,o.end);return b4(ae,e,t,!1)}if(i===0&&!r&&!s&&a.length===4&&a[0].x===3&&a[0].y===-1&&a[1].x===-3&&a[1].y===-1&&a[2].x===2&&a[2].y===-2&&a[3].x===-2&&a[3].y===-2)return mH(e,t,o);const l=fH[i].concat(a);l.sort((ae,ge)=>ae.y-ge.y||ae.x-ge.x);const c=l.length,h=new Int8Array(c),u=new Int8Array(c),d=[];let f=0,g=0,m=0,x=0,p,y;for(y=0;y<c;y++)h[y]=l[y].x,u[y]=l[y].y,g=Math.min(g,l[y].x),m=Math.max(m,l[y].x),x=Math.min(x,l[y].y),y<c-1&&l[y].y===l[y+1].y&&l[y].x===l[y+1].x-1?f|=1<<c-1-y:d.push(y);const w=d.length,v=new Int8Array(w),_=new Int8Array(w),C=new Uint16Array(w);for(p=0;p<w;p++)y=d[p],v[p]=l[y].x,_[p]=l[y].y,C[p]=1<<c-1-y;const k=-g,I=-x,S=e-m,R=gH[i];let P=new Uint8Array(e);const D=[],U=o.decoder,T=o.contextCache.getContexts("GB");let G=0,M,F,X,z=0,K,j;for(let ae=0;ae<t;ae++){if(s){const ge=U.readBit(T,R);if(G^=ge,G){D.push(P);continue}}for(P=new Uint8Array(P),D.push(P),M=0;M<e;M++){if(M>=k&&M<S&&ae>=I)for(z=z<<1&f,y=0;y<w;y++)F=ae+_[y],X=M+v[y],K=D[F][X],K&&(K=C[y],z|=K);else for(z=0,j=c-1,y=0;y<c;y++,j--)X=M+h[y],X>=0&&X<e&&(F=ae+u[y],F>=0&&(K=D[F][X],K&&(z|=K<<j)));const ge=U.readBit(T,z);P[M]=ge}}return D}function vR(n,e,t,i,s,r,a,o,l){let c=nk[t].coding;t===0&&(c=c.concat([o[0]]));const h=c.length,u=new Int32Array(h),d=new Int32Array(h);let f;for(f=0;f<h;f++)u[f]=c[f].x,d[f]=c[f].y;let g=nk[t].reference;t===0&&(g=g.concat([o[1]]));const m=g.length,x=new Int32Array(m),p=new Int32Array(m);for(f=0;f<m;f++)x[f]=g[f].x,p[f]=g[f].y;const y=i[0].length,w=i.length,v=[],_=l.decoder,C=l.contextCache.getContexts("GR");for(let k=0;k<e;k++){const I=new Uint8Array(n);v.push(I);for(let S=0;S<n;S++){let R,P,D=0;for(f=0;f<h;f++)R=k+d[f],P=S+u[f],R<0||P<0||P>=n?D<<=1:D=D<<1|v[R][P];for(f=0;f<m;f++)R=k+p[f]-r,P=S+x[f]-s,R<0||R>=w||P<0||P>=y?D<<=1:D=D<<1|i[R][P];const U=_.readBit(C,D);I[S]=U}}return v}function pH(n,e,t,i,s,r,a,o,l,c,h,u){if(n&&e)throw new Di("symbol refinement with Huffman is not supported");const d=[];let f=0,g=g4(t.length+i);const m=h.decoder,x=h.contextCache;let p,y;for(n&&(p=Sh(1),y=[],g=Math.max(g,1));d.length<i;){const S=n?r.tableDeltaHeight.decode(u):vr(x,"IADH",m);f+=S;let R=0,P=0;const D=n?y.length:0;for(;;){const U=n?r.tableDeltaWidth.decode(u):vr(x,"IADW",m);if(U===null)break;R+=U,P+=R;let T;if(e){const G=vr(x,"IAAI",m);if(G>1)T=_R(n,e,R,f,0,G,1,t.concat(d),g,0,0,1,0,r,l,c,h,0,u);else{const M=wR(x,m,g),F=vr(x,"IARDX",m),X=vr(x,"IARDY",m),z=M<t.length?t[M]:d[M-t.length];T=vR(R,f,l,z,F,X,!1,c,h)}d.push(T)}else n?y.push(R):(T=ey(!1,R,f,a,!1,null,o,h),d.push(T))}if(n&&!e){const U=r.tableBitmapSize.decode(u);u.byteAlign();let T;if(U===0)T=EH(u,P,f);else{const M=u.end,F=u.position+U;u.end=F,T=b4(u,P,f,!1),u.end=M,u.position=F}const G=y.length;if(D===G-1)d.push(T);else{let M,F,X=0,z,K,j;for(M=D;M<G;M++){for(K=y[M],z=X+K,j=[],F=0;F<f;F++)j.push(T[F].subarray(X,z));d.push(j),X=z}}}}const w=[],v=[];let _=!1,C,k;const I=t.length+i;for(;v.length<I;){let S=n?p.decode(u):vr(x,"IAEX",m);for(;S--;)v.push(_);_=!_}for(C=0,k=t.length;C<k;C++)v[C]&&w.push(t[C]);for(let S=0;S<i;C++,S++)v[C]&&w.push(d[S]);return w}function _R(n,e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y){if(n&&e)throw new Di("refinement with Huffman is not supported");const w=[];let v,_;for(v=0;v<i;v++)_=new Uint8Array(t),s&&_.fill(s),w.push(_);const C=x.decoder,k=x.contextCache;let I=n?-f.tableDeltaT.decode(y):-vr(k,"IADT",C),S=0;for(v=0;v<r;){const R=n?f.tableDeltaT.decode(y):vr(k,"IADT",C);I+=R;const P=n?f.tableFirstS.decode(y):vr(k,"IAFS",C);S+=P;let D=S;do{let U=0;a>1&&(U=n?y.readBits(p):vr(k,"IAIT",C));const T=a*I+U,G=n?f.symbolIDTable.decode(y):wR(k,C,l),M=e&&(n?y.readBit():vr(k,"IARI",C));let F=o[G],X=F[0].length,z=F.length;if(M){const O=vr(k,"IARDW",C),Y=vr(k,"IARDH",C),le=vr(k,"IARDX",C),$=vr(k,"IARDY",C);X+=O,z+=Y,F=vR(X,z,g,F,(O>>1)+le,(Y>>1)+$,!1,m,x)}let K=0;c?u&1?K=z-1:D+=z-1:u>1?D+=X-1:K=X-1;const j=T-(u&1?0:z-1),ae=D-(u&2?X-1:0);let ge,ue,pe;if(c)for(ge=0;ge<z;ge++){if(_=w[ae+ge],!_)continue;pe=F[ge];const O=Math.min(t-j,X);switch(d){case 0:for(ue=0;ue<O;ue++)_[j+ue]|=pe[ue];break;case 2:for(ue=0;ue<O;ue++)_[j+ue]^=pe[ue];break;default:throw new Di(`operator ${d} is not supported`)}}else for(ue=0;ue<z;ue++)if(_=w[j+ue],!!_)switch(pe=F[ue],d){case 0:for(ge=0;ge<X;ge++)_[ae+ge]|=pe[ge];break;case 2:for(ge=0;ge<X;ge++)_[ae+ge]^=pe[ge];break;default:throw new Di(`operator ${d} is not supported`)}v++;const de=n?f.tableDeltaS.decode(y):vr(k,"IADS",C);if(de===null)break;D+=K+de+h}while(!0)}return w}function bH(n,e,t,i,s,r){const a=[];n||(a.push({x:-e,y:0}),s===0&&a.push({x:-3,y:-1},{x:2,y:-2},{x:-2,y:-2}));const o=(i+1)*e,l=ey(n,o,t,s,!1,null,a,r),c=[];for(let h=0;h<=i;h++){const u=[],d=e*h,f=d+e;for(let g=0;g<t;g++)u.push(l[g].subarray(d,f));c.push(u)}return c}function xH(n,e,t,i,s,r,a,o,l,c,h,u,d,f,g){if(a)throw new Di("skip is not supported");if(o!==0)throw new Di(`operator "${o}" is not supported in halftone region`);const x=[];let p,y,w;for(p=0;p<s;p++)w=new Uint8Array(i),r&&w.fill(r),x.push(w);const v=e.length,_=e[0],C=_[0].length,k=_.length,I=g4(v),S=[];n||(S.push({x:t<=1?3:2,y:-1}),t===0&&S.push({x:-3,y:-1},{x:2,y:-2},{x:-2,y:-2}));const R=[];let P,D;for(n&&(P=new Up(g.data,g.start,g.end)),p=I-1;p>=0;p--)n?D=b4(P,l,c,!0):D=ey(!1,l,c,t,!1,null,S,g),R[p]=D;let U,T,G,M,F,X,z,K,j;for(U=0;U<c;U++)for(T=0;T<l;T++){for(G=0,M=0,y=I-1;y>=0;y--)G^=R[y][U][T],M|=G<<y;if(F=e[M],X=h+U*f+T*d>>8,z=u+U*d-T*f>>8,X>=0&&X+C<=i&&z>=0&&z+k<=s)for(p=0;p<k;p++)for(j=x[z+p],K=F[p],y=0;y<C;y++)j[X+y]|=K[y];else{let ae,ge;for(p=0;p<k;p++)if(ge=z+p,!(ge<0||ge>=s))for(j=x[ge],K=F[p],y=0;y<C;y++)ae=X+y,ae>=0&&ae<i&&(j[ae]|=K[y])}}return x}function yH(n,e){const t={};t.number=Jn(n,e);const i=n[e+4],s=i&63;if(!tk[s])throw new Di("invalid segment type: "+s);t.type=s,t.typeName=tk[s],t.deferredNonRetain=!!(i&128);const r=!!(i&64),a=n[e+5];let o=a>>5&7;const l=[a&31];let c=e+6;if(a===7){o=Jn(n,c-1)&536870911,c+=3;let g=o+7>>3;for(l[0]=n[c++];--g>0;)l.push(n[c++])}else if(a===5||a===6)throw new Di("invalid referred-to flags");t.retainBits=l;let h=4;t.number<=256?h=1:t.number<=65536&&(h=2);const u=[];let d,f;for(d=0;d<o;d++){let g;h===1?g=n[c]:h===2?g=xn(n,c):g=Jn(n,c),u.push(g),c+=h}if(t.referredTo=u,r?(t.pageAssociation=Jn(n,c),c+=4):t.pageAssociation=n[c++],t.length=Jn(n,c),c+=4,t.length===4294967295)if(s===38){const g=$9(n,c),x=!!(n[c+e3]&1),p=6,y=new Uint8Array(p);for(x||(y[0]=255,y[1]=172),y[2]=g.height>>>24&255,y[3]=g.height>>16&255,y[4]=g.height>>8&255,y[5]=g.height&255,d=c,f=n.length;d<f;d++){let w=0;for(;w<p&&y[w]===n[d+w];)w++;if(w===p){t.length=d+p;break}}if(t.length===4294967295)throw new Di("segment end was not found")}else throw new Di("invalid unknown segment length");return t.headerEnd=c,t}function wH(n,e,t,i){const s=[];let r=t;for(;r<i;){const a=yH(e,r);r=a.headerEnd;const o={header:a,data:e};if(n.randomAccess||(o.start=r,r+=a.length,o.end=r),s.push(o),a.type===51)break}if(n.randomAccess)for(let a=0,o=s.length;a<o;a++)s[a].start=r,r+=s[a].header.length,s[a].end=r;return s}function $9(n,e){return{width:Jn(n,e),height:Jn(n,e+4),x:Jn(n,e+8),y:Jn(n,e+12),combinationOperator:n[e+16]&7}}const e3=17;function vH(n,e){const t=n.header,i=n.data,s=n.end;let r=n.start,a,o,l,c;switch(t.type){case 0:const u={},d=xn(i,r);if(u.huffman=!!(d&1),u.refinement=!!(d&2),u.huffmanDHSelector=d>>2&3,u.huffmanDWSelector=d>>4&3,u.bitmapSizeSelector=d>>6&1,u.aggregationInstancesSelector=d>>7&1,u.bitmapCodingContextUsed=!!(d&256),u.bitmapCodingContextRetained=!!(d&512),u.template=d>>10&3,u.refinementTemplate=d>>12&1,r+=2,!u.huffman){for(c=u.template===0?4:1,o=[],l=0;l<c;l++)o.push({x:vl(i,r),y:vl(i,r+1)}),r+=2;u.at=o}if(u.refinement&&!u.refinementTemplate){for(o=[],l=0;l<2;l++)o.push({x:vl(i,r),y:vl(i,r+1)}),r+=2;u.refinementAt=o}u.numberOfExportedSymbols=Jn(i,r),r+=4,u.numberOfNewSymbols=Jn(i,r),r+=4,a=[u,t.number,t.referredTo,i,r,s];break;case 6:case 7:const f={};f.info=$9(i,r),r+=e3;const g=xn(i,r);if(r+=2,f.huffman=!!(g&1),f.refinement=!!(g&2),f.logStripSize=g>>2&3,f.stripSize=1<<f.logStripSize,f.referenceCorner=g>>4&3,f.transposed=!!(g&64),f.combinationOperator=g>>7&3,f.defaultPixelValue=g>>9&1,f.dsOffset=g<<17>>27,f.refinementTemplate=g>>15&1,f.huffman){const k=xn(i,r);r+=2,f.huffmanFS=k&3,f.huffmanDS=k>>2&3,f.huffmanDT=k>>4&3,f.huffmanRefinementDW=k>>6&3,f.huffmanRefinementDH=k>>8&3,f.huffmanRefinementDX=k>>10&3,f.huffmanRefinementDY=k>>12&3,f.huffmanRefinementSizeSelector=!!(k&16384)}if(f.refinement&&!f.refinementTemplate){for(o=[],l=0;l<2;l++)o.push({x:vl(i,r),y:vl(i,r+1)}),r+=2;f.refinementAt=o}f.numberOfSymbolInstances=Jn(i,r),r+=4,a=[f,t.referredTo,i,r,s];break;case 16:const m={},x=i[r++];m.mmr=!!(x&1),m.template=x>>1&3,m.patternWidth=i[r++],m.patternHeight=i[r++],m.maxPatternIndex=Jn(i,r),r+=4,a=[m,t.number,i,r,s];break;case 22:case 23:const p={};p.info=$9(i,r),r+=e3;const y=i[r++];p.mmr=!!(y&1),p.template=y>>1&3,p.enableSkip=!!(y&8),p.combinationOperator=y>>4&7,p.defaultPixelValue=y>>7&1,p.gridWidth=Jn(i,r),r+=4,p.gridHeight=Jn(i,r),r+=4,p.gridOffsetX=Jn(i,r)&4294967295,r+=4,p.gridOffsetY=Jn(i,r)&4294967295,r+=4,p.gridVectorX=xn(i,r),r+=2,p.gridVectorY=xn(i,r),r+=2,a=[p,t.referredTo,i,r,s];break;case 38:case 39:const w={};w.info=$9(i,r),r+=e3;const v=i[r++];if(w.mmr=!!(v&1),w.template=v>>1&3,w.prediction=!!(v&8),!w.mmr){for(c=w.template===0?4:1,o=[],l=0;l<c;l++)o.push({x:vl(i,r),y:vl(i,r+1)}),r+=2;w.at=o}a=[w,i,r,s];break;case 48:const _={width:Jn(i,r),height:Jn(i,r+4),resolutionX:Jn(i,r+8),resolutionY:Jn(i,r+12)};_.height===4294967295&&delete _.height;const C=i[r+16];xn(i,r+17),_.lossless=!!(C&1),_.refinement=!!(C&2),_.defaultPixelValue=C>>2&1,_.combinationOperator=C>>3&3,_.requiresBuffer=!!(C&32),_.combinationOperatorOverride=!!(C&64),a=[_];break;case 49:break;case 50:break;case 51:break;case 53:a=[t.number,i,r,s];break;case 62:break;default:throw new Di(`segment type ${t.typeName}(${t.type}) is not implemented`)}const h="on"+t.typeName;h in e&&e[h].apply(e,a)}function _H(n,e){for(let t=0,i=n.length;t<i;t++)vH(n[t],e)}function kH(n){const e=new CH;for(let t=0,i=n.length;t<i;t++){const s=n[t],r=wH({},s.data,s.start,s.end);_H(r,e)}return e.buffer}class CH{onPageInformation(e){this.currentPageInfo=e;const t=e.width+7>>3,i=new Uint8ClampedArray(t*e.height);e.defaultPixelValue&&i.fill(255),this.buffer=i}drawBitmap(e,t){const i=this.currentPageInfo,s=e.width,r=e.height,a=i.width+7>>3,o=i.combinationOperatorOverride?e.combinationOperator:i.combinationOperator,l=this.buffer,c=128>>(e.x&7);let h=e.y*a+(e.x>>3),u,d,f,g;switch(o){case 0:for(u=0;u<r;u++){for(f=c,g=h,d=0;d<s;d++)t[u][d]&&(l[g]|=f),f>>=1,f||(f=128,g++);h+=a}break;case 2:for(u=0;u<r;u++){for(f=c,g=h,d=0;d<s;d++)t[u][d]&&(l[g]^=f),f>>=1,f||(f=128,g++);h+=a}break;default:throw new Di(`operator ${o} is not supported`)}}onImmediateGenericRegion(e,t,i,s){const r=e.info,a=new _m(t,i,s),o=ey(e.mmr,r.width,r.height,e.template,e.prediction,null,e.at,a);this.drawBitmap(r,o)}onImmediateLosslessGenericRegion(){this.onImmediateGenericRegion(...arguments)}onSymbolDictionary(e,t,i,s,r,a){let o,l;e.huffman&&(o=IH(e,i,this.customTables),l=new Up(s,r,a));let c=this.symbols;c||(this.symbols=c={});const h=[];for(const d of i){const f=c[d];f&&h.push(...f)}const u=new _m(s,r,a);c[t]=pH(e.huffman,e.refinement,h,e.numberOfNewSymbols,e.numberOfExportedSymbols,o,e.template,e.at,e.refinementTemplate,e.refinementAt,u,l)}onImmediateTextRegion(e,t,i,s,r){const a=e.info;let o,l;const c=this.symbols,h=[];for(const g of t){const m=c[g];m&&h.push(...m)}const u=g4(h.length);e.huffman&&(l=new Up(i,s,r),o=SH(e,t,this.customTables,h.length,l));const d=new _m(i,s,r),f=_R(e.huffman,e.refinement,a.width,a.height,e.defaultPixelValue,e.numberOfSymbolInstances,e.stripSize,h,u,e.transposed,e.dsOffset,e.referenceCorner,e.combinationOperator,o,e.refinementTemplate,e.refinementAt,d,e.logStripSize,l);this.drawBitmap(a,f)}onImmediateLosslessTextRegion(){this.onImmediateTextRegion(...arguments)}onPatternDictionary(e,t,i,s,r){let a=this.patterns;a||(this.patterns=a={});const o=new _m(i,s,r);a[t]=bH(e.mmr,e.patternWidth,e.patternHeight,e.maxPatternIndex,e.template,o)}onImmediateHalftoneRegion(e,t,i,s,r){const a=this.patterns[t[0]],o=e.info,l=new _m(i,s,r),c=xH(e.mmr,a,e.template,o.width,o.height,e.defaultPixelValue,e.enableSkip,e.combinationOperator,e.gridWidth,e.gridHeight,e.gridOffsetX,e.gridOffsetY,e.gridVectorX,e.gridVectorY,l);this.drawBitmap(o,c)}onImmediateLosslessHalftoneRegion(){this.onImmediateHalftoneRegion(...arguments)}onTables(e,t,i,s){let r=this.customTables;r||(this.customTables=r={}),r[e]=AH(t,i,s)}}class Ah{constructor(e){e.length===2?(this.isOOB=!0,this.rangeLow=0,this.prefixLength=e[0],this.rangeLength=0,this.prefixCode=e[1],this.isLowerRange=!1):(this.isOOB=!1,this.rangeLow=e[0],this.prefixLength=e[1],this.rangeLength=e[2],this.prefixCode=e[3],this.isLowerRange=e[4]==="lower")}}class I3{constructor(e){this.children=[],e?(this.isLeaf=!0,this.rangeLength=e.rangeLength,this.rangeLow=e.rangeLow,this.isLowerRange=e.isLowerRange,this.isOOB=e.isOOB):this.isLeaf=!1}buildTree(e,t){const i=e.prefixCode>>t&1;if(t<=0)this.children[i]=new I3(e);else{let s=this.children[i];s||(this.children[i]=s=new I3(null)),s.buildTree(e,t-1)}}decodeNode(e){if(this.isLeaf){if(this.isOOB)return null;const i=e.readBits(this.rangeLength);return this.rangeLow+(this.isLowerRange?-i:i)}const t=this.children[e.readBit()];if(!t)throw new Di("invalid Huffman data");return t.decodeNode(e)}}class E3{constructor(e,t){t||this.assignPrefixCodes(e),this.rootNode=new I3(null);for(let i=0,s=e.length;i<s;i++){const r=e[i];r.prefixLength>0&&this.rootNode.buildTree(r,r.prefixLength-1)}}decode(e){return this.rootNode.decodeNode(e)}assignPrefixCodes(e){const t=e.length;let i=0;for(let h=0;h<t;h++)i=Math.max(i,e[h].prefixLength);const s=new Uint32Array(i+1);for(let h=0;h<t;h++)s[e[h].prefixLength]++;let r=1,a=0,o,l,c;for(s[0]=0;r<=i;){for(a=a+s[r-1]<<1,o=a,l=0;l<t;)c=e[l],c.prefixLength===r&&(c.prefixCode=o,o++),l++;r++}}}function AH(n,e,t){const i=n[e],s=Jn(n,e+1)&4294967295,r=Jn(n,e+5)&4294967295,a=new Up(n,e+9,t),o=(i>>1&7)+1,l=(i>>4&7)+1,c=[];let h,u,d=s;do h=a.readBits(o),u=a.readBits(l),c.push(new Ah([d,h,u,0])),d+=1<<u;while(d<r);return h=a.readBits(o),c.push(new Ah([s-1,h,32,0,"lower"])),h=a.readBits(o),c.push(new Ah([r,h,32,0])),i&1&&(h=a.readBits(o),c.push(new Ah([h,0]))),new E3(c,!1)}const ik={};function Sh(n){let e=ik[n];if(e)return e;let t;switch(n){case 1:t=[[0,1,4,0],[16,2,8,2],[272,3,16,6],[65808,3,32,7]];break;case 2:t=[[0,1,0,0],[1,2,0,2],[2,3,0,6],[3,4,3,14],[11,5,6,30],[75,6,32,62],[6,63]];break;case 3:t=[[-256,8,8,254],[0,1,0,0],[1,2,0,2],[2,3,0,6],[3,4,3,14],[11,5,6,30],[-257,8,32,255,"lower"],[75,7,32,126],[6,62]];break;case 4:t=[[1,1,0,0],[2,2,0,2],[3,3,0,6],[4,4,3,14],[12,5,6,30],[76,5,32,31]];break;case 5:t=[[-255,7,8,126],[1,1,0,0],[2,2,0,2],[3,3,0,6],[4,4,3,14],[12,5,6,30],[-256,7,32,127,"lower"],[76,6,32,62]];break;case 6:t=[[-2048,5,10,28],[-1024,4,9,8],[-512,4,8,9],[-256,4,7,10],[-128,5,6,29],[-64,5,5,30],[-32,4,5,11],[0,2,7,0],[128,3,7,2],[256,3,8,3],[512,4,9,12],[1024,4,10,13],[-2049,6,32,62,"lower"],[2048,6,32,63]];break;case 7:t=[[-1024,4,9,8],[-512,3,8,0],[-256,4,7,9],[-128,5,6,26],[-64,5,5,27],[-32,4,5,10],[0,4,5,11],[32,5,5,28],[64,5,6,29],[128,4,7,12],[256,3,8,1],[512,3,9,2],[1024,3,10,3],[-1025,5,32,30,"lower"],[2048,5,32,31]];break;case 8:t=[[-15,8,3,252],[-7,9,1,508],[-5,8,1,253],[-3,9,0,509],[-2,7,0,124],[-1,4,0,10],[0,2,1,0],[2,5,0,26],[3,6,0,58],[4,3,4,4],[20,6,1,59],[22,4,4,11],[38,4,5,12],[70,5,6,27],[134,5,7,28],[262,6,7,60],[390,7,8,125],[646,6,10,61],[-16,9,32,510,"lower"],[1670,9,32,511],[2,1]];break;case 9:t=[[-31,8,4,252],[-15,9,2,508],[-11,8,2,253],[-7,9,1,509],[-5,7,1,124],[-3,4,1,10],[-1,3,1,2],[1,3,1,3],[3,5,1,26],[5,6,1,58],[7,3,5,4],[39,6,2,59],[43,4,5,11],[75,4,6,12],[139,5,7,27],[267,5,8,28],[523,6,8,60],[779,7,9,125],[1291,6,11,61],[-32,9,32,510,"lower"],[3339,9,32,511],[2,0]];break;case 10:t=[[-21,7,4,122],[-5,8,0,252],[-4,7,0,123],[-3,5,0,24],[-2,2,2,0],[2,5,0,25],[3,6,0,54],[4,7,0,124],[5,8,0,253],[6,2,6,1],[70,5,5,26],[102,6,5,55],[134,6,6,56],[198,6,7,57],[326,6,8,58],[582,6,9,59],[1094,6,10,60],[2118,7,11,125],[-22,8,32,254,"lower"],[4166,8,32,255],[2,2]];break;case 11:t=[[1,1,0,0],[2,2,1,2],[4,4,0,12],[5,4,1,13],[7,5,1,28],[9,5,2,29],[13,6,2,60],[17,7,2,122],[21,7,3,123],[29,7,4,124],[45,7,5,125],[77,7,6,126],[141,7,32,127]];break;case 12:t=[[1,1,0,0],[2,2,0,2],[3,3,1,6],[5,5,0,28],[6,5,1,29],[8,6,1,60],[10,7,0,122],[11,7,1,123],[13,7,2,124],[17,7,3,125],[25,7,4,126],[41,8,5,254],[73,8,32,255]];break;case 13:t=[[1,1,0,0],[2,3,0,4],[3,4,0,12],[4,5,0,28],[5,4,1,13],[7,3,3,5],[15,6,1,58],[17,6,2,59],[21,6,3,60],[29,6,4,61],[45,6,5,62],[77,7,6,126],[141,7,32,127]];break;case 14:t=[[-2,3,0,4],[-1,3,0,5],[0,1,0,0],[1,3,0,6],[2,3,0,7]];break;case 15:t=[[-24,7,4,124],[-8,6,2,60],[-4,5,1,28],[-2,4,0,12],[-1,3,0,4],[0,1,0,0],[1,3,0,5],[2,4,0,13],[3,5,1,29],[5,6,2,61],[9,7,4,125],[-25,7,32,126,"lower"],[25,7,32,127]];break;default:throw new Di(`standard table B.${n} does not exist`)}for(let i=0,s=t.length;i<s;i++)t[i]=new Ah(t[i]);return e=new E3(t,!0),ik[n]=e,e}class Up{constructor(e,t,i){this.data=e,this.start=t,this.end=i,this.position=t,this.shift=-1,this.currentByte=0}readBit(){if(this.shift<0){if(this.position>=this.end)throw new Di("end of data while reading bit");this.currentByte=this.data[this.position++],this.shift=7}const e=this.currentByte>>this.shift&1;return this.shift--,e}readBits(e){let t=0,i;for(i=e-1;i>=0;i--)t|=this.readBit()<<i;return t}byteAlign(){this.shift=-1}next(){return this.position>=this.end?-1:this.data[this.position++]}}function xu(n,e,t){let i=0;for(let s=0,r=e.length;s<r;s++){const a=t[e[s]];if(a){if(n===i)return a;i++}}throw new Di("can't find custom Huffman table")}function SH(n,e,t,i,s){const r=[];for(let d=0;d<=34;d++){const f=s.readBits(4);r.push(new Ah([d,f,0,0]))}const a=new E3(r,!1);r.length=0;for(let d=0;d<i;){const f=a.decode(s);if(f>=32){let g,m,x;switch(f){case 32:if(d===0)throw new Di("no previous value in symbol ID table");m=s.readBits(2)+3,g=r[d-1].prefixLength;break;case 33:m=s.readBits(3)+3,g=0;break;case 34:m=s.readBits(7)+11,g=0;break;default:throw new Di("invalid code length in symbol ID table")}for(x=0;x<m;x++)r.push(new Ah([d,g,0,0])),d++}else r.push(new Ah([d,f,0,0])),d++}s.byteAlign();const o=new E3(r,!1);let l=0,c,h,u;switch(n.huffmanFS){case 0:case 1:c=Sh(n.huffmanFS+6);break;case 3:c=xu(l,e,t),l++;break;default:throw new Di("invalid Huffman FS selector")}switch(n.huffmanDS){case 0:case 1:case 2:h=Sh(n.huffmanDS+8);break;case 3:h=xu(l,e,t),l++;break;default:throw new Di("invalid Huffman DS selector")}switch(n.huffmanDT){case 0:case 1:case 2:u=Sh(n.huffmanDT+11);break;case 3:u=xu(l,e,t),l++;break;default:throw new Di("invalid Huffman DT selector")}if(n.refinement)throw new Di("refinement with Huffman is not supported");return{symbolIDTable:o,tableFirstS:c,tableDeltaS:h,tableDeltaT:u}}function IH(n,e,t){let i=0,s,r;switch(n.huffmanDHSelector){case 0:case 1:s=Sh(n.huffmanDHSelector+4);break;case 3:s=xu(i,e,t),i++;break;default:throw new Di("invalid Huffman DH selector")}switch(n.huffmanDWSelector){case 0:case 1:r=Sh(n.huffmanDWSelector+2);break;case 3:r=xu(i,e,t),i++;break;default:throw new Di("invalid Huffman DW selector")}let a,o;return n.bitmapSizeSelector?(a=xu(i,e,t),i++):a=Sh(1),n.aggregationInstancesSelector?o=xu(i,e,t):o=Sh(1),{tableDeltaHeight:s,tableDeltaWidth:r,tableBitmapSize:a,tableAggregateInstances:o}}function EH(n,e,t){const i=[];for(let s=0;s<t;s++){const r=new Uint8Array(e);i.push(r);for(let a=0;a<e;a++)r[a]=n.readBit();n.byteAlign()}return i}function b4(n,e,t,i){const s={K:-1,Columns:e,Rows:t,BlackIs1:!0,EndOfBlock:i},r=new yR(n,s),a=[];let o,l=!1;for(let c=0;c<t;c++){const h=new Uint8Array(e);a.push(h);let u=-1;for(let d=0;d<e;d++)u<0&&(o=r.readNextChar(),o===-1&&(o=0,l=!0),u=7),h[d]=o>>u&1,u--}if(i&&!l)for(let h=0;h<5&&r.readNextChar()!==-1;h++);return a}class TH{parseChunks(e){return kH(e)}parse(e){throw new Error("Not implemented: Jbig2Image.parse")}}class RH extends Jr{constructor(e,t,i){super(t),this.stream=e,this.dict=e.dict,this.maybeLength=t,this.params=i}get bytes(){return Ze(this,"bytes",this.stream.getBytes(this.maybeLength))}ensureBuffer(e){}readBlock(){this.decodeImage()}decodeImage(e){if(this.eof)return this.buffer;e||(e=this.bytes);const t=new TH,i=[];if(this.params instanceof fe){const a=this.params.get("JBIG2Globals");if(a instanceof hn){const o=a.getBytes();i.push({data:o,start:0,end:o.length})}}i.push({data:e,start:0,end:e.length});const s=t.parseChunks(i),r=s.length;for(let a=0;a<r;a++)s[a]^=255;return this.buffer=s,this.bufferLength=r,this.eof=!0,this.buffer}get canAsyncDecodeImageFromBuffer(){return this.stream.isAsync}}class MH extends Jr{constructor(e,t,i){super(t),this.stream=e,this.dict=e.dict,this.maybeLength=t,this.params=i}get bytes(){return Ze(this,"bytes",this.stream.getBytes(this.maybeLength))}ensureBuffer(e){}readBlock(e){kn("JpxStream.readBlock")}get isAsyncDecoder(){return!0}async decodeImage(e,t){return this.eof?this.buffer:(e||(e=this.bytes),this.buffer=await Go.decode(e,t),this.bufferLength=this.buffer.length,this.eof=!0,this.buffer)}get canAsyncDecodeImageFromBuffer(){return this.stream.isAsync}}class sk extends Jr{constructor(e,t,i){super(t),this.str=e,this.dict=e.dict,this.cachedData=0,this.bitsCached=0;const s=4096,r={earlyChange:i,codeLength:9,nextCode:258,dictionaryValues:new Uint8Array(s),dictionaryLengths:new Uint16Array(s),dictionaryPrevCodes:new Uint16Array(s),currentSequence:new Uint8Array(s),currentSequenceLength:0};for(let a=0;a<256;++a)r.dictionaryValues[a]=a,r.dictionaryLengths[a]=1;this.lzwState=r}readBits(e){let t=this.bitsCached,i=this.cachedData;for(;t<e;){const s=this.str.getByte();if(s===-1)return this.eof=!0,null;i=i<<8|s,t+=8}return this.bitsCached=t-=e,this.cachedData=i,this.lastCode=null,i>>>t&(1<<e)-1}readBlock(){let i=1024,s,r,a;const o=this.lzwState;if(!o)return;const l=o.earlyChange;let c=o.nextCode;const h=o.dictionaryValues,u=o.dictionaryLengths,d=o.dictionaryPrevCodes;let f=o.codeLength,g=o.prevCode;const m=o.currentSequence;let x=o.currentSequenceLength,p=0,y=this.bufferLength,w=this.ensureBuffer(this.bufferLength+i);for(s=0;s<512;s++){const v=this.readBits(f),_=x>0;if(v<256)m[0]=v,x=1;else if(v>=258)if(v<c)for(x=u[v],r=x-1,a=v;r>=0;r--)m[r]=h[a],a=d[a];else m[x++]=m[0];else if(v===256){f=9,c=258,x=0;continue}else{this.eof=!0,delete this.lzwState;break}if(_&&(d[c]=g,u[c]=u[g]+1,h[c]=m[0],c++,f=c+l&c+l-1?f:Math.min(Math.log(c+l)/.6931471805599453+1,12)|0),g=v,p+=x,i<p){do i+=512;while(i<p);w=this.ensureBuffer(this.bufferLength+i)}for(r=0;r<x;r++)w[y++]=m[r]}o.nextCode=c,o.codeLength=f,o.prevCode=g,o.currentSequenceLength=x,this.bufferLength=y}}class rk extends Jr{constructor(e,t,i){if(super(t),!(i instanceof fe))return e;const s=this.predictor=i.get("Predictor")||1;if(s<=1)return e;if(s!==2&&(s<10||s>15))throw new Ee(`Unsupported predictor: ${s}`);this.readBlock=s===2?this.readBlockTiff:this.readBlockPng,this.str=e,this.dict=e.dict;const r=this.colors=i.get("Colors")||1,a=this.bits=i.get("BPC","BitsPerComponent")||8,o=this.columns=i.get("Columns")||1;return this.pixBytes=r*a+7>>3,this.rowBytes=o*r*a+7>>3,this}readBlockTiff(){const e=this.rowBytes,t=this.bufferLength,i=this.ensureBuffer(t+e),s=this.bits,r=this.colors,a=this.str.getBytes(e);if(this.eof=!a.length,this.eof)return;let o=0,l=0,c=0,h=0,u=t,d;if(s===1&&r===1)for(d=0;d<e;++d){let f=a[d]^o;f^=f>>1,f^=f>>2,f^=f>>4,o=(f&1)<<7,i[u++]=f}else if(s===8){for(d=0;d<r;++d)i[u++]=a[d];for(;d<e;++d)i[u]=i[u-r]+a[d],u++}else if(s===16){const f=r*2;for(d=0;d<f;++d)i[u++]=a[d];for(;d<e;d+=2){const g=((a[d]&255)<<8)+(a[d+1]&255)+((i[u-f]&255)<<8)+(i[u-f+1]&255);i[u++]=g>>8&255,i[u++]=g&255}}else{const f=new Uint8Array(r+1),g=(1<<s)-1;let m=0,x=t;const p=this.columns;for(d=0;d<p;++d)for(let y=0;y<r;++y)c<s&&(o=o<<8|a[m++]&255,c+=8),f[y]=f[y]+(o>>c-s)&g,c-=s,l=l<<s|f[y],h+=s,h>=8&&(i[x++]=l>>h-8&255,h-=8);h>0&&(i[x++]=(l<<8-h)+(o&(1<<8-h)-1))}this.bufferLength+=e}readBlockPng(){const e=this.rowBytes,t=this.pixBytes,i=this.str.getByte(),s=this.str.getBytes(e);if(this.eof=!s.length,this.eof)return;const r=this.bufferLength,a=this.ensureBuffer(r+e);let o=a.subarray(r-e,r);o.length===0&&(o=new Uint8Array(e));let l,c=r,h,u;switch(i){case 0:for(l=0;l<e;++l)a[c++]=s[l];break;case 1:for(l=0;l<t;++l)a[c++]=s[l];for(;l<e;++l)a[c]=a[c-t]+s[l]&255,c++;break;case 2:for(l=0;l<e;++l)a[c++]=o[l]+s[l]&255;break;case 3:for(l=0;l<t;++l)a[c++]=(o[l]>>1)+s[l];for(;l<e;++l)a[c]=(o[l]+a[c-t]>>1)+s[l]&255,c++;break;case 4:for(l=0;l<t;++l)h=o[l],u=s[l],a[c++]=h+u;for(;l<e;++l){h=o[l];const d=o[l-t],f=a[c-t],g=f+h-d;let m=g-f;m<0&&(m=-m);let x=g-h;x<0&&(x=-x);let p=g-d;p<0&&(p=-p),u=s[l],m<=x&&m<=p?a[c++]=f+u:x<=p?a[c++]=h+u:a[c++]=d+u}break;default:throw new Ee(`Unsupported predictor: ${i}`)}this.bufferLength+=e}}class PH extends Jr{constructor(e,t){super(t),this.str=e,this.dict=e.dict}readBlock(){const e=this.str.getBytes(2);if(!e||e.length<2||e[0]===128){this.eof=!0;return}let t,i=this.bufferLength,s=e[0];if(s<128){if(t=this.ensureBuffer(i+s+1),t[i++]=e[1],s>0){const r=this.str.getBytes(s);t.set(r,i),i+=s}}else s=257-s,t=this.ensureBuffer(i+s+1),t.fill(e[1],i,i+s),i+=s;this.bufferLength=i}}const NH=1e3;function OH(n){const e=[],t=n.length;let i=0;for(;i<t-1;)e.push(n[i++]<<8|n[i++]);return i<t&&e.push(n[i]),t+"_"+String.fromCharCode.apply(null,e)}var L5,kR;class A0{constructor({lexer:e,xref:t,allowStreams:i=!1,recoveryMode:s=!1}){B(this,L5);this.lexer=e,this.xref=t,this.allowStreams=i,this.recoveryMode=s,this.imageCache=Object.create(null),this._imageId=0,this.refill()}refill(){this.buf1=this.lexer.getObj(),this.buf2=this.lexer.getObj()}shift(){this.buf2 instanceof is&&this.buf2.cmd==="ID"?(this.buf1=this.buf2,this.buf2=null):(this.buf1=this.buf2,this.buf2=this.lexer.getObj())}tryShift(){try{return this.shift(),!0}catch(e){if(e instanceof bi)throw e;return!1}}getObj(e=null){const t=this.buf1;if(this.shift(),t instanceof is)switch(t.cmd){case"BI":return this.makeInlineImage(e);case"[":const i=[];for(;!Cs(this.buf1,"]")&&this.buf1!==Ls;)i.push(this.getObj(e));if(this.buf1===Ls){if(this.recoveryMode)return i;throw new C7("End of file inside array.")}return this.shift(),i;case"<<":const s=new fe(this.xref);for(;!Cs(this.buf1,">>")&&this.buf1!==Ls;){if(!(this.buf1 instanceof _e)){gn("Malformed dictionary: key must be a name object"),this.shift();continue}const r=this.buf1.name;if(this.shift(),this.buf1===Ls)break;s.set(r,this.getObj(e))}if(this.buf1===Ls){if(this.recoveryMode)return s;throw new C7("End of file inside dictionary.")}return Cs(this.buf2,"stream")?this.allowStreams?this.makeStream(s,e):s:(this.shift(),s);default:return t}if(Number.isInteger(t)){if(Number.isInteger(this.buf1)&&Cs(this.buf2,"R")){const i=st.get(t,this.buf1);return this.shift(),this.shift(),i}return t}return typeof t=="string"&&e?e.decryptString(t):t}findDefaultInlineStreamEnd(e){const{knownCommands:l}=this.lexer,c=e.pos,h=15;let u=0,d,f;for(;(d=e.getByte())!==-1;)if(u===0)u=d===69?1:0;else if(u===1)u=d===73?2:0;else if(d===32||d===10||d===13){f=e.pos;const m=e.peekBytes(h),x=m.length;if(x===0)break;for(let w=0;w<x;w++)if(d=m[w],!(d===0&&m[w+1]!==0)&&d!==10&&d!==13&&(d<32||d>127)){u=0;break}if(u!==2)continue;if(!l){he("findDefaultInlineStreamEnd - `lexer.knownCommands` is undefined.");continue}const p=new Wo(new Ui(e.peekBytes(5*h)),l);p._hexStringWarn=()=>{};let y=0;for(;;){const w=p.getObj();if(w===Ls){u=0;break}if(w instanceof is){const v=l[w.cmd];if(v){if(v.variableArgs?y<=v.numArgs:y===v.numArgs)break}else{u=0;break}y=0;continue}y++}if(u===2)break}else u=0;d===-1&&(he("findDefaultInlineStreamEnd: Reached the end of the stream without finding a valid EI marker"),f&&(he('... trying to recover by using the last "EI" occurrence.'),e.skip(-(e.pos-f))));let g=4;return e.skip(-g),d=e.peekByte(),e.skip(g),Va(d)||g--,e.pos-g-c}findDCTDecodeInlineStreamEnd(e){const t=e.pos;let i=!1,s,r;for(;(s=e.getByte())!==-1;)if(s===255){switch(e.getByte()){case 0:break;case 255:e.skip(-1);break;case 217:i=!0;break;case 192:case 193:case 194:case 195:case 197:case 198:case 199:case 201:case 202:case 203:case 205:case 206:case 207:case 196:case 204:case 218:case 219:case 220:case 221:case 222:case 223:case 224:case 225:case 226:case 227:case 228:case 229:case 230:case 231:case 232:case 233:case 234:case 235:case 236:case 237:case 238:case 239:case 254:r=e.getUint16(),r>2?e.skip(r-2):e.skip(-2);break}if(i)break}const a=e.pos-t;return s===-1?(he("Inline DCTDecode image stream: EOI marker not found, searching for /EI/ instead."),e.skip(-a),this.findDefaultInlineStreamEnd(e)):(this.inlineStreamSkipEI(e),a)}findASCII85DecodeInlineStreamEnd(e){const s=e.pos;let r;for(;(r=e.getByte())!==-1;)if(r===126){const o=e.pos;for(r=e.peekByte();Va(r);)e.skip(),r=e.peekByte();if(r===62){e.skip();break}if(e.pos>o){const l=e.peekBytes(2);if(l[0]===69&&l[1]===73)break}}const a=e.pos-s;return r===-1?(he("Inline ASCII85Decode image stream: EOD marker not found, searching for /EI/ instead."),e.skip(-a),this.findDefaultInlineStreamEnd(e)):(this.inlineStreamSkipEI(e),a)}findASCIIHexDecodeInlineStreamEnd(e){const i=e.pos;let s;for(;(s=e.getByte())!==-1&&s!==62;);const r=e.pos-i;return s===-1?(he("Inline ASCIIHexDecode image stream: EOD marker not found, searching for /EI/ instead."),e.skip(-r),this.findDefaultInlineStreamEnd(e)):(this.inlineStreamSkipEI(e),r)}inlineStreamSkipEI(e){let s=0,r;for(;(r=e.getByte())!==-1;)if(s===0)s=r===69?1:0;else if(s===1)s=r===73?2:0;else if(s===2)break}makeInlineImage(e){const t=this.lexer,i=t.stream,s=Object.create(null);let r;for(;!Cs(this.buf1,"ID")&&this.buf1!==Ls;){if(!(this.buf1 instanceof _e))throw new Ee("Dictionary key must be a name object");const f=this.buf1.name;if(this.shift(),this.buf1===Ls)break;s[f]=this.getObj(e)}t.beginInlineImagePos!==-1&&(r=i.pos-t.beginInlineImagePos);const a=this.xref.fetchIfRef(s.F||s.Filter);let o;if(a instanceof _e)o=a.name;else if(Array.isArray(a)){const f=this.xref.fetchIfRef(a[0]);f instanceof _e&&(o=f.name)}const l=i.pos;let c;switch(o){case"DCT":case"DCTDecode":c=this.findDCTDecodeInlineStreamEnd(i);break;case"A85":case"ASCII85Decode":c=this.findASCII85DecodeInlineStreamEnd(i);break;case"AHx":case"ASCIIHexDecode":c=this.findASCIIHexDecodeInlineStreamEnd(i);break;default:c=this.findDefaultInlineStreamEnd(i)}let h;if(c<NH&&r>0){const f=i.pos;i.pos=t.beginInlineImagePos,h=OH(i.getBytes(r+c)),i.pos=f;const g=this.imageCache[h];if(g!==void 0)return this.buf2=is.get("EI"),this.shift(),g.reset(),g}const u=new fe(this.xref);for(const f in s)u.set(f,s[f]);let d=i.makeSubStream(l,c,u);return e&&(d=e.createStream(d,c)),d=this.filter(d,u,c),d.dict=u,h!==void 0&&(d.cacheKey=`inline_img_${++this._imageId}`,this.imageCache[h]=d),this.buf2=is.get("EI"),this.shift(),d}makeStream(e,t){const i=this.lexer;let s=i.stream;i.skipToNextLine();const r=s.pos-1;let a=e.get("Length");if(Number.isInteger(a)||(gn(`Bad length "${a&&a.toString()}" in stream.`),a=0),s.pos=r+a,i.nextChar(),this.tryShift()&&Cs(this.buf2,"endstream"))this.shift();else{if(a=L(this,L5,kR).call(this,r),a<0)throw new Ee("Missing endstream command.");i.nextChar(),this.shift(),this.shift()}return this.shift(),s=s.makeSubStream(r,a,e),t&&(s=t.createStream(s,a)),s=this.filter(s,e,a),s.dict=e,s}filter(e,t,i){let s=t.get("F","Filter"),r=t.get("DP","DecodeParms");if(s instanceof _e)return Array.isArray(r)&&he("/DecodeParms should not be an Array, when /Filter is a Name."),this.makeFilter(e,s.name,i,r);let a=i;if(Array.isArray(s)){const o=s,l=r;for(let c=0,h=o.length;c<h;++c){if(s=this.xref.fetchIfRef(o[c]),!(s instanceof _e))throw new Ee(`Bad filter name "${s}"`);r=null,Array.isArray(l)&&c in l&&(r=this.xref.fetchIfRef(l[c])),e=this.makeFilter(e,s.name,a,r),a=null}}return e}makeFilter(e,t,i,s){if(i===0)return he(`Empty "${t}" stream.`),new N7;try{switch(t){case"Fl":case"FlateDecode":return s?new rk(new ek(e,i),i,s):new ek(e,i);case"LZW":case"LZWDecode":let r=1;return s?(s.has("EarlyChange")&&(r=s.get("EarlyChange")),new rk(new sk(e,i,r),i,s)):new sk(e,i,r);case"DCT":case"DCTDecode":return new Cg(e,i,s);case"JPX":case"JPXDecode":return new MH(e,i,s);case"A85":case"ASCII85Decode":return new iH(e,i);case"AHx":case"ASCIIHexDecode":return new sH(e,i);case"CCF":case"CCITTFaxDecode":return new rH(e,i,s);case"RL":case"RunLengthDecode":return new PH(e,i);case"JBIG2Decode":return new RH(e,i,s)}return he(`Filter "${t}" is not supported.`),e}catch(r){if(r instanceof bi)throw r;return he(`Invalid stream: "${r}"`),new N7}}}L5=new WeakSet,kR=function(e){const{stream:t}=this.lexer;t.pos=e;const i=2048,s=9,r=new Uint8Array([101,110,100]),a=r.length,o=[new Uint8Array([115,116,114,101,97,109]),new Uint8Array([115,116,101,97,109]),new Uint8Array([115,116,114,101,97])],l=s-a;for(;t.pos<t.end;){const c=t.peekBytes(i),h=c.length-s;if(h<=0)break;let u=0;for(;u<h;){let d=0;for(;d<a&&c[u+d]===r[d];)d++;if(d>=a){let f=!1;for(const g of o){const m=g.length;let x=0;for(;x<m&&c[u+d+x]===g[x];)x++;if(x>=l){f=!0;break}if(x>=m){const p=c[u+d+x];Va(p)&&(gn(`Found "${ua([...r,...g])}" when searching for endstream command.`),f=!0);break}}if(f)return t.pos+=u,t.pos-e}u++}t.pos+=h}return-1};const ff=[1,0,0,0,0,0,0,0,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,0,0,2,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];function mw(n){return n>=48&&n<=57?n&15:n>=65&&n<=70||n>=97&&n<=102?(n&15)+9:-1}class Wo{constructor(e,t=null){this.stream=e,this.nextChar(),this.strBuf=[],this.knownCommands=t,this._hexStringNumWarn=0,this.beginInlineImagePos=-1}nextChar(){return this.currentChar=this.stream.getByte()}peekChar(){return this.stream.peekByte()}getNumber(){let e=this.currentChar,t=!1,i=0,s=1;if(e===45?(s=-1,e=this.nextChar(),e===45&&(e=this.nextChar())):e===43&&(e=this.nextChar()),e===10||e===13)do e=this.nextChar();while(e===10||e===13);if(e===46&&(i=10,e=this.nextChar()),e<48||e>57){const l=`Invalid number: ${String.fromCharCode(e)} (charCode ${e})`;if(Va(e)||e===40||e===60||e===-1)return gn(`Lexer.getNumber - "${l}".`),0;throw new Ee(l)}let r=e-48,a=0,o=1;for(;(e=this.nextChar())>=0;)if(e>=48&&e<=57){const l=e-48;t?a=a*10+l:(i!==0&&(i*=10),r=r*10+l)}else if(e===46)if(i===0)i=1;else break;else if(e===45)he("Badly formatted number: minus sign in the middle");else if(e===69||e===101){if(e=this.peekChar(),e===43||e===45)o=e===45?-1:1,this.nextChar();else if(e<48||e>57)break;t=!0}else break;return i!==0&&(r/=i),t&&(r*=10**(o*a)),s*r}getString(){let e=1,t=!1;const i=this.strBuf;i.length=0;let s=this.nextChar();for(;;){let r=!1;switch(s|0){case-1:he("Unterminated string"),t=!0;break;case 40:++e,i.push("(");break;case 41:--e===0?(this.nextChar(),t=!0):i.push(")");break;case 92:switch(s=this.nextChar(),s){case-1:he("Unterminated string"),t=!0;break;case 110:i.push(`
`);break;case 114:i.push("\r");break;case 116:i.push("	");break;case 98:i.push("\b");break;case 102:i.push("\f");break;case 92:case 40:case 41:i.push(String.fromCharCode(s));break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:let a=s&15;s=this.nextChar(),r=!0,s>=48&&s<=55&&(a=(a<<3)+(s&15),s=this.nextChar(),s>=48&&s<=55&&(r=!1,a=(a<<3)+(s&15))),i.push(String.fromCharCode(a));break;case 13:this.peekChar()===10&&this.nextChar();break;case 10:break;default:i.push(String.fromCharCode(s));break}break;default:i.push(String.fromCharCode(s));break}if(t)break;r||(s=this.nextChar())}return i.join("")}getName(){let e,t;const i=this.strBuf;for(i.length=0;(e=this.nextChar())>=0&&!ff[e];)if(e===35){if(e=this.nextChar(),ff[e]){he("Lexer_getName: NUMBER SIGN (#) should be followed by a hexadecimal number."),i.push("#");break}const s=mw(e);if(s!==-1){t=e,e=this.nextChar();const r=mw(e);if(r===-1){if(he(`Lexer_getName: Illegal digit (${String.fromCharCode(e)}) in hexadecimal number.`),i.push("#",String.fromCharCode(t)),ff[e])break;i.push(String.fromCharCode(e));continue}i.push(String.fromCharCode(s<<4|r))}else i.push("#",String.fromCharCode(e))}else i.push(String.fromCharCode(e));return i.length>127&&he(`Name token is longer than allowed by the spec: ${i.length}`),_e.get(i.join(""))}_hexStringWarn(e){if(this._hexStringNumWarn++===5){he("getHexString - ignoring additional invalid characters.");return}this._hexStringNumWarn>5||he(`getHexString - ignoring invalid character: ${e}`)}getHexString(){const e=this.strBuf;e.length=0;let t=this.currentChar,i=-1,s=-1;for(this._hexStringNumWarn=0;;)if(t<0){he("Unterminated hex string");break}else if(t===62){this.nextChar();break}else if(ff[t]===1){t=this.nextChar();continue}else s=mw(t),s===-1?this._hexStringWarn(t):i===-1?i=s:(e.push(String.fromCharCode(i<<4|s)),i=-1),t=this.nextChar();return i!==-1&&e.push(String.fromCharCode(i<<4)),e.join("")}getObj(){let e=!1,t=this.currentChar;for(;;){if(t<0)return Ls;if(e)(t===10||t===13)&&(e=!1);else if(t===37)e=!0;else if(ff[t]!==1)break;t=this.nextChar()}switch(t|0){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 43:case 45:case 46:return this.getNumber();case 40:return this.getString();case 47:return this.getName();case 91:return this.nextChar(),is.get("[");case 93:return this.nextChar(),is.get("]");case 60:return t=this.nextChar(),t===60?(this.nextChar(),is.get("<<")):this.getHexString();case 62:return t=this.nextChar(),t===62?(this.nextChar(),is.get(">>")):is.get(">");case 123:return this.nextChar(),is.get("{");case 125:return this.nextChar(),is.get("}");case 41:throw this.nextChar(),new Ee(`Illegal character: ${t}`)}let i=String.fromCharCode(t);if(t<32||t>127){const a=this.peekChar();if(a>=32&&a<=127)return this.nextChar(),is.get(i)}const s=this.knownCommands;let r=(s==null?void 0:s[i])!==void 0;for(;(t=this.nextChar())>=0&&!ff[t];){const a=i+String.fromCharCode(t);if(r&&s[a]===void 0)break;if(i.length===128)throw new Ee(`Command token too long: ${i.length}`);i=a,r=(s==null?void 0:s[i])!==void 0}return i==="true"?!0:i==="false"?!1:i==="null"?null:(i==="BI"&&(this.beginInlineImagePos=this.stream.pos),is.get(i))}skipToNextLine(){let e=this.currentChar;for(;e>=0;){if(e===13){e=this.nextChar(),e===10&&this.nextChar();break}else if(e===10){this.nextChar();break}e=this.nextChar()}}}class DH{static create(e){function t(u,d,f=!1){const g=u.get(d);if(Number.isInteger(g)&&(f?g>=0:g>0))return g;throw new Error(`The "${d}" parameter in the linearization dictionary is invalid.`)}function i(u){const d=u.get("H");let f;if(Array.isArray(d)&&((f=d.length)===2||f===4)){for(let g=0;g<f;g++){const m=d[g];if(!(Number.isInteger(m)&&m>0))throw new Error(`Hint (${g}) in the linearization dictionary is invalid.`)}return d}throw new Error("Hint array in the linearization dictionary is invalid.")}const s=new A0({lexer:new Wo(e),xref:null}),r=s.getObj(),a=s.getObj(),o=s.getObj(),l=s.getObj();let c,h;if(Number.isInteger(r)&&Number.isInteger(a)&&Cs(o,"obj")&&l instanceof fe&&typeof(c=l.get("Linearized"))=="number"&&c>0){if((h=t(l,"L"))!==e.length)throw new Error('The "L" parameter in the linearization dictionary does not equal the stream length.')}else return null;return{length:h,hints:i(l),objectNumberFirst:t(l,"O"),endFirst:t(l,"E"),numPages:t(l,"N"),mainXRefEntriesOffset:t(l,"T"),pageFirst:l.has("P")?t(l,"P",!0):0}}}const LH=["Adobe-GB1-UCS2","Adobe-CNS1-UCS2","Adobe-Japan1-UCS2","Adobe-Korea1-UCS2","78-EUC-H","78-EUC-V","78-H","78-RKSJ-H","78-RKSJ-V","78-V","78ms-RKSJ-H","78ms-RKSJ-V","83pv-RKSJ-H","90ms-RKSJ-H","90ms-RKSJ-V","90msp-RKSJ-H","90msp-RKSJ-V","90pv-RKSJ-H","90pv-RKSJ-V","Add-H","Add-RKSJ-H","Add-RKSJ-V","Add-V","Adobe-CNS1-0","Adobe-CNS1-1","Adobe-CNS1-2","Adobe-CNS1-3","Adobe-CNS1-4","Adobe-CNS1-5","Adobe-CNS1-6","Adobe-GB1-0","Adobe-GB1-1","Adobe-GB1-2","Adobe-GB1-3","Adobe-GB1-4","Adobe-GB1-5","Adobe-Japan1-0","Adobe-Japan1-1","Adobe-Japan1-2","Adobe-Japan1-3","Adobe-Japan1-4","Adobe-Japan1-5","Adobe-Japan1-6","Adobe-Korea1-0","Adobe-Korea1-1","Adobe-Korea1-2","B5-H","B5-V","B5pc-H","B5pc-V","CNS-EUC-H","CNS-EUC-V","CNS1-H","CNS1-V","CNS2-H","CNS2-V","ETHK-B5-H","ETHK-B5-V","ETen-B5-H","ETen-B5-V","ETenms-B5-H","ETenms-B5-V","EUC-H","EUC-V","Ext-H","Ext-RKSJ-H","Ext-RKSJ-V","Ext-V","GB-EUC-H","GB-EUC-V","GB-H","GB-V","GBK-EUC-H","GBK-EUC-V","GBK2K-H","GBK2K-V","GBKp-EUC-H","GBKp-EUC-V","GBT-EUC-H","GBT-EUC-V","GBT-H","GBT-V","GBTpc-EUC-H","GBTpc-EUC-V","GBpc-EUC-H","GBpc-EUC-V","H","HKdla-B5-H","HKdla-B5-V","HKdlb-B5-H","HKdlb-B5-V","HKgccs-B5-H","HKgccs-B5-V","HKm314-B5-H","HKm314-B5-V","HKm471-B5-H","HKm471-B5-V","HKscs-B5-H","HKscs-B5-V","Hankaku","Hiragana","KSC-EUC-H","KSC-EUC-V","KSC-H","KSC-Johab-H","KSC-Johab-V","KSC-V","KSCms-UHC-H","KSCms-UHC-HW-H","KSCms-UHC-HW-V","KSCms-UHC-V","KSCpc-EUC-H","KSCpc-EUC-V","Katakana","NWP-H","NWP-V","RKSJ-H","RKSJ-V","Roman","UniCNS-UCS2-H","UniCNS-UCS2-V","UniCNS-UTF16-H","UniCNS-UTF16-V","UniCNS-UTF32-H","UniCNS-UTF32-V","UniCNS-UTF8-H","UniCNS-UTF8-V","UniGB-UCS2-H","UniGB-UCS2-V","UniGB-UTF16-H","UniGB-UTF16-V","UniGB-UTF32-H","UniGB-UTF32-V","UniGB-UTF8-H","UniGB-UTF8-V","UniJIS-UCS2-H","UniJIS-UCS2-HW-H","UniJIS-UCS2-HW-V","UniJIS-UCS2-V","UniJIS-UTF16-H","UniJIS-UTF16-V","UniJIS-UTF32-H","UniJIS-UTF32-V","UniJIS-UTF8-H","UniJIS-UTF8-V","UniJIS2004-UTF16-H","UniJIS2004-UTF16-V","UniJIS2004-UTF32-H","UniJIS2004-UTF32-V","UniJIS2004-UTF8-H","UniJIS2004-UTF8-V","UniJISPro-UCS2-HW-V","UniJISPro-UCS2-V","UniJISPro-UTF8-V","UniJISX0213-UTF32-H","UniJISX0213-UTF32-V","UniJISX02132004-UTF32-H","UniJISX02132004-UTF32-V","UniKS-UCS2-H","UniKS-UCS2-V","UniKS-UTF16-H","UniKS-UTF16-V","UniKS-UTF32-H","UniKS-UTF32-V","UniKS-UTF8-H","UniKS-UTF8-V","V","WP-Symbol"],pw=2**24-1;class x4{constructor(e=!1){this.codespaceRanges=[[],[],[],[]],this.numCodespaceRanges=0,this._map=[],this.name="",this.vertical=!1,this.useCMap=null,this.builtInCMap=e}addCodespaceRange(e,t,i){this.codespaceRanges[e-1].push(t,i),this.numCodespaceRanges++}mapCidRange(e,t,i){if(t-e>pw)throw new Error("mapCidRange - ignoring data above MAX_MAP_RANGE.");for(;e<=t;)this._map[e++]=i++}mapBfRange(e,t,i){if(t-e>pw)throw new Error("mapBfRange - ignoring data above MAX_MAP_RANGE.");const s=i.length-1;for(;e<=t;){this._map[e++]=i;const r=i.charCodeAt(s)+1;if(r>255){i=i.substring(0,s-1)+String.fromCharCode(i.charCodeAt(s-1)+1)+"\0";continue}i=i.substring(0,s)+String.fromCharCode(r)}}mapBfRangeToArray(e,t,i){if(t-e>pw)throw new Error("mapBfRangeToArray - ignoring data above MAX_MAP_RANGE.");const s=i.length;let r=0;for(;e<=t&&r<s;)this._map[e]=i[r++],++e}mapOne(e,t){this._map[e]=t}lookup(e){return this._map[e]}contains(e){return this._map[e]!==void 0}forEach(e){const t=this._map,i=t.length;if(i<=65536)for(let s=0;s<i;s++)t[s]!==void 0&&e(s,t[s]);else for(const s in t)e(s,t[s])}charCodeOf(e){const t=this._map;if(t.length<=65536)return t.indexOf(e);for(const i in t)if(t[i]===e)return i|0;return-1}getMap(){return this._map}readCharCode(e,t,i){let s=0;const r=this.codespaceRanges;for(let a=0,o=r.length;a<o;a++){s=(s<<8|e.charCodeAt(t+a))>>>0;const l=r[a];for(let c=0,h=l.length;c<h;){const u=l[c++],d=l[c++];if(s>=u&&s<=d){i.charcode=s,i.length=a+1;return}}}i.charcode=0,i.length=1}getCharCodeLength(e){const t=this.codespaceRanges;for(let i=0,s=t.length;i<s;i++){const r=t[i];for(let a=0,o=r.length;a<o;){const l=r[a++],c=r[a++];if(e>=l&&e<=c)return i+1}}return 1}get length(){return this._map.length}get isIdentityCMap(){if(!(this.name==="Identity-H"||this.name==="Identity-V")||this._map.length!==65536)return!1;for(let e=0;e<65536;e++)if(this._map[e]!==e)return!1;return!0}}class $f extends x4{constructor(e,t){super(),this.vertical=e,this.addCodespaceRange(t,0,65535)}mapCidRange(e,t,i){kn("should not call mapCidRange")}mapBfRange(e,t,i){kn("should not call mapBfRange")}mapBfRangeToArray(e,t,i){kn("should not call mapBfRangeToArray")}mapOne(e,t){kn("should not call mapCidOne")}lookup(e){return Number.isInteger(e)&&e<=65535?e:void 0}contains(e){return Number.isInteger(e)&&e<=65535}forEach(e){for(let t=0;t<=65535;t++)e(t,t)}charCodeOf(e){return Number.isInteger(e)&&e<=65535?e:-1}getMap(){const e=new Array(65536);for(let t=0;t<=65535;t++)e[t]=t;return e}get length(){return 65536}get isIdentityCMap(){kn("should not access .isIdentityCMap")}}function Lh(n){let e=0;for(let t=0;t<n.length;t++)e=e<<8|n.charCodeAt(t);return e>>>0}function Kd(n){if(typeof n!="string")throw new Ee("Malformed CMap: expected string.")}function CR(n){if(!Number.isInteger(n))throw new Ee("Malformed CMap: expected int.")}function FH(n,e){for(;;){let t=e.getObj();if(t===Ls)break;if(Cs(t,"endbfchar"))return;Kd(t);const i=Lh(t);t=e.getObj(),Kd(t);const s=t;n.mapOne(i,s)}}function BH(n,e){for(;;){let t=e.getObj();if(t===Ls)break;if(Cs(t,"endbfrange"))return;Kd(t);const i=Lh(t);t=e.getObj(),Kd(t);const s=Lh(t);if(t=e.getObj(),Number.isInteger(t)||typeof t=="string"){const r=Number.isInteger(t)?String.fromCharCode(t):t;n.mapBfRange(i,s,r)}else if(Cs(t,"[")){t=e.getObj();const r=[];for(;!Cs(t,"]")&&t!==Ls;)r.push(t),t=e.getObj();n.mapBfRangeToArray(i,s,r)}else break}throw new Ee("Invalid bf range.")}function UH(n,e){for(;;){let t=e.getObj();if(t===Ls)break;if(Cs(t,"endcidchar"))return;Kd(t);const i=Lh(t);t=e.getObj(),CR(t);const s=t;n.mapOne(i,s)}}function HH(n,e){for(;;){let t=e.getObj();if(t===Ls)break;if(Cs(t,"endcidrange"))return;Kd(t);const i=Lh(t);t=e.getObj(),Kd(t);const s=Lh(t);t=e.getObj(),CR(t);const r=t;n.mapCidRange(i,s,r)}}function zH(n,e){for(;;){let t=e.getObj();if(t===Ls)break;if(Cs(t,"endcodespacerange"))return;if(typeof t!="string")break;const i=Lh(t);if(t=e.getObj(),typeof t!="string")break;const s=Lh(t);n.addCodespaceRange(t.length,i,s)}throw new Ee("Invalid codespace range.")}function jH(n,e){const t=e.getObj();Number.isInteger(t)&&(n.vertical=!!t)}function GH(n,e){const t=e.getObj();t instanceof _e&&(n.name=t.name)}async function AR(n,e,t,i){let s,r;e:for(;;)try{const a=e.getObj();if(a===Ls)break;if(a instanceof _e)a.name==="WMode"?jH(n,e):a.name==="CMapName"&&GH(n,e),s=a;else if(a instanceof is)switch(a.cmd){case"endcmap":break e;case"usecmap":s instanceof _e&&(r=s.name);break;case"begincodespacerange":zH(n,e);break;case"beginbfchar":FH(n,e);break;case"begincidchar":UH(n,e);break;case"beginbfrange":BH(n,e);break;case"begincidrange":HH(n,e);break}}catch(a){if(a instanceof bi)throw a;he("Invalid cMap data: "+a);continue}return!i&&r&&(i=r),i?SR(n,t,i):n}async function SR(n,e,t){if(n.useCMap=await j7(t,e),n.numCodespaceRanges===0){const i=n.useCMap.codespaceRanges;for(let s=0;s<i.length;s++)n.codespaceRanges[s]=i[s].slice();n.numCodespaceRanges=n.useCMap.numCodespaceRanges}return n.useCMap.forEach(function(i,s){n.contains(i)||n.mapOne(i,s)}),n}async function j7(n,e){if(n==="Identity-H")return new $f(!1,2);if(n==="Identity-V")return new $f(!0,2);if(!LH.includes(n))throw new Error("Unknown CMap name: "+n);if(!e)throw new Error("Built-in CMap parameters are not provided.");const{cMapData:t,isCompressed:i}=await e(n),s=new x4(!0);if(i)return new nH().process(t,s,a=>SR(s,e,a));const r=new Wo(new Ui(t));return AR(s,r,e,null)}class qx{static async create({encoding:e,fetchBuiltInCMap:t,useCMap:i}){if(e instanceof _e)return j7(e.name,t);if(e instanceof hn){const s=await AR(new x4,new Wo(e),t,i);return s.isIdentityCMap?j7(s.name,t):s}throw new Error("Encoding required.")}}const IR=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],VH=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","centoldstyle","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","","threequartersemdash","","questionsmall","","","","","Ethsmall","","","onequarter","onehalf","threequarters","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","","","","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hypheninferior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","asuperior","centsuperior","","","","","Aacutesmall","Agravesmall","Acircumflexsmall","Adieresissmall","Atildesmall","Aringsmall","Ccedillasmall","Eacutesmall","Egravesmall","Ecircumflexsmall","Edieresissmall","Iacutesmall","Igravesmall","Icircumflexsmall","Idieresissmall","Ntildesmall","Oacutesmall","Ogravesmall","Ocircumflexsmall","Odieresissmall","Otildesmall","Uacutesmall","Ugravesmall","Ucircumflexsmall","Udieresissmall","","eightsuperior","fourinferior","threeinferior","sixinferior","eightinferior","seveninferior","Scaronsmall","","centinferior","twoinferior","","Dieresissmall","","Caronsmall","osuperior","fiveinferior","","commainferior","periodinferior","Yacutesmall","","dollarinferior","","","Thornsmall","","nineinferior","zeroinferior","Zcaronsmall","AEsmall","Oslashsmall","questiondownsmall","oneinferior","Lslashsmall","","","","","","","Cedillasmall","","","","","","OEsmall","figuredash","hyphensuperior","","","","","exclamdownsmall","","Ydieresissmall","","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","ninesuperior","zerosuperior","","esuperior","rsuperior","tsuperior","","","isuperior","ssuperior","dsuperior","","","","","","lsuperior","Ogoneksmall","Brevesmall","Macronsmall","bsuperior","nsuperior","msuperior","commasuperior","periodsuperior","Dotaccentsmall","Ringsmall","","","",""],y4=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","space","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron"],s0=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls","","","",""],Hp=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","bullet","Euro","bullet","quotesinglbase","florin","quotedblbase","ellipsis","dagger","daggerdbl","circumflex","perthousand","Scaron","guilsinglleft","OE","bullet","Zcaron","bullet","bullet","quoteleft","quoteright","quotedblleft","quotedblright","bullet","endash","emdash","tilde","trademark","scaron","guilsinglright","oe","bullet","zcaron","Ydieresis","space","exclamdown","cent","sterling","currency","yen","brokenbar","section","dieresis","copyright","ordfeminine","guillemotleft","logicalnot","hyphen","registered","macron","degree","plusminus","twosuperior","threesuperior","acute","mu","paragraph","periodcentered","cedilla","onesuperior","ordmasculine","guillemotright","onequarter","onehalf","threequarters","questiondown","Agrave","Aacute","Acircumflex","Atilde","Adieresis","Aring","AE","Ccedilla","Egrave","Eacute","Ecircumflex","Edieresis","Igrave","Iacute","Icircumflex","Idieresis","Eth","Ntilde","Ograve","Oacute","Ocircumflex","Otilde","Odieresis","multiply","Oslash","Ugrave","Uacute","Ucircumflex","Udieresis","Yacute","Thorn","germandbls","agrave","aacute","acircumflex","atilde","adieresis","aring","ae","ccedilla","egrave","eacute","ecircumflex","edieresis","igrave","iacute","icircumflex","idieresis","eth","ntilde","ograve","oacute","ocircumflex","otilde","odieresis","divide","oslash","ugrave","uacute","ucircumflex","udieresis","yacute","thorn","ydieresis"],w4=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","universal","numbersign","existential","percent","ampersand","suchthat","parenleft","parenright","asteriskmath","plus","comma","minus","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","congruent","Alpha","Beta","Chi","Delta","Epsilon","Phi","Gamma","Eta","Iota","theta1","Kappa","Lambda","Mu","Nu","Omicron","Pi","Theta","Rho","Sigma","Tau","Upsilon","sigma1","Omega","Xi","Psi","Zeta","bracketleft","therefore","bracketright","perpendicular","underscore","radicalex","alpha","beta","chi","delta","epsilon","phi","gamma","eta","iota","phi1","kappa","lambda","mu","nu","omicron","pi","theta","rho","sigma","tau","upsilon","omega1","omega","xi","psi","zeta","braceleft","bar","braceright","similar","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","Euro","Upsilon1","minute","lessequal","fraction","infinity","florin","club","diamond","heart","spade","arrowboth","arrowleft","arrowup","arrowright","arrowdown","degree","plusminus","second","greaterequal","multiply","proportional","partialdiff","bullet","divide","notequal","equivalence","approxequal","ellipsis","arrowvertex","arrowhorizex","carriagereturn","aleph","Ifraktur","Rfraktur","weierstrass","circlemultiply","circleplus","emptyset","intersection","union","propersuperset","reflexsuperset","notsubset","propersubset","reflexsubset","element","notelement","angle","gradient","registerserif","copyrightserif","trademarkserif","product","radical","dotmath","logicalnot","logicaland","logicalor","arrowdblboth","arrowdblleft","arrowdblup","arrowdblright","arrowdbldown","lozenge","angleleft","registersans","copyrightsans","trademarksans","summation","parenlefttp","parenleftex","parenleftbt","bracketlefttp","bracketleftex","bracketleftbt","bracelefttp","braceleftmid","braceleftbt","braceex","","angleright","integral","integraltp","integralex","integralbt","parenrighttp","parenrightex","parenrightbt","bracketrighttp","bracketrightex","bracketrightbt","bracerighttp","bracerightmid","bracerightbt",""],v4=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","a1","a2","a202","a3","a4","a5","a119","a118","a117","a11","a12","a13","a14","a15","a16","a105","a17","a18","a19","a20","a21","a22","a23","a24","a25","a26","a27","a28","a6","a7","a8","a9","a10","a29","a30","a31","a32","a33","a34","a35","a36","a37","a38","a39","a40","a41","a42","a43","a44","a45","a46","a47","a48","a49","a50","a51","a52","a53","a54","a55","a56","a57","a58","a59","a60","a61","a62","a63","a64","a65","a66","a67","a68","a69","a70","a71","a72","a73","a74","a203","a75","a204","a76","a77","a78","a79","a81","a82","a83","a84","a97","a98","a99","a100","","a89","a90","a93","a94","a91","a92","a205","a85","a206","a86","a87","a88","a95","a96","","","","","","","","","","","","","","","","","","","","a101","a102","a103","a104","a106","a107","a108","a112","a111","a110","a109","a120","a121","a122","a123","a124","a125","a126","a127","a128","a129","a130","a131","a132","a133","a134","a135","a136","a137","a138","a139","a140","a141","a142","a143","a144","a145","a146","a147","a148","a149","a150","a151","a152","a153","a154","a155","a156","a157","a158","a159","a160","a161","a163","a164","a196","a165","a192","a166","a167","a168","a169","a170","a171","a172","a173","a162","a174","a175","a176","a177","a178","a179","a193","a180","a199","a181","a200","a182","","a201","a183","a184","a197","a185","a194","a198","a186","a195","a187","a188","a189","a190","a191",""];function zp(n){switch(n){case"WinAnsiEncoding":return Hp;case"StandardEncoding":return s0;case"MacRomanEncoding":return y4;case"SymbolSetEncoding":return w4;case"ZapfDingbatsEncoding":return v4;case"ExpertEncoding":return IR;case"MacExpertEncoding":return VH;default:return null}}const Wl=Ai(function(n){n.A=65,n.AE=198,n.AEacute=508,n.AEmacron=482,n.AEsmall=63462,n.Aacute=193,n.Aacutesmall=63457,n.Abreve=258,n.Abreveacute=7854,n.Abrevecyrillic=1232,n.Abrevedotbelow=7862,n.Abrevegrave=7856,n.Abrevehookabove=7858,n.Abrevetilde=7860,n.Acaron=461,n.Acircle=9398,n.Acircumflex=194,n.Acircumflexacute=7844,n.Acircumflexdotbelow=7852,n.Acircumflexgrave=7846,n.Acircumflexhookabove=7848,n.Acircumflexsmall=63458,n.Acircumflextilde=7850,n.Acute=63177,n.Acutesmall=63412,n.Acyrillic=1040,n.Adblgrave=512,n.Adieresis=196,n.Adieresiscyrillic=1234,n.Adieresismacron=478,n.Adieresissmall=63460,n.Adotbelow=7840,n.Adotmacron=480,n.Agrave=192,n.Agravesmall=63456,n.Ahookabove=7842,n.Aiecyrillic=1236,n.Ainvertedbreve=514,n.Alpha=913,n.Alphatonos=902,n.Amacron=256,n.Amonospace=65313,n.Aogonek=260,n.Aring=197,n.Aringacute=506,n.Aringbelow=7680,n.Aringsmall=63461,n.Asmall=63329,n.Atilde=195,n.Atildesmall=63459,n.Aybarmenian=1329,n.B=66,n.Bcircle=9399,n.Bdotaccent=7682,n.Bdotbelow=7684,n.Becyrillic=1041,n.Benarmenian=1330,n.Beta=914,n.Bhook=385,n.Blinebelow=7686,n.Bmonospace=65314,n.Brevesmall=63220,n.Bsmall=63330,n.Btopbar=386,n.C=67,n.Caarmenian=1342,n.Cacute=262,n.Caron=63178,n.Caronsmall=63221,n.Ccaron=268,n.Ccedilla=199,n.Ccedillaacute=7688,n.Ccedillasmall=63463,n.Ccircle=9400,n.Ccircumflex=264,n.Cdot=266,n.Cdotaccent=266,n.Cedillasmall=63416,n.Chaarmenian=1353,n.Cheabkhasiancyrillic=1212,n.Checyrillic=1063,n.Chedescenderabkhasiancyrillic=1214,n.Chedescendercyrillic=1206,n.Chedieresiscyrillic=1268,n.Cheharmenian=1347,n.Chekhakassiancyrillic=1227,n.Cheverticalstrokecyrillic=1208,n.Chi=935,n.Chook=391,n.Circumflexsmall=63222,n.Cmonospace=65315,n.Coarmenian=1361,n.Csmall=63331,n.D=68,n.DZ=497,n.DZcaron=452,n.Daarmenian=1332,n.Dafrican=393,n.Dcaron=270,n.Dcedilla=7696,n.Dcircle=9401,n.Dcircumflexbelow=7698,n.Dcroat=272,n.Ddotaccent=7690,n.Ddotbelow=7692,n.Decyrillic=1044,n.Deicoptic=1006,n.Delta=8710,n.Deltagreek=916,n.Dhook=394,n.Dieresis=63179,n.DieresisAcute=63180,n.DieresisGrave=63181,n.Dieresissmall=63400,n.Digammagreek=988,n.Djecyrillic=1026,n.Dlinebelow=7694,n.Dmonospace=65316,n.Dotaccentsmall=63223,n.Dslash=272,n.Dsmall=63332,n.Dtopbar=395,n.Dz=498,n.Dzcaron=453,n.Dzeabkhasiancyrillic=1248,n.Dzecyrillic=1029,n.Dzhecyrillic=1039,n.E=69,n.Eacute=201,n.Eacutesmall=63465,n.Ebreve=276,n.Ecaron=282,n.Ecedillabreve=7708,n.Echarmenian=1333,n.Ecircle=9402,n.Ecircumflex=202,n.Ecircumflexacute=7870,n.Ecircumflexbelow=7704,n.Ecircumflexdotbelow=7878,n.Ecircumflexgrave=7872,n.Ecircumflexhookabove=7874,n.Ecircumflexsmall=63466,n.Ecircumflextilde=7876,n.Ecyrillic=1028,n.Edblgrave=516,n.Edieresis=203,n.Edieresissmall=63467,n.Edot=278,n.Edotaccent=278,n.Edotbelow=7864,n.Efcyrillic=1060,n.Egrave=200,n.Egravesmall=63464,n.Eharmenian=1335,n.Ehookabove=7866,n.Eightroman=8551,n.Einvertedbreve=518,n.Eiotifiedcyrillic=1124,n.Elcyrillic=1051,n.Elevenroman=8554,n.Emacron=274,n.Emacronacute=7702,n.Emacrongrave=7700,n.Emcyrillic=1052,n.Emonospace=65317,n.Encyrillic=1053,n.Endescendercyrillic=1186,n.Eng=330,n.Enghecyrillic=1188,n.Enhookcyrillic=1223,n.Eogonek=280,n.Eopen=400,n.Epsilon=917,n.Epsilontonos=904,n.Ercyrillic=1056,n.Ereversed=398,n.Ereversedcyrillic=1069,n.Escyrillic=1057,n.Esdescendercyrillic=1194,n.Esh=425,n.Esmall=63333,n.Eta=919,n.Etarmenian=1336,n.Etatonos=905,n.Eth=208,n.Ethsmall=63472,n.Etilde=7868,n.Etildebelow=7706,n.Euro=8364,n.Ezh=439,n.Ezhcaron=494,n.Ezhreversed=440,n.F=70,n.Fcircle=9403,n.Fdotaccent=7710,n.Feharmenian=1366,n.Feicoptic=996,n.Fhook=401,n.Fitacyrillic=1138,n.Fiveroman=8548,n.Fmonospace=65318,n.Fourroman=8547,n.Fsmall=63334,n.G=71,n.GBsquare=13191,n.Gacute=500,n.Gamma=915,n.Gammaafrican=404,n.Gangiacoptic=1002,n.Gbreve=286,n.Gcaron=486,n.Gcedilla=290,n.Gcircle=9404,n.Gcircumflex=284,n.Gcommaaccent=290,n.Gdot=288,n.Gdotaccent=288,n.Gecyrillic=1043,n.Ghadarmenian=1346,n.Ghemiddlehookcyrillic=1172,n.Ghestrokecyrillic=1170,n.Gheupturncyrillic=1168,n.Ghook=403,n.Gimarmenian=1331,n.Gjecyrillic=1027,n.Gmacron=7712,n.Gmonospace=65319,n.Grave=63182,n.Gravesmall=63328,n.Gsmall=63335,n.Gsmallhook=667,n.Gstroke=484,n.H=72,n.H18533=9679,n.H18543=9642,n.H18551=9643,n.H22073=9633,n.HPsquare=13259,n.Haabkhasiancyrillic=1192,n.Hadescendercyrillic=1202,n.Hardsigncyrillic=1066,n.Hbar=294,n.Hbrevebelow=7722,n.Hcedilla=7720,n.Hcircle=9405,n.Hcircumflex=292,n.Hdieresis=7718,n.Hdotaccent=7714,n.Hdotbelow=7716,n.Hmonospace=65320,n.Hoarmenian=1344,n.Horicoptic=1e3,n.Hsmall=63336,n.Hungarumlaut=63183,n.Hungarumlautsmall=63224,n.Hzsquare=13200,n.I=73,n.IAcyrillic=1071,n.IJ=306,n.IUcyrillic=1070,n.Iacute=205,n.Iacutesmall=63469,n.Ibreve=300,n.Icaron=463,n.Icircle=9406,n.Icircumflex=206,n.Icircumflexsmall=63470,n.Icyrillic=1030,n.Idblgrave=520,n.Idieresis=207,n.Idieresisacute=7726,n.Idieresiscyrillic=1252,n.Idieresissmall=63471,n.Idot=304,n.Idotaccent=304,n.Idotbelow=7882,n.Iebrevecyrillic=1238,n.Iecyrillic=1045,n.Ifraktur=8465,n.Igrave=204,n.Igravesmall=63468,n.Ihookabove=7880,n.Iicyrillic=1048,n.Iinvertedbreve=522,n.Iishortcyrillic=1049,n.Imacron=298,n.Imacroncyrillic=1250,n.Imonospace=65321,n.Iniarmenian=1339,n.Iocyrillic=1025,n.Iogonek=302,n.Iota=921,n.Iotaafrican=406,n.Iotadieresis=938,n.Iotatonos=906,n.Ismall=63337,n.Istroke=407,n.Itilde=296,n.Itildebelow=7724,n.Izhitsacyrillic=1140,n.Izhitsadblgravecyrillic=1142,n.J=74,n.Jaarmenian=1345,n.Jcircle=9407,n.Jcircumflex=308,n.Jecyrillic=1032,n.Jheharmenian=1355,n.Jmonospace=65322,n.Jsmall=63338,n.K=75,n.KBsquare=13189,n.KKsquare=13261,n.Kabashkircyrillic=1184,n.Kacute=7728,n.Kacyrillic=1050,n.Kadescendercyrillic=1178,n.Kahookcyrillic=1219,n.Kappa=922,n.Kastrokecyrillic=1182,n.Kaverticalstrokecyrillic=1180,n.Kcaron=488,n.Kcedilla=310,n.Kcircle=9408,n.Kcommaaccent=310,n.Kdotbelow=7730,n.Keharmenian=1364,n.Kenarmenian=1343,n.Khacyrillic=1061,n.Kheicoptic=998,n.Khook=408,n.Kjecyrillic=1036,n.Klinebelow=7732,n.Kmonospace=65323,n.Koppacyrillic=1152,n.Koppagreek=990,n.Ksicyrillic=1134,n.Ksmall=63339,n.L=76,n.LJ=455,n.LL=63167,n.Lacute=313,n.Lambda=923,n.Lcaron=317,n.Lcedilla=315,n.Lcircle=9409,n.Lcircumflexbelow=7740,n.Lcommaaccent=315,n.Ldot=319,n.Ldotaccent=319,n.Ldotbelow=7734,n.Ldotbelowmacron=7736,n.Liwnarmenian=1340,n.Lj=456,n.Ljecyrillic=1033,n.Llinebelow=7738,n.Lmonospace=65324,n.Lslash=321,n.Lslashsmall=63225,n.Lsmall=63340,n.M=77,n.MBsquare=13190,n.Macron=63184,n.Macronsmall=63407,n.Macute=7742,n.Mcircle=9410,n.Mdotaccent=7744,n.Mdotbelow=7746,n.Menarmenian=1348,n.Mmonospace=65325,n.Msmall=63341,n.Mturned=412,n.Mu=924,n.N=78,n.NJ=458,n.Nacute=323,n.Ncaron=327,n.Ncedilla=325,n.Ncircle=9411,n.Ncircumflexbelow=7754,n.Ncommaaccent=325,n.Ndotaccent=7748,n.Ndotbelow=7750,n.Nhookleft=413,n.Nineroman=8552,n.Nj=459,n.Njecyrillic=1034,n.Nlinebelow=7752,n.Nmonospace=65326,n.Nowarmenian=1350,n.Nsmall=63342,n.Ntilde=209,n.Ntildesmall=63473,n.Nu=925,n.O=79,n.OE=338,n.OEsmall=63226,n.Oacute=211,n.Oacutesmall=63475,n.Obarredcyrillic=1256,n.Obarreddieresiscyrillic=1258,n.Obreve=334,n.Ocaron=465,n.Ocenteredtilde=415,n.Ocircle=9412,n.Ocircumflex=212,n.Ocircumflexacute=7888,n.Ocircumflexdotbelow=7896,n.Ocircumflexgrave=7890,n.Ocircumflexhookabove=7892,n.Ocircumflexsmall=63476,n.Ocircumflextilde=7894,n.Ocyrillic=1054,n.Odblacute=336,n.Odblgrave=524,n.Odieresis=214,n.Odieresiscyrillic=1254,n.Odieresissmall=63478,n.Odotbelow=7884,n.Ogoneksmall=63227,n.Ograve=210,n.Ogravesmall=63474,n.Oharmenian=1365,n.Ohm=8486,n.Ohookabove=7886,n.Ohorn=416,n.Ohornacute=7898,n.Ohorndotbelow=7906,n.Ohorngrave=7900,n.Ohornhookabove=7902,n.Ohorntilde=7904,n.Ohungarumlaut=336,n.Oi=418,n.Oinvertedbreve=526,n.Omacron=332,n.Omacronacute=7762,n.Omacrongrave=7760,n.Omega=8486,n.Omegacyrillic=1120,n.Omegagreek=937,n.Omegaroundcyrillic=1146,n.Omegatitlocyrillic=1148,n.Omegatonos=911,n.Omicron=927,n.Omicrontonos=908,n.Omonospace=65327,n.Oneroman=8544,n.Oogonek=490,n.Oogonekmacron=492,n.Oopen=390,n.Oslash=216,n.Oslashacute=510,n.Oslashsmall=63480,n.Osmall=63343,n.Ostrokeacute=510,n.Otcyrillic=1150,n.Otilde=213,n.Otildeacute=7756,n.Otildedieresis=7758,n.Otildesmall=63477,n.P=80,n.Pacute=7764,n.Pcircle=9413,n.Pdotaccent=7766,n.Pecyrillic=1055,n.Peharmenian=1354,n.Pemiddlehookcyrillic=1190,n.Phi=934,n.Phook=420,n.Pi=928,n.Piwrarmenian=1363,n.Pmonospace=65328,n.Psi=936,n.Psicyrillic=1136,n.Psmall=63344,n.Q=81,n.Qcircle=9414,n.Qmonospace=65329,n.Qsmall=63345,n.R=82,n.Raarmenian=1356,n.Racute=340,n.Rcaron=344,n.Rcedilla=342,n.Rcircle=9415,n.Rcommaaccent=342,n.Rdblgrave=528,n.Rdotaccent=7768,n.Rdotbelow=7770,n.Rdotbelowmacron=7772,n.Reharmenian=1360,n.Rfraktur=8476,n.Rho=929,n.Ringsmall=63228,n.Rinvertedbreve=530,n.Rlinebelow=7774,n.Rmonospace=65330,n.Rsmall=63346,n.Rsmallinverted=641,n.Rsmallinvertedsuperior=694,n.S=83,n.SF010000=9484,n.SF020000=9492,n.SF030000=9488,n.SF040000=9496,n.SF050000=9532,n.SF060000=9516,n.SF070000=9524,n.SF080000=9500,n.SF090000=9508,n.SF100000=9472,n.SF110000=9474,n.SF190000=9569,n.SF200000=9570,n.SF210000=9558,n.SF220000=9557,n.SF230000=9571,n.SF240000=9553,n.SF250000=9559,n.SF260000=9565,n.SF270000=9564,n.SF280000=9563,n.SF360000=9566,n.SF370000=9567,n.SF380000=9562,n.SF390000=9556,n.SF400000=9577,n.SF410000=9574,n.SF420000=9568,n.SF430000=9552,n.SF440000=9580,n.SF450000=9575,n.SF460000=9576,n.SF470000=9572,n.SF480000=9573,n.SF490000=9561,n.SF500000=9560,n.SF510000=9554,n.SF520000=9555,n.SF530000=9579,n.SF540000=9578,n.Sacute=346,n.Sacutedotaccent=7780,n.Sampigreek=992,n.Scaron=352,n.Scarondotaccent=7782,n.Scaronsmall=63229,n.Scedilla=350,n.Schwa=399,n.Schwacyrillic=1240,n.Schwadieresiscyrillic=1242,n.Scircle=9416,n.Scircumflex=348,n.Scommaaccent=536,n.Sdotaccent=7776,n.Sdotbelow=7778,n.Sdotbelowdotaccent=7784,n.Seharmenian=1357,n.Sevenroman=8550,n.Shaarmenian=1351,n.Shacyrillic=1064,n.Shchacyrillic=1065,n.Sheicoptic=994,n.Shhacyrillic=1210,n.Shimacoptic=1004,n.Sigma=931,n.Sixroman=8549,n.Smonospace=65331,n.Softsigncyrillic=1068,n.Ssmall=63347,n.Stigmagreek=986,n.T=84,n.Tau=932,n.Tbar=358,n.Tcaron=356,n.Tcedilla=354,n.Tcircle=9417,n.Tcircumflexbelow=7792,n.Tcommaaccent=354,n.Tdotaccent=7786,n.Tdotbelow=7788,n.Tecyrillic=1058,n.Tedescendercyrillic=1196,n.Tenroman=8553,n.Tetsecyrillic=1204,n.Theta=920,n.Thook=428,n.Thorn=222,n.Thornsmall=63486,n.Threeroman=8546,n.Tildesmall=63230,n.Tiwnarmenian=1359,n.Tlinebelow=7790,n.Tmonospace=65332,n.Toarmenian=1337,n.Tonefive=444,n.Tonesix=388,n.Tonetwo=423,n.Tretroflexhook=430,n.Tsecyrillic=1062,n.Tshecyrillic=1035,n.Tsmall=63348,n.Twelveroman=8555,n.Tworoman=8545,n.U=85,n.Uacute=218,n.Uacutesmall=63482,n.Ubreve=364,n.Ucaron=467,n.Ucircle=9418,n.Ucircumflex=219,n.Ucircumflexbelow=7798,n.Ucircumflexsmall=63483,n.Ucyrillic=1059,n.Udblacute=368,n.Udblgrave=532,n.Udieresis=220,n.Udieresisacute=471,n.Udieresisbelow=7794,n.Udieresiscaron=473,n.Udieresiscyrillic=1264,n.Udieresisgrave=475,n.Udieresismacron=469,n.Udieresissmall=63484,n.Udotbelow=7908,n.Ugrave=217,n.Ugravesmall=63481,n.Uhookabove=7910,n.Uhorn=431,n.Uhornacute=7912,n.Uhorndotbelow=7920,n.Uhorngrave=7914,n.Uhornhookabove=7916,n.Uhorntilde=7918,n.Uhungarumlaut=368,n.Uhungarumlautcyrillic=1266,n.Uinvertedbreve=534,n.Ukcyrillic=1144,n.Umacron=362,n.Umacroncyrillic=1262,n.Umacrondieresis=7802,n.Umonospace=65333,n.Uogonek=370,n.Upsilon=933,n.Upsilon1=978,n.Upsilonacutehooksymbolgreek=979,n.Upsilonafrican=433,n.Upsilondieresis=939,n.Upsilondieresishooksymbolgreek=980,n.Upsilonhooksymbol=978,n.Upsilontonos=910,n.Uring=366,n.Ushortcyrillic=1038,n.Usmall=63349,n.Ustraightcyrillic=1198,n.Ustraightstrokecyrillic=1200,n.Utilde=360,n.Utildeacute=7800,n.Utildebelow=7796,n.V=86,n.Vcircle=9419,n.Vdotbelow=7806,n.Vecyrillic=1042,n.Vewarmenian=1358,n.Vhook=434,n.Vmonospace=65334,n.Voarmenian=1352,n.Vsmall=63350,n.Vtilde=7804,n.W=87,n.Wacute=7810,n.Wcircle=9420,n.Wcircumflex=372,n.Wdieresis=7812,n.Wdotaccent=7814,n.Wdotbelow=7816,n.Wgrave=7808,n.Wmonospace=65335,n.Wsmall=63351,n.X=88,n.Xcircle=9421,n.Xdieresis=7820,n.Xdotaccent=7818,n.Xeharmenian=1341,n.Xi=926,n.Xmonospace=65336,n.Xsmall=63352,n.Y=89,n.Yacute=221,n.Yacutesmall=63485,n.Yatcyrillic=1122,n.Ycircle=9422,n.Ycircumflex=374,n.Ydieresis=376,n.Ydieresissmall=63487,n.Ydotaccent=7822,n.Ydotbelow=7924,n.Yericyrillic=1067,n.Yerudieresiscyrillic=1272,n.Ygrave=7922,n.Yhook=435,n.Yhookabove=7926,n.Yiarmenian=1349,n.Yicyrillic=1031,n.Yiwnarmenian=1362,n.Ymonospace=65337,n.Ysmall=63353,n.Ytilde=7928,n.Yusbigcyrillic=1130,n.Yusbigiotifiedcyrillic=1132,n.Yuslittlecyrillic=1126,n.Yuslittleiotifiedcyrillic=1128,n.Z=90,n.Zaarmenian=1334,n.Zacute=377,n.Zcaron=381,n.Zcaronsmall=63231,n.Zcircle=9423,n.Zcircumflex=7824,n.Zdot=379,n.Zdotaccent=379,n.Zdotbelow=7826,n.Zecyrillic=1047,n.Zedescendercyrillic=1176,n.Zedieresiscyrillic=1246,n.Zeta=918,n.Zhearmenian=1338,n.Zhebrevecyrillic=1217,n.Zhecyrillic=1046,n.Zhedescendercyrillic=1174,n.Zhedieresiscyrillic=1244,n.Zlinebelow=7828,n.Zmonospace=65338,n.Zsmall=63354,n.Zstroke=437,n.a=97,n.aabengali=2438,n.aacute=225,n.aadeva=2310,n.aagujarati=2694,n.aagurmukhi=2566,n.aamatragurmukhi=2622,n.aarusquare=13059,n.aavowelsignbengali=2494,n.aavowelsigndeva=2366,n.aavowelsigngujarati=2750,n.abbreviationmarkarmenian=1375,n.abbreviationsigndeva=2416,n.abengali=2437,n.abopomofo=12570,n.abreve=259,n.abreveacute=7855,n.abrevecyrillic=1233,n.abrevedotbelow=7863,n.abrevegrave=7857,n.abrevehookabove=7859,n.abrevetilde=7861,n.acaron=462,n.acircle=9424,n.acircumflex=226,n.acircumflexacute=7845,n.acircumflexdotbelow=7853,n.acircumflexgrave=7847,n.acircumflexhookabove=7849,n.acircumflextilde=7851,n.acute=180,n.acutebelowcmb=791,n.acutecmb=769,n.acutecomb=769,n.acutedeva=2388,n.acutelowmod=719,n.acutetonecmb=833,n.acyrillic=1072,n.adblgrave=513,n.addakgurmukhi=2673,n.adeva=2309,n.adieresis=228,n.adieresiscyrillic=1235,n.adieresismacron=479,n.adotbelow=7841,n.adotmacron=481,n.ae=230,n.aeacute=509,n.aekorean=12624,n.aemacron=483,n.afii00208=8213,n.afii08941=8356,n.afii10017=1040,n.afii10018=1041,n.afii10019=1042,n.afii10020=1043,n.afii10021=1044,n.afii10022=1045,n.afii10023=1025,n.afii10024=1046,n.afii10025=1047,n.afii10026=1048,n.afii10027=1049,n.afii10028=1050,n.afii10029=1051,n.afii10030=1052,n.afii10031=1053,n.afii10032=1054,n.afii10033=1055,n.afii10034=1056,n.afii10035=1057,n.afii10036=1058,n.afii10037=1059,n.afii10038=1060,n.afii10039=1061,n.afii10040=1062,n.afii10041=1063,n.afii10042=1064,n.afii10043=1065,n.afii10044=1066,n.afii10045=1067,n.afii10046=1068,n.afii10047=1069,n.afii10048=1070,n.afii10049=1071,n.afii10050=1168,n.afii10051=1026,n.afii10052=1027,n.afii10053=1028,n.afii10054=1029,n.afii10055=1030,n.afii10056=1031,n.afii10057=1032,n.afii10058=1033,n.afii10059=1034,n.afii10060=1035,n.afii10061=1036,n.afii10062=1038,n.afii10063=63172,n.afii10064=63173,n.afii10065=1072,n.afii10066=1073,n.afii10067=1074,n.afii10068=1075,n.afii10069=1076,n.afii10070=1077,n.afii10071=1105,n.afii10072=1078,n.afii10073=1079,n.afii10074=1080,n.afii10075=1081,n.afii10076=1082,n.afii10077=1083,n.afii10078=1084,n.afii10079=1085,n.afii10080=1086,n.afii10081=1087,n.afii10082=1088,n.afii10083=1089,n.afii10084=1090,n.afii10085=1091,n.afii10086=1092,n.afii10087=1093,n.afii10088=1094,n.afii10089=1095,n.afii10090=1096,n.afii10091=1097,n.afii10092=1098,n.afii10093=1099,n.afii10094=1100,n.afii10095=1101,n.afii10096=1102,n.afii10097=1103,n.afii10098=1169,n.afii10099=1106,n.afii10100=1107,n.afii10101=1108,n.afii10102=1109,n.afii10103=1110,n.afii10104=1111,n.afii10105=1112,n.afii10106=1113,n.afii10107=1114,n.afii10108=1115,n.afii10109=1116,n.afii10110=1118,n.afii10145=1039,n.afii10146=1122,n.afii10147=1138,n.afii10148=1140,n.afii10192=63174,n.afii10193=1119,n.afii10194=1123,n.afii10195=1139,n.afii10196=1141,n.afii10831=63175,n.afii10832=63176,n.afii10846=1241,n.afii299=8206,n.afii300=8207,n.afii301=8205,n.afii57381=1642,n.afii57388=1548,n.afii57392=1632,n.afii57393=1633,n.afii57394=1634,n.afii57395=1635,n.afii57396=1636,n.afii57397=1637,n.afii57398=1638,n.afii57399=1639,n.afii57400=1640,n.afii57401=1641,n.afii57403=1563,n.afii57407=1567,n.afii57409=1569,n.afii57410=1570,n.afii57411=1571,n.afii57412=1572,n.afii57413=1573,n.afii57414=1574,n.afii57415=1575,n.afii57416=1576,n.afii57417=1577,n.afii57418=1578,n.afii57419=1579,n.afii57420=1580,n.afii57421=1581,n.afii57422=1582,n.afii57423=1583,n.afii57424=1584,n.afii57425=1585,n.afii57426=1586,n.afii57427=1587,n.afii57428=1588,n.afii57429=1589,n.afii57430=1590,n.afii57431=1591,n.afii57432=1592,n.afii57433=1593,n.afii57434=1594,n.afii57440=1600,n.afii57441=1601,n.afii57442=1602,n.afii57443=1603,n.afii57444=1604,n.afii57445=1605,n.afii57446=1606,n.afii57448=1608,n.afii57449=1609,n.afii57450=1610,n.afii57451=1611,n.afii57452=1612,n.afii57453=1613,n.afii57454=1614,n.afii57455=1615,n.afii57456=1616,n.afii57457=1617,n.afii57458=1618,n.afii57470=1607,n.afii57505=1700,n.afii57506=1662,n.afii57507=1670,n.afii57508=1688,n.afii57509=1711,n.afii57511=1657,n.afii57512=1672,n.afii57513=1681,n.afii57514=1722,n.afii57519=1746,n.afii57534=1749,n.afii57636=8362,n.afii57645=1470,n.afii57658=1475,n.afii57664=1488,n.afii57665=1489,n.afii57666=1490,n.afii57667=1491,n.afii57668=1492,n.afii57669=1493,n.afii57670=1494,n.afii57671=1495,n.afii57672=1496,n.afii57673=1497,n.afii57674=1498,n.afii57675=1499,n.afii57676=1500,n.afii57677=1501,n.afii57678=1502,n.afii57679=1503,n.afii57680=1504,n.afii57681=1505,n.afii57682=1506,n.afii57683=1507,n.afii57684=1508,n.afii57685=1509,n.afii57686=1510,n.afii57687=1511,n.afii57688=1512,n.afii57689=1513,n.afii57690=1514,n.afii57694=64298,n.afii57695=64299,n.afii57700=64331,n.afii57705=64287,n.afii57716=1520,n.afii57717=1521,n.afii57718=1522,n.afii57723=64309,n.afii57793=1460,n.afii57794=1461,n.afii57795=1462,n.afii57796=1467,n.afii57797=1464,n.afii57798=1463,n.afii57799=1456,n.afii57800=1458,n.afii57801=1457,n.afii57802=1459,n.afii57803=1474,n.afii57804=1473,n.afii57806=1465,n.afii57807=1468,n.afii57839=1469,n.afii57841=1471,n.afii57842=1472,n.afii57929=700,n.afii61248=8453,n.afii61289=8467,n.afii61352=8470,n.afii61573=8236,n.afii61574=8237,n.afii61575=8238,n.afii61664=8204,n.afii63167=1645,n.afii64937=701,n.agrave=224,n.agujarati=2693,n.agurmukhi=2565,n.ahiragana=12354,n.ahookabove=7843,n.aibengali=2448,n.aibopomofo=12574,n.aideva=2320,n.aiecyrillic=1237,n.aigujarati=2704,n.aigurmukhi=2576,n.aimatragurmukhi=2632,n.ainarabic=1593,n.ainfinalarabic=65226,n.aininitialarabic=65227,n.ainmedialarabic=65228,n.ainvertedbreve=515,n.aivowelsignbengali=2504,n.aivowelsigndeva=2376,n.aivowelsigngujarati=2760,n.akatakana=12450,n.akatakanahalfwidth=65393,n.akorean=12623,n.alef=1488,n.alefarabic=1575,n.alefdageshhebrew=64304,n.aleffinalarabic=65166,n.alefhamzaabovearabic=1571,n.alefhamzaabovefinalarabic=65156,n.alefhamzabelowarabic=1573,n.alefhamzabelowfinalarabic=65160,n.alefhebrew=1488,n.aleflamedhebrew=64335,n.alefmaddaabovearabic=1570,n.alefmaddaabovefinalarabic=65154,n.alefmaksuraarabic=1609,n.alefmaksurafinalarabic=65264,n.alefmaksurainitialarabic=65267,n.alefmaksuramedialarabic=65268,n.alefpatahhebrew=64302,n.alefqamatshebrew=64303,n.aleph=8501,n.allequal=8780,n.alpha=945,n.alphatonos=940,n.amacron=257,n.amonospace=65345,n.ampersand=38,n.ampersandmonospace=65286,n.ampersandsmall=63270,n.amsquare=13250,n.anbopomofo=12578,n.angbopomofo=12580,n.angbracketleft=12296,n.angbracketright=12297,n.angkhankhuthai=3674,n.angle=8736,n.anglebracketleft=12296,n.anglebracketleftvertical=65087,n.anglebracketright=12297,n.anglebracketrightvertical=65088,n.angleleft=9001,n.angleright=9002,n.angstrom=8491,n.anoteleia=903,n.anudattadeva=2386,n.anusvarabengali=2434,n.anusvaradeva=2306,n.anusvaragujarati=2690,n.aogonek=261,n.apaatosquare=13056,n.aparen=9372,n.apostrophearmenian=1370,n.apostrophemod=700,n.apple=63743,n.approaches=8784,n.approxequal=8776,n.approxequalorimage=8786,n.approximatelyequal=8773,n.araeaekorean=12686,n.araeakorean=12685,n.arc=8978,n.arighthalfring=7834,n.aring=229,n.aringacute=507,n.aringbelow=7681,n.arrowboth=8596,n.arrowdashdown=8675,n.arrowdashleft=8672,n.arrowdashright=8674,n.arrowdashup=8673,n.arrowdblboth=8660,n.arrowdbldown=8659,n.arrowdblleft=8656,n.arrowdblright=8658,n.arrowdblup=8657,n.arrowdown=8595,n.arrowdownleft=8601,n.arrowdownright=8600,n.arrowdownwhite=8681,n.arrowheaddownmod=709,n.arrowheadleftmod=706,n.arrowheadrightmod=707,n.arrowheadupmod=708,n.arrowhorizex=63719,n.arrowleft=8592,n.arrowleftdbl=8656,n.arrowleftdblstroke=8653,n.arrowleftoverright=8646,n.arrowleftwhite=8678,n.arrowright=8594,n.arrowrightdblstroke=8655,n.arrowrightheavy=10142,n.arrowrightoverleft=8644,n.arrowrightwhite=8680,n.arrowtableft=8676,n.arrowtabright=8677,n.arrowup=8593,n.arrowupdn=8597,n.arrowupdnbse=8616,n.arrowupdownbase=8616,n.arrowupleft=8598,n.arrowupleftofdown=8645,n.arrowupright=8599,n.arrowupwhite=8679,n.arrowvertex=63718,n.asciicircum=94,n.asciicircummonospace=65342,n.asciitilde=126,n.asciitildemonospace=65374,n.ascript=593,n.ascriptturned=594,n.asmallhiragana=12353,n.asmallkatakana=12449,n.asmallkatakanahalfwidth=65383,n.asterisk=42,n.asteriskaltonearabic=1645,n.asteriskarabic=1645,n.asteriskmath=8727,n.asteriskmonospace=65290,n.asterisksmall=65121,n.asterism=8258,n.asuperior=63209,n.asymptoticallyequal=8771,n.at=64,n.atilde=227,n.atmonospace=65312,n.atsmall=65131,n.aturned=592,n.aubengali=2452,n.aubopomofo=12576,n.audeva=2324,n.augujarati=2708,n.augurmukhi=2580,n.aulengthmarkbengali=2519,n.aumatragurmukhi=2636,n.auvowelsignbengali=2508,n.auvowelsigndeva=2380,n.auvowelsigngujarati=2764,n.avagrahadeva=2365,n.aybarmenian=1377,n.ayin=1506,n.ayinaltonehebrew=64288,n.ayinhebrew=1506,n.b=98,n.babengali=2476,n.backslash=92,n.backslashmonospace=65340,n.badeva=2348,n.bagujarati=2732,n.bagurmukhi=2604,n.bahiragana=12400,n.bahtthai=3647,n.bakatakana=12496,n.bar=124,n.barmonospace=65372,n.bbopomofo=12549,n.bcircle=9425,n.bdotaccent=7683,n.bdotbelow=7685,n.beamedsixteenthnotes=9836,n.because=8757,n.becyrillic=1073,n.beharabic=1576,n.behfinalarabic=65168,n.behinitialarabic=65169,n.behiragana=12409,n.behmedialarabic=65170,n.behmeeminitialarabic=64671,n.behmeemisolatedarabic=64520,n.behnoonfinalarabic=64621,n.bekatakana=12505,n.benarmenian=1378,n.bet=1489,n.beta=946,n.betasymbolgreek=976,n.betdagesh=64305,n.betdageshhebrew=64305,n.bethebrew=1489,n.betrafehebrew=64332,n.bhabengali=2477,n.bhadeva=2349,n.bhagujarati=2733,n.bhagurmukhi=2605,n.bhook=595,n.bihiragana=12403,n.bikatakana=12499,n.bilabialclick=664,n.bindigurmukhi=2562,n.birusquare=13105,n.blackcircle=9679,n.blackdiamond=9670,n.blackdownpointingtriangle=9660,n.blackleftpointingpointer=9668,n.blackleftpointingtriangle=9664,n.blacklenticularbracketleft=12304,n.blacklenticularbracketleftvertical=65083,n.blacklenticularbracketright=12305,n.blacklenticularbracketrightvertical=65084,n.blacklowerlefttriangle=9699,n.blacklowerrighttriangle=9698,n.blackrectangle=9644,n.blackrightpointingpointer=9658,n.blackrightpointingtriangle=9654,n.blacksmallsquare=9642,n.blacksmilingface=9787,n.blacksquare=9632,n.blackstar=9733,n.blackupperlefttriangle=9700,n.blackupperrighttriangle=9701,n.blackuppointingsmalltriangle=9652,n.blackuppointingtriangle=9650,n.blank=9251,n.blinebelow=7687,n.block=9608,n.bmonospace=65346,n.bobaimaithai=3610,n.bohiragana=12412,n.bokatakana=12508,n.bparen=9373,n.bqsquare=13251,n.braceex=63732,n.braceleft=123,n.braceleftbt=63731,n.braceleftmid=63730,n.braceleftmonospace=65371,n.braceleftsmall=65115,n.bracelefttp=63729,n.braceleftvertical=65079,n.braceright=125,n.bracerightbt=63742,n.bracerightmid=63741,n.bracerightmonospace=65373,n.bracerightsmall=65116,n.bracerighttp=63740,n.bracerightvertical=65080,n.bracketleft=91,n.bracketleftbt=63728,n.bracketleftex=63727,n.bracketleftmonospace=65339,n.bracketlefttp=63726,n.bracketright=93,n.bracketrightbt=63739,n.bracketrightex=63738,n.bracketrightmonospace=65341,n.bracketrighttp=63737,n.breve=728,n.brevebelowcmb=814,n.brevecmb=774,n.breveinvertedbelowcmb=815,n.breveinvertedcmb=785,n.breveinverteddoublecmb=865,n.bridgebelowcmb=810,n.bridgeinvertedbelowcmb=826,n.brokenbar=166,n.bstroke=384,n.bsuperior=63210,n.btopbar=387,n.buhiragana=12406,n.bukatakana=12502,n.bullet=8226,n.bulletinverse=9688,n.bulletoperator=8729,n.bullseye=9678,n.c=99,n.caarmenian=1390,n.cabengali=2458,n.cacute=263,n.cadeva=2330,n.cagujarati=2714,n.cagurmukhi=2586,n.calsquare=13192,n.candrabindubengali=2433,n.candrabinducmb=784,n.candrabindudeva=2305,n.candrabindugujarati=2689,n.capslock=8682,n.careof=8453,n.caron=711,n.caronbelowcmb=812,n.caroncmb=780,n.carriagereturn=8629,n.cbopomofo=12568,n.ccaron=269,n.ccedilla=231,n.ccedillaacute=7689,n.ccircle=9426,n.ccircumflex=265,n.ccurl=597,n.cdot=267,n.cdotaccent=267,n.cdsquare=13253,n.cedilla=184,n.cedillacmb=807,n.cent=162,n.centigrade=8451,n.centinferior=63199,n.centmonospace=65504,n.centoldstyle=63394,n.centsuperior=63200,n.chaarmenian=1401,n.chabengali=2459,n.chadeva=2331,n.chagujarati=2715,n.chagurmukhi=2587,n.chbopomofo=12564,n.cheabkhasiancyrillic=1213,n.checkmark=10003,n.checyrillic=1095,n.chedescenderabkhasiancyrillic=1215,n.chedescendercyrillic=1207,n.chedieresiscyrillic=1269,n.cheharmenian=1395,n.chekhakassiancyrillic=1228,n.cheverticalstrokecyrillic=1209,n.chi=967,n.chieuchacirclekorean=12919,n.chieuchaparenkorean=12823,n.chieuchcirclekorean=12905,n.chieuchkorean=12618,n.chieuchparenkorean=12809,n.chochangthai=3594,n.chochanthai=3592,n.chochingthai=3593,n.chochoethai=3596,n.chook=392,n.cieucacirclekorean=12918,n.cieucaparenkorean=12822,n.cieuccirclekorean=12904,n.cieuckorean=12616,n.cieucparenkorean=12808,n.cieucuparenkorean=12828,n.circle=9675,n.circlecopyrt=169,n.circlemultiply=8855,n.circleot=8857,n.circleplus=8853,n.circlepostalmark=12342,n.circlewithlefthalfblack=9680,n.circlewithrighthalfblack=9681,n.circumflex=710,n.circumflexbelowcmb=813,n.circumflexcmb=770,n.clear=8999,n.clickalveolar=450,n.clickdental=448,n.clicklateral=449,n.clickretroflex=451,n.club=9827,n.clubsuitblack=9827,n.clubsuitwhite=9831,n.cmcubedsquare=13220,n.cmonospace=65347,n.cmsquaredsquare=13216,n.coarmenian=1409,n.colon=58,n.colonmonetary=8353,n.colonmonospace=65306,n.colonsign=8353,n.colonsmall=65109,n.colontriangularhalfmod=721,n.colontriangularmod=720,n.comma=44,n.commaabovecmb=787,n.commaaboverightcmb=789,n.commaaccent=63171,n.commaarabic=1548,n.commaarmenian=1373,n.commainferior=63201,n.commamonospace=65292,n.commareversedabovecmb=788,n.commareversedmod=701,n.commasmall=65104,n.commasuperior=63202,n.commaturnedabovecmb=786,n.commaturnedmod=699,n.compass=9788,n.congruent=8773,n.contourintegral=8750,n.control=8963,n.controlACK=6,n.controlBEL=7,n.controlBS=8,n.controlCAN=24,n.controlCR=13,n.controlDC1=17,n.controlDC2=18,n.controlDC3=19,n.controlDC4=20,n.controlDEL=127,n.controlDLE=16,n.controlEM=25,n.controlENQ=5,n.controlEOT=4,n.controlESC=27,n.controlETB=23,n.controlETX=3,n.controlFF=12,n.controlFS=28,n.controlGS=29,n.controlHT=9,n.controlLF=10,n.controlNAK=21,n.controlNULL=0,n.controlRS=30,n.controlSI=15,n.controlSO=14,n.controlSOT=2,n.controlSTX=1,n.controlSUB=26,n.controlSYN=22,n.controlUS=31,n.controlVT=11,n.copyright=169,n.copyrightsans=63721,n.copyrightserif=63193,n.cornerbracketleft=12300,n.cornerbracketlefthalfwidth=65378,n.cornerbracketleftvertical=65089,n.cornerbracketright=12301,n.cornerbracketrighthalfwidth=65379,n.cornerbracketrightvertical=65090,n.corporationsquare=13183,n.cosquare=13255,n.coverkgsquare=13254,n.cparen=9374,n.cruzeiro=8354,n.cstretched=663,n.curlyand=8911,n.curlyor=8910,n.currency=164,n.cyrBreve=63185,n.cyrFlex=63186,n.cyrbreve=63188,n.cyrflex=63189,n.d=100,n.daarmenian=1380,n.dabengali=2470,n.dadarabic=1590,n.dadeva=2342,n.dadfinalarabic=65214,n.dadinitialarabic=65215,n.dadmedialarabic=65216,n.dagesh=1468,n.dageshhebrew=1468,n.dagger=8224,n.daggerdbl=8225,n.dagujarati=2726,n.dagurmukhi=2598,n.dahiragana=12384,n.dakatakana=12480,n.dalarabic=1583,n.dalet=1491,n.daletdagesh=64307,n.daletdageshhebrew=64307,n.dalethebrew=1491,n.dalfinalarabic=65194,n.dammaarabic=1615,n.dammalowarabic=1615,n.dammatanaltonearabic=1612,n.dammatanarabic=1612,n.danda=2404,n.dargahebrew=1447,n.dargalefthebrew=1447,n.dasiapneumatacyrilliccmb=1157,n.dblGrave=63187,n.dblanglebracketleft=12298,n.dblanglebracketleftvertical=65085,n.dblanglebracketright=12299,n.dblanglebracketrightvertical=65086,n.dblarchinvertedbelowcmb=811,n.dblarrowleft=8660,n.dblarrowright=8658,n.dbldanda=2405,n.dblgrave=63190,n.dblgravecmb=783,n.dblintegral=8748,n.dbllowline=8215,n.dbllowlinecmb=819,n.dbloverlinecmb=831,n.dblprimemod=698,n.dblverticalbar=8214,n.dblverticallineabovecmb=782,n.dbopomofo=12553,n.dbsquare=13256,n.dcaron=271,n.dcedilla=7697,n.dcircle=9427,n.dcircumflexbelow=7699,n.dcroat=273,n.ddabengali=2465,n.ddadeva=2337,n.ddagujarati=2721,n.ddagurmukhi=2593,n.ddalarabic=1672,n.ddalfinalarabic=64393,n.dddhadeva=2396,n.ddhabengali=2466,n.ddhadeva=2338,n.ddhagujarati=2722,n.ddhagurmukhi=2594,n.ddotaccent=7691,n.ddotbelow=7693,n.decimalseparatorarabic=1643,n.decimalseparatorpersian=1643,n.decyrillic=1076,n.degree=176,n.dehihebrew=1453,n.dehiragana=12391,n.deicoptic=1007,n.dekatakana=12487,n.deleteleft=9003,n.deleteright=8998,n.delta=948,n.deltaturned=397,n.denominatorminusonenumeratorbengali=2552,n.dezh=676,n.dhabengali=2471,n.dhadeva=2343,n.dhagujarati=2727,n.dhagurmukhi=2599,n.dhook=599,n.dialytikatonos=901,n.dialytikatonoscmb=836,n.diamond=9830,n.diamondsuitwhite=9826,n.dieresis=168,n.dieresisacute=63191,n.dieresisbelowcmb=804,n.dieresiscmb=776,n.dieresisgrave=63192,n.dieresistonos=901,n.dihiragana=12386,n.dikatakana=12482,n.dittomark=12291,n.divide=247,n.divides=8739,n.divisionslash=8725,n.djecyrillic=1106,n.dkshade=9619,n.dlinebelow=7695,n.dlsquare=13207,n.dmacron=273,n.dmonospace=65348,n.dnblock=9604,n.dochadathai=3598,n.dodekthai=3604,n.dohiragana=12393,n.dokatakana=12489,n.dollar=36,n.dollarinferior=63203,n.dollarmonospace=65284,n.dollaroldstyle=63268,n.dollarsmall=65129,n.dollarsuperior=63204,n.dong=8363,n.dorusquare=13094,n.dotaccent=729,n.dotaccentcmb=775,n.dotbelowcmb=803,n.dotbelowcomb=803,n.dotkatakana=12539,n.dotlessi=305,n.dotlessj=63166,n.dotlessjstrokehook=644,n.dotmath=8901,n.dottedcircle=9676,n.doubleyodpatah=64287,n.doubleyodpatahhebrew=64287,n.downtackbelowcmb=798,n.downtackmod=725,n.dparen=9375,n.dsuperior=63211,n.dtail=598,n.dtopbar=396,n.duhiragana=12389,n.dukatakana=12485,n.dz=499,n.dzaltone=675,n.dzcaron=454,n.dzcurl=677,n.dzeabkhasiancyrillic=1249,n.dzecyrillic=1109,n.dzhecyrillic=1119,n.e=101,n.eacute=233,n.earth=9793,n.ebengali=2447,n.ebopomofo=12572,n.ebreve=277,n.ecandradeva=2317,n.ecandragujarati=2701,n.ecandravowelsigndeva=2373,n.ecandravowelsigngujarati=2757,n.ecaron=283,n.ecedillabreve=7709,n.echarmenian=1381,n.echyiwnarmenian=1415,n.ecircle=9428,n.ecircumflex=234,n.ecircumflexacute=7871,n.ecircumflexbelow=7705,n.ecircumflexdotbelow=7879,n.ecircumflexgrave=7873,n.ecircumflexhookabove=7875,n.ecircumflextilde=7877,n.ecyrillic=1108,n.edblgrave=517,n.edeva=2319,n.edieresis=235,n.edot=279,n.edotaccent=279,n.edotbelow=7865,n.eegurmukhi=2575,n.eematragurmukhi=2631,n.efcyrillic=1092,n.egrave=232,n.egujarati=2703,n.eharmenian=1383,n.ehbopomofo=12573,n.ehiragana=12360,n.ehookabove=7867,n.eibopomofo=12575,n.eight=56,n.eightarabic=1640,n.eightbengali=2542,n.eightcircle=9319,n.eightcircleinversesansserif=10129,n.eightdeva=2414,n.eighteencircle=9329,n.eighteenparen=9349,n.eighteenperiod=9369,n.eightgujarati=2798,n.eightgurmukhi=2670,n.eighthackarabic=1640,n.eighthangzhou=12328,n.eighthnotebeamed=9835,n.eightideographicparen=12839,n.eightinferior=8328,n.eightmonospace=65304,n.eightoldstyle=63288,n.eightparen=9339,n.eightperiod=9359,n.eightpersian=1784,n.eightroman=8567,n.eightsuperior=8312,n.eightthai=3672,n.einvertedbreve=519,n.eiotifiedcyrillic=1125,n.ekatakana=12456,n.ekatakanahalfwidth=65396,n.ekonkargurmukhi=2676,n.ekorean=12628,n.elcyrillic=1083,n.element=8712,n.elevencircle=9322,n.elevenparen=9342,n.elevenperiod=9362,n.elevenroman=8570,n.ellipsis=8230,n.ellipsisvertical=8942,n.emacron=275,n.emacronacute=7703,n.emacrongrave=7701,n.emcyrillic=1084,n.emdash=8212,n.emdashvertical=65073,n.emonospace=65349,n.emphasismarkarmenian=1371,n.emptyset=8709,n.enbopomofo=12579,n.encyrillic=1085,n.endash=8211,n.endashvertical=65074,n.endescendercyrillic=1187,n.eng=331,n.engbopomofo=12581,n.enghecyrillic=1189,n.enhookcyrillic=1224,n.enspace=8194,n.eogonek=281,n.eokorean=12627,n.eopen=603,n.eopenclosed=666,n.eopenreversed=604,n.eopenreversedclosed=606,n.eopenreversedhook=605,n.eparen=9376,n.epsilon=949,n.epsilontonos=941,n.equal=61,n.equalmonospace=65309,n.equalsmall=65126,n.equalsuperior=8316,n.equivalence=8801,n.erbopomofo=12582,n.ercyrillic=1088,n.ereversed=600,n.ereversedcyrillic=1101,n.escyrillic=1089,n.esdescendercyrillic=1195,n.esh=643,n.eshcurl=646,n.eshortdeva=2318,n.eshortvowelsigndeva=2374,n.eshreversedloop=426,n.eshsquatreversed=645,n.esmallhiragana=12359,n.esmallkatakana=12455,n.esmallkatakanahalfwidth=65386,n.estimated=8494,n.esuperior=63212,n.eta=951,n.etarmenian=1384,n.etatonos=942,n.eth=240,n.etilde=7869,n.etildebelow=7707,n.etnahtafoukhhebrew=1425,n.etnahtafoukhlefthebrew=1425,n.etnahtahebrew=1425,n.etnahtalefthebrew=1425,n.eturned=477,n.eukorean=12641,n.euro=8364,n.evowelsignbengali=2503,n.evowelsigndeva=2375,n.evowelsigngujarati=2759,n.exclam=33,n.exclamarmenian=1372,n.exclamdbl=8252,n.exclamdown=161,n.exclamdownsmall=63393,n.exclammonospace=65281,n.exclamsmall=63265,n.existential=8707,n.ezh=658,n.ezhcaron=495,n.ezhcurl=659,n.ezhreversed=441,n.ezhtail=442,n.f=102,n.fadeva=2398,n.fagurmukhi=2654,n.fahrenheit=8457,n.fathaarabic=1614,n.fathalowarabic=1614,n.fathatanarabic=1611,n.fbopomofo=12552,n.fcircle=9429,n.fdotaccent=7711,n.feharabic=1601,n.feharmenian=1414,n.fehfinalarabic=65234,n.fehinitialarabic=65235,n.fehmedialarabic=65236,n.feicoptic=997,n.female=9792,n.ff=64256,n.f_f=64256,n.ffi=64259,n.f_f_i=64259,n.ffl=64260,n.f_f_l=64260,n.fi=64257,n.f_i=64257,n.fifteencircle=9326,n.fifteenparen=9346,n.fifteenperiod=9366,n.figuredash=8210,n.filledbox=9632,n.filledrect=9644,n.finalkaf=1498,n.finalkafdagesh=64314,n.finalkafdageshhebrew=64314,n.finalkafhebrew=1498,n.finalmem=1501,n.finalmemhebrew=1501,n.finalnun=1503,n.finalnunhebrew=1503,n.finalpe=1507,n.finalpehebrew=1507,n.finaltsadi=1509,n.finaltsadihebrew=1509,n.firsttonechinese=713,n.fisheye=9673,n.fitacyrillic=1139,n.five=53,n.fivearabic=1637,n.fivebengali=2539,n.fivecircle=9316,n.fivecircleinversesansserif=10126,n.fivedeva=2411,n.fiveeighths=8541,n.fivegujarati=2795,n.fivegurmukhi=2667,n.fivehackarabic=1637,n.fivehangzhou=12325,n.fiveideographicparen=12836,n.fiveinferior=8325,n.fivemonospace=65301,n.fiveoldstyle=63285,n.fiveparen=9336,n.fiveperiod=9356,n.fivepersian=1781,n.fiveroman=8564,n.fivesuperior=8309,n.fivethai=3669,n.fl=64258,n.f_l=64258,n.florin=402,n.fmonospace=65350,n.fmsquare=13209,n.fofanthai=3615,n.fofathai=3613,n.fongmanthai=3663,n.forall=8704,n.four=52,n.fourarabic=1636,n.fourbengali=2538,n.fourcircle=9315,n.fourcircleinversesansserif=10125,n.fourdeva=2410,n.fourgujarati=2794,n.fourgurmukhi=2666,n.fourhackarabic=1636,n.fourhangzhou=12324,n.fourideographicparen=12835,n.fourinferior=8324,n.fourmonospace=65300,n.fournumeratorbengali=2551,n.fouroldstyle=63284,n.fourparen=9335,n.fourperiod=9355,n.fourpersian=1780,n.fourroman=8563,n.foursuperior=8308,n.fourteencircle=9325,n.fourteenparen=9345,n.fourteenperiod=9365,n.fourthai=3668,n.fourthtonechinese=715,n.fparen=9377,n.fraction=8260,n.franc=8355,n.g=103,n.gabengali=2455,n.gacute=501,n.gadeva=2327,n.gafarabic=1711,n.gaffinalarabic=64403,n.gafinitialarabic=64404,n.gafmedialarabic=64405,n.gagujarati=2711,n.gagurmukhi=2583,n.gahiragana=12364,n.gakatakana=12460,n.gamma=947,n.gammalatinsmall=611,n.gammasuperior=736,n.gangiacoptic=1003,n.gbopomofo=12557,n.gbreve=287,n.gcaron=487,n.gcedilla=291,n.gcircle=9430,n.gcircumflex=285,n.gcommaaccent=291,n.gdot=289,n.gdotaccent=289,n.gecyrillic=1075,n.gehiragana=12370,n.gekatakana=12466,n.geometricallyequal=8785,n.gereshaccenthebrew=1436,n.gereshhebrew=1523,n.gereshmuqdamhebrew=1437,n.germandbls=223,n.gershayimaccenthebrew=1438,n.gershayimhebrew=1524,n.getamark=12307,n.ghabengali=2456,n.ghadarmenian=1394,n.ghadeva=2328,n.ghagujarati=2712,n.ghagurmukhi=2584,n.ghainarabic=1594,n.ghainfinalarabic=65230,n.ghaininitialarabic=65231,n.ghainmedialarabic=65232,n.ghemiddlehookcyrillic=1173,n.ghestrokecyrillic=1171,n.gheupturncyrillic=1169,n.ghhadeva=2394,n.ghhagurmukhi=2650,n.ghook=608,n.ghzsquare=13203,n.gihiragana=12366,n.gikatakana=12462,n.gimarmenian=1379,n.gimel=1490,n.gimeldagesh=64306,n.gimeldageshhebrew=64306,n.gimelhebrew=1490,n.gjecyrillic=1107,n.glottalinvertedstroke=446,n.glottalstop=660,n.glottalstopinverted=662,n.glottalstopmod=704,n.glottalstopreversed=661,n.glottalstopreversedmod=705,n.glottalstopreversedsuperior=740,n.glottalstopstroke=673,n.glottalstopstrokereversed=674,n.gmacron=7713,n.gmonospace=65351,n.gohiragana=12372,n.gokatakana=12468,n.gparen=9378,n.gpasquare=13228,n.gradient=8711,n.grave=96,n.gravebelowcmb=790,n.gravecmb=768,n.gravecomb=768,n.gravedeva=2387,n.gravelowmod=718,n.gravemonospace=65344,n.gravetonecmb=832,n.greater=62,n.greaterequal=8805,n.greaterequalorless=8923,n.greatermonospace=65310,n.greaterorequivalent=8819,n.greaterorless=8823,n.greateroverequal=8807,n.greatersmall=65125,n.gscript=609,n.gstroke=485,n.guhiragana=12368,n.guillemotleft=171,n.guillemotright=187,n.guilsinglleft=8249,n.guilsinglright=8250,n.gukatakana=12464,n.guramusquare=13080,n.gysquare=13257,n.h=104,n.haabkhasiancyrillic=1193,n.haaltonearabic=1729,n.habengali=2489,n.hadescendercyrillic=1203,n.hadeva=2361,n.hagujarati=2745,n.hagurmukhi=2617,n.haharabic=1581,n.hahfinalarabic=65186,n.hahinitialarabic=65187,n.hahiragana=12399,n.hahmedialarabic=65188,n.haitusquare=13098,n.hakatakana=12495,n.hakatakanahalfwidth=65418,n.halantgurmukhi=2637,n.hamzaarabic=1569,n.hamzalowarabic=1569,n.hangulfiller=12644,n.hardsigncyrillic=1098,n.harpoonleftbarbup=8636,n.harpoonrightbarbup=8640,n.hasquare=13258,n.hatafpatah=1458,n.hatafpatah16=1458,n.hatafpatah23=1458,n.hatafpatah2f=1458,n.hatafpatahhebrew=1458,n.hatafpatahnarrowhebrew=1458,n.hatafpatahquarterhebrew=1458,n.hatafpatahwidehebrew=1458,n.hatafqamats=1459,n.hatafqamats1b=1459,n.hatafqamats28=1459,n.hatafqamats34=1459,n.hatafqamatshebrew=1459,n.hatafqamatsnarrowhebrew=1459,n.hatafqamatsquarterhebrew=1459,n.hatafqamatswidehebrew=1459,n.hatafsegol=1457,n.hatafsegol17=1457,n.hatafsegol24=1457,n.hatafsegol30=1457,n.hatafsegolhebrew=1457,n.hatafsegolnarrowhebrew=1457,n.hatafsegolquarterhebrew=1457,n.hatafsegolwidehebrew=1457,n.hbar=295,n.hbopomofo=12559,n.hbrevebelow=7723,n.hcedilla=7721,n.hcircle=9431,n.hcircumflex=293,n.hdieresis=7719,n.hdotaccent=7715,n.hdotbelow=7717,n.he=1492,n.heart=9829,n.heartsuitblack=9829,n.heartsuitwhite=9825,n.hedagesh=64308,n.hedageshhebrew=64308,n.hehaltonearabic=1729,n.heharabic=1607,n.hehebrew=1492,n.hehfinalaltonearabic=64423,n.hehfinalalttwoarabic=65258,n.hehfinalarabic=65258,n.hehhamzaabovefinalarabic=64421,n.hehhamzaaboveisolatedarabic=64420,n.hehinitialaltonearabic=64424,n.hehinitialarabic=65259,n.hehiragana=12408,n.hehmedialaltonearabic=64425,n.hehmedialarabic=65260,n.heiseierasquare=13179,n.hekatakana=12504,n.hekatakanahalfwidth=65421,n.hekutaarusquare=13110,n.henghook=615,n.herutusquare=13113,n.het=1495,n.hethebrew=1495,n.hhook=614,n.hhooksuperior=689,n.hieuhacirclekorean=12923,n.hieuhaparenkorean=12827,n.hieuhcirclekorean=12909,n.hieuhkorean=12622,n.hieuhparenkorean=12813,n.hihiragana=12402,n.hikatakana=12498,n.hikatakanahalfwidth=65419,n.hiriq=1460,n.hiriq14=1460,n.hiriq21=1460,n.hiriq2d=1460,n.hiriqhebrew=1460,n.hiriqnarrowhebrew=1460,n.hiriqquarterhebrew=1460,n.hiriqwidehebrew=1460,n.hlinebelow=7830,n.hmonospace=65352,n.hoarmenian=1392,n.hohipthai=3627,n.hohiragana=12411,n.hokatakana=12507,n.hokatakanahalfwidth=65422,n.holam=1465,n.holam19=1465,n.holam26=1465,n.holam32=1465,n.holamhebrew=1465,n.holamnarrowhebrew=1465,n.holamquarterhebrew=1465,n.holamwidehebrew=1465,n.honokhukthai=3630,n.hookabovecomb=777,n.hookcmb=777,n.hookpalatalizedbelowcmb=801,n.hookretroflexbelowcmb=802,n.hoonsquare=13122,n.horicoptic=1001,n.horizontalbar=8213,n.horncmb=795,n.hotsprings=9832,n.house=8962,n.hparen=9379,n.hsuperior=688,n.hturned=613,n.huhiragana=12405,n.huiitosquare=13107,n.hukatakana=12501,n.hukatakanahalfwidth=65420,n.hungarumlaut=733,n.hungarumlautcmb=779,n.hv=405,n.hyphen=45,n.hypheninferior=63205,n.hyphenmonospace=65293,n.hyphensmall=65123,n.hyphensuperior=63206,n.hyphentwo=8208,n.i=105,n.iacute=237,n.iacyrillic=1103,n.ibengali=2439,n.ibopomofo=12583,n.ibreve=301,n.icaron=464,n.icircle=9432,n.icircumflex=238,n.icyrillic=1110,n.idblgrave=521,n.ideographearthcircle=12943,n.ideographfirecircle=12939,n.ideographicallianceparen=12863,n.ideographiccallparen=12858,n.ideographiccentrecircle=12965,n.ideographicclose=12294,n.ideographiccomma=12289,n.ideographiccommaleft=65380,n.ideographiccongratulationparen=12855,n.ideographiccorrectcircle=12963,n.ideographicearthparen=12847,n.ideographicenterpriseparen=12861,n.ideographicexcellentcircle=12957,n.ideographicfestivalparen=12864,n.ideographicfinancialcircle=12950,n.ideographicfinancialparen=12854,n.ideographicfireparen=12843,n.ideographichaveparen=12850,n.ideographichighcircle=12964,n.ideographiciterationmark=12293,n.ideographiclaborcircle=12952,n.ideographiclaborparen=12856,n.ideographicleftcircle=12967,n.ideographiclowcircle=12966,n.ideographicmedicinecircle=12969,n.ideographicmetalparen=12846,n.ideographicmoonparen=12842,n.ideographicnameparen=12852,n.ideographicperiod=12290,n.ideographicprintcircle=12958,n.ideographicreachparen=12867,n.ideographicrepresentparen=12857,n.ideographicresourceparen=12862,n.ideographicrightcircle=12968,n.ideographicsecretcircle=12953,n.ideographicselfparen=12866,n.ideographicsocietyparen=12851,n.ideographicspace=12288,n.ideographicspecialparen=12853,n.ideographicstockparen=12849,n.ideographicstudyparen=12859,n.ideographicsunparen=12848,n.ideographicsuperviseparen=12860,n.ideographicwaterparen=12844,n.ideographicwoodparen=12845,n.ideographiczero=12295,n.ideographmetalcircle=12942,n.ideographmooncircle=12938,n.ideographnamecircle=12948,n.ideographsuncircle=12944,n.ideographwatercircle=12940,n.ideographwoodcircle=12941,n.ideva=2311,n.idieresis=239,n.idieresisacute=7727,n.idieresiscyrillic=1253,n.idotbelow=7883,n.iebrevecyrillic=1239,n.iecyrillic=1077,n.ieungacirclekorean=12917,n.ieungaparenkorean=12821,n.ieungcirclekorean=12903,n.ieungkorean=12615,n.ieungparenkorean=12807,n.igrave=236,n.igujarati=2695,n.igurmukhi=2567,n.ihiragana=12356,n.ihookabove=7881,n.iibengali=2440,n.iicyrillic=1080,n.iideva=2312,n.iigujarati=2696,n.iigurmukhi=2568,n.iimatragurmukhi=2624,n.iinvertedbreve=523,n.iishortcyrillic=1081,n.iivowelsignbengali=2496,n.iivowelsigndeva=2368,n.iivowelsigngujarati=2752,n.ij=307,n.ikatakana=12452,n.ikatakanahalfwidth=65394,n.ikorean=12643,n.ilde=732,n.iluyhebrew=1452,n.imacron=299,n.imacroncyrillic=1251,n.imageorapproximatelyequal=8787,n.imatragurmukhi=2623,n.imonospace=65353,n.increment=8710,n.infinity=8734,n.iniarmenian=1387,n.integral=8747,n.integralbottom=8993,n.integralbt=8993,n.integralex=63733,n.integraltop=8992,n.integraltp=8992,n.intersection=8745,n.intisquare=13061,n.invbullet=9688,n.invcircle=9689,n.invsmileface=9787,n.iocyrillic=1105,n.iogonek=303,n.iota=953,n.iotadieresis=970,n.iotadieresistonos=912,n.iotalatin=617,n.iotatonos=943,n.iparen=9380,n.irigurmukhi=2674,n.ismallhiragana=12355,n.ismallkatakana=12451,n.ismallkatakanahalfwidth=65384,n.issharbengali=2554,n.istroke=616,n.isuperior=63213,n.iterationhiragana=12445,n.iterationkatakana=12541,n.itilde=297,n.itildebelow=7725,n.iubopomofo=12585,n.iucyrillic=1102,n.ivowelsignbengali=2495,n.ivowelsigndeva=2367,n.ivowelsigngujarati=2751,n.izhitsacyrillic=1141,n.izhitsadblgravecyrillic=1143,n.j=106,n.jaarmenian=1393,n.jabengali=2460,n.jadeva=2332,n.jagujarati=2716,n.jagurmukhi=2588,n.jbopomofo=12560,n.jcaron=496,n.jcircle=9433,n.jcircumflex=309,n.jcrossedtail=669,n.jdotlessstroke=607,n.jecyrillic=1112,n.jeemarabic=1580,n.jeemfinalarabic=65182,n.jeeminitialarabic=65183,n.jeemmedialarabic=65184,n.jeharabic=1688,n.jehfinalarabic=64395,n.jhabengali=2461,n.jhadeva=2333,n.jhagujarati=2717,n.jhagurmukhi=2589,n.jheharmenian=1403,n.jis=12292,n.jmonospace=65354,n.jparen=9381,n.jsuperior=690,n.k=107,n.kabashkircyrillic=1185,n.kabengali=2453,n.kacute=7729,n.kacyrillic=1082,n.kadescendercyrillic=1179,n.kadeva=2325,n.kaf=1499,n.kafarabic=1603,n.kafdagesh=64315,n.kafdageshhebrew=64315,n.kaffinalarabic=65242,n.kafhebrew=1499,n.kafinitialarabic=65243,n.kafmedialarabic=65244,n.kafrafehebrew=64333,n.kagujarati=2709,n.kagurmukhi=2581,n.kahiragana=12363,n.kahookcyrillic=1220,n.kakatakana=12459,n.kakatakanahalfwidth=65398,n.kappa=954,n.kappasymbolgreek=1008,n.kapyeounmieumkorean=12657,n.kapyeounphieuphkorean=12676,n.kapyeounpieupkorean=12664,n.kapyeounssangpieupkorean=12665,n.karoriisquare=13069,n.kashidaautoarabic=1600,n.kashidaautonosidebearingarabic=1600,n.kasmallkatakana=12533,n.kasquare=13188,n.kasraarabic=1616,n.kasratanarabic=1613,n.kastrokecyrillic=1183,n.katahiraprolongmarkhalfwidth=65392,n.kaverticalstrokecyrillic=1181,n.kbopomofo=12558,n.kcalsquare=13193,n.kcaron=489,n.kcedilla=311,n.kcircle=9434,n.kcommaaccent=311,n.kdotbelow=7731,n.keharmenian=1412,n.kehiragana=12369,n.kekatakana=12465,n.kekatakanahalfwidth=65401,n.kenarmenian=1391,n.kesmallkatakana=12534,n.kgreenlandic=312,n.khabengali=2454,n.khacyrillic=1093,n.khadeva=2326,n.khagujarati=2710,n.khagurmukhi=2582,n.khaharabic=1582,n.khahfinalarabic=65190,n.khahinitialarabic=65191,n.khahmedialarabic=65192,n.kheicoptic=999,n.khhadeva=2393,n.khhagurmukhi=2649,n.khieukhacirclekorean=12920,n.khieukhaparenkorean=12824,n.khieukhcirclekorean=12906,n.khieukhkorean=12619,n.khieukhparenkorean=12810,n.khokhaithai=3586,n.khokhonthai=3589,n.khokhuatthai=3587,n.khokhwaithai=3588,n.khomutthai=3675,n.khook=409,n.khorakhangthai=3590,n.khzsquare=13201,n.kihiragana=12365,n.kikatakana=12461,n.kikatakanahalfwidth=65399,n.kiroguramusquare=13077,n.kiromeetorusquare=13078,n.kirosquare=13076,n.kiyeokacirclekorean=12910,n.kiyeokaparenkorean=12814,n.kiyeokcirclekorean=12896,n.kiyeokkorean=12593,n.kiyeokparenkorean=12800,n.kiyeoksioskorean=12595,n.kjecyrillic=1116,n.klinebelow=7733,n.klsquare=13208,n.kmcubedsquare=13222,n.kmonospace=65355,n.kmsquaredsquare=13218,n.kohiragana=12371,n.kohmsquare=13248,n.kokaithai=3585,n.kokatakana=12467,n.kokatakanahalfwidth=65402,n.kooposquare=13086,n.koppacyrillic=1153,n.koreanstandardsymbol=12927,n.koroniscmb=835,n.kparen=9382,n.kpasquare=13226,n.ksicyrillic=1135,n.ktsquare=13263,n.kturned=670,n.kuhiragana=12367,n.kukatakana=12463,n.kukatakanahalfwidth=65400,n.kvsquare=13240,n.kwsquare=13246,n.l=108,n.labengali=2482,n.lacute=314,n.ladeva=2354,n.lagujarati=2738,n.lagurmukhi=2610,n.lakkhangyaothai=3653,n.lamaleffinalarabic=65276,n.lamalefhamzaabovefinalarabic=65272,n.lamalefhamzaaboveisolatedarabic=65271,n.lamalefhamzabelowfinalarabic=65274,n.lamalefhamzabelowisolatedarabic=65273,n.lamalefisolatedarabic=65275,n.lamalefmaddaabovefinalarabic=65270,n.lamalefmaddaaboveisolatedarabic=65269,n.lamarabic=1604,n.lambda=955,n.lambdastroke=411,n.lamed=1500,n.lameddagesh=64316,n.lameddageshhebrew=64316,n.lamedhebrew=1500,n.lamfinalarabic=65246,n.lamhahinitialarabic=64714,n.laminitialarabic=65247,n.lamjeeminitialarabic=64713,n.lamkhahinitialarabic=64715,n.lamlamhehisolatedarabic=65010,n.lammedialarabic=65248,n.lammeemhahinitialarabic=64904,n.lammeeminitialarabic=64716,n.largecircle=9711,n.lbar=410,n.lbelt=620,n.lbopomofo=12556,n.lcaron=318,n.lcedilla=316,n.lcircle=9435,n.lcircumflexbelow=7741,n.lcommaaccent=316,n.ldot=320,n.ldotaccent=320,n.ldotbelow=7735,n.ldotbelowmacron=7737,n.leftangleabovecmb=794,n.lefttackbelowcmb=792,n.less=60,n.lessequal=8804,n.lessequalorgreater=8922,n.lessmonospace=65308,n.lessorequivalent=8818,n.lessorgreater=8822,n.lessoverequal=8806,n.lesssmall=65124,n.lezh=622,n.lfblock=9612,n.lhookretroflex=621,n.lira=8356,n.liwnarmenian=1388,n.lj=457,n.ljecyrillic=1113,n.ll=63168,n.lladeva=2355,n.llagujarati=2739,n.llinebelow=7739,n.llladeva=2356,n.llvocalicbengali=2529,n.llvocalicdeva=2401,n.llvocalicvowelsignbengali=2531,n.llvocalicvowelsigndeva=2403,n.lmiddletilde=619,n.lmonospace=65356,n.lmsquare=13264,n.lochulathai=3628,n.logicaland=8743,n.logicalnot=172,n.logicalnotreversed=8976,n.logicalor=8744,n.lolingthai=3621,n.longs=383,n.lowlinecenterline=65102,n.lowlinecmb=818,n.lowlinedashed=65101,n.lozenge=9674,n.lparen=9383,n.lslash=322,n.lsquare=8467,n.lsuperior=63214,n.ltshade=9617,n.luthai=3622,n.lvocalicbengali=2444,n.lvocalicdeva=2316,n.lvocalicvowelsignbengali=2530,n.lvocalicvowelsigndeva=2402,n.lxsquare=13267,n.m=109,n.mabengali=2478,n.macron=175,n.macronbelowcmb=817,n.macroncmb=772,n.macronlowmod=717,n.macronmonospace=65507,n.macute=7743,n.madeva=2350,n.magujarati=2734,n.magurmukhi=2606,n.mahapakhhebrew=1444,n.mahapakhlefthebrew=1444,n.mahiragana=12414,n.maichattawalowleftthai=63637,n.maichattawalowrightthai=63636,n.maichattawathai=3659,n.maichattawaupperleftthai=63635,n.maieklowleftthai=63628,n.maieklowrightthai=63627,n.maiekthai=3656,n.maiekupperleftthai=63626,n.maihanakatleftthai=63620,n.maihanakatthai=3633,n.maitaikhuleftthai=63625,n.maitaikhuthai=3655,n.maitholowleftthai=63631,n.maitholowrightthai=63630,n.maithothai=3657,n.maithoupperleftthai=63629,n.maitrilowleftthai=63634,n.maitrilowrightthai=63633,n.maitrithai=3658,n.maitriupperleftthai=63632,n.maiyamokthai=3654,n.makatakana=12510,n.makatakanahalfwidth=65423,n.male=9794,n.mansyonsquare=13127,n.maqafhebrew=1470,n.mars=9794,n.masoracirclehebrew=1455,n.masquare=13187,n.mbopomofo=12551,n.mbsquare=13268,n.mcircle=9436,n.mcubedsquare=13221,n.mdotaccent=7745,n.mdotbelow=7747,n.meemarabic=1605,n.meemfinalarabic=65250,n.meeminitialarabic=65251,n.meemmedialarabic=65252,n.meemmeeminitialarabic=64721,n.meemmeemisolatedarabic=64584,n.meetorusquare=13133,n.mehiragana=12417,n.meizierasquare=13182,n.mekatakana=12513,n.mekatakanahalfwidth=65426,n.mem=1502,n.memdagesh=64318,n.memdageshhebrew=64318,n.memhebrew=1502,n.menarmenian=1396,n.merkhahebrew=1445,n.merkhakefulahebrew=1446,n.merkhakefulalefthebrew=1446,n.merkhalefthebrew=1445,n.mhook=625,n.mhzsquare=13202,n.middledotkatakanahalfwidth=65381,n.middot=183,n.mieumacirclekorean=12914,n.mieumaparenkorean=12818,n.mieumcirclekorean=12900,n.mieumkorean=12609,n.mieumpansioskorean=12656,n.mieumparenkorean=12804,n.mieumpieupkorean=12654,n.mieumsioskorean=12655,n.mihiragana=12415,n.mikatakana=12511,n.mikatakanahalfwidth=65424,n.minus=8722,n.minusbelowcmb=800,n.minuscircle=8854,n.minusmod=727,n.minusplus=8723,n.minute=8242,n.miribaarusquare=13130,n.mirisquare=13129,n.mlonglegturned=624,n.mlsquare=13206,n.mmcubedsquare=13219,n.mmonospace=65357,n.mmsquaredsquare=13215,n.mohiragana=12418,n.mohmsquare=13249,n.mokatakana=12514,n.mokatakanahalfwidth=65427,n.molsquare=13270,n.momathai=3617,n.moverssquare=13223,n.moverssquaredsquare=13224,n.mparen=9384,n.mpasquare=13227,n.mssquare=13235,n.msuperior=63215,n.mturned=623,n.mu=181,n.mu1=181,n.muasquare=13186,n.muchgreater=8811,n.muchless=8810,n.mufsquare=13196,n.mugreek=956,n.mugsquare=13197,n.muhiragana=12416,n.mukatakana=12512,n.mukatakanahalfwidth=65425,n.mulsquare=13205,n.multiply=215,n.mumsquare=13211,n.munahhebrew=1443,n.munahlefthebrew=1443,n.musicalnote=9834,n.musicalnotedbl=9835,n.musicflatsign=9837,n.musicsharpsign=9839,n.mussquare=13234,n.muvsquare=13238,n.muwsquare=13244,n.mvmegasquare=13241,n.mvsquare=13239,n.mwmegasquare=13247,n.mwsquare=13245,n.n=110,n.nabengali=2472,n.nabla=8711,n.nacute=324,n.nadeva=2344,n.nagujarati=2728,n.nagurmukhi=2600,n.nahiragana=12394,n.nakatakana=12490,n.nakatakanahalfwidth=65413,n.napostrophe=329,n.nasquare=13185,n.nbopomofo=12555,n.nbspace=160,n.ncaron=328,n.ncedilla=326,n.ncircle=9437,n.ncircumflexbelow=7755,n.ncommaaccent=326,n.ndotaccent=7749,n.ndotbelow=7751,n.nehiragana=12397,n.nekatakana=12493,n.nekatakanahalfwidth=65416,n.newsheqelsign=8362,n.nfsquare=13195,n.ngabengali=2457,n.ngadeva=2329,n.ngagujarati=2713,n.ngagurmukhi=2585,n.ngonguthai=3591,n.nhiragana=12435,n.nhookleft=626,n.nhookretroflex=627,n.nieunacirclekorean=12911,n.nieunaparenkorean=12815,n.nieuncieuckorean=12597,n.nieuncirclekorean=12897,n.nieunhieuhkorean=12598,n.nieunkorean=12596,n.nieunpansioskorean=12648,n.nieunparenkorean=12801,n.nieunsioskorean=12647,n.nieuntikeutkorean=12646,n.nihiragana=12395,n.nikatakana=12491,n.nikatakanahalfwidth=65414,n.nikhahitleftthai=63641,n.nikhahitthai=3661,n.nine=57,n.ninearabic=1641,n.ninebengali=2543,n.ninecircle=9320,n.ninecircleinversesansserif=10130,n.ninedeva=2415,n.ninegujarati=2799,n.ninegurmukhi=2671,n.ninehackarabic=1641,n.ninehangzhou=12329,n.nineideographicparen=12840,n.nineinferior=8329,n.ninemonospace=65305,n.nineoldstyle=63289,n.nineparen=9340,n.nineperiod=9360,n.ninepersian=1785,n.nineroman=8568,n.ninesuperior=8313,n.nineteencircle=9330,n.nineteenparen=9350,n.nineteenperiod=9370,n.ninethai=3673,n.nj=460,n.njecyrillic=1114,n.nkatakana=12531,n.nkatakanahalfwidth=65437,n.nlegrightlong=414,n.nlinebelow=7753,n.nmonospace=65358,n.nmsquare=13210,n.nnabengali=2467,n.nnadeva=2339,n.nnagujarati=2723,n.nnagurmukhi=2595,n.nnnadeva=2345,n.nohiragana=12398,n.nokatakana=12494,n.nokatakanahalfwidth=65417,n.nonbreakingspace=160,n.nonenthai=3603,n.nonuthai=3609,n.noonarabic=1606,n.noonfinalarabic=65254,n.noonghunnaarabic=1722,n.noonghunnafinalarabic=64415,n.nooninitialarabic=65255,n.noonjeeminitialarabic=64722,n.noonjeemisolatedarabic=64587,n.noonmedialarabic=65256,n.noonmeeminitialarabic=64725,n.noonmeemisolatedarabic=64590,n.noonnoonfinalarabic=64653,n.notcontains=8716,n.notelement=8713,n.notelementof=8713,n.notequal=8800,n.notgreater=8815,n.notgreaternorequal=8817,n.notgreaternorless=8825,n.notidentical=8802,n.notless=8814,n.notlessnorequal=8816,n.notparallel=8742,n.notprecedes=8832,n.notsubset=8836,n.notsucceeds=8833,n.notsuperset=8837,n.nowarmenian=1398,n.nparen=9385,n.nssquare=13233,n.nsuperior=8319,n.ntilde=241,n.nu=957,n.nuhiragana=12396,n.nukatakana=12492,n.nukatakanahalfwidth=65415,n.nuktabengali=2492,n.nuktadeva=2364,n.nuktagujarati=2748,n.nuktagurmukhi=2620,n.numbersign=35,n.numbersignmonospace=65283,n.numbersignsmall=65119,n.numeralsigngreek=884,n.numeralsignlowergreek=885,n.numero=8470,n.nun=1504,n.nundagesh=64320,n.nundageshhebrew=64320,n.nunhebrew=1504,n.nvsquare=13237,n.nwsquare=13243,n.nyabengali=2462,n.nyadeva=2334,n.nyagujarati=2718,n.nyagurmukhi=2590,n.o=111,n.oacute=243,n.oangthai=3629,n.obarred=629,n.obarredcyrillic=1257,n.obarreddieresiscyrillic=1259,n.obengali=2451,n.obopomofo=12571,n.obreve=335,n.ocandradeva=2321,n.ocandragujarati=2705,n.ocandravowelsigndeva=2377,n.ocandravowelsigngujarati=2761,n.ocaron=466,n.ocircle=9438,n.ocircumflex=244,n.ocircumflexacute=7889,n.ocircumflexdotbelow=7897,n.ocircumflexgrave=7891,n.ocircumflexhookabove=7893,n.ocircumflextilde=7895,n.ocyrillic=1086,n.odblacute=337,n.odblgrave=525,n.odeva=2323,n.odieresis=246,n.odieresiscyrillic=1255,n.odotbelow=7885,n.oe=339,n.oekorean=12634,n.ogonek=731,n.ogonekcmb=808,n.ograve=242,n.ogujarati=2707,n.oharmenian=1413,n.ohiragana=12362,n.ohookabove=7887,n.ohorn=417,n.ohornacute=7899,n.ohorndotbelow=7907,n.ohorngrave=7901,n.ohornhookabove=7903,n.ohorntilde=7905,n.ohungarumlaut=337,n.oi=419,n.oinvertedbreve=527,n.okatakana=12458,n.okatakanahalfwidth=65397,n.okorean=12631,n.olehebrew=1451,n.omacron=333,n.omacronacute=7763,n.omacrongrave=7761,n.omdeva=2384,n.omega=969,n.omega1=982,n.omegacyrillic=1121,n.omegalatinclosed=631,n.omegaroundcyrillic=1147,n.omegatitlocyrillic=1149,n.omegatonos=974,n.omgujarati=2768,n.omicron=959,n.omicrontonos=972,n.omonospace=65359,n.one=49,n.onearabic=1633,n.onebengali=2535,n.onecircle=9312,n.onecircleinversesansserif=10122,n.onedeva=2407,n.onedotenleader=8228,n.oneeighth=8539,n.onefitted=63196,n.onegujarati=2791,n.onegurmukhi=2663,n.onehackarabic=1633,n.onehalf=189,n.onehangzhou=12321,n.oneideographicparen=12832,n.oneinferior=8321,n.onemonospace=65297,n.onenumeratorbengali=2548,n.oneoldstyle=63281,n.oneparen=9332,n.oneperiod=9352,n.onepersian=1777,n.onequarter=188,n.oneroman=8560,n.onesuperior=185,n.onethai=3665,n.onethird=8531,n.oogonek=491,n.oogonekmacron=493,n.oogurmukhi=2579,n.oomatragurmukhi=2635,n.oopen=596,n.oparen=9386,n.openbullet=9702,n.option=8997,n.ordfeminine=170,n.ordmasculine=186,n.orthogonal=8735,n.oshortdeva=2322,n.oshortvowelsigndeva=2378,n.oslash=248,n.oslashacute=511,n.osmallhiragana=12361,n.osmallkatakana=12457,n.osmallkatakanahalfwidth=65387,n.ostrokeacute=511,n.osuperior=63216,n.otcyrillic=1151,n.otilde=245,n.otildeacute=7757,n.otildedieresis=7759,n.oubopomofo=12577,n.overline=8254,n.overlinecenterline=65098,n.overlinecmb=773,n.overlinedashed=65097,n.overlinedblwavy=65100,n.overlinewavy=65099,n.overscore=175,n.ovowelsignbengali=2507,n.ovowelsigndeva=2379,n.ovowelsigngujarati=2763,n.p=112,n.paampssquare=13184,n.paasentosquare=13099,n.pabengali=2474,n.pacute=7765,n.padeva=2346,n.pagedown=8671,n.pageup=8670,n.pagujarati=2730,n.pagurmukhi=2602,n.pahiragana=12401,n.paiyannoithai=3631,n.pakatakana=12497,n.palatalizationcyrilliccmb=1156,n.palochkacyrillic=1216,n.pansioskorean=12671,n.paragraph=182,n.parallel=8741,n.parenleft=40,n.parenleftaltonearabic=64830,n.parenleftbt=63725,n.parenleftex=63724,n.parenleftinferior=8333,n.parenleftmonospace=65288,n.parenleftsmall=65113,n.parenleftsuperior=8317,n.parenlefttp=63723,n.parenleftvertical=65077,n.parenright=41,n.parenrightaltonearabic=64831,n.parenrightbt=63736,n.parenrightex=63735,n.parenrightinferior=8334,n.parenrightmonospace=65289,n.parenrightsmall=65114,n.parenrightsuperior=8318,n.parenrighttp=63734,n.parenrightvertical=65078,n.partialdiff=8706,n.paseqhebrew=1472,n.pashtahebrew=1433,n.pasquare=13225,n.patah=1463,n.patah11=1463,n.patah1d=1463,n.patah2a=1463,n.patahhebrew=1463,n.patahnarrowhebrew=1463,n.patahquarterhebrew=1463,n.patahwidehebrew=1463,n.pazerhebrew=1441,n.pbopomofo=12550,n.pcircle=9439,n.pdotaccent=7767,n.pe=1508,n.pecyrillic=1087,n.pedagesh=64324,n.pedageshhebrew=64324,n.peezisquare=13115,n.pefinaldageshhebrew=64323,n.peharabic=1662,n.peharmenian=1402,n.pehebrew=1508,n.pehfinalarabic=64343,n.pehinitialarabic=64344,n.pehiragana=12410,n.pehmedialarabic=64345,n.pekatakana=12506,n.pemiddlehookcyrillic=1191,n.perafehebrew=64334,n.percent=37,n.percentarabic=1642,n.percentmonospace=65285,n.percentsmall=65130,n.period=46,n.periodarmenian=1417,n.periodcentered=183,n.periodhalfwidth=65377,n.periodinferior=63207,n.periodmonospace=65294,n.periodsmall=65106,n.periodsuperior=63208,n.perispomenigreekcmb=834,n.perpendicular=8869,n.perthousand=8240,n.peseta=8359,n.pfsquare=13194,n.phabengali=2475,n.phadeva=2347,n.phagujarati=2731,n.phagurmukhi=2603,n.phi=966,n.phi1=981,n.phieuphacirclekorean=12922,n.phieuphaparenkorean=12826,n.phieuphcirclekorean=12908,n.phieuphkorean=12621,n.phieuphparenkorean=12812,n.philatin=632,n.phinthuthai=3642,n.phisymbolgreek=981,n.phook=421,n.phophanthai=3614,n.phophungthai=3612,n.phosamphaothai=3616,n.pi=960,n.pieupacirclekorean=12915,n.pieupaparenkorean=12819,n.pieupcieuckorean=12662,n.pieupcirclekorean=12901,n.pieupkiyeokkorean=12658,n.pieupkorean=12610,n.pieupparenkorean=12805,n.pieupsioskiyeokkorean=12660,n.pieupsioskorean=12612,n.pieupsiostikeutkorean=12661,n.pieupthieuthkorean=12663,n.pieuptikeutkorean=12659,n.pihiragana=12404,n.pikatakana=12500,n.pisymbolgreek=982,n.piwrarmenian=1411,n.planckover2pi=8463,n.planckover2pi1=8463,n.plus=43,n.plusbelowcmb=799,n.pluscircle=8853,n.plusminus=177,n.plusmod=726,n.plusmonospace=65291,n.plussmall=65122,n.plussuperior=8314,n.pmonospace=65360,n.pmsquare=13272,n.pohiragana=12413,n.pointingindexdownwhite=9759,n.pointingindexleftwhite=9756,n.pointingindexrightwhite=9758,n.pointingindexupwhite=9757,n.pokatakana=12509,n.poplathai=3611,n.postalmark=12306,n.postalmarkface=12320,n.pparen=9387,n.precedes=8826,n.prescription=8478,n.primemod=697,n.primereversed=8245,n.product=8719,n.projective=8965,n.prolongedkana=12540,n.propellor=8984,n.propersubset=8834,n.propersuperset=8835,n.proportion=8759,n.proportional=8733,n.psi=968,n.psicyrillic=1137,n.psilipneumatacyrilliccmb=1158,n.pssquare=13232,n.puhiragana=12407,n.pukatakana=12503,n.pvsquare=13236,n.pwsquare=13242,n.q=113,n.qadeva=2392,n.qadmahebrew=1448,n.qafarabic=1602,n.qaffinalarabic=65238,n.qafinitialarabic=65239,n.qafmedialarabic=65240,n.qamats=1464,n.qamats10=1464,n.qamats1a=1464,n.qamats1c=1464,n.qamats27=1464,n.qamats29=1464,n.qamats33=1464,n.qamatsde=1464,n.qamatshebrew=1464,n.qamatsnarrowhebrew=1464,n.qamatsqatanhebrew=1464,n.qamatsqatannarrowhebrew=1464,n.qamatsqatanquarterhebrew=1464,n.qamatsqatanwidehebrew=1464,n.qamatsquarterhebrew=1464,n.qamatswidehebrew=1464,n.qarneyparahebrew=1439,n.qbopomofo=12561,n.qcircle=9440,n.qhook=672,n.qmonospace=65361,n.qof=1511,n.qofdagesh=64327,n.qofdageshhebrew=64327,n.qofhebrew=1511,n.qparen=9388,n.quarternote=9833,n.qubuts=1467,n.qubuts18=1467,n.qubuts25=1467,n.qubuts31=1467,n.qubutshebrew=1467,n.qubutsnarrowhebrew=1467,n.qubutsquarterhebrew=1467,n.qubutswidehebrew=1467,n.question=63,n.questionarabic=1567,n.questionarmenian=1374,n.questiondown=191,n.questiondownsmall=63423,n.questiongreek=894,n.questionmonospace=65311,n.questionsmall=63295,n.quotedbl=34,n.quotedblbase=8222,n.quotedblleft=8220,n.quotedblmonospace=65282,n.quotedblprime=12318,n.quotedblprimereversed=12317,n.quotedblright=8221,n.quoteleft=8216,n.quoteleftreversed=8219,n.quotereversed=8219,n.quoteright=8217,n.quoterightn=329,n.quotesinglbase=8218,n.quotesingle=39,n.quotesinglemonospace=65287,n.r=114,n.raarmenian=1404,n.rabengali=2480,n.racute=341,n.radeva=2352,n.radical=8730,n.radicalex=63717,n.radoverssquare=13230,n.radoverssquaredsquare=13231,n.radsquare=13229,n.rafe=1471,n.rafehebrew=1471,n.ragujarati=2736,n.ragurmukhi=2608,n.rahiragana=12425,n.rakatakana=12521,n.rakatakanahalfwidth=65431,n.ralowerdiagonalbengali=2545,n.ramiddlediagonalbengali=2544,n.ramshorn=612,n.ratio=8758,n.rbopomofo=12566,n.rcaron=345,n.rcedilla=343,n.rcircle=9441,n.rcommaaccent=343,n.rdblgrave=529,n.rdotaccent=7769,n.rdotbelow=7771,n.rdotbelowmacron=7773,n.referencemark=8251,n.reflexsubset=8838,n.reflexsuperset=8839,n.registered=174,n.registersans=63720,n.registerserif=63194,n.reharabic=1585,n.reharmenian=1408,n.rehfinalarabic=65198,n.rehiragana=12428,n.rekatakana=12524,n.rekatakanahalfwidth=65434,n.resh=1512,n.reshdageshhebrew=64328,n.reshhebrew=1512,n.reversedtilde=8765,n.reviahebrew=1431,n.reviamugrashhebrew=1431,n.revlogicalnot=8976,n.rfishhook=638,n.rfishhookreversed=639,n.rhabengali=2525,n.rhadeva=2397,n.rho=961,n.rhook=637,n.rhookturned=635,n.rhookturnedsuperior=693,n.rhosymbolgreek=1009,n.rhotichookmod=734,n.rieulacirclekorean=12913,n.rieulaparenkorean=12817,n.rieulcirclekorean=12899,n.rieulhieuhkorean=12608,n.rieulkiyeokkorean=12602,n.rieulkiyeoksioskorean=12649,n.rieulkorean=12601,n.rieulmieumkorean=12603,n.rieulpansioskorean=12652,n.rieulparenkorean=12803,n.rieulphieuphkorean=12607,n.rieulpieupkorean=12604,n.rieulpieupsioskorean=12651,n.rieulsioskorean=12605,n.rieulthieuthkorean=12606,n.rieultikeutkorean=12650,n.rieulyeorinhieuhkorean=12653,n.rightangle=8735,n.righttackbelowcmb=793,n.righttriangle=8895,n.rihiragana=12426,n.rikatakana=12522,n.rikatakanahalfwidth=65432,n.ring=730,n.ringbelowcmb=805,n.ringcmb=778,n.ringhalfleft=703,n.ringhalfleftarmenian=1369,n.ringhalfleftbelowcmb=796,n.ringhalfleftcentered=723,n.ringhalfright=702,n.ringhalfrightbelowcmb=825,n.ringhalfrightcentered=722,n.rinvertedbreve=531,n.rittorusquare=13137,n.rlinebelow=7775,n.rlongleg=636,n.rlonglegturned=634,n.rmonospace=65362,n.rohiragana=12429,n.rokatakana=12525,n.rokatakanahalfwidth=65435,n.roruathai=3619,n.rparen=9389,n.rrabengali=2524,n.rradeva=2353,n.rragurmukhi=2652,n.rreharabic=1681,n.rrehfinalarabic=64397,n.rrvocalicbengali=2528,n.rrvocalicdeva=2400,n.rrvocalicgujarati=2784,n.rrvocalicvowelsignbengali=2500,n.rrvocalicvowelsigndeva=2372,n.rrvocalicvowelsigngujarati=2756,n.rsuperior=63217,n.rtblock=9616,n.rturned=633,n.rturnedsuperior=692,n.ruhiragana=12427,n.rukatakana=12523,n.rukatakanahalfwidth=65433,n.rupeemarkbengali=2546,n.rupeesignbengali=2547,n.rupiah=63197,n.ruthai=3620,n.rvocalicbengali=2443,n.rvocalicdeva=2315,n.rvocalicgujarati=2699,n.rvocalicvowelsignbengali=2499,n.rvocalicvowelsigndeva=2371,n.rvocalicvowelsigngujarati=2755,n.s=115,n.sabengali=2488,n.sacute=347,n.sacutedotaccent=7781,n.sadarabic=1589,n.sadeva=2360,n.sadfinalarabic=65210,n.sadinitialarabic=65211,n.sadmedialarabic=65212,n.sagujarati=2744,n.sagurmukhi=2616,n.sahiragana=12373,n.sakatakana=12469,n.sakatakanahalfwidth=65403,n.sallallahoualayhewasallamarabic=65018,n.samekh=1505,n.samekhdagesh=64321,n.samekhdageshhebrew=64321,n.samekhhebrew=1505,n.saraaathai=3634,n.saraaethai=3649,n.saraaimaimalaithai=3652,n.saraaimaimuanthai=3651,n.saraamthai=3635,n.saraathai=3632,n.saraethai=3648,n.saraiileftthai=63622,n.saraiithai=3637,n.saraileftthai=63621,n.saraithai=3636,n.saraothai=3650,n.saraueeleftthai=63624,n.saraueethai=3639,n.saraueleftthai=63623,n.sarauethai=3638,n.sarauthai=3640,n.sarauuthai=3641,n.sbopomofo=12569,n.scaron=353,n.scarondotaccent=7783,n.scedilla=351,n.schwa=601,n.schwacyrillic=1241,n.schwadieresiscyrillic=1243,n.schwahook=602,n.scircle=9442,n.scircumflex=349,n.scommaaccent=537,n.sdotaccent=7777,n.sdotbelow=7779,n.sdotbelowdotaccent=7785,n.seagullbelowcmb=828,n.second=8243,n.secondtonechinese=714,n.section=167,n.seenarabic=1587,n.seenfinalarabic=65202,n.seeninitialarabic=65203,n.seenmedialarabic=65204,n.segol=1462,n.segol13=1462,n.segol1f=1462,n.segol2c=1462,n.segolhebrew=1462,n.segolnarrowhebrew=1462,n.segolquarterhebrew=1462,n.segoltahebrew=1426,n.segolwidehebrew=1462,n.seharmenian=1405,n.sehiragana=12379,n.sekatakana=12475,n.sekatakanahalfwidth=65406,n.semicolon=59,n.semicolonarabic=1563,n.semicolonmonospace=65307,n.semicolonsmall=65108,n.semivoicedmarkkana=12444,n.semivoicedmarkkanahalfwidth=65439,n.sentisquare=13090,n.sentosquare=13091,n.seven=55,n.sevenarabic=1639,n.sevenbengali=2541,n.sevencircle=9318,n.sevencircleinversesansserif=10128,n.sevendeva=2413,n.seveneighths=8542,n.sevengujarati=2797,n.sevengurmukhi=2669,n.sevenhackarabic=1639,n.sevenhangzhou=12327,n.sevenideographicparen=12838,n.seveninferior=8327,n.sevenmonospace=65303,n.sevenoldstyle=63287,n.sevenparen=9338,n.sevenperiod=9358,n.sevenpersian=1783,n.sevenroman=8566,n.sevensuperior=8311,n.seventeencircle=9328,n.seventeenparen=9348,n.seventeenperiod=9368,n.seventhai=3671,n.sfthyphen=173,n.shaarmenian=1399,n.shabengali=2486,n.shacyrillic=1096,n.shaddaarabic=1617,n.shaddadammaarabic=64609,n.shaddadammatanarabic=64606,n.shaddafathaarabic=64608,n.shaddakasraarabic=64610,n.shaddakasratanarabic=64607,n.shade=9618,n.shadedark=9619,n.shadelight=9617,n.shademedium=9618,n.shadeva=2358,n.shagujarati=2742,n.shagurmukhi=2614,n.shalshelethebrew=1427,n.shbopomofo=12565,n.shchacyrillic=1097,n.sheenarabic=1588,n.sheenfinalarabic=65206,n.sheeninitialarabic=65207,n.sheenmedialarabic=65208,n.sheicoptic=995,n.sheqel=8362,n.sheqelhebrew=8362,n.sheva=1456,n.sheva115=1456,n.sheva15=1456,n.sheva22=1456,n.sheva2e=1456,n.shevahebrew=1456,n.shevanarrowhebrew=1456,n.shevaquarterhebrew=1456,n.shevawidehebrew=1456,n.shhacyrillic=1211,n.shimacoptic=1005,n.shin=1513,n.shindagesh=64329,n.shindageshhebrew=64329,n.shindageshshindot=64300,n.shindageshshindothebrew=64300,n.shindageshsindot=64301,n.shindageshsindothebrew=64301,n.shindothebrew=1473,n.shinhebrew=1513,n.shinshindot=64298,n.shinshindothebrew=64298,n.shinsindot=64299,n.shinsindothebrew=64299,n.shook=642,n.sigma=963,n.sigma1=962,n.sigmafinal=962,n.sigmalunatesymbolgreek=1010,n.sihiragana=12375,n.sikatakana=12471,n.sikatakanahalfwidth=65404,n.siluqhebrew=1469,n.siluqlefthebrew=1469,n.similar=8764,n.sindothebrew=1474,n.siosacirclekorean=12916,n.siosaparenkorean=12820,n.sioscieuckorean=12670,n.sioscirclekorean=12902,n.sioskiyeokkorean=12666,n.sioskorean=12613,n.siosnieunkorean=12667,n.siosparenkorean=12806,n.siospieupkorean=12669,n.siostikeutkorean=12668,n.six=54,n.sixarabic=1638,n.sixbengali=2540,n.sixcircle=9317,n.sixcircleinversesansserif=10127,n.sixdeva=2412,n.sixgujarati=2796,n.sixgurmukhi=2668,n.sixhackarabic=1638,n.sixhangzhou=12326,n.sixideographicparen=12837,n.sixinferior=8326,n.sixmonospace=65302,n.sixoldstyle=63286,n.sixparen=9337,n.sixperiod=9357,n.sixpersian=1782,n.sixroman=8565,n.sixsuperior=8310,n.sixteencircle=9327,n.sixteencurrencydenominatorbengali=2553,n.sixteenparen=9347,n.sixteenperiod=9367,n.sixthai=3670,n.slash=47,n.slashmonospace=65295,n.slong=383,n.slongdotaccent=7835,n.smileface=9786,n.smonospace=65363,n.sofpasuqhebrew=1475,n.softhyphen=173,n.softsigncyrillic=1100,n.sohiragana=12381,n.sokatakana=12477,n.sokatakanahalfwidth=65407,n.soliduslongoverlaycmb=824,n.solidusshortoverlaycmb=823,n.sorusithai=3625,n.sosalathai=3624,n.sosothai=3595,n.sosuathai=3626,n.space=32,n.spacehackarabic=32,n.spade=9824,n.spadesuitblack=9824,n.spadesuitwhite=9828,n.sparen=9390,n.squarebelowcmb=827,n.squarecc=13252,n.squarecm=13213,n.squarediagonalcrosshatchfill=9641,n.squarehorizontalfill=9636,n.squarekg=13199,n.squarekm=13214,n.squarekmcapital=13262,n.squareln=13265,n.squarelog=13266,n.squaremg=13198,n.squaremil=13269,n.squaremm=13212,n.squaremsquared=13217,n.squareorthogonalcrosshatchfill=9638,n.squareupperlefttolowerrightfill=9639,n.squareupperrighttolowerleftfill=9640,n.squareverticalfill=9637,n.squarewhitewithsmallblack=9635,n.srsquare=13275,n.ssabengali=2487,n.ssadeva=2359,n.ssagujarati=2743,n.ssangcieuckorean=12617,n.ssanghieuhkorean=12677,n.ssangieungkorean=12672,n.ssangkiyeokkorean=12594,n.ssangnieunkorean=12645,n.ssangpieupkorean=12611,n.ssangsioskorean=12614,n.ssangtikeutkorean=12600,n.ssuperior=63218,n.sterling=163,n.sterlingmonospace=65505,n.strokelongoverlaycmb=822,n.strokeshortoverlaycmb=821,n.subset=8834,n.subsetnotequal=8842,n.subsetorequal=8838,n.succeeds=8827,n.suchthat=8715,n.suhiragana=12377,n.sukatakana=12473,n.sukatakanahalfwidth=65405,n.sukunarabic=1618,n.summation=8721,n.sun=9788,n.superset=8835,n.supersetnotequal=8843,n.supersetorequal=8839,n.svsquare=13276,n.syouwaerasquare=13180,n.t=116,n.tabengali=2468,n.tackdown=8868,n.tackleft=8867,n.tadeva=2340,n.tagujarati=2724,n.tagurmukhi=2596,n.taharabic=1591,n.tahfinalarabic=65218,n.tahinitialarabic=65219,n.tahiragana=12383,n.tahmedialarabic=65220,n.taisyouerasquare=13181,n.takatakana=12479,n.takatakanahalfwidth=65408,n.tatweelarabic=1600,n.tau=964,n.tav=1514,n.tavdages=64330,n.tavdagesh=64330,n.tavdageshhebrew=64330,n.tavhebrew=1514,n.tbar=359,n.tbopomofo=12554,n.tcaron=357,n.tccurl=680,n.tcedilla=355,n.tcheharabic=1670,n.tchehfinalarabic=64379,n.tchehinitialarabic=64380,n.tchehmedialarabic=64381,n.tcircle=9443,n.tcircumflexbelow=7793,n.tcommaaccent=355,n.tdieresis=7831,n.tdotaccent=7787,n.tdotbelow=7789,n.tecyrillic=1090,n.tedescendercyrillic=1197,n.teharabic=1578,n.tehfinalarabic=65174,n.tehhahinitialarabic=64674,n.tehhahisolatedarabic=64524,n.tehinitialarabic=65175,n.tehiragana=12390,n.tehjeeminitialarabic=64673,n.tehjeemisolatedarabic=64523,n.tehmarbutaarabic=1577,n.tehmarbutafinalarabic=65172,n.tehmedialarabic=65176,n.tehmeeminitialarabic=64676,n.tehmeemisolatedarabic=64526,n.tehnoonfinalarabic=64627,n.tekatakana=12486,n.tekatakanahalfwidth=65411,n.telephone=8481,n.telephoneblack=9742,n.telishagedolahebrew=1440,n.telishaqetanahebrew=1449,n.tencircle=9321,n.tenideographicparen=12841,n.tenparen=9341,n.tenperiod=9361,n.tenroman=8569,n.tesh=679,n.tet=1496,n.tetdagesh=64312,n.tetdageshhebrew=64312,n.tethebrew=1496,n.tetsecyrillic=1205,n.tevirhebrew=1435,n.tevirlefthebrew=1435,n.thabengali=2469,n.thadeva=2341,n.thagujarati=2725,n.thagurmukhi=2597,n.thalarabic=1584,n.thalfinalarabic=65196,n.thanthakhatlowleftthai=63640,n.thanthakhatlowrightthai=63639,n.thanthakhatthai=3660,n.thanthakhatupperleftthai=63638,n.theharabic=1579,n.thehfinalarabic=65178,n.thehinitialarabic=65179,n.thehmedialarabic=65180,n.thereexists=8707,n.therefore=8756,n.theta=952,n.theta1=977,n.thetasymbolgreek=977,n.thieuthacirclekorean=12921,n.thieuthaparenkorean=12825,n.thieuthcirclekorean=12907,n.thieuthkorean=12620,n.thieuthparenkorean=12811,n.thirteencircle=9324,n.thirteenparen=9344,n.thirteenperiod=9364,n.thonangmonthothai=3601,n.thook=429,n.thophuthaothai=3602,n.thorn=254,n.thothahanthai=3607,n.thothanthai=3600,n.thothongthai=3608,n.thothungthai=3606,n.thousandcyrillic=1154,n.thousandsseparatorarabic=1644,n.thousandsseparatorpersian=1644,n.three=51,n.threearabic=1635,n.threebengali=2537,n.threecircle=9314,n.threecircleinversesansserif=10124,n.threedeva=2409,n.threeeighths=8540,n.threegujarati=2793,n.threegurmukhi=2665,n.threehackarabic=1635,n.threehangzhou=12323,n.threeideographicparen=12834,n.threeinferior=8323,n.threemonospace=65299,n.threenumeratorbengali=2550,n.threeoldstyle=63283,n.threeparen=9334,n.threeperiod=9354,n.threepersian=1779,n.threequarters=190,n.threequartersemdash=63198,n.threeroman=8562,n.threesuperior=179,n.threethai=3667,n.thzsquare=13204,n.tihiragana=12385,n.tikatakana=12481,n.tikatakanahalfwidth=65409,n.tikeutacirclekorean=12912,n.tikeutaparenkorean=12816,n.tikeutcirclekorean=12898,n.tikeutkorean=12599,n.tikeutparenkorean=12802,n.tilde=732,n.tildebelowcmb=816,n.tildecmb=771,n.tildecomb=771,n.tildedoublecmb=864,n.tildeoperator=8764,n.tildeoverlaycmb=820,n.tildeverticalcmb=830,n.timescircle=8855,n.tipehahebrew=1430,n.tipehalefthebrew=1430,n.tippigurmukhi=2672,n.titlocyrilliccmb=1155,n.tiwnarmenian=1407,n.tlinebelow=7791,n.tmonospace=65364,n.toarmenian=1385,n.tohiragana=12392,n.tokatakana=12488,n.tokatakanahalfwidth=65412,n.tonebarextrahighmod=741,n.tonebarextralowmod=745,n.tonebarhighmod=742,n.tonebarlowmod=744,n.tonebarmidmod=743,n.tonefive=445,n.tonesix=389,n.tonetwo=424,n.tonos=900,n.tonsquare=13095,n.topatakthai=3599,n.tortoiseshellbracketleft=12308,n.tortoiseshellbracketleftsmall=65117,n.tortoiseshellbracketleftvertical=65081,n.tortoiseshellbracketright=12309,n.tortoiseshellbracketrightsmall=65118,n.tortoiseshellbracketrightvertical=65082,n.totaothai=3605,n.tpalatalhook=427,n.tparen=9391,n.trademark=8482,n.trademarksans=63722,n.trademarkserif=63195,n.tretroflexhook=648,n.triagdn=9660,n.triaglf=9668,n.triagrt=9658,n.triagup=9650,n.ts=678,n.tsadi=1510,n.tsadidagesh=64326,n.tsadidageshhebrew=64326,n.tsadihebrew=1510,n.tsecyrillic=1094,n.tsere=1461,n.tsere12=1461,n.tsere1e=1461,n.tsere2b=1461,n.tserehebrew=1461,n.tserenarrowhebrew=1461,n.tserequarterhebrew=1461,n.tserewidehebrew=1461,n.tshecyrillic=1115,n.tsuperior=63219,n.ttabengali=2463,n.ttadeva=2335,n.ttagujarati=2719,n.ttagurmukhi=2591,n.tteharabic=1657,n.ttehfinalarabic=64359,n.ttehinitialarabic=64360,n.ttehmedialarabic=64361,n.tthabengali=2464,n.tthadeva=2336,n.tthagujarati=2720,n.tthagurmukhi=2592,n.tturned=647,n.tuhiragana=12388,n.tukatakana=12484,n.tukatakanahalfwidth=65410,n.tusmallhiragana=12387,n.tusmallkatakana=12483,n.tusmallkatakanahalfwidth=65391,n.twelvecircle=9323,n.twelveparen=9343,n.twelveperiod=9363,n.twelveroman=8571,n.twentycircle=9331,n.twentyhangzhou=21316,n.twentyparen=9351,n.twentyperiod=9371,n.two=50,n.twoarabic=1634,n.twobengali=2536,n.twocircle=9313,n.twocircleinversesansserif=10123,n.twodeva=2408,n.twodotenleader=8229,n.twodotleader=8229,n.twodotleadervertical=65072,n.twogujarati=2792,n.twogurmukhi=2664,n.twohackarabic=1634,n.twohangzhou=12322,n.twoideographicparen=12833,n.twoinferior=8322,n.twomonospace=65298,n.twonumeratorbengali=2549,n.twooldstyle=63282,n.twoparen=9333,n.twoperiod=9353,n.twopersian=1778,n.tworoman=8561,n.twostroke=443,n.twosuperior=178,n.twothai=3666,n.twothirds=8532,n.u=117,n.uacute=250,n.ubar=649,n.ubengali=2441,n.ubopomofo=12584,n.ubreve=365,n.ucaron=468,n.ucircle=9444,n.ucircumflex=251,n.ucircumflexbelow=7799,n.ucyrillic=1091,n.udattadeva=2385,n.udblacute=369,n.udblgrave=533,n.udeva=2313,n.udieresis=252,n.udieresisacute=472,n.udieresisbelow=7795,n.udieresiscaron=474,n.udieresiscyrillic=1265,n.udieresisgrave=476,n.udieresismacron=470,n.udotbelow=7909,n.ugrave=249,n.ugujarati=2697,n.ugurmukhi=2569,n.uhiragana=12358,n.uhookabove=7911,n.uhorn=432,n.uhornacute=7913,n.uhorndotbelow=7921,n.uhorngrave=7915,n.uhornhookabove=7917,n.uhorntilde=7919,n.uhungarumlaut=369,n.uhungarumlautcyrillic=1267,n.uinvertedbreve=535,n.ukatakana=12454,n.ukatakanahalfwidth=65395,n.ukcyrillic=1145,n.ukorean=12636,n.umacron=363,n.umacroncyrillic=1263,n.umacrondieresis=7803,n.umatragurmukhi=2625,n.umonospace=65365,n.underscore=95,n.underscoredbl=8215,n.underscoremonospace=65343,n.underscorevertical=65075,n.underscorewavy=65103,n.union=8746,n.universal=8704,n.uogonek=371,n.uparen=9392,n.upblock=9600,n.upperdothebrew=1476,n.upsilon=965,n.upsilondieresis=971,n.upsilondieresistonos=944,n.upsilonlatin=650,n.upsilontonos=973,n.uptackbelowcmb=797,n.uptackmod=724,n.uragurmukhi=2675,n.uring=367,n.ushortcyrillic=1118,n.usmallhiragana=12357,n.usmallkatakana=12453,n.usmallkatakanahalfwidth=65385,n.ustraightcyrillic=1199,n.ustraightstrokecyrillic=1201,n.utilde=361,n.utildeacute=7801,n.utildebelow=7797,n.uubengali=2442,n.uudeva=2314,n.uugujarati=2698,n.uugurmukhi=2570,n.uumatragurmukhi=2626,n.uuvowelsignbengali=2498,n.uuvowelsigndeva=2370,n.uuvowelsigngujarati=2754,n.uvowelsignbengali=2497,n.uvowelsigndeva=2369,n.uvowelsigngujarati=2753,n.v=118,n.vadeva=2357,n.vagujarati=2741,n.vagurmukhi=2613,n.vakatakana=12535,n.vav=1493,n.vavdagesh=64309,n.vavdagesh65=64309,n.vavdageshhebrew=64309,n.vavhebrew=1493,n.vavholam=64331,n.vavholamhebrew=64331,n.vavvavhebrew=1520,n.vavyodhebrew=1521,n.vcircle=9445,n.vdotbelow=7807,n.vecyrillic=1074,n.veharabic=1700,n.vehfinalarabic=64363,n.vehinitialarabic=64364,n.vehmedialarabic=64365,n.vekatakana=12537,n.venus=9792,n.verticalbar=124,n.verticallineabovecmb=781,n.verticallinebelowcmb=809,n.verticallinelowmod=716,n.verticallinemod=712,n.vewarmenian=1406,n.vhook=651,n.vikatakana=12536,n.viramabengali=2509,n.viramadeva=2381,n.viramagujarati=2765,n.visargabengali=2435,n.visargadeva=2307,n.visargagujarati=2691,n.vmonospace=65366,n.voarmenian=1400,n.voicediterationhiragana=12446,n.voicediterationkatakana=12542,n.voicedmarkkana=12443,n.voicedmarkkanahalfwidth=65438,n.vokatakana=12538,n.vparen=9393,n.vtilde=7805,n.vturned=652,n.vuhiragana=12436,n.vukatakana=12532,n.w=119,n.wacute=7811,n.waekorean=12633,n.wahiragana=12431,n.wakatakana=12527,n.wakatakanahalfwidth=65436,n.wakorean=12632,n.wasmallhiragana=12430,n.wasmallkatakana=12526,n.wattosquare=13143,n.wavedash=12316,n.wavyunderscorevertical=65076,n.wawarabic=1608,n.wawfinalarabic=65262,n.wawhamzaabovearabic=1572,n.wawhamzaabovefinalarabic=65158,n.wbsquare=13277,n.wcircle=9446,n.wcircumflex=373,n.wdieresis=7813,n.wdotaccent=7815,n.wdotbelow=7817,n.wehiragana=12433,n.weierstrass=8472,n.wekatakana=12529,n.wekorean=12638,n.weokorean=12637,n.wgrave=7809,n.whitebullet=9702,n.whitecircle=9675,n.whitecircleinverse=9689,n.whitecornerbracketleft=12302,n.whitecornerbracketleftvertical=65091,n.whitecornerbracketright=12303,n.whitecornerbracketrightvertical=65092,n.whitediamond=9671,n.whitediamondcontainingblacksmalldiamond=9672,n.whitedownpointingsmalltriangle=9663,n.whitedownpointingtriangle=9661,n.whiteleftpointingsmalltriangle=9667,n.whiteleftpointingtriangle=9665,n.whitelenticularbracketleft=12310,n.whitelenticularbracketright=12311,n.whiterightpointingsmalltriangle=9657,n.whiterightpointingtriangle=9655,n.whitesmallsquare=9643,n.whitesmilingface=9786,n.whitesquare=9633,n.whitestar=9734,n.whitetelephone=9743,n.whitetortoiseshellbracketleft=12312,n.whitetortoiseshellbracketright=12313,n.whiteuppointingsmalltriangle=9653,n.whiteuppointingtriangle=9651,n.wihiragana=12432,n.wikatakana=12528,n.wikorean=12639,n.wmonospace=65367,n.wohiragana=12434,n.wokatakana=12530,n.wokatakanahalfwidth=65382,n.won=8361,n.wonmonospace=65510,n.wowaenthai=3623,n.wparen=9394,n.wring=7832,n.wsuperior=695,n.wturned=653,n.wynn=447,n.x=120,n.xabovecmb=829,n.xbopomofo=12562,n.xcircle=9447,n.xdieresis=7821,n.xdotaccent=7819,n.xeharmenian=1389,n.xi=958,n.xmonospace=65368,n.xparen=9395,n.xsuperior=739,n.y=121,n.yaadosquare=13134,n.yabengali=2479,n.yacute=253,n.yadeva=2351,n.yaekorean=12626,n.yagujarati=2735,n.yagurmukhi=2607,n.yahiragana=12420,n.yakatakana=12516,n.yakatakanahalfwidth=65428,n.yakorean=12625,n.yamakkanthai=3662,n.yasmallhiragana=12419,n.yasmallkatakana=12515,n.yasmallkatakanahalfwidth=65388,n.yatcyrillic=1123,n.ycircle=9448,n.ycircumflex=375,n.ydieresis=255,n.ydotaccent=7823,n.ydotbelow=7925,n.yeharabic=1610,n.yehbarreearabic=1746,n.yehbarreefinalarabic=64431,n.yehfinalarabic=65266,n.yehhamzaabovearabic=1574,n.yehhamzaabovefinalarabic=65162,n.yehhamzaaboveinitialarabic=65163,n.yehhamzaabovemedialarabic=65164,n.yehinitialarabic=65267,n.yehmedialarabic=65268,n.yehmeeminitialarabic=64733,n.yehmeemisolatedarabic=64600,n.yehnoonfinalarabic=64660,n.yehthreedotsbelowarabic=1745,n.yekorean=12630,n.yen=165,n.yenmonospace=65509,n.yeokorean=12629,n.yeorinhieuhkorean=12678,n.yerahbenyomohebrew=1450,n.yerahbenyomolefthebrew=1450,n.yericyrillic=1099,n.yerudieresiscyrillic=1273,n.yesieungkorean=12673,n.yesieungpansioskorean=12675,n.yesieungsioskorean=12674,n.yetivhebrew=1434,n.ygrave=7923,n.yhook=436,n.yhookabove=7927,n.yiarmenian=1397,n.yicyrillic=1111,n.yikorean=12642,n.yinyang=9775,n.yiwnarmenian=1410,n.ymonospace=65369,n.yod=1497,n.yoddagesh=64313,n.yoddageshhebrew=64313,n.yodhebrew=1497,n.yodyodhebrew=1522,n.yodyodpatahhebrew=64287,n.yohiragana=12424,n.yoikorean=12681,n.yokatakana=12520,n.yokatakanahalfwidth=65430,n.yokorean=12635,n.yosmallhiragana=12423,n.yosmallkatakana=12519,n.yosmallkatakanahalfwidth=65390,n.yotgreek=1011,n.yoyaekorean=12680,n.yoyakorean=12679,n.yoyakthai=3618,n.yoyingthai=3597,n.yparen=9396,n.ypogegrammeni=890,n.ypogegrammenigreekcmb=837,n.yr=422,n.yring=7833,n.ysuperior=696,n.ytilde=7929,n.yturned=654,n.yuhiragana=12422,n.yuikorean=12684,n.yukatakana=12518,n.yukatakanahalfwidth=65429,n.yukorean=12640,n.yusbigcyrillic=1131,n.yusbigiotifiedcyrillic=1133,n.yuslittlecyrillic=1127,n.yuslittleiotifiedcyrillic=1129,n.yusmallhiragana=12421,n.yusmallkatakana=12517,n.yusmallkatakanahalfwidth=65389,n.yuyekorean=12683,n.yuyeokorean=12682,n.yyabengali=2527,n.yyadeva=2399,n.z=122,n.zaarmenian=1382,n.zacute=378,n.zadeva=2395,n.zagurmukhi=2651,n.zaharabic=1592,n.zahfinalarabic=65222,n.zahinitialarabic=65223,n.zahiragana=12374,n.zahmedialarabic=65224,n.zainarabic=1586,n.zainfinalarabic=65200,n.zakatakana=12470,n.zaqefgadolhebrew=1429,n.zaqefqatanhebrew=1428,n.zarqahebrew=1432,n.zayin=1494,n.zayindagesh=64310,n.zayindageshhebrew=64310,n.zayinhebrew=1494,n.zbopomofo=12567,n.zcaron=382,n.zcircle=9449,n.zcircumflex=7825,n.zcurl=657,n.zdot=380,n.zdotaccent=380,n.zdotbelow=7827,n.zecyrillic=1079,n.zedescendercyrillic=1177,n.zedieresiscyrillic=1247,n.zehiragana=12380,n.zekatakana=12476,n.zero=48,n.zeroarabic=1632,n.zerobengali=2534,n.zerodeva=2406,n.zerogujarati=2790,n.zerogurmukhi=2662,n.zerohackarabic=1632,n.zeroinferior=8320,n.zeromonospace=65296,n.zerooldstyle=63280,n.zeropersian=1776,n.zerosuperior=8304,n.zerothai=3664,n.zerowidthjoiner=65279,n.zerowidthnonjoiner=8204,n.zerowidthspace=8203,n.zeta=950,n.zhbopomofo=12563,n.zhearmenian=1386,n.zhebrevecyrillic=1218,n.zhecyrillic=1078,n.zhedescendercyrillic=1175,n.zhedieresiscyrillic=1245,n.zihiragana=12376,n.zikatakana=12472,n.zinorhebrew=1454,n.zlinebelow=7829,n.zmonospace=65370,n.zohiragana=12382,n.zokatakana=12478,n.zparen=9397,n.zretroflexhook=656,n.zstroke=438,n.zuhiragana=12378,n.zukatakana=12474,n[".notdef"]=0,n.angbracketleftbig=9001,n.angbracketleftBig=9001,n.angbracketleftbigg=9001,n.angbracketleftBigg=9001,n.angbracketrightBig=9002,n.angbracketrightbig=9002,n.angbracketrightBigg=9002,n.angbracketrightbigg=9002,n.arrowhookleft=8618,n.arrowhookright=8617,n.arrowlefttophalf=8636,n.arrowleftbothalf=8637,n.arrownortheast=8599,n.arrownorthwest=8598,n.arrowrighttophalf=8640,n.arrowrightbothalf=8641,n.arrowsoutheast=8600,n.arrowsouthwest=8601,n.backslashbig=8726,n.backslashBig=8726,n.backslashBigg=8726,n.backslashbigg=8726,n.bardbl=8214,n.bracehtipdownleft=65079,n.bracehtipdownright=65079,n.bracehtipupleft=65080,n.bracehtipupright=65080,n.braceleftBig=123,n.braceleftbig=123,n.braceleftbigg=123,n.braceleftBigg=123,n.bracerightBig=125,n.bracerightbig=125,n.bracerightbigg=125,n.bracerightBigg=125,n.bracketleftbig=91,n.bracketleftBig=91,n.bracketleftbigg=91,n.bracketleftBigg=91,n.bracketrightBig=93,n.bracketrightbig=93,n.bracketrightbigg=93,n.bracketrightBigg=93,n.ceilingleftbig=8968,n.ceilingleftBig=8968,n.ceilingleftBigg=8968,n.ceilingleftbigg=8968,n.ceilingrightbig=8969,n.ceilingrightBig=8969,n.ceilingrightbigg=8969,n.ceilingrightBigg=8969,n.circledotdisplay=8857,n.circledottext=8857,n.circlemultiplydisplay=8855,n.circlemultiplytext=8855,n.circleplusdisplay=8853,n.circleplustext=8853,n.contintegraldisplay=8750,n.contintegraltext=8750,n.coproductdisplay=8720,n.coproducttext=8720,n.floorleftBig=8970,n.floorleftbig=8970,n.floorleftbigg=8970,n.floorleftBigg=8970,n.floorrightbig=8971,n.floorrightBig=8971,n.floorrightBigg=8971,n.floorrightbigg=8971,n.hatwide=770,n.hatwider=770,n.hatwidest=770,n.intercal=7488,n.integraldisplay=8747,n.integraltext=8747,n.intersectiondisplay=8898,n.intersectiontext=8898,n.logicalanddisplay=8743,n.logicalandtext=8743,n.logicalordisplay=8744,n.logicalortext=8744,n.parenleftBig=40,n.parenleftbig=40,n.parenleftBigg=40,n.parenleftbigg=40,n.parenrightBig=41,n.parenrightbig=41,n.parenrightBigg=41,n.parenrightbigg=41,n.prime=8242,n.productdisplay=8719,n.producttext=8719,n.radicalbig=8730,n.radicalBig=8730,n.radicalBigg=8730,n.radicalbigg=8730,n.radicalbt=8730,n.radicaltp=8730,n.radicalvertex=8730,n.slashbig=47,n.slashBig=47,n.slashBigg=47,n.slashbigg=47,n.summationdisplay=8721,n.summationtext=8721,n.tildewide=732,n.tildewider=732,n.tildewidest=732,n.uniondisplay=8899,n.unionmultidisplay=8846,n.unionmultitext=8846,n.unionsqdisplay=8852,n.unionsqtext=8852,n.uniontext=8899,n.vextenddouble=8741,n.vextendsingle=8739}),qH=Ai(function(n){n.space=32,n.a1=9985,n.a2=9986,n.a202=9987,n.a3=9988,n.a4=9742,n.a5=9990,n.a119=9991,n.a118=9992,n.a117=9993,n.a11=9755,n.a12=9758,n.a13=9996,n.a14=9997,n.a15=9998,n.a16=9999,n.a105=1e4,n.a17=10001,n.a18=10002,n.a19=10003,n.a20=10004,n.a21=10005,n.a22=10006,n.a23=10007,n.a24=10008,n.a25=10009,n.a26=10010,n.a27=10011,n.a28=10012,n.a6=10013,n.a7=10014,n.a8=10015,n.a9=10016,n.a10=10017,n.a29=10018,n.a30=10019,n.a31=10020,n.a32=10021,n.a33=10022,n.a34=10023,n.a35=9733,n.a36=10025,n.a37=10026,n.a38=10027,n.a39=10028,n.a40=10029,n.a41=10030,n.a42=10031,n.a43=10032,n.a44=10033,n.a45=10034,n.a46=10035,n.a47=10036,n.a48=10037,n.a49=10038,n.a50=10039,n.a51=10040,n.a52=10041,n.a53=10042,n.a54=10043,n.a55=10044,n.a56=10045,n.a57=10046,n.a58=10047,n.a59=10048,n.a60=10049,n.a61=10050,n.a62=10051,n.a63=10052,n.a64=10053,n.a65=10054,n.a66=10055,n.a67=10056,n.a68=10057,n.a69=10058,n.a70=10059,n.a71=9679,n.a72=10061,n.a73=9632,n.a74=10063,n.a203=10064,n.a75=10065,n.a204=10066,n.a76=9650,n.a77=9660,n.a78=9670,n.a79=10070,n.a81=9687,n.a82=10072,n.a83=10073,n.a84=10074,n.a97=10075,n.a98=10076,n.a99=10077,n.a100=10078,n.a101=10081,n.a102=10082,n.a103=10083,n.a104=10084,n.a106=10085,n.a107=10086,n.a108=10087,n.a112=9827,n.a111=9830,n.a110=9829,n.a109=9824,n.a120=9312,n.a121=9313,n.a122=9314,n.a123=9315,n.a124=9316,n.a125=9317,n.a126=9318,n.a127=9319,n.a128=9320,n.a129=9321,n.a130=10102,n.a131=10103,n.a132=10104,n.a133=10105,n.a134=10106,n.a135=10107,n.a136=10108,n.a137=10109,n.a138=10110,n.a139=10111,n.a140=10112,n.a141=10113,n.a142=10114,n.a143=10115,n.a144=10116,n.a145=10117,n.a146=10118,n.a147=10119,n.a148=10120,n.a149=10121,n.a150=10122,n.a151=10123,n.a152=10124,n.a153=10125,n.a154=10126,n.a155=10127,n.a156=10128,n.a157=10129,n.a158=10130,n.a159=10131,n.a160=10132,n.a161=8594,n.a163=8596,n.a164=8597,n.a196=10136,n.a165=10137,n.a192=10138,n.a166=10139,n.a167=10140,n.a168=10141,n.a169=10142,n.a170=10143,n.a171=10144,n.a172=10145,n.a173=10146,n.a162=10147,n.a174=10148,n.a175=10149,n.a176=10150,n.a177=10151,n.a178=10152,n.a179=10153,n.a193=10154,n.a180=10155,n.a199=10156,n.a181=10157,n.a200=10158,n.a182=10159,n.a201=10161,n.a183=10162,n.a184=10163,n.a197=10164,n.a185=10165,n.a194=10166,n.a198=10167,n.a186=10168,n.a195=10169,n.a187=10170,n.a188=10171,n.a189=10172,n.a190=10173,n.a191=10174,n.a89=10088,n.a90=10089,n.a93=10090,n.a94=10091,n.a91=10092,n.a92=10093,n.a205=10094,n.a85=10095,n.a206=10096,n.a86=10097,n.a87=10098,n.a88=10099,n.a95=10100,n.a96=10101,n[".notdef"]=0}),WH=Ai(function(n){n[63721]=169,n[63193]=169,n[63720]=174,n[63194]=174,n[63722]=8482,n[63195]=8482,n[63729]=9127,n[63730]=9128,n[63731]=9129,n[63740]=9131,n[63741]=9132,n[63742]=9133,n[63726]=9121,n[63727]=9122,n[63728]=9123,n[63737]=9124,n[63738]=9125,n[63739]=9126,n[63723]=9115,n[63724]=9116,n[63725]=9117,n[63734]=9118,n[63735]=9119,n[63736]=9120});function KH(n){return n>=65520&&n<=65535?0:n>=62976&&n<=63743?WH()[n]||n:n===173?45:n}function Ag(n,e){let t=e[n];if(t!==void 0)return t;if(!n)return-1;if(n[0]==="u"){const i=n.length;let s;if(i===7&&n[1]==="n"&&n[2]==="i")s=n.substring(3);else if(i>=5&&i<=7)s=n.substring(1);else return-1;if(s===s.toUpperCase()&&(t=parseInt(s,16),t>=0))return t}return-1}const bw=[[0,127],[128,255],[256,383],[384,591],[592,687,7424,7551,7552,7615],[688,767,42752,42783],[768,879,7616,7679],[880,1023],[11392,11519],[1024,1279,1280,1327,11744,11775,42560,42655],[1328,1423],[1424,1535],[42240,42559],[1536,1791,1872,1919],[1984,2047],[2304,2431],[2432,2559],[2560,2687],[2688,2815],[2816,2943],[2944,3071],[3072,3199],[3200,3327],[3328,3455],[3584,3711],[3712,3839],[4256,4351,11520,11567],[6912,7039],[4352,4607],[7680,7935,11360,11391,42784,43007],[7936,8191],[8192,8303,11776,11903],[8304,8351],[8352,8399],[8400,8447],[8448,8527],[8528,8591],[8592,8703,10224,10239,10496,10623,11008,11263],[8704,8959,10752,11007,10176,10223,10624,10751],[8960,9215],[9216,9279],[9280,9311],[9312,9471],[9472,9599],[9600,9631],[9632,9727],[9728,9983],[9984,10175],[12288,12351],[12352,12447],[12448,12543,12784,12799],[12544,12591,12704,12735],[12592,12687],[43072,43135],[12800,13055],[13056,13311],[44032,55215],[55296,57343],[67840,67871],[19968,40959,11904,12031,12032,12255,12272,12287,13312,19903,131072,173791,12688,12703],[57344,63743],[12736,12783,63744,64255,194560,195103],[64256,64335],[64336,65023],[65056,65071],[65040,65055],[65104,65135],[65136,65279],[65280,65519],[65520,65535],[3840,4095],[1792,1871],[1920,1983],[3456,3583],[4096,4255],[4608,4991,4992,5023,11648,11743],[5024,5119],[5120,5759],[5760,5791],[5792,5887],[6016,6143],[6144,6319],[10240,10495],[40960,42127],[5888,5919,5920,5951,5952,5983,5984,6015],[66304,66351],[66352,66383],[66560,66639],[118784,119039,119040,119295,119296,119375],[119808,120831],[1044480,1048573],[65024,65039,917760,917999],[917504,917631],[6400,6479],[6480,6527],[6528,6623],[6656,6687],[11264,11359],[11568,11647],[19904,19967],[43008,43055],[65536,65663,65664,65791,65792,65855],[65856,65935],[66432,66463],[66464,66527],[66640,66687],[66688,66735],[67584,67647],[68096,68191],[119552,119647],[73728,74751,74752,74879],[119648,119679],[7040,7103],[7168,7247],[7248,7295],[43136,43231],[43264,43311],[43312,43359],[43520,43615],[65936,65999],[66e3,66047],[66208,66271,66176,66207,67872,67903],[127024,127135,126976,127023]];function XH(n,e=-1){if(e!==-1){const t=bw[e];for(let i=0,s=t.length;i<s;i+=2)if(n>=t[i]&&n<=t[i+1])return e}for(let t=0,i=bw.length;t<i;t++){const s=bw[t];for(let r=0,a=s.length;r<a;r+=2)if(n>=s[r]&&n<=s[r+1])return t}return-1}const YH=new RegExp("^(\\s)|(\\p{Mn})|(\\p{Cf})$","u"),G7=new Map;function JH(n){const e=G7.get(n);if(e)return e;const t=n.match(YH),i={isWhitespace:!!(t!=null&&t[1]),isZeroWidthDiacritic:!!(t!=null&&t[2]),isInvisibleFormatMark:!!(t!=null&&t[3])};return G7.set(n,i),i}function ZH(){G7.clear()}const e1=!0,oo={FixedPitch:1,Serif:2,Symbolic:4,Script:8,Nonsymbolic:32,Italic:64,AllCap:65536,SmallCap:131072,ForceBold:262144},ak=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function ER(n,e){if(e[n]!==void 0)return n;const t=Ag(n,e);if(t!==-1){for(const i in e)if(e[i]===t)return i}return gn("Unable to recover a standard glyph name for: "+n),n}function TR(n,e,t){const i=Object.create(null);let s,r,a;const o=!!(n.flags&oo.Symbolic);if(n.isInternalFont)for(a=e,r=0;r<a.length;r++)s=t.indexOf(a[r]),i[r]=s>=0?s:0;else if(n.baseEncodingName)for(a=zp(n.baseEncodingName),r=0;r<a.length;r++)s=t.indexOf(a[r]),i[r]=s>=0?s:0;else if(o)for(r in e)i[r]=e[r];else for(a=s0,r=0;r<a.length;r++)s=t.indexOf(a[r]),i[r]=s>=0?s:0;const l=n.differences;let c;if(l)for(r in l){const h=l[r];if(s=t.indexOf(h),s===-1){c||(c=Wl());const u=ER(h,c);u!==h&&(s=t.indexOf(u))}i[r]=s>=0?s:0}return i}function cx(n){return n.replaceAll(/[,_]/g,"-").replaceAll(/\s/g,"")}const QH=Ai(n=>{n[8211]=65074,n[8212]=65073,n[8229]=65072,n[8230]=65049,n[12289]=65041,n[12290]=65042,n[12296]=65087,n[12297]=65088,n[12298]=65085,n[12299]=65086,n[12300]=65089,n[12301]=65090,n[12302]=65091,n[12303]=65092,n[12304]=65083,n[12305]=65084,n[12308]=65081,n[12309]=65082,n[12310]=65047,n[12311]=65048,n[65103]=65076,n[65281]=65045,n[65288]=65077,n[65289]=65078,n[65292]=65040,n[65306]=65043,n[65307]=65044,n[65311]=65046,n[65339]=65095,n[65341]=65096,n[65343]=65075,n[65371]=65079,n[65373]=65080}),ok=1e3;function $H({data:n,width:e,height:t}){if(e>ok||t>ok)return null;const i=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1,a=new Uint8Array(r*(t+1));let o,l,c;const h=e+7&-8,u=new Uint8Array(h*t);let d=0;for(const C of n){let k=128;for(;k>0;)u[d++]=C&k?0:255,k>>=1}let f=0;for(d=0,u[d]!==0&&(a[0]=1,++f),l=1;l<e;l++)u[d]!==u[d+1]&&(a[l]=u[d]?2:1,++f),d++;for(u[d]!==0&&(a[l]=2,++f),o=1;o<t;o++){d=o*h,c=o*r,u[d-h]!==u[d]&&(a[c]=u[d]?1:8,++f);let C=(u[d]?4:0)+(u[d-h]?8:0);for(l=1;l<e;l++)C=(C>>2)+(u[d+1]?4:0)+(u[d-h+1]?8:0),s[C]&&(a[c+l]=s[C],++f),d++;if(u[d-h]!==u[d]&&(a[c+l]=u[d]?2:4,++f),f>i)return null}for(d=h*(t-1),c=o*r,u[d]!==0&&(a[c]=8,++f),l=1;l<e;l++)u[d]!==u[d+1]&&(a[c+l]=u[d]?4:8,++f),d++;if(u[d]!==0&&(a[c+l]=4,++f),f>i)return null;const g=new Int32Array([0,r,-1,0,-r,0,0,0,1]),m=[],{a:x,b:p,c:y,d:w,e:v,f:_}=new DOMMatrix().scaleSelf(1/e,-1/t).translateSelf(0,-t);for(o=0;f&&o<=t;o++){let C=o*r;const k=C+e;for(;C<k&&!a[C];)C++;if(C===k)continue;let I=C%r,S=o;m.push(ds.moveTo,x*I+y*S+v,p*I+w*S+_);const R=C;let P=a[C];do{const D=g[P];do C+=D;while(!a[C]);const U=a[C];U!==5&&U!==10?(P=U,a[C]=0):(P=U&51*P>>4,a[C]&=P>>2|P<<2),I=C%r,S=C/r|0,m.push(ds.lineTo,x*I+y*S+v,p*I+w*S+_),a[C]||--f}while(R!==C);--o}return[ne.rawFillPath,[new Float32Array(m)],new Float32Array([0,0,e,t])]}const ez=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron"],tz=[".notdef","space","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","fi","fl","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],nz=[".notdef","space","dollaroldstyle","dollarsuperior","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","fi","fl","ffi","ffl","parenleftinferior","parenrightinferior","hyphensuperior","colonmonetary","onefitted","rupiah","centoldstyle","figuredash","hypheninferior","onequarter","onehalf","threequarters","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior"],iz=10,t3=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],Wx=391,gf=[null,{id:"hstem",min:2,stackClearing:!0,stem:!0},null,{id:"vstem",min:2,stackClearing:!0,stem:!0},{id:"vmoveto",min:1,stackClearing:!0},{id:"rlineto",min:2,resetStack:!0},{id:"hlineto",min:1,resetStack:!0},{id:"vlineto",min:1,resetStack:!0},{id:"rrcurveto",min:6,resetStack:!0},null,{id:"callsubr",min:1,undefStack:!0},{id:"return",min:0,undefStack:!0},null,null,{id:"endchar",min:0,stackClearing:!0},null,null,null,{id:"hstemhm",min:2,stackClearing:!0,stem:!0},{id:"hintmask",min:0,stackClearing:!0},{id:"cntrmask",min:0,stackClearing:!0},{id:"rmoveto",min:2,stackClearing:!0},{id:"hmoveto",min:1,stackClearing:!0},{id:"vstemhm",min:2,stackClearing:!0,stem:!0},{id:"rcurveline",min:8,resetStack:!0},{id:"rlinecurve",min:8,resetStack:!0},{id:"vvcurveto",min:4,resetStack:!0},{id:"hhcurveto",min:4,resetStack:!0},null,{id:"callgsubr",min:1,undefStack:!0},{id:"vhcurveto",min:4,resetStack:!0},{id:"hvcurveto",min:4,resetStack:!0}],sz=[null,null,null,{id:"and",min:2,stackDelta:-1},{id:"or",min:2,stackDelta:-1},{id:"not",min:1,stackDelta:0},null,null,null,{id:"abs",min:1,stackDelta:0},{id:"add",min:2,stackDelta:-1,stackFn(n,e){n[e-2]=n[e-2]+n[e-1]}},{id:"sub",min:2,stackDelta:-1,stackFn(n,e){n[e-2]=n[e-2]-n[e-1]}},{id:"div",min:2,stackDelta:-1,stackFn(n,e){n[e-2]=n[e-2]/n[e-1]}},null,{id:"neg",min:1,stackDelta:0,stackFn(n,e){n[e-1]=-n[e-1]}},{id:"eq",min:2,stackDelta:-1},null,null,{id:"drop",min:1,stackDelta:-1},null,{id:"put",min:2,stackDelta:-2},{id:"get",min:1,stackDelta:0},{id:"ifelse",min:4,stackDelta:-3},{id:"random",min:0,stackDelta:1},{id:"mul",min:2,stackDelta:-1,stackFn(n,e){n[e-2]=n[e-2]*n[e-1]}},null,{id:"sqrt",min:1,stackDelta:0},{id:"dup",min:1,stackDelta:1},{id:"exch",min:2,stackDelta:0},{id:"index",min:2,stackDelta:0},{id:"roll",min:3,stackDelta:-2},null,null,null,{id:"hflex",min:7,resetStack:!0},{id:"flex",min:13,resetStack:!0},{id:"hflex1",min:9,resetStack:!0},{id:"flex1",min:11,resetStack:!0}];class _4{constructor(e,t,i){this.bytes=e.getBytes(),this.properties=t,this.seacAnalysisEnabled=!!i}parse(){const e=this.properties,t=new RR;this.cff=t;const i=this.parseHeader(),s=this.parseIndex(i.endPos),r=this.parseIndex(s.endPos),a=this.parseIndex(r.endPos),o=this.parseIndex(a.endPos),l=this.parseDict(r.obj.get(0)),c=this.createDict(jp,l,t.strings);t.header=i.obj,t.names=this.parseNameIndex(s.obj),t.strings=this.parseStringIndex(a.obj),t.topDict=c,t.globalSubrIndex=o.obj,this.parsePrivateDict(t.topDict),t.isCIDFont=c.hasName("ROS");const h=c.getByName("CharStrings"),u=this.parseIndex(h).obj,d=c.getByName("FontMatrix");d&&(e.fontMatrix=d);const f=c.getByName("FontBBox");f&&(e.ascent=Math.max(f[3],f[1]),e.descent=Math.min(f[1],f[3]),e.ascentScaled=!0);let g,m;if(t.isCIDFont){const p=this.parseIndex(c.getByName("FDArray")).obj;for(let y=0,w=p.count;y<w;++y){const v=p.get(y),_=this.createDict(jp,this.parseDict(v),t.strings);this.parsePrivateDict(_),t.fdArray.push(_)}m=null,g=this.parseCharsets(c.getByName("charset"),u.count,t.strings,!0),t.fdSelect=this.parseFDSelect(c.getByName("FDSelect"),u.count)}else g=this.parseCharsets(c.getByName("charset"),u.count,t.strings,!1),m=this.parseEncoding(c.getByName("Encoding"),e,t.strings,g.charset);t.charset=g,t.encoding=m;const x=this.parseCharStrings({charStrings:u,localSubrIndex:c.privateDict.subrsIndex,globalSubrIndex:o.obj,fdSelect:t.fdSelect,fdArray:t.fdArray,privateDict:c.privateDict});return t.charStrings=x.charStrings,t.seacs=x.seacs,t.widths=x.widths,t}parseHeader(){let e=this.bytes;const t=e.length;let i=0;for(;i<t&&e[i]!==1;)++i;if(i>=t)throw new Ee("Invalid CFF header");i!==0&&(gn("cff data is shifted"),e=e.subarray(i),this.bytes=e);const s=e[0],r=e[1],a=e[2],o=e[3];return{obj:new MR(s,r,a,o),endPos:a}}parseDict(e){let t=0;function i(){let l=e[t++];return l===30?s():l===28?(l=Qc(e,t),t+=2,l):l===29?(l=e[t++],l=l<<8|e[t++],l=l<<8|e[t++],l=l<<8|e[t++],l):l>=32&&l<=246?l-139:l>=247&&l<=250?(l-247)*256+e[t++]+108:l>=251&&l<=254?-((l-251)*256)-e[t++]-108:(he('CFFParser_parseDict: "'+l+'" is a reserved command.'),NaN)}function s(){let l="";const h=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"],u=e.length;for(;t<u;){const d=e[t++],f=d>>4,g=d&15;if(f===15||(l+=h[f],g===15))break;l+=h[g]}return parseFloat(l)}let r=[];const a=[];t=0;const o=e.length;for(;t<o;){let l=e[t];l<=21?(l===12&&(l=l<<8|e[++t]),a.push([l,r]),r=[],++t):r.push(i())}return a}parseIndex(e){const t=new Ih,i=this.bytes,s=i[e++]<<8|i[e++],r=[];let a=e,o,l;if(s!==0){const c=i[e++],h=e+(s+1)*c-1;for(o=0,l=s+1;o<l;++o){let u=0;for(let d=0;d<c;++d)u<<=8,u+=i[e++];r.push(h+u)}a=r[s]}for(o=0,l=r.length-1;o<l;++o){const c=r[o],h=r[o+1];t.add(i.subarray(c,h))}return{obj:t,endPos:a}}parseNameIndex(e){const t=[];for(let i=0,s=e.count;i<s;++i){const r=e.get(i);t.push(ua(r))}return t}parseStringIndex(e){const t=new k4;for(let i=0,s=e.count;i<s;++i){const r=e.get(i);t.add(ua(r))}return t}createDict(e,t,i){const s=new e(i);for(const[r,a]of t)s.setByKey(r,a);return s}parseCharString(e,t,i,s){if(!t||e.callDepth>iz)return!1;let r=e.stackSize;const a=e.stack;let o=t.length;for(let l=0;l<o;){const c=t[l++];let h=null;if(c===12){const u=t[l++];u===0?(t[l-2]=139,t[l-1]=22,r=0):h=sz[u]}else if(c===28)a[r]=Qc(t,l),l+=2,r++;else if(c===14){if(r>=4&&(r-=4,this.seacAnalysisEnabled))return e.seac=a.slice(r,r+4),!1;h=gf[c]}else if(c>=32&&c<=246)a[r]=c-139,r++;else if(c>=247&&c<=254)a[r]=c<251?(c-247<<8)+t[l]+108:-(c-251<<8)-t[l]-108,l++,r++;else if(c===255)a[r]=(t[l]<<24|t[l+1]<<16|t[l+2]<<8|t[l+3])/65536,l+=4,r++;else if(c===19||c===20){if(e.hints+=r>>1,e.hints===0){t.copyWithin(l-1,l,-1),l-=1,o-=1;continue}l+=e.hints+7>>3,r%=2,h=gf[c]}else if(c===10||c===29){const u=c===10?i:s;if(!u)return h=gf[c],he("Missing subrsIndex for "+h.id),!1;let d=32768;u.count<1240?d=107:u.count<33900&&(d=1131);const f=a[--r]+d;if(f<0||f>=u.count||isNaN(f))return h=gf[c],he("Out of bounds subrIndex for "+h.id),!1;if(e.stackSize=r,e.callDepth++,!this.parseCharString(e,u.get(f),i,s))return!1;e.callDepth--,r=e.stackSize;continue}else{if(c===11)return e.stackSize=r,!0;if(c===0&&l===t.length)t[l-1]=14,h=gf[14];else if(c===9){t.copyWithin(l-1,l,-1),l-=1,o-=1;continue}else h=gf[c]}if(h){if(h.stem&&(e.hints+=r>>1,c===3||c===23?e.hasVStems=!0:e.hasVStems&&(c===1||c===18)&&(he("CFF stem hints are in wrong order"),t[l-1]=c===1?3:23)),"min"in h&&!e.undefStack&&r<h.min)return he("Not enough parameters for "+h.id+"; actual: "+r+", expected: "+h.min),r===0?(t[l-1]=14,!0):!1;e.firstStackClearing&&h.stackClearing&&(e.firstStackClearing=!1,r-=h.min,r>=2&&h.stem?r%=2:r>1&&he("Found too many parameters for stack-clearing command"),r>0&&(e.width=a[r-1])),"stackDelta"in h?("stackFn"in h&&h.stackFn(a,r),r+=h.stackDelta):h.stackClearing?r=0:h.resetStack?(r=0,e.undefStack=!1):h.undefStack&&(r=0,e.undefStack=!0,e.firstStackClearing=!1)}}return o<t.length&&t.fill(14,o),e.stackSize=r,!0}parseCharStrings({charStrings:e,localSubrIndex:t,globalSubrIndex:i,fdSelect:s,fdArray:r,privateDict:a}){const o=[],l=[],c=e.count;for(let h=0;h<c;h++){const u=e.get(h),d={callDepth:0,stackSize:0,stack:[],undefStack:!0,hints:0,firstStackClearing:!0,seac:null,width:null,hasVStems:!1};let f=!0,g=null,m=a;if(s&&r.length){const x=s.getFDIndex(h);x===-1&&(he("Glyph index is not in fd select."),f=!1),x>=r.length&&(he("Invalid fd index for glyph index."),f=!1),f&&(m=r[x].privateDict,g=m.subrsIndex)}else t&&(g=t);if(f&&(f=this.parseCharString(d,u,g,i)),d.width!==null){const x=m.getByName("nominalWidthX");l[h]=x+d.width}else{const x=m.getByName("defaultWidthX");l[h]=x}d.seac!==null&&(o[h]=d.seac),f||e.set(h,new Uint8Array([14]))}return{charStrings:e,seacs:o,widths:l}}emptyPrivateDictionary(e){const t=this.createDict(Gp,[],e.strings);e.setByKey(18,[0,0]),e.privateDict=t}parsePrivateDict(e){if(!e.hasName("Private")){this.emptyPrivateDictionary(e);return}const t=e.getByName("Private");if(!Array.isArray(t)||t.length!==2){e.removeByName("Private");return}const i=t[0],s=t[1];if(i===0||s>=this.bytes.length){this.emptyPrivateDictionary(e);return}const r=s+i,a=this.bytes.subarray(s,r),o=this.parseDict(a),l=this.createDict(Gp,o,e.strings);if(e.privateDict=l,l.getByName("ExpansionFactor")===0&&l.setByName("ExpansionFactor",.06),!l.getByName("Subrs"))return;const c=l.getByName("Subrs"),h=s+c;if(c===0||h>=this.bytes.length){this.emptyPrivateDictionary(e);return}const u=this.parseIndex(h);l.subrsIndex=u.obj}parseCharsets(e,t,i,s){if(e===0)return new rp(!0,xw.ISO_ADOBE,ez);if(e===1)return new rp(!0,xw.EXPERT,tz);if(e===2)return new rp(!0,xw.EXPERT_SUBSET,nz);const r=this.bytes,a=e,o=r[e++],l=[s?0:".notdef"];let c,h,u;switch(t-=1,o){case 0:for(u=0;u<t;u++)c=r[e++]<<8|r[e++],l.push(s?c:i.get(c));break;case 1:for(;l.length<=t;)for(c=r[e++]<<8|r[e++],h=r[e++],u=0;u<=h;u++)l.push(s?c++:i.get(c++));break;case 2:for(;l.length<=t;)for(c=r[e++]<<8|r[e++],h=r[e++]<<8|r[e++],u=0;u<=h;u++)l.push(s?c++:i.get(c++));break;default:throw new Ee("Unknown charset format")}const d=e,f=r.subarray(a,d);return new rp(!1,o,l,f)}parseEncoding(e,t,i,s){const r=Object.create(null),a=this.bytes;let o=!1,l,c,h,u=null;function d(){const f=a[e++];for(c=0;c<f;c++){const g=a[e++],m=(a[e++]<<8)+(a[e++]&255);r[g]=s.indexOf(i.get(m))}}if(e===0||e===1){o=!0,l=e;const f=e?IR:s0;for(c=0,h=s.length;c<h;c++){const g=f.indexOf(s[c]);g!==-1&&(r[g]=c)}}else{const f=e;switch(l=a[e++],l&127){case 0:const m=a[e++];for(c=1;c<=m;c++)r[a[e++]]=c;break;case 1:const x=a[e++];let p=1;for(c=0;c<x;c++){const y=a[e++],w=a[e++];for(let v=y;v<=y+w;v++)r[v]=p++}break;default:throw new Ee(`Unknown encoding format: ${l} in CFF`)}const g=e;l&128&&(a[f]&=127,d()),u=a.subarray(f,g)}return l&=127,new oz(o,l,r,u)}parseFDSelect(e,t){const i=this.bytes,s=i[e++],r=[];let a;switch(s){case 0:for(a=0;a<t;++a){const l=i[e++];r.push(l)}break;case 3:const o=i[e++]<<8|i[e++];for(a=0;a<o;++a){let l=i[e++]<<8|i[e++];a===0&&l!==0&&(he("parseFDSelect: The first range must have a first GID of 0 -- trying to recover."),l=0);const c=i[e++],h=i[e]<<8|i[e+1];for(let u=l;u<h;++u)r.push(c)}e+=2;break;default:throw new Ee(`parseFDSelect: Unknown format "${s}".`)}if(r.length!==t)throw new Ee("parseFDSelect: Invalid font data.");return new lz(s,r)}}class RR{constructor(){this.header=null,this.names=[],this.topDict=null,this.strings=new k4,this.globalSubrIndex=null,this.encoding=null,this.charset=null,this.charStrings=null,this.fdArray=[],this.fdSelect=null,this.isCIDFont=!1}duplicateFirstGlyph(){if(this.charStrings.count>=65535){he("Not enough space in charstrings to duplicate first glyph.");return}const e=this.charStrings.get(0);this.charStrings.add(e),this.isCIDFont&&this.fdSelect.fdSelect.push(this.fdSelect.fdSelect[0])}hasGlyphId(e){return e<0||e>=this.charStrings.count?!1:this.charStrings.get(e).length>0}}class MR{constructor(e,t,i,s){this.major=e,this.minor=t,this.hdrSize=i,this.offSize=s}}class k4{constructor(){this.strings=[]}get(e){return e>=0&&e<=Wx-1?t3[e]:e-Wx<=this.strings.length?this.strings[e-Wx]:t3[0]}getSID(e){let t=t3.indexOf(e);return t!==-1?t:(t=this.strings.indexOf(e),t!==-1?t+Wx:-1)}add(e){this.strings.push(e)}get count(){return this.strings.length}}class Ih{constructor(){this.objects=[],this.length=0}add(e){this.length+=e.length,this.objects.push(e)}set(e,t){this.length+=t.length-this.objects[e].length,this.objects[e]=t}get(e){return this.objects[e]}get count(){return this.objects.length}}class PR{constructor(e,t){this.keyToNameMap=e.keyToNameMap,this.nameToKeyMap=e.nameToKeyMap,this.defaults=e.defaults,this.types=e.types,this.opcodes=e.opcodes,this.order=e.order,this.strings=t,this.values=Object.create(null)}setByKey(e,t){if(!(e in this.keyToNameMap))return!1;if(t.length===0)return!0;for(const s of t)if(isNaN(s))return he(`Invalid CFFDict value: "${t}" for key "${e}".`),!0;const i=this.types[e];return(i==="num"||i==="sid"||i==="offset")&&(t=t[0]),this.values[e]=t,!0}setByName(e,t){if(!(e in this.nameToKeyMap))throw new Ee(`Invalid dictionary name "${e}"`);this.values[this.nameToKeyMap[e]]=t}hasName(e){return this.nameToKeyMap[e]in this.values}getByName(e){if(!(e in this.nameToKeyMap))throw new Ee(`Invalid dictionary name ${e}"`);const t=this.nameToKeyMap[e];return t in this.values?this.values[t]:this.defaults[t]}removeByName(e){delete this.values[this.nameToKeyMap[e]]}static createTables(e){const t={keyToNameMap:{},nameToKeyMap:{},defaults:{},types:{},opcodes:{},order:[]};for(const i of e){const s=Array.isArray(i[0])?(i[0][0]<<8)+i[0][1]:i[0];t.keyToNameMap[s]=i[1],t.nameToKeyMap[i[1]]=s,t.types[s]=i[2],t.defaults[s]=i[3],t.opcodes[s]=Array.isArray(i[0])?i[0]:[i[0]],t.order.push(s)}return t}}const rz=[[[12,30],"ROS",["sid","sid","num"],null],[[12,20],"SyntheticBase","num",null],[0,"version","sid",null],[1,"Notice","sid",null],[[12,0],"Copyright","sid",null],[2,"FullName","sid",null],[3,"FamilyName","sid",null],[4,"Weight","sid",null],[[12,1],"isFixedPitch","num",0],[[12,2],"ItalicAngle","num",0],[[12,3],"UnderlinePosition","num",-100],[[12,4],"UnderlineThickness","num",50],[[12,5],"PaintType","num",0],[[12,6],"CharstringType","num",2],[[12,7],"FontMatrix",["num","num","num","num","num","num"],[.001,0,0,.001,0,0]],[13,"UniqueID","num",null],[5,"FontBBox",["num","num","num","num"],[0,0,0,0]],[[12,8],"StrokeWidth","num",0],[14,"XUID","array",null],[15,"charset","offset",0],[16,"Encoding","offset",0],[17,"CharStrings","offset",0],[18,"Private",["offset","offset"],null],[[12,21],"PostScript","sid",null],[[12,22],"BaseFontName","sid",null],[[12,23],"BaseFontBlend","delta",null],[[12,31],"CIDFontVersion","num",0],[[12,32],"CIDFontRevision","num",0],[[12,33],"CIDFontType","num",0],[[12,34],"CIDCount","num",8720],[[12,35],"UIDBase","num",null],[[12,37],"FDSelect","offset",null],[[12,36],"FDArray","offset",null],[[12,38],"FontName","sid",null]];class jp extends PR{static get tables(){return Ze(this,"tables",this.createTables(rz))}constructor(e){super(jp.tables,e),this.privateDict=null}}const az=[[6,"BlueValues","delta",null],[7,"OtherBlues","delta",null],[8,"FamilyBlues","delta",null],[9,"FamilyOtherBlues","delta",null],[[12,9],"BlueScale","num",.039625],[[12,10],"BlueShift","num",7],[[12,11],"BlueFuzz","num",1],[10,"StdHW","num",null],[11,"StdVW","num",null],[[12,12],"StemSnapH","delta",null],[[12,13],"StemSnapV","delta",null],[[12,14],"ForceBold","num",0],[[12,17],"LanguageGroup","num",0],[[12,18],"ExpansionFactor","num",.06],[[12,19],"initialRandomSeed","num",0],[20,"defaultWidthX","num",0],[21,"nominalWidthX","num",0],[19,"Subrs","offset",null]];class Gp extends PR{static get tables(){return Ze(this,"tables",this.createTables(az))}constructor(e){super(Gp.tables,e),this.subrsIndex=null}}const xw={ISO_ADOBE:0,EXPERT:1,EXPERT_SUBSET:2};class rp{constructor(e,t,i,s){this.predefined=e,this.format=t,this.charset=i,this.raw=s}}class oz{constructor(e,t,i,s){this.predefined=e,this.format=t,this.encoding=i,this.raw=s}}class lz{constructor(e,t){this.format=e,this.fdSelect=t}getFDIndex(e){return e<0||e>=this.fdSelect.length?-1:this.fdSelect[e]}}class lk{constructor(){this.offsets=Object.create(null)}isTracking(e){return e in this.offsets}track(e,t){if(e in this.offsets)throw new Ee(`Already tracking location of ${e}`);this.offsets[e]=t}offset(e){for(const t in this.offsets)this.offsets[t]+=e}setEntryLocation(e,t,i){if(!(e in this.offsets))throw new Ee(`Not tracking location of ${e}`);const s=i.data,r=this.offsets[e],a=5;for(let o=0,l=t.length;o<l;++o){const c=o*a+r,h=c+1,u=c+2,d=c+3,f=c+4;if(s[c]!==29||s[h]!==0||s[u]!==0||s[d]!==0||s[f]!==0)throw new Ee("writing to an offset that is not empty");const g=t[o];s[c]=29,s[h]=g>>24&255,s[u]=g>>16&255,s[d]=g>>8&255,s[f]=g&255}}}class hx{constructor(e){this.cff=e}compile(){const e=this.cff,t={data:[],length:0,add(d){try{this.data.push(...d)}catch{this.data=this.data.concat(d)}this.length=this.data.length}},i=this.compileHeader(e.header);t.add(i);const s=this.compileNameIndex(e.names);if(t.add(s),e.isCIDFont&&e.topDict.hasName("FontMatrix")){const d=e.topDict.getByName("FontMatrix");e.topDict.removeByName("FontMatrix");for(const f of e.fdArray){let g=d.slice(0);f.hasName("FontMatrix")&&(g=Dn.transform(g,f.getByName("FontMatrix"))),f.setByName("FontMatrix",g)}}const r=e.topDict.getByName("XUID");(r==null?void 0:r.length)>16&&e.topDict.removeByName("XUID"),e.topDict.setByName("charset",0);let a=this.compileTopDicts([e.topDict],t.length,e.isCIDFont);t.add(a.output);const o=a.trackers[0],l=this.compileStringIndex(e.strings.strings);t.add(l);const c=this.compileIndex(e.globalSubrIndex);if(t.add(c),e.encoding&&e.topDict.hasName("Encoding"))if(e.encoding.predefined)o.setEntryLocation("Encoding",[e.encoding.format],t);else{const d=this.compileEncoding(e.encoding);o.setEntryLocation("Encoding",[t.length],t),t.add(d)}const h=this.compileCharset(e.charset,e.charStrings.count,e.strings,e.isCIDFont);o.setEntryLocation("charset",[t.length],t),t.add(h);const u=this.compileCharStrings(e.charStrings);if(o.setEntryLocation("CharStrings",[t.length],t),t.add(u),e.isCIDFont){o.setEntryLocation("FDSelect",[t.length],t);const d=this.compileFDSelect(e.fdSelect);t.add(d),a=this.compileTopDicts(e.fdArray,t.length,!0),o.setEntryLocation("FDArray",[t.length],t),t.add(a.output);const f=a.trackers;this.compilePrivateDicts(e.fdArray,f,t)}return this.compilePrivateDicts([e.topDict],[o],t),t.add([0]),t.data}encodeNumber(e){return Number.isInteger(e)?this.encodeInteger(e):this.encodeFloat(e)}static get EncodeFloatRegExp(){return Ze(this,"EncodeFloatRegExp",/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/)}encodeFloat(e){let t=e.toString();const i=hx.EncodeFloatRegExp.exec(t);if(i){const l=parseFloat("1e"+((i[2]?+i[2]:0)+i[1].length));t=(Math.round(e*l)/l).toString()}let s="",r,a;for(r=0,a=t.length;r<a;++r){const l=t[r];l==="e"?s+=t[++r]==="-"?"c":"b":l==="."?s+="a":l==="-"?s+="e":s+=l}s+=s.length&1?"f":"ff";const o=[30];for(r=0,a=s.length;r<a;r+=2)o.push(parseInt(s.substring(r,r+2),16));return o}encodeInteger(e){let t;return e>=-107&&e<=107?t=[e+139]:e>=108&&e<=1131?(e-=108,t=[(e>>8)+247,e&255]):e>=-1131&&e<=-108?(e=-e-108,t=[(e>>8)+251,e&255]):e>=-32768&&e<=32767?t=[28,e>>8&255,e&255]:t=[29,e>>24&255,e>>16&255,e>>8&255,e&255],t}compileHeader(e){return[e.major,e.minor,4,e.offSize]}compileNameIndex(e){const t=new Ih;for(const i of e){const s=Math.min(i.length,127);let r=new Array(s);for(let a=0;a<s;a++){let o=i[a];(o<"!"||o>"~"||o==="["||o==="]"||o==="("||o===")"||o==="{"||o==="}"||o==="<"||o===">"||o==="/"||o==="%")&&(o="_"),r[a]=o}r=r.join(""),r===""&&(r="Bad_Font_Name"),t.add(lr(r))}return this.compileIndex(t)}compileTopDicts(e,t,i){const s=[];let r=new Ih;for(const a of e){i&&(a.removeByName("CIDFontVersion"),a.removeByName("CIDFontRevision"),a.removeByName("CIDFontType"),a.removeByName("CIDCount"),a.removeByName("UIDBase"));const o=new lk,l=this.compileDict(a,o);s.push(o),r.add(l),o.offset(t)}return r=this.compileIndex(r,s),{trackers:s,output:r}}compilePrivateDicts(e,t,i){for(let s=0,r=e.length;s<r;++s){const a=e[s],o=a.privateDict;if(!o||!a.hasName("Private"))throw new Ee("There must be a private dictionary.");const l=new lk,c=this.compileDict(o,l);let h=i.length;if(l.offset(h),c.length||(h=0),t[s].setEntryLocation("Private",[c.length,h],i),i.add(c),o.subrsIndex&&o.hasName("Subrs")){const u=this.compileIndex(o.subrsIndex);l.setEntryLocation("Subrs",[c.length],i),i.add(u)}}}compileDict(e,t){const i=[];for(const s of e.order){if(!(s in e.values))continue;let r=e.values[s],a=e.types[s];if(Array.isArray(a)||(a=[a]),Array.isArray(r)||(r=[r]),r.length!==0){for(let o=0,l=a.length;o<l;++o){const c=a[o],h=r[o];switch(c){case"num":case"sid":i.push(...this.encodeNumber(h));break;case"offset":const u=e.keyToNameMap[s];t.isTracking(u)||t.track(u,i.length),i.push(29,0,0,0,0);break;case"array":case"delta":i.push(...this.encodeNumber(h));for(let d=1,f=r.length;d<f;++d)i.push(...this.encodeNumber(r[d]));break;default:throw new Ee(`Unknown data type of ${c}`)}}i.push(...e.opcodes[s])}}return i}compileStringIndex(e){const t=new Ih;for(const i of e)t.add(lr(i));return this.compileIndex(t)}compileCharStrings(e){const t=new Ih;for(let i=0;i<e.count;i++){const s=e.get(i);if(s.length===0){t.add(new Uint8Array([139,14]));continue}t.add(s)}return this.compileIndex(t)}compileCharset(e,t,i,s){let r;const a=t-1;if(s){const o=a-1;r=new Uint8Array([2,0,1,o>>8&255,o&255])}else{const o=1+a*2;r=new Uint8Array(o),r[0]=0;let l=0;const c=e.charset.length;let h=!1;for(let u=1;u<r.length;u+=2){let d=0;if(l<c){const f=e.charset[l++];d=i.getSID(f),d===-1&&(d=0,h||(h=!0,he(`Couldn't find ${f} in CFF strings`)))}r[u]=d>>8&255,r[u+1]=d&255}}return this.compileTypedArray(r)}compileEncoding(e){return this.compileTypedArray(e.raw)}compileFDSelect(e){const t=e.format;let i,s;switch(t){case 0:for(i=new Uint8Array(1+e.fdSelect.length),i[0]=t,s=0;s<e.fdSelect.length;s++)i[s+1]=e.fdSelect[s];break;case 3:const r=0;let a=e.fdSelect[0];const o=[t,0,0,r>>8&255,r&255,a];for(s=1;s<e.fdSelect.length;s++){const c=e.fdSelect[s];c!==a&&(o.push(s>>8&255,s&255,c),a=c)}const l=(o.length-3)/3;o[1]=l>>8&255,o[2]=l&255,o.push(s>>8&255,s&255),i=new Uint8Array(o);break}return this.compileTypedArray(i)}compileTypedArray(e){return Array.from(e)}compileIndex(e,t=[]){const i=e.objects,s=i.length;if(s===0)return[0,0];const r=[s>>8&255,s&255];let a=1,o;for(o=0;o<s;++o)a+=i[o].length;let l;a<256?l=1:a<65536?l=2:a<16777216?l=3:l=4,r.push(l);let c=1;for(o=0;o<s+1;o++)l===1?r.push(c&255):l===2?r.push(c>>8&255,c&255):l===3?r.push(c>>16&255,c>>8&255,c&255):r.push(c>>>24&255,c>>16&255,c>>8&255,c&255),i[o]&&(c+=i[o].length);for(o=0;o<s;o++)t[o]&&t[o].offset(r.length),r.push(...i[o]);return r}}const ty=Ai(function(n){n["Times-Roman"]="Times-Roman",n.Helvetica="Helvetica",n.Courier="Courier",n.Symbol="Symbol",n["Times-Bold"]="Times-Bold",n["Helvetica-Bold"]="Helvetica-Bold",n["Courier-Bold"]="Courier-Bold",n.ZapfDingbats="ZapfDingbats",n["Times-Italic"]="Times-Italic",n["Helvetica-Oblique"]="Helvetica-Oblique",n["Courier-Oblique"]="Courier-Oblique",n["Times-BoldItalic"]="Times-BoldItalic",n["Helvetica-BoldOblique"]="Helvetica-BoldOblique",n["Courier-BoldOblique"]="Courier-BoldOblique",n.ArialNarrow="Helvetica",n["ArialNarrow-Bold"]="Helvetica-Bold",n["ArialNarrow-BoldItalic"]="Helvetica-BoldOblique",n["ArialNarrow-Italic"]="Helvetica-Oblique",n.ArialBlack="Helvetica",n["ArialBlack-Bold"]="Helvetica-Bold",n["ArialBlack-BoldItalic"]="Helvetica-BoldOblique",n["ArialBlack-Italic"]="Helvetica-Oblique",n["Arial-Black"]="Helvetica",n["Arial-Black-Bold"]="Helvetica-Bold",n["Arial-Black-BoldItalic"]="Helvetica-BoldOblique",n["Arial-Black-Italic"]="Helvetica-Oblique",n.Arial="Helvetica",n["Arial-Bold"]="Helvetica-Bold",n["Arial-BoldItalic"]="Helvetica-BoldOblique",n["Arial-Italic"]="Helvetica-Oblique",n.ArialMT="Helvetica",n["Arial-BoldItalicMT"]="Helvetica-BoldOblique",n["Arial-BoldMT"]="Helvetica-Bold",n["Arial-ItalicMT"]="Helvetica-Oblique",n["Arial-BoldItalicMT-BoldItalic"]="Helvetica-BoldOblique",n["Arial-BoldMT-Bold"]="Helvetica-Bold",n["Arial-ItalicMT-Italic"]="Helvetica-Oblique",n.ArialUnicodeMS="Helvetica",n["ArialUnicodeMS-Bold"]="Helvetica-Bold",n["ArialUnicodeMS-BoldItalic"]="Helvetica-BoldOblique",n["ArialUnicodeMS-Italic"]="Helvetica-Oblique",n["Courier-BoldItalic"]="Courier-BoldOblique",n["Courier-Italic"]="Courier-Oblique",n.CourierNew="Courier",n["CourierNew-Bold"]="Courier-Bold",n["CourierNew-BoldItalic"]="Courier-BoldOblique",n["CourierNew-Italic"]="Courier-Oblique",n["CourierNewPS-BoldItalicMT"]="Courier-BoldOblique",n["CourierNewPS-BoldMT"]="Courier-Bold",n["CourierNewPS-ItalicMT"]="Courier-Oblique",n.CourierNewPSMT="Courier",n["Helvetica-BoldItalic"]="Helvetica-BoldOblique",n["Helvetica-Italic"]="Helvetica-Oblique",n["HelveticaLTStd-Bold"]="Helvetica-Bold",n["Symbol-Bold"]="Symbol",n["Symbol-BoldItalic"]="Symbol",n["Symbol-Italic"]="Symbol",n.TimesNewRoman="Times-Roman",n["TimesNewRoman-Bold"]="Times-Bold",n["TimesNewRoman-BoldItalic"]="Times-BoldItalic",n["TimesNewRoman-Italic"]="Times-Italic",n.TimesNewRomanPS="Times-Roman",n["TimesNewRomanPS-Bold"]="Times-Bold",n["TimesNewRomanPS-BoldItalic"]="Times-BoldItalic",n["TimesNewRomanPS-BoldItalicMT"]="Times-BoldItalic",n["TimesNewRomanPS-BoldMT"]="Times-Bold",n["TimesNewRomanPS-Italic"]="Times-Italic",n["TimesNewRomanPS-ItalicMT"]="Times-Italic",n.TimesNewRomanPSMT="Times-Roman",n["TimesNewRomanPSMT-Bold"]="Times-Bold",n["TimesNewRomanPSMT-BoldItalic"]="Times-BoldItalic",n["TimesNewRomanPSMT-Italic"]="Times-Italic"}),cz=Ai(function(n){n.Courier="FoxitFixed.pfb",n["Courier-Bold"]="FoxitFixedBold.pfb",n["Courier-BoldOblique"]="FoxitFixedBoldItalic.pfb",n["Courier-Oblique"]="FoxitFixedItalic.pfb",n.Helvetica="LiberationSans-Regular.ttf",n["Helvetica-Bold"]="LiberationSans-Bold.ttf",n["Helvetica-BoldOblique"]="LiberationSans-BoldItalic.ttf",n["Helvetica-Oblique"]="LiberationSans-Italic.ttf",n["Times-Roman"]="FoxitSerif.pfb",n["Times-Bold"]="FoxitSerifBold.pfb",n["Times-BoldItalic"]="FoxitSerifBoldItalic.pfb",n["Times-Italic"]="FoxitSerifItalic.pfb",n.Symbol="FoxitSymbol.pfb",n.ZapfDingbats="FoxitDingbats.pfb",n["LiberationSans-Regular"]="LiberationSans-Regular.ttf",n["LiberationSans-Bold"]="LiberationSans-Bold.ttf",n["LiberationSans-Italic"]="LiberationSans-Italic.ttf",n["LiberationSans-BoldItalic"]="LiberationSans-BoldItalic.ttf"}),NR=Ai(function(n){n.Calibri="Helvetica",n["Calibri-Bold"]="Helvetica-Bold",n["Calibri-BoldItalic"]="Helvetica-BoldOblique",n["Calibri-Italic"]="Helvetica-Oblique",n.CenturyGothic="Helvetica",n["CenturyGothic-Bold"]="Helvetica-Bold",n["CenturyGothic-BoldItalic"]="Helvetica-BoldOblique",n["CenturyGothic-Italic"]="Helvetica-Oblique",n.ComicSansMS="Comic Sans MS",n["ComicSansMS-Bold"]="Comic Sans MS-Bold",n["ComicSansMS-BoldItalic"]="Comic Sans MS-BoldItalic",n["ComicSansMS-Italic"]="Comic Sans MS-Italic",n.GillSansMT="Helvetica",n["GillSansMT-Bold"]="Helvetica-Bold",n["GillSansMT-BoldItalic"]="Helvetica-BoldOblique",n["GillSansMT-Italic"]="Helvetica-Oblique",n.Impact="Helvetica",n["ItcSymbol-Bold"]="Helvetica-Bold",n["ItcSymbol-BoldItalic"]="Helvetica-BoldOblique",n["ItcSymbol-Book"]="Helvetica",n["ItcSymbol-BookItalic"]="Helvetica-Oblique",n["ItcSymbol-Medium"]="Helvetica",n["ItcSymbol-MediumItalic"]="Helvetica-Oblique",n.LucidaConsole="Courier",n["LucidaConsole-Bold"]="Courier-Bold",n["LucidaConsole-BoldItalic"]="Courier-BoldOblique",n["LucidaConsole-Italic"]="Courier-Oblique",n["LucidaSans-Demi"]="Helvetica-Bold",n["MS-Gothic"]="MS Gothic",n["MS-Gothic-Bold"]="MS Gothic-Bold",n["MS-Gothic-BoldItalic"]="MS Gothic-BoldItalic",n["MS-Gothic-Italic"]="MS Gothic-Italic",n["MS-Mincho"]="MS Mincho",n["MS-Mincho-Bold"]="MS Mincho-Bold",n["MS-Mincho-BoldItalic"]="MS Mincho-BoldItalic",n["MS-Mincho-Italic"]="MS Mincho-Italic",n["MS-PGothic"]="MS PGothic",n["MS-PGothic-Bold"]="MS PGothic-Bold",n["MS-PGothic-BoldItalic"]="MS PGothic-BoldItalic",n["MS-PGothic-Italic"]="MS PGothic-Italic",n["MS-PMincho"]="MS PMincho",n["MS-PMincho-Bold"]="MS PMincho-Bold",n["MS-PMincho-BoldItalic"]="MS PMincho-BoldItalic",n["MS-PMincho-Italic"]="MS PMincho-Italic",n.NuptialScript="Times-Italic",n.SegoeUISymbol="Helvetica"}),C4=Ai(function(n){n["Adobe Jenson"]=!0,n["Adobe Text"]=!0,n.Albertus=!0,n.Aldus=!0,n.Alexandria=!0,n.Algerian=!0,n["American Typewriter"]=!0,n.Antiqua=!0,n.Apex=!0,n.Arno=!0,n.Aster=!0,n.Aurora=!0,n.Baskerville=!0,n.Bell=!0,n.Bembo=!0,n["Bembo Schoolbook"]=!0,n.Benguiat=!0,n["Berkeley Old Style"]=!0,n["Bernhard Modern"]=!0,n["Berthold City"]=!0,n.Bodoni=!0,n["Bauer Bodoni"]=!0,n["Book Antiqua"]=!0,n.Bookman=!0,n["Bordeaux Roman"]=!0,n["Californian FB"]=!0,n.Calisto=!0,n.Calvert=!0,n.Capitals=!0,n.Cambria=!0,n.Cartier=!0,n.Caslon=!0,n.Catull=!0,n.Centaur=!0,n["Century Old Style"]=!0,n["Century Schoolbook"]=!0,n.Chaparral=!0,n["Charis SIL"]=!0,n.Cheltenham=!0,n["Cholla Slab"]=!0,n.Clarendon=!0,n.Clearface=!0,n.Cochin=!0,n.Colonna=!0,n["Computer Modern"]=!0,n["Concrete Roman"]=!0,n.Constantia=!0,n["Cooper Black"]=!0,n.Corona=!0,n.Ecotype=!0,n.Egyptienne=!0,n.Elephant=!0,n.Excelsior=!0,n.Fairfield=!0,n["FF Scala"]=!0,n.Folkard=!0,n.Footlight=!0,n.FreeSerif=!0,n["Friz Quadrata"]=!0,n.Garamond=!0,n.Gentium=!0,n.Georgia=!0,n.Gloucester=!0,n["Goudy Old Style"]=!0,n["Goudy Schoolbook"]=!0,n["Goudy Pro Font"]=!0,n.Granjon=!0,n["Guardian Egyptian"]=!0,n.Heather=!0,n.Hercules=!0,n["High Tower Text"]=!0,n.Hiroshige=!0,n["Hoefler Text"]=!0,n["Humana Serif"]=!0,n.Imprint=!0,n["Ionic No. 5"]=!0,n.Janson=!0,n.Joanna=!0,n.Korinna=!0,n.Lexicon=!0,n.LiberationSerif=!0,n["Liberation Serif"]=!0,n["Linux Libertine"]=!0,n.Literaturnaya=!0,n.Lucida=!0,n["Lucida Bright"]=!0,n.Melior=!0,n.Memphis=!0,n.Miller=!0,n.Minion=!0,n.Modern=!0,n["Mona Lisa"]=!0,n["Mrs Eaves"]=!0,n["MS Serif"]=!0,n["Museo Slab"]=!0,n["New York"]=!0,n["Nimbus Roman"]=!0,n["NPS Rawlinson Roadway"]=!0,n.NuptialScript=!0,n.Palatino=!0,n.Perpetua=!0,n.Plantin=!0,n["Plantin Schoolbook"]=!0,n.Playbill=!0,n["Poor Richard"]=!0,n["Rawlinson Roadway"]=!0,n.Renault=!0,n.Requiem=!0,n.Rockwell=!0,n.Roman=!0,n["Rotis Serif"]=!0,n.Sabon=!0,n.Scala=!0,n.Seagull=!0,n.Sistina=!0,n.Souvenir=!0,n.STIX=!0,n["Stone Informal"]=!0,n["Stone Serif"]=!0,n.Sylfaen=!0,n.Times=!0,n.Trajan=!0,n.Trinité=!0,n["Trump Mediaeval"]=!0,n.Utopia=!0,n["Vale Type"]=!0,n["Bitstream Vera"]=!0,n["Vera Serif"]=!0,n.Versailles=!0,n.Wanted=!0,n.Weiss=!0,n["Wide Latin"]=!0,n.Windsor=!0,n.XITS=!0}),V7=Ai(function(n){n.Dingbats=!0,n.Symbol=!0,n.ZapfDingbats=!0,n.Wingdings=!0,n["Wingdings-Bold"]=!0,n["Wingdings-Regular"]=!0}),ck=Ai(function(n){n[2]=10,n[3]=32,n[4]=33,n[5]=34,n[6]=35,n[7]=36,n[8]=37,n[9]=38,n[10]=39,n[11]=40,n[12]=41,n[13]=42,n[14]=43,n[15]=44,n[16]=45,n[17]=46,n[18]=47,n[19]=48,n[20]=49,n[21]=50,n[22]=51,n[23]=52,n[24]=53,n[25]=54,n[26]=55,n[27]=56,n[28]=57,n[29]=58,n[30]=894,n[31]=60,n[32]=61,n[33]=62,n[34]=63,n[35]=64,n[36]=65,n[37]=66,n[38]=67,n[39]=68,n[40]=69,n[41]=70,n[42]=71,n[43]=72,n[44]=73,n[45]=74,n[46]=75,n[47]=76,n[48]=77,n[49]=78,n[50]=79,n[51]=80,n[52]=81,n[53]=82,n[54]=83,n[55]=84,n[56]=85,n[57]=86,n[58]=87,n[59]=88,n[60]=89,n[61]=90,n[62]=91,n[63]=92,n[64]=93,n[65]=94,n[66]=95,n[67]=96,n[68]=97,n[69]=98,n[70]=99,n[71]=100,n[72]=101,n[73]=102,n[74]=103,n[75]=104,n[76]=105,n[77]=106,n[78]=107,n[79]=108,n[80]=109,n[81]=110,n[82]=111,n[83]=112,n[84]=113,n[85]=114,n[86]=115,n[87]=116,n[88]=117,n[89]=118,n[90]=119,n[91]=120,n[92]=121,n[93]=122,n[94]=123,n[95]=124,n[96]=125,n[97]=126,n[98]=196,n[99]=197,n[100]=199,n[101]=201,n[102]=209,n[103]=214,n[104]=220,n[105]=225,n[106]=224,n[107]=226,n[108]=228,n[109]=227,n[110]=229,n[111]=231,n[112]=233,n[113]=232,n[114]=234,n[115]=235,n[116]=237,n[117]=236,n[118]=238,n[119]=239,n[120]=241,n[121]=243,n[122]=242,n[123]=244,n[124]=246,n[125]=245,n[126]=250,n[127]=249,n[128]=251,n[129]=252,n[130]=8224,n[131]=176,n[132]=162,n[133]=163,n[134]=167,n[135]=8226,n[136]=182,n[137]=223,n[138]=174,n[139]=169,n[140]=8482,n[141]=180,n[142]=168,n[143]=8800,n[144]=198,n[145]=216,n[146]=8734,n[147]=177,n[148]=8804,n[149]=8805,n[150]=165,n[151]=181,n[152]=8706,n[153]=8721,n[154]=8719,n[156]=8747,n[157]=170,n[158]=186,n[159]=8486,n[160]=230,n[161]=248,n[162]=191,n[163]=161,n[164]=172,n[165]=8730,n[166]=402,n[167]=8776,n[168]=8710,n[169]=171,n[170]=187,n[171]=8230,n[179]=8220,n[180]=8221,n[181]=8216,n[182]=8217,n[200]=193,n[203]=205,n[207]=211,n[210]=218,n[223]=711,n[224]=321,n[225]=322,n[226]=352,n[227]=353,n[228]=381,n[229]=382,n[233]=221,n[234]=253,n[252]=263,n[253]=268,n[254]=269,n[258]=258,n[260]=260,n[261]=261,n[265]=280,n[266]=281,n[267]=282,n[268]=283,n[269]=313,n[275]=323,n[276]=324,n[278]=328,n[283]=344,n[284]=345,n[285]=346,n[286]=347,n[292]=367,n[295]=377,n[296]=378,n[298]=380,n[305]=963,n[306]=964,n[307]=966,n[308]=8215,n[309]=8252,n[310]=8319,n[311]=8359,n[312]=8592,n[313]=8593,n[337]=9552,n[493]=1039,n[494]=1040,n[570]=1040,n[571]=1041,n[572]=1042,n[573]=1043,n[574]=1044,n[575]=1045,n[576]=1046,n[577]=1047,n[578]=1048,n[579]=1049,n[580]=1050,n[581]=1051,n[582]=1052,n[583]=1053,n[584]=1054,n[585]=1055,n[586]=1056,n[587]=1057,n[588]=1058,n[589]=1059,n[590]=1060,n[591]=1061,n[592]=1062,n[593]=1063,n[594]=1064,n[595]=1065,n[596]=1066,n[597]=1067,n[598]=1068,n[599]=1069,n[600]=1070,n[672]=1488,n[673]=1489,n[674]=1490,n[675]=1491,n[676]=1492,n[677]=1493,n[678]=1494,n[679]=1495,n[680]=1496,n[681]=1497,n[682]=1498,n[683]=1499,n[684]=1500,n[685]=1501,n[686]=1502,n[687]=1503,n[688]=1504,n[689]=1505,n[690]=1506,n[691]=1507,n[692]=1508,n[693]=1509,n[694]=1510,n[695]=1511,n[696]=1512,n[697]=1513,n[698]=1514,n[705]=1524,n[706]=8362,n[710]=64288,n[711]=64298,n[759]=1617,n[761]=1776,n[763]=1778,n[775]=1652,n[777]=1764,n[778]=1780,n[779]=1781,n[780]=1782,n[782]=771,n[783]=64726,n[786]=8363,n[788]=8532,n[790]=768,n[791]=769,n[792]=768,n[795]=803,n[797]=64336,n[798]=64337,n[799]=64342,n[800]=64343,n[801]=64344,n[802]=64345,n[803]=64362,n[804]=64363,n[805]=64364,n[2424]=7821,n[2425]=7822,n[2426]=7823,n[2427]=7824,n[2428]=7825,n[2429]=7826,n[2430]=7827,n[2433]=7682,n[2678]=8045,n[2679]=8046,n[2830]=1552,n[2838]=686,n[2840]=751,n[2842]=753,n[2843]=754,n[2844]=755,n[2846]=757,n[2856]=767,n[2857]=848,n[2858]=849,n[2862]=853,n[2863]=854,n[2864]=855,n[2865]=861,n[2866]=862,n[2906]=7460,n[2908]=7462,n[2909]=7463,n[2910]=7464,n[2912]=7466,n[2913]=7467,n[2914]=7468,n[2916]=7470,n[2917]=7471,n[2918]=7472,n[2920]=7474,n[2921]=7475,n[2922]=7476,n[2924]=7478,n[2925]=7479,n[2926]=7480,n[2928]=7482,n[2929]=7483,n[2930]=7484,n[2932]=7486,n[2933]=7487,n[2934]=7488,n[2936]=7490,n[2937]=7491,n[2938]=7492,n[2940]=7494,n[2941]=7495,n[2942]=7496,n[2944]=7498,n[2946]=7500,n[2948]=7502,n[2950]=7504,n[2951]=7505,n[2952]=7506,n[2954]=7508,n[2955]=7509,n[2956]=7510,n[2958]=7512,n[2959]=7513,n[2960]=7514,n[2962]=7516,n[2963]=7517,n[2964]=7518,n[2966]=7520,n[2967]=7521,n[2968]=7522,n[2970]=7524,n[2971]=7525,n[2972]=7526,n[2974]=7528,n[2975]=7529,n[2976]=7530,n[2978]=1537,n[2979]=1538,n[2980]=1539,n[2982]=1549,n[2983]=1551,n[2984]=1552,n[2986]=1554,n[2987]=1555,n[2988]=1556,n[2990]=1623,n[2991]=1624,n[2995]=1775,n[2999]=1791,n[3002]=64290,n[3003]=64291,n[3004]=64292,n[3006]=64294,n[3007]=64295,n[3008]=64296,n[3011]=1900,n[3014]=8223,n[3015]=8244,n[3017]=7532,n[3018]=7533,n[3019]=7534,n[3075]=7590,n[3076]=7591,n[3079]=7594,n[3080]=7595,n[3083]=7598,n[3084]=7599,n[3087]=7602,n[3088]=7603,n[3091]=7606,n[3092]=7607,n[3095]=7610,n[3096]=7611,n[3099]=7614,n[3100]=7615,n[3103]=7618,n[3104]=7619,n[3107]=8337,n[3108]=8338,n[3116]=1884,n[3119]=1885,n[3120]=1885,n[3123]=1886,n[3124]=1886,n[3127]=1887,n[3128]=1887,n[3131]=1888,n[3132]=1888,n[3135]=1889,n[3136]=1889,n[3139]=1890,n[3140]=1890,n[3143]=1891,n[3144]=1891,n[3147]=1892,n[3148]=1892,n[3153]=580,n[3154]=581,n[3157]=584,n[3158]=585,n[3161]=588,n[3162]=589,n[3165]=891,n[3166]=892,n[3169]=1274,n[3170]=1275,n[3173]=1278,n[3174]=1279,n[3181]=7622,n[3182]=7623,n[3282]=11799,n[3316]=578,n[3379]=42785,n[3393]=1159,n[3416]=8377}),hz=Ai(function(n){n[227]=322,n[264]=261,n[291]=346}),uz=Ai(function(n){n[1]=32,n[4]=65,n[5]=192,n[6]=193,n[9]=196,n[17]=66,n[18]=67,n[21]=268,n[24]=68,n[28]=69,n[29]=200,n[30]=201,n[32]=282,n[38]=70,n[39]=71,n[44]=72,n[47]=73,n[48]=204,n[49]=205,n[58]=74,n[60]=75,n[62]=76,n[68]=77,n[69]=78,n[75]=79,n[76]=210,n[80]=214,n[87]=80,n[89]=81,n[90]=82,n[92]=344,n[94]=83,n[97]=352,n[100]=84,n[104]=85,n[109]=220,n[115]=86,n[116]=87,n[121]=88,n[122]=89,n[124]=221,n[127]=90,n[129]=381,n[258]=97,n[259]=224,n[260]=225,n[263]=228,n[268]=261,n[271]=98,n[272]=99,n[273]=263,n[275]=269,n[282]=100,n[286]=101,n[287]=232,n[288]=233,n[290]=283,n[295]=281,n[296]=102,n[336]=103,n[346]=104,n[349]=105,n[350]=236,n[351]=237,n[361]=106,n[364]=107,n[367]=108,n[371]=322,n[373]=109,n[374]=110,n[381]=111,n[382]=242,n[383]=243,n[386]=246,n[393]=112,n[395]=113,n[396]=114,n[398]=345,n[400]=115,n[401]=347,n[403]=353,n[410]=116,n[437]=117,n[442]=252,n[448]=118,n[449]=119,n[454]=120,n[455]=121,n[457]=253,n[460]=122,n[462]=382,n[463]=380,n[853]=44,n[855]=58,n[856]=46,n[876]=47,n[878]=45,n[882]=45,n[894]=40,n[895]=41,n[896]=91,n[897]=93,n[923]=64,n[940]=163,n[1004]=48,n[1005]=49,n[1006]=50,n[1007]=51,n[1008]=52,n[1009]=53,n[1010]=54,n[1011]=55,n[1012]=56,n[1013]=57,n[1081]=37,n[1085]=43,n[1086]=45});function hk(n){const e=cx(n);return ty()[e]}function uk(n){const e=cx(n);return!!(ty()[e]||NR()[e]||C4()[e]||V7()[e])}class ap{constructor(e=[]){this._map=e}get length(){return this._map.length}forEach(e){for(const t in this._map)e(t,this._map[t].codePointAt(0))}has(e){return this._map[e]!==void 0}get(e){return this._map[e]}charCodeOf(e){const t=this._map;if(t.length<=65536)return t.indexOf(e);for(const i in t)if(t[i]===e)return i|0;return-1}amend(e){for(const t in e)this._map[t]=e[t]}}class ho{constructor(e,t){this.firstChar=e,this.lastChar=t}get length(){return this.lastChar+1-this.firstChar}forEach(e){for(let t=this.firstChar,i=this.lastChar;t<=i;t++)e(t,t)}has(e){return this.firstChar<=e&&e<=this.lastChar}get(e){if(this.firstChar<=e&&e<=this.lastChar)return String.fromCharCode(e)}charCodeOf(e){return Number.isInteger(e)&&e>=this.firstChar&&e<=this.lastChar?e:-1}amend(e){kn("Should not call amend()")}}class yw{constructor(e,t){this.properties=t;const i=new _4(e,t,e1);this.cff=i.parse(),this.cff.duplicateFirstGlyph();const s=new hx(this.cff);this.seacs=this.cff.seacs;try{this.data=s.compile()}catch{he("Failed to compile font "+t.loadedName),this.data=e}this._createBuiltInEncoding()}get numGlyphs(){return this.cff.charStrings.count}getCharset(){return this.cff.charset.charset}getGlyphMapping(){const e=this.cff,t=this.properties,{cidToGidMap:i,cMap:s}=t,r=e.charset.charset;let a,o;if(t.composite){let c;if((i==null?void 0:i.length)>0){c=Object.create(null);for(let u=0,d=i.length;u<d;u++){const f=i[u];f!==void 0&&(c[f]=u)}}a=Object.create(null);let h;if(e.isCIDFont)for(o=0;o<r.length;o++){const u=r[o];h=s.charCodeOf(u),(c==null?void 0:c[h])!==void 0&&(h=c[h]),a[h]=o}else for(o=0;o<e.charStrings.count;o++)h=s.charCodeOf(o),a[h]=o;return a}let l=e.encoding?e.encoding.encoding:null;return t.isInternalFont&&(l=t.defaultEncoding),a=TR(t,l,r),a}hasGlyphId(e){return this.cff.hasGlyphId(e)}_createBuiltInEncoding(){const{charset:e,encoding:t}=this.cff;if(!e||!t)return;const i=e.charset,s=t.encoding,r=[];for(const a in s){const o=s[a];if(o>=0){const l=i[o];l&&(r[a]=l)}}r.length>0&&(this.properties.builtInEncoding=r)}}function Jh(n,e){return Qc(n,e)/16384}function q7(n){const e=n.length;let t=32768;return e<1240?t=107:e<33900&&(t=1131),t}function dz(n,e,t){const i=xn(n,e+2)===1?Jn(n,e+8):Jn(n,e+16),s=xn(n,e+i);let r,a,o;if(s===4){xn(n,e+i+2);const l=xn(n,e+i+6)>>1;for(a=e+i+14,r=[],o=0;o<l;o++,a+=2)r[o]={end:xn(n,a)};for(a+=2,o=0;o<l;o++,a+=2)r[o].start=xn(n,a);for(o=0;o<l;o++,a+=2)r[o].idDelta=xn(n,a);for(o=0;o<l;o++,a+=2){let c=xn(n,a);if(c!==0){r[o].ids=[];for(let h=0,u=r[o].end-r[o].start+1;h<u;h++)r[o].ids[h]=xn(n,a+c),c+=2}}return r}else if(s===12){const l=Jn(n,e+i+12);for(a=e+i+16,r=[],o=0;o<l;o++)e=Jn(n,a),r.push({start:e,end:Jn(n,a+4),idDelta:Jn(n,a+8)-e}),a+=12;return r}throw new Ee(`unsupported cmap: ${s}`)}function fz(n,e,t,i){var o,l,c;const s={},a=new _4(new Ui(n,e,t-e),s,i).parse();return{glyphs:a.charStrings.objects,subrs:(l=(o=a.topDict.privateDict)==null?void 0:o.subrsIndex)==null?void 0:l.objects,gsubrs:(c=a.globalSubrIndex)==null?void 0:c.objects,isCFFCIDFont:a.isCIDFont,fdSelect:a.fdSelect,fdArray:a.fdArray}}function gz(n,e,t){let i,s;t?(i=4,s=Jn):(i=2,s=(o,l)=>2*xn(o,l));const r=[];let a=s(e,0);for(let o=i;o<e.length;o+=i){const l=s(e,o);r.push(n.subarray(a,l)),a=l}return r}function T3(n,e){const t=e.codePointAt(0);let i=0,s=0,r=n.length-1;for(;s<r;){const a=s+r+1>>1;t<n[a].start?r=a-1:s=a}return n[s].start<=t&&t<=n[s].end&&(i=n[s].idDelta+(n[s].ids?n[s].ids[t-n[s].start]:t)&65535),{charCode:t,glyphId:i}}function OR(n,e,t){function i(d,f){c&&e.add("L",c),c=[d,f],e.add("M",[d,f])}function s(d,f){e.add("L",[d,f])}function r(d,f,g,m){e.add("Q",[d,f,g,m])}let a=0;const o=Qc(n,a);let l,c=null,h=0,u=0;if(a+=10,o<0)do{l=xn(n,a);const d=xn(n,a+2);a+=4;let f,g;l&1?(l&2?(f=Qc(n,a),g=Qc(n,a+2)):(f=xn(n,a),g=xn(n,a+2)),a+=4):l&2?(f=vl(n,a++),g=vl(n,a++)):(f=n[a++],g=n[a++]),l&2?(h=f,u=g):(h=0,u=0);let m=1,x=1,p=0,y=0;l&8?(m=x=Jh(n,a),a+=2):l&64?(m=Jh(n,a),x=Jh(n,a+2),a+=4):l&128&&(m=Jh(n,a),p=Jh(n,a+2),y=Jh(n,a+4),x=Jh(n,a+6),a+=8);const w=t.glyphs[d];w&&(e.save(),e.transform([m,p,y,x,h,u]),OR(w,e,t),e.restore())}while(l&32);else{const d=[];let f,g;for(f=0;f<o;f++)d.push(xn(n,a)),a+=2;const m=xn(n,a);a+=2+m;const x=d.at(-1)+1,p=[];for(;p.length<x;){l=n[a++];let w=1;for(l&8&&(w+=n[a++]);w-- >0;)p.push({flags:l})}for(f=0;f<x;f++){switch(p[f].flags&18){case 0:h+=Qc(n,a),a+=2;break;case 2:h-=n[a++];break;case 18:h+=n[a++];break}p[f].x=h}for(f=0;f<x;f++){switch(p[f].flags&36){case 0:u+=Qc(n,a),a+=2;break;case 4:u-=n[a++];break;case 36:u+=n[a++];break}p[f].y=u}let y=0;for(a=0;a<o;a++){const w=d[a],v=p.slice(y,w+1);if(v[0].flags&1)v.push(v[0]);else if(v.at(-1).flags&1)v.unshift(v.at(-1));else{const _={flags:1,x:(v[0].x+v.at(-1).x)/2,y:(v[0].y+v.at(-1).y)/2};v.unshift(_),v.push(_)}for(i(v[0].x,v[0].y),f=1,g=v.length;f<g;f++)v[f].flags&1?s(v[f].x,v[f].y):v[f+1].flags&1?(r(v[f].x,v[f].y,v[f+1].x,v[f+1].y),f++):r(v[f].x,v[f].y,(v[f].x+v[f+1].x)/2,(v[f].y+v[f+1].y)/2);y=w+1}}}function W7(n,e,t,i){function s(f,g){u&&e.add("L",u),u=[f,g],e.add("M",[f,g])}function r(f,g){e.add("L",[f,g])}function a(f,g,m,x,p,y){e.add("C",[f,g,m,x,p,y])}const o=[];let l=0,c=0,h=0,u=null;function d(f){var m;let g=0;for(;g<f.length;){let x=!1,p=f[g++],y,w,v,_,C,k,I,S,R;switch(p){case 1:h+=o.length>>1,x=!0;break;case 3:h+=o.length>>1,x=!0;break;case 4:c+=o.pop(),s(l,c),x=!0;break;case 5:for(;o.length>0;)l+=o.shift(),c+=o.shift(),r(l,c);break;case 6:for(;o.length>0&&(l+=o.shift(),r(l,c),o.length!==0);)c+=o.shift(),r(l,c);break;case 7:for(;o.length>0&&(c+=o.shift(),r(l,c),o.length!==0);)l+=o.shift(),r(l,c);break;case 8:for(;o.length>0;)y=l+o.shift(),v=c+o.shift(),w=y+o.shift(),_=v+o.shift(),l=w+o.shift(),c=_+o.shift(),a(y,v,w,_,l,c);break;case 10:if(S=o.pop(),R=null,t.isCFFCIDFont){const P=t.fdSelect.getFDIndex(i);if(P>=0&&P<t.fdArray.length){const D=t.fdArray[P];let U;(m=D.privateDict)!=null&&m.subrsIndex&&(U=D.privateDict.subrsIndex.objects),U&&(S+=q7(U),R=U[S])}else he("Invalid fd index for glyph index.")}else R=t.subrs[S+t.subrsBias];R&&d(R);break;case 11:return;case 12:switch(p=f[g++],p){case 34:y=l+o.shift(),w=y+o.shift(),C=c+o.shift(),l=w+o.shift(),a(y,c,w,C,l,C),y=l+o.shift(),w=y+o.shift(),l=w+o.shift(),a(y,C,w,c,l,c);break;case 35:y=l+o.shift(),v=c+o.shift(),w=y+o.shift(),_=v+o.shift(),l=w+o.shift(),c=_+o.shift(),a(y,v,w,_,l,c),y=l+o.shift(),v=c+o.shift(),w=y+o.shift(),_=v+o.shift(),l=w+o.shift(),c=_+o.shift(),a(y,v,w,_,l,c),o.pop();break;case 36:y=l+o.shift(),C=c+o.shift(),w=y+o.shift(),k=C+o.shift(),l=w+o.shift(),a(y,C,w,k,l,k),y=l+o.shift(),w=y+o.shift(),I=k+o.shift(),l=w+o.shift(),a(y,k,w,I,l,c);break;case 37:const P=l,D=c;y=l+o.shift(),v=c+o.shift(),w=y+o.shift(),_=v+o.shift(),l=w+o.shift(),c=_+o.shift(),a(y,v,w,_,l,c),y=l+o.shift(),v=c+o.shift(),w=y+o.shift(),_=v+o.shift(),l=w,c=_,Math.abs(l-P)>Math.abs(c-D)?l+=o.shift():c+=o.shift(),a(y,v,w,_,l,c);break;default:throw new Ee(`unknown operator: 12 ${p}`)}break;case 14:if(o.length>=4){const P=o.pop(),D=o.pop();c=o.pop(),l=o.pop(),e.save(),e.translate(l,c);let U=T3(t.cmap,String.fromCharCode(t.glyphNameMap[s0[P]]));W7(t.glyphs[U.glyphId],e,t,U.glyphId),e.restore(),U=T3(t.cmap,String.fromCharCode(t.glyphNameMap[s0[D]])),W7(t.glyphs[U.glyphId],e,t,U.glyphId)}return;case 18:h+=o.length>>1,x=!0;break;case 19:h+=o.length>>1,g+=h+7>>3,x=!0;break;case 20:h+=o.length>>1,g+=h+7>>3,x=!0;break;case 21:c+=o.pop(),l+=o.pop(),s(l,c),x=!0;break;case 22:l+=o.pop(),s(l,c),x=!0;break;case 23:h+=o.length>>1,x=!0;break;case 24:for(;o.length>2;)y=l+o.shift(),v=c+o.shift(),w=y+o.shift(),_=v+o.shift(),l=w+o.shift(),c=_+o.shift(),a(y,v,w,_,l,c);l+=o.shift(),c+=o.shift(),r(l,c);break;case 25:for(;o.length>6;)l+=o.shift(),c+=o.shift(),r(l,c);y=l+o.shift(),v=c+o.shift(),w=y+o.shift(),_=v+o.shift(),l=w+o.shift(),c=_+o.shift(),a(y,v,w,_,l,c);break;case 26:for(o.length%2&&(l+=o.shift());o.length>0;)y=l,v=c+o.shift(),w=y+o.shift(),_=v+o.shift(),l=w,c=_+o.shift(),a(y,v,w,_,l,c);break;case 27:for(o.length%2&&(c+=o.shift());o.length>0;)y=l+o.shift(),v=c,w=y+o.shift(),_=v+o.shift(),l=w+o.shift(),c=_,a(y,v,w,_,l,c);break;case 28:o.push(Qc(f,g)),g+=2;break;case 29:S=o.pop()+t.gsubrsBias,R=t.gsubrs[S],R&&d(R);break;case 30:for(;o.length>0&&(y=l,v=c+o.shift(),w=y+o.shift(),_=v+o.shift(),l=w+o.shift(),c=_+(o.length===1?o.shift():0),a(y,v,w,_,l,c),o.length!==0);)y=l+o.shift(),v=c,w=y+o.shift(),_=v+o.shift(),c=_+o.shift(),l=w+(o.length===1?o.shift():0),a(y,v,w,_,l,c);break;case 31:for(;o.length>0&&(y=l+o.shift(),v=c,w=y+o.shift(),_=v+o.shift(),c=_+o.shift(),l=w+(o.length===1?o.shift():0),a(y,v,w,_,l,c),o.length!==0);)y=l,v=c+o.shift(),w=y+o.shift(),_=v+o.shift(),l=w+o.shift(),c=_+(o.length===1?o.shift():0),a(y,v,w,_,l,c);break;default:if(p<32)throw new Ee(`unknown operator: ${p}`);p<247?o.push(p-139):p<251?o.push((p-247)*256+f[g++]+108):p<255?o.push(-(p-251)*256-f[g++]-108):(o.push((f[g]<<24|f[g+1]<<16|f[g+2]<<8|f[g+3])/65536),g+=4);break}x&&(o.length=0)}}d(n)}const dk="";class mz{constructor(){ze(this,"cmds",[]);ze(this,"transformStack",[]);ze(this,"currentTransform",[1,0,0,1,0,0])}add(e,t){if(t){const{currentTransform:i}=this;for(let s=0,r=t.length;s<r;s+=2)Dn.applyTransform(t,i,s);this.cmds.push(`${e}${t.join(" ")}`)}else this.cmds.push(e)}transform(e){this.currentTransform=Dn.transform(this.currentTransform,e)}translate(e,t){this.transform([1,0,0,1,e,t])}save(){this.transformStack.push(this.currentTransform.slice())}restore(){this.currentTransform=this.transformStack.pop()||[1,0,0,1,0,0]}getSVG(){return this.cmds.join("")}}class DR{constructor(e){this.fontMatrix=e,this.compiledGlyphs=Object.create(null),this.compiledCharCodeToGlyphId=Object.create(null)}getPathJs(e){var a;const{charCode:t,glyphId:i}=T3(this.cmap,e);let s=this.compiledGlyphs[i],r;if(s===void 0){try{s=this.compileGlyph(this.glyphs[i],i)}catch(o){s=dk,r=o}this.compiledGlyphs[i]=s}if((a=this.compiledCharCodeToGlyphId)[t]??(a[t]=i),r)throw r;return s}compileGlyph(e,t){if(!(e!=null&&e.length)||e[0]===14)return dk;let i=this.fontMatrix;if(this.isCFFCIDFont){const r=this.fdSelect.getFDIndex(t);r>=0&&r<this.fdArray.length?i=this.fdArray[r].getByName("FontMatrix")||Dd:he("Invalid fd index for glyph index.")}Bs(Gr(i,6),"Expected a valid fontMatrix.");const s=new mz;return s.transform(i.slice()),this.compileGlyphImpl(e,s,t),s.add("Z"),s.getSVG()}compileGlyphImpl(){kn("Children classes should implement this.")}hasBuiltPath(e){const{charCode:t,glyphId:i}=T3(this.cmap,e);return this.compiledGlyphs[i]!==void 0&&this.compiledCharCodeToGlyphId[t]!==void 0}}class pz extends DR{constructor(e,t,i){super(i||[488e-6,0,0,488e-6,0,0]),this.glyphs=e,this.cmap=t}compileGlyphImpl(e,t){OR(e,t,this)}}class bz extends DR{constructor(e,t,i){super(i||[.001,0,0,.001,0,0]),this.glyphs=e.glyphs,this.gsubrs=e.gsubrs||[],this.subrs=e.subrs||[],this.cmap=t,this.glyphNameMap=Wl(),this.gsubrsBias=q7(this.gsubrs),this.subrsBias=q7(this.subrs),this.isCFFCIDFont=e.isCFFCIDFont,this.fdSelect=e.fdSelect,this.fdArray=e.fdArray}compileGlyphImpl(e,t,i){W7(e,t,this,i)}}class xz{static create(e,t){const i=new Uint8Array(e.data);let s,r,a,o,l,c;const h=xn(i,4);for(let u=0,d=12;u<h;u++,d+=16){const f=ua(i.subarray(d,d+4)),g=Jn(i,d+8),m=Jn(i,d+12);switch(f){case"cmap":s=dz(i,g);break;case"glyf":r=i.subarray(g,g+m);break;case"loca":a=i.subarray(g,g+m);break;case"head":c=xn(i,g+18),l=xn(i,g+50);break;case"CFF ":o=fz(i,g,g+m,t);break}}if(r){const u=c?[1/c,0,0,1/c,0,0]:e.fontMatrix;return new pz(gz(r,a,l),s,u)}return new bz(o,s,e.fontMatrix)}}const yz=Ai(function(n){n.Courier=600,n["Courier-Bold"]=600,n["Courier-BoldOblique"]=600,n["Courier-Oblique"]=600,n.Helvetica=Ai(function(e){e.space=278,e.exclam=278,e.quotedbl=355,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=667,e.quoteright=222,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=278,e.semicolon=278,e.less=584,e.equal=584,e.greater=584,e.question=556,e.at=1015,e.A=667,e.B=667,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=500,e.K=667,e.L=556,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=278,e.backslash=278,e.bracketright=278,e.asciicircum=469,e.underscore=556,e.quoteleft=222,e.a=556,e.b=556,e.c=500,e.d=556,e.e=556,e.f=278,e.g=556,e.h=556,e.i=222,e.j=222,e.k=500,e.l=222,e.m=833,e.n=556,e.o=556,e.p=556,e.q=556,e.r=333,e.s=500,e.t=278,e.u=556,e.v=500,e.w=722,e.x=500,e.y=500,e.z=500,e.braceleft=334,e.bar=260,e.braceright=334,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=191,e.quotedblleft=333,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=500,e.fl=500,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=537,e.bullet=350,e.quotesinglbase=222,e.quotedblbase=333,e.quotedblright=333,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=556,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=222,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=556,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=667,e.aacute=556,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=500,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=500,e.aring=556,e.Ncommaaccent=722,e.lacute=222,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=500,e.scedilla=500,e.iacute=278,e.lozenge=471,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=556,e.acircumflex=556,e.Amacron=667,e.rcaron=333,e.ccedilla=500,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=643,e.Umacron=722,e.uring=556,e.threesuperior=333,e.Ograve=778,e.Agrave=667,e.Abreve=667,e.multiply=584,e.uacute=556,e.Tcaron=611,e.partialdiff=476,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=500,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=260,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=333,e.omacron=556,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=222,e.tcaron=317,e.eogonek=556,e.Uogonek=722,e.Aacute=667,e.Adieresis=667,e.egrave=556,e.zacute=500,e.iogonek=222,e.Oacute=778,e.oacute=556,e.amacron=556,e.sacute=500,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=556,e.twosuperior=333,e.Odieresis=778,e.mu=556,e.igrave=278,e.ohungarumlaut=556,e.Eogonek=667,e.dcroat=556,e.threequarters=834,e.Scedilla=667,e.lcaron=299,e.Kcommaaccent=667,e.Lacute=556,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=556,e.onehalf=834,e.lessequal=549,e.ocircumflex=556,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=556,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=556,e.Ccaron=722,e.ugrave=556,e.radical=453,e.Dcaron=722,e.rcommaaccent=333,e.Ntilde=722,e.otilde=556,e.Rcommaaccent=722,e.Lcommaaccent=556,e.Atilde=667,e.Aogonek=667,e.Aring=667,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=500,e.minus=584,e.Icircumflex=278,e.ncaron=556,e.tcommaaccent=278,e.logicalnot=584,e.odieresis=556,e.udieresis=556,e.notequal=549,e.gcommaaccent=556,e.eth=556,e.zcaron=500,e.ncommaaccent=556,e.onesuperior=333,e.imacron=278,e.Euro=556}),n["Helvetica-Bold"]=Ai(function(e){e.space=278,e.exclam=333,e.quotedbl=474,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=722,e.quoteright=278,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=333,e.semicolon=333,e.less=584,e.equal=584,e.greater=584,e.question=611,e.at=975,e.A=722,e.B=722,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=556,e.K=722,e.L=611,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=584,e.underscore=556,e.quoteleft=278,e.a=556,e.b=611,e.c=556,e.d=611,e.e=556,e.f=333,e.g=611,e.h=611,e.i=278,e.j=278,e.k=556,e.l=278,e.m=889,e.n=611,e.o=611,e.p=611,e.q=611,e.r=389,e.s=556,e.t=333,e.u=611,e.v=556,e.w=778,e.x=556,e.y=556,e.z=500,e.braceleft=389,e.bar=280,e.braceright=389,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=238,e.quotedblleft=500,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=611,e.fl=611,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=556,e.bullet=350,e.quotesinglbase=278,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=611,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=278,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=611,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=722,e.aacute=556,e.Ucircumflex=722,e.yacute=556,e.scommaaccent=556,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=611,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=556,e.aring=556,e.Ncommaaccent=722,e.lacute=278,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=556,e.scedilla=556,e.iacute=278,e.lozenge=494,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=611,e.acircumflex=556,e.Amacron=722,e.rcaron=389,e.ccedilla=556,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=743,e.Umacron=722,e.uring=611,e.threesuperior=333,e.Ograve=778,e.Agrave=722,e.Abreve=722,e.multiply=584,e.uacute=611,e.Tcaron=611,e.partialdiff=494,e.ydieresis=556,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=556,e.nacute=611,e.umacron=611,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=280,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=389,e.omacron=611,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=278,e.tcaron=389,e.eogonek=556,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=556,e.zacute=500,e.iogonek=278,e.Oacute=778,e.oacute=611,e.amacron=556,e.sacute=556,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=611,e.twosuperior=333,e.Odieresis=778,e.mu=611,e.igrave=278,e.ohungarumlaut=611,e.Eogonek=667,e.dcroat=611,e.threequarters=834,e.Scedilla=667,e.lcaron=400,e.Kcommaaccent=722,e.Lacute=611,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=611,e.onehalf=834,e.lessequal=549,e.ocircumflex=611,e.ntilde=611,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=611,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=611,e.Ccaron=722,e.ugrave=611,e.radical=549,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=722,e.otilde=611,e.Rcommaaccent=722,e.Lcommaaccent=611,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=556,e.minus=584,e.Icircumflex=278,e.ncaron=611,e.tcommaaccent=333,e.logicalnot=584,e.odieresis=611,e.udieresis=611,e.notequal=549,e.gcommaaccent=611,e.eth=611,e.zcaron=500,e.ncommaaccent=611,e.onesuperior=333,e.imacron=278,e.Euro=556}),n["Helvetica-BoldOblique"]=Ai(function(e){e.space=278,e.exclam=333,e.quotedbl=474,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=722,e.quoteright=278,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=333,e.semicolon=333,e.less=584,e.equal=584,e.greater=584,e.question=611,e.at=975,e.A=722,e.B=722,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=556,e.K=722,e.L=611,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=584,e.underscore=556,e.quoteleft=278,e.a=556,e.b=611,e.c=556,e.d=611,e.e=556,e.f=333,e.g=611,e.h=611,e.i=278,e.j=278,e.k=556,e.l=278,e.m=889,e.n=611,e.o=611,e.p=611,e.q=611,e.r=389,e.s=556,e.t=333,e.u=611,e.v=556,e.w=778,e.x=556,e.y=556,e.z=500,e.braceleft=389,e.bar=280,e.braceright=389,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=238,e.quotedblleft=500,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=611,e.fl=611,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=556,e.bullet=350,e.quotesinglbase=278,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=611,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=278,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=611,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=722,e.aacute=556,e.Ucircumflex=722,e.yacute=556,e.scommaaccent=556,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=611,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=556,e.aring=556,e.Ncommaaccent=722,e.lacute=278,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=556,e.scedilla=556,e.iacute=278,e.lozenge=494,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=611,e.acircumflex=556,e.Amacron=722,e.rcaron=389,e.ccedilla=556,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=743,e.Umacron=722,e.uring=611,e.threesuperior=333,e.Ograve=778,e.Agrave=722,e.Abreve=722,e.multiply=584,e.uacute=611,e.Tcaron=611,e.partialdiff=494,e.ydieresis=556,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=556,e.nacute=611,e.umacron=611,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=280,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=389,e.omacron=611,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=278,e.tcaron=389,e.eogonek=556,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=556,e.zacute=500,e.iogonek=278,e.Oacute=778,e.oacute=611,e.amacron=556,e.sacute=556,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=611,e.twosuperior=333,e.Odieresis=778,e.mu=611,e.igrave=278,e.ohungarumlaut=611,e.Eogonek=667,e.dcroat=611,e.threequarters=834,e.Scedilla=667,e.lcaron=400,e.Kcommaaccent=722,e.Lacute=611,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=611,e.onehalf=834,e.lessequal=549,e.ocircumflex=611,e.ntilde=611,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=611,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=611,e.Ccaron=722,e.ugrave=611,e.radical=549,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=722,e.otilde=611,e.Rcommaaccent=722,e.Lcommaaccent=611,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=556,e.minus=584,e.Icircumflex=278,e.ncaron=611,e.tcommaaccent=333,e.logicalnot=584,e.odieresis=611,e.udieresis=611,e.notequal=549,e.gcommaaccent=611,e.eth=611,e.zcaron=500,e.ncommaaccent=611,e.onesuperior=333,e.imacron=278,e.Euro=556}),n["Helvetica-Oblique"]=Ai(function(e){e.space=278,e.exclam=278,e.quotedbl=355,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=667,e.quoteright=222,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=278,e.semicolon=278,e.less=584,e.equal=584,e.greater=584,e.question=556,e.at=1015,e.A=667,e.B=667,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=500,e.K=667,e.L=556,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=278,e.backslash=278,e.bracketright=278,e.asciicircum=469,e.underscore=556,e.quoteleft=222,e.a=556,e.b=556,e.c=500,e.d=556,e.e=556,e.f=278,e.g=556,e.h=556,e.i=222,e.j=222,e.k=500,e.l=222,e.m=833,e.n=556,e.o=556,e.p=556,e.q=556,e.r=333,e.s=500,e.t=278,e.u=556,e.v=500,e.w=722,e.x=500,e.y=500,e.z=500,e.braceleft=334,e.bar=260,e.braceright=334,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=191,e.quotedblleft=333,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=500,e.fl=500,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=537,e.bullet=350,e.quotesinglbase=222,e.quotedblbase=333,e.quotedblright=333,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=556,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=222,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=556,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=667,e.aacute=556,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=500,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=500,e.aring=556,e.Ncommaaccent=722,e.lacute=222,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=500,e.scedilla=500,e.iacute=278,e.lozenge=471,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=556,e.acircumflex=556,e.Amacron=667,e.rcaron=333,e.ccedilla=500,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=643,e.Umacron=722,e.uring=556,e.threesuperior=333,e.Ograve=778,e.Agrave=667,e.Abreve=667,e.multiply=584,e.uacute=556,e.Tcaron=611,e.partialdiff=476,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=500,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=260,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=333,e.omacron=556,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=222,e.tcaron=317,e.eogonek=556,e.Uogonek=722,e.Aacute=667,e.Adieresis=667,e.egrave=556,e.zacute=500,e.iogonek=222,e.Oacute=778,e.oacute=556,e.amacron=556,e.sacute=500,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=556,e.twosuperior=333,e.Odieresis=778,e.mu=556,e.igrave=278,e.ohungarumlaut=556,e.Eogonek=667,e.dcroat=556,e.threequarters=834,e.Scedilla=667,e.lcaron=299,e.Kcommaaccent=667,e.Lacute=556,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=556,e.onehalf=834,e.lessequal=549,e.ocircumflex=556,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=556,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=556,e.Ccaron=722,e.ugrave=556,e.radical=453,e.Dcaron=722,e.rcommaaccent=333,e.Ntilde=722,e.otilde=556,e.Rcommaaccent=722,e.Lcommaaccent=556,e.Atilde=667,e.Aogonek=667,e.Aring=667,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=500,e.minus=584,e.Icircumflex=278,e.ncaron=556,e.tcommaaccent=278,e.logicalnot=584,e.odieresis=556,e.udieresis=556,e.notequal=549,e.gcommaaccent=556,e.eth=556,e.zcaron=500,e.ncommaaccent=556,e.onesuperior=333,e.imacron=278,e.Euro=556}),n.Symbol=Ai(function(e){e.space=250,e.exclam=333,e.universal=713,e.numbersign=500,e.existential=549,e.percent=833,e.ampersand=778,e.suchthat=439,e.parenleft=333,e.parenright=333,e.asteriskmath=500,e.plus=549,e.comma=250,e.minus=549,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=278,e.semicolon=278,e.less=549,e.equal=549,e.greater=549,e.question=444,e.congruent=549,e.Alpha=722,e.Beta=667,e.Chi=722,e.Delta=612,e.Epsilon=611,e.Phi=763,e.Gamma=603,e.Eta=722,e.Iota=333,e.theta1=631,e.Kappa=722,e.Lambda=686,e.Mu=889,e.Nu=722,e.Omicron=722,e.Pi=768,e.Theta=741,e.Rho=556,e.Sigma=592,e.Tau=611,e.Upsilon=690,e.sigma1=439,e.Omega=768,e.Xi=645,e.Psi=795,e.Zeta=611,e.bracketleft=333,e.therefore=863,e.bracketright=333,e.perpendicular=658,e.underscore=500,e.radicalex=500,e.alpha=631,e.beta=549,e.chi=549,e.delta=494,e.epsilon=439,e.phi=521,e.gamma=411,e.eta=603,e.iota=329,e.phi1=603,e.kappa=549,e.lambda=549,e.mu=576,e.nu=521,e.omicron=549,e.pi=549,e.theta=521,e.rho=549,e.sigma=603,e.tau=439,e.upsilon=576,e.omega1=713,e.omega=686,e.xi=493,e.psi=686,e.zeta=494,e.braceleft=480,e.bar=200,e.braceright=480,e.similar=549,e.Euro=750,e.Upsilon1=620,e.minute=247,e.lessequal=549,e.fraction=167,e.infinity=713,e.florin=500,e.club=753,e.diamond=753,e.heart=753,e.spade=753,e.arrowboth=1042,e.arrowleft=987,e.arrowup=603,e.arrowright=987,e.arrowdown=603,e.degree=400,e.plusminus=549,e.second=411,e.greaterequal=549,e.multiply=549,e.proportional=713,e.partialdiff=494,e.bullet=460,e.divide=549,e.notequal=549,e.equivalence=549,e.approxequal=549,e.ellipsis=1e3,e.arrowvertex=603,e.arrowhorizex=1e3,e.carriagereturn=658,e.aleph=823,e.Ifraktur=686,e.Rfraktur=795,e.weierstrass=987,e.circlemultiply=768,e.circleplus=768,e.emptyset=823,e.intersection=768,e.union=768,e.propersuperset=713,e.reflexsuperset=713,e.notsubset=713,e.propersubset=713,e.reflexsubset=713,e.element=713,e.notelement=713,e.angle=768,e.gradient=713,e.registerserif=790,e.copyrightserif=790,e.trademarkserif=890,e.product=823,e.radical=549,e.dotmath=250,e.logicalnot=713,e.logicaland=603,e.logicalor=603,e.arrowdblboth=1042,e.arrowdblleft=987,e.arrowdblup=603,e.arrowdblright=987,e.arrowdbldown=603,e.lozenge=494,e.angleleft=329,e.registersans=790,e.copyrightsans=790,e.trademarksans=786,e.summation=713,e.parenlefttp=384,e.parenleftex=384,e.parenleftbt=384,e.bracketlefttp=384,e.bracketleftex=384,e.bracketleftbt=384,e.bracelefttp=494,e.braceleftmid=494,e.braceleftbt=494,e.braceex=494,e.angleright=329,e.integral=274,e.integraltp=686,e.integralex=686,e.integralbt=686,e.parenrighttp=384,e.parenrightex=384,e.parenrightbt=384,e.bracketrighttp=384,e.bracketrightex=384,e.bracketrightbt=384,e.bracerighttp=494,e.bracerightmid=494,e.bracerightbt=494,e.apple=790}),n["Times-Roman"]=Ai(function(e){e.space=250,e.exclam=333,e.quotedbl=408,e.numbersign=500,e.dollar=500,e.percent=833,e.ampersand=778,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=564,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=278,e.semicolon=278,e.less=564,e.equal=564,e.greater=564,e.question=444,e.at=921,e.A=722,e.B=667,e.C=667,e.D=722,e.E=611,e.F=556,e.G=722,e.H=722,e.I=333,e.J=389,e.K=722,e.L=611,e.M=889,e.N=722,e.O=722,e.P=556,e.Q=722,e.R=667,e.S=556,e.T=611,e.U=722,e.V=722,e.W=944,e.X=722,e.Y=722,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=469,e.underscore=500,e.quoteleft=333,e.a=444,e.b=500,e.c=444,e.d=500,e.e=444,e.f=333,e.g=500,e.h=500,e.i=278,e.j=278,e.k=500,e.l=278,e.m=778,e.n=500,e.o=500,e.p=500,e.q=500,e.r=333,e.s=389,e.t=278,e.u=500,e.v=500,e.w=722,e.x=500,e.y=500,e.z=444,e.braceleft=480,e.bar=200,e.braceright=480,e.asciitilde=541,e.exclamdown=333,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=180,e.quotedblleft=444,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=556,e.fl=556,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=453,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=444,e.quotedblright=444,e.guillemotright=500,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=444,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=889,e.ordfeminine=276,e.Lslash=611,e.Oslash=722,e.OE=889,e.ordmasculine=310,e.ae=667,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=722,e.germandbls=500,e.Idieresis=333,e.eacute=444,e.abreve=444,e.uhungarumlaut=500,e.ecaron=444,e.Ydieresis=722,e.divide=564,e.Yacute=722,e.Acircumflex=722,e.aacute=444,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=444,e.Uacute=722,e.uogonek=500,e.Edieresis=611,e.Dcroat=722,e.commaaccent=250,e.copyright=760,e.Emacron=611,e.ccaron=444,e.aring=444,e.Ncommaaccent=722,e.lacute=278,e.agrave=444,e.Tcommaaccent=611,e.Cacute=667,e.atilde=444,e.Edotaccent=611,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=471,e.Rcaron=667,e.Gcommaaccent=722,e.ucircumflex=500,e.acircumflex=444,e.Amacron=722,e.rcaron=333,e.ccedilla=444,e.Zdotaccent=611,e.Thorn=556,e.Omacron=722,e.Racute=667,e.Sacute=556,e.dcaron=588,e.Umacron=722,e.uring=500,e.threesuperior=300,e.Ograve=722,e.Agrave=722,e.Abreve=722,e.multiply=564,e.uacute=500,e.Tcaron=611,e.partialdiff=476,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=611,e.adieresis=444,e.edieresis=444,e.cacute=444,e.nacute=500,e.umacron=500,e.Ncaron=722,e.Iacute=333,e.plusminus=564,e.brokenbar=200,e.registered=760,e.Gbreve=722,e.Idotaccent=333,e.summation=600,e.Egrave=611,e.racute=333,e.omacron=500,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=667,e.lcommaaccent=278,e.tcaron=326,e.eogonek=444,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=444,e.zacute=444,e.iogonek=278,e.Oacute=722,e.oacute=500,e.amacron=444,e.sacute=389,e.idieresis=278,e.Ocircumflex=722,e.Ugrave=722,e.Delta=612,e.thorn=500,e.twosuperior=300,e.Odieresis=722,e.mu=500,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=611,e.dcroat=500,e.threequarters=750,e.Scedilla=556,e.lcaron=344,e.Kcommaaccent=722,e.Lacute=611,e.trademark=980,e.edotaccent=444,e.Igrave=333,e.Imacron=333,e.Lcaron=611,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=500,e.Uhungarumlaut=722,e.Eacute=611,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=556,e.Scommaaccent=556,e.Ohungarumlaut=722,e.degree=400,e.ograve=500,e.Ccaron=667,e.ugrave=500,e.radical=453,e.Dcaron=722,e.rcommaaccent=333,e.Ntilde=722,e.otilde=500,e.Rcommaaccent=667,e.Lcommaaccent=611,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=722,e.zdotaccent=444,e.Ecaron=611,e.Iogonek=333,e.kcommaaccent=500,e.minus=564,e.Icircumflex=333,e.ncaron=500,e.tcommaaccent=278,e.logicalnot=564,e.odieresis=500,e.udieresis=500,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=444,e.ncommaaccent=500,e.onesuperior=300,e.imacron=278,e.Euro=500}),n["Times-Bold"]=Ai(function(e){e.space=250,e.exclam=333,e.quotedbl=555,e.numbersign=500,e.dollar=500,e.percent=1e3,e.ampersand=833,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=570,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=333,e.semicolon=333,e.less=570,e.equal=570,e.greater=570,e.question=500,e.at=930,e.A=722,e.B=667,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=778,e.I=389,e.J=500,e.K=778,e.L=667,e.M=944,e.N=722,e.O=778,e.P=611,e.Q=778,e.R=722,e.S=556,e.T=667,e.U=722,e.V=722,e.W=1e3,e.X=722,e.Y=722,e.Z=667,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=581,e.underscore=500,e.quoteleft=333,e.a=500,e.b=556,e.c=444,e.d=556,e.e=444,e.f=333,e.g=500,e.h=556,e.i=278,e.j=333,e.k=556,e.l=278,e.m=833,e.n=556,e.o=500,e.p=556,e.q=556,e.r=444,e.s=389,e.t=333,e.u=556,e.v=500,e.w=722,e.x=500,e.y=500,e.z=444,e.braceleft=394,e.bar=220,e.braceright=394,e.asciitilde=520,e.exclamdown=333,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=278,e.quotedblleft=500,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=556,e.fl=556,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=540,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=500,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=500,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=300,e.Lslash=667,e.Oslash=778,e.OE=1e3,e.ordmasculine=330,e.ae=722,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=722,e.germandbls=556,e.Idieresis=389,e.eacute=444,e.abreve=500,e.uhungarumlaut=556,e.ecaron=444,e.Ydieresis=722,e.divide=570,e.Yacute=722,e.Acircumflex=722,e.aacute=500,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=500,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=747,e.Emacron=667,e.ccaron=444,e.aring=500,e.Ncommaaccent=722,e.lacute=278,e.agrave=500,e.Tcommaaccent=667,e.Cacute=722,e.atilde=500,e.Edotaccent=667,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=494,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=556,e.acircumflex=500,e.Amacron=722,e.rcaron=444,e.ccedilla=444,e.Zdotaccent=667,e.Thorn=611,e.Omacron=778,e.Racute=722,e.Sacute=556,e.dcaron=672,e.Umacron=722,e.uring=556,e.threesuperior=300,e.Ograve=778,e.Agrave=722,e.Abreve=722,e.multiply=570,e.uacute=556,e.Tcaron=667,e.partialdiff=494,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=500,e.edieresis=444,e.cacute=444,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=389,e.plusminus=570,e.brokenbar=220,e.registered=747,e.Gbreve=778,e.Idotaccent=389,e.summation=600,e.Egrave=667,e.racute=444,e.omacron=500,e.Zacute=667,e.Zcaron=667,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=278,e.tcaron=416,e.eogonek=444,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=444,e.zacute=444,e.iogonek=278,e.Oacute=778,e.oacute=500,e.amacron=500,e.sacute=389,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=556,e.twosuperior=300,e.Odieresis=778,e.mu=556,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=667,e.dcroat=556,e.threequarters=750,e.Scedilla=556,e.lcaron=394,e.Kcommaaccent=778,e.Lacute=667,e.trademark=1e3,e.edotaccent=444,e.Igrave=389,e.Imacron=389,e.Lcaron=667,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=556,e.Scommaaccent=556,e.Ohungarumlaut=778,e.degree=400,e.ograve=500,e.Ccaron=722,e.ugrave=556,e.radical=549,e.Dcaron=722,e.rcommaaccent=444,e.Ntilde=722,e.otilde=500,e.Rcommaaccent=722,e.Lcommaaccent=667,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=778,e.zdotaccent=444,e.Ecaron=667,e.Iogonek=389,e.kcommaaccent=556,e.minus=570,e.Icircumflex=389,e.ncaron=556,e.tcommaaccent=333,e.logicalnot=570,e.odieresis=500,e.udieresis=556,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=444,e.ncommaaccent=556,e.onesuperior=300,e.imacron=278,e.Euro=500}),n["Times-BoldItalic"]=Ai(function(e){e.space=250,e.exclam=389,e.quotedbl=555,e.numbersign=500,e.dollar=500,e.percent=833,e.ampersand=778,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=570,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=333,e.semicolon=333,e.less=570,e.equal=570,e.greater=570,e.question=500,e.at=832,e.A=667,e.B=667,e.C=667,e.D=722,e.E=667,e.F=667,e.G=722,e.H=778,e.I=389,e.J=500,e.K=667,e.L=611,e.M=889,e.N=722,e.O=722,e.P=611,e.Q=722,e.R=667,e.S=556,e.T=611,e.U=722,e.V=667,e.W=889,e.X=667,e.Y=611,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=570,e.underscore=500,e.quoteleft=333,e.a=500,e.b=500,e.c=444,e.d=500,e.e=444,e.f=333,e.g=500,e.h=556,e.i=278,e.j=278,e.k=500,e.l=278,e.m=778,e.n=556,e.o=500,e.p=500,e.q=500,e.r=389,e.s=389,e.t=278,e.u=556,e.v=444,e.w=667,e.x=500,e.y=444,e.z=389,e.braceleft=348,e.bar=220,e.braceright=348,e.asciitilde=570,e.exclamdown=389,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=278,e.quotedblleft=500,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=556,e.fl=556,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=500,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=500,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=500,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=944,e.ordfeminine=266,e.Lslash=611,e.Oslash=722,e.OE=944,e.ordmasculine=300,e.ae=722,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=722,e.germandbls=500,e.Idieresis=389,e.eacute=444,e.abreve=500,e.uhungarumlaut=556,e.ecaron=444,e.Ydieresis=611,e.divide=570,e.Yacute=611,e.Acircumflex=667,e.aacute=500,e.Ucircumflex=722,e.yacute=444,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=500,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=747,e.Emacron=667,e.ccaron=444,e.aring=500,e.Ncommaaccent=722,e.lacute=278,e.agrave=500,e.Tcommaaccent=611,e.Cacute=667,e.atilde=500,e.Edotaccent=667,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=494,e.Rcaron=667,e.Gcommaaccent=722,e.ucircumflex=556,e.acircumflex=500,e.Amacron=667,e.rcaron=389,e.ccedilla=444,e.Zdotaccent=611,e.Thorn=611,e.Omacron=722,e.Racute=667,e.Sacute=556,e.dcaron=608,e.Umacron=722,e.uring=556,e.threesuperior=300,e.Ograve=722,e.Agrave=667,e.Abreve=667,e.multiply=570,e.uacute=556,e.Tcaron=611,e.partialdiff=494,e.ydieresis=444,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=500,e.edieresis=444,e.cacute=444,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=389,e.plusminus=570,e.brokenbar=220,e.registered=747,e.Gbreve=722,e.Idotaccent=389,e.summation=600,e.Egrave=667,e.racute=389,e.omacron=500,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=667,e.lcommaaccent=278,e.tcaron=366,e.eogonek=444,e.Uogonek=722,e.Aacute=667,e.Adieresis=667,e.egrave=444,e.zacute=389,e.iogonek=278,e.Oacute=722,e.oacute=500,e.amacron=500,e.sacute=389,e.idieresis=278,e.Ocircumflex=722,e.Ugrave=722,e.Delta=612,e.thorn=500,e.twosuperior=300,e.Odieresis=722,e.mu=576,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=667,e.dcroat=500,e.threequarters=750,e.Scedilla=556,e.lcaron=382,e.Kcommaaccent=667,e.Lacute=611,e.trademark=1e3,e.edotaccent=444,e.Igrave=389,e.Imacron=389,e.Lcaron=611,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=556,e.Scommaaccent=556,e.Ohungarumlaut=722,e.degree=400,e.ograve=500,e.Ccaron=667,e.ugrave=556,e.radical=549,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=722,e.otilde=500,e.Rcommaaccent=667,e.Lcommaaccent=611,e.Atilde=667,e.Aogonek=667,e.Aring=667,e.Otilde=722,e.zdotaccent=389,e.Ecaron=667,e.Iogonek=389,e.kcommaaccent=500,e.minus=606,e.Icircumflex=389,e.ncaron=556,e.tcommaaccent=278,e.logicalnot=606,e.odieresis=500,e.udieresis=556,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=389,e.ncommaaccent=556,e.onesuperior=300,e.imacron=278,e.Euro=500}),n["Times-Italic"]=Ai(function(e){e.space=250,e.exclam=333,e.quotedbl=420,e.numbersign=500,e.dollar=500,e.percent=833,e.ampersand=778,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=675,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=333,e.semicolon=333,e.less=675,e.equal=675,e.greater=675,e.question=500,e.at=920,e.A=611,e.B=611,e.C=667,e.D=722,e.E=611,e.F=611,e.G=722,e.H=722,e.I=333,e.J=444,e.K=667,e.L=556,e.M=833,e.N=667,e.O=722,e.P=611,e.Q=722,e.R=611,e.S=500,e.T=556,e.U=722,e.V=611,e.W=833,e.X=611,e.Y=556,e.Z=556,e.bracketleft=389,e.backslash=278,e.bracketright=389,e.asciicircum=422,e.underscore=500,e.quoteleft=333,e.a=500,e.b=500,e.c=444,e.d=500,e.e=444,e.f=278,e.g=500,e.h=500,e.i=278,e.j=278,e.k=444,e.l=278,e.m=722,e.n=500,e.o=500,e.p=500,e.q=500,e.r=389,e.s=389,e.t=278,e.u=500,e.v=444,e.w=667,e.x=444,e.y=444,e.z=389,e.braceleft=400,e.bar=275,e.braceright=400,e.asciitilde=541,e.exclamdown=389,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=214,e.quotedblleft=556,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=500,e.fl=500,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=523,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=556,e.quotedblright=556,e.guillemotright=500,e.ellipsis=889,e.perthousand=1e3,e.questiondown=500,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=889,e.AE=889,e.ordfeminine=276,e.Lslash=556,e.Oslash=722,e.OE=944,e.ordmasculine=310,e.ae=667,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=667,e.germandbls=500,e.Idieresis=333,e.eacute=444,e.abreve=500,e.uhungarumlaut=500,e.ecaron=444,e.Ydieresis=556,e.divide=675,e.Yacute=556,e.Acircumflex=611,e.aacute=500,e.Ucircumflex=722,e.yacute=444,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=500,e.Uacute=722,e.uogonek=500,e.Edieresis=611,e.Dcroat=722,e.commaaccent=250,e.copyright=760,e.Emacron=611,e.ccaron=444,e.aring=500,e.Ncommaaccent=667,e.lacute=278,e.agrave=500,e.Tcommaaccent=556,e.Cacute=667,e.atilde=500,e.Edotaccent=611,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=471,e.Rcaron=611,e.Gcommaaccent=722,e.ucircumflex=500,e.acircumflex=500,e.Amacron=611,e.rcaron=389,e.ccedilla=444,e.Zdotaccent=556,e.Thorn=611,e.Omacron=722,e.Racute=611,e.Sacute=500,e.dcaron=544,e.Umacron=722,e.uring=500,e.threesuperior=300,e.Ograve=722,e.Agrave=611,e.Abreve=611,e.multiply=675,e.uacute=500,e.Tcaron=556,e.partialdiff=476,e.ydieresis=444,e.Nacute=667,e.icircumflex=278,e.Ecircumflex=611,e.adieresis=500,e.edieresis=444,e.cacute=444,e.nacute=500,e.umacron=500,e.Ncaron=667,e.Iacute=333,e.plusminus=675,e.brokenbar=275,e.registered=760,e.Gbreve=722,e.Idotaccent=333,e.summation=600,e.Egrave=611,e.racute=389,e.omacron=500,e.Zacute=556,e.Zcaron=556,e.greaterequal=549,e.Eth=722,e.Ccedilla=667,e.lcommaaccent=278,e.tcaron=300,e.eogonek=444,e.Uogonek=722,e.Aacute=611,e.Adieresis=611,e.egrave=444,e.zacute=389,e.iogonek=278,e.Oacute=722,e.oacute=500,e.amacron=500,e.sacute=389,e.idieresis=278,e.Ocircumflex=722,e.Ugrave=722,e.Delta=612,e.thorn=500,e.twosuperior=300,e.Odieresis=722,e.mu=500,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=611,e.dcroat=500,e.threequarters=750,e.Scedilla=500,e.lcaron=300,e.Kcommaaccent=667,e.Lacute=556,e.trademark=980,e.edotaccent=444,e.Igrave=333,e.Imacron=333,e.Lcaron=611,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=500,e.Uhungarumlaut=722,e.Eacute=611,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=500,e.Scommaaccent=500,e.Ohungarumlaut=722,e.degree=400,e.ograve=500,e.Ccaron=667,e.ugrave=500,e.radical=453,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=667,e.otilde=500,e.Rcommaaccent=611,e.Lcommaaccent=556,e.Atilde=611,e.Aogonek=611,e.Aring=611,e.Otilde=722,e.zdotaccent=389,e.Ecaron=611,e.Iogonek=333,e.kcommaaccent=444,e.minus=675,e.Icircumflex=333,e.ncaron=500,e.tcommaaccent=278,e.logicalnot=675,e.odieresis=500,e.udieresis=500,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=389,e.ncommaaccent=500,e.onesuperior=300,e.imacron=278,e.Euro=500}),n.ZapfDingbats=Ai(function(e){e.space=278,e.a1=974,e.a2=961,e.a202=974,e.a3=980,e.a4=719,e.a5=789,e.a119=790,e.a118=791,e.a117=690,e.a11=960,e.a12=939,e.a13=549,e.a14=855,e.a15=911,e.a16=933,e.a105=911,e.a17=945,e.a18=974,e.a19=755,e.a20=846,e.a21=762,e.a22=761,e.a23=571,e.a24=677,e.a25=763,e.a26=760,e.a27=759,e.a28=754,e.a6=494,e.a7=552,e.a8=537,e.a9=577,e.a10=692,e.a29=786,e.a30=788,e.a31=788,e.a32=790,e.a33=793,e.a34=794,e.a35=816,e.a36=823,e.a37=789,e.a38=841,e.a39=823,e.a40=833,e.a41=816,e.a42=831,e.a43=923,e.a44=744,e.a45=723,e.a46=749,e.a47=790,e.a48=792,e.a49=695,e.a50=776,e.a51=768,e.a52=792,e.a53=759,e.a54=707,e.a55=708,e.a56=682,e.a57=701,e.a58=826,e.a59=815,e.a60=789,e.a61=789,e.a62=707,e.a63=687,e.a64=696,e.a65=689,e.a66=786,e.a67=787,e.a68=713,e.a69=791,e.a70=785,e.a71=791,e.a72=873,e.a73=761,e.a74=762,e.a203=762,e.a75=759,e.a204=759,e.a76=892,e.a77=892,e.a78=788,e.a79=784,e.a81=438,e.a82=138,e.a83=277,e.a84=415,e.a97=392,e.a98=392,e.a99=668,e.a100=668,e.a89=390,e.a90=390,e.a93=317,e.a94=317,e.a91=276,e.a92=276,e.a205=509,e.a85=509,e.a206=410,e.a86=410,e.a87=234,e.a88=234,e.a95=334,e.a96=334,e.a101=732,e.a102=544,e.a103=544,e.a104=910,e.a106=667,e.a107=760,e.a108=760,e.a112=776,e.a111=595,e.a110=694,e.a109=626,e.a120=788,e.a121=788,e.a122=788,e.a123=788,e.a124=788,e.a125=788,e.a126=788,e.a127=788,e.a128=788,e.a129=788,e.a130=788,e.a131=788,e.a132=788,e.a133=788,e.a134=788,e.a135=788,e.a136=788,e.a137=788,e.a138=788,e.a139=788,e.a140=788,e.a141=788,e.a142=788,e.a143=788,e.a144=788,e.a145=788,e.a146=788,e.a147=788,e.a148=788,e.a149=788,e.a150=788,e.a151=788,e.a152=788,e.a153=788,e.a154=788,e.a155=788,e.a156=788,e.a157=788,e.a158=788,e.a159=788,e.a160=894,e.a161=838,e.a163=1016,e.a164=458,e.a196=748,e.a165=924,e.a192=748,e.a166=918,e.a167=927,e.a168=928,e.a169=928,e.a170=834,e.a171=873,e.a172=828,e.a173=924,e.a162=924,e.a174=917,e.a175=930,e.a176=931,e.a177=463,e.a178=883,e.a179=836,e.a193=836,e.a180=867,e.a199=867,e.a181=696,e.a200=696,e.a182=874,e.a201=874,e.a183=760,e.a184=946,e.a197=771,e.a185=865,e.a194=771,e.a198=888,e.a186=967,e.a195=888,e.a187=831,e.a188=873,e.a189=927,e.a190=970,e.a191=918})}),wz=Ai(function(n){n.Courier={ascent:629,descent:-157,capHeight:562,xHeight:-426},n["Courier-Bold"]={ascent:629,descent:-157,capHeight:562,xHeight:439},n["Courier-Oblique"]={ascent:629,descent:-157,capHeight:562,xHeight:426},n["Courier-BoldOblique"]={ascent:629,descent:-157,capHeight:562,xHeight:426},n.Helvetica={ascent:718,descent:-207,capHeight:718,xHeight:523},n["Helvetica-Bold"]={ascent:718,descent:-207,capHeight:718,xHeight:532},n["Helvetica-Oblique"]={ascent:718,descent:-207,capHeight:718,xHeight:523},n["Helvetica-BoldOblique"]={ascent:718,descent:-207,capHeight:718,xHeight:532},n["Times-Roman"]={ascent:683,descent:-217,capHeight:662,xHeight:450},n["Times-Bold"]={ascent:683,descent:-217,capHeight:676,xHeight:461},n["Times-Italic"]={ascent:683,descent:-217,capHeight:653,xHeight:441},n["Times-BoldItalic"]={ascent:683,descent:-217,capHeight:669,xHeight:462},n.Symbol={ascent:Math.NaN,descent:Math.NaN,capHeight:Math.NaN,xHeight:Math.NaN},n.ZapfDingbats={ascent:Math.NaN,descent:Math.NaN,capHeight:Math.NaN,xHeight:Math.NaN}}),vz=1,Kx=2,Xx=4,fk=8,km=16,Cm=32,_z=64,Am=1,Yx=2,kz=8,Cz=32,Az=64,Sz=128,ww=256;class Iz{constructor({glyfTable:e,isGlyphLocationsLong:t,locaTable:i,numGlyphs:s}){this.glyphs=[];const r=new DataView(i.buffer,i.byteOffset,i.byteLength),a=new DataView(e.buffer,e.byteOffset,e.byteLength),o=t?4:2;let l=t?r.getUint32(0):2*r.getUint16(0),c=0;for(let h=0;h<s;h++){c+=o;const u=t?r.getUint32(c):2*r.getUint16(c);if(u===l){this.glyphs.push(new Vp({}));continue}const d=Vp.parse(l,a);this.glyphs.push(d),l=u}}getSize(){return Math.sumPrecise(this.glyphs.map(e=>e.getSize()+3&-4))}write(){const e=this.getSize(),t=new DataView(new ArrayBuffer(e)),i=e>131070,s=i?4:2,r=new DataView(new ArrayBuffer((this.glyphs.length+1)*s));i?r.setUint32(0,0):r.setUint16(0,0);let a=0,o=0;for(const l of this.glyphs)a+=l.write(a,t),a=a+3&-4,o+=s,i?r.setUint32(o,a):r.setUint16(o,a>>1);return{isLocationLong:i,loca:new Uint8Array(r.buffer),glyf:new Uint8Array(t.buffer)}}scale(e){for(let t=0,i=this.glyphs.length;t<i;t++)this.glyphs[t].scale(e[t])}}class Vp{constructor({header:e=null,simple:t=null,composites:i=null}){this.header=e,this.simple=t,this.composites=i}static parse(e,t){const[i,s]=A4.parse(e,t);if(e+=i,s.numberOfContours<0){const a=[];for(;;){const[o,l]=I4.parse(e,t);if(e+=o,a.push(l),!(l.flags&Cz))break}return new Vp({header:s,composites:a})}const r=S4.parse(e,t,s.numberOfContours);return new Vp({header:s,simple:r})}getSize(){if(!this.header)return 0;const e=this.simple?this.simple.getSize():Math.sumPrecise(this.composites.map(t=>t.getSize()));return this.header.getSize()+e}write(e,t){if(!this.header)return 0;const i=e;if(e+=this.header.write(e,t),this.simple)e+=this.simple.write(e,t);else for(const s of this.composites)e+=s.write(e,t);return e-i}scale(e){if(!this.header)return;const t=(this.header.xMin+this.header.xMax)/2;if(this.header.scale(t,e),this.simple)this.simple.scale(t,e);else for(const i of this.composites)i.scale(t,e)}}class A4{constructor({numberOfContours:e,xMin:t,yMin:i,xMax:s,yMax:r}){this.numberOfContours=e,this.xMin=t,this.yMin=i,this.xMax=s,this.yMax=r}static parse(e,t){return[10,new A4({numberOfContours:t.getInt16(e),xMin:t.getInt16(e+2),yMin:t.getInt16(e+4),xMax:t.getInt16(e+6),yMax:t.getInt16(e+8)})]}getSize(){return 10}write(e,t){return t.setInt16(e,this.numberOfContours),t.setInt16(e+2,this.xMin),t.setInt16(e+4,this.yMin),t.setInt16(e+6,this.xMax),t.setInt16(e+8,this.yMax),10}scale(e,t){this.xMin=Math.round(e+(this.xMin-e)*t),this.xMax=Math.round(e+(this.xMax-e)*t)}}class Ez{constructor({flags:e,xCoordinates:t,yCoordinates:i}){this.xCoordinates=t,this.yCoordinates=i,this.flags=e}}class S4{constructor({contours:e,instructions:t}){this.contours=e,this.instructions=t}static parse(e,t,i){const s=[];for(let x=0;x<i;x++){const p=t.getUint16(e);e+=2,s.push(p)}const r=s[i-1]+1,a=t.getUint16(e);e+=2;const o=new Uint8Array(t).slice(e,e+a);e+=a;const l=[];for(let x=0;x<r;e++,x++){let p=t.getUint8(e);if(l.push(p),p&fk){const y=t.getUint8(++e);p^=fk;for(let w=0;w<y;w++)l.push(p);x+=y}}const c=[];let h=[],u=[],d=[];const f=[];let g=0,m=0;for(let x=0;x<r;x++){const p=l[x];if(p&Kx){const y=t.getUint8(e++);m+=p&km?y:-y,h.push(m)}else p&km||(m+=t.getInt16(e),e+=2),h.push(m);s[g]===x&&(g++,c.push(h),h=[])}m=0,g=0;for(let x=0;x<r;x++){const p=l[x];if(p&Xx){const y=t.getUint8(e++);m+=p&Cm?y:-y,u.push(m)}else p&Cm||(m+=t.getInt16(e),e+=2),u.push(m);d.push(p&vz|p&_z),s[g]===x&&(h=c[g],g++,f.push(new Ez({flags:d,xCoordinates:h,yCoordinates:u})),u=[],d=[])}return new S4({contours:f,instructions:o})}getSize(){let e=this.contours.length*2+2+this.instructions.length,t=0,i=0;for(const s of this.contours){e+=s.flags.length;for(let r=0,a=s.xCoordinates.length;r<a;r++){const o=s.xCoordinates[r],l=s.yCoordinates[r];let c=Math.abs(o-t);c>255?e+=2:c>0&&(e+=1),t=o,c=Math.abs(l-i),c>255?e+=2:c>0&&(e+=1),i=l}}return e}write(e,t){const i=e,s=[],r=[],a=[];let o=0,l=0;for(const c of this.contours){for(let h=0,u=c.xCoordinates.length;h<u;h++){let d=c.flags[h];const f=c.xCoordinates[h];let g=f-o;if(g===0)d|=km,s.push(0);else{const x=Math.abs(g);x<=255?(d|=g>=0?Kx|km:Kx,s.push(x)):s.push(g)}o=f;const m=c.yCoordinates[h];if(g=m-l,g===0)d|=Cm,r.push(0);else{const x=Math.abs(g);x<=255?(d|=g>=0?Xx|Cm:Xx,r.push(x)):r.push(g)}l=m,a.push(d)}t.setUint16(e,s.length-1),e+=2}t.setUint16(e,this.instructions.length),e+=2,this.instructions.length&&(new Uint8Array(t.buffer,0,t.buffer.byteLength).set(this.instructions,e),e+=this.instructions.length);for(const c of a)t.setUint8(e++,c);for(let c=0,h=s.length;c<h;c++){const u=s[c],d=a[c];d&Kx?t.setUint8(e++,u):d&km||(t.setInt16(e,u),e+=2)}for(let c=0,h=r.length;c<h;c++){const u=r[c],d=a[c];d&Xx?t.setUint8(e++,u):d&Cm||(t.setInt16(e,u),e+=2)}return e-i}scale(e,t){for(const i of this.contours)if(i.xCoordinates.length!==0)for(let s=0,r=i.xCoordinates.length;s<r;s++)i.xCoordinates[s]=Math.round(e+(i.xCoordinates[s]-e)*t)}}class I4{constructor({flags:e,glyphIndex:t,argument1:i,argument2:s,transf:r,instructions:a}){this.flags=e,this.glyphIndex=t,this.argument1=i,this.argument2=s,this.transf=r,this.instructions=a}static parse(e,t){const i=e,s=[];let r=t.getUint16(e);const a=t.getUint16(e+2);e+=4;let o,l;r&Am?(r&Yx?(o=t.getInt16(e),l=t.getInt16(e+2)):(o=t.getUint16(e),l=t.getUint16(e+2)),e+=4,r^=Am):(r&Yx?(o=t.getInt8(e),l=t.getInt8(e+1)):(o=t.getUint8(e),l=t.getUint8(e+1)),e+=2),r&kz?(s.push(t.getUint16(e)),e+=2):r&Az?(s.push(t.getUint16(e),t.getUint16(e+2)),e+=4):r&Sz&&(s.push(t.getUint16(e),t.getUint16(e+2),t.getUint16(e+4),t.getUint16(e+6)),e+=8);let c=null;if(r&ww){const h=t.getUint16(e);e+=2,c=new Uint8Array(t).slice(e,e+h),e+=h}return[e-i,new I4({flags:r,glyphIndex:a,argument1:o,argument2:l,transf:s,instructions:c})]}getSize(){let e=4+this.transf.length*2;return this.flags&ww&&(e+=2+this.instructions.length),e+=2,this.flags&2?this.argument1>=-128&&this.argument1<=127&&this.argument2>=-128&&this.argument2<=127||(e+=2):this.argument1>=0&&this.argument1<=255&&this.argument2>=0&&this.argument2<=255||(e+=2),e}write(e,t){const i=e;return this.flags&Yx?this.argument1>=-128&&this.argument1<=127&&this.argument2>=-128&&this.argument2<=127||(this.flags|=Am):this.argument1>=0&&this.argument1<=255&&this.argument2>=0&&this.argument2<=255||(this.flags|=Am),t.setUint16(e,this.flags),t.setUint16(e+2,this.glyphIndex),e+=4,this.flags&Am?(this.flags&Yx?(t.setInt16(e,this.argument1),t.setInt16(e+2,this.argument2)):(t.setUint16(e,this.argument1),t.setUint16(e+2,this.argument2)),e+=4):(t.setUint8(e,this.argument1),t.setUint8(e+1,this.argument2),e+=2),this.flags&ww&&(t.setUint16(e,this.instructions.length),e+=2,this.instructions.length&&(new Uint8Array(t.buffer,0,t.buffer.byteLength).set(this.instructions,e),e+=this.instructions.length)),e-i}scale(e,t){}}function Jx(n,e,t){n[e]=t>>8&255,n[e+1]=t&255}function vw(n,e,t){n[e]=t>>24&255,n[e+1]=t>>16&255,n[e+2]=t>>8&255,n[e+3]=t&255}function Tz(n,e,t){if(t instanceof Uint8Array)n.set(t,e);else if(typeof t=="string")for(let i=0,s=t.length;i<s;i++)n[e++]=t.charCodeAt(i)&255;else for(const i of t)n[e++]=i&255}const gk=12,mk=16;class qp{constructor(e){this.sfnt=e,this.tables=Object.create(null)}static getSearchParams(e,t){let i=1,s=0;for(;(i^e)>i;)i<<=1,s++;const r=i*t;return{range:r,entry:s,rangeShift:t*e-r}}toArray(){let e=this.sfnt;const t=this.tables,i=Object.keys(t);i.sort();const s=i.length;let r,a,o,l,c,h=gk+s*mk;const u=[h];for(r=0;r<s;r++){l=t[i[r]];const g=(l.length+3&-4)>>>0;h+=g,u.push(h)}const d=new Uint8Array(h);for(r=0;r<s;r++)l=t[i[r]],Tz(d,u[r],l);e==="true"&&(e=rr(65536)),d[0]=e.charCodeAt(0)&255,d[1]=e.charCodeAt(1)&255,d[2]=e.charCodeAt(2)&255,d[3]=e.charCodeAt(3)&255,Jx(d,4,s);const f=qp.getSearchParams(s,16);for(Jx(d,6,f.range),Jx(d,8,f.entry),Jx(d,10,f.rangeShift),h=gk,r=0;r<s;r++){c=i[r],d[h]=c.charCodeAt(0)&255,d[h+1]=c.charCodeAt(1)&255,d[h+2]=c.charCodeAt(2)&255,d[h+3]=c.charCodeAt(3)&255;let g=0;for(a=u[r],o=u[r+1];a<o;a+=4){const m=Jn(d,a);g=g+m>>>0}vw(d,h+4,g),vw(d,h+8,u[r]),vw(d,h+12,t[c].length),h+=mk}return d}addTable(e,t){if(e in this.tables)throw new Error("Table "+e+" already exists");this.tables[e]=t}}const Rz=!1,Pr={hstem:[1],vstem:[3],vmoveto:[4],rlineto:[5],hlineto:[6],vlineto:[7],rrcurveto:[8],callsubr:[10],flex:[12,35],drop:[12,18],endchar:[14],rmoveto:[21],hmoveto:[22],vhcurveto:[30],hvcurveto:[31]};class Mz{constructor(){this.width=0,this.lsb=0,this.flexing=!1,this.output=[],this.stack=[]}convert(e,t,i){const s=e.length;let r=!1,a,o,l;for(let c=0;c<s;c++){let h=e[c];if(h<32){switch(h===12&&(h=(h<<8)+e[++c]),h){case 1:{this.stack=[];break}case 3:{this.stack=[];break}case 4:if(this.flexing){if(this.stack.length<1){r=!0;break}const m=this.stack.pop();this.stack.push(0,m);break}r=this.executeCommand(1,Pr.vmoveto);break;case 5:r=this.executeCommand(2,Pr.rlineto);break;case 6:r=this.executeCommand(1,Pr.hlineto);break;case 7:r=this.executeCommand(1,Pr.vlineto);break;case 8:r=this.executeCommand(6,Pr.rrcurveto);break;case 9:this.stack=[];break;case 10:if(this.stack.length<1){r=!0;break}if(l=this.stack.pop(),!t[l]){r=!0;break}r=this.convert(t[l],t,i);break;case 11:return r;case 13:if(this.stack.length<2){r=!0;break}a=this.stack.pop(),o=this.stack.pop(),this.lsb=o,this.width=a,this.stack.push(a,o),r=this.executeCommand(2,Pr.hmoveto);break;case 14:this.output.push(Pr.endchar[0]);break;case 21:if(this.flexing)break;r=this.executeCommand(2,Pr.rmoveto);break;case 22:if(this.flexing){this.stack.push(0);break}r=this.executeCommand(1,Pr.hmoveto);break;case 30:r=this.executeCommand(4,Pr.vhcurveto);break;case 31:r=this.executeCommand(4,Pr.hvcurveto);break;case 3072:this.stack=[];break;case 3073:{this.stack=[];break}case 3074:{this.stack=[];break}case 3078:if(i){const m=this.stack.at(-5);this.seac=this.stack.splice(-4,4),this.seac[0]+=this.lsb-m,r=this.executeCommand(0,Pr.endchar)}else r=this.executeCommand(4,Pr.endchar);break;case 3079:if(this.stack.length<4){r=!0;break}this.stack.pop(),a=this.stack.pop();const u=this.stack.pop();o=this.stack.pop(),this.lsb=o,this.width=a,this.stack.push(a,o,u),r=this.executeCommand(3,Pr.rmoveto);break;case 3084:if(this.stack.length<2){r=!0;break}const d=this.stack.pop(),f=this.stack.pop();this.stack.push(f/d);break;case 3088:if(this.stack.length<2){r=!0;break}l=this.stack.pop();const g=this.stack.pop();if(l===0&&g===3){const m=this.stack.splice(-17,17);this.stack.push(m[2]+m[0],m[3]+m[1],m[4],m[5],m[6],m[7],m[8],m[9],m[10],m[11],m[12],m[13],m[14]),r=this.executeCommand(13,Pr.flex,!0),this.flexing=!1,this.stack.push(m[15],m[16])}else l===1&&g===0&&(this.flexing=!0);break;case 3089:break;case 3105:this.stack=[];break;default:he('Unknown type 1 charstring command of "'+h+'"');break}if(r)break;continue}else h<=246?h-=139:h<=250?h=(h-247)*256+e[++c]+108:h<=254?h=-((h-251)*256)-e[++c]-108:h=(e[++c]&255)<<24|(e[++c]&255)<<16|(e[++c]&255)<<8|(e[++c]&255)<<0;this.stack.push(h)}return r}executeCommand(e,t,i){const s=this.stack.length;if(e>s)return!0;const r=s-e;for(let a=r;a<s;a++){let o=this.stack[a];Number.isInteger(o)?this.output.push(28,o>>8&255,o&255):(o=65536*o|0,this.output.push(255,o>>24&255,o>>16&255,o>>8&255,o&255))}return this.output.push(...t),i?this.stack.splice(r,e):this.stack.length=0,!1}}const pk=55665,Pz=4330;function _l(n){return n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102}function bk(n,e,t){if(t>=n.length)return new Uint8Array(0);const i=52845,s=22719;let r=e|0,a,o;for(a=0;a<t;a++)r=(n[a]+r)*i+s&65535;const l=n.length-t,c=new Uint8Array(l);for(a=t,o=0;o<l;a++,o++){const h=n[a];c[o]=h^r>>8,r=(h+r)*i+s&65535}return c}function Nz(n,e,t){let r=e|0;const a=n.length,o=a>>>1,l=new Uint8Array(o);let c,h;for(c=0,h=0;c<a;c++){const u=n[c];if(!_l(u))continue;c++;let d;for(;c<a&&!_l(d=n[c]);)c++;if(c<a){const f=parseInt(String.fromCharCode(u,d),16);l[h++]=f^r>>8,r=(f+r)*52845+22719&65535}}return l.slice(t,h)}function xk(n){return n===47||n===91||n===93||n===123||n===125||n===40||n===41}class yk{constructor(e,t,i){if(t){const s=e.getBytes(),r=!((_l(s[0])||Va(s[0]))&&_l(s[1])&&_l(s[2])&&_l(s[3])&&_l(s[4])&&_l(s[5])&&_l(s[6])&&_l(s[7]));e=new Ui(r?bk(s,pk,4):Nz(s,pk,4))}this.seacAnalysisEnabled=!!i,this.stream=e,this.nextChar()}readNumberArray(){this.getToken();const e=[];for(;;){const t=this.getToken();if(t===null||t==="]"||t==="}")break;e.push(parseFloat(t||0))}return e}readNumber(){const e=this.getToken();return parseFloat(e||0)}readInt(){const e=this.getToken();return parseInt(e||0,10)|0}readBoolean(){return this.getToken()==="true"?1:0}nextChar(){return this.currentChar=this.stream.getByte()}prevChar(){return this.stream.skip(-2),this.currentChar=this.stream.getByte()}getToken(){let e=!1,t=this.currentChar;for(;;){if(t===-1)return null;if(e)(t===10||t===13)&&(e=!1);else if(t===37)e=!0;else if(!Va(t))break;t=this.nextChar()}if(xk(t))return this.nextChar(),String.fromCharCode(t);let i="";do i+=String.fromCharCode(t),t=this.nextChar();while(t>=0&&!Va(t)&&!xk(t));return i}readCharStrings(e,t){return t===-1?e:bk(e,Pz,t)}extractFontProgram(e){const t=this.stream,i=[],s=[],r=Object.create(null);r.lenIV=4;const a={subrs:[],charstrings:[],properties:{privateData:r}};let o,l,c,h;for(;(o=this.getToken())!==null;)if(o==="/")switch(o=this.getToken(),o){case"CharStrings":for(this.getToken(),this.getToken(),this.getToken(),this.getToken();o=this.getToken(),!(o===null||o==="end");){if(o!=="/")continue;const d=this.getToken();l=this.readInt(),this.getToken(),c=l>0?t.getBytes(l):new Uint8Array(0),h=a.properties.privateData.lenIV;const f=this.readCharStrings(c,h);this.nextChar(),o=this.getToken(),o==="noaccess"?this.getToken():o==="/"&&this.prevChar(),s.push({glyph:d,encoded:f})}break;case"Subrs":for(this.readInt(),this.getToken();this.getToken()==="dup";){const d=this.readInt();l=this.readInt(),this.getToken(),c=l>0?t.getBytes(l):new Uint8Array(0),h=a.properties.privateData.lenIV;const f=this.readCharStrings(c,h);this.nextChar(),o=this.getToken(),o==="noaccess"&&this.getToken(),i[d]=f}break;case"BlueValues":case"OtherBlues":case"FamilyBlues":case"FamilyOtherBlues":const u=this.readNumberArray();u.length>0&&u.length%2===0&&Rz&&(a.properties.privateData[o]=u);break;case"StemSnapH":case"StemSnapV":a.properties.privateData[o]=this.readNumberArray();break;case"StdHW":case"StdVW":a.properties.privateData[o]=this.readNumberArray()[0];break;case"BlueShift":case"lenIV":case"BlueFuzz":case"BlueScale":case"LanguageGroup":a.properties.privateData[o]=this.readNumber();break;case"ExpansionFactor":a.properties.privateData[o]=this.readNumber()||.06;break;case"ForceBold":a.properties.privateData[o]=this.readBoolean();break}for(const{encoded:u,glyph:d}of s){const f=new Mz,g=f.convert(u,i,this.seacAnalysisEnabled);let m=f.output;g&&(m=[14]);const x={glyphName:d,charstring:m,width:f.width,lsb:f.lsb,seac:f.seac};if(d===".notdef"?a.charstrings.unshift(x):a.charstrings.push(x),e.builtInEncoding){const p=e.builtInEncoding.indexOf(d);p>-1&&e.widths[p]===void 0&&p>=e.firstChar&&p<=e.lastChar&&(e.widths[p]=f.width)}}return a}extractFontHeader(e){let t;for(;(t=this.getToken())!==null;)if(t==="/")switch(t=this.getToken(),t){case"FontMatrix":const i=this.readNumberArray();e.fontMatrix=i;break;case"Encoding":const s=this.getToken();let r;if(!/^\d+$/.test(s))r=zp(s);else{r=[];const o=parseInt(s,10)|0;this.getToken();for(let l=0;l<o;l++){for(t=this.getToken();t!=="dup"&&t!=="def";)if(t=this.getToken(),t===null)return;if(t==="def")break;const c=this.readInt();this.getToken();const h=this.getToken();r[c]=h,this.getToken()}}e.builtInEncoding=r;break;case"FontBBox":const a=this.readNumberArray();e.ascent=Math.max(a[3],a[1]),e.descent=Math.min(a[1],a[3]),e.ascentScaled=!0;break}}}function wk(n,e,t){const i=n.length,s=e.length,r=i-s;let a=t,o=!1;for(;a<r;){let l=0;for(;l<s&&n[a+l]===e[l];)l++;if(l>=s){for(a+=l;a<i&&Va(n[a]);)a++;o=!0;break}a++}return{found:o,length:a}}function Oz(n,e){const t=[101,101,120,101,99],i=n.pos;let s,r,a;try{s=n.getBytes(e),r=s.length}catch{}if(r===e&&(a=wk(s,t,e-2*t.length),a.found&&a.length===e))return{stream:new Ui(s),length:e};he('Invalid "Length1" property in Type1 font -- trying to recover.'),n.pos=i;const o=2048;let l;for(;;){const c=n.peekBytes(o);if(a=wk(c,t,0),a.length===0)break;if(n.pos+=a.length,a.found){l=n.pos-i;break}}return n.pos=i,l?{stream:new Ui(n.getBytes(l)),length:l}:(he('Unable to recover "Length1" property in Type1 font -- using as is.'),{stream:new Ui(n.getBytes(e)),length:e})}function Dz(n,e){const t=n.getBytes();if(t.length===0)throw new Ee("getEexecBlock - no font program found.");return{stream:new Ui(t),length:t.length}}class Lz{constructor(e,t,i){let r=i.length1;i.length2;let a=t.peekBytes(6);const o=a[0]===128&&a[1]===1;o&&(t.skip(6),r=a[5]<<24|a[4]<<16|a[3]<<8|a[2]);const l=Oz(t,r);new yk(l.stream,!1,e1).extractFontHeader(i),o&&(a=t.getBytes(6),a[5]<<24|a[4]<<16|a[3]<<8|a[2]);const h=Dz(t),d=new yk(h.stream,!0,e1).extractFontProgram(i);for(const x in d.properties)i[x]=d.properties[x];const f=d.charstrings,g=this.getType2Charstrings(f),m=this.getType2Subrs(d.subrs);this.charstrings=f,this.data=this.wrap(e,g,this.charstrings,m,i),this.seacs=this.getSeacs(d.charstrings)}get numGlyphs(){return this.charstrings.length+1}getCharset(){const e=[".notdef"];for(const{glyphName:t}of this.charstrings)e.push(t);return e}getGlyphMapping(e){const t=this.charstrings;if(e.composite){const o=Object.create(null);for(let l=0,c=t.length;l<c;l++){const h=e.cMap.charCodeOf(l);o[h]=l+1}return o}const i=[".notdef"];let s,r;for(r=0;r<t.length;r++)i.push(t[r].glyphName);const a=e.builtInEncoding;if(a){s=Object.create(null);for(const o in a)r=i.indexOf(a[o]),r>=0&&(s[o]=r)}return TR(e,s,i)}hasGlyphId(e){return e<0||e>=this.numGlyphs?!1:e===0?!0:this.charstrings[e-1].charstring.length>0}getSeacs(e){const t=[];for(let i=0,s=e.length;i<s;i++){const r=e[i];r.seac&&(t[i+1]=r.seac)}return t}getType2Charstrings(e){const t=[];for(const i of e)t.push(i.charstring);return t}getType2Subrs(e){let t=0;const i=e.length;i<1133?t=107:i<33769?t=1131:t=32768;const s=[];let r;for(r=0;r<t;r++)s.push([11]);for(r=0;r<i;r++)s.push(e[r]);return s}wrap(e,t,i,s,r){const a=new RR;a.header=new MR(1,0,4,4),a.names=[e];const o=new jp;o.setByName("version",391),o.setByName("Notice",392),o.setByName("FullName",393),o.setByName("FamilyName",394),o.setByName("Weight",395),o.setByName("Encoding",null),o.setByName("FontMatrix",r.fontMatrix),o.setByName("FontBBox",r.bbox),o.setByName("charset",null),o.setByName("CharStrings",null),o.setByName("Private",null),a.topDict=o;const l=new k4;l.add("Version 0.11"),l.add("See original notice"),l.add(e),l.add(e),l.add("Medium"),a.strings=l,a.globalSubrIndex=new Ih;const c=t.length,h=[".notdef"];let u,d;for(u=0;u<c;u++){const y=i[u].glyphName;t3.indexOf(y)===-1&&l.add(y),h.push(y)}a.charset=new rp(!1,0,h);const f=new Ih;for(f.add([139,14]),u=0;u<c;u++)f.add(t[u]);a.charStrings=f;const g=new Gp;g.setByName("Subrs",null);const m=["BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StemSnapH","StemSnapV","BlueShift","BlueFuzz","BlueScale","LanguageGroup","ExpansionFactor","ForceBold","StdHW","StdVW"];for(u=0,d=m.length;u<d;u++){const y=m[u];if(!(y in r.privateData))continue;const w=r.privateData[y];if(Array.isArray(w))for(let v=w.length-1;v>0;v--)w[v]-=w[v-1];g.setByName(y,w)}a.topDict.privateDict=g;const x=new Ih;for(u=0,d=s.length;u<d;u++)x.add(s[u]);return g.subrsIndex=x,new hx(a).compile()}}const lc=[[57344,63743],[1048576,1114109]],ru=1e3,vk=["ascent","bbox","black","bold","charProcOperatorList","cssFontInfo","data","defaultVMetrics","defaultWidth","descent","disableFontFace","fallbackName","fontExtraProperties","fontMatrix","isInvalidPDFjsFont","isType3Font","italic","loadedName","mimetype","missingFile","name","remeasure","systemFontInfo","vertical"],Fz=["cMap","composite","defaultEncoding","differences","isMonospace","isSerifFont","isSymbolicFont","seacMap","subtype","toFontChar","toUnicode","type","vmetrics","widths"];function _k(n){if(!n.fontMatrix||n.fontMatrix[0]===Dd[0])return;const e=.001/n.fontMatrix[0],t=n.widths;for(const i in t)t[i]*=e;n.defaultWidth*=e}function Bz(n,e,t){if(n.isInternalFont||n.hasIncludedToUnicodeMap||n.hasEncoding||n.toUnicode instanceof ho||!e||t.length===0||n.defaultEncoding===Hp)return;for(const a of t)if(!FR(a))return;const i=Hp,s=[],r=Wl();for(const a in i){const o=i[a];if(o==="")continue;const l=r[o];l!==void 0&&(s[a]=String.fromCharCode(l))}s.length>0&&n.toUnicode.amend(s)}function Uz(n,e){if(n.isInternalFont||n.hasIncludedToUnicodeMap||e===n.defaultEncoding||n.toUnicode instanceof ho)return;const t=[],i=Wl();for(const s in e){if(n.hasEncoding&&(n.baseEncodingName||n.differences[s]!==void 0))continue;const r=e[s],a=Ag(r,i);a!==-1&&(t[s]=String.fromCharCode(a))}t.length>0&&n.toUnicode.amend(t)}function kk(n){if(!n.fallbackToUnicode||n.toUnicode instanceof ho)return;const e=[];for(const t in n.fallbackToUnicode)n.toUnicode.has(t)||(e[t]=n.fallbackToUnicode[t]);e.length>0&&n.toUnicode.amend(e)}class Hz{constructor(e,t,i,s,r,a,o,l,c){this.originalCharCode=e,this.fontChar=t,this.unicode=i,this.accent=s,this.width=r,this.vmetric=a,this.operatorListId=o,this.isSpace=l,this.isInFont=c}get category(){return Ze(this,"category",JH(this.unicode),!0)}}function Zh(n,e){return(n<<8)+e}function Sm(n,e,t){n[e+1]=t,n[e]=t>>>8}function ma(n,e){const t=(n<<8)+e;return t&32768?t-65536:t}function zz(n,e,t){n[e+3]=t&255,n[e+2]=t>>>8,n[e+1]=t>>>16,n[e]=t>>>24}function jz(n,e,t,i){return(n<<24)+(e<<16)+(t<<8)+i}function Gn(n){return String.fromCharCode(n>>8&255,n&255)}function Qh(n){return n>32767?n=32767:n<-32768&&(n=-32768),String.fromCharCode(n>>8&255,n&255)}function Gz(n){const e=n.peekBytes(4);return Jn(e,0)===65536||ua(e)==="true"}function LR(n){const e=n.peekBytes(4);return ua(e)==="ttcf"}function Vz(n){const e=n.peekBytes(4);return ua(e)==="OTTO"}function qz(n){const e=n.peekBytes(2);return e[0]===37&&e[1]===33||e[0]===128&&e[1]===1}function Wz(n){const e=n.peekBytes(4);return e[0]>=1&&e[3]>=1&&e[3]<=4}function Kz(n,{type:e,subtype:t,composite:i}){let s,r;return Gz(n)||LR(n)?s=i?"CIDFontType2":"TrueType":Vz(n)?s=i?"CIDFontType2":"OpenType":qz(n)?i?s="CIDFontType0":s=e==="MMType1"?"MMType1":"Type1":Wz(n)?i?(s="CIDFontType0",r="CIDFontType0C"):(s=e==="MMType1"?"MMType1":"Type1",r="Type1C"):(he("getFontFileType: Unable to detect correct font file Type/Subtype."),s=e,r=t),[s,r]}function Zx(n,e){for(const t in e)n[+t]=e[t]}function _w(n,e,t){const i=[];let s;for(let r=0,a=n.length;r<a;r++)s=Ag(n[r],e),s!==-1&&(i[r]=s);for(const r in t)s=Ag(t[r],e),s!==-1&&(i[+r]=s);return i}function Xz(n){return n.platform===1&&n.encoding===0&&n.language===0}function FR(n){return n.platform===3&&n.encoding===1&&n.language===1033}function kw(n,e,t=!1){switch(e.length){case 1:return e.charCodeAt(0);case 2:return e.charCodeAt(0)<<8|e.charCodeAt(1)}const i=`Unsupported CID string (charCode ${n}): "${e}".`;if(t)throw new Ee(i);return he(i),e}function Ck(n,e,t,i){const s=Object.create(null),r=new Map,a=[],o=new Set;let l=0,h=lc[l][0],u=lc[l][1];const d=g=>lc[0][0]<=g&&g<=lc[0][1]||lc[1][0]<=g&&g<=lc[1][1];let f=null;for(const g in n){let m=n[g];if(!e(m))continue;if(h>u){if(l++,l>=lc.length){he("Ran out of space in font private use area.");break}h=lc[l][0],u=lc[l][1]}const x=h++;m===0&&(m=t);let p=i.get(g);if(typeof p=="string")if(p.length===1)p=p.codePointAt(0);else{if(!f){f=new Map;for(let y=64256;y<=64335;y++){const w=String.fromCharCode(y).normalize("NFKD");w.length>1&&f.set(w,y)}}p=f.get(p)||p.codePointAt(0)}p&&!d(p)&&!o.has(m)&&(r.set(p,m),o.add(m)),s[x]=m,a[g]=x}return{toFontChar:a,charCodeToGlyphId:s,toUnicodeExtraMap:r,nextAvailableFontCharCode:h}}function Yz(n,e,t){const i=[];for(const a in n)n[a]>=t||i.push({fontCharCode:a|0,glyphId:n[a]});if(e)for(const[a,o]of e)o>=t||i.push({fontCharCode:a,glyphId:o});i.length===0&&i.push({fontCharCode:0,glyphId:0}),i.sort((a,o)=>a.fontCharCode-o.fontCharCode);const s=[],r=i.length;for(let a=0;a<r;){const o=i[a].fontCharCode,l=[i[a].glyphId];++a;let c=o;for(;a<r&&c+1===i[a].fontCharCode&&(l.push(i[a].glyphId),++c,++a,c!==65535););s.push([o,c,l])}return s}function Ak(n,e,t){const i=Yz(n,e,t),s=i.at(-1)[1]>65535?2:1;let r="\0\0"+Gn(s)+"\0\0"+rr(4+s*8),a,o,l,c;for(a=i.length-1;a>=0&&!(i[a][0]<=65535);--a);const h=a+1;i[a][0]<65535&&i[a][1]===65535&&(i[a][1]=65534);const u=i[a][1]<65535?1:0,d=h+u,f=qp.getSearchParams(d,2);let g="",m="",x="",p="",y="",w=0,v,_,C,k;for(a=0,o=h;a<o;a++){v=i[a],_=v[0],C=v[1],g+=Gn(_),m+=Gn(C),k=v[2];let P=!0;for(l=1,c=k.length;l<c;++l)if(k[l]!==k[l-1]+1){P=!1;break}if(P){const D=k[0];x+=Gn(D-_&65535),p+=Gn(0)}else{const D=(d-a)*2+w*2;for(w+=C-_+1,x+=Gn(0),p+=Gn(D),l=0,c=k.length;l<c;++l)y+=Gn(k[l])}}u>0&&(m+="ÿÿ",g+="ÿÿ",x+="\0",p+="\0\0");const I="\0\0"+Gn(2*d)+Gn(f.range)+Gn(f.entry)+Gn(f.rangeShift)+m+"\0\0"+g+x+p+y;let S="",R="";if(s>1){for(r+=`\0\0
`+rr(4+s*8+4+I.length),S="",a=0,o=i.length;a<o;a++){v=i[a],_=v[0],k=v[2];let P=k[0];for(l=1,c=k.length;l<c;++l)k[l]!==k[l-1]+1&&(C=v[0]+l-1,S+=rr(_)+rr(C)+rr(P),_=C+1,P=k[l]);S+=rr(_)+rr(v[1])+rr(P)}R="\0\f\0\0"+rr(S.length+16)+"\0\0\0\0"+rr(S.length/12)}return r+"\0"+Gn(I.length+4)+I+R+S}function Jz(n,e){e.pos=(e.start||0)+n.offset;const t=e.getUint16();e.skip(60);const i=e.getUint16();if(t<4&&i&768)return!1;const s=e.getUint16(),r=e.getUint16();return s>r||(e.skip(6),e.getUint16()===0)?!1:(n.data[8]=n.data[9]=0,!0)}function Sk(n,e,t){t||(t={unitsPerEm:0,yMax:0,yMin:0,ascent:0,descent:0});let i=0,s=0,r=0,a=0,o=null,l=0,c=-1;if(e){for(let p in e)if(p|=0,(o>p||!o)&&(o=p),l<p&&(l=p),c=XH(p,c),c<32)i|=1<<c;else if(c<64)s|=1<<c-32;else if(c<96)r|=1<<c-64;else if(c<123)a|=1<<c-96;else throw new Ee("Unicode ranges Bits > 123 are reserved for internal usage");l>65535&&(l=65535)}else o=0,l=255;const h=n.bbox||[0,0,0,0],u=t.unitsPerEm||(n.fontMatrix?1/Math.max(...n.fontMatrix.slice(0,4).map(Math.abs)):1e3),d=n.ascentScaled?1:u/ru,f=t.ascent||Math.round(d*(n.ascent||h[3]));let g=t.descent||Math.round(d*(n.descent||h[1]));g>0&&n.descent>0&&h[1]<0&&(g=-g);const m=t.yMax||f,x=-t.yMin||-g;return"\0$ô\0\0\0»\0\0\0»\0\0ß\x001\0\0\0\0"+String.fromCharCode(n.fixedPitch?9:0)+"\0\0\0\0\0\0"+rr(i)+rr(s)+rr(r)+rr(a)+"*21*"+Gn(n.italicAngle?1:0)+Gn(o||n.firstChar)+Gn(l||n.lastChar)+Gn(f)+Gn(g)+"\0d"+Gn(m)+Gn(x)+"\0\0\0\0\0\0\0\0"+Gn(n.xHeight)+Gn(n.capHeight)+Gn(0)+Gn(o||n.firstChar)+"\0"}function Ik(n){const e=Math.floor(n.italicAngle*65536);return"\0\0\0"+rr(e)+"\0\0\0\0"+rr(n.fixedPitch?1:0)+"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"}function Zz(n){return n.replaceAll(/[^\x21-\x7E]|[[\](){}<>/%]/g,"").slice(0,63)}function Cw(n,e){e||(e=[[],[]]);const t=[e[0][0]||"Original licence",e[0][1]||n,e[0][2]||"Unknown",e[0][3]||"uniqueID",e[0][4]||n,e[0][5]||"Version 0.11",e[0][6]||Zz(n),e[0][7]||"Unknown",e[0][8]||"Unknown",e[0][9]||"Unknown"],i=[];let s,r,a,o,l;for(s=0,r=t.length;s<r;s++){l=e[1][s]||t[s];const x=[];for(a=0,o=l.length;a<o;a++)x.push(Gn(l.charCodeAt(a)));i.push(x.join(""))}const c=[t,i],h=["\0","\0"],u=["\0\0","\0"],d=["\0\0","	"],f=t.length*h.length;let g="\0\0"+Gn(f)+Gn(f*12+6),m=0;for(s=0,r=h.length;s<r;s++){const x=c[s];for(a=0,o=x.length;a<o;a++){l=x[a];const p=h[s]+u[s]+d[s]+Gn(a)+Gn(l.length)+Gn(m);g+=p,m+=l.length}}return g+=t.join("")+i.join(""),g}class Ek{constructor(e,t,i,s){var h;this.name=e,this.psName=null,this.mimetype=null,this.disableFontFace=s.disableFontFace,this.fontExtraProperties=s.fontExtraProperties,this.loadedName=i.loadedName,this.isType3Font=i.isType3Font,this.missingFile=!1,this.cssFontInfo=i.cssFontInfo,this._charsCache=Object.create(null),this._glyphCache=Object.create(null);let r=!!(i.flags&oo.Serif);if(!r&&!i.isSimulatedFlags){const u=e.replaceAll(/[,_]/g,"-").split("-",1)[0],d=C4();for(const f of u.split("+"))if(d[f]){r=!0;break}}this.isSerifFont=r,this.isSymbolicFont=!!(i.flags&oo.Symbolic),this.isMonospace=!!(i.flags&oo.FixedPitch);let{type:a,subtype:o}=i;this.type=a,this.subtype=o,this.systemFontInfo=i.systemFontInfo;const l=e.match(/^InvalidPDFjsFont_(.*)_\d+$/);if(this.isInvalidPDFjsFont=!!l,this.isInvalidPDFjsFont?this.fallbackName=l[1]:this.isMonospace?this.fallbackName="monospace":this.isSerifFont?this.fallbackName="serif":this.fallbackName="sans-serif",(h=this.systemFontInfo)!=null&&h.guessFallback&&(this.systemFontInfo.guessFallback=!1,this.systemFontInfo.css+=`,${this.fallbackName}`),this.differences=i.differences,this.widths=i.widths,this.defaultWidth=i.defaultWidth,this.composite=i.composite,this.cMap=i.cMap,this.capHeight=i.capHeight/ru,this.ascent=i.ascent/ru,this.descent=i.descent/ru,this.lineHeight=this.ascent-this.descent,this.fontMatrix=i.fontMatrix,this.bbox=i.bbox,this.defaultEncoding=i.defaultEncoding,this.toUnicode=i.toUnicode,this.toFontChar=[],i.type==="Type3"){for(let u=0;u<256;u++)this.toFontChar[u]=this.differences[u]||i.defaultEncoding[u];return}if(this.cidEncoding=i.cidEncoding||"",this.vertical=!!i.vertical,this.vertical&&(this.vmetrics=i.vmetrics,this.defaultVMetrics=i.defaultVMetrics),!t||t.isEmpty){t&&he('Font file is empty in "'+e+'" ('+this.loadedName+")"),this.fallbackToSystemFont(i);return}[a,o]=Kz(t,i),(a!==this.type||o!==this.subtype)&&gn(`Inconsistent font file Type/SubType, expected: ${this.type}/${this.subtype} but found: ${a}/${o}.`);let c;try{switch(a){case"MMType1":gn("MMType1 font ("+e+"), falling back to Type1.");case"Type1":case"CIDFontType0":this.mimetype="font/opentype";const u=o==="Type1C"||o==="CIDFontType0C"?new yw(t,i):new Lz(e,t,i);_k(i),c=this.convert(e,u,i);break;case"OpenType":case"TrueType":case"CIDFontType2":this.mimetype="font/opentype",c=this.checkAndRepair(e,t,i),_k(i),this.isOpenType&&(a="OpenType");break;default:throw new Ee(`Font ${a} is not supported`)}}catch(u){he(u),this.fallbackToSystemFont(i);return}kk(i),this.data=c,this.type=a,this.subtype=o,this.fontMatrix=i.fontMatrix,this.widths=i.widths,this.defaultWidth=i.defaultWidth,this.toUnicode=i.toUnicode,this.seacMap=i.seacMap}get renderer(){const e=xz.create(this,e1);return Ze(this,"renderer",e)}exportData(){const e=this.fontExtraProperties?[...vk,...Fz]:vk,t=Object.create(null);for(const i of e){const s=this[i];s!==void 0&&(t[i]=s)}return t}fallbackToSystemFont(e){this.missingFile=!0;const{name:t,type:i}=this;let s=cx(t);const r=ty(),a=NR(),o=!!r[s],l=!!(a[s]&&r[a[s]]);s=r[s]||a[s]||s;const h=wz()[s];h&&(isNaN(this.ascent)&&(this.ascent=h.ascent/ru),isNaN(this.descent)&&(this.descent=h.descent/ru),isNaN(this.capHeight)&&(this.capHeight=h.capHeight/ru)),this.bold=/bold/gi.test(s),this.italic=/oblique|italic/gi.test(s),this.black=/Black/g.test(t);const u=/Narrow/g.test(t);if(this.remeasure=(!o||u)&&Object.keys(this.widths).length>0,(o||l)&&i==="CIDFontType2"&&this.cidEncoding.startsWith("Identity-")){const d=e.cidToGidMap,f=[];if(Zx(f,ck()),/Arial-?Black/i.test(t)?Zx(f,hz()):/Calibri/i.test(t)&&Zx(f,uz()),d){for(const g in f){const m=f[g];d[m]!==void 0&&(f[+g]=d[m])}d.length!==this.toUnicode.length&&e.hasIncludedToUnicodeMap&&this.toUnicode instanceof ho&&this.toUnicode.forEach(function(g,m){const x=f[g];d[x]===void 0&&(f[+g]=m)})}this.toUnicode instanceof ho||this.toUnicode.forEach(function(g,m){f[+g]=m}),this.toFontChar=f,this.toUnicode=new ap(f)}else if(/Symbol/i.test(s))this.toFontChar=_w(w4,Wl(),this.differences);else if(/Dingbats/i.test(s))this.toFontChar=_w(v4,qH(),this.differences);else if(o||l){const d=_w(this.defaultEncoding,Wl(),this.differences);i==="CIDFontType2"&&!this.cidEncoding.startsWith("Identity-")&&!(this.toUnicode instanceof ho)&&this.toUnicode.forEach(function(f,g){d[+f]=g}),this.toFontChar=d}else{const d=Wl(),f=[];this.toUnicode.forEach((g,m)=>{if(!this.composite){const x=this.differences[g]||this.defaultEncoding[g],p=Ag(x,d);p!==-1&&(m=p)}f[+g]=m}),this.composite&&this.toUnicode instanceof ho&&/Tahoma|Verdana/i.test(t)&&Zx(f,ck()),this.toFontChar=f}kk(e),this.loadedName=s.split("-",1)[0]}checkAndRepair(e,t,i){var ue,pe,de;const s=["OS/2","cmap","head","hhea","hmtx","maxp","name","post","loca","glyf","fpgm","prep","cvt ","CFF "];function r(O,Y){const le=Object.create(null);le["OS/2"]=null,le.cmap=null,le.head=null,le.hhea=null,le.hmtx=null,le.maxp=null,le.name=null,le.post=null;for(let $=0;$<Y;$++){const re=a(O);s.includes(re.tag)&&re.length!==0&&(le[re.tag]=re)}return le}function a(O){const Y=O.getString(4),le=O.getInt32()>>>0,$=O.getInt32()>>>0,re=O.getInt32()>>>0,oe=O.pos;O.pos=O.start||0,O.skip($);const ee=O.getBytes(re);return O.pos=oe,Y==="head"&&(ee[8]=ee[9]=ee[10]=ee[11]=0,ee[17]|=32),{tag:Y,checksum:le,length:re,offset:$,data:ee}}function o(O){return{version:O.getString(4),numTables:O.getUint16(),searchRange:O.getUint16(),entrySelector:O.getUint16(),rangeShift:O.getUint16()}}function l(O){const Y=O.getString(4);Bs(Y==="ttcf","Must be a TrueType Collection font.");const le=O.getUint16(),$=O.getUint16(),re=O.getInt32()>>>0,oe=[];for(let Q=0;Q<re;Q++)oe.push(O.getInt32()>>>0);const ee={ttcTag:Y,majorVersion:le,minorVersion:$,numFonts:re,offsetTable:oe};switch(le){case 1:return ee;case 2:return ee.dsigTag=O.getInt32()>>>0,ee.dsigLength=O.getInt32()>>>0,ee.dsigOffset=O.getInt32()>>>0,ee}throw new Ee(`Invalid TrueType Collection majorVersion: ${le}.`)}function c(O,Y){var ee;const{numFonts:le,offsetTable:$}=l(O),re=Y.split("+");let oe;for(let Q=0;Q<le;Q++){O.pos=(O.start||0)+$[Q];const je=o(O),Re=r(O,je.numTables);if(!Re.name)throw new Ee('TrueType Collection font must contain a "name" table.');const[Ne]=x(Re.name);for(let He=0,Be=Ne.length;He<Be;He++)for(let Je=0,ht=Ne[He].length;Je<ht;Je++){const ot=(ee=Ne[He][Je])==null?void 0:ee.replaceAll(/\s/g,"");if(ot){if(ot===Y)return{header:je,tables:Re};if(!(re.length<2))for(const Ye of re)ot===Ye&&(oe={name:Ye,header:je,tables:Re})}}}if(oe)return he(`TrueType Collection does not contain "${Y}" font, falling back to "${oe.name}" font instead.`),{header:oe.header,tables:oe.tables};throw new Ee(`TrueType Collection does not contain "${Y}" font.`)}function h(O,Y,le,$){if(!O)return he("No cmap table available."),{platformId:-1,encodingId:-1,mappings:[],hasShortCmap:!1};let re,oe=(Y.start||0)+O.offset;Y.pos=oe,Y.skip(2);const ee=Y.getUint16();let Q,je=!1;for(let Ye=0;Ye<ee;Ye++){const rt=Y.getUint16(),me=Y.getUint16(),Mt=Y.getInt32()>>>0;let ut=!1;if(!((Q==null?void 0:Q.platformId)===rt&&(Q==null?void 0:Q.encodingId)===me)){if(rt===0&&(me===0||me===1||me===3))ut=!0;else if(rt===1&&me===0)ut=!0;else if(rt===3&&me===1&&($||!Q))ut=!0,le||(je=!0);else if(le&&rt===3&&me===0){ut=!0;let dt=!0;if(Ye<ee-1){const Ve=Y.peekBytes(2);Zh(Ve[0],Ve[1])<rt&&(dt=!1)}dt&&(je=!0)}if(ut&&(Q={platformId:rt,encodingId:me,offset:Mt}),je)break}}if(Q&&(Y.pos=oe+Q.offset),!Q||Y.peekByte()===-1)return he("Could not find a preferred cmap table."),{platformId:-1,encodingId:-1,mappings:[],hasShortCmap:!1};const Re=Y.getUint16();let Ne=!1;const He=[];let Be,Je;if(Re===0){for(Y.skip(4),Be=0;Be<256;Be++){const Ye=Y.getByte();Ye&&He.push({charCode:Be,glyphId:Ye})}Ne=!0}else if(Re===2){Y.skip(4);const Ye=[];let rt=0;for(let Mt=0;Mt<256;Mt++){const ut=Y.getUint16()>>3;Ye.push(ut),rt=Math.max(ut,rt)}const me=[];for(let Mt=0;Mt<=rt;Mt++)me.push({firstCode:Y.getUint16(),entryCount:Y.getUint16(),idDelta:ma(Y.getByte(),Y.getByte()),idRangePos:Y.pos+Y.getUint16()});for(let Mt=0;Mt<256;Mt++)if(Ye[Mt]===0)Y.pos=me[0].idRangePos+2*Mt,Je=Y.getUint16(),He.push({charCode:Mt,glyphId:Je});else{const ut=me[Ye[Mt]];for(Be=0;Be<ut.entryCount;Be++){const dt=(Mt<<8)+Be+ut.firstCode;Y.pos=ut.idRangePos+2*Be,Je=Y.getUint16(),Je!==0&&(Je=(Je+ut.idDelta)%65536),He.push({charCode:dt,glyphId:Je})}}}else if(Re===4){Y.skip(4);const Ye=Y.getUint16()>>1;Y.skip(6);const rt=[];let me;for(me=0;me<Ye;me++)rt.push({end:Y.getUint16()});for(Y.skip(2),me=0;me<Ye;me++)rt[me].start=Y.getUint16();for(me=0;me<Ye;me++)rt[me].delta=Y.getUint16();let Mt=0,ut;for(me=0;me<Ye;me++){re=rt[me];const Ve=Y.getUint16();if(!Ve){re.offsetIndex=-1;continue}ut=(Ve>>1)-(Ye-me),re.offsetIndex=ut,Mt=Math.max(Mt,ut+re.end-re.start+1)}const dt=[];for(Be=0;Be<Mt;Be++)dt.push(Y.getUint16());for(me=0;me<Ye;me++){re=rt[me],oe=re.start;const Ve=re.end,Ot=re.delta;for(ut=re.offsetIndex,Be=oe;Be<=Ve;Be++)Be!==65535&&(Je=ut<0?Be:dt[ut+Be-oe],Je=Je+Ot&65535,He.push({charCode:Be,glyphId:Je}))}}else if(Re===6){Y.skip(4);const Ye=Y.getUint16(),rt=Y.getUint16();for(Be=0;Be<rt;Be++){Je=Y.getUint16();const me=Ye+Be;He.push({charCode:me,glyphId:Je})}}else if(Re===12){Y.skip(10);const Ye=Y.getInt32()>>>0;for(Be=0;Be<Ye;Be++){const rt=Y.getInt32()>>>0,me=Y.getInt32()>>>0;let Mt=Y.getInt32()>>>0;for(let ut=rt;ut<=me;ut++)He.push({charCode:ut,glyphId:Mt++})}}else return he("cmap table has unsupported format: "+Re),{platformId:-1,encodingId:-1,mappings:[],hasShortCmap:!1};He.sort((Ye,rt)=>Ye.charCode-rt.charCode);const ht=[],ot=new Set;for(const Ye of He){const{charCode:rt}=Ye;ot.has(rt)||(ot.add(rt),ht.push(Ye))}return{platformId:Q.platformId,encodingId:Q.encodingId,mappings:ht,hasShortCmap:Ne}}function u(O,Y,le,$,re,oe){if(!Y){le&&(le.data=null);return}O.pos=(O.start||0)+Y.offset,O.pos+=4,O.pos+=2,O.pos+=2,O.pos+=2,O.pos+=2,O.pos+=2,O.pos+=2,O.pos+=2,O.pos+=2,O.pos+=2;const ee=O.getUint16();O.pos+=8,O.pos+=2;let Q=O.getUint16();ee!==0&&(Zh($.data[44],$.data[45])&2||(Y.data[22]=0,Y.data[23]=0)),Q>re&&(gn(`The numOfMetrics (${Q}) should not be greater than the numGlyphs (${re}).`),Q=re,Y.data[34]=(Q&65280)>>8,Y.data[35]=Q&255);const Re=re-Q-(le.length-Q*4>>1);if(Re>0){const Ne=new Uint8Array(le.length+Re*2);Ne.set(le.data),oe&&(Ne[le.length]=le.data[2],Ne[le.length+1]=le.data[3]),le.data=Ne}}function d(O,Y,le,$,re,oe){const ee={length:0,sizeOfInstructions:0};if(Y<0||Y>=O.length||le>O.length||le-Y<=12)return ee;const Q=O.subarray(Y,le),je=ma(Q[2],Q[3]),Re=ma(Q[4],Q[5]),Ne=ma(Q[6],Q[7]),He=ma(Q[8],Q[9]);je>Ne&&(Sm(Q,2,Ne),Sm(Q,6,je)),Re>He&&(Sm(Q,4,He),Sm(Q,8,Re));const Be=ma(Q[0],Q[1]);if(Be<0)return Be<-1||($.set(Q,re),ee.length=Q.length),ee;let Je,ht=10,ot=0;for(Je=0;Je<Be;Je++)ot=(Q[ht]<<8|Q[ht+1])+1,ht+=2;const Ye=ht,rt=Q[ht]<<8|Q[ht+1];ee.sizeOfInstructions=rt,ht+=2+rt;const me=ht;let Mt=0;for(Je=0;Je<ot;Je++){const dt=Q[ht++];dt&192&&(Q[ht-1]=dt&63);let Ve=2;dt&2?Ve=1:dt&16&&(Ve=0);let Ot=2;dt&4?Ot=1:dt&32&&(Ot=0);const rn=Ve+Ot;if(Mt+=rn,dt&8){const Me=Q[ht++];Me===0&&(Q[ht-1]^=8),Je+=Me,Mt+=Me*rn}}if(Mt===0)return ee;let ut=ht+Mt;return ut>Q.length?ee:!oe&&rt>0?($.set(Q.subarray(0,Ye),re),$.set([0,0],re+Ye),$.set(Q.subarray(me,ut),re+Ye+2),ut-=rt,Q.length-ut>3&&(ut=ut+3&-4),ee.length=ut,ee):Q.length-ut>3?(ut=ut+3&-4,$.set(Q.subarray(0,ut),re),ee.length=ut,ee):($.set(Q,re),ee.length=Q.length,ee)}function f(O,Y,le){const $=O.data,re=jz($[0],$[1],$[2],$[3]);re>>16!==1&&(gn("Attempting to fix invalid version in head table: "+re),$[0]=0,$[1]=1,$[2]=0,$[3]=0);const oe=Zh($[50],$[51]);if(oe<0||oe>1){gn("Attempting to fix invalid indexToLocFormat in head table: "+oe);const ee=Y+1;if(le===ee<<1)$[50]=0,$[51]=0;else if(le===ee<<2)$[50]=0,$[51]=1;else throw new Ee("Could not fix indexToLocFormat: "+oe)}}function g(O,Y,le,$,re,oe,ee){let Q,je,Re;$?(Q=4,je=function(Ot,rn){return Ot[rn]<<24|Ot[rn+1]<<16|Ot[rn+2]<<8|Ot[rn+3]},Re=function(Ot,rn,Me){Ot[rn]=Me>>>24&255,Ot[rn+1]=Me>>16&255,Ot[rn+2]=Me>>8&255,Ot[rn+3]=Me&255}):(Q=2,je=function(Ot,rn){return Ot[rn]<<9|Ot[rn+1]<<1},Re=function(Ot,rn,Me){Ot[rn]=Me>>9&255,Ot[rn+1]=Me>>1&255});const Ne=oe?le+1:le,He=Q*(1+Ne),Be=new Uint8Array(He);Be.set(O.data.subarray(0,He)),O.data=Be;const Je=Y.data,ht=Je.length,ot=new Uint8Array(ht);let Ye,rt;const me=[];for(Ye=0,rt=0;Ye<le+1;Ye++,rt+=Q){let Ve=je(Be,rt);Ve>ht&&(Ve=ht),me.push({index:Ye,offset:Ve,endOffset:0})}for(me.sort((Ve,Ot)=>Ve.offset-Ot.offset),Ye=0;Ye<le;Ye++)me[Ye].endOffset=me[Ye+1].offset;for(me.sort((Ve,Ot)=>Ve.index-Ot.index),Ye=0;Ye<le;Ye++){const{offset:Ve,endOffset:Ot}=me[Ye];if(Ve!==0||Ot!==0)break;const rn=me[Ye+1].offset;if(rn!==0){me[Ye].endOffset=rn;break}}const Mt=me.at(-2);Mt.offset!==0&&Mt.endOffset===0&&(Mt.endOffset=ht);const ut=Object.create(null);let dt=0;for(Re(Be,0,dt),Ye=0,rt=Q;Ye<le;Ye++,rt+=Q){const Ve=d(Je,me[Ye].offset,me[Ye].endOffset,ot,dt,re),Ot=Ve.length;Ot===0&&(ut[Ye]=!0),Ve.sizeOfInstructions>ee&&(ee=Ve.sizeOfInstructions),dt+=Ot,Re(Be,rt,dt)}if(dt===0){const Ve=new Uint8Array([0,1,0,0,0,0,0,0,0,0,0,0,0,0,49,0]);for(Ye=0,rt=Q;Ye<Ne;Ye++,rt+=Q)Re(Be,rt,Ve.length);Y.data=Ve}else if(oe){const Ve=je(Be,Q);ot.length>Ve+dt?Y.data=ot.subarray(0,Ve+dt):(Y.data=new Uint8Array(Ve+dt),Y.data.set(ot.subarray(0,dt))),Y.data.set(ot.subarray(0,Ve),dt),Re(O.data,Be.length-Q,dt+Ve)}else Y.data=ot.subarray(0,dt);return{missingGlyphs:ut,maxSizeOfInstructions:ee}}function m(O,Y,le){const $=(t.start||0)+O.offset;t.pos=$;const re=O.length,oe=$+re,ee=t.getInt32();t.skip(28);let Q,je=!0,Re;switch(ee){case 65536:Q=ak;break;case 131072:const Ne=t.getUint16();if(Ne!==le){je=!1;break}const He=[];for(Re=0;Re<Ne;++Re){const ht=t.getUint16();if(ht>=32768){je=!1;break}He.push(ht)}if(!je)break;const Be=[],Je=[];for(;t.pos<oe;){const ht=t.getByte();for(Je.length=ht,Re=0;Re<ht;++Re)Je[Re]=String.fromCharCode(t.getByte());Be.push(Je.join(""))}for(Q=[],Re=0;Re<Ne;++Re){const ht=He[Re];if(ht<258){Q.push(ak[ht]);continue}Q.push(Be[ht-258])}break;case 196608:break;default:he("Unknown/unsupported post table version "+ee),je=!1,Y.defaultEncoding&&(Q=Y.defaultEncoding);break}return Y.glyphNames=Q,je}function x(O){const Y=(t.start||0)+O.offset;t.pos=Y;const le=[[],[]],$=[],re=O.length,oe=Y+re;if(t.getUint16()!==0||re<6)return[le,$];const je=t.getUint16(),Re=t.getUint16(),Ne=12;let He,Be;for(He=0;He<je&&t.pos+Ne<=oe;He++){const Je={platform:t.getUint16(),encoding:t.getUint16(),language:t.getUint16(),name:t.getUint16(),length:t.getUint16(),offset:t.getUint16()};(Xz(Je)||FR(Je))&&$.push(Je)}for(He=0,Be=$.length;He<Be;He++){const Je=$[He];if(Je.length<=0)continue;const ht=Y+Re+Je.offset;if(ht+Je.length>oe)continue;t.pos=ht;const ot=Je.name;if(Je.encoding){let Ye="";for(let rt=0,me=Je.length;rt<me;rt+=2)Ye+=String.fromCharCode(t.getUint16());le[1][ot]=Ye}else le[0][ot]=t.getString(Je.length)}return[le,$]}const p=[0,0,0,0,0,0,0,0,-2,-2,-2,-2,0,0,-2,-5,-1,-1,-1,-1,-1,-1,-1,-1,0,0,-1,0,-1,-1,-1,-1,1,-1,-999,0,1,0,-1,-2,0,-1,-2,-1,-1,0,-1,-1,0,0,-999,-999,-1,-1,-1,-1,-2,-999,-2,-2,-999,0,-2,-2,0,0,-2,0,-2,0,0,0,-2,-1,-1,1,1,0,0,-1,-1,-1,-1,-1,-1,-1,0,0,-1,0,-1,-1,0,-999,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,0,0,0,0,0,-2,-999,-999,-999,-999,-999,-1,-1,-2,-2,0,0,0,0,-1,-1,-999,-2,-2,0,0,-1,-2,-2,0,0,0,-1,-1,-1,-2];function y(O,Y){let le=O.data,$=0,re,oe,ee,Q,je,Re=0,Ne=0;const He=[],Be=[],Je=[];let ht=Y.tooComplexToFollowFunctions,ot=!1,Ye=0,rt=0;for(let Mt=le.length;$<Mt;){const ut=le[$++];if(ut===64)if(oe=le[$++],ot||rt)$+=oe;else for(re=0;re<oe;re++)He.push(le[$++]);else if(ut===65)if(oe=le[$++],ot||rt)$+=oe*2;else for(re=0;re<oe;re++)ee=le[$++],He.push(ee<<8|le[$++]);else if((ut&248)===176)if(oe=ut-176+1,ot||rt)$+=oe;else for(re=0;re<oe;re++)He.push(le[$++]);else if((ut&248)===184)if(oe=ut-184+1,ot||rt)$+=oe*2;else for(re=0;re<oe;re++)ee=le[$++],He.push(ma(ee,le[$++]));else if(ut===43&&!ht){if(!ot&&!rt){if(Q=He.at(-1),isNaN(Q))gn("TT: CALL empty stack (or invalid entry).");else if(Y.functionsUsed[Q]=!0,Q in Y.functionsStackDeltas){const dt=He.length+Y.functionsStackDeltas[Q];if(dt<0){he("TT: CALL invalid functions stack delta."),Y.hintsValid=!1;return}He.length=dt}else if(Q in Y.functionsDefined&&!Je.includes(Q)){if(Be.push({data:le,i:$,stackTop:He.length-1}),Je.push(Q),je=Y.functionsDefined[Q],!je){he("TT: CALL non-existent function"),Y.hintsValid=!1;return}le=je.data,$=je.i}}}else if(ut===44&&!ht)(ot||rt)&&(he("TT: nested FDEFs not allowed"),ht=!0),ot=!0,Ne=$,Q=He.pop(),Y.functionsDefined[Q]={data:le,i:$};else if(ut===45)if(ot)ot=!1,Re=$;else{if(je=Be.pop(),!je){he("TT: ENDF bad stack"),Y.hintsValid=!1;return}Q=Je.pop(),le=je.data,$=je.i,Y.functionsStackDeltas[Q]=He.length-je.stackTop}else if(ut===137)(ot||rt)&&(he("TT: nested IDEFs not allowed"),ht=!0),ot=!0,Ne=$;else if(ut===88)++Ye;else if(ut===27)rt=Ye;else if(ut===89)rt===Ye&&(rt=0),--Ye;else if(ut===28&&!ot&&!rt){const dt=He.at(-1);dt>0&&($+=dt-1)}if(!ot&&!rt){let dt=0;for(ut<=142?dt=p[ut]:ut>=192&&ut<=223?dt=-1:ut>=224&&(dt=-2),ut>=113&&ut<=117&&(oe=He.pop(),isNaN(oe)||(dt=-oe*2));dt<0&&He.length>0;)He.pop(),dt++;for(;dt>0;)He.push(NaN),dt--}}Y.tooComplexToFollowFunctions=ht;const me=[le];$>le.length&&me.push(new Uint8Array($-le.length)),Ne>Re&&(he("TT: complementing a missing function tail"),me.push(new Uint8Array([34,45]))),v(O,me)}function w(O,Y){if(!O.tooComplexToFollowFunctions){if(O.functionsDefined.length>Y){he("TT: more functions defined than expected"),O.hintsValid=!1;return}for(let le=0,$=O.functionsUsed.length;le<$;le++){if(le>Y){he("TT: invalid function id: "+le),O.hintsValid=!1;return}if(O.functionsUsed[le]&&!O.functionsDefined[le]){he("TT: undefined function: "+le),O.hintsValid=!1;return}}}}function v(O,Y){if(Y.length>1){let le=0,$,re;for($=0,re=Y.length;$<re;$++)le+=Y[$].length;le=le+3&-4;const oe=new Uint8Array(le);let ee=0;for($=0,re=Y.length;$<re;$++)oe.set(Y[$],ee),ee+=Y[$].length;O.data=oe,O.length=le}}function _(O,Y,le,$){const re={functionsDefined:[],functionsUsed:[],functionsStackDeltas:[],tooComplexToFollowFunctions:!1,hintsValid:!0};if(O&&y(O,re),Y&&y(Y,re),O&&w(re,$),le&&le.length&1){const oe=new Uint8Array(le.length+1);oe.set(le.data),le.data=oe}return re.hintsValid}t=new Ui(new Uint8Array(t.getBytes()));let C,k;if(LR(t)){const O=c(t,this.name);C=O.header,k=O.tables}else C=o(t),k=r(t,C.numTables);let I,S;const R=!k["CFF "];if(R){if(!k.loca)throw new Ee('Required "loca" table is not found');k.glyf||(he('Required "glyf" table is not found -- trying to recover.'),k.glyf={tag:"glyf",data:new Uint8Array(0)}),this.isOpenType=!1}else{const O=i.composite&&(((ue=i.cidToGidMap)==null?void 0:ue.length)>0||!(i.cMap instanceof $f));if(C.version==="OTTO"&&!O||!k.head||!k.hhea||!k.maxp||!k.post)return S=new Ui(k["CFF "].data),I=new yw(S,i),this.convert(e,I,i);delete k.glyf,delete k.loca,delete k.fpgm,delete k.prep,delete k["cvt "],this.isOpenType=!0}if(!k.maxp)throw new Ee('Required "maxp" table is not found');t.pos=(t.start||0)+k.maxp.offset;let P=t.getInt32();const D=t.getUint16();if(P!==65536&&P!==20480){if(k.maxp.length===6)P=20480;else if(k.maxp.length>=32)P=65536;else throw new Ee('"maxp" table has a wrong version number');zz(k.maxp.data,0,P)}if(((pe=i.scaleFactors)==null?void 0:pe.length)===D&&R){const{scaleFactors:O}=i,Y=Zh(k.head.data[50],k.head.data[51]),le=new Iz({glyfTable:k.glyf.data,isGlyphLocationsLong:Y,locaTable:k.loca.data,numGlyphs:D});le.scale(O);const{glyf:$,loca:re,isLocationLong:oe}=le.write();k.glyf.data=$,k.loca.data=re,oe!==!!Y&&(k.head.data[50]=0,k.head.data[51]=oe?1:0);const ee=k.hmtx.data;for(let Q=0;Q<D;Q++){const je=4*Q,Re=Math.round(O[Q]*Zh(ee[je],ee[je+1]));ee[je]=Re>>8&255,ee[je+1]=Re&255;const Ne=Math.round(O[Q]*ma(ee[je+2],ee[je+3]));Sm(ee,je+2,Ne)}}let U=D+1,T=!0;U>65535&&(T=!1,U=D,he("Not enough space in glyfs to duplicate first glyph."));let G=0,M=0;P>=65536&&k.maxp.length>=32&&(t.pos+=8,t.getUint16()>2&&(k.maxp.data[14]=0,k.maxp.data[15]=2),t.pos+=4,G=t.getUint16(),t.pos+=4,M=t.getUint16()),k.maxp.data[4]=U>>8,k.maxp.data[5]=U&255;const F=_(k.fpgm,k.prep,k["cvt "],G);if(F||(delete k.fpgm,delete k.prep,delete k["cvt "]),u(t,k.hhea,k.hmtx,k.head,U,T),!k.head)throw new Ee('Required "head" table is not found');f(k.head,D,R?k.loca.length:0);let X=Object.create(null);if(R){const O=Zh(k.head.data[50],k.head.data[51]),Y=g(k.loca,k.glyf,D,O,F,T,M);X=Y.missingGlyphs,P>=65536&&k.maxp.length>=32&&(k.maxp.data[26]=Y.maxSizeOfInstructions>>8,k.maxp.data[27]=Y.maxSizeOfInstructions&255)}if(!k.hhea)throw new Ee('Required "hhea" table is not found');k.hhea.data[10]===0&&k.hhea.data[11]===0&&(k.hhea.data[10]=255,k.hhea.data[11]=255);const z={unitsPerEm:Zh(k.head.data[18],k.head.data[19]),yMax:ma(k.head.data[42],k.head.data[43]),yMin:ma(k.head.data[38],k.head.data[39]),ascent:ma(k.hhea.data[4],k.hhea.data[5]),descent:ma(k.hhea.data[6],k.hhea.data[7]),lineGap:ma(k.hhea.data[8],k.hhea.data[9])};this.ascent=z.ascent/z.unitsPerEm,this.descent=z.descent/z.unitsPerEm,this.lineGap=z.lineGap/z.unitsPerEm,(de=this.cssFontInfo)!=null&&de.lineHeight?(this.lineHeight=this.cssFontInfo.metrics.lineHeight,this.lineGap=this.cssFontInfo.metrics.lineGap):this.lineHeight=this.ascent-this.descent+this.lineGap,k.post&&m(k.post,i,D),k.post={tag:"post",data:Ik(i)};const K=Object.create(null);function j(O){return!X[O]}if(i.composite){const O=i.cidToGidMap||[],Y=O.length===0;i.cMap.forEach(function(le,$){if(typeof $=="string"&&($=kw(le,$,!0)),$>65535)throw new Ee("Max size of CID is 65,535");let re=-1;Y?re=$:O[$]!==void 0&&(re=O[$]),re>=0&&re<D&&j(re)&&(K[le]=re)})}else{const O=h(k.cmap,t,this.isSymbolicFont,i.hasEncoding),Y=O.platformId,le=O.encodingId,$=O.mappings;let re=[],oe=!1;if(i.hasEncoding&&(i.baseEncodingName==="MacRomanEncoding"||i.baseEncodingName==="WinAnsiEncoding")&&(re=zp(i.baseEncodingName)),i.hasEncoding&&!this.isSymbolicFont&&(Y===3&&le===1||Y===1&&le===0)){const ee=Wl();for(let Q=0;Q<256;Q++){let je;if(this.differences[Q]!==void 0?je=this.differences[Q]:re.length&&re[Q]!==""?je=re[Q]:je=s0[Q],!je)continue;const Re=ER(je,ee);let Ne;if(Y===3&&le===1?Ne=ee[Re]:Y===1&&le===0&&(Ne=y4.indexOf(Re)),Ne===void 0){if(!i.glyphNames&&i.hasIncludedToUnicodeMap&&!(this.toUnicode instanceof ho)){const He=this.toUnicode.get(Q);He&&(Ne=He.codePointAt(0))}if(Ne===void 0)continue}for(const He of $)if(He.charCode===Ne){K[Q]=He.glyphId;break}}}else if(Y===0){for(const ee of $)K[ee.charCode]=ee.glyphId;oe=!0}else if(Y===3&&le===0)for(const ee of $){let Q=ee.charCode;Q>=61440&&Q<=61695&&(Q&=255),K[Q]=ee.glyphId}else for(const ee of $)K[ee.charCode]=ee.glyphId;if(i.glyphNames&&(re.length||this.differences.length))for(let ee=0;ee<256;++ee){if(!oe&&K[ee]!==void 0)continue;const Q=this.differences[ee]||re[ee];if(!Q)continue;const je=i.glyphNames.indexOf(Q);je>0&&j(je)&&(K[ee]=je)}}K.length===0&&(K[0]=0);let ae=U-1;if(T||(ae=0),!i.cssFontInfo){const O=Ck(K,j,ae,this.toUnicode);this.toFontChar=O.toFontChar,k.cmap={tag:"cmap",data:Ak(O.charCodeToGlyphId,O.toUnicodeExtraMap,U)},(!k["OS/2"]||!Jz(k["OS/2"],t))&&(k["OS/2"]={tag:"OS/2",data:Sk(i,O.charCodeToGlyphId,z)})}if(!R)try{S=new Ui(k["CFF "].data),I=new _4(S,i,e1).parse(),I.duplicateFirstGlyph();const Y=new hx(I);k["CFF "].data=Y.compile()}catch{he("Failed to compile font "+i.loadedName)}if(!k.name)k.name={tag:"name",data:Cw(this.name)};else{const[O,Y]=x(k.name);k.name.data=Cw(e,O),this.psName=O[0][6]||null,i.composite||Bz(i,this.isSymbolicFont,Y)}const ge=new qp(C.version);for(const O in k)ge.addTable(O,k[O].data);return ge.toArray()}convert(e,t,i){i.fixedPitch=!1,i.builtInEncoding&&Uz(i,i.builtInEncoding);let s=1;t instanceof yw&&(s=t.numGlyphs-1);const r=t.getGlyphMapping(i);let a=null,o=r,l=null;i.cssFontInfo||(a=Ck(r,t.hasGlyphId.bind(t),s,this.toUnicode),this.toFontChar=a.toFontChar,o=a.charCodeToGlyphId,l=a.toUnicodeExtraMap);const c=t.numGlyphs;function h(m,x){let p=null;for(const y in m)x===m[y]&&(p||(p=[])).push(y|0);return p}function u(m,x){for(const p in m)if(x===m[p])return p|0;return a.charCodeToGlyphId[a.nextAvailableFontCharCode]=x,a.nextAvailableFontCharCode++}const d=t.seacs;if(a&&e1&&(d!=null&&d.length)){const m=i.fontMatrix||Dd,x=t.getCharset(),p=Object.create(null);for(let y in d){y|=0;const w=d[y],v=s0[w[2]],_=s0[w[3]],C=x.indexOf(v),k=x.indexOf(_);if(C<0||k<0)continue;const I={x:w[0]*m[0]+w[1]*m[2]+m[4],y:w[0]*m[1]+w[1]*m[3]+m[5]},S=h(r,y);if(S)for(const R of S){const P=a.charCodeToGlyphId,D=u(P,C),U=u(P,k);p[R]={baseFontCharCode:D,accentFontCharCode:U,accentOffset:I}}}i.seacMap=p}const f=i.fontMatrix?1/Math.max(...i.fontMatrix.slice(0,4).map(Math.abs)):1e3,g=new qp("OTTO");return g.addTable("CFF ",t.data),g.addTable("OS/2",Sk(i,o)),g.addTable("cmap",Ak(o,l,c)),g.addTable("head","\0\0\0\0\0\0\0\0\0\0_<õ\0\0"+Qh(f)+"\0\0\0\0\v~'\0\0\0\0\v~'\0\0"+Qh(i.descent)+"ÿ"+Qh(i.ascent)+Gn(i.italicAngle?2:0)+"\0\0\0\0\0\0\0"),g.addTable("hhea","\0\0\0"+Qh(i.ascent)+Qh(i.descent)+"\0\0ÿÿ\0\0\0\0\0\0"+Qh(i.capHeight)+Qh(Math.tan(i.italicAngle)*i.xHeight)+"\0\0\0\0\0\0\0\0\0\0\0\0"+Gn(c)),g.addTable("hmtx",function(){const x=t.charstrings,p=t.cff?t.cff.widths:null;let y="\0\0\0\0";for(let w=1,v=c;w<v;w++){let _=0;if(x){const C=x[w-1];_="width"in C?C.width:0}else p&&(_=Math.ceil(p[w]||0));y+=Gn(_)+Gn(0)}return y}()),g.addTable("maxp","\0\0P\0"+Gn(c)),g.addTable("name",Cw(e)),g.addTable("post",Ik(i)),g.toArray()}get _spaceWidth(){const e=["space","minus","one","i","I"];let t;for(const i of e){if(i in this.widths){t=this.widths[i];break}const r=Wl()[i];let a=0;if(this.composite&&this.cMap.contains(r)&&(a=this.cMap.lookup(r),typeof a=="string"&&(a=kw(r,a))),!a&&this.toUnicode&&(a=this.toUnicode.charCodeOf(r)),a<=0&&(a=r),t=this.widths[a],t)break}return Ze(this,"_spaceWidth",t||this.defaultWidth)}_charToGlyph(e,t=!1){var f,g,m;let i=this._glyphCache[e];if((i==null?void 0:i.isSpace)===t)return i;let s,r,a,o=e;(f=this.cMap)!=null&&f.contains(e)&&(o=this.cMap.lookup(e),typeof o=="string"&&(o=kw(e,o))),r=this.widths[o],typeof r!="number"&&(r=this.defaultWidth);const l=(g=this.vmetrics)==null?void 0:g[o];let c=this.toUnicode.get(e)||e;typeof c=="number"&&(c=String.fromCharCode(c));let h=this.toFontChar[e]!==void 0;if(s=this.toFontChar[e]||e,this.missingFile){const x=this.differences[e]||this.defaultEncoding[e];(x===".notdef"||x==="")&&this.type==="Type1"&&(s=32,x===""&&(r||(r=this._spaceWidth),c=String.fromCharCode(s))),s=KH(s)}this.isType3Font&&(a=s);let u=null;if((m=this.seacMap)!=null&&m[e]){h=!0;const x=this.seacMap[e];s=x.baseFontCharCode,u={fontChar:String.fromCodePoint(x.accentFontCharCode),offset:x.accentOffset}}let d="";if(typeof s=="number"&&(s<=1114111?d=String.fromCodePoint(s):he(`charToGlyph - invalid fontCharCode: ${s}`)),this.missingFile&&this.vertical&&d.length===1){const x=QH()[d.charCodeAt(0)];x&&(d=c=String.fromCharCode(x))}return i=new Hz(e,d,c,u,r,l,a,t,h),this._glyphCache[e]=i}charsToGlyphs(e){let t=this._charsCache[e];if(t)return t;if(t=[],this.cMap){const i=Object.create(null),s=e.length;let r=0;for(;r<s;){this.cMap.readCharCode(e,r,i);const{charcode:a,length:o}=i;r+=o;const l=this._charToGlyph(a,o===1&&e.charCodeAt(r-1)===32);t.push(l)}}else for(let i=0,s=e.length;i<s;++i){const r=e.charCodeAt(i),a=this._charToGlyph(r,r===32);t.push(a)}return this._charsCache[e]=t}getCharPositions(e){const t=[];if(this.cMap){const i=Object.create(null);let s=0;for(;s<e.length;){this.cMap.readCharCode(e,s,i);const r=i.length;t.push([s,s+r]),s+=r}}else for(let i=0,s=e.length;i<s;++i)t.push([i,i+1]);return t}get glyphCacheValues(){return Object.values(this._glyphCache)}encodeString(e){const t=[],i=[],s=()=>t.length%2===1,r=this.toUnicode instanceof ho?a=>this.toUnicode.charCodeOf(a):a=>this.toUnicode.charCodeOf(String.fromCodePoint(a));for(let a=0,o=e.length;a<o;a++){const l=e.codePointAt(a);if(l>55295&&(l<57344||l>65533)&&a++,this.toUnicode){const c=r(l);if(c!==-1){s()&&(t.push(i.join("")),i.length=0);const h=this.cMap?this.cMap.getCharCodeLength(c):1;for(let u=h-1;u>=0;u--)i.push(String.fromCharCode(c>>8*u&255));continue}}s()||(t.push(i.join("")),i.length=0),i.push(String.fromCodePoint(l))}return t.push(i.join("")),t}}class Tk{constructor(e){this.error=e,this.loadedName="g_font_error",this.missingFile=!0}charsToGlyphs(){return[]}encodeString(e){return[e]}exportData(){return{error:this.error}}}const jr={FUNCTION_BASED:1,AXIAL:2,RADIAL:3,FREE_FORM_MESH:4,LATTICE_FORM_MESH:5,COONS_PATCH_MESH:6,TENSOR_PATCH_MESH:7};class Qz{constructor(){kn("Cannot initialize Pattern.")}static parseShading(e,t,i,s,r,a){const o=e instanceof hn?e.dict:e,l=o.get("ShadingType");try{switch(l){case jr.AXIAL:case jr.RADIAL:return new $z(o,t,i,s,r,a);case jr.FREE_FORM_MESH:case jr.LATTICE_FORM_MESH:case jr.COONS_PATCH_MESH:case jr.TENSOR_PATCH_MESH:return new K7(e,t,i,s,r,a);default:throw new Ee("Unsupported ShadingType: "+l)}}catch(c){if(c instanceof bi)throw c;return he(c),new ij}}}class t1{getIR(){kn("Abstract method `getIR` called.")}}ze(t1,"SMALL_NUMBER",1e-6);class $z extends t1{constructor(e,t,i,s,r,a){super(),this.shadingType=e.get("ShadingType");let o=0;if(this.shadingType===jr.AXIAL?o=4:this.shadingType===jr.RADIAL&&(o=6),this.coordsArr=e.getArray("Coords"),!Gr(this.coordsArr,o))throw new Ee("RadialAxialShading: Invalid /Coords array.");const l=Nn.parse({cs:e.getRaw("CS")||e.getRaw("ColorSpace"),xref:t,resources:i,pdfFunctionFactory:s,globalColorSpaceCache:r,localColorSpaceCache:a});this.bbox=p0(e.getArray("BBox"),null);let c=0,h=1;const u=e.getArray("Domain");Gr(u,2)&&([c,h]=u);let d=!1,f=!1;const g=e.getArray("Extend");if(lU(g,2)&&([d,f]=g),this.shadingType===jr.RADIAL&&(!d||!f)){const[ae,ge,ue,pe,de,O]=this.coordsArr,Y=Math.hypot(ae-pe,ge-de);ue<=O+Y&&O<=ue+Y&&he("Unsupported radial gradient.")}this.extendStart=d,this.extendEnd=f;const m=e.getRaw("Function"),x=s.create(m,!0),p=840,y=(h-c)/p,w=this.colorStops=[];if(c>=h||y<=0){gn("Bad shading domain.");return}const v=new Float32Array(l.numComps),_=new Float32Array(1);let C=0;_[0]=c,x(_,0,v,0);const k=new Uint8ClampedArray(3);l.getRgb(v,0,k);let[I,S,R]=k;w.push([0,Dn.makeHexColor(I,S,R)]);let P=1;_[0]=c+y,x(_,0,v,0),l.getRgb(v,0,k);let[D,U,T]=k,G=D-I+1,M=U-S+1,F=T-R+1,X=D-I-1,z=U-S-1,K=T-R-1;for(let ae=2;ae<p;ae++){_[0]=c+ae*y,x(_,0,v,0),l.getRgb(v,0,k);const[ge,ue,pe]=k,de=ae-C;if(G=Math.min(G,(ge-I+1)/de),M=Math.min(M,(ue-S+1)/de),F=Math.min(F,(pe-R+1)/de),X=Math.max(X,(ge-I-1)/de),z=Math.max(z,(ue-S-1)/de),K=Math.max(K,(pe-R-1)/de),!(X<=G&&z<=M&&K<=F)){const Y=Dn.makeHexColor(D,U,T);w.push([P/p,Y]),G=ge-D+1,M=ue-U+1,F=pe-T+1,X=ge-D-1,z=ue-U-1,K=pe-T-1,C=P,I=D,S=U,R=T}P=ae,D=ge,U=ue,T=pe}w.push([1,Dn.makeHexColor(D,U,T)]);let j="transparent";e.has("Background")&&(j=l.getRgbHex(e.get("Background"),0)),d||(w.unshift([0,j]),w[1][0]+=t1.SMALL_NUMBER),f||(w.at(-1)[0]-=t1.SMALL_NUMBER,w.push([1,j])),this.colorStops=w}getIR(){const{coordsArr:e,shadingType:t}=this;let i,s,r,a,o;return t===jr.AXIAL?(s=[e[0],e[1]],r=[e[2],e[3]],a=null,o=null,i="axial"):t===jr.RADIAL?(s=[e[0],e[1]],r=[e[3],e[4]],a=e[2],o=e[5],i="radial"):kn(`getPattern type unknown: ${t}`),["RadialAxial",i,this.bbox,this.colorStops,s,r,a,o]}}class ej{constructor(e,t){this.stream=e,this.context=t,this.buffer=0,this.bufferLength=0;const i=t.numComps;this.tmpCompsBuf=new Float32Array(i);const s=t.colorSpace.numComps;this.tmpCsCompsBuf=t.colorFn?new Float32Array(s):this.tmpCompsBuf}get hasData(){if(this.stream.end)return this.stream.pos<this.stream.end;if(this.bufferLength>0)return!0;const e=this.stream.getByte();return e<0?!1:(this.buffer=e,this.bufferLength=8,!0)}readBits(e){const{stream:t}=this;let{buffer:i,bufferLength:s}=this;if(e===32){if(s===0)return t.getInt32()>>>0;i=i<<24|t.getByte()<<16|t.getByte()<<8|t.getByte();const r=t.getByte();return this.buffer=r&(1<<s)-1,(i<<8-s|(r&255)>>s)>>>0}if(e===8&&s===0)return t.getByte();for(;s<e;)i=i<<8|t.getByte(),s+=8;return s-=e,this.bufferLength=s,this.buffer=i&(1<<s)-1,i>>s}align(){this.buffer=0,this.bufferLength=0}readFlag(){return this.readBits(this.context.bitsPerFlag)}readCoordinate(){const{bitsPerCoordinate:e,decode:t}=this.context,i=this.readBits(e),s=this.readBits(e),r=e<32?1/((1<<e)-1):23283064365386963e-26;return[i*r*(t[1]-t[0])+t[0],s*r*(t[3]-t[2])+t[2]]}readComponents(){const{bitsPerComponent:e,colorFn:t,colorSpace:i,decode:s,numComps:r}=this.context,a=e<32?1/((1<<e)-1):23283064365386963e-26,o=this.tmpCompsBuf;for(let c=0,h=4;c<r;c++,h+=2){const u=this.readBits(e);o[c]=u*a*(s[h+1]-s[h])+s[h]}const l=this.tmpCsCompsBuf;return t==null||t(o,0,l,0),i.getRgb(l,0)}}let n3=Object.create(null);function tj(n){const e=[];for(let t=0;t<=n;t++){const i=t/n,s=1-i;e.push(new Float32Array([s**3,3*i*s**2,3*i**2*s,i**3]))}return e}function Rk(n){return n3[n]||(n3[n]=tj(n))}function nj(){n3=Object.create(null)}const To=class To extends t1{constructor(e,t,i,s,r,a){if(super(),!(e instanceof hn))throw new Ee("Mesh data is not a stream");const o=e.dict;this.shadingType=o.get("ShadingType"),this.bbox=p0(o.getArray("BBox"),null);const l=Nn.parse({cs:o.getRaw("CS")||o.getRaw("ColorSpace"),xref:t,resources:i,pdfFunctionFactory:s,globalColorSpaceCache:r,localColorSpaceCache:a});this.background=o.has("Background")?l.getRgb(o.get("Background"),0):null;const c=o.getRaw("Function"),h=c?s.create(c,!0):null;this.coords=[],this.colors=[],this.figures=[];const u={bitsPerCoordinate:o.get("BitsPerCoordinate"),bitsPerComponent:o.get("BitsPerComponent"),bitsPerFlag:o.get("BitsPerFlag"),decode:o.getArray("Decode"),colorFn:h,colorSpace:l,numComps:h?1:l.numComps},d=new ej(e,u);let f=!1;switch(this.shadingType){case jr.FREE_FORM_MESH:this._decodeType4Shading(d);break;case jr.LATTICE_FORM_MESH:const g=o.get("VerticesPerRow")|0;if(g<2)throw new Ee("Invalid VerticesPerRow");this._decodeType5Shading(d,g);break;case jr.COONS_PATCH_MESH:this._decodeType6Shading(d),f=!0;break;case jr.TENSOR_PATCH_MESH:this._decodeType7Shading(d),f=!0;break;default:kn("Unsupported mesh type.");break}if(f){this._updateBounds();for(let g=0,m=this.figures.length;g<m;g++)this._buildFigureFromPatch(g)}this._updateBounds(),this._packData()}_decodeType4Shading(e){const t=this.coords,i=this.colors,s=[];let r=0;for(;e.hasData;){const a=e.readFlag(),o=e.readCoordinate(),l=e.readComponents();if(r===0){if(!(0<=a&&a<=2))throw new Ee("Unknown type4 flag");switch(a){case 0:r=3;break;case 1:s.push(s.at(-2),s.at(-1)),r=1;break;case 2:s.push(s.at(-3),s.at(-1)),r=1;break}}s.push(t.length),t.push(o),i.push(l),r--,e.align()}this.figures.push({type:"triangles",coords:new Int32Array(s),colors:new Int32Array(s)})}_decodeType5Shading(e,t){const i=this.coords,s=this.colors,r=[];for(;e.hasData;){const a=e.readCoordinate(),o=e.readComponents();r.push(i.length),i.push(a),s.push(o)}this.figures.push({type:"lattice",coords:new Int32Array(r),colors:new Int32Array(r),verticesPerRow:t})}_decodeType6Shading(e){const t=this.coords,i=this.colors,s=new Int32Array(16),r=new Int32Array(4);for(;e.hasData;){const a=e.readFlag();if(!(0<=a&&a<=3))throw new Ee("Unknown type6 flag");const o=t.length;for(let f=0,g=a!==0?8:12;f<g;f++)t.push(e.readCoordinate());const l=i.length;for(let f=0,g=a!==0?2:4;f<g;f++)i.push(e.readComponents());let c,h,u,d;switch(a){case 0:s[12]=o+3,s[13]=o+4,s[14]=o+5,s[15]=o+6,s[8]=o+2,s[11]=o+7,s[4]=o+1,s[7]=o+8,s[0]=o,s[1]=o+11,s[2]=o+10,s[3]=o+9,r[2]=l+1,r[3]=l+2,r[0]=l,r[1]=l+3;break;case 1:c=s[12],h=s[13],u=s[14],d=s[15],s[12]=d,s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=u,s[11]=o+3,s[4]=h,s[7]=o+4,s[0]=c,s[1]=o+7,s[2]=o+6,s[3]=o+5,c=r[2],h=r[3],r[2]=h,r[3]=l,r[0]=c,r[1]=l+1;break;case 2:c=s[15],h=s[11],s[12]=s[3],s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=s[7],s[11]=o+3,s[4]=h,s[7]=o+4,s[0]=c,s[1]=o+7,s[2]=o+6,s[3]=o+5,c=r[3],r[2]=r[1],r[3]=l,r[0]=c,r[1]=l+1;break;case 3:s[12]=s[0],s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=s[1],s[11]=o+3,s[4]=s[2],s[7]=o+4,s[0]=s[3],s[1]=o+7,s[2]=o+6,s[3]=o+5,r[2]=r[0],r[3]=l,r[0]=r[1],r[1]=l+1;break}s[5]=t.length,t.push([(-4*t[s[0]][0]-t[s[15]][0]+6*(t[s[4]][0]+t[s[1]][0])-2*(t[s[12]][0]+t[s[3]][0])+3*(t[s[13]][0]+t[s[7]][0]))/9,(-4*t[s[0]][1]-t[s[15]][1]+6*(t[s[4]][1]+t[s[1]][1])-2*(t[s[12]][1]+t[s[3]][1])+3*(t[s[13]][1]+t[s[7]][1]))/9]),s[6]=t.length,t.push([(-4*t[s[3]][0]-t[s[12]][0]+6*(t[s[2]][0]+t[s[7]][0])-2*(t[s[0]][0]+t[s[15]][0])+3*(t[s[4]][0]+t[s[14]][0]))/9,(-4*t[s[3]][1]-t[s[12]][1]+6*(t[s[2]][1]+t[s[7]][1])-2*(t[s[0]][1]+t[s[15]][1])+3*(t[s[4]][1]+t[s[14]][1]))/9]),s[9]=t.length,t.push([(-4*t[s[12]][0]-t[s[3]][0]+6*(t[s[8]][0]+t[s[13]][0])-2*(t[s[0]][0]+t[s[15]][0])+3*(t[s[11]][0]+t[s[1]][0]))/9,(-4*t[s[12]][1]-t[s[3]][1]+6*(t[s[8]][1]+t[s[13]][1])-2*(t[s[0]][1]+t[s[15]][1])+3*(t[s[11]][1]+t[s[1]][1]))/9]),s[10]=t.length,t.push([(-4*t[s[15]][0]-t[s[0]][0]+6*(t[s[11]][0]+t[s[14]][0])-2*(t[s[12]][0]+t[s[3]][0])+3*(t[s[2]][0]+t[s[8]][0]))/9,(-4*t[s[15]][1]-t[s[0]][1]+6*(t[s[11]][1]+t[s[14]][1])-2*(t[s[12]][1]+t[s[3]][1])+3*(t[s[2]][1]+t[s[8]][1]))/9]),this.figures.push({type:"patch",coords:new Int32Array(s),colors:new Int32Array(r)})}}_decodeType7Shading(e){const t=this.coords,i=this.colors,s=new Int32Array(16),r=new Int32Array(4);for(;e.hasData;){const a=e.readFlag();if(!(0<=a&&a<=3))throw new Ee("Unknown type7 flag");const o=t.length;for(let f=0,g=a!==0?12:16;f<g;f++)t.push(e.readCoordinate());const l=i.length;for(let f=0,g=a!==0?2:4;f<g;f++)i.push(e.readComponents());let c,h,u,d;switch(a){case 0:s[12]=o+3,s[13]=o+4,s[14]=o+5,s[15]=o+6,s[8]=o+2,s[9]=o+13,s[10]=o+14,s[11]=o+7,s[4]=o+1,s[5]=o+12,s[6]=o+15,s[7]=o+8,s[0]=o,s[1]=o+11,s[2]=o+10,s[3]=o+9,r[2]=l+1,r[3]=l+2,r[0]=l,r[1]=l+3;break;case 1:c=s[12],h=s[13],u=s[14],d=s[15],s[12]=d,s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=u,s[9]=o+9,s[10]=o+10,s[11]=o+3,s[4]=h,s[5]=o+8,s[6]=o+11,s[7]=o+4,s[0]=c,s[1]=o+7,s[2]=o+6,s[3]=o+5,c=r[2],h=r[3],r[2]=h,r[3]=l,r[0]=c,r[1]=l+1;break;case 2:c=s[15],h=s[11],s[12]=s[3],s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=s[7],s[9]=o+9,s[10]=o+10,s[11]=o+3,s[4]=h,s[5]=o+8,s[6]=o+11,s[7]=o+4,s[0]=c,s[1]=o+7,s[2]=o+6,s[3]=o+5,c=r[3],r[2]=r[1],r[3]=l,r[0]=c,r[1]=l+1;break;case 3:s[12]=s[0],s[13]=o+0,s[14]=o+1,s[15]=o+2,s[8]=s[1],s[9]=o+9,s[10]=o+10,s[11]=o+3,s[4]=s[2],s[5]=o+8,s[6]=o+11,s[7]=o+4,s[0]=s[3],s[1]=o+7,s[2]=o+6,s[3]=o+5,r[2]=r[0],r[3]=l,r[0]=r[1],r[1]=l+1;break}this.figures.push({type:"patch",coords:new Int32Array(s),colors:new Int32Array(r)})}}_buildFigureFromPatch(e){const t=this.figures[e];Bs(t.type==="patch","Unexpected patch mesh figure");const i=this.coords,s=this.colors,r=t.coords,a=t.colors,o=Math.min(i[r[0]][0],i[r[3]][0],i[r[12]][0],i[r[15]][0]),l=Math.min(i[r[0]][1],i[r[3]][1],i[r[12]][1],i[r[15]][1]),c=Math.max(i[r[0]][0],i[r[3]][0],i[r[12]][0],i[r[15]][0]),h=Math.max(i[r[0]][1],i[r[3]][1],i[r[12]][1],i[r[15]][1]);let u=Math.ceil((c-o)*To.TRIANGLE_DENSITY/(this.bounds[2]-this.bounds[0]));u=Us(u,To.MIN_SPLIT_PATCH_CHUNKS_AMOUNT,To.MAX_SPLIT_PATCH_CHUNKS_AMOUNT);let d=Math.ceil((h-l)*To.TRIANGLE_DENSITY/(this.bounds[3]-this.bounds[1]));d=Us(d,To.MIN_SPLIT_PATCH_CHUNKS_AMOUNT,To.MAX_SPLIT_PATCH_CHUNKS_AMOUNT);const f=u+1,g=new Int32Array((d+1)*f),m=new Int32Array((d+1)*f);let x=0;const p=new Uint8Array(3),y=new Uint8Array(3),w=s[a[0]],v=s[a[1]],_=s[a[2]],C=s[a[3]],k=Rk(d),I=Rk(u);for(let S=0;S<=d;S++){p[0]=(w[0]*(d-S)+_[0]*S)/d|0,p[1]=(w[1]*(d-S)+_[1]*S)/d|0,p[2]=(w[2]*(d-S)+_[2]*S)/d|0,y[0]=(v[0]*(d-S)+C[0]*S)/d|0,y[1]=(v[1]*(d-S)+C[1]*S)/d|0,y[2]=(v[2]*(d-S)+C[2]*S)/d|0;for(let R=0;R<=u;R++,x++){if((S===0||S===d)&&(R===0||R===u))continue;let P=0,D=0,U=0;for(let G=0;G<=3;G++)for(let M=0;M<=3;M++,U++){const F=k[S][G]*I[R][M];P+=i[r[U]][0]*F,D+=i[r[U]][1]*F}g[x]=i.length,i.push([P,D]),m[x]=s.length;const T=new Uint8Array(3);T[0]=(p[0]*(u-R)+y[0]*R)/u|0,T[1]=(p[1]*(u-R)+y[1]*R)/u|0,T[2]=(p[2]*(u-R)+y[2]*R)/u|0,s.push(T)}}g[0]=r[0],m[0]=a[0],g[u]=r[3],m[u]=a[1],g[f*d]=r[12],m[f*d]=a[2],g[f*d+u]=r[15],m[f*d+u]=a[3],this.figures[e]={type:"lattice",coords:g,colors:m,verticesPerRow:f}}_updateBounds(){let e=this.coords[0][0],t=this.coords[0][1],i=e,s=t;for(let r=1,a=this.coords.length;r<a;r++){const o=this.coords[r][0],l=this.coords[r][1];e=e>o?o:e,t=t>l?l:t,i=i<o?o:i,s=s<l?l:s}this.bounds=[e,t,i,s]}_packData(){let e,t,i,s;const r=this.coords,a=new Float32Array(r.length*2);for(e=0,i=0,t=r.length;e<t;e++){const h=r[e];a[i++]=h[0],a[i++]=h[1]}this.coords=a;const o=this.colors,l=new Uint8Array(o.length*3);for(e=0,i=0,t=o.length;e<t;e++){const h=o[e];l[i++]=h[0],l[i++]=h[1],l[i++]=h[2]}this.colors=l;const c=this.figures;for(e=0,t=c.length;e<t;e++){const h=c[e],u=h.coords,d=h.colors;for(i=0,s=u.length;i<s;i++)u[i]*=2,d[i]*=3}}getIR(){const{bounds:e}=this;if(e[2]-e[0]===0||e[3]-e[1]===0)throw new Ee(`Invalid MeshShading bounds: [${e}].`);return["Mesh",this.shadingType,this.coords,this.colors,this.figures,e,this.bbox,this.background]}};ze(To,"MIN_SPLIT_PATCH_CHUNKS_AMOUNT",3),ze(To,"MAX_SPLIT_PATCH_CHUNKS_AMOUNT",20),ze(To,"TRIANGLE_DENSITY",20);let K7=To;class ij extends t1{getIR(){return["Dummy"]}}function Mk(n,e,t){const i=Ch(e.getArray("Matrix"),el),s=p0(e.getArray("BBox"),null);if(!s||s[2]-s[0]===0||s[3]-s[1]===0)throw new Ee("Invalid getTilingPatternIR /BBox array.");const r=e.get("XStep");if(typeof r!="number")throw new Ee("Invalid getTilingPatternIR /XStep value.");const a=e.get("YStep");if(typeof a!="number")throw new Ee("Invalid getTilingPatternIR /YStep value.");const o=e.get("PaintType");if(!Number.isInteger(o))throw new Ee("Invalid getTilingPatternIR /PaintType value.");const l=e.get("TilingType");if(!Number.isInteger(l))throw new Ee("Invalid getTilingPatternIR /TilingType value.");return["TilingPattern",t,n,i,s,r,a,o,l]}const sj=[1.3877,1,1,1,.97801,.92482,.89552,.91133,.81988,.97566,.98152,.93548,.93548,1.2798,.85284,.92794,1,.96134,1.54657,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.82845,.82845,.85284,.85284,.85284,.75859,.92138,.83908,.7762,.73293,.87289,.73133,.7514,.81921,.87356,.95958,.59526,.75727,.69225,1.04924,.9121,.86943,.79795,.88198,.77958,.70864,.81055,.90399,.88653,.96017,.82577,.77892,.78257,.97507,1.54657,.97507,.85284,.89552,.90176,.88762,.8785,.75241,.8785,.90518,.95015,.77618,.8785,.88401,.91916,.86304,.88401,.91488,.8785,.8801,.8785,.8785,.91343,.7173,1.04106,.8785,.85075,.95794,.82616,.85162,.79492,.88331,1.69808,.88331,.85284,.97801,.89552,.91133,.89552,.91133,1.7801,.89552,1.24487,1.13254,1.12401,.96839,.85284,.68787,.70645,.85592,.90747,1.01466,1.0088,.90323,1,1.07463,1,.91056,.75806,1.19118,.96839,.78864,.82845,.84133,.75859,.83908,.83908,.83908,.83908,.83908,.83908,.77539,.73293,.73133,.73133,.73133,.73133,.95958,.95958,.95958,.95958,.88506,.9121,.86943,.86943,.86943,.86943,.86943,.85284,.87508,.90399,.90399,.90399,.90399,.77892,.79795,.90807,.88762,.88762,.88762,.88762,.88762,.88762,.8715,.75241,.90518,.90518,.90518,.90518,.88401,.88401,.88401,.88401,.8785,.8785,.8801,.8801,.8801,.8801,.8801,.90747,.89049,.8785,.8785,.8785,.8785,.85162,.8785,.85162,.83908,.88762,.83908,.88762,.83908,.88762,.73293,.75241,.73293,.75241,.73293,.75241,.73293,.75241,.87289,.83016,.88506,.93125,.73133,.90518,.73133,.90518,.73133,.90518,.73133,.90518,.73133,.90518,.81921,.77618,.81921,.77618,.81921,.77618,1,1,.87356,.8785,.91075,.89608,.95958,.88401,.95958,.88401,.95958,.88401,.95958,.88401,.95958,.88401,.76229,.90167,.59526,.91916,1,1,.86304,.69225,.88401,1,1,.70424,.79468,.91926,.88175,.70823,.94903,.9121,.8785,1,1,.9121,.8785,.87802,.88656,.8785,.86943,.8801,.86943,.8801,.86943,.8801,.87402,.89291,.77958,.91343,1,1,.77958,.91343,.70864,.7173,.70864,.7173,.70864,.7173,.70864,.7173,1,1,.81055,.75841,.81055,1.06452,.90399,.8785,.90399,.8785,.90399,.8785,.90399,.8785,.90399,.8785,.90399,.8785,.96017,.95794,.77892,.85162,.77892,.78257,.79492,.78257,.79492,.78257,.79492,.9297,.56892,.83908,.88762,.77539,.8715,.87508,.89049,1,1,.81055,1.04106,1.20528,1.20528,1,1.15543,.70674,.98387,.94721,1.33431,1.45894,.95161,1.06303,.83908,.80352,.57184,.6965,.56289,.82001,.56029,.81235,1.02988,.83908,.7762,.68156,.80367,.73133,.78257,.87356,.86943,.95958,.75727,.89019,1.04924,.9121,.7648,.86943,.87356,.79795,.78275,.81055,.77892,.9762,.82577,.99819,.84896,.95958,.77892,.96108,1.01407,.89049,1.02988,.94211,.96108,.8936,.84021,.87842,.96399,.79109,.89049,1.00813,1.02988,.86077,.87445,.92099,.84723,.86513,.8801,.75638,.85714,.78216,.79586,.87965,.94211,.97747,.78287,.97926,.84971,1.02988,.94211,.8801,.94211,.84971,.73133,1,1,1,1,1,1,1,1,1,1,1,1,.90264,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.90518,1,1,1,1,1,1,1,1,1,1,1,1,.90548,1,1,1,1,1,1,.96017,.95794,.96017,.95794,.96017,.95794,.77892,.85162,1,1,.89552,.90527,1,.90363,.92794,.92794,.92794,.92794,.87012,.87012,.87012,.89552,.89552,1.42259,.71143,1.06152,1,1,1.03372,1.03372,.97171,1.4956,2.2807,.93835,.83406,.91133,.84107,.91133,1,1,1,.72021,1,1.23108,.83489,.88525,.88525,.81499,.90527,1.81055,.90527,1.81055,1.31006,1.53711,.94434,1.08696,1,.95018,.77192,.85284,.90747,1.17534,.69825,.9716,1.37077,.90747,.90747,.85356,.90747,.90747,1.44947,.85284,.8941,.8941,.70572,.8,.70572,.70572,.70572,.70572,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.99862,.99862,1,1,1,1,1,1.08004,.91027,1,1,1,.99862,1,1,1,1,1,1,1,1,1,1,1,1,.90727,.90727,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],rj={lineHeight:1.2207,lineGap:.2207},aj=[1.3877,1,1,1,.97801,.92482,.89552,.91133,.81988,.97566,.98152,.93548,.93548,1.2798,.85284,.92794,1,.96134,1.56239,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.82845,.82845,.85284,.85284,.85284,.75859,.92138,.83908,.7762,.71805,.87289,.73133,.7514,.81921,.87356,.95958,.59526,.75727,.69225,1.04924,.90872,.85938,.79795,.87068,.77958,.69766,.81055,.90399,.88653,.96068,.82577,.77892,.78257,.97507,1.529,.97507,.85284,.89552,.90176,.94908,.86411,.74012,.86411,.88323,.95015,.86411,.86331,.88401,.91916,.86304,.88401,.9039,.86331,.86331,.86411,.86411,.90464,.70852,1.04106,.86331,.84372,.95794,.82616,.84548,.79492,.88331,1.69808,.88331,.85284,.97801,.89552,.91133,.89552,.91133,1.7801,.89552,1.24487,1.13254,1.19129,.96839,.85284,.68787,.70645,.85592,.90747,1.01466,1.0088,.90323,1,1.07463,1,.91056,.75806,1.19118,.96839,.78864,.82845,.84133,.75859,.83908,.83908,.83908,.83908,.83908,.83908,.77539,.71805,.73133,.73133,.73133,.73133,.95958,.95958,.95958,.95958,.88506,.90872,.85938,.85938,.85938,.85938,.85938,.85284,.87068,.90399,.90399,.90399,.90399,.77892,.79795,.90807,.94908,.94908,.94908,.94908,.94908,.94908,.85887,.74012,.88323,.88323,.88323,.88323,.88401,.88401,.88401,.88401,.8785,.86331,.86331,.86331,.86331,.86331,.86331,.90747,.89049,.86331,.86331,.86331,.86331,.84548,.86411,.84548,.83908,.94908,.83908,.94908,.83908,.94908,.71805,.74012,.71805,.74012,.71805,.74012,.71805,.74012,.87289,.79538,.88506,.92726,.73133,.88323,.73133,.88323,.73133,.88323,.73133,.88323,.73133,.88323,.81921,.86411,.81921,.86411,.81921,.86411,1,1,.87356,.86331,.91075,.8777,.95958,.88401,.95958,.88401,.95958,.88401,.95958,.88401,.95958,.88401,.76467,.90167,.59526,.91916,1,1,.86304,.69225,.88401,1,1,.70424,.77312,.91926,.88175,.70823,.94903,.90872,.86331,1,1,.90872,.86331,.86906,.88116,.86331,.85938,.86331,.85938,.86331,.85938,.86331,.87402,.86549,.77958,.90464,1,1,.77958,.90464,.69766,.70852,.69766,.70852,.69766,.70852,.69766,.70852,1,1,.81055,.75841,.81055,1.06452,.90399,.86331,.90399,.86331,.90399,.86331,.90399,.86331,.90399,.86331,.90399,.86331,.96068,.95794,.77892,.84548,.77892,.78257,.79492,.78257,.79492,.78257,.79492,.9297,.56892,.83908,.94908,.77539,.85887,.87068,.89049,1,1,.81055,1.04106,1.20528,1.20528,1,1.15543,.70088,.98387,.94721,1.33431,1.45894,.95161,1.48387,.83908,.80352,.57118,.6965,.56347,.79179,.55853,.80346,1.02988,.83908,.7762,.67174,.86036,.73133,.78257,.87356,.86441,.95958,.75727,.89019,1.04924,.90872,.74889,.85938,.87891,.79795,.7957,.81055,.77892,.97447,.82577,.97466,.87179,.95958,.77892,.94252,.95612,.8753,1.02988,.92733,.94252,.87411,.84021,.8728,.95612,.74081,.8753,1.02189,1.02988,.84814,.87445,.91822,.84723,.85668,.86331,.81344,.87581,.76422,.82046,.96057,.92733,.99375,.78022,.95452,.86015,1.02988,.92733,.86331,.92733,.86015,.73133,1,1,1,1,1,1,1,1,1,1,1,1,.90631,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.88323,1,1,1,1,1,1,1,1,1,1,1,1,.85174,1,1,1,1,1,1,.96068,.95794,.96068,.95794,.96068,.95794,.77892,.84548,1,1,.89552,.90527,1,.90363,.92794,.92794,.92794,.89807,.87012,.87012,.87012,.89552,.89552,1.42259,.71094,1.06152,1,1,1.03372,1.03372,.97171,1.4956,2.2807,.92972,.83406,.91133,.83326,.91133,1,1,1,.72021,1,1.23108,.83489,.88525,.88525,.81499,.90616,1.81055,.90527,1.81055,1.3107,1.53711,.94434,1.08696,1,.95018,.77192,.85284,.90747,1.17534,.69825,.9716,1.37077,.90747,.90747,.85356,.90747,.90747,1.44947,.85284,.8941,.8941,.70572,.8,.70572,.70572,.70572,.70572,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.99862,.99862,1,1,1,1,1,1.08004,.91027,1,1,1,.99862,1,1,1,1,1,1,1,1,1,1,1,1,.90727,.90727,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],oj={lineHeight:1.2207,lineGap:.2207},lj=[1.3877,1,1,1,1.17223,1.1293,.89552,.91133,.80395,1.02269,1.15601,.91056,.91056,1.2798,.85284,.89807,1,.90861,1.39543,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.96309,.96309,.85284,.85284,.85284,.83319,.88071,.8675,.81552,.72346,.85193,.73206,.7522,.81105,.86275,.90685,.6377,.77892,.75593,1.02638,.89249,.84118,.77452,.85374,.75186,.67789,.79776,.88844,.85066,.94309,.77818,.7306,.76659,1.10369,1.38313,1.10369,1.06139,.89552,.8739,.9245,.9245,.83203,.9245,.85865,1.09842,.9245,.9245,1.03297,1.07692,.90918,1.03297,.94959,.9245,.92274,.9245,.9245,1.02933,.77832,1.20562,.9245,.8916,.98986,.86621,.89453,.79004,.94152,1.77256,.94152,.85284,.97801,.89552,.91133,.89552,.91133,1.91729,.89552,1.17889,1.13254,1.16359,.92098,.85284,.68787,.71353,.84737,.90747,1.0088,1.0044,.87683,1,1.09091,1,.92229,.739,1.15642,.92098,.76288,.80504,.80972,.75859,.8675,.8675,.8675,.8675,.8675,.8675,.76318,.72346,.73206,.73206,.73206,.73206,.90685,.90685,.90685,.90685,.86477,.89249,.84118,.84118,.84118,.84118,.84118,.85284,.84557,.88844,.88844,.88844,.88844,.7306,.77452,.86331,.9245,.9245,.9245,.9245,.9245,.9245,.84843,.83203,.85865,.85865,.85865,.85865,.82601,.82601,.82601,.82601,.94469,.9245,.92274,.92274,.92274,.92274,.92274,.90747,.86651,.9245,.9245,.9245,.9245,.89453,.9245,.89453,.8675,.9245,.8675,.9245,.8675,.9245,.72346,.83203,.72346,.83203,.72346,.83203,.72346,.83203,.85193,.8875,.86477,.99034,.73206,.85865,.73206,.85865,.73206,.85865,.73206,.85865,.73206,.85865,.81105,.9245,.81105,.9245,.81105,.9245,1,1,.86275,.9245,.90872,.93591,.90685,.82601,.90685,.82601,.90685,.82601,.90685,1.03297,.90685,.82601,.77896,1.05611,.6377,1.07692,1,1,.90918,.75593,1.03297,1,1,.76032,.9375,.98156,.93407,.77261,1.11429,.89249,.9245,1,1,.89249,.9245,.92534,.86698,.9245,.84118,.92274,.84118,.92274,.84118,.92274,.8667,.86291,.75186,1.02933,1,1,.75186,1.02933,.67789,.77832,.67789,.77832,.67789,.77832,.67789,.77832,1,1,.79776,.97655,.79776,1.23023,.88844,.9245,.88844,.9245,.88844,.9245,.88844,.9245,.88844,.9245,.88844,.9245,.94309,.98986,.7306,.89453,.7306,.76659,.79004,.76659,.79004,.76659,.79004,1.09231,.54873,.8675,.9245,.76318,.84843,.84557,.86651,1,1,.79776,1.20562,1.18622,1.18622,1,1.1437,.67009,.96334,.93695,1.35191,1.40909,.95161,1.48387,.8675,.90861,.6192,.7363,.64824,.82411,.56321,.85696,1.23516,.8675,.81552,.7286,.84134,.73206,.76659,.86275,.84369,.90685,.77892,.85871,1.02638,.89249,.75828,.84118,.85984,.77452,.76466,.79776,.7306,.90782,.77818,.903,.87291,.90685,.7306,.99058,1.03667,.94635,1.23516,.9849,.99058,.92393,.8916,.942,1.03667,.75026,.94635,1.0297,1.23516,.90918,.94048,.98217,.89746,.84153,.92274,.82507,.88832,.84438,.88178,1.03525,.9849,1.00225,.78086,.97248,.89404,1.23516,.9849,.92274,.9849,.89404,.73206,1,1,1,1,1,1,1,1,1,1,1,1,.89693,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.85865,1,1,1,1,1,1,1,1,1,1,1,1,.90933,1,1,1,1,1,1,.94309,.98986,.94309,.98986,.94309,.98986,.7306,.89453,1,1,.89552,.90527,1,.90186,1.12308,1.12308,1.12308,1.12308,1.2566,1.2566,1.2566,.89552,.89552,1.42259,.68994,1.03809,1,1,1.0176,1.0176,1.11523,1.4956,2.01462,.97858,.82616,.91133,.83437,.91133,1,1,1,.70508,1,1.23108,.79801,.84426,.84426,.774,.90572,1.81055,.90749,1.81055,1.28809,1.55469,.94434,1.07806,1,.97094,.7589,.85284,.90747,1.19658,.69825,.97622,1.33512,.90747,.90747,.85284,.90747,.90747,1.44947,.85284,.8941,.8941,.70572,.8,.70572,.70572,.70572,.70572,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.99862,.99862,1,1,1,1,1,1.0336,.91027,1,1,1,.99862,1,1,1,1,1,1,1,1,1,1,1,1,1.05859,1.05859,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],cj={lineHeight:1.2207,lineGap:.2207},hj=[1.3877,1,1,1,1.17223,1.1293,.89552,.91133,.80395,1.02269,1.15601,.91056,.91056,1.2798,.85284,.89807,1,.90861,1.39016,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.91133,.96309,.96309,.85284,.85284,.85284,.83319,.88071,.8675,.81552,.73834,.85193,.73206,.7522,.81105,.86275,.90685,.6377,.77892,.75593,1.02638,.89385,.85122,.77452,.86503,.75186,.68887,.79776,.88844,.85066,.94258,.77818,.7306,.76659,1.10369,1.39016,1.10369,1.06139,.89552,.8739,.86128,.94469,.8457,.94469,.89464,1.09842,.84636,.94469,1.03297,1.07692,.90918,1.03297,.95897,.94469,.9482,.94469,.94469,1.04692,.78223,1.20562,.94469,.90332,.98986,.86621,.90527,.79004,.94152,1.77256,.94152,.85284,.97801,.89552,.91133,.89552,.91133,1.91729,.89552,1.17889,1.13254,1.08707,.92098,.85284,.68787,.71353,.84737,.90747,1.0088,1.0044,.87683,1,1.09091,1,.92229,.739,1.15642,.92098,.76288,.80504,.80972,.75859,.8675,.8675,.8675,.8675,.8675,.8675,.76318,.73834,.73206,.73206,.73206,.73206,.90685,.90685,.90685,.90685,.86477,.89385,.85122,.85122,.85122,.85122,.85122,.85284,.85311,.88844,.88844,.88844,.88844,.7306,.77452,.86331,.86128,.86128,.86128,.86128,.86128,.86128,.8693,.8457,.89464,.89464,.89464,.89464,.82601,.82601,.82601,.82601,.94469,.94469,.9482,.9482,.9482,.9482,.9482,.90747,.86651,.94469,.94469,.94469,.94469,.90527,.94469,.90527,.8675,.86128,.8675,.86128,.8675,.86128,.73834,.8457,.73834,.8457,.73834,.8457,.73834,.8457,.85193,.92454,.86477,.9921,.73206,.89464,.73206,.89464,.73206,.89464,.73206,.89464,.73206,.89464,.81105,.84636,.81105,.84636,.81105,.84636,1,1,.86275,.94469,.90872,.95786,.90685,.82601,.90685,.82601,.90685,.82601,.90685,1.03297,.90685,.82601,.77741,1.05611,.6377,1.07692,1,1,.90918,.75593,1.03297,1,1,.76032,.90452,.98156,1.11842,.77261,1.11429,.89385,.94469,1,1,.89385,.94469,.95877,.86901,.94469,.85122,.9482,.85122,.9482,.85122,.9482,.8667,.90016,.75186,1.04692,1,1,.75186,1.04692,.68887,.78223,.68887,.78223,.68887,.78223,.68887,.78223,1,1,.79776,.92188,.79776,1.23023,.88844,.94469,.88844,.94469,.88844,.94469,.88844,.94469,.88844,.94469,.88844,.94469,.94258,.98986,.7306,.90527,.7306,.76659,.79004,.76659,.79004,.76659,.79004,1.09231,.54873,.8675,.86128,.76318,.8693,.85311,.86651,1,1,.79776,1.20562,1.18622,1.18622,1,1.1437,.67742,.96334,.93695,1.35191,1.40909,.95161,1.48387,.86686,.90861,.62267,.74359,.65649,.85498,.56963,.88254,1.23516,.8675,.81552,.75443,.84503,.73206,.76659,.86275,.85122,.90685,.77892,.85746,1.02638,.89385,.75657,.85122,.86275,.77452,.74171,.79776,.7306,.95165,.77818,.89772,.88831,.90685,.7306,.98142,1.02191,.96576,1.23516,.99018,.98142,.9236,.89258,.94035,1.02191,.78848,.96576,.9561,1.23516,.90918,.92578,.95424,.89746,.83969,.9482,.80113,.89442,.85208,.86155,.98022,.99018,1.00452,.81209,.99247,.89181,1.23516,.99018,.9482,.99018,.89181,.73206,1,1,1,1,1,1,1,1,1,1,1,1,.88844,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.89464,1,1,1,1,1,1,1,1,1,1,1,1,.96766,1,1,1,1,1,1,.94258,.98986,.94258,.98986,.94258,.98986,.7306,.90527,1,1,.89552,.90527,1,.90186,1.12308,1.12308,1.12308,1.12308,1.2566,1.2566,1.2566,.89552,.89552,1.42259,.69043,1.03809,1,1,1.0176,1.0176,1.11523,1.4956,2.01462,.99331,.82616,.91133,.84286,.91133,1,1,1,.70508,1,1.23108,.79801,.84426,.84426,.774,.90527,1.81055,.90527,1.81055,1.28809,1.55469,.94434,1.07806,1,.97094,.7589,.85284,.90747,1.19658,.69825,.97622,1.33512,.90747,.90747,.85356,.90747,.90747,1.44947,.85284,.8941,.8941,.70572,.8,.70572,.70572,.70572,.70572,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.99862,.99862,1,1,1,1,1,1.0336,.91027,1,1,1,.99862,1,1,1,1,1,1,1,1,1,1,1,1,1.05859,1.05859,1,1,1,1.07185,.99413,.96334,1.08065,1,1,1,1,1,1,1,1,1,1,1],uj={lineHeight:1.2207,lineGap:.2207},dj=[.76116,1,1,1.0006,.99998,.99974,.99973,.99973,.99982,.99977,1.00087,.99998,.99998,.99959,1.00003,1.0006,.99998,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99998,1,1.00003,1.00003,1.00003,1.00026,.9999,.99977,.99977,.99977,.99977,1.00001,1.00026,1.00022,.99977,1.0006,.99973,.99977,1.00026,.99999,.99977,1.00022,1.00001,1.00022,.99977,1.00001,1.00026,.99977,1.00001,1.00016,1.00001,1.00001,1.00026,.99998,1.0006,.99998,1.00003,.99973,.99998,.99973,1.00026,.99973,1.00026,.99973,.99998,1.00026,1.00026,1.0006,1.0006,.99973,1.0006,.99982,1.00026,1.00026,1.00026,1.00026,.99959,.99973,.99998,1.00026,.99973,1.00022,.99973,.99973,1,.99959,1.00077,.99959,1.00003,.99998,.99973,.99973,.99973,.99973,1.00077,.99973,.99998,1.00025,.99968,.99973,1.00003,1.00025,.60299,1.00024,1.06409,1,1,.99998,1,.99973,1.0006,.99998,1,.99936,.99973,1.00002,1.00002,1.00002,1.00026,.99977,.99977,.99977,.99977,.99977,.99977,1,.99977,1.00001,1.00001,1.00001,1.00001,1.0006,1.0006,1.0006,1.0006,.99977,.99977,1.00022,1.00022,1.00022,1.00022,1.00022,1.00003,1.00022,.99977,.99977,.99977,.99977,1.00001,1.00001,1.00026,.99973,.99973,.99973,.99973,.99973,.99973,.99982,.99973,.99973,.99973,.99973,.99973,1.0006,1.0006,1.0006,1.0006,1.00026,1.00026,1.00026,1.00026,1.00026,1.00026,1.00026,1.06409,1.00026,1.00026,1.00026,1.00026,1.00026,.99973,1.00026,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,1.03374,.99977,1.00026,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,.99977,1.00026,.99977,1.00026,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.00042,.99973,.99973,1.0006,.99977,.99973,.99973,1.00026,1.0006,1.00026,1.0006,1.00026,1.03828,1.00026,.99999,1.00026,1.0006,.99977,1.00026,.99977,1.00026,.99977,1.00026,.9993,.9998,1.00026,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,1,1.00016,.99977,.99959,.99977,.99959,.99977,.99959,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00026,.99998,1.00026,.8121,1.00026,.99998,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,1.00016,1.00022,1.00001,.99973,1.00001,1.00026,1,1.00026,1,1.00026,1,1.0006,.99973,.99977,.99973,1,.99982,1.00022,1.00026,1.00001,.99973,1.00026,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,1.00034,.99977,1,.99997,1.00026,1.00078,1.00036,.99973,1.00013,1.0006,.99977,.99977,.99988,.85148,1.00001,1.00026,.99977,1.00022,1.0006,.99977,1.00001,.99999,.99977,1.00069,1.00022,.99977,1.00001,.99984,1.00026,1.00001,1.00024,1.00001,.9999,1,1.0006,1.00001,1.00041,.99962,1.00026,1.0006,.99995,1.00041,.99942,.99973,.99927,1.00082,.99902,1.00026,1.00087,1.0006,1.00069,.99973,.99867,.99973,.9993,1.00026,1.00049,1.00056,1,.99988,.99935,.99995,.99954,1.00055,.99945,1.00032,1.0006,.99995,1.00026,.99995,1.00032,1.00001,1.00008,.99971,1.00019,.9994,1.00001,1.0006,1.00044,.99973,1.00023,1.00047,1,.99942,.99561,.99989,1.00035,.99977,1.00035,.99977,1.00019,.99944,1.00001,1.00021,.99926,1.00035,1.00035,.99942,1.00048,.99999,.99977,1.00022,1.00035,1.00001,.99977,1.00026,.99989,1.00057,1.00001,.99936,1.00052,1.00012,.99996,1.00043,1,1.00035,.9994,.99976,1.00035,.99973,1.00052,1.00041,1.00119,1.00037,.99973,1.00002,.99986,1.00041,1.00041,.99902,.9996,1.00034,.99999,1.00026,.99999,1.00026,.99973,1.00052,.99973,1,.99973,1.00041,1.00075,.9994,1.0003,.99999,1,1.00041,.99955,1,.99915,.99973,.99973,1.00026,1.00119,.99955,.99973,1.0006,.99911,1.0006,1.00026,.99972,1.00026,.99902,1.00041,.99973,.99999,1,1,1.00038,1.0005,1.00016,1.00022,1.00016,1.00022,1.00016,1.00022,1.00001,.99973,1,1,.99973,1,1,.99955,1.0006,1.0006,1.0006,1.0006,1,1,1,.99973,.99973,.99972,1,1,1.00106,.99999,.99998,.99998,.99999,.99998,1.66475,1,.99973,.99973,1.00023,.99973,.99971,1.00047,1.00023,1,.99991,.99984,1.00002,1.00002,1.00002,1.00002,1,1,1,1,1,1,1,.99972,1,1.20985,1.39713,1.00003,1.00031,1.00015,1,.99561,1.00027,1.00031,1.00031,.99915,1.00031,1.00031,.99999,1.00003,.99999,.99999,1.41144,1.6,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.40579,1.40579,1.36625,.99999,1,.99861,.99861,1,1.00026,1.00026,1.00026,1.00026,.99972,.99999,.99999,.99999,.99999,1.40483,1,.99977,1.00054,1,1,.99953,.99962,1.00042,.9995,1,1,1,1,1,1,1,1,.99998,.99998,.99998,.99998,1,1,1,1,1,1,1,1,1,1,1],fj={lineHeight:1.2,lineGap:.2},gj=[.76116,1,1,1.0006,.99998,.99974,.99973,.99973,.99982,.99977,1.00087,.99998,.99998,.99959,1.00003,1.0006,.99998,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99998,1,1.00003,1.00003,1.00003,1.00026,.9999,.99977,.99977,.99977,.99977,1.00001,1.00026,1.00022,.99977,1.0006,.99973,.99977,1.00026,.99999,.99977,1.00022,1.00001,1.00022,.99977,1.00001,1.00026,.99977,1.00001,1.00016,1.00001,1.00001,1.00026,.99998,1.0006,.99998,1.00003,.99973,.99998,.99973,1.00026,.99973,1.00026,.99973,.99998,1.00026,1.00026,1.0006,1.0006,.99973,1.0006,.99982,1.00026,1.00026,1.00026,1.00026,.99959,.99973,.99998,1.00026,.99973,1.00022,.99973,.99973,1,.99959,1.00077,.99959,1.00003,.99998,.99973,.99973,.99973,.99973,1.00077,.99973,.99998,1.00025,.99968,.99973,1.00003,1.00025,.60299,1.00024,1.06409,1,1,.99998,1,.99973,1.0006,.99998,1,.99936,.99973,1.00002,1.00002,1.00002,1.00026,.99977,.99977,.99977,.99977,.99977,.99977,1,.99977,1.00001,1.00001,1.00001,1.00001,1.0006,1.0006,1.0006,1.0006,.99977,.99977,1.00022,1.00022,1.00022,1.00022,1.00022,1.00003,1.00022,.99977,.99977,.99977,.99977,1.00001,1.00001,1.00026,.99973,.99973,.99973,.99973,.99973,.99973,.99982,.99973,.99973,.99973,.99973,.99973,1.0006,1.0006,1.0006,1.0006,1.00026,1.00026,1.00026,1.00026,1.00026,1.00026,1.00026,1.06409,1.00026,1.00026,1.00026,1.00026,1.00026,.99973,1.00026,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,1.0044,.99977,1.00026,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,.99977,1.00026,.99977,1.00026,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,.99971,.99973,.99973,1.0006,.99977,.99973,.99973,1.00026,1.0006,1.00026,1.0006,1.00026,1.01011,1.00026,.99999,1.00026,1.0006,.99977,1.00026,.99977,1.00026,.99977,1.00026,.9993,.9998,1.00026,1.00022,1.00026,1.00022,1.00026,1.00022,1.00026,1,1.00016,.99977,.99959,.99977,.99959,.99977,.99959,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00026,.99998,1.00026,.8121,1.00026,.99998,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,.99977,1.00026,1.00016,1.00022,1.00001,.99973,1.00001,1.00026,1,1.00026,1,1.00026,1,1.0006,.99973,.99977,.99973,1,.99982,1.00022,1.00026,1.00001,.99973,1.00026,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99977,1,1,1.00026,.99969,.99972,.99981,.9998,1.0006,.99977,.99977,1.00022,.91155,1.00001,1.00026,.99977,1.00022,1.0006,.99977,1.00001,.99999,.99977,.99966,1.00022,1.00032,1.00001,.99944,1.00026,1.00001,.99968,1.00001,1.00047,1,1.0006,1.00001,.99981,1.00101,1.00026,1.0006,.99948,.99981,1.00064,.99973,.99942,1.00101,1.00061,1.00026,1.00069,1.0006,1.00014,.99973,1.01322,.99973,1.00065,1.00026,1.00012,.99923,1,1.00064,1.00076,.99948,1.00055,1.00063,1.00007,.99943,1.0006,.99948,1.00026,.99948,.99943,1.00001,1.00001,1.00029,1.00038,1.00035,1.00001,1.0006,1.0006,.99973,.99978,1.00001,1.00057,.99989,.99967,.99964,.99967,.99977,.99999,.99977,1.00038,.99977,1.00001,.99973,1.00066,.99967,.99967,1.00041,.99998,.99999,.99977,1.00022,.99967,1.00001,.99977,1.00026,.99964,1.00031,1.00001,.99999,.99999,1,1.00023,1,1,.99999,1.00035,1.00001,.99999,.99973,.99977,.99999,1.00058,.99973,.99973,.99955,.9995,1.00026,1.00026,1.00032,.99989,1.00034,.99999,1.00026,1.00026,1.00026,.99973,.45998,.99973,1.00026,.99973,1.00001,.99999,.99982,.99994,.99996,1,1.00042,1.00044,1.00029,1.00023,.99973,.99973,1.00026,.99949,1.00002,.99973,1.0006,1.0006,1.0006,.99975,1.00026,1.00026,1.00032,.98685,.99973,1.00026,1,1,.99966,1.00044,1.00016,1.00022,1.00016,1.00022,1.00016,1.00022,1.00001,.99973,1,1,.99973,1,1,.99955,1.0006,1.0006,1.0006,1.0006,1,1,1,.99973,.99973,.99972,1,1,1.00106,.99999,.99998,.99998,.99999,.99998,1.66475,1,.99973,.99973,1,.99973,.99971,.99978,1,1,.99991,.99984,1.00002,1.00002,1.00002,1.00002,1.00098,1,1,1,1.00049,1,1,.99972,1,1.20985,1.39713,1.00003,1.00031,1.00015,1,.99561,1.00027,1.00031,1.00031,.99915,1.00031,1.00031,.99999,1.00003,.99999,.99999,1.41144,1.6,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.40579,1.40579,1.36625,.99999,1,.99861,.99861,1,1.00026,1.00026,1.00026,1.00026,.99972,.99999,.99999,.99999,.99999,1.40483,1,.99977,1.00054,1,1,.99953,.99962,1.00042,.9995,1,1,1,1,1,1,1,1,.99998,.99998,.99998,.99998,1,1,1,1,1,1,1,1,1,1,1],mj={lineHeight:1.35,lineGap:.2},pj=[.76116,1,1,1.0006,1.0006,1.00006,.99973,.99973,.99982,1.00001,1.00043,.99998,.99998,.99959,1.00003,1.0006,.99998,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,1.0006,1,1.00003,1.00003,1.00003,.99973,.99987,1.00001,1.00001,.99977,.99977,1.00001,1.00026,1.00022,.99977,1.0006,1,1.00001,.99973,.99999,.99977,1.00022,1.00001,1.00022,.99977,1.00001,1.00026,.99977,1.00001,1.00016,1.00001,1.00001,1.00026,1.0006,1.0006,1.0006,.99949,.99973,.99998,.99973,.99973,1,.99973,.99973,1.0006,.99973,.99973,.99924,.99924,1,.99924,.99999,.99973,.99973,.99973,.99973,.99998,1,1.0006,.99973,1,.99977,1,1,1,1.00005,1.0009,1.00005,1.00003,.99998,.99973,.99973,.99973,.99973,1.0009,.99973,.99998,1.00025,.99968,.99973,1.00003,1.00025,.60299,1.00024,1.06409,1,1,.99998,1,.9998,1.0006,.99998,1,.99936,.99973,1.00002,1.00002,1.00002,1.00026,1.00001,1.00001,1.00001,1.00001,1.00001,1.00001,1,.99977,1.00001,1.00001,1.00001,1.00001,1.0006,1.0006,1.0006,1.0006,.99977,.99977,1.00022,1.00022,1.00022,1.00022,1.00022,1.00003,1.00022,.99977,.99977,.99977,.99977,1.00001,1.00001,1.00026,.99973,.99973,.99973,.99973,.99973,.99973,.99982,1,.99973,.99973,.99973,.99973,1.0006,1.0006,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,1.06409,1.00026,.99973,.99973,.99973,.99973,1,.99973,1,1.00001,.99973,1.00001,.99973,1.00001,.99973,.99977,1,.99977,1,.99977,1,.99977,1,.99977,1.0288,.99977,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,.99977,.99973,.99977,.99973,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,.99924,1.0006,1.0006,.99946,1.00034,1,.99924,1.00001,1,1,.99973,.99924,.99973,.99924,.99973,1.06311,.99973,1.00024,.99973,.99924,.99977,.99973,.99977,.99973,.99977,.99973,1.00041,.9998,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,1,1.00016,.99977,.99998,.99977,.99998,.99977,.99998,1.00001,1,1.00001,1,1.00001,1,1.00001,1,1.00026,1.0006,1.00026,.89547,1.00026,1.0006,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,1.00016,.99977,1.00001,1,1.00001,1.00026,1,1.00026,1,1.00026,1,.99924,.99973,1.00001,.99973,1,.99982,1.00022,1.00026,1.00001,1,1.00026,1.0006,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,1.00001,1,1.00054,.99977,1.00084,1.00007,.99973,1.00013,.99924,1.00001,1.00001,.99945,.91221,1.00001,1.00026,.99977,1.00022,1.0006,1.00001,1.00001,.99999,.99977,.99933,1.00022,1.00054,1.00001,1.00065,1.00026,1.00001,1.0001,1.00001,1.00052,1,1.0006,1.00001,.99945,.99897,.99968,.99924,1.00036,.99945,.99949,1,1.0006,.99897,.99918,.99968,.99911,.99924,1,.99962,1.01487,1,1.0005,.99973,1.00012,1.00043,1,.99995,.99994,1.00036,.99947,1.00019,1.00063,1.00025,.99924,1.00036,.99973,1.00036,1.00025,1.00001,1.00001,1.00027,1.0001,1.00068,1.00001,1.0006,1.0006,1,1.00008,.99957,.99972,.9994,.99954,.99975,1.00051,1.00001,1.00019,1.00001,1.0001,.99986,1.00001,1.00001,1.00038,.99954,.99954,.9994,1.00066,.99999,.99977,1.00022,1.00054,1.00001,.99977,1.00026,.99975,1.0001,1.00001,.99993,.9995,.99955,1.00016,.99978,.99974,1.00019,1.00022,.99955,1.00053,.99973,1.00089,1.00005,.99967,1.00048,.99973,1.00002,1.00034,.99973,.99973,.99964,1.00006,1.00066,.99947,.99973,.98894,.99973,1,.44898,1,.99946,1,1.00039,1.00082,.99991,.99991,.99985,1.00022,1.00023,1.00061,1.00006,.99966,.99973,.99973,.99973,1.00019,1.0008,1,.99924,.99924,.99924,.99983,1.00044,.99973,.99964,.98332,1,.99973,1,1,.99962,.99895,1.00016,.99977,1.00016,.99977,1.00016,.99977,1.00001,1,1,1,.99973,1,1,.99955,.99924,.99924,.99924,.99924,.99998,.99998,.99998,.99973,.99973,.99972,1,1,1.00267,.99999,.99998,.99998,1,.99998,1.66475,1,.99973,.99973,1.00023,.99973,1.00423,.99925,.99999,1,.99991,.99984,1.00002,1.00002,1.00002,1.00002,1.00049,1,1.00245,1,1,1,1,.96329,1,1.20985,1.39713,1.00003,.8254,1.00015,1,1.00035,1.00027,1.00031,1.00031,1.00003,1.00031,1.00031,.99999,1.00003,.99999,.99999,1.41144,1.6,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.40579,1.40579,1.36625,.99999,1,.99861,.99861,1,1.00026,1.00026,1.00026,1.00026,.95317,.99999,.99999,.99999,.99999,1.40483,1,.99977,1.00054,1,1,.99953,.99962,1.00042,.9995,1,1,1,1,1,1,1,1,.99998,.99998,.99998,.99998,1,1,1,1,1,1,1,1,1,1,1],bj={lineHeight:1.35,lineGap:.2},xj=[.76116,1,1,1.0006,1.0006,1.00006,.99973,.99973,.99982,1.00001,1.00043,.99998,.99998,.99959,1.00003,1.0006,.99998,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,.99973,1.0006,1,1.00003,1.00003,1.00003,.99973,.99987,1.00001,1.00001,.99977,.99977,1.00001,1.00026,1.00022,.99977,1.0006,1,1.00001,.99973,.99999,.99977,1.00022,1.00001,1.00022,.99977,1.00001,1.00026,.99977,1.00001,1.00016,1.00001,1.00001,1.00026,1.0006,1.0006,1.0006,.99949,.99973,.99998,.99973,.99973,1,.99973,.99973,1.0006,.99973,.99973,.99924,.99924,1,.99924,.99999,.99973,.99973,.99973,.99973,.99998,1,1.0006,.99973,1,.99977,1,1,1,1.00005,1.0009,1.00005,1.00003,.99998,.99973,.99973,.99973,.99973,1.0009,.99973,.99998,1.00025,.99968,.99973,1.00003,1.00025,.60299,1.00024,1.06409,1,1,.99998,1,.9998,1.0006,.99998,1,.99936,.99973,1.00002,1.00002,1.00002,1.00026,1.00001,1.00001,1.00001,1.00001,1.00001,1.00001,1,.99977,1.00001,1.00001,1.00001,1.00001,1.0006,1.0006,1.0006,1.0006,.99977,.99977,1.00022,1.00022,1.00022,1.00022,1.00022,1.00003,1.00022,.99977,.99977,.99977,.99977,1.00001,1.00001,1.00026,.99973,.99973,.99973,.99973,.99973,.99973,.99982,1,.99973,.99973,.99973,.99973,1.0006,1.0006,1.0006,1.0006,.99973,.99973,.99973,.99973,.99973,.99973,.99973,1.06409,1.00026,.99973,.99973,.99973,.99973,1,.99973,1,1.00001,.99973,1.00001,.99973,1.00001,.99973,.99977,1,.99977,1,.99977,1,.99977,1,.99977,1.04596,.99977,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00001,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,.99977,.99973,.99977,.99973,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,1.0006,.99924,1.0006,1.0006,1.00019,1.00034,1,.99924,1.00001,1,1,.99973,.99924,.99973,.99924,.99973,1.02572,.99973,1.00005,.99973,.99924,.99977,.99973,.99977,.99973,.99977,.99973,.99999,.9998,.99973,1.00022,.99973,1.00022,.99973,1.00022,.99973,1,1.00016,.99977,.99998,.99977,.99998,.99977,.99998,1.00001,1,1.00001,1,1.00001,1,1.00001,1,1.00026,1.0006,1.00026,.84533,1.00026,1.0006,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,.99977,.99973,1.00016,.99977,1.00001,1,1.00001,1.00026,1,1.00026,1,1.00026,1,.99924,.99973,1.00001,.99973,1,.99982,1.00022,1.00026,1.00001,1,1.00026,1.0006,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99998,.99928,1,.99977,1.00013,1.00055,.99947,.99945,.99941,.99924,1.00001,1.00001,1.0004,.91621,1.00001,1.00026,.99977,1.00022,1.0006,1.00001,1.00005,.99999,.99977,1.00015,1.00022,.99977,1.00001,.99973,1.00026,1.00001,1.00019,1.00001,.99946,1,1.0006,1.00001,.99978,1.00045,.99973,.99924,1.00023,.99978,.99966,1,1.00065,1.00045,1.00019,.99973,.99973,.99924,1,1,.96499,1,1.00055,.99973,1.00008,1.00027,1,.9997,.99995,1.00023,.99933,1.00019,1.00015,1.00031,.99924,1.00023,.99973,1.00023,1.00031,1.00001,.99928,1.00029,1.00092,1.00035,1.00001,1.0006,1.0006,1,.99988,.99975,1,1.00082,.99561,.9996,1.00035,1.00001,.99962,1.00001,1.00092,.99964,1.00001,.99963,.99999,1.00035,1.00035,1.00082,.99962,.99999,.99977,1.00022,1.00035,1.00001,.99977,1.00026,.9996,.99967,1.00001,1.00034,1.00074,1.00054,1.00053,1.00063,.99971,.99962,1.00035,.99975,.99977,.99973,1.00043,.99953,1.0007,.99915,.99973,1.00008,.99892,1.00073,1.00073,1.00114,.99915,1.00073,.99955,.99973,1.00092,.99973,1,.99998,1,1.0003,1,1.00043,1.00001,.99969,1.0003,1,1.00035,1.00001,.9995,1,1.00092,.99973,.99973,.99973,1.0007,.9995,1,.99924,1.0006,.99924,.99972,1.00062,.99973,1.00114,1.00073,1,.99955,1,1,1.00047,.99968,1.00016,.99977,1.00016,.99977,1.00016,.99977,1.00001,1,1,1,.99973,1,1,.99955,.99924,.99924,.99924,.99924,.99998,.99998,.99998,.99973,.99973,.99972,1,1,1.00267,.99999,.99998,.99998,1,.99998,1.66475,1,.99973,.99973,1.00023,.99973,.99971,.99925,1.00023,1,.99991,.99984,1.00002,1.00002,1.00002,1.00002,1,1,1,1,1,1,1,.96329,1,1.20985,1.39713,1.00003,.8254,1.00015,1,1.00035,1.00027,1.00031,1.00031,.99915,1.00031,1.00031,.99999,1.00003,.99999,.99999,1.41144,1.6,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.41144,1.40579,1.40579,1.36625,.99999,1,.99861,.99861,1,1.00026,1.00026,1.00026,1.00026,.95317,.99999,.99999,.99999,.99999,1.40483,1,.99977,1.00054,1,1,.99953,.99962,1.00042,.9995,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],yj={lineHeight:1.2,lineGap:.2},Im=[365,0,333,278,333,474,556,556,889,722,238,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,333,333,584,584,584,611,975,722,722,722,722,667,611,778,722,278,556,722,611,833,722,778,667,778,722,667,611,722,667,944,667,667,611,333,278,333,584,556,333,556,611,556,611,556,333,611,611,278,278,556,278,889,611,611,611,611,389,556,333,611,556,778,556,556,500,389,280,389,584,333,556,556,556,556,280,556,333,737,370,556,584,737,552,400,549,333,333,333,576,556,278,333,333,365,556,834,834,834,611,722,722,722,722,722,722,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,556,556,556,556,556,278,278,278,278,611,611,611,611,611,611,611,549,611,611,611,611,611,556,611,556,722,556,722,556,722,556,722,556,722,556,722,556,722,556,722,719,722,611,667,556,667,556,667,556,667,556,667,556,778,611,778,611,778,611,778,611,722,611,722,611,278,278,278,278,278,278,278,278,278,278,785,556,556,278,722,556,556,611,278,611,278,611,385,611,479,611,278,722,611,722,611,722,611,708,723,611,778,611,778,611,778,611,1e3,944,722,389,722,389,722,389,667,556,667,556,667,556,667,556,611,333,611,479,611,333,722,611,722,611,722,611,722,611,722,611,722,611,944,778,667,556,667,611,500,611,500,611,500,278,556,722,556,1e3,889,778,611,667,556,611,333,333,333,333,333,333,333,333,333,333,333,465,722,333,853,906,474,825,927,838,278,722,722,601,719,667,611,722,778,278,722,667,833,722,644,778,722,667,600,611,667,821,667,809,802,278,667,615,451,611,278,582,615,610,556,606,475,460,611,541,278,558,556,612,556,445,611,766,619,520,684,446,582,715,576,753,845,278,582,611,582,845,667,669,885,567,711,667,278,276,556,1094,1062,875,610,722,622,719,722,719,722,567,712,667,904,626,719,719,610,702,833,722,778,719,667,722,611,622,854,667,730,703,1005,1019,870,979,719,711,1031,719,556,618,615,417,635,556,709,497,615,615,500,635,740,604,611,604,611,556,490,556,875,556,615,581,833,844,729,854,615,552,854,583,556,556,611,417,552,556,278,281,278,969,906,611,500,615,556,604,778,611,487,447,944,778,944,778,944,778,667,556,333,333,556,1e3,1e3,552,278,278,278,278,500,500,500,556,556,350,1e3,1e3,240,479,333,333,604,333,167,396,556,556,1094,556,885,489,1115,1e3,768,600,834,834,834,834,1e3,500,1e3,500,1e3,500,500,494,612,823,713,584,549,713,979,722,274,549,549,583,549,549,604,584,604,604,708,625,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,729,604,604,354,354,1e3,990,990,990,990,494,604,604,604,604,354,1021,1052,917,750,750,531,656,594,510,500,750,750,611,611,333,333,333,333,333,333,333,333,222,222,333,333,333,333,333,333,333,333],Em=[-1,-1,-1,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,161,162,163,164,165,166,167,168,169,170,171,172,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,402,506,507,508,509,510,511,536,537,538,539,710,711,713,728,729,730,731,732,733,900,901,902,903,904,905,906,908,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1138,1139,1168,1169,7808,7809,7810,7811,7812,7813,7922,7923,8208,8209,8211,8212,8213,8215,8216,8217,8218,8219,8220,8221,8222,8224,8225,8226,8230,8240,8242,8243,8249,8250,8252,8254,8260,8319,8355,8356,8359,8364,8453,8467,8470,8482,8486,8494,8539,8540,8541,8542,8592,8593,8594,8595,8596,8597,8616,8706,8710,8719,8721,8722,8730,8734,8735,8745,8747,8776,8800,8801,8804,8805,8962,8976,8992,8993,9472,9474,9484,9488,9492,9496,9500,9508,9516,9524,9532,9552,9553,9554,9555,9556,9557,9558,9559,9560,9561,9562,9563,9564,9565,9566,9567,9568,9569,9570,9571,9572,9573,9574,9575,9576,9577,9578,9579,9580,9600,9604,9608,9612,9616,9617,9618,9619,9632,9633,9642,9643,9644,9650,9658,9660,9668,9674,9675,9679,9688,9689,9702,9786,9787,9788,9792,9794,9824,9827,9829,9830,9834,9835,9836,61441,61442,61445,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],Tm=[365,0,333,278,333,474,556,556,889,722,238,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,333,333,584,584,584,611,975,722,722,722,722,667,611,778,722,278,556,722,611,833,722,778,667,778,722,667,611,722,667,944,667,667,611,333,278,333,584,556,333,556,611,556,611,556,333,611,611,278,278,556,278,889,611,611,611,611,389,556,333,611,556,778,556,556,500,389,280,389,584,333,556,556,556,556,280,556,333,737,370,556,584,737,552,400,549,333,333,333,576,556,278,333,333,365,556,834,834,834,611,722,722,722,722,722,722,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,556,556,556,556,556,278,278,278,278,611,611,611,611,611,611,611,549,611,611,611,611,611,556,611,556,722,556,722,556,722,556,722,556,722,556,722,556,722,556,722,740,722,611,667,556,667,556,667,556,667,556,667,556,778,611,778,611,778,611,778,611,722,611,722,611,278,278,278,278,278,278,278,278,278,278,782,556,556,278,722,556,556,611,278,611,278,611,396,611,479,611,278,722,611,722,611,722,611,708,723,611,778,611,778,611,778,611,1e3,944,722,389,722,389,722,389,667,556,667,556,667,556,667,556,611,333,611,479,611,333,722,611,722,611,722,611,722,611,722,611,722,611,944,778,667,556,667,611,500,611,500,611,500,278,556,722,556,1e3,889,778,611,667,556,611,333,333,333,333,333,333,333,333,333,333,333,333,722,333,854,906,473,844,930,847,278,722,722,610,671,667,611,722,778,278,722,667,833,722,657,778,718,667,590,611,667,822,667,829,781,278,667,620,479,611,278,591,620,621,556,610,479,492,611,558,278,566,556,603,556,450,611,712,605,532,664,409,591,704,578,773,834,278,591,611,591,834,667,667,886,614,719,667,278,278,556,1094,1042,854,622,719,677,719,722,708,722,614,722,667,927,643,719,719,615,687,833,722,778,719,667,722,611,677,781,667,729,708,979,989,854,1e3,708,719,1042,729,556,619,604,534,618,556,736,510,611,611,507,622,740,604,611,611,611,556,889,556,885,556,646,583,889,935,707,854,594,552,865,589,556,556,611,469,563,556,278,278,278,969,906,611,507,619,556,611,778,611,575,467,944,778,944,778,944,778,667,556,333,333,556,1e3,1e3,552,278,278,278,278,500,500,500,556,556,350,1e3,1e3,240,479,333,333,604,333,167,396,556,556,1104,556,885,516,1146,1e3,768,600,834,834,834,834,999,500,1e3,500,1e3,500,500,494,612,823,713,584,549,713,979,722,274,549,549,583,549,549,604,584,604,604,708,625,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,729,604,604,354,354,1e3,990,990,990,990,494,604,604,604,604,354,1021,1052,917,750,750,531,656,594,510,500,750,750,611,611,333,333,333,333,333,333,333,333,222,222,333,333,333,333,333,333,333,333],Rm=[-1,-1,-1,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,161,162,163,164,165,166,167,168,169,170,171,172,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,402,506,507,508,509,510,511,536,537,538,539,710,711,713,728,729,730,731,732,733,900,901,902,903,904,905,906,908,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1138,1139,1168,1169,7808,7809,7810,7811,7812,7813,7922,7923,8208,8209,8211,8212,8213,8215,8216,8217,8218,8219,8220,8221,8222,8224,8225,8226,8230,8240,8242,8243,8249,8250,8252,8254,8260,8319,8355,8356,8359,8364,8453,8467,8470,8482,8486,8494,8539,8540,8541,8542,8592,8593,8594,8595,8596,8597,8616,8706,8710,8719,8721,8722,8730,8734,8735,8745,8747,8776,8800,8801,8804,8805,8962,8976,8992,8993,9472,9474,9484,9488,9492,9496,9500,9508,9516,9524,9532,9552,9553,9554,9555,9556,9557,9558,9559,9560,9561,9562,9563,9564,9565,9566,9567,9568,9569,9570,9571,9572,9573,9574,9575,9576,9577,9578,9579,9580,9600,9604,9608,9612,9616,9617,9618,9619,9632,9633,9642,9643,9644,9650,9658,9660,9668,9674,9675,9679,9688,9689,9702,9786,9787,9788,9792,9794,9824,9827,9829,9830,9834,9835,9836,61441,61442,61445,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],Mm=[365,0,333,278,278,355,556,556,889,667,191,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,278,278,584,584,584,556,1015,667,667,722,722,667,611,778,722,278,500,667,556,833,722,778,667,778,722,667,611,722,667,944,667,667,611,278,278,278,469,556,333,556,556,500,556,556,278,556,556,222,222,500,222,833,556,556,556,556,333,500,278,556,500,722,500,500,500,334,260,334,584,333,556,556,556,556,260,556,333,737,370,556,584,737,552,400,549,333,333,333,576,537,278,333,333,365,556,834,834,834,611,667,667,667,667,667,667,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,500,556,556,556,556,278,278,278,278,556,556,556,556,556,556,556,549,611,556,556,556,556,500,556,500,667,556,667,556,667,556,722,500,722,500,722,500,722,500,722,625,722,556,667,556,667,556,667,556,667,556,667,556,778,556,778,556,778,556,778,556,722,556,722,556,278,278,278,278,278,278,278,222,278,278,733,444,500,222,667,500,500,556,222,556,222,556,281,556,400,556,222,722,556,722,556,722,556,615,723,556,778,556,778,556,778,556,1e3,944,722,333,722,333,722,333,667,500,667,500,667,500,667,500,611,278,611,354,611,278,722,556,722,556,722,556,722,556,722,556,722,556,944,722,667,500,667,611,500,611,500,611,500,222,556,667,556,1e3,889,778,611,667,500,611,278,333,333,333,333,333,333,333,333,333,333,333,667,278,789,846,389,794,865,775,222,667,667,570,671,667,611,722,778,278,667,667,833,722,648,778,725,667,600,611,667,837,667,831,761,278,667,570,439,555,222,550,570,571,500,556,439,463,555,542,222,500,492,548,500,447,556,670,573,486,603,374,550,652,546,728,779,222,550,556,550,779,667,667,843,544,708,667,278,278,500,1066,982,844,589,715,639,724,667,651,667,544,704,667,917,614,715,715,589,686,833,722,778,725,667,722,611,639,795,667,727,673,920,923,805,886,651,694,1022,682,556,562,522,493,553,556,688,465,556,556,472,564,686,550,556,556,556,500,833,500,835,500,572,518,830,851,621,736,526,492,752,534,556,556,556,378,496,500,222,222,222,910,828,556,472,565,500,556,778,556,492,339,944,722,944,722,944,722,667,500,333,333,556,1e3,1e3,552,222,222,222,222,333,333,333,556,556,350,1e3,1e3,188,354,333,333,500,333,167,365,556,556,1094,556,885,323,1083,1e3,768,600,834,834,834,834,1e3,500,998,500,1e3,500,500,494,612,823,713,584,549,713,979,719,274,549,549,584,549,549,604,584,604,604,708,625,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,729,604,604,354,354,1e3,990,990,990,990,494,604,604,604,604,354,1021,1052,917,750,750,531,656,594,510,500,750,750,500,500,333,333,333,333,333,333,333,333,222,222,294,294,324,324,316,328,398,285],Pm=[-1,-1,-1,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,161,162,163,164,165,166,167,168,169,170,171,172,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,402,506,507,508,509,510,511,536,537,538,539,710,711,713,728,729,730,731,732,733,900,901,902,903,904,905,906,908,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1138,1139,1168,1169,7808,7809,7810,7811,7812,7813,7922,7923,8208,8209,8211,8212,8213,8215,8216,8217,8218,8219,8220,8221,8222,8224,8225,8226,8230,8240,8242,8243,8249,8250,8252,8254,8260,8319,8355,8356,8359,8364,8453,8467,8470,8482,8486,8494,8539,8540,8541,8542,8592,8593,8594,8595,8596,8597,8616,8706,8710,8719,8721,8722,8730,8734,8735,8745,8747,8776,8800,8801,8804,8805,8962,8976,8992,8993,9472,9474,9484,9488,9492,9496,9500,9508,9516,9524,9532,9552,9553,9554,9555,9556,9557,9558,9559,9560,9561,9562,9563,9564,9565,9566,9567,9568,9569,9570,9571,9572,9573,9574,9575,9576,9577,9578,9579,9580,9600,9604,9608,9612,9616,9617,9618,9619,9632,9633,9642,9643,9644,9650,9658,9660,9668,9674,9675,9679,9688,9689,9702,9786,9787,9788,9792,9794,9824,9827,9829,9830,9834,9835,9836,61441,61442,61445,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],Nm=[365,0,333,278,278,355,556,556,889,667,191,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,278,278,584,584,584,556,1015,667,667,722,722,667,611,778,722,278,500,667,556,833,722,778,667,778,722,667,611,722,667,944,667,667,611,278,278,278,469,556,333,556,556,500,556,556,278,556,556,222,222,500,222,833,556,556,556,556,333,500,278,556,500,722,500,500,500,334,260,334,584,333,556,556,556,556,260,556,333,737,370,556,584,737,552,400,549,333,333,333,576,537,278,333,333,365,556,834,834,834,611,667,667,667,667,667,667,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,500,556,556,556,556,278,278,278,278,556,556,556,556,556,556,556,549,611,556,556,556,556,500,556,500,667,556,667,556,667,556,722,500,722,500,722,500,722,500,722,615,722,556,667,556,667,556,667,556,667,556,667,556,778,556,778,556,778,556,778,556,722,556,722,556,278,278,278,278,278,278,278,222,278,278,735,444,500,222,667,500,500,556,222,556,222,556,292,556,334,556,222,722,556,722,556,722,556,604,723,556,778,556,778,556,778,556,1e3,944,722,333,722,333,722,333,667,500,667,500,667,500,667,500,611,278,611,375,611,278,722,556,722,556,722,556,722,556,722,556,722,556,944,722,667,500,667,611,500,611,500,611,500,222,556,667,556,1e3,889,778,611,667,500,611,278,333,333,333,333,333,333,333,333,333,333,333,667,278,784,838,384,774,855,752,222,667,667,551,668,667,611,722,778,278,667,668,833,722,650,778,722,667,618,611,667,798,667,835,748,278,667,578,446,556,222,547,578,575,500,557,446,441,556,556,222,500,500,576,500,448,556,690,569,482,617,395,547,648,525,713,781,222,547,556,547,781,667,667,865,542,719,667,278,278,500,1057,1010,854,583,722,635,719,667,656,667,542,677,667,923,604,719,719,583,656,833,722,778,719,667,722,611,635,760,667,740,667,917,938,792,885,656,719,1010,722,556,573,531,365,583,556,669,458,559,559,438,583,688,552,556,542,556,500,458,500,823,500,573,521,802,823,625,719,521,510,750,542,556,556,556,365,510,500,222,278,222,906,812,556,438,559,500,552,778,556,489,411,944,722,944,722,944,722,667,500,333,333,556,1e3,1e3,552,222,222,222,222,333,333,333,556,556,350,1e3,1e3,188,354,333,333,500,333,167,365,556,556,1094,556,885,323,1073,1e3,768,600,834,834,834,834,1e3,500,1e3,500,1e3,500,500,494,612,823,713,584,549,713,979,719,274,549,549,583,549,549,604,584,604,604,708,625,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,708,729,604,604,354,354,1e3,990,990,990,990,494,604,604,604,604,354,1021,1052,917,750,750,531,656,594,510,500,750,750,500,500,333,333,333,333,333,333,333,333,222,222,294,294,324,324,316,328,398,285],Om=[-1,-1,-1,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,161,162,163,164,165,166,167,168,169,170,171,172,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,402,506,507,508,509,510,511,536,537,538,539,710,711,713,728,729,730,731,732,733,900,901,902,903,904,905,906,908,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1138,1139,1168,1169,7808,7809,7810,7811,7812,7813,7922,7923,8208,8209,8211,8212,8213,8215,8216,8217,8218,8219,8220,8221,8222,8224,8225,8226,8230,8240,8242,8243,8249,8250,8252,8254,8260,8319,8355,8356,8359,8364,8453,8467,8470,8482,8486,8494,8539,8540,8541,8542,8592,8593,8594,8595,8596,8597,8616,8706,8710,8719,8721,8722,8730,8734,8735,8745,8747,8776,8800,8801,8804,8805,8962,8976,8992,8993,9472,9474,9484,9488,9492,9496,9500,9508,9516,9524,9532,9552,9553,9554,9555,9556,9557,9558,9559,9560,9561,9562,9563,9564,9565,9566,9567,9568,9569,9570,9571,9572,9573,9574,9575,9576,9577,9578,9579,9580,9600,9604,9608,9612,9616,9617,9618,9619,9632,9633,9642,9643,9644,9650,9658,9660,9668,9674,9675,9679,9688,9689,9702,9786,9787,9788,9792,9794,9824,9827,9829,9830,9834,9835,9836,61441,61442,61445,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],wj=[1.36898,1,1,.72706,.80479,.83734,.98894,.99793,.9897,.93884,.86209,.94292,.94292,1.16661,1.02058,.93582,.96694,.93582,1.19137,.99793,.99793,.99793,.99793,.99793,.99793,.99793,.99793,.99793,.99793,.78076,.78076,1.02058,1.02058,1.02058,.72851,.78966,.90838,.83637,.82391,.96376,.80061,.86275,.8768,.95407,1.0258,.73901,.85022,.83655,1.0156,.95546,.92179,.87107,.92179,.82114,.8096,.89713,.94438,.95353,.94083,.91905,.90406,.9446,.94292,1.18777,.94292,1.02058,.89903,.90088,.94938,.97898,.81093,.97571,.94938,1.024,.9577,.95933,.98621,1.0474,.97455,.98981,.9672,.95933,.9446,.97898,.97407,.97646,.78036,1.10208,.95442,.95298,.97579,.9332,.94039,.938,.80687,1.01149,.80687,1.02058,.80479,.99793,.99793,.99793,.99793,1.01149,1.00872,.90088,.91882,1.0213,.8361,1.02058,.62295,.54324,.89022,1.08595,1,1,.90088,1,.97455,.93582,.90088,1,1.05686,.8361,.99642,.99642,.99642,.72851,.90838,.90838,.90838,.90838,.90838,.90838,.868,.82391,.80061,.80061,.80061,.80061,1.0258,1.0258,1.0258,1.0258,.97484,.95546,.92179,.92179,.92179,.92179,.92179,1.02058,.92179,.94438,.94438,.94438,.94438,.90406,.86958,.98225,.94938,.94938,.94938,.94938,.94938,.94938,.9031,.81093,.94938,.94938,.94938,.94938,.98621,.98621,.98621,.98621,.93969,.95933,.9446,.9446,.9446,.9446,.9446,1.08595,.9446,.95442,.95442,.95442,.95442,.94039,.97898,.94039,.90838,.94938,.90838,.94938,.90838,.94938,.82391,.81093,.82391,.81093,.82391,.81093,.82391,.81093,.96376,.84313,.97484,.97571,.80061,.94938,.80061,.94938,.80061,.94938,.80061,.94938,.80061,.94938,.8768,.9577,.8768,.9577,.8768,.9577,1,1,.95407,.95933,.97069,.95933,1.0258,.98621,1.0258,.98621,1.0258,.98621,1.0258,.98621,1.0258,.98621,.887,1.01591,.73901,1.0474,1,1,.97455,.83655,.98981,1,1,.83655,.73977,.83655,.73903,.84638,1.033,.95546,.95933,1,1,.95546,.95933,.8271,.95417,.95933,.92179,.9446,.92179,.9446,.92179,.9446,.936,.91964,.82114,.97646,1,1,.82114,.97646,.8096,.78036,.8096,.78036,1,1,.8096,.78036,1,1,.89713,.77452,.89713,1.10208,.94438,.95442,.94438,.95442,.94438,.95442,.94438,.95442,.94438,.95442,.94438,.95442,.94083,.97579,.90406,.94039,.90406,.9446,.938,.9446,.938,.9446,.938,1,.99793,.90838,.94938,.868,.9031,.92179,.9446,1,1,.89713,1.10208,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90989,.9358,.91945,.83181,.75261,.87992,.82976,.96034,.83689,.97268,1.0078,.90838,.83637,.8019,.90157,.80061,.9446,.95407,.92436,1.0258,.85022,.97153,1.0156,.95546,.89192,.92179,.92361,.87107,.96318,.89713,.93704,.95638,.91905,.91709,.92796,1.0258,.93704,.94836,1.0373,.95933,1.0078,.95871,.94836,.96174,.92601,.9498,.98607,.95776,.95933,1.05453,1.0078,.98275,.9314,.95617,.91701,1.05993,.9446,.78367,.9553,1,.86832,1.0128,.95871,.99394,.87548,.96361,.86774,1.0078,.95871,.9446,.95871,.86774,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.94083,.97579,.94083,.97579,.94083,.97579,.90406,.94039,.96694,1,.89903,1,1,1,.93582,.93582,.93582,1,.908,.908,.918,.94219,.94219,.96544,1,1.285,1,1,.81079,.81079,1,1,.74854,1,1,1,1,.99793,1,1,1,.65,1,1.36145,1,1,1,1,1,1,1,1,1,1,1,1.17173,1,.80535,.76169,1.02058,1.0732,1.05486,1,1,1.30692,1.08595,1.08595,1,1.08595,1.08595,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.16161,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],vj={lineHeight:1.2,lineGap:.2},_j=[1.36898,1,1,.66227,.80779,.81625,.97276,.97276,.97733,.92222,.83266,.94292,.94292,1.16148,1.02058,.93582,.96694,.93582,1.17337,.97276,.97276,.97276,.97276,.97276,.97276,.97276,.97276,.97276,.97276,.78076,.78076,1.02058,1.02058,1.02058,.71541,.76813,.85576,.80591,.80729,.94299,.77512,.83655,.86523,.92222,.98621,.71743,.81698,.79726,.98558,.92222,.90637,.83809,.90637,.80729,.76463,.86275,.90699,.91605,.9154,.85308,.85458,.90531,.94292,1.21296,.94292,1.02058,.89903,1.18616,.99613,.91677,.78216,.91677,.90083,.98796,.9135,.92168,.95381,.98981,.95298,.95381,.93459,.92168,.91513,.92004,.91677,.95077,.748,1.04502,.91677,.92061,.94236,.89544,.89364,.9,.80687,.8578,.80687,1.02058,.80779,.97276,.97276,.97276,.97276,.8578,.99973,1.18616,.91339,1.08074,.82891,1.02058,.55509,.71526,.89022,1.08595,1,1,1.18616,1,.96736,.93582,1.18616,1,1.04864,.82711,.99043,.99043,.99043,.71541,.85576,.85576,.85576,.85576,.85576,.85576,.845,.80729,.77512,.77512,.77512,.77512,.98621,.98621,.98621,.98621,.95961,.92222,.90637,.90637,.90637,.90637,.90637,1.02058,.90251,.90699,.90699,.90699,.90699,.85458,.83659,.94951,.99613,.99613,.99613,.99613,.99613,.99613,.85811,.78216,.90083,.90083,.90083,.90083,.95381,.95381,.95381,.95381,.9135,.92168,.91513,.91513,.91513,.91513,.91513,1.08595,.91677,.91677,.91677,.91677,.91677,.89364,.92332,.89364,.85576,.99613,.85576,.99613,.85576,.99613,.80729,.78216,.80729,.78216,.80729,.78216,.80729,.78216,.94299,.76783,.95961,.91677,.77512,.90083,.77512,.90083,.77512,.90083,.77512,.90083,.77512,.90083,.86523,.9135,.86523,.9135,.86523,.9135,1,1,.92222,.92168,.92222,.92168,.98621,.95381,.98621,.95381,.98621,.95381,.98621,.95381,.98621,.95381,.86036,.97096,.71743,.98981,1,1,.95298,.79726,.95381,1,1,.79726,.6894,.79726,.74321,.81691,1.0006,.92222,.92168,1,1,.92222,.92168,.79464,.92098,.92168,.90637,.91513,.90637,.91513,.90637,.91513,.909,.87514,.80729,.95077,1,1,.80729,.95077,.76463,.748,.76463,.748,1,1,.76463,.748,1,1,.86275,.72651,.86275,1.04502,.90699,.91677,.90699,.91677,.90699,.91677,.90699,.91677,.90699,.91677,.90699,.91677,.9154,.94236,.85458,.89364,.85458,.90531,.9,.90531,.9,.90531,.9,1,.97276,.85576,.99613,.845,.85811,.90251,.91677,1,1,.86275,1.04502,1.18616,1.18616,1.18616,1.18616,1.18616,1.18616,1.18616,1.18616,1.18616,1.00899,1.30628,.85576,.80178,.66862,.7927,.69323,.88127,.72459,.89711,.95381,.85576,.80591,.7805,.94729,.77512,.90531,.92222,.90637,.98621,.81698,.92655,.98558,.92222,.85359,.90637,.90976,.83809,.94523,.86275,.83509,.93157,.85308,.83392,.92346,.98621,.83509,.92886,.91324,.92168,.95381,.90646,.92886,.90557,.86847,.90276,.91324,.86842,.92168,.99531,.95381,.9224,.85408,.92699,.86847,1.0051,.91513,.80487,.93481,1,.88159,1.05214,.90646,.97355,.81539,.89398,.85923,.95381,.90646,.91513,.90646,.85923,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.9154,.94236,.9154,.94236,.9154,.94236,.85458,.89364,.96694,1,.89903,1,1,1,.91782,.91782,.91782,1,.896,.896,.896,.9332,.9332,.95973,1,1.26,1,1,.80479,.80178,1,1,.85633,1,1,1,1,.97276,1,1,1,.698,1,1.36145,1,1,1,1,1,1,1,1,1,1,1,1.14542,1,.79199,.78694,1.02058,1.03493,1.05486,1,1,1.23026,1.08595,1.08595,1,1.08595,1.08595,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.20006,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],kj={lineHeight:1.2,lineGap:.2},Cj=[1.36898,1,1,.65507,.84943,.85639,.88465,.88465,.86936,.88307,.86948,.85283,.85283,1.06383,1.02058,.75945,.9219,.75945,1.17337,.88465,.88465,.88465,.88465,.88465,.88465,.88465,.88465,.88465,.88465,.75945,.75945,1.02058,1.02058,1.02058,.69046,.70926,.85158,.77812,.76852,.89591,.70466,.76125,.80094,.86822,.83864,.728,.77212,.79475,.93637,.87514,.8588,.76013,.8588,.72421,.69866,.77598,.85991,.80811,.87832,.78112,.77512,.8562,1.0222,1.18417,1.0222,1.27014,.89903,1.15012,.93859,.94399,.846,.94399,.81453,1.0186,.94219,.96017,1.03075,1.02175,.912,1.03075,.96998,.96017,.93859,.94399,.94399,.95493,.746,1.12658,.94578,.91,.979,.882,.882,.83,.85034,.83537,.85034,1.02058,.70869,.88465,.88465,.88465,.88465,.83537,.90083,1.15012,.9161,.94565,.73541,1.02058,.53609,.69353,.79519,1.08595,1,1,1.15012,1,.91974,.75945,1.15012,1,.9446,.73361,.9005,.9005,.9005,.62864,.85158,.85158,.85158,.85158,.85158,.85158,.773,.76852,.70466,.70466,.70466,.70466,.83864,.83864,.83864,.83864,.90561,.87514,.8588,.8588,.8588,.8588,.8588,1.02058,.85751,.85991,.85991,.85991,.85991,.77512,.76013,.88075,.93859,.93859,.93859,.93859,.93859,.93859,.8075,.846,.81453,.81453,.81453,.81453,.82424,.82424,.82424,.82424,.9278,.96017,.93859,.93859,.93859,.93859,.93859,1.08595,.8562,.94578,.94578,.94578,.94578,.882,.94578,.882,.85158,.93859,.85158,.93859,.85158,.93859,.76852,.846,.76852,.846,.76852,.846,.76852,.846,.89591,.8544,.90561,.94399,.70466,.81453,.70466,.81453,.70466,.81453,.70466,.81453,.70466,.81453,.80094,.94219,.80094,.94219,.80094,.94219,1,1,.86822,.96017,.86822,.96017,.83864,.82424,.83864,.82424,.83864,.82424,.83864,1.03075,.83864,.82424,.81402,1.02738,.728,1.02175,1,1,.912,.79475,1.03075,1,1,.79475,.83911,.79475,.66266,.80553,1.06676,.87514,.96017,1,1,.87514,.96017,.86865,.87396,.96017,.8588,.93859,.8588,.93859,.8588,.93859,.867,.84759,.72421,.95493,1,1,.72421,.95493,.69866,.746,.69866,.746,1,1,.69866,.746,1,1,.77598,.88417,.77598,1.12658,.85991,.94578,.85991,.94578,.85991,.94578,.85991,.94578,.85991,.94578,.85991,.94578,.87832,.979,.77512,.882,.77512,.8562,.83,.8562,.83,.8562,.83,1,.88465,.85158,.93859,.773,.8075,.85751,.8562,1,1,.77598,1.12658,1.15012,1.15012,1.15012,1.15012,1.15012,1.15313,1.15012,1.15012,1.15012,1.08106,1.03901,.85158,.77025,.62264,.7646,.65351,.86026,.69461,.89947,1.03075,.85158,.77812,.76449,.88836,.70466,.8562,.86822,.8588,.83864,.77212,.85308,.93637,.87514,.82352,.8588,.85701,.76013,.89058,.77598,.8156,.82565,.78112,.77899,.89386,.83864,.8156,.9486,.92388,.96186,1.03075,.91123,.9486,.93298,.878,.93942,.92388,.84596,.96186,.95119,1.03075,.922,.88787,.95829,.88,.93559,.93859,.78815,.93758,1,.89217,1.03737,.91123,.93969,.77487,.85769,.86799,1.03075,.91123,.93859,.91123,.86799,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.87832,.979,.87832,.979,.87832,.979,.77512,.882,.9219,1,.89903,1,1,1,.87321,.87321,.87321,1,1.027,1.027,1.027,.86847,.86847,.79121,1,1.124,1,1,.73572,.73572,1,1,.85034,1,1,1,1,.88465,1,1,1,.669,1,1.36145,1,1,1,1,1,1,1,1,1,1,1,1.04828,1,.74948,.75187,1.02058,.98391,1.02119,1,1,1.06233,1.08595,1.08595,1,1.08595,1.08595,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.05233,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Aj={lineHeight:1.2,lineGap:.2},Sj=[1.36898,1,1,.76305,.82784,.94935,.89364,.92241,.89073,.90706,.98472,.85283,.85283,1.0664,1.02058,.74505,.9219,.74505,1.23456,.92241,.92241,.92241,.92241,.92241,.92241,.92241,.92241,.92241,.92241,.74505,.74505,1.02058,1.02058,1.02058,.73002,.72601,.91755,.8126,.80314,.92222,.73764,.79726,.83051,.90284,.86023,.74,.8126,.84869,.96518,.91115,.8858,.79761,.8858,.74498,.73914,.81363,.89591,.83659,.89633,.85608,.8111,.90531,1.0222,1.22736,1.0222,1.27014,.89903,.90088,.86667,1.0231,.896,1.01411,.90083,1.05099,1.00512,.99793,1.05326,1.09377,.938,1.06226,1.00119,.99793,.98714,1.0231,1.01231,.98196,.792,1.19137,.99074,.962,1.01915,.926,.942,.856,.85034,.92006,.85034,1.02058,.69067,.92241,.92241,.92241,.92241,.92006,.9332,.90088,.91882,.93484,.75339,1.02058,.56866,.54324,.79519,1.08595,1,1,.90088,1,.95325,.74505,.90088,1,.97198,.75339,.91009,.91009,.91009,.66466,.91755,.91755,.91755,.91755,.91755,.91755,.788,.80314,.73764,.73764,.73764,.73764,.86023,.86023,.86023,.86023,.92915,.91115,.8858,.8858,.8858,.8858,.8858,1.02058,.8858,.89591,.89591,.89591,.89591,.8111,.79611,.89713,.86667,.86667,.86667,.86667,.86667,.86667,.86936,.896,.90083,.90083,.90083,.90083,.84224,.84224,.84224,.84224,.97276,.99793,.98714,.98714,.98714,.98714,.98714,1.08595,.89876,.99074,.99074,.99074,.99074,.942,1.0231,.942,.91755,.86667,.91755,.86667,.91755,.86667,.80314,.896,.80314,.896,.80314,.896,.80314,.896,.92222,.93372,.92915,1.01411,.73764,.90083,.73764,.90083,.73764,.90083,.73764,.90083,.73764,.90083,.83051,1.00512,.83051,1.00512,.83051,1.00512,1,1,.90284,.99793,.90976,.99793,.86023,.84224,.86023,.84224,.86023,.84224,.86023,1.05326,.86023,.84224,.82873,1.07469,.74,1.09377,1,1,.938,.84869,1.06226,1,1,.84869,.83704,.84869,.81441,.85588,1.08927,.91115,.99793,1,1,.91115,.99793,.91887,.90991,.99793,.8858,.98714,.8858,.98714,.8858,.98714,.894,.91434,.74498,.98196,1,1,.74498,.98196,.73914,.792,.73914,.792,1,1,.73914,.792,1,1,.81363,.904,.81363,1.19137,.89591,.99074,.89591,.99074,.89591,.99074,.89591,.99074,.89591,.99074,.89591,.99074,.89633,1.01915,.8111,.942,.8111,.90531,.856,.90531,.856,.90531,.856,1,.92241,.91755,.86667,.788,.86936,.8858,.89876,1,1,.81363,1.19137,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90088,.90388,1.03901,.92138,.78105,.7154,.86169,.80513,.94007,.82528,.98612,1.06226,.91755,.8126,.81884,.92819,.73764,.90531,.90284,.8858,.86023,.8126,.91172,.96518,.91115,.83089,.8858,.87791,.79761,.89297,.81363,.88157,.89992,.85608,.81992,.94307,.86023,.88157,.95308,.98699,.99793,1.06226,.95817,.95308,.97358,.928,.98088,.98699,.92761,.99793,.96017,1.06226,.986,.944,.95978,.938,.96705,.98714,.80442,.98972,1,.89762,1.04552,.95817,.99007,.87064,.91879,.88888,1.06226,.95817,.98714,.95817,.88888,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.89633,1.01915,.89633,1.01915,.89633,1.01915,.8111,.942,.9219,1,.89903,1,1,1,.93173,.93173,.93173,1,1.06304,1.06304,1.06904,.89903,.89903,.80549,1,1.156,1,1,.76575,.76575,1,1,.72458,1,1,1,1,.92241,1,1,1,.619,1,1.36145,1,1,1,1,1,1,1,1,1,1,1,1.07257,1,.74705,.71119,1.02058,1.024,1.02119,1,1,1.1536,1.08595,1.08595,1,1.08595,1.08595,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.05638,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Ij={lineHeight:1.2,lineGap:.2},Ej=[1.76738,1,1,.99297,.9824,1.04016,1.06497,1.03424,.97529,1.17647,1.23203,1.1085,1.1085,1.16939,1.2107,.9754,1.21408,.9754,1.59578,1.03424,1.03424,1.03424,1.03424,1.03424,1.03424,1.03424,1.03424,1.03424,1.03424,.81378,.81378,1.2107,1.2107,1.2107,.71703,.97847,.97363,.88776,.8641,1.02096,.79795,.85132,.914,1.06085,1.1406,.8007,.89858,.83693,1.14889,1.09398,.97489,.92094,.97489,.90399,.84041,.95923,1.00135,1,1.06467,.98243,.90996,.99361,1.1085,1.56942,1.1085,1.2107,.74627,.94282,.96752,1.01519,.86304,1.01359,.97278,1.15103,1.01359,.98561,1.02285,1.02285,1.00527,1.02285,1.0302,.99041,1.0008,1.01519,1.01359,1.02258,.79104,1.16862,.99041,.97454,1.02511,.99298,.96752,.95801,.94856,1.16579,.94856,1.2107,.9824,1.03424,1.03424,1,1.03424,1.16579,.8727,1.3871,1.18622,1.10818,1.04478,1.2107,1.18622,.75155,.94994,1.28826,1.21408,1.21408,.91056,1,.91572,.9754,.64663,1.18328,1.24866,1.04478,1.14169,1.15749,1.17389,.71703,.97363,.97363,.97363,.97363,.97363,.97363,.93506,.8641,.79795,.79795,.79795,.79795,1.1406,1.1406,1.1406,1.1406,1.02096,1.09398,.97426,.97426,.97426,.97426,.97426,1.2107,.97489,1.00135,1.00135,1.00135,1.00135,.90996,.92094,1.02798,.96752,.96752,.96752,.96752,.96752,.96752,.93136,.86304,.97278,.97278,.97278,.97278,1.02285,1.02285,1.02285,1.02285,.97122,.99041,1,1,1,1,1,1.28826,1.0008,.99041,.99041,.99041,.99041,.96752,1.01519,.96752,.97363,.96752,.97363,.96752,.97363,.96752,.8641,.86304,.8641,.86304,.8641,.86304,.8641,.86304,1.02096,1.03057,1.02096,1.03517,.79795,.97278,.79795,.97278,.79795,.97278,.79795,.97278,.79795,.97278,.914,1.01359,.914,1.01359,.914,1.01359,1,1,1.06085,.98561,1.06085,1.00879,1.1406,1.02285,1.1406,1.02285,1.1406,1.02285,1.1406,1.02285,1.1406,1.02285,.97138,1.08692,.8007,1.02285,1,1,1.00527,.83693,1.02285,1,1,.83693,.9455,.83693,.90418,.83693,1.13005,1.09398,.99041,1,1,1.09398,.99041,.96692,1.09251,.99041,.97489,1.0008,.97489,1.0008,.97489,1.0008,.93994,.97931,.90399,1.02258,1,1,.90399,1.02258,.84041,.79104,.84041,.79104,.84041,.79104,.84041,.79104,1,1,.95923,1.07034,.95923,1.16862,1.00135,.99041,1.00135,.99041,1.00135,.99041,1.00135,.99041,1.00135,.99041,1.00135,.99041,1.06467,1.02511,.90996,.96752,.90996,.99361,.95801,.99361,.95801,.99361,.95801,1.07733,1.03424,.97363,.96752,.93506,.93136,.97489,1.0008,1,1,.95923,1.16862,1.15103,1.15103,1.01173,1.03959,.75953,.81378,.79912,1.15103,1.21994,.95161,.87815,1.01149,.81525,.7676,.98167,1.01134,1.02546,.84097,1.03089,1.18102,.97363,.88776,.85134,.97826,.79795,.99361,1.06085,.97489,1.1406,.89858,1.0388,1.14889,1.09398,.86039,.97489,1.0595,.92094,.94793,.95923,.90996,.99346,.98243,1.02112,.95493,1.1406,.90996,1.03574,1.02597,1.0008,1.18102,1.06628,1.03574,1.0192,1.01932,1.00886,.97531,1.0106,1.0008,1.13189,1.18102,1.02277,.98683,1.0016,.99561,1.07237,1.0008,.90434,.99921,.93803,.8965,1.23085,1.06628,1.04983,.96268,1.0499,.98439,1.18102,1.06628,1.0008,1.06628,.98439,.79795,1,1,1,1,1,1,1,1,1,1,1,1,1.09466,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.97278,1,1,1,1,1,1,1,1,1,1,1,1,1.02065,1,1,1,1,1,1,1.06467,1.02511,1.06467,1.02511,1.06467,1.02511,.90996,.96752,1,1.21408,.89903,1,1,.75155,1.04394,1.04394,1.04394,1.04394,.98633,.98633,.98633,.73047,.73047,1.20642,.91211,1.25635,1.222,1.02956,1.03372,1.03372,.96039,1.24633,1,1.12454,.93503,1.03424,1.19687,1.03424,1,1,1,.771,1,1,1.15749,1.15749,1.15749,1.10948,.86279,.94434,.86279,.94434,.86182,1,1,1.16897,1,.96085,.90137,1.2107,1.18416,1.13973,.69825,.9716,2.10339,1.29004,1.29004,1.21172,1.29004,1.29004,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.42603,1,.99862,.99862,1,.87025,.87025,.87025,.87025,1.18874,1.42603,1,1.42603,1.42603,.99862,1,1,1,1,1,1.2886,1.04315,1.15296,1.34163,1,1,1,1.09193,1.09193,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Tj={lineHeight:1.33008,lineGap:0},Rj=[1.76738,1,1,.98946,1.03959,1.04016,1.02809,1.036,.97639,1.10953,1.23203,1.11144,1.11144,1.16939,1.21237,.9754,1.21261,.9754,1.59754,1.036,1.036,1.036,1.036,1.036,1.036,1.036,1.036,1.036,1.036,.81378,.81378,1.21237,1.21237,1.21237,.73541,.97847,.97363,.89723,.87897,1.0426,.79429,.85292,.91149,1.05815,1.1406,.79631,.90128,.83853,1.04396,1.10615,.97552,.94436,.97552,.88641,.80527,.96083,1.00135,1,1.06777,.9817,.91142,.99361,1.11144,1.57293,1.11144,1.21237,.74627,1.31818,1.06585,.97042,.83055,.97042,.93503,1.1261,.97042,.97922,1.14236,.94552,1.01054,1.14236,1.02471,.97922,.94165,.97042,.97042,1.0276,.78929,1.1261,.97922,.95874,1.02197,.98507,.96752,.97168,.95107,1.16579,.95107,1.21237,1.03959,1.036,1.036,1,1.036,1.16579,.87357,1.31818,1.18754,1.26781,1.05356,1.21237,1.18622,.79487,.94994,1.29004,1.24047,1.24047,1.31818,1,.91484,.9754,1.31818,1.1349,1.24866,1.05356,1.13934,1.15574,1.17389,.73541,.97363,.97363,.97363,.97363,.97363,.97363,.94385,.87897,.79429,.79429,.79429,.79429,1.1406,1.1406,1.1406,1.1406,1.0426,1.10615,.97552,.97552,.97552,.97552,.97552,1.21237,.97552,1.00135,1.00135,1.00135,1.00135,.91142,.94436,.98721,1.06585,1.06585,1.06585,1.06585,1.06585,1.06585,.96705,.83055,.93503,.93503,.93503,.93503,1.14236,1.14236,1.14236,1.14236,.93125,.97922,.94165,.94165,.94165,.94165,.94165,1.29004,.94165,.97922,.97922,.97922,.97922,.96752,.97042,.96752,.97363,1.06585,.97363,1.06585,.97363,1.06585,.87897,.83055,.87897,.83055,.87897,.83055,.87897,.83055,1.0426,1.0033,1.0426,.97042,.79429,.93503,.79429,.93503,.79429,.93503,.79429,.93503,.79429,.93503,.91149,.97042,.91149,.97042,.91149,.97042,1,1,1.05815,.97922,1.05815,.97922,1.1406,1.14236,1.1406,1.14236,1.1406,1.14236,1.1406,1.14236,1.1406,1.14236,.97441,1.04302,.79631,1.01582,1,1,1.01054,.83853,1.14236,1,1,.83853,1.09125,.83853,.90418,.83853,1.19508,1.10615,.97922,1,1,1.10615,.97922,1.01034,1.10466,.97922,.97552,.94165,.97552,.94165,.97552,.94165,.91602,.91981,.88641,1.0276,1,1,.88641,1.0276,.80527,.78929,.80527,.78929,.80527,.78929,.80527,.78929,1,1,.96083,1.05403,.95923,1.16862,1.00135,.97922,1.00135,.97922,1.00135,.97922,1.00135,.97922,1.00135,.97922,1.00135,.97922,1.06777,1.02197,.91142,.96752,.91142,.99361,.97168,.99361,.97168,.99361,.97168,1.23199,1.036,.97363,1.06585,.94385,.96705,.97552,.94165,1,1,.96083,1.1261,1.31818,1.31818,1.31818,1.31818,1.31818,1.31818,1.31818,1.31818,1.31818,.95161,1.27126,1.00811,.83284,.77702,.99137,.95253,1.0347,.86142,1.07205,1.14236,.97363,.89723,.86869,1.09818,.79429,.99361,1.05815,.97552,1.1406,.90128,1.06662,1.04396,1.10615,.84918,.97552,1.04694,.94436,.98015,.96083,.91142,1.00356,.9817,1.01945,.98999,1.1406,.91142,1.04961,.9898,1.00639,1.14236,1.07514,1.04961,.99607,1.02897,1.008,.9898,.95134,1.00639,1.11121,1.14236,1.00518,.97981,1.02186,1,1.08578,.94165,.99314,.98387,.93028,.93377,1.35125,1.07514,1.10687,.93491,1.04232,1.00351,1.14236,1.07514,.94165,1.07514,1.00351,.79429,1,1,1,1,1,1,1,1,1,1,1,1,1.09097,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.93503,1,1,1,1,1,1,1,1,1,1,1,1,.96609,1,1,1,1,1,1,1.06777,1.02197,1.06777,1.02197,1.06777,1.02197,.91142,.96752,1,1.21261,.89903,1,1,.75155,1.04745,1.04745,1.04745,1.04394,.98633,.98633,.98633,.72959,.72959,1.20502,.91406,1.26514,1.222,1.02956,1.03372,1.03372,.96039,1.24633,1,1.09125,.93327,1.03336,1.16541,1.036,1,1,1,.771,1,1,1.15574,1.15574,1.15574,1.15574,.86364,.94434,.86279,.94434,.86224,1,1,1.16798,1,.96085,.90068,1.21237,1.18416,1.13904,.69825,.9716,2.10339,1.29004,1.29004,1.21339,1.29004,1.29004,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.42603,1,.99862,.99862,1,.87025,.87025,.87025,.87025,1.18775,1.42603,1,1.42603,1.42603,.99862,1,1,1,1,1,1.2886,1.04315,1.15296,1.34163,1,1,1,1.13269,1.13269,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Mj={lineHeight:1.33008,lineGap:0},Pj=[1.76738,1,1,.98946,1.14763,1.05365,1.06234,.96927,.92586,1.15373,1.18414,.91349,.91349,1.07403,1.17308,.78383,1.20088,.78383,1.42531,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.78383,.78383,1.17308,1.17308,1.17308,.77349,.94565,.94729,.85944,.88506,.9858,.74817,.80016,.88449,.98039,.95782,.69238,.89898,.83231,.98183,1.03989,.96924,.86237,.96924,.80595,.74524,.86091,.95402,.94143,.98448,.8858,.83089,.93285,1.0949,1.39016,1.0949,1.45994,.74627,1.04839,.97454,.97454,.87207,.97454,.87533,1.06151,.97454,1.00176,1.16484,1.08132,.98047,1.16484,1.02989,1.01054,.96225,.97454,.97454,1.06598,.79004,1.16344,1.00351,.94629,.9973,.91016,.96777,.9043,.91082,.92481,.91082,1.17308,.95748,.96927,.96927,1,.96927,.92481,.80597,1.04839,1.23393,1.1781,.9245,1.17308,1.20808,.63218,.94261,1.24822,1.09971,1.09971,1.04839,1,.85273,.78032,1.04839,1.09971,1.22326,.9245,1.09836,1.13525,1.15222,.70424,.94729,.94729,.94729,.94729,.94729,.94729,.85498,.88506,.74817,.74817,.74817,.74817,.95782,.95782,.95782,.95782,.9858,1.03989,.96924,.96924,.96924,.96924,.96924,1.17308,.96924,.95402,.95402,.95402,.95402,.83089,.86237,.88409,.97454,.97454,.97454,.97454,.97454,.97454,.92916,.87207,.87533,.87533,.87533,.87533,.93146,.93146,.93146,.93146,.93854,1.01054,.96225,.96225,.96225,.96225,.96225,1.24822,.8761,1.00351,1.00351,1.00351,1.00351,.96777,.97454,.96777,.94729,.97454,.94729,.97454,.94729,.97454,.88506,.87207,.88506,.87207,.88506,.87207,.88506,.87207,.9858,.95391,.9858,.97454,.74817,.87533,.74817,.87533,.74817,.87533,.74817,.87533,.74817,.87533,.88449,.97454,.88449,.97454,.88449,.97454,1,1,.98039,1.00176,.98039,1.00176,.95782,.93146,.95782,.93146,.95782,.93146,.95782,1.16484,.95782,.93146,.84421,1.12761,.69238,1.08132,1,1,.98047,.83231,1.16484,1,1,.84723,1.04861,.84723,.78755,.83231,1.23736,1.03989,1.01054,1,1,1.03989,1.01054,.9857,1.03849,1.01054,.96924,.96225,.96924,.96225,.96924,.96225,.92383,.90171,.80595,1.06598,1,1,.80595,1.06598,.74524,.79004,.74524,.79004,.74524,.79004,.74524,.79004,1,1,.86091,1.02759,.85771,1.16344,.95402,1.00351,.95402,1.00351,.95402,1.00351,.95402,1.00351,.95402,1.00351,.95402,1.00351,.98448,.9973,.83089,.96777,.83089,.93285,.9043,.93285,.9043,.93285,.9043,1.31868,.96927,.94729,.97454,.85498,.92916,.96924,.8761,1,1,.86091,1.16344,1.04839,1.04839,1.04839,1.04839,1.04839,1.04839,1.04839,1.04839,1.04839,.81965,.81965,.94729,.78032,.71022,.90883,.84171,.99877,.77596,1.05734,1.2,.94729,.85944,.82791,.9607,.74817,.93285,.98039,.96924,.95782,.89898,.98316,.98183,1.03989,.78614,.96924,.97642,.86237,.86075,.86091,.83089,.90082,.8858,.97296,1.01284,.95782,.83089,1.0976,1.04,1.03342,1.2,1.0675,1.0976,.98205,1.03809,1.05097,1.04,.95364,1.03342,1.05401,1.2,1.02148,1.0119,1.04724,1.0127,1.02732,.96225,.8965,.97783,.93574,.94818,1.30679,1.0675,1.11826,.99821,1.0557,1.0326,1.2,1.0675,.96225,1.0675,1.0326,.74817,1,1,1,1,1,1,1,1,1,1,1,1,1.03754,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.87533,1,1,1,1,1,1,1,1,1,1,1,1,.98705,1,1,1,1,1,1,.98448,.9973,.98448,.9973,.98448,.9973,.83089,.96777,1,1.20088,.89903,1,1,.75155,.94945,.94945,.94945,.94945,1.12317,1.12317,1.12317,.67603,.67603,1.15621,.73584,1.21191,1.22135,1.06483,.94868,.94868,.95996,1.24633,1,1.07497,.87709,.96927,1.01473,.96927,1,1,1,.77295,1,1,1.09836,1.09836,1.09836,1.01522,.86321,.94434,.8649,.94434,.86182,1,1,1.083,1,.91578,.86438,1.17308,1.18416,1.14589,.69825,.97622,1.96791,1.24822,1.24822,1.17308,1.24822,1.24822,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.42603,1,.99862,.99862,1,.87025,.87025,.87025,.87025,1.17984,1.42603,1,1.42603,1.42603,.99862,1,1,1,1,1,1.2886,1.04315,1.15296,1.34163,1,1,1,1.10742,1.10742,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Nj={lineHeight:1.33008,lineGap:0},Oj=[1.76738,1,1,.98594,1.02285,1.10454,1.06234,.96927,.92037,1.19985,1.2046,.90616,.90616,1.07152,1.1714,.78032,1.20088,.78032,1.40246,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.96927,.78032,.78032,1.1714,1.1714,1.1714,.80597,.94084,.96706,.85944,.85734,.97093,.75842,.79936,.88198,.9831,.95782,.71387,.86969,.84636,1.07796,1.03584,.96924,.83968,.96924,.82826,.79649,.85771,.95132,.93119,.98965,.88433,.8287,.93365,1.08612,1.3638,1.08612,1.45786,.74627,.80499,.91484,1.05707,.92383,1.05882,.9403,1.12654,1.05882,1.01756,1.09011,1.09011,.99414,1.09011,1.034,1.01756,1.05356,1.05707,1.05882,1.04399,.84863,1.21968,1.01756,.95801,1.00068,.91797,.96777,.9043,.90351,.92105,.90351,1.1714,.85337,.96927,.96927,.99912,.96927,.92105,.80597,1.2434,1.20808,1.05937,.90957,1.1714,1.20808,.75155,.94261,1.24644,1.09971,1.09971,.84751,1,.85273,.78032,.61584,1.05425,1.17914,.90957,1.08665,1.11593,1.14169,.73381,.96706,.96706,.96706,.96706,.96706,.96706,.86035,.85734,.75842,.75842,.75842,.75842,.95782,.95782,.95782,.95782,.97093,1.03584,.96924,.96924,.96924,.96924,.96924,1.1714,.96924,.95132,.95132,.95132,.95132,.8287,.83968,.89049,.91484,.91484,.91484,.91484,.91484,.91484,.93575,.92383,.9403,.9403,.9403,.9403,.8717,.8717,.8717,.8717,1.00527,1.01756,1.05356,1.05356,1.05356,1.05356,1.05356,1.24644,.95923,1.01756,1.01756,1.01756,1.01756,.96777,1.05707,.96777,.96706,.91484,.96706,.91484,.96706,.91484,.85734,.92383,.85734,.92383,.85734,.92383,.85734,.92383,.97093,1.0969,.97093,1.05882,.75842,.9403,.75842,.9403,.75842,.9403,.75842,.9403,.75842,.9403,.88198,1.05882,.88198,1.05882,.88198,1.05882,1,1,.9831,1.01756,.9831,1.01756,.95782,.8717,.95782,.8717,.95782,.8717,.95782,1.09011,.95782,.8717,.84784,1.11551,.71387,1.09011,1,1,.99414,.84636,1.09011,1,1,.84636,1.0536,.84636,.94298,.84636,1.23297,1.03584,1.01756,1,1,1.03584,1.01756,1.00323,1.03444,1.01756,.96924,1.05356,.96924,1.05356,.96924,1.05356,.93066,.98293,.82826,1.04399,1,1,.82826,1.04399,.79649,.84863,.79649,.84863,.79649,.84863,.79649,.84863,1,1,.85771,1.17318,.85771,1.21968,.95132,1.01756,.95132,1.01756,.95132,1.01756,.95132,1.01756,.95132,1.01756,.95132,1.01756,.98965,1.00068,.8287,.96777,.8287,.93365,.9043,.93365,.9043,.93365,.9043,1.08571,.96927,.96706,.91484,.86035,.93575,.96924,.95923,1,1,.85771,1.21968,1.11437,1.11437,.93109,.91202,.60411,.84164,.55572,1.01173,.97361,.81818,.81818,.96635,.78032,.72727,.92366,.98601,1.03405,.77968,1.09799,1.2,.96706,.85944,.85638,.96491,.75842,.93365,.9831,.96924,.95782,.86969,.94152,1.07796,1.03584,.78437,.96924,.98715,.83968,.83491,.85771,.8287,.94492,.88433,.9287,1.0098,.95782,.8287,1.0625,.98248,1.03424,1.2,1.01071,1.0625,.95246,1.03809,1.04912,.98248,1.00221,1.03424,1.05443,1.2,1.04785,.99609,1.00169,1.05176,.99346,1.05356,.9087,1.03004,.95542,.93117,1.23362,1.01071,1.07831,1.02512,1.05205,1.03502,1.2,1.01071,1.05356,1.01071,1.03502,.75842,1,1,1,1,1,1,1,1,1,1,1,1,1.03719,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.9403,1,1,1,1,1,1,1,1,1,1,1,1,1.04021,1,1,1,1,1,1,.98965,1.00068,.98965,1.00068,.98965,1.00068,.8287,.96777,1,1.20088,.89903,1,1,.75155,1.03077,1.03077,1.03077,1.03077,1.13196,1.13196,1.13196,.67428,.67428,1.16039,.73291,1.20996,1.22135,1.06483,.94868,.94868,.95996,1.24633,1,1.07497,.87796,.96927,1.01518,.96927,1,1,1,.77295,1,1,1.10539,1.10539,1.11358,1.06967,.86279,.94434,.86279,.94434,.86182,1,1,1.083,1,.91578,.86507,1.1714,1.18416,1.14589,.69825,.97622,1.9697,1.24822,1.24822,1.17238,1.24822,1.24822,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.42603,1,.99862,.99862,1,.87025,.87025,.87025,.87025,1.18083,1.42603,1,1.42603,1.42603,.99862,1,1,1,1,1,1.2886,1.04315,1.15296,1.34163,1,1,1,1.10938,1.10938,1,1,1,1.05425,1.09971,1.09971,1.09971,1,1,1,1,1,1,1,1,1,1,1],Dj={lineHeight:1.33008,lineGap:0},Lj=Ai(function(n){n["MyriadPro-Regular"]=n["PdfJS-Fallback-Regular"]={name:"LiberationSans-Regular",factors:Sj,baseWidths:Nm,baseMapping:Om,metrics:Ij},n["MyriadPro-Bold"]=n["PdfJS-Fallback-Bold"]={name:"LiberationSans-Bold",factors:wj,baseWidths:Im,baseMapping:Em,metrics:vj},n["MyriadPro-It"]=n["MyriadPro-Italic"]=n["PdfJS-Fallback-Italic"]={name:"LiberationSans-Italic",factors:Cj,baseWidths:Mm,baseMapping:Pm,metrics:Aj},n["MyriadPro-BoldIt"]=n["MyriadPro-BoldItalic"]=n["PdfJS-Fallback-BoldItalic"]={name:"LiberationSans-BoldItalic",factors:_j,baseWidths:Tm,baseMapping:Rm,metrics:kj},n.ArialMT=n.Arial=n["Arial-Regular"]={name:"LiberationSans-Regular",baseWidths:Nm,baseMapping:Om},n["Arial-BoldMT"]=n["Arial-Bold"]={name:"LiberationSans-Bold",baseWidths:Im,baseMapping:Em},n["Arial-ItalicMT"]=n["Arial-Italic"]={name:"LiberationSans-Italic",baseWidths:Mm,baseMapping:Pm},n["Arial-BoldItalicMT"]=n["Arial-BoldItalic"]={name:"LiberationSans-BoldItalic",baseWidths:Tm,baseMapping:Rm},n["Calibri-Regular"]={name:"LiberationSans-Regular",factors:hj,baseWidths:Nm,baseMapping:Om,metrics:uj},n["Calibri-Bold"]={name:"LiberationSans-Bold",factors:sj,baseWidths:Im,baseMapping:Em,metrics:rj},n["Calibri-Italic"]={name:"LiberationSans-Italic",factors:lj,baseWidths:Mm,baseMapping:Pm,metrics:cj},n["Calibri-BoldItalic"]={name:"LiberationSans-BoldItalic",factors:aj,baseWidths:Tm,baseMapping:Rm,metrics:oj},n["Segoeui-Regular"]={name:"LiberationSans-Regular",factors:Oj,baseWidths:Nm,baseMapping:Om,metrics:Dj},n["Segoeui-Bold"]={name:"LiberationSans-Bold",factors:Ej,baseWidths:Im,baseMapping:Em,metrics:Tj},n["Segoeui-Italic"]={name:"LiberationSans-Italic",factors:Pj,baseWidths:Mm,baseMapping:Pm,metrics:Nj},n["Segoeui-BoldItalic"]={name:"LiberationSans-BoldItalic",factors:Rj,baseWidths:Tm,baseMapping:Rm,metrics:Mj},n["Helvetica-Regular"]=n.Helvetica={name:"LiberationSans-Regular",factors:xj,baseWidths:Nm,baseMapping:Om,metrics:yj},n["Helvetica-Bold"]={name:"LiberationSans-Bold",factors:dj,baseWidths:Im,baseMapping:Em,metrics:fj},n["Helvetica-Italic"]={name:"LiberationSans-Italic",factors:pj,baseWidths:Mm,baseMapping:Pm,metrics:bj},n["Helvetica-BoldItalic"]={name:"LiberationSans-BoldItalic",factors:gj,baseWidths:Tm,baseMapping:Rm,metrics:mj}});function E4(n){const e=cx(n);return Lj()[e]}function Fj(n){const e=E4(n);if(!e)return null;const{baseWidths:t,baseMapping:i,factors:s}=e,r=s?t.map((c,h)=>c*s[h]):t;let a=-2,o;const l=[];for(const[c,h]of i.map((u,d)=>[u,d]).sort(([u],[d])=>u-d))c!==-1&&(c===a+1?(o.push(r[h]),a+=1):(a=c,o=[r[h]],l.push(c,o)));return l}function BR(n){const e=Fj(n),t=new fe(null);t.set("BaseFont",_e.get(n)),t.set("Type",_e.get("Font")),t.set("Subtype",_e.get("CIDFontType2")),t.set("Encoding",_e.get("Identity-H")),t.set("CIDToGIDMap",_e.get("Identity")),t.set("W",e),t.set("FirstChar",e[0]),t.set("LastChar",e.at(-2)+e.at(-1).length-1);const i=new fe(null);t.set("FontDescriptor",i);const s=new fe(null);return s.set("Ordering","Identity"),s.set("Registry","Adobe"),s.set("Supplement",0),t.set("CIDSystemInfo",s),t}class Bj{constructor(e){this.lexer=e,this.operators=[],this.token=null,this.prev=null}nextToken(){this.prev=this.token,this.token=this.lexer.getToken()}accept(e){return this.token.type===e?(this.nextToken(),!0):!1}expect(e){if(this.accept(e))return!0;throw new Ee(`Unexpected symbol: found ${this.token.type} expected ${e}.`)}parse(){return this.nextToken(),this.expect(_r.LBRACE),this.parseBlock(),this.expect(_r.RBRACE),this.operators}parseBlock(){for(;;)if(this.accept(_r.NUMBER))this.operators.push(this.prev.value);else if(this.accept(_r.OPERATOR))this.operators.push(this.prev.value);else if(this.accept(_r.LBRACE))this.parseCondition();else return}parseCondition(){const e=this.operators.length;if(this.operators.push(null,null),this.parseBlock(),this.expect(_r.RBRACE),this.accept(_r.IF))this.operators[e]=this.operators.length,this.operators[e+1]="jz";else if(this.accept(_r.LBRACE)){const t=this.operators.length;this.operators.push(null,null);const i=this.operators.length;this.parseBlock(),this.expect(_r.RBRACE),this.expect(_r.IFELSE),this.operators[t]=this.operators.length,this.operators[t+1]="j",this.operators[e]=i,this.operators[e+1]="jz"}else throw new Ee("PS Function: error parsing conditional.")}}const _r={LBRACE:0,RBRACE:1,NUMBER:2,OPERATOR:3,IF:4,IFELSE:5};class Ba{static get opCache(){return Ze(this,"opCache",Object.create(null))}constructor(e,t){this.type=e,this.value=t}static getOperator(e){var t;return(t=Ba.opCache)[e]||(t[e]=new Ba(_r.OPERATOR,e))}static get LBRACE(){return Ze(this,"LBRACE",new Ba(_r.LBRACE,"{"))}static get RBRACE(){return Ze(this,"RBRACE",new Ba(_r.RBRACE,"}"))}static get IF(){return Ze(this,"IF",new Ba(_r.IF,"IF"))}static get IFELSE(){return Ze(this,"IFELSE",new Ba(_r.IFELSE,"IFELSE"))}}class Uj{constructor(e){this.stream=e,this.nextChar(),this.strBuf=[]}nextChar(){return this.currentChar=this.stream.getByte()}getToken(){let e=!1,t=this.currentChar;for(;;){if(t<0)return Ls;if(e)(t===10||t===13)&&(e=!1);else if(t===37)e=!0;else if(!Va(t))break;t=this.nextChar()}switch(t|0){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 43:case 45:case 46:return new Ba(_r.NUMBER,this.getNumber());case 123:return this.nextChar(),Ba.LBRACE;case 125:return this.nextChar(),Ba.RBRACE}const i=this.strBuf;for(i.length=0,i[0]=String.fromCharCode(t);(t=this.nextChar())>=0&&(t>=65&&t<=90||t>=97&&t<=122);)i.push(String.fromCharCode(t));const s=i.join("");switch(s.toLowerCase()){case"if":return Ba.IF;case"ifelse":return Ba.IFELSE;default:return Ba.getOperator(s)}}getNumber(){let e=this.currentChar;const t=this.strBuf;for(t.length=0,t[0]=String.fromCharCode(e);(e=this.nextChar())>=0&&(e>=48&&e<=57||e===45||e===46);)t.push(String.fromCharCode(e));const i=parseFloat(t.join(""));if(isNaN(i))throw new Ee(`Invalid floating point number: ${i}`);return i}}class af{constructor(e){this._onlyRefs=(e==null?void 0:e.onlyRefs)===!0,this._onlyRefs||(this._nameRefMap=new Map,this._imageMap=new Map),this._imageCache=new la}getByName(e){this._onlyRefs&&kn("Should not call `getByName` method.");const t=this._nameRefMap.get(e);return t?this.getByRef(t):this._imageMap.get(e)||null}getByRef(e){return this._imageCache.get(e)||null}set(e,t,i){kn("Abstract method `set` called.")}}class Pk extends af{set(e,t=null,i){if(typeof e!="string")throw new Error('LocalImageCache.set - expected "name" argument.');if(t){if(this._imageCache.has(t))return;this._nameRefMap.set(e,t),this._imageCache.put(t,i);return}this._imageMap.has(e)||this._imageMap.set(e,i)}}class UR extends af{set(e=null,t=null,i){if(typeof e!="string"&&!t)throw new Error('LocalColorSpaceCache.set - expected "name" and/or "ref" argument.');if(t){if(this._imageCache.has(t))return;e!==null&&this._nameRefMap.set(e,t),this._imageCache.put(t,i);return}this._imageMap.has(e)||this._imageMap.set(e,i)}}class Hj extends af{constructor(e){super({onlyRefs:!0})}set(e=null,t,i){if(!t)throw new Error('LocalFunctionCache.set - expected "ref" argument.');this._imageCache.has(t)||this._imageCache.put(t,i)}}class Nk extends af{set(e,t=null,i){if(typeof e!="string")throw new Error('LocalGStateCache.set - expected "name" argument.');if(t){if(this._imageCache.has(t))return;this._nameRefMap.set(e,t),this._imageCache.put(t,i);return}this._imageMap.has(e)||this._imageMap.set(e,i)}}class zj extends af{constructor(e){super({onlyRefs:!0})}set(e=null,t,i){if(!t)throw new Error('LocalTilingPatternCache.set - expected "ref" argument.');this._imageCache.has(t)||this._imageCache.put(t,i)}}class jj extends af{constructor(e){super({onlyRefs:!0})}set(e=null,t,i){if(!t)throw new Error('RegionalImageCache.set - expected "ref" argument.');this._imageCache.has(t)||this._imageCache.put(t,i)}}class Gj extends af{constructor(e){super({onlyRefs:!0})}set(e=null,t,i){if(!t)throw new Error('GlobalColorSpaceCache.set - expected "ref" argument.');this._imageCache.has(t)||this._imageCache.put(t,i)}clear(){this._imageCache.clear()}}var bg,nf,HR,Y7;const xc=class xc{constructor(){B(this,nf);B(this,bg,new Ji);this._refCache=new la,this._imageCache=new la}shouldCache(e,t){let i=this._refCache.get(e);return i||(i=new Set,this._refCache.put(e,i)),i.add(t),!(i.size<xc.NUM_PAGES_THRESHOLD||!this._imageCache.has(e)&&b(this,nf,Y7))}addDecodeFailed(e){b(this,bg).put(e)}hasDecodeFailed(e){return b(this,bg).has(e)}addByteSize(e,t){const i=this._imageCache.get(e);i&&(i.byteSize||(i.byteSize=t))}getData(e,t){const i=this._refCache.get(e);if(!i||i.size<xc.NUM_PAGES_THRESHOLD)return null;const s=this._imageCache.get(e);return s?(i.add(t),s):null}setData(e,t){if(!this._refCache.has(e))throw new Error('GlobalImageCache.setData - expected "shouldCache" to have been called.');if(!this._imageCache.has(e)){if(b(this,nf,Y7)){he("GlobalImageCache.setData - cache limit reached.");return}this._imageCache.put(e,t)}}clear(e=!1){e||(b(this,bg).clear(),this._refCache.clear()),this._imageCache.clear()}};bg=new WeakMap,nf=new WeakSet,HR=function(){let e=0;for(const t of this._imageCache)e+=t.byteSize;return e},Y7=function(){return!(this._imageCache.size<xc.MIN_IMAGES_TO_CACHE||b(this,nf,HR)<xc.MAX_BYTE_SIZE)},ze(xc,"NUM_PAGES_THRESHOLD",2),ze(xc,"MIN_IMAGES_TO_CACHE",10),ze(xc,"MAX_BYTE_SIZE",5e7);let X7=xc;class zR{constructor({xref:e,isEvalSupported:t=!0}){this.xref=e,this.isEvalSupported=t!==!1}create(e,t=!1){var a;let i,s;if(e instanceof st?i=e:e instanceof fe?i=e.objId:e instanceof hn&&(i=(a=e.dict)==null?void 0:a.objId),i){const o=this._localFunctionCache.getByRef(i);if(o)return o}const r=this.xref.fetchIfRef(e);if(Array.isArray(r)){if(!t)throw new Error('PDFFunctionFactory.create - expected "parseArray" argument.');s=Ok.parseArray(this,r)}else s=Ok.parse(this,r);return i&&this._localFunctionCache.set(null,i,s),s}get _localFunctionCache(){return Ze(this,"_localFunctionCache",new Hj)}}function Ja(n){return Array.isArray(n)?Gr(n,null)?n:n.map(e=>+e):null}class Ok{static getSampleArray(e,t,i,s){let r,a,o=1;for(r=0,a=e.length;r<a;r++)o*=e[r];o*=t;const l=new Array(o);let c=0,h=0;const u=1/(2**i-1),d=s.getBytes((o*i+7)/8);let f=0;for(r=0;r<o;r++){for(;c<i;)h<<=8,h|=d[f++],c+=8;c-=i,l[r]=(h>>c)*u,h&=(1<<c)-1}return l}static parse(e,t){const i=t.dict||t;switch(i.get("FunctionType")){case 0:return this.constructSampled(e,t,i);case 1:break;case 2:return this.constructInterpolated(e,i);case 3:return this.constructStiched(e,i);case 4:return this.constructPostScript(e,t,i)}throw new Ee("Unknown type of function")}static parseArray(e,t){const{xref:i}=e,s=[];for(const r of t)s.push(this.parse(e,i.fetchIfRef(r)));return function(r,a,o,l){for(let c=0,h=s.length;c<h;c++)s[c](r,a,o,l+c)}}static constructSampled(e,t,i){function s(x){const p=x.length,y=[];let w=0;for(let v=0;v<p;v+=2)y[w++]=[x[v],x[v+1]];return y}function r(x,p,y,w,v){return w+(x-p)*((v-w)/(y-p))}let a=Ja(i.getArray("Domain")),o=Ja(i.getArray("Range"));if(!a||!o)throw new Ee("No domain or range");const l=a.length/2,c=o.length/2;a=s(a),o=s(o);const h=Ja(i.getArray("Size")),u=i.get("BitsPerSample"),d=i.get("Order")||1;d!==1&&gn("No support for cubic spline interpolation: "+d);let f=Ja(i.getArray("Encode"));if(f)f=s(f);else{f=[];for(let x=0;x<l;++x)f.push([0,h[x]-1])}let g=Ja(i.getArray("Decode"));g=g?s(g):o;const m=this.getSampleArray(h,c,u,t);return function(p,y,w,v){const _=1<<l,C=new Float64Array(_).fill(1),k=new Uint32Array(_);let I,S,R=c,P=1;for(I=0;I<l;++I){const D=a[I][0],U=a[I][1],T=Us(p[y+I],D,U);let G=r(T,D,U,f[I][0],f[I][1]);const M=h[I];G=Us(G,0,M-1);const F=G<M-1?Math.floor(G):G-1,X=F+1-G,z=G-F,K=F*R,j=K+R;for(S=0;S<_;S++)S&P?(C[S]*=z,k[S]+=j):(C[S]*=X,k[S]+=K);R*=M,P<<=1}for(S=0;S<c;++S){let D=0;for(I=0;I<_;I++)D+=m[k[I]+S]*C[I];D=r(D,0,1,g[S][0],g[S][1]),w[v+S]=Us(D,o[S][0],o[S][1])}}}static constructInterpolated(e,t){const i=Ja(t.getArray("C0"))||[0],s=Ja(t.getArray("C1"))||[1],r=t.get("N"),a=[];for(let l=0,c=i.length;l<c;++l)a.push(s[l]-i[l]);const o=a.length;return function(c,h,u,d){const f=r===1?c[h]:c[h]**r;for(let g=0;g<o;++g)u[d+g]=i[g]+f*a[g]}}static constructStiched(e,t){const i=Ja(t.getArray("Domain"));if(!i)throw new Ee("No domain");if(i.length/2!==1)throw new Ee("Bad domain for stiched function");const{xref:r}=e,a=[];for(const h of t.get("Functions"))a.push(this.parse(e,r.fetchIfRef(h)));const o=Ja(t.getArray("Bounds")),l=Ja(t.getArray("Encode")),c=new Float32Array(1);return function(u,d,f,g){const m=Us(u[d],i[0],i[1]),x=o.length;let p;for(p=0;p<x&&!(m<o[p]);++p);let y=i[0];p>0&&(y=o[p-1]);let w=i[1];p<o.length&&(w=o[p]);const v=l[2*p],_=l[2*p+1];c[0]=y===w?v:v+(m-y)*(_-v)/(w-y),a[p](c,0,f,g)}}static constructPostScript(e,t,i){const s=Ja(i.getArray("Domain")),r=Ja(i.getArray("Range"));if(!s)throw new Ee("No domain.");if(!r)throw new Ee("No range.");const a=new Uj(t),l=new Bj(a).parse();if(e.isEvalSupported&&da.isEvalSupported){const x=new Zj().compile(l,s,r);if(x)return new Function("src","srcOffset","dest","destOffset",x)}gn("Unable to compile PS function");const c=r.length>>1,h=s.length>>1,u=new Vj(l),d=Object.create(null);let g=2048*4;const m=new Float32Array(h);return function(p,y,w,v){let _,C,k="";const I=m;for(_=0;_<h;_++)C=p[y+_],I[_]=C,k+=C+"_";const S=d[k];if(S!==void 0){w.set(S,v);return}const R=new Float32Array(c),P=u.execute(I),D=P.length-c;for(_=0;_<c;_++){C=P[D+_];let U=r[_*2];C<U?C=U:(U=r[_*2+1],C>U&&(C=U)),R[_]=C}g>0&&(g--,d[k]=R),w.set(R,v)}}}function Aw(n){let e;if(n instanceof fe)e=n;else if(n instanceof hn)e=n.dict;else return!1;return e.has("FunctionType")}const Sp=class Sp{constructor(e){this.stack=e?Array.from(e):[]}push(e){if(this.stack.length>=Sp.MAX_STACK_SIZE)throw new Error("PostScript function stack overflow.");this.stack.push(e)}pop(){if(this.stack.length<=0)throw new Error("PostScript function stack underflow.");return this.stack.pop()}copy(e){if(this.stack.length+e>=Sp.MAX_STACK_SIZE)throw new Error("PostScript function stack overflow.");const t=this.stack;for(let i=t.length-e,s=e-1;s>=0;s--,i++)t.push(t[i])}index(e){this.push(this.stack[this.stack.length-e-1])}roll(e,t){const i=this.stack,s=i.length-e,r=i.length-1,a=s+(t-Math.floor(t/e)*e);for(let o=s,l=r;o<l;o++,l--){const c=i[o];i[o]=i[l],i[l]=c}for(let o=s,l=a-1;o<l;o++,l--){const c=i[o];i[o]=i[l],i[l]=c}for(let o=a,l=r;o<l;o++,l--){const c=i[o];i[o]=i[l],i[l]=c}}};ze(Sp,"MAX_STACK_SIZE",100);let J7=Sp;class Vj{constructor(e){this.operators=e}execute(e){const t=new J7(e);let i=0;const s=this.operators,r=s.length;let a,o,l;for(;i<r;){if(a=s[i++],typeof a=="number"){t.push(a);continue}switch(a){case"jz":l=t.pop(),o=t.pop(),o||(i=l);break;case"j":o=t.pop(),i=o;break;case"abs":o=t.pop(),t.push(Math.abs(o));break;case"add":l=t.pop(),o=t.pop(),t.push(o+l);break;case"and":l=t.pop(),o=t.pop(),typeof o=="boolean"&&typeof l=="boolean"?t.push(o&&l):t.push(o&l);break;case"atan":l=t.pop(),o=t.pop(),o=Math.atan2(o,l)/Math.PI*180,o<0&&(o+=360),t.push(o);break;case"bitshift":l=t.pop(),o=t.pop(),o>0?t.push(o<<l):t.push(o>>l);break;case"ceiling":o=t.pop(),t.push(Math.ceil(o));break;case"copy":o=t.pop(),t.copy(o);break;case"cos":o=t.pop(),t.push(Math.cos(o%360/180*Math.PI));break;case"cvi":o=t.pop()|0,t.push(o);break;case"cvr":break;case"div":l=t.pop(),o=t.pop(),t.push(o/l);break;case"dup":t.copy(1);break;case"eq":l=t.pop(),o=t.pop(),t.push(o===l);break;case"exch":t.roll(2,1);break;case"exp":l=t.pop(),o=t.pop(),t.push(o**l);break;case"false":t.push(!1);break;case"floor":o=t.pop(),t.push(Math.floor(o));break;case"ge":l=t.pop(),o=t.pop(),t.push(o>=l);break;case"gt":l=t.pop(),o=t.pop(),t.push(o>l);break;case"idiv":l=t.pop(),o=t.pop(),t.push(o/l|0);break;case"index":o=t.pop(),t.index(o);break;case"le":l=t.pop(),o=t.pop(),t.push(o<=l);break;case"ln":o=t.pop(),t.push(Math.log(o));break;case"log":o=t.pop(),t.push(Math.log10(o));break;case"lt":l=t.pop(),o=t.pop(),t.push(o<l);break;case"mod":l=t.pop(),o=t.pop(),t.push(o%l);break;case"mul":l=t.pop(),o=t.pop(),t.push(o*l);break;case"ne":l=t.pop(),o=t.pop(),t.push(o!==l);break;case"neg":o=t.pop(),t.push(-o);break;case"not":o=t.pop(),typeof o=="boolean"?t.push(!o):t.push(~o);break;case"or":l=t.pop(),o=t.pop(),typeof o=="boolean"&&typeof l=="boolean"?t.push(o||l):t.push(o|l);break;case"pop":t.pop();break;case"roll":l=t.pop(),o=t.pop(),t.roll(o,l);break;case"round":o=t.pop(),t.push(Math.round(o));break;case"sin":o=t.pop(),t.push(Math.sin(o%360/180*Math.PI));break;case"sqrt":o=t.pop(),t.push(Math.sqrt(o));break;case"sub":l=t.pop(),o=t.pop(),t.push(o-l);break;case"true":t.push(!0);break;case"truncate":o=t.pop(),o=o<0?Math.ceil(o):Math.floor(o),t.push(o);break;case"xor":l=t.pop(),o=t.pop(),typeof o=="boolean"&&typeof l=="boolean"?t.push(o!==l):t.push(o^l);break;default:throw new Ee(`Unknown operator ${a}`)}}return t.stack}}class Wg{constructor(e){this.type=e}visit(e){kn("abstract method")}}class qj extends Wg{constructor(e,t,i){super("args"),this.index=e,this.min=t,this.max=i}visit(e){e.visitArgument(this)}}class Ld extends Wg{constructor(e){super("literal"),this.number=e,this.min=e,this.max=e}visit(e){e.visitLiteral(this)}}class T4 extends Wg{constructor(e,t,i,s,r){super("binary"),this.op=e,this.arg1=t,this.arg2=i,this.min=s,this.max=r}visit(e){e.visitBinaryOperation(this)}}class Wj extends Wg{constructor(e,t){super("max"),this.arg=e,this.min=e.min,this.max=t}visit(e){e.visitMin(this)}}class Dk extends Wg{constructor(e,t,i){super("var"),this.index=e,this.min=t,this.max=i}visit(e){e.visitVariable(this)}}class Lk extends Wg{constructor(e,t){super("definition"),this.variable=e,this.arg=t}visit(e){e.visitVariableDefinition(this)}}class Fk{constructor(){this.parts=[]}visitArgument(e){this.parts.push("Math.max(",e.min,", Math.min(",e.max,", src[srcOffset + ",e.index,"]))")}visitVariable(e){this.parts.push("v",e.index)}visitLiteral(e){this.parts.push(e.number)}visitBinaryOperation(e){this.parts.push("("),e.arg1.visit(this),this.parts.push(" ",e.op," "),e.arg2.visit(this),this.parts.push(")")}visitVariableDefinition(e){this.parts.push("var "),e.variable.visit(this),this.parts.push(" = "),e.arg.visit(this),this.parts.push(";")}visitMin(e){this.parts.push("Math.min("),e.arg.visit(this),this.parts.push(", ",e.max,")")}toString(){return this.parts.join("")}}function Kj(n,e){return e.type==="literal"&&e.number===0?n:n.type==="literal"&&n.number===0?e:e.type==="literal"&&n.type==="literal"?new Ld(n.number+e.number):new T4("+",n,e,n.min+e.min,n.max+e.max)}function Xj(n,e){if(e.type==="literal"){if(e.number===0)return new Ld(0);if(e.number===1)return n;if(n.type==="literal")return new Ld(n.number*e.number)}if(n.type==="literal"){if(n.number===0)return new Ld(0);if(n.number===1)return e}const t=Math.min(n.min*e.min,n.min*e.max,n.max*e.min,n.max*e.max),i=Math.max(n.min*e.min,n.min*e.max,n.max*e.min,n.max*e.max);return new T4("*",n,e,t,i)}function Yj(n,e){if(e.type==="literal"){if(e.number===0)return n;if(n.type==="literal")return new Ld(n.number-e.number)}return e.type==="binary"&&e.op==="-"&&n.type==="literal"&&n.number===1&&e.arg1.type==="literal"&&e.arg1.number===1?e.arg2:new T4("-",n,e,n.min-e.max,n.max-e.min)}function Jj(n,e){return n.min>=e?new Ld(e):n.max<=e?n:new Wj(n,e)}class Zj{compile(e,t,i){const s=[],r=[],a=t.length>>1,o=i.length>>1;let l=0,c,h,u,d,f,g,m,x;for(let y=0;y<a;y++)s.push(new qj(y,t[y*2],t[y*2+1]));for(let y=0,w=e.length;y<w;y++){if(x=e[y],typeof x=="number"){s.push(new Ld(x));continue}switch(x){case"add":if(s.length<2)return null;d=s.pop(),u=s.pop(),s.push(Kj(u,d));break;case"cvr":if(s.length<1)return null;break;case"mul":if(s.length<2)return null;d=s.pop(),u=s.pop(),s.push(Xj(u,d));break;case"sub":if(s.length<2)return null;d=s.pop(),u=s.pop(),s.push(Yj(u,d));break;case"exch":if(s.length<2)return null;f=s.pop(),g=s.pop(),s.push(f,g);break;case"pop":if(s.length<1)return null;s.pop();break;case"index":if(s.length<1||(u=s.pop(),u.type!=="literal")||(c=u.number,c<0||!Number.isInteger(c)||s.length<c))return null;if(f=s[s.length-c-1],f.type==="literal"||f.type==="var"){s.push(f);break}m=new Dk(l++,f.min,f.max),s[s.length-c-1]=m,s.push(m),r.push(new Lk(m,f));break;case"dup":if(s.length<1)return null;if(typeof e[y+1]=="number"&&e[y+2]==="gt"&&e[y+3]===y+7&&e[y+4]==="jz"&&e[y+5]==="pop"&&e[y+6]===e[y+1]){u=s.pop(),s.push(Jj(u,e[y+1])),y+=6;break}if(f=s.at(-1),f.type==="literal"||f.type==="var"){s.push(f);break}m=new Dk(l++,f.min,f.max),s[s.length-1]=m,s.push(m),r.push(new Lk(m,f));break;case"roll":if(s.length<2||(d=s.pop(),u=s.pop(),d.type!=="literal"||u.type!=="literal")||(h=d.number,c=u.number,c<=0||!Number.isInteger(c)||!Number.isInteger(h)||s.length<c))return null;if(h=(h%c+c)%c,h===0)break;s.push(...s.splice(s.length-c,c-h));break;default:return null}}if(s.length!==o)return null;const p=[];for(const y of r){const w=new Fk;y.visit(w),p.push(w.toString())}for(let y=0,w=s.length;y<w;y++){const v=s[y],_=new Fk;v.visit(_);const C=i[y*2],k=i[y*2+1],I=[_.toString()];C>v.min&&(I.unshift("Math.max(",C,", "),I.push(")")),k<v.max&&(I.unshift("Math.min(",k,", "),I.push(")")),I.unshift("dest[destOffset + ",y,"] = "),I.push(";"),p.push(I.join(""))}return p.join(`
`)}}const Qj=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","ON","ON","ET","ET","ET","ON","ON","ON","ON","ON","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","ON","ON","ON","ON","ON","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","ON","ON","ON","ON","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","ON","ON","ON","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","ON","ET","ET","ET","ET","ON","ON","ON","ON","L","ON","ON","BN","ON","ON","ET","ET","EN","EN","ON","L","ON","ON","ON","EN","L","ON","ON","ON","ON","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","L","L","L","L","L","L","L","L"],$j=["AN","AN","AN","AN","AN","AN","ON","ON","AL","ET","ET","AL","CS","AL","ON","ON","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","ON","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","ON","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL"];function Bk(n){return(n&1)!==0}function eG(n){return(n&1)===0}function tG(n,e,t){let i,s;for(i=e,s=n.length;i<s;++i)if(n[i]!==t)return i;return i}function Uk(n,e,t){for(let i=e,s=t-1;i<s;++i,--s){const r=n[i];n[i]=n[s],n[s]=r}}function Sw(n,e,t=!1){let i="ltr";return t?i="ttb":e||(i="rtl"),{str:n,dir:i}}const _0=[],Ln=[];function jR(n,e=-1,t=!1){let i=!0;const s=n.length;if(s===0||t)return Sw(n,i,t);_0.length=s,Ln.length=s;let r=0,a,o;for(a=0;a<s;++a){_0[a]=n.charAt(a);const p=n.charCodeAt(a);let y="L";p<=255?y=Qj[p]:1424<=p&&p<=1524?y="R":1536<=p&&p<=1791?(y=$j[p&255],y||he("Bidi: invalid Unicode character "+p.toString(16))):(1792<=p&&p<=2220||64336<=p&&p<=65023||65136<=p&&p<=65279)&&(y="AL"),(y==="R"||y==="AL"||y==="AN")&&r++,Ln[a]=y}if(r===0)return i=!0,Sw(n,i);e===-1&&(r/s<.3&&s>4?(i=!0,e=0):(i=!1,e=1));const l=[];for(a=0;a<s;++a)l[a]=e;const c=Bk(e)?"R":"L",h=c,u=h;let d=h;for(a=0;a<s;++a)Ln[a]==="NSM"?Ln[a]=d:d=Ln[a];d=h;let f;for(a=0;a<s;++a)f=Ln[a],f==="EN"?Ln[a]=d==="AL"?"AN":"EN":(f==="R"||f==="L"||f==="AL")&&(d=f);for(a=0;a<s;++a)f=Ln[a],f==="AL"&&(Ln[a]="R");for(a=1;a<s-1;++a)Ln[a]==="ES"&&Ln[a-1]==="EN"&&Ln[a+1]==="EN"&&(Ln[a]="EN"),Ln[a]==="CS"&&(Ln[a-1]==="EN"||Ln[a-1]==="AN")&&Ln[a+1]===Ln[a-1]&&(Ln[a]=Ln[a-1]);for(a=0;a<s;++a)if(Ln[a]==="EN"){for(let p=a-1;p>=0&&Ln[p]==="ET";--p)Ln[p]="EN";for(let p=a+1;p<s&&Ln[p]==="ET";++p)Ln[p]="EN"}for(a=0;a<s;++a)f=Ln[a],(f==="WS"||f==="ES"||f==="ET"||f==="CS")&&(Ln[a]="ON");for(d=h,a=0;a<s;++a)f=Ln[a],f==="EN"?Ln[a]=d==="L"?"L":"EN":(f==="R"||f==="L")&&(d=f);for(a=0;a<s;++a)if(Ln[a]==="ON"){const p=tG(Ln,a+1,"ON");let y=h;a>0&&(y=Ln[a-1]);let w=u;p+1<s&&(w=Ln[p+1]),y!=="L"&&(y="R"),w!=="L"&&(w="R"),y===w&&Ln.fill(y,a,p),a=p-1}for(a=0;a<s;++a)Ln[a]==="ON"&&(Ln[a]=c);for(a=0;a<s;++a)f=Ln[a],eG(l[a])?f==="R"?l[a]+=1:(f==="AN"||f==="EN")&&(l[a]+=2):(f==="L"||f==="AN"||f==="EN")&&(l[a]+=1);let g=-1,m=99,x;for(a=0,o=l.length;a<o;++a)x=l[a],g<x&&(g=x),m>x&&Bk(x)&&(m=x);for(x=g;x>=m;--x){let p=-1;for(a=0,o=l.length;a<o;++a)l[a]<x?p>=0&&(Uk(_0,p,a),p=-1):p<0&&(p=a);p>=0&&Uk(_0,p,l.length)}for(a=0,o=_0.length;a<o;++a){const p=_0[a];(p==="<"||p===">")&&(_0[a]="")}return Sw(_0.join(""),i)}const au={style:"normal",weight:"normal"},hu={style:"normal",weight:"bold"},uu={style:"italic",weight:"normal"},du={style:"italic",weight:"bold"},gp=new Map([["Times-Roman",{local:["Times New Roman","Times-Roman","Times","Liberation Serif","Nimbus Roman","Nimbus Roman L","Tinos","Thorndale","TeX Gyre Termes","FreeSerif","Linux Libertine O","Libertinus Serif","DejaVu Serif","Bitstream Vera Serif","Ubuntu"],style:au,ultimate:"serif"}],["Times-Bold",{alias:"Times-Roman",style:hu,ultimate:"serif"}],["Times-Italic",{alias:"Times-Roman",style:uu,ultimate:"serif"}],["Times-BoldItalic",{alias:"Times-Roman",style:du,ultimate:"serif"}],["Helvetica",{local:["Helvetica","Helvetica Neue","Arial","Arial Nova","Liberation Sans","Arimo","Nimbus Sans","Nimbus Sans L","A030","TeX Gyre Heros","FreeSans","DejaVu Sans","Albany","Bitstream Vera Sans","Arial Unicode MS","Microsoft Sans Serif","Apple Symbols","Cantarell"],path:"LiberationSans-Regular.ttf",style:au,ultimate:"sans-serif"}],["Helvetica-Bold",{alias:"Helvetica",path:"LiberationSans-Bold.ttf",style:hu,ultimate:"sans-serif"}],["Helvetica-Oblique",{alias:"Helvetica",path:"LiberationSans-Italic.ttf",style:uu,ultimate:"sans-serif"}],["Helvetica-BoldOblique",{alias:"Helvetica",path:"LiberationSans-BoldItalic.ttf",style:du,ultimate:"sans-serif"}],["Courier",{local:["Courier","Courier New","Liberation Mono","Nimbus Mono","Nimbus Mono L","Cousine","Cumberland","TeX Gyre Cursor","FreeMono","Linux Libertine Mono O","Libertinus Mono"],style:au,ultimate:"monospace"}],["Courier-Bold",{alias:"Courier",style:hu,ultimate:"monospace"}],["Courier-Oblique",{alias:"Courier",style:uu,ultimate:"monospace"}],["Courier-BoldOblique",{alias:"Courier",style:du,ultimate:"monospace"}],["ArialBlack",{local:["Arial Black"],style:{style:"normal",weight:"900"},fallback:"Helvetica-Bold"}],["ArialBlack-Bold",{alias:"ArialBlack"}],["ArialBlack-Italic",{alias:"ArialBlack",style:{style:"italic",weight:"900"},fallback:"Helvetica-BoldOblique"}],["ArialBlack-BoldItalic",{alias:"ArialBlack-Italic"}],["ArialNarrow",{local:["Arial Narrow","Liberation Sans Narrow","Helvetica Condensed","Nimbus Sans Narrow","TeX Gyre Heros Cn"],style:au,fallback:"Helvetica"}],["ArialNarrow-Bold",{alias:"ArialNarrow",style:hu,fallback:"Helvetica-Bold"}],["ArialNarrow-Italic",{alias:"ArialNarrow",style:uu,fallback:"Helvetica-Oblique"}],["ArialNarrow-BoldItalic",{alias:"ArialNarrow",style:du,fallback:"Helvetica-BoldOblique"}],["Calibri",{local:["Calibri","Carlito"],style:au,fallback:"Helvetica"}],["Calibri-Bold",{alias:"Calibri",style:hu,fallback:"Helvetica-Bold"}],["Calibri-Italic",{alias:"Calibri",style:uu,fallback:"Helvetica-Oblique"}],["Calibri-BoldItalic",{alias:"Calibri",style:du,fallback:"Helvetica-BoldOblique"}],["Wingdings",{local:["Wingdings","URW Dingbats"],style:au}],["Wingdings-Regular",{alias:"Wingdings"}],["Wingdings-Bold",{alias:"Wingdings"}]]),nG=new Map([["Arial-Black","ArialBlack"]]);function iG(n){switch(n){case hu:return"Bold";case uu:return"Italic";case du:return"Bold Italic";default:if((n==null?void 0:n.weight)==="bold")return"Bold";if((n==null?void 0:n.style)==="italic")return"Italic"}return""}function Hk(n){const e=new Set(["thin","extralight","ultralight","demilight","semilight","light","book","regular","normal","medium","demibold","semibold","bold","extrabold","ultrabold","black","heavy","extrablack","ultrablack","roman","italic","oblique","ultracondensed","extracondensed","condensed","semicondensed","normal","semiexpanded","expanded","extraexpanded","ultraexpanded","bolditalic"]);return n.split(/[- ,+]+/g).filter(t=>!e.has(t.toLowerCase())).join(" ")}function Z7({alias:n,local:e,path:t,fallback:i,style:s,ultimate:r},a,o,l=!0,c=!0,h=""){const u={style:null,ultimate:null};if(e){const d=h?` ${h}`:"";for(const f of e)a.push(`local(${f}${d})`)}if(n){const d=gp.get(n),f=h||iG(s);Object.assign(u,Z7(d,a,o,l&&!i,c&&!t,f))}if(s&&(u.style=s),r&&(u.ultimate=r),l&&i){const d=gp.get(i),{ultimate:f}=Z7(d,a,o,l,c&&!t,h);u.ultimate||(u.ultimate=f)}return c&&t&&o&&a.push(`url(${o}${t})`),u}function zk(n,e,t,i,s,r){if(i.startsWith("InvalidPDFjsFont_"))return null;(r==="TrueType"||r==="Type1")&&/^[A-Z]{6}\+/.test(i)&&(i=i.slice(7)),i=cx(i);const a=i;let o=n.get(a);if(o)return o;let l=gp.get(i);if(!l){for(const[x,p]of nG)if(i.startsWith(x)){i=`${p}${i.substring(x.length)}`,l=gp.get(i);break}}let c=!1;l||(l=gp.get(s),c=!0);const h=`${e.getDocId()}_s${e.createFontId()}`;if(!l){if(!I7(i))return he(`Cannot substitute the font because of its name: ${i}`),n.set(a,null),null;const x=/bold/gi.test(i),p=/oblique|italic/gi.test(i),y=x&&p&&du||x&&hu||p&&uu||au;return o={css:`"${Hk(i)}",${h}`,guessFallback:!0,loadedName:h,baseFontName:i,src:`local(${i})`,style:y},n.set(a,o),o}const u=[];c&&I7(i)&&u.push(`local(${i})`);const{style:d,ultimate:f}=Z7(l,u,t),g=f===null,m=g?"":`,${f}`;return o={css:`"${Hk(i)}",${h}${m}`,guessFallback:g,loadedName:h,baseFontName:i,src:u.join(","),style:d},n.set(a,o),o}const jk=3285377520,Za=4294901760,bl=65535;class sG{constructor(e){this.h1=e?e&4294967295:jk,this.h2=e?e&4294967295:jk}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let m=0,x=e.length;m<x;m++){const p=e.charCodeAt(m);p<=255?t[i++]=p:(t[i++]=p>>>8,t[i++]=p&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,a=new Uint32Array(t.buffer,0,s);let o=0,l=0,c=this.h1,h=this.h2;const u=3432918353,d=461845907,f=u&bl,g=d&bl;for(let m=0;m<s;m++)m&1?(o=a[m],o=o*u&Za|o*f&bl,o=o<<15|o>>>17,o=o*d&Za|o*g&bl,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[m],l=l*u&Za|l*f&bl,l=l<<15|l>>>17,l=l*d&Za|l*g&bl,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=t[s*4+2]<<16;case 2:o^=t[s*4+1]<<8;case 1:o^=t[s*4],o=o*u&Za|o*f&bl,o=o<<15|o>>>17,o=o*d&Za|o*g&bl,s&1?c^=o:h^=o}this.h1=c,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Za|e*36045&bl,t=t*4283543511&Za|((t<<16|e>>>16)*2950163797&Za)>>>16,e^=t>>>1,e=e*444984403&Za|e*60499&bl,t=t*3301882366&Za|((t<<16|e>>>16)*3120437893&Za)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}function Gk(n,e,t,i,s,r){const a=s*r;let o;e<=8?o=new Uint8Array(a):e<=16?o=new Uint16Array(a):o=new Uint32Array(a);const l=t/s,c=i/r;let h,u,d,f=0,g;const m=new Uint16Array(s),x=t;for(h=0;h<s;h++)m[h]=Math.floor(h*l);for(h=0;h<r;h++)for(d=Math.floor(h*c)*x,u=0;u<s;u++)g=d+m[u],o[f++]=n[g];return o}var Kb,Q7;const Gf=class Gf{constructor({xref:e,res:t,image:i,isInline:s=!1,smask:r=null,mask:a=null,isMask:o=!1,pdfFunctionFactory:l,globalColorSpaceCache:c,localColorSpaceCache:h}){B(this,Kb);var p,y;this.image=i;const u=i.dict,d=u.get("F","Filter");let f;if(d instanceof _e)f=d.name;else if(Array.isArray(d)){const w=e.fetchIfRef(d[0]);w instanceof _e&&(f=w.name)}switch(f){case"JPXDecode":({width:i.width,height:i.height,componentsCount:i.numComps,bitsPerComponent:i.bitsPerComponent}=Go.parseImageProperties(i.stream)),i.stream.reset();const w=Ro.getReducePowerForJPX(i.width,i.height,i.numComps);if(this.jpxDecoderOptions={numComponents:0,isIndexedColormap:!1,smaskInData:u.has("SMaskInData"),reducePower:w},w){const v=2**w;i.width=Math.ceil(i.width/v),i.height=Math.ceil(i.height/v)}break;case"JBIG2Decode":i.bitsPerComponent=1,i.numComps=1;break}let g=u.get("W","Width"),m=u.get("H","Height");if(Number.isInteger(i.width)&&i.width>0&&Number.isInteger(i.height)&&i.height>0&&(i.width!==g||i.height!==m))he("PDFImage - using the Width/Height of the image data, rather than the image dictionary."),g=i.width,m=i.height;else{const w=typeof g=="number"&&g>0,v=typeof m=="number"&&m>0;if(!w||!v){if(!i.fallbackDims)throw new Ee(`Invalid image width: ${g} or height: ${m}`);he("PDFImage - using the Width/Height of the parent image, for SMask/Mask data."),w||(g=i.fallbackDims.width),v||(m=i.fallbackDims.height)}}this.width=g,this.height=m,this.interpolate=u.get("I","Interpolate"),this.imageMask=u.get("IM","ImageMask")||!1,this.matte=u.get("Matte")||!1;let x=i.bitsPerComponent;if(!x&&(x=u.get("BPC","BitsPerComponent"),!x))if(this.imageMask)x=1;else throw new Ee(`Bits per component missing in image: ${this.imageMask}`);if(this.bpc=x,!this.imageMask){let w=u.getRaw("CS")||u.getRaw("ColorSpace");const v=!!w;if(v)(p=this.jpxDecoderOptions)!=null&&p.smaskInData&&(w=_e.get("DeviceRGBA"));else if(this.jpxDecoderOptions)w=_e.get("DeviceRGBA");else switch(i.numComps){case 1:w=_e.get("DeviceGray");break;case 3:w=_e.get("DeviceRGB");break;case 4:w=_e.get("DeviceCMYK");break;default:throw new Error(`Images with ${i.numComps} color components not supported.`)}this.colorSpace=Nn.parse({cs:w,xref:e,resources:s?t:null,pdfFunctionFactory:l,globalColorSpaceCache:c,localColorSpaceCache:h}),this.numComps=this.colorSpace.numComps,this.jpxDecoderOptions&&(this.jpxDecoderOptions.numComponents=v?this.numComps:0,this.jpxDecoderOptions.isIndexedColormap=this.colorSpace.name==="Indexed")}if(this.decode=u.getArray("D","Decode"),this.needsDecode=!1,this.decode&&(this.colorSpace&&!this.colorSpace.isDefaultDecode(this.decode,x)||o&&!dr.isDefaultDecode(this.decode,1))){this.needsDecode=!0;const w=(1<<x)-1;this.decodeCoefficients=[],this.decodeAddends=[];const v=((y=this.colorSpace)==null?void 0:y.name)==="Indexed";for(let _=0,C=0;_<this.decode.length;_+=2,++C){const k=this.decode[_],I=this.decode[_+1];this.decodeCoefficients[C]=v?(I-k)/w:I-k,this.decodeAddends[C]=v?k:w*k}}r?(r.fallbackDims??(r.fallbackDims={width:g,height:m}),this.smask=new Gf({xref:e,res:t,image:r,isInline:s,pdfFunctionFactory:l,globalColorSpaceCache:c,localColorSpaceCache:h})):a&&(a instanceof hn?a.dict.get("IM","ImageMask")?(a.fallbackDims??(a.fallbackDims={width:g,height:m}),this.mask=new Gf({xref:e,res:t,image:a,isInline:s,isMask:!0,pdfFunctionFactory:l,globalColorSpaceCache:c,localColorSpaceCache:h})):he("Ignoring /Mask in image without /ImageMask."):this.mask=a)}static async buildImage({xref:e,res:t,image:i,isInline:s=!1,pdfFunctionFactory:r,globalColorSpaceCache:a,localColorSpaceCache:o}){const l=i;let c=null,h=null;const u=i.dict.get("SMask"),d=i.dict.get("Mask");return u?u instanceof hn?c=u:he("Unsupported /SMask format."):d&&(d instanceof hn||Array.isArray(d)?h=d:he("Unsupported /Mask format.")),new Gf({xref:e,res:t,image:l,isInline:s,smask:c,mask:h,pdfFunctionFactory:r,globalColorSpaceCache:a,localColorSpaceCache:o})}static async createMask({image:e,isOffscreenCanvasSupported:t=!1}){const{dict:i}=e,s=i.get("W","Width"),r=i.get("H","Height"),a=i.get("I","Interpolate"),o=i.getArray("D","Decode"),l=(o==null?void 0:o[0])>0,c=(s+7>>3)*r,h=e.getBytes(c),u=s===1&&r===1&&l===(h.length===0||!!(h[0]&128));if(u)return{isSingleOpaquePixel:u};if(t){if(Ro.needsToBeResized(s,r)){const w=new Uint8ClampedArray(s*r*4);return O7({src:h,dest:w,width:s,height:r,nonBlackColor:0,inverseDecode:l}),Ro.createImage({kind:Os.RGBA_32BPP,data:w,width:s,height:r,interpolate:a})}const m=new OffscreenCanvas(s,r),x=m.getContext("2d"),p=x.createImageData(s,r);O7({src:h,dest:p.data,width:s,height:r,nonBlackColor:0,inverseDecode:l}),x.putImageData(p,0,0);const y=m.transferToImageBitmap();return{data:null,width:s,height:r,interpolate:a,bitmap:y}}const d=h.byteLength,f=c===d;let g;if(e instanceof Jr&&(!l||f)?g=h:l?(g=new Uint8Array(c),g.set(h),g.fill(255,d)):g=new Uint8Array(h),l)for(let m=0;m<d;m++)g[m]^=255;return{data:g,width:s,height:r,interpolate:a}}get drawWidth(){var e,t;return Math.max(this.width,((e=this.smask)==null?void 0:e.width)||0,((t=this.mask)==null?void 0:t.width)||0)}get drawHeight(){var e,t;return Math.max(this.height,((e=this.smask)==null?void 0:e.height)||0,((t=this.mask)==null?void 0:t.height)||0)}decodeBuffer(e){const t=this.bpc,i=this.numComps,s=this.decodeAddends,r=this.decodeCoefficients,a=(1<<t)-1;let o,l;if(t===1){for(o=0,l=e.length;o<l;o++)e[o]=+!e[o];return}let c=0;for(o=0,l=this.width*this.height;o<l;o++)for(let h=0;h<i;h++)e[c]=Us(s[h]+e[c]*r[h],0,a),c++}getComponents(e){const t=this.bpc;if(t===8)return e;const i=this.width,s=this.height,r=this.numComps,a=i*s*r;let o=0,l;t<=8?l=new Uint8Array(a):t<=16?l=new Uint16Array(a):l=new Uint32Array(a);const c=i*r,h=(1<<t)-1;let u=0,d,f;if(t===1){let g,m,x;for(let p=0;p<s;p++){for(m=u+(c&-8),x=u+c;u<m;)f=e[o++],l[u]=f>>7&1,l[u+1]=f>>6&1,l[u+2]=f>>5&1,l[u+3]=f>>4&1,l[u+4]=f>>3&1,l[u+5]=f>>2&1,l[u+6]=f>>1&1,l[u+7]=f&1,u+=8;if(u<x)for(f=e[o++],g=128;u<x;)l[u++]=+!!(f&g),g>>=1}}else{let g=0;for(f=0,u=0,d=a;u<d;++u){for(u%c===0&&(f=0,g=0);g<t;)f=f<<8|e[o++],g+=8;const m=g-t;let x=f>>m;x<0?x=0:x>h&&(x=h),l[u]=x,f&=(1<<m)-1,g=m}}return l}async fillOpacity(e,t,i,s,r){const a=this.smask,o=this.mask;let l,c,h,u,d,f;if(a)c=a.width,h=a.height,l=new Uint8ClampedArray(c*h),await a.fillGrayBuffer(l),(c!==t||h!==i)&&(l=Gk(l,a.bpc,c,h,t,i));else if(o)if(o instanceof Gf){for(c=o.width,h=o.height,l=new Uint8ClampedArray(c*h),o.numComps=1,await o.fillGrayBuffer(l),u=0,d=c*h;u<d;++u)l[u]=255-l[u];(c!==t||h!==i)&&(l=Gk(l,o.bpc,c,h,t,i))}else if(Array.isArray(o)){l=new Uint8ClampedArray(t*i);const g=this.numComps;for(u=0,d=t*i;u<d;++u){let m=0;const x=u*g;for(f=0;f<g;++f){const p=r[x+f],y=f*2;if(p<o[y]||p>o[y+1]){m=255;break}}l[u]=m}}else throw new Ee("Unknown mask format.");if(l)for(u=0,f=3,d=t*s;u<d;++u,f+=4)e[f]=l[u];else for(u=0,f=3,d=t*s;u<d;++u,f+=4)e[f]=255}undoPreblend(e,t,i){var h;const s=(h=this.smask)==null?void 0:h.matte;if(!s)return;const r=this.colorSpace.getRgb(s,0),a=r[0],o=r[1],l=r[2],c=t*i*4;for(let u=0;u<c;u+=4){const d=e[u+3];if(d===0){e[u]=255,e[u+1]=255,e[u+2]=255;continue}const f=255/d;e[u]=(e[u]-a)*f+a,e[u+1]=(e[u+1]-o)*f+o,e[u+2]=(e[u+2]-l)*f+l}}async createImageData(e=!1,t=!1){const i=this.drawWidth,s=this.drawHeight,r={width:i,height:s,interpolate:this.interpolate,kind:0,data:null},a=this.numComps,o=this.width,l=this.height,c=this.bpc,h=o*a*c+7>>3,u=t&&Ro.needsToBeResized(i,s);if(!this.smask&&!this.mask&&this.colorSpace.name==="DeviceRGBA"){r.kind=Os.RGBA_32BPP;const _=r.data=await this.getImageBytes(l*o*4,{});return t?u?Ro.createImage(r,!1):this.createBitmap(Os.RGBA_32BPP,i,s,_):r}if(!e){let _;if(this.colorSpace.name==="DeviceGray"&&c===1?_=Os.GRAYSCALE_1BPP:this.colorSpace.name==="DeviceRGB"&&c===8&&!this.needsDecode&&(_=Os.RGB_24BPP),_&&!this.smask&&!this.mask&&i===o&&s===l){const C=await L(this,Kb,Q7).call(this,o,l);if(C)return C;const k=await this.getImageBytes(l*h,{});if(t)return u?Ro.createImage({data:k,kind:_,width:i,height:s,interpolate:this.interpolate},this.needsDecode):this.createBitmap(_,o,l,k);if(r.kind=_,r.data=k,this.needsDecode){Bs(_===Os.GRAYSCALE_1BPP,"PDFImage.createImageData: The image must be grayscale.");const I=r.data;for(let S=0,R=I.length;S<R;S++)I[S]^=255}return r}if(this.image instanceof Cg&&!this.smask&&!this.mask&&!this.needsDecode){let C=l*h;if(t&&!u){let k=!1;switch(this.colorSpace.name){case"DeviceGray":C*=4,k=!0;break;case"DeviceRGB":C=C/3*4,k=!0;break;case"DeviceCMYK":k=!0;break}if(k){const I=await L(this,Kb,Q7).call(this,i,s);if(I)return I;const S=await this.getImageBytes(C,{drawWidth:i,drawHeight:s,forceRGBA:!0});return this.createBitmap(Os.RGBA_32BPP,i,s,S)}}else switch(this.colorSpace.name){case"DeviceGray":C*=3;case"DeviceRGB":case"DeviceCMYK":return r.kind=Os.RGB_24BPP,r.data=await this.getImageBytes(C,{drawWidth:i,drawHeight:s,forceRGB:!0}),u?Ro.createImage(r):r}}}const d=await this.getImageBytes(l*h,{internal:!0}),f=0|d.length/h*s/l,g=this.getComponents(d);let m,x,p,y,w,v;if(t&&!u&&(p=new OffscreenCanvas(i,s),y=p.getContext("2d"),w=y.createImageData(i,s),v=w.data),r.kind=Os.RGBA_32BPP,!e&&!this.smask&&!this.mask?(!t||u?(r.kind=Os.RGB_24BPP,v=new Uint8ClampedArray(i*s*3),m=0):(new Uint32Array(v.buffer).fill(da.isLittleEndian?4278190080:255),m=1),x=!1):((!t||u)&&(v=new Uint8ClampedArray(i*s*4)),m=1,x=!0,await this.fillOpacity(v,i,s,f,g)),this.needsDecode&&this.decodeBuffer(g),this.colorSpace.fillRgb(v,o,l,i,s,f,c,g,m),x&&this.undoPreblend(v,i,f),t&&!u){y.putImageData(w,0,0);const _=p.transferToImageBitmap();return{data:null,width:i,height:s,bitmap:_,interpolate:this.interpolate}}return r.data=v,u?Ro.createImage(r):r}async fillGrayBuffer(e){const t=this.numComps;if(t!==1)throw new Ee(`Reading gray scale from a color image: ${t}`);const i=this.width,s=this.height,r=this.bpc,a=i*t*r+7>>3,o=await this.getImageBytes(s*a,{internal:!0}),l=this.getComponents(o);let c,h;if(r===1){if(h=i*s,this.needsDecode)for(c=0;c<h;++c)e[c]=l[c]-1&255;else for(c=0;c<h;++c)e[c]=-l[c]&255;return}this.needsDecode&&this.decodeBuffer(l),h=i*s;const u=255/((1<<r)-1);for(c=0;c<h;++c)e[c]=u*l[c]}createBitmap(e,t,i,s){const r=new OffscreenCanvas(t,i),a=r.getContext("2d");let o;e===Os.RGBA_32BPP?o=new ImageData(s,t,i):(o=a.createImageData(t,i),dR({kind:e,src:s,dest:new Uint32Array(o.data.buffer),width:t,height:i,inverseDecode:this.needsDecode})),a.putImageData(o,0,0);const l=r.transferToImageBitmap();return{data:null,width:t,height:i,bitmap:l,interpolate:this.interpolate}}async getImageBytes(e,{drawWidth:t,drawHeight:i,forceRGBA:s=!1,forceRGB:r=!1,internal:a=!1}){this.image.reset(),this.image.drawWidth=t||this.width,this.image.drawHeight=i||this.height,this.image.forceRGBA=!!s,this.image.forceRGB=!!r;const o=await this.image.getImageData(e,this.jpxDecoderOptions);return a||this.image instanceof Jr?o:(Bs(o instanceof Uint8Array,'PDFImage.getImageBytes: Unsupported "imageBytes" type.'),new Uint8Array(o))}};Kb=new WeakSet,Q7=async function(e,t){const i=await this.image.getTransferableImage();return i?{data:null,width:e,height:t,bitmap:i,interpolate:this.interpolate}:null};let mp=Gf;const rG=Object.freeze({maxImageSize:-1,disableFontFace:!1,ignoreErrors:!1,isEvalSupported:!0,isOffscreenCanvasSupported:!1,isImageDecoderSupported:!1,canvasMaxAreaInBytes:-1,fontExtraProperties:!1,useSystemFonts:!0,useWasm:!0,useWorkerFetch:!0,cMapUrl:null,iccUrl:null,standardFontDataUrl:null,wasmUrl:null}),Vk={TILING:1,SHADING:2},aG=10,qk=Promise.resolve();function GR(n,e=!1){if(Array.isArray(n)){for(const t of n){const i=GR(t,!0);if(i)return i}return he(`Unsupported blend mode Array: ${n}`),"source-over"}if(!(n instanceof _e))return e?null:"source-over";switch(n.name){case"Normal":case"Compatible":return"source-over";case"Multiply":return"multiply";case"Screen":return"screen";case"Overlay":return"overlay";case"Darken":return"darken";case"Lighten":return"lighten";case"ColorDodge":return"color-dodge";case"ColorBurn":return"color-burn";case"HardLight":return"hard-light";case"SoftLight":return"soft-light";case"Difference":return"difference";case"Exclusion":return"exclusion";case"Hue":return"hue";case"Saturation":return"saturation";case"Color":return"color";case"Luminosity":return"luminosity"}return e?null:(he(`Unsupported blend mode: ${n.name}`),"source-over")}function Iw(n,{objId:e,fn:t,args:i,optionalContent:s,hasMask:r}){var a;e&&n.addDependency(e),n.addImageOps(t,i,s,r),t===ne.paintImageMaskXObject&&((a=i[0])==null?void 0:a.count)>0&&i[0].count++}const Vf=class Vf{constructor(){this.reset()}check(){return++this.checked<Vf.CHECK_TIME_EVERY?!1:(this.checked=0,this.endTime<=Date.now())}reset(){this.endTime=Date.now()+Vf.TIME_SLOT_DURATION_MS,this.checked=0}};ze(Vf,"TIME_SLOT_DURATION_MS",20),ze(Vf,"CHECK_TIME_EVERY",100);let R3=Vf;class Sg{constructor({xref:e,handler:t,pageIndex:i,idFactory:s,fontCache:r,builtInCMapCache:a,standardFontDataCache:o,globalColorSpaceCache:l,globalImageCache:c,systemFontCache:h,options:u=null}){this.xref=e,this.handler=t,this.pageIndex=i,this.idFactory=s,this.fontCache=r,this.builtInCMapCache=a,this.standardFontDataCache=o,this.globalColorSpaceCache=l,this.globalImageCache=c,this.systemFontCache=h,this.options=u||rG,this.type3FontRefs=null,this._regionalImageCache=new jj,this._fetchBuiltInCMapBound=this.fetchBuiltInCMap.bind(this)}get _pdfFunctionFactory(){const e=new zR({xref:this.xref,isEvalSupported:this.options.isEvalSupported});return Ze(this,"_pdfFunctionFactory",e)}get parsingType3Font(){return!!this.type3FontRefs}clone(e=null){const t=Object.create(this);return t.options=Object.assign(Object.create(null),this.options,e),t}hasBlendModes(e,t){if(!(e instanceof fe)||e.objId&&t.has(e.objId))return!1;const i=new Ji(t);e.objId&&i.put(e.objId);const s=[e],r=this.xref;for(;s.length;){const a=s.shift(),o=a.get("ExtGState");if(o instanceof fe)for(let c of o.getRawValues()){if(c instanceof st){if(i.has(c))continue;try{c=r.fetch(c)}catch(u){i.put(c),gn(`hasBlendModes - ignoring ExtGState: "${u}".`);continue}}if(!(c instanceof fe))continue;c.objId&&i.put(c.objId);const h=c.get("BM");if(h instanceof _e){if(h.name!=="Normal")return!0;continue}if(h!==void 0&&Array.isArray(h)){for(const u of h)if(u instanceof _e&&u.name!=="Normal")return!0}}const l=a.get("XObject");if(l instanceof fe)for(let c of l.getRawValues()){if(c instanceof st){if(i.has(c))continue;try{c=r.fetch(c)}catch(u){i.put(c),gn(`hasBlendModes - ignoring XObject: "${u}".`);continue}}if(!(c instanceof hn))continue;c.dict.objId&&i.put(c.dict.objId);const h=c.dict.get("Resources");h instanceof fe&&(h.objId&&i.has(h.objId)||(s.push(h),h.objId&&i.put(h.objId)))}}for(const a of i)t.put(a);return!1}async fetchBuiltInCMap(e){const t=this.builtInCMapCache.get(e);if(t)return t;let i;return this.options.useWorkerFetch?i={cMapData:await A7(`${this.options.cMapUrl}${e}.bcmap`),isCompressed:!0}:i=await this.handler.sendWithPromise("FetchBinaryData",{type:"cMapReaderFactory",name:e}),this.builtInCMapCache.set(e,i),i}async fetchStandardFontData(e){const t=this.standardFontDataCache.get(e);if(t)return new Ui(t);if(this.options.useSystemFonts&&e!=="Symbol"&&e!=="ZapfDingbats")return null;const i=cz(),s=i[e];let r;try{this.options.useWorkerFetch?r=await A7(`${this.options.standardFontDataUrl}${s}`):r=await this.handler.sendWithPromise("FetchBinaryData",{type:"standardFontDataFactory",filename:s})}catch(a){return he(a),null}return this.standardFontDataCache.set(e,r),new Ui(r)}async buildFormXObject(e,t,i,s,r,a,o,l){const{dict:c}=t,h=Ch(c.getArray("Matrix"),null),u=p0(c.getArray("BBox"),null);let d,f;c.has("OC")&&(d=await this.parseMarkedContentProps(c.get("OC"),e)),d!==void 0&&s.addOp(ne.beginMarkedContentProps,["OC",d]);const g=c.get("Group");if(g){f={matrix:h,bbox:u,smask:i,isolated:!1,knockout:!1};const w=g.get("S");let v=null;if(Oi(w,"Transparency")&&(f.isolated=g.get("I")||!1,f.knockout=g.get("K")||!1,g.has("CS"))){const _=this._getColorSpace(g.getRaw("CS"),e,o);v=_ instanceof dr?_:await this._handleColorSpace(_)}i!=null&&i.backdrop&&(v||(v=Nn.rgb),i.backdrop=v.getRgbHex(i.backdrop,0)),s.addOp(ne.beginGroup,[f])}const m=h&&new Float32Array(h),x=!g&&u&&new Float32Array(u)||null,p=[m,x];s.addOp(ne.paintFormXObjectBegin,p);const y=c.get("Resources");await this.getOperatorList({stream:t,task:r,resources:y instanceof fe?y:e,operatorList:s,initialState:a,prevRefs:l}),s.addOp(ne.paintFormXObjectEnd,[]),g&&s.addOp(ne.endGroup,[f]),d!==void 0&&s.addOp(ne.endMarkedContent,[])}_sendImgData(e,t,i=!1){const s=t?[t.bitmap||t.data.buffer]:null;return this.parsingType3Font||i?this.handler.send("commonobj",[e,"Image",t],s):this.handler.send("obj",[e,this.pageIndex,"Image",t],s)}async buildPaintImageXObject({resources:e,image:t,isInline:i=!1,operatorList:s,cacheKey:r,localImageCache:a,localColorSpaceCache:o}){const{maxImageSize:l,ignoreErrors:c,isOffscreenCanvasSupported:h}=this.options,{dict:u}=t,d=u.objId,f=u.get("W","Width"),g=u.get("H","Height");if(!(f&&typeof f=="number")||!(g&&typeof g=="number")){he("Image dimensions are missing, or not numbers.");return}if(l!==-1&&f*g>l){const S="Image exceeded maximum allowed size and was removed.";if(!c)throw new Error(S);he(S);return}let m;u.has("OC")&&(m=await this.parseMarkedContentProps(u.get("OC"),e));const x=u.get("IM","ImageMask")||!1;let p,y,w;if(x){if(p=await mp.createMask({image:t,isOffscreenCanvasSupported:h&&!this.parsingType3Font}),p.isSingleOpaquePixel){if(y=ne.paintSolidColorImageMask,w=[],s.addImageOps(y,w,m),r){const R={fn:y,args:w,optionalContent:m};a.set(r,d,R),d&&this._regionalImageCache.set(null,d,R)}return}if(this.parsingType3Font){if(w=$H(p),w){s.addImageOps(ne.constructPath,w,m);return}he("Cannot compile Type3 glyph."),s.addImageOps(ne.paintImageMaskXObject,[p],m);return}const S=`mask_${this.idFactory.createObjId()}`;if(s.addDependency(S),p.dataLen=p.bitmap?p.width*p.height*4:p.data.length,this._sendImgData(S,p),y=ne.paintImageMaskXObject,w=[{data:S,width:p.width,height:p.height,interpolate:p.interpolate,count:1}],s.addImageOps(y,w,m),r){const R={objId:S,fn:y,args:w,optionalContent:m};a.set(r,d,R),d&&this._regionalImageCache.set(null,d,R)}return}const v=200,_=u.has("SMask")||u.has("Mask");if(i&&f+g<v&&!_){try{p=await new mp({xref:this.xref,res:e,image:t,isInline:i,pdfFunctionFactory:this._pdfFunctionFactory,globalColorSpaceCache:this.globalColorSpaceCache,localColorSpaceCache:o}).createImageData(!0,!1),s.addImageOps(ne.paintInlineImageXObject,[p],m)}catch(S){const R=`Unable to decode inline image: "${S}".`;if(!c)throw new Error(R);he(R)}return}let C=`img_${this.idFactory.createObjId()}`,k=!1,I=null;if(this.parsingType3Font?C=`${this.idFactory.getDocId()}_type3_${C}`:r&&d&&(k=this.globalImageCache.shouldCache(d,this.pageIndex),k&&(Bs(!i,"Cannot cache an inline image globally."),C=`${this.idFactory.getDocId()}_${C}`)),s.addDependency(C),y=ne.paintImageXObject,w=[C,f,g],s.addImageOps(y,w,m,_),k){if(I={objId:C,fn:y,args:w,optionalContent:m,hasMask:_,byteSize:0},this.globalImageCache.hasDecodeFailed(d)){this.globalImageCache.setData(d,I),this._sendImgData(C,null,k);return}if(f*g>25e4||_){const S=await this.handler.sendWithPromise("commonobj",[C,"CopyLocalImage",{imageRef:d}]);if(S){this.globalImageCache.setData(d,I),this.globalImageCache.addByteSize(d,S);return}}}if(mp.buildImage({xref:this.xref,res:e,image:t,isInline:i,pdfFunctionFactory:this._pdfFunctionFactory,globalColorSpaceCache:this.globalColorSpaceCache,localColorSpaceCache:o}).then(async S=>(p=await S.createImageData(!1,h),p.dataLen=p.bitmap?p.width*p.height*4:p.data.length,p.ref=d,k&&this.globalImageCache.addByteSize(d,p.dataLen),this._sendImgData(C,p,k))).catch(S=>(he(`Unable to decode image "${C}": "${S}".`),d&&this.globalImageCache.addDecodeFailed(d),this._sendImgData(C,null,k))),r){const S={objId:C,fn:y,args:w,optionalContent:m,hasMask:_};a.set(r,d,S),d&&(this._regionalImageCache.set(null,d,S),k&&(Bs(I,"The global cache-data must be available."),this.globalImageCache.setData(d,I)))}}handleSMask(e,t,i,s,r,a,o){const l=e.get("G"),c={subtype:e.get("S").name,backdrop:e.get("BC")},h=e.get("TR");if(Aw(h)){const u=this._pdfFunctionFactory.create(h),d=new Uint8Array(256),f=new Float32Array(1);for(let g=0;g<256;g++)f[0]=g/255,u(f,0,f,0),d[g]=f[0]*255|0;c.transferMap=d}return this.buildFormXObject(t,l,c,i,s,r.state.clone({newPath:!0}),a,o)}handleTransferFunction(e){let t;if(Array.isArray(e))t=e;else if(Aw(e))t=[e];else return null;const i=[];let s=0,r=0;for(const a of t){const o=this.xref.fetchIfRef(a);if(s++,Oi(o,"Identity")){i.push(null);continue}else if(!Aw(o))return null;const l=this._pdfFunctionFactory.create(o),c=new Uint8Array(256),h=new Float32Array(1);for(let u=0;u<256;u++)h[0]=u/255,l(h,0,h,0),c[u]=h[0]*255|0;i.push(c),r++}return!(s===1||s===4)||r===0?null:i}handleTilingType(e,t,i,s,r,a,o,l){const c=new Ar,h=fe.merge({xref:this.xref,dictArray:[r.get("Resources"),i]});return this.getOperatorList({stream:s,task:o,resources:h,operatorList:c}).then(function(){const u=c.getIR(),d=Mk(u,r,t);a.addDependencies(c.dependencies),a.addOp(e,d),r.objId&&l.set(null,r.objId,{operatorListIR:u,dict:r})}).catch(u=>{if(!(u instanceof sr)){if(this.options.ignoreErrors){he(`handleTilingType - ignoring pattern: "${u}".`);return}throw u}})}async handleSetFont(e,t,i,s,r,a,o=null,l=null){const c=(t==null?void 0:t[0])instanceof _e?t[0].name:null,h=await this.loadFont(c,i,e,r,o,l);return h.font.isType3Font&&s.addDependencies(h.type3Dependencies),a.font=h.font,h.send(this.handler),h.loadedName}handleText(e,t){const i=t.font,s=i.charsToGlyphs(e);return i.data&&(t.textRenderingMode&WT.ADD_TO_PATH_FLAG||t.fillColorSpace.name==="Pattern"||i.disableFontFace)&&Sg.buildFontPaths(i,s,this.handler,this.options),s}ensureStateFont(e){if(e.font)return;const t=new Ee("Missing setFont (Tf) operator before text rendering operator.");if(this.options.ignoreErrors){he(`ensureStateFont: "${t}".`);return}throw t}async setGState({resources:e,gState:t,operatorList:i,cacheKey:s,task:r,stateManager:a,localGStateCache:o,localColorSpaceCache:l,seenRefs:c}){const h=t.objId;let u=!0;const d=[];let f=Promise.resolve();for(const[g,m]of t)switch(g){case"Type":break;case"LW":if(typeof m!="number"){he(`Invalid LW (line width): ${m}`);break}d.push([g,Math.abs(m)]);break;case"LC":case"LJ":case"ML":case"D":case"RI":case"FL":case"CA":case"ca":d.push([g,m]);break;case"Font":u=!1,f=f.then(()=>this.handleSetFont(e,null,m[0],i,r,a.state).then(function(p){i.addDependency(p),d.push([g,[p,m[1]]])}));break;case"BM":d.push([g,GR(m)]);break;case"SMask":if(Oi(m,"None")){d.push([g,!1]);break}m instanceof fe?(u=!1,f=f.then(()=>this.handleSMask(m,e,i,r,a,l,c)),d.push([g,!0])):he("Unsupported SMask type");break;case"TR":const x=this.handleTransferFunction(m);d.push([g,x]);break;case"OP":case"op":case"OPM":case"BG":case"BG2":case"UCR":case"UCR2":case"TR2":case"HT":case"SM":case"SA":case"AIS":case"TK":gn("graphic state operator "+g);break;default:gn("Unknown graphic state operator "+g);break}await f,d.length>0&&i.addOp(ne.setGState,[d]),u&&o.set(s,h,d)}loadFont(e,t,i,s,r=null,a=null){var x;const o=async()=>new Ew({loadedName:"g_font_error",font:new Tk(`Font "${e}" is not available.`),dict:t});let l;if(t)t instanceof st&&(l=t);else{const p=i.get("Font");p&&(l=p.getRaw(e))}if(l){if((x=this.type3FontRefs)!=null&&x.has(l))return o();if(this.fontCache.has(l))return this.fontCache.get(l);try{t=this.xref.fetchIfRef(l)}catch(p){he(`loadFont - lookup failed: "${p}".`)}}if(!(t instanceof fe)){if(!this.options.ignoreErrors&&!this.parsingType3Font)return he(`Font "${e}" is not available.`),o();he(`Font "${e}" is not available -- attempting to fallback to a default font.`),t=r||Sg.fallbackFontDict}if(t.cacheKey&&this.fontCache.has(t.cacheKey))return this.fontCache.get(t.cacheKey);const{promise:c,resolve:h}=Promise.withResolvers();let u;try{u=this.preEvaluateFont(t),u.cssFontInfo=a}catch(p){return he(`loadFont - preEvaluateFont failed: "${p}".`),o()}const{descriptor:d,hash:f}=u,g=l instanceof st;let m;if(f&&d instanceof fe){const p=d.fontAliases||(d.fontAliases=Object.create(null));if(p[f]){const y=p[f].aliasRef;if(g&&y&&this.fontCache.has(y))return this.fontCache.putAlias(l,y),this.fontCache.get(l)}else p[f]={fontID:this.idFactory.createFontId()};g&&(p[f].aliasRef=l),m=p[f].fontID}else m=this.idFactory.createFontId();return Bs(m==null?void 0:m.startsWith("f"),'The "fontID" must be (correctly) defined.'),g?this.fontCache.put(l,c):(t.cacheKey=`cacheKey_${m}`,this.fontCache.put(t.cacheKey,c)),t.loadedName=`${this.idFactory.getDocId()}_${m}`,this.translateFont(u).then(async p=>{const y=new Ew({loadedName:t.loadedName,font:p,dict:t});if(p.isType3Font)try{await y.loadType3Data(this,i,s)}catch(w){throw new Error(`Type3 font load error: ${w}`)}h(y)}).catch(p=>{he(`loadFont - translateFont failed: "${p}".`),h(new Ew({loadedName:t.loadedName,font:new Tk(p==null?void 0:p.message),dict:t}))}),c}buildPath(e,t,i){const{pathMinMax:s,pathBuffer:r}=i;switch(e|0){case ne.rectangle:{const a=i.currentPointX=t[0],o=i.currentPointY=t[1],l=t[2],c=t[3],h=a+l,u=o+c;l===0||c===0?r.push(ds.moveTo,a,o,ds.lineTo,h,u,ds.closePath):r.push(ds.moveTo,a,o,ds.lineTo,h,o,ds.lineTo,h,u,ds.lineTo,a,u,ds.closePath),Dn.rectBoundingBox(a,o,h,u,s);break}case ne.moveTo:{const a=i.currentPointX=t[0],o=i.currentPointY=t[1];r.push(ds.moveTo,a,o),Dn.pointBoundingBox(a,o,s);break}case ne.lineTo:{const a=i.currentPointX=t[0],o=i.currentPointY=t[1];r.push(ds.lineTo,a,o),Dn.pointBoundingBox(a,o,s);break}case ne.curveTo:{const a=i.currentPointX,o=i.currentPointY,[l,c,h,u,d,f]=t;i.currentPointX=d,i.currentPointY=f,r.push(ds.curveTo,l,c,h,u,d,f),Dn.bezierBoundingBox(a,o,l,c,h,u,d,f,s);break}case ne.curveTo2:{const a=i.currentPointX,o=i.currentPointY,[l,c,h,u]=t;i.currentPointX=h,i.currentPointY=u,r.push(ds.curveTo,a,o,l,c,h,u),Dn.bezierBoundingBox(a,o,a,o,l,c,h,u,s);break}case ne.curveTo3:{const a=i.currentPointX,o=i.currentPointY,[l,c,h,u]=t;i.currentPointX=h,i.currentPointY=u,r.push(ds.curveTo,l,c,h,u,h,u),Dn.bezierBoundingBox(a,o,l,c,h,u,h,u,s);break}case ne.closePath:r.push(ds.closePath);break}}_getColorSpace(e,t,i){return Nn.parse({cs:e,xref:this.xref,resources:t,pdfFunctionFactory:this._pdfFunctionFactory,globalColorSpaceCache:this.globalColorSpaceCache,localColorSpaceCache:i,asyncIfNotCached:!0})}async _handleColorSpace(e){try{return await e}catch(t){if(t instanceof sr)return null;if(this.options.ignoreErrors)return he(`_handleColorSpace - ignoring ColorSpace: "${t}".`),null;throw t}}parseShading({shading:e,resources:t,localColorSpaceCache:i,localShadingPatternCache:s}){let r=s.get(e);if(r)return r;let a;try{a=Qz.parseShading(e,this.xref,t,this._pdfFunctionFactory,this.globalColorSpaceCache,i).getIR()}catch(o){if(o instanceof sr)return null;if(this.options.ignoreErrors)return he(`parseShading - ignoring shading: "${o}".`),s.set(e,null),null;throw o}return r=`pattern_${this.idFactory.createObjId()}`,this.parsingType3Font&&(r=`${this.idFactory.getDocId()}_type3_${r}`),s.set(e,r),this.parsingType3Font?this.handler.send("commonobj",[r,"Pattern",a]):this.handler.send("obj",[r,this.pageIndex,"Pattern",a]),r}handleColorN(e,t,i,s,r,a,o,l,c,h){const u=i.pop();if(u instanceof _e){const d=r.getRaw(u.name),f=d instanceof st&&c.getByRef(d);if(f)try{const m=s.base?s.base.getRgbHex(i,0):null,x=Mk(f.operatorListIR,f.dict,m);e.addOp(t,x);return}catch{}const g=this.xref.fetchIfRef(d);if(g){const m=g instanceof hn?g.dict:g,x=m.get("PatternType");if(x===Vk.TILING){const p=s.base?s.base.getRgbHex(i,0):null;return this.handleTilingType(t,p,a,g,m,e,o,c)}else if(x===Vk.SHADING){const p=m.get("Shading"),y=this.parseShading({shading:p,resources:a,localColorSpaceCache:l,localShadingPatternCache:h});if(y){const w=Ch(m.getArray("Matrix"),null);e.addOp(t,["Shading",y,w])}return}throw new Ee(`Unknown PatternType: ${x}`)}}throw new Ee(`Unknown PatternName: ${u}`)}_parseVisibilityExpression(e,t,i){if(++t>10){he("Visibility expression is too deeply nested");return}const r=e.length,a=this.xref.fetchIfRef(e[0]);if(r<2||!(a instanceof _e)){he("Invalid visibility expression");return}switch(a.name){case"And":case"Or":case"Not":i.push(a.name);break;default:he(`Invalid operator ${a.name} in visibility expression`);return}for(let o=1;o<r;o++){const l=e[o],c=this.xref.fetchIfRef(l);if(Array.isArray(c)){const h=[];i.push(h),this._parseVisibilityExpression(c,t,h)}else l instanceof st&&i.push(l.toString())}}async parseMarkedContentProps(e,t){var r;let i;if(e instanceof _e)i=t.get("Properties").get(e.name);else if(e instanceof fe)i=e;else throw new Ee("Optional content properties malformed.");const s=(r=i.get("Type"))==null?void 0:r.name;if(s==="OCG")return{type:s,id:i.objId};if(s==="OCMD"){const a=i.get("VE");if(Array.isArray(a)){const l=[];if(this._parseVisibilityExpression(a,0,l),l.length>0)return{type:"OCMD",expression:l}}const o=i.get("OCGs");if(Array.isArray(o)||o instanceof fe){const l=[];if(Array.isArray(o))for(const c of o)l.push(c.toString());else l.push(o.objId);return{type:s,ids:l,policy:i.get("P")instanceof _e?i.get("P").name:null,expression:null}}else if(o instanceof st)return{type:s,id:o.toString()}}return null}getOperatorList({stream:e,task:t,resources:i,operatorList:s,initialState:r=null,fallbackFontDict:a=null,prevRefs:o=null}){var k;const l=(k=e.dict)==null?void 0:k.objId,c=new Ji(o);if(l){if(o!=null&&o.has(l))throw new Error(`getOperatorList - ignoring circular reference: ${l}`);c.put(l)}if(i||(i=fe.empty),r||(r=new WR),!s)throw new Error('getOperatorList: missing "operatorList" parameter');const h=this,u=this.xref,d=new Pk,f=new UR,g=new Nk,m=new zj,x=new Map,p=i.get("XObject")||fe.empty,y=i.get("Pattern")||fe.empty,w=new i3(r),v=new Ig(e,u,w),_=new R3;function C(I){for(let S=0,R=v.savedStatesDepth;S<R;S++)s.addOp(ne.restore,[])}return new Promise(function I(S,R){const P=function(z){Promise.all([z,s.ready]).then(function(){try{I(S,R)}catch(K){R(K)}},R)};t.ensureNotTerminated(),_.reset();const D={};let U,T,G,M,F,X;for(;!(U=_.check())&&(D.args=null,!!v.read(D));){let z=D.args,K=D.fn;switch(K|0){case ne.paintXObject:if(X=z[0]instanceof _e,F=z[0].name,X){const O=d.getByName(F);if(O){Iw(s,O),z=null;continue}}P(new Promise(function(O,Y){if(!X)throw new Ee("XObject must be referred to by name.");let le=p.getRaw(F);if(le instanceof st){const re=d.getByRef(le)||h._regionalImageCache.getByRef(le)||h.globalImageCache.getData(le,h.pageIndex);if(re){Iw(s,re),O();return}le=u.fetch(le)}if(!(le instanceof hn))throw new Ee("XObject should be a stream");const $=le.dict.get("Subtype");if(!($ instanceof _e))throw new Ee("XObject should have a Name subtype");if($.name==="Form"){w.save(),h.buildFormXObject(i,le,null,s,t,w.state.clone({newPath:!0}),f,c).then(function(){w.restore(),O()},Y);return}else if($.name==="Image"){h.buildPaintImageXObject({resources:i,image:le,operatorList:s,cacheKey:F,localImageCache:d,localColorSpaceCache:f}).then(O,Y);return}else if($.name==="PS")gn("Ignored XObject subtype PS");else throw new Ee(`Unhandled XObject subtype ${$.name}`);O()}).catch(function(O){if(!(O instanceof sr)){if(h.options.ignoreErrors){he(`getOperatorList - ignoring XObject: "${O}".`);return}throw O}}));return;case ne.setFont:const j=z[1];P(h.handleSetFont(i,z,null,s,t,w.state,a).then(function(O){s.addDependency(O),s.addOp(ne.setFont,[O,j])}));return;case ne.endInlineImage:const ae=z[0].cacheKey;if(ae){const O=d.getByName(ae);if(O){Iw(s,O),z=null;continue}}P(h.buildPaintImageXObject({resources:i,image:z[0],isInline:!0,operatorList:s,cacheKey:ae,localImageCache:d,localColorSpaceCache:f}));return;case ne.showText:if(!w.state.font){h.ensureStateFont(w.state);continue}z[0]=h.handleText(z[0],w.state);break;case ne.showSpacedText:if(!w.state.font){h.ensureStateFont(w.state);continue}const ge=[],ue=w.state;for(const O of z[0])typeof O=="string"?ge.push(...h.handleText(O,ue)):typeof O=="number"&&ge.push(O);z[0]=ge,K=ne.showText;break;case ne.nextLineShowText:if(!w.state.font){h.ensureStateFont(w.state);continue}s.addOp(ne.nextLine),z[0]=h.handleText(z[0],w.state),K=ne.showText;break;case ne.nextLineSetSpacingShowText:if(!w.state.font){h.ensureStateFont(w.state);continue}s.addOp(ne.nextLine),s.addOp(ne.setWordSpacing,[z.shift()]),s.addOp(ne.setCharSpacing,[z.shift()]),z[0]=h.handleText(z[0],w.state),K=ne.showText;break;case ne.setTextRenderingMode:w.state.textRenderingMode=z[0];break;case ne.setFillColorSpace:{const O=h._getColorSpace(z[0],i,f);if(O instanceof dr){w.state.fillColorSpace=O;continue}P(h._handleColorSpace(O).then(Y=>{w.state.fillColorSpace=Y||Nn.gray}));return}case ne.setStrokeColorSpace:{const O=h._getColorSpace(z[0],i,f);if(O instanceof dr){w.state.strokeColorSpace=O;continue}P(h._handleColorSpace(O).then(Y=>{w.state.strokeColorSpace=Y||Nn.gray}));return}case ne.setFillColor:M=w.state.fillColorSpace,z=[M.getRgbHex(z,0)],K=ne.setFillRGBColor;break;case ne.setStrokeColor:M=w.state.strokeColorSpace,z=[M.getRgbHex(z,0)],K=ne.setStrokeRGBColor;break;case ne.setFillGray:w.state.fillColorSpace=Nn.gray,z=[Nn.gray.getRgbHex(z,0)],K=ne.setFillRGBColor;break;case ne.setStrokeGray:w.state.strokeColorSpace=Nn.gray,z=[Nn.gray.getRgbHex(z,0)],K=ne.setStrokeRGBColor;break;case ne.setFillCMYKColor:w.state.fillColorSpace=Nn.cmyk,z=[Nn.cmyk.getRgbHex(z,0)],K=ne.setFillRGBColor;break;case ne.setStrokeCMYKColor:w.state.strokeColorSpace=Nn.cmyk,z=[Nn.cmyk.getRgbHex(z,0)],K=ne.setStrokeRGBColor;break;case ne.setFillRGBColor:w.state.fillColorSpace=Nn.rgb,z=[Nn.rgb.getRgbHex(z,0)];break;case ne.setStrokeRGBColor:w.state.strokeColorSpace=Nn.rgb,z=[Nn.rgb.getRgbHex(z,0)];break;case ne.setFillColorN:if(M=w.state.patternFillColorSpace,!M){if(Gr(z,null)){z=[Nn.gray.getRgbHex(z,0)],K=ne.setFillRGBColor;break}z=[],K=ne.setFillTransparent;break}if(M.name==="Pattern"){P(h.handleColorN(s,ne.setFillColorN,z,M,y,i,t,f,m,x));return}z=[M.getRgbHex(z,0)],K=ne.setFillRGBColor;break;case ne.setStrokeColorN:if(M=w.state.patternStrokeColorSpace,!M){if(Gr(z,null)){z=[Nn.gray.getRgbHex(z,0)],K=ne.setStrokeRGBColor;break}z=[],K=ne.setStrokeTransparent;break}if(M.name==="Pattern"){P(h.handleColorN(s,ne.setStrokeColorN,z,M,y,i,t,f,m,x));return}z=[M.getRgbHex(z,0)],K=ne.setStrokeRGBColor;break;case ne.shadingFill:let pe;try{const O=i.get("Shading");if(!O)throw new Ee("No shading resource found");if(pe=O.get(z[0].name),!pe)throw new Ee("No shading object found")}catch(O){if(O instanceof sr)continue;if(h.options.ignoreErrors){he(`getOperatorList - ignoring Shading: "${O}".`);continue}throw O}const de=h.parseShading({shading:pe,resources:i,localColorSpaceCache:f,localShadingPatternCache:x});if(!de)continue;z=[de],K=ne.shadingFill;break;case ne.setGState:if(X=z[0]instanceof _e,F=z[0].name,X){const O=g.getByName(F);if(O){O.length>0&&s.addOp(ne.setGState,[O]),z=null;continue}}P(new Promise(function(O,Y){if(!X)throw new Ee("GState must be referred to by name.");const le=i.get("ExtGState");if(!(le instanceof fe))throw new Ee("ExtGState should be a dictionary.");const $=le.get(F);if(!($ instanceof fe))throw new Ee("GState should be a dictionary.");h.setGState({resources:i,gState:$,operatorList:s,cacheKey:F,task:t,stateManager:w,localGStateCache:g,localColorSpaceCache:f,seenRefs:c}).then(O,Y)}).catch(function(O){if(!(O instanceof sr)){if(h.options.ignoreErrors){he(`getOperatorList - ignoring ExtGState: "${O}".`);return}throw O}}));return;case ne.setLineWidth:{const[O]=z;if(typeof O!="number"){he(`Invalid setLineWidth: ${O}`);continue}z[0]=Math.abs(O);break}case ne.moveTo:case ne.lineTo:case ne.curveTo:case ne.curveTo2:case ne.curveTo3:case ne.closePath:case ne.rectangle:h.buildPath(K,z,w.state);continue;case ne.stroke:case ne.closeStroke:case ne.fill:case ne.eoFill:case ne.fillStroke:case ne.eoFillStroke:case ne.closeFillStroke:case ne.closeEOFillStroke:case ne.endPath:{const{state:{pathBuffer:O,pathMinMax:Y}}=w;(K===ne.closeStroke||K===ne.closeFillStroke||K===ne.closeEOFillStroke)&&O.push(ds.closePath),O.length===0?s.addOp(ne.constructPath,[K,[null],null]):(s.addOp(ne.constructPath,[K,[new Float32Array(O)],Y.slice()]),O.length=0,Y.set([1/0,1/0,-1/0,-1/0],0));continue}case ne.setTextMatrix:s.addOp(K,[new Float32Array(z)]);continue;case ne.markPoint:case ne.markPointProps:case ne.beginCompat:case ne.endCompat:continue;case ne.beginMarkedContentProps:if(!(z[0]instanceof _e)){he(`Expected name for beginMarkedContentProps arg0=${z[0]}`),s.addOp(ne.beginMarkedContentProps,["OC",null]);continue}if(z[0].name==="OC"){P(h.parseMarkedContentProps(z[1],i).then(O=>{s.addOp(ne.beginMarkedContentProps,["OC",O])}).catch(O=>{if(!(O instanceof sr)){if(h.options.ignoreErrors){he(`getOperatorList - ignoring beginMarkedContentProps: "${O}".`),s.addOp(ne.beginMarkedContentProps,["OC",null]);return}throw O}}));return}z=[z[0].name,z[1]instanceof fe?z[1].get("MCID"):null];break;case ne.beginMarkedContent:case ne.endMarkedContent:default:if(z!==null){for(T=0,G=z.length;T<G&&!(z[T]instanceof fe);T++);if(T<G){he("getOperatorList - ignoring operator: "+K);continue}}}s.addOp(K,z)}if(U){P(qk);return}C(),S()}).catch(I=>{if(!(I instanceof sr)){if(this.options.ignoreErrors){he(`getOperatorList - ignoring errors during "${t.name}" task: "${I}".`),C();return}throw I}})}getTextContent({stream:e,task:t,resources:i,stateManager:s=null,includeMarkedContent:r=!1,sink:a,seenStyles:o=new Set,viewBox:l,lang:c=null,markedContentData:h=null,disableNormalization:u=!1,keepWhiteSpace:d=!1,prevRefs:f=null,intersector:g=null}){var Re;const m=(Re=e.dict)==null?void 0:Re.objId,x=new Ji(f);if(m){if(f!=null&&f.has(m))throw new Error(`getTextContent - ignoring circular reference: ${m}`);x.put(m)}i||(i=fe.empty),s||(s=new i3(new oG)),r&&(h||(h={level:0}));const p={items:[],styles:Object.create(null),lang:c},y={initialized:!1,str:[],totalWidth:0,totalHeight:0,width:0,height:0,vertical:!1,prevTransform:null,textAdvanceScale:0,spaceInFlowMin:0,spaceInFlowMax:0,trackingSpaceMin:1/0,negativeSpaceMax:-1/0,notASpace:-1/0,transform:null,fontName:null,hasEOL:!1},w=[" "," "];let v=0;function _(Ne){const He=(v+1)%2,Be=w[v]!==" "&&w[He]===" ";return w[v]=Ne,v=He,!d&&Be}function C(){return!d&&w[v]!==" "&&w[(v+1)%2]===" "}function k(){w[0]=w[1]=" ",v=0}const I=.102,S=.03,R=-.2,P=.102,D=.6,U=.25,T=this,G=this.xref,M=[];let F=null;const X=new Pk,z=new Nk,K=new Ig(e,G,s);let j;function ae({width:Ne=0,height:He=0,transform:Be=y.prevTransform,fontName:Je=y.fontName}){g==null||g.addExtraChar(" "),p.items.push({str:" ",dir:"ltr",width:Ne,height:He,transform:Be,fontName:Je,hasEOL:!1})}function ge(){const Ne=j.font,He=[j.fontSize*j.textHScale,0,0,j.fontSize,0,j.textRise];if(Ne.isType3Font&&(j.fontSize<=1||Ne.isCharBBox)&&!Fp(j.fontMatrix,Dd)){const Be=Ne.bbox[3]-Ne.bbox[1];Be>0&&(He[3]*=Be*j.fontMatrix[3])}return Dn.transform(j.ctm,Dn.transform(j.textMatrix,He))}function ue(){if(y.initialized)return y;const{font:Ne,loadedName:He}=j;if(!o.has(He)&&(o.add(He),p.styles[He]={fontFamily:Ne.fallbackName,ascent:Ne.ascent,descent:Ne.descent,vertical:Ne.vertical},T.options.fontExtraProperties&&Ne.systemFontInfo)){const Ye=p.styles[He];Ye.fontSubstitution=Ne.systemFontInfo.css,Ye.fontSubstitutionLoadedName=Ne.systemFontInfo.loadedName}y.fontName=He;const Be=y.transform=ge();Ne.vertical?(y.width=y.totalWidth=Math.hypot(Be[0],Be[1]),y.height=y.totalHeight=0,y.vertical=!0):(y.width=y.totalWidth=0,y.height=y.totalHeight=Math.hypot(Be[2],Be[3]),y.vertical=!1);const Je=Math.hypot(j.textLineMatrix[0],j.textLineMatrix[1]),ht=Math.hypot(j.ctm[0],j.ctm[1]);y.textAdvanceScale=ht*Je;const{fontSize:ot}=j;return y.trackingSpaceMin=ot*I,y.notASpace=ot*S,y.negativeSpaceMax=ot*R,y.spaceInFlowMin=ot*P,y.spaceInFlowMax=ot*D,y.hasEOL=!1,y.initialized=!0,y}function pe(){if(!y.initialized)return;const Ne=Math.hypot(j.textLineMatrix[0],j.textLineMatrix[1]),Be=Math.hypot(j.ctm[0],j.ctm[1])*Ne;Be!==y.textAdvanceScale&&(y.vertical?(y.totalHeight+=y.height*y.textAdvanceScale,y.height=0):(y.totalWidth+=y.width*y.textAdvanceScale,y.width=0),y.textAdvanceScale=Be)}function de(Ne){let He=Ne.str.join("");u||(He=$B(He));const Be=jR(He,-1,Ne.vertical);return{str:Be.str,dir:Be.dir,width:Math.abs(Ne.totalWidth),height:Math.abs(Ne.totalHeight),transform:Ne.transform,fontName:Ne.fontName,hasEOL:Ne.hasEOL}}async function O(Ne,He){const Be=await T.loadFont(Ne,He,i,t);j.loadedName=Be.loadedName,j.font=Be.font,j.fontMatrix=Be.font.fontMatrix||Dd}function Y(Ne,He,Be){const Je=Math.hypot(Be[0],Be[1]);return[(Be[0]*Ne+Be[1]*He)/Je,(Be[2]*Ne+Be[3]*He)/Je]}function le(Ne){var ut;const He=ge();let Be=He[4],Je=He[5];if((ut=j.font)!=null&&ut.vertical){if(Be<l[0]||Be>l[2]||Je+Ne<l[1]||Je>l[3])return!1}else if(Be+Ne<l[0]||Be>l[2]||Je<l[1]||Je>l[3])return!1;if(!j.font||!y.prevTransform)return!0;let ht=y.prevTransform[4],ot=y.prevTransform[5];if(ht===Be&&ot===Je)return!0;let Ye=-1;switch(He[0]&&He[1]===0&&He[2]===0?Ye=He[0]>0?0:180:He[1]&&He[0]===0&&He[3]===0&&(Ye=He[1]>0?90:270),Ye){case 0:break;case 90:[Be,Je]=[Je,Be],[ht,ot]=[ot,ht];break;case 180:[Be,Je,ht,ot]=[-Be,-Je,-ht,-ot];break;case 270:[Be,Je]=[-Je,-Be],[ht,ot]=[-ot,-ht];break;default:[Be,Je]=Y(Be,Je,He),[ht,ot]=Y(ht,ot,y.prevTransform)}if(j.font.vertical){const dt=(ot-Je)/y.textAdvanceScale,Ve=Be-ht,Ot=Math.sign(y.height);return dt<Ot*y.negativeSpaceMax?Math.abs(Ve)>.5*y.width?(re(),!0):(k(),ee(),!0):Math.abs(Ve)>y.width?(re(),!0):(dt<=Ot*y.notASpace&&k(),dt<=Ot*y.trackingSpaceMin?C()?(k(),ee(),ae({height:Math.abs(dt)})):y.height+=dt:oe(dt,y.prevTransform,Ot)||(y.str.length===0?(k(),ae({height:Math.abs(dt)})):y.height+=dt),Math.abs(Ve)>y.width*U&&ee(),!0)}const rt=(Be-ht)/y.textAdvanceScale,me=Je-ot,Mt=Math.sign(y.width);return rt<Mt*y.negativeSpaceMax?Math.abs(me)>.5*y.height?(re(),!0):(k(),ee(),!0):Math.abs(me)>y.height?(re(),!0):(rt<=Mt*y.notASpace&&k(),rt<=Mt*y.trackingSpaceMin?C()?(k(),ee(),ae({width:Math.abs(rt)})):y.width+=rt:oe(rt,y.prevTransform,Mt)||(y.str.length===0?(k(),ae({width:Math.abs(rt)})):y.width+=rt),Math.abs(me)>y.height*U&&ee(),!0)}function $({chars:Ne,extraSpacing:He}){const Be=j.font;if(!Ne){const ot=j.charSpacing+He;ot&&(Be.vertical?j.translateTextMatrix(0,-ot):j.translateTextMatrix(ot*j.textHScale,0)),d&&le(0);return}const Je=Be.charsToGlyphs(Ne),ht=j.fontMatrix[0]*j.fontSize;for(let ot=0,Ye=Je.length;ot<Ye;ot++){const rt=Je[ot],{category:me}=rt;if(me.isInvisibleFormatMark)continue;let Mt=j.charSpacing+(ot+1===Ye?He:0),ut=rt.width;Be.vertical&&(ut=rt.vmetric?rt.vmetric[0]:-ut);let dt=ut*ht;if(!d&&me.isWhitespace){Be.vertical?(Mt+=-dt+j.wordSpacing,j.translateTextMatrix(0,-Mt)):(Mt+=dt+j.wordSpacing,j.translateTextMatrix(Mt*j.textHScale,0)),_(" ");continue}if(!me.isZeroWidthDiacritic&&!le(dt)){Be.vertical?j.translateTextMatrix(0,dt):j.translateTextMatrix(dt*j.textHScale,0);continue}const Ve=ue();me.isZeroWidthDiacritic&&(dt=0),Be.vertical?(g==null||g.addGlyph(ge(),0,dt,rt.unicode),j.translateTextMatrix(0,dt),dt=Math.abs(dt),Ve.height+=dt):(dt*=j.textHScale,g==null||g.addGlyph(ge(),dt,0,rt.unicode),j.translateTextMatrix(dt,0),Ve.width+=dt),dt&&(Ve.prevTransform=ge());const Ot=rt.unicode;_(Ot)&&(Ve.str.push(" "),g==null||g.addExtraChar(" ")),g||Ve.str.push(Ot),Mt&&(Be.vertical?j.translateTextMatrix(0,-Mt):j.translateTextMatrix(Mt*j.textHScale,0))}}function re(){g==null||g.addExtraChar(`
`),k(),y.initialized?(y.hasEOL=!0,ee()):p.items.push({str:"",dir:"ltr",width:0,height:0,transform:ge(),fontName:j.loadedName,hasEOL:!0})}function oe(Ne,He,Be){if(Be*y.spaceInFlowMin<=Ne&&Ne<=Be*y.spaceInFlowMax)return y.initialized&&(k(),y.str.push(" "),g==null||g.addExtraChar(" ")),!1;const Je=y.fontName;let ht=0;return y.vertical&&(ht=Ne,Ne=0),ee(),k(),ae({width:Math.abs(Ne),height:Math.abs(ht),transform:He||ge(),fontName:Je}),!0}function ee(){!y.initialized||!y.str||(y.vertical?y.totalHeight+=y.height*y.textAdvanceScale:y.totalWidth+=y.width*y.textAdvanceScale,p.items.push(de(y)),y.initialized=!1,y.str.length=0)}function Q(Ne=!1){const He=p.items.length;He!==0&&(Ne&&He<aG||(a==null||a.enqueue(p,He),p.items=[],p.styles=Object.create(null)))}const je=new R3;return new Promise(function Ne(He,Be){const Je=function(Mt){Q(!0),Promise.all([Mt,a==null?void 0:a.ready]).then(function(){try{Ne(He,Be)}catch(ut){Be(ut)}},Be)};t.ensureNotTerminated(),je.reset();const ht={};let ot,Ye,rt,me=[];for(;!(ot=je.check())&&(me.length=0,ht.args=me,!!K.read(ht));){const Mt=j;j=s.state;const ut=ht.fn;switch(me=ht.args,ut|0){case ne.setFont:const dt=me[0].name,Ve=me[1];if(j.font&&dt===j.fontName&&Ve===j.fontSize)break;ee(),j.fontName=dt,j.fontSize=Ve,Je(O(dt,null));return;case ne.setTextRise:j.textRise=me[0];break;case ne.setHScale:j.textHScale=me[0]/100;break;case ne.setLeading:j.leading=me[0];break;case ne.moveText:j.translateTextLineMatrix(me[0],me[1]),j.textMatrix=j.textLineMatrix.slice();break;case ne.setLeadingMoveText:j.leading=-me[1],j.translateTextLineMatrix(me[0],me[1]),j.textMatrix=j.textLineMatrix.slice();break;case ne.nextLine:j.carriageReturn();break;case ne.setTextMatrix:j.setTextMatrix(me[0],me[1],me[2],me[3],me[4],me[5]),j.setTextLineMatrix(me[0],me[1],me[2],me[3],me[4],me[5]),pe();break;case ne.setCharSpacing:j.charSpacing=me[0];break;case ne.setWordSpacing:j.wordSpacing=me[0];break;case ne.beginText:j.textMatrix=el.slice(),j.textLineMatrix=el.slice();break;case ne.showSpacedText:if(!s.state.font){T.ensureStateFont(s.state);continue}const Ot=(j.font.vertical?1:-1)*j.fontSize/1e3,rn=me[0];for(let Me=0,Dt=rn.length;Me<Dt;Me++){const gt=rn[Me];if(typeof gt=="string")M.push(gt);else if(typeof gt=="number"&&gt!==0){const jt=M.join("");M.length=0,$({chars:jt,extraSpacing:gt*Ot})}}if(M.length>0){const Me=M.join("");M.length=0,$({chars:Me,extraSpacing:0})}break;case ne.showText:if(!s.state.font){T.ensureStateFont(s.state);continue}$({chars:me[0],extraSpacing:0});break;case ne.nextLineShowText:if(!s.state.font){T.ensureStateFont(s.state);continue}j.carriageReturn(),$({chars:me[0],extraSpacing:0});break;case ne.nextLineSetSpacingShowText:if(!s.state.font){T.ensureStateFont(s.state);continue}j.wordSpacing=me[0],j.charSpacing=me[1],j.carriageReturn(),$({chars:me[2],extraSpacing:0});break;case ne.paintXObject:if(ee(),F??(F=i.get("XObject")||fe.empty),rt=me[0]instanceof _e,Ye=me[0].name,rt&&X.getByName(Ye))break;Je(new Promise(function(Me,Dt){if(!rt)throw new Ee("XObject must be referred to by name.");let gt=F.getRaw(Ye);if(gt instanceof st){if(X.getByRef(gt)){Me();return}if(T.globalImageCache.getData(gt,T.pageIndex)){Me();return}gt=G.fetch(gt)}if(!(gt instanceof hn))throw new Ee("XObject should be a stream");const{dict:jt}=gt,Fn=jt.get("Subtype");if(!(Fn instanceof _e))throw new Ee("XObject should have a Name subtype");if(Fn.name!=="Form"){X.set(Ye,jt.objId,!0),Me();return}const Kn=s.state.clone(),ci=new i3(Kn),ji=Ch(jt.getArray("Matrix"),null);ji&&ci.transform(ji);const xs=jt.get("Resources");Q();const hi={enqueueInvoked:!1,enqueue(qi,ys){this.enqueueInvoked=!0,a.enqueue(qi,ys)},get desiredSize(){return a.desiredSize??0},get ready(){return a.ready}};T.getTextContent({stream:gt,task:t,resources:xs instanceof fe?xs:i,stateManager:ci,includeMarkedContent:r,sink:a&&hi,seenStyles:o,viewBox:l,lang:c,markedContentData:h,disableNormalization:u,keepWhiteSpace:d,prevRefs:x}).then(function(){hi.enqueueInvoked||X.set(Ye,jt.objId,!0),Me()},Dt)}).catch(function(Me){if(!(Me instanceof sr)){if(T.options.ignoreErrors){he(`getTextContent - ignoring XObject: "${Me}".`);return}throw Me}}));return;case ne.setGState:if(rt=me[0]instanceof _e,Ye=me[0].name,rt&&z.getByName(Ye))break;Je(new Promise(function(Me,Dt){if(!rt)throw new Ee("GState must be referred to by name.");const gt=i.get("ExtGState");if(!(gt instanceof fe))throw new Ee("ExtGState should be a dictionary.");const jt=gt.get(Ye);if(!(jt instanceof fe))throw new Ee("GState should be a dictionary.");const Fn=jt.get("Font");if(!Fn){z.set(Ye,jt.objId,!0),Me();return}ee(),j.fontName=null,j.fontSize=Fn[1],O(null,Fn[0]).then(Me,Dt)}).catch(function(Me){if(!(Me instanceof sr)){if(T.options.ignoreErrors){he(`getTextContent - ignoring ExtGState: "${Me}".`);return}throw Me}}));return;case ne.beginMarkedContent:ee(),r&&(h.level++,p.items.push({type:"beginMarkedContent",tag:me[0]instanceof _e?me[0].name:null}));break;case ne.beginMarkedContentProps:if(ee(),r){h.level++;let Me=null;me[1]instanceof fe&&(Me=me[1].get("MCID")),p.items.push({type:"beginMarkedContentProps",id:Number.isInteger(Me)?`${T.idFactory.getPageObjId()}_mc${Me}`:null,tag:me[0]instanceof _e?me[0].name:null})}break;case ne.endMarkedContent:if(ee(),r){if(h.level===0)break;h.level--,p.items.push({type:"endMarkedContent"})}break;case ne.restore:Mt&&(Mt.font!==j.font||Mt.fontSize!==j.fontSize||Mt.fontName!==j.fontName)&&ee();break}if(p.items.length>=((a==null?void 0:a.desiredSize)??1)){ot=!0;break}}if(ot){Je(qk);return}ee(),Q(),He()}).catch(Ne=>{if(!(Ne instanceof sr)){if(this.options.ignoreErrors){he(`getTextContent - ignoring errors during "${t.name}" task: "${Ne}".`),ee(),Q();return}throw Ne}})}async extractDataStructures(e,t){const i=this.xref;let s;const r=this.readToUnicode(t.toUnicode);if(t.composite){const d=e.get("CIDSystemInfo");d instanceof fe&&(t.cidSystemInfo={registry:Tn(d.get("Registry")),ordering:Tn(d.get("Ordering")),supplement:d.get("Supplement")});try{const f=e.get("CIDToGIDMap");f instanceof hn&&(s=f.getBytes())}catch(f){if(!this.options.ignoreErrors)throw f;he(`extractDataStructures - ignoring CIDToGIDMap data: "${f}".`)}}const a=[];let o=null,l;if(e.has("Encoding")){if(l=e.get("Encoding"),l instanceof fe){if(o=l.get("BaseEncoding"),o=o instanceof _e?o.name:null,l.has("Differences")){const d=l.get("Differences");let f=0;for(const g of d){const m=i.fetchIfRef(g);if(typeof m=="number")f=m;else if(m instanceof _e)a[f++]=m.name;else throw new Ee(`Invalid entry in 'Differences' array: ${m}`)}}}else if(l instanceof _e)o=l.name;else{const d="Encoding is not a Name nor a Dict";if(!this.options.ignoreErrors)throw new Ee(d);he(d)}o!=="MacRomanEncoding"&&o!=="MacExpertEncoding"&&o!=="WinAnsiEncoding"&&(o=null)}const c=!t.file||t.isInternalFont,h=V7()[t.name];if(o&&c&&h&&(o=null),o)t.defaultEncoding=zp(o);else{const d=!!(t.flags&oo.Symbolic),f=!!(t.flags&oo.Nonsymbolic);l=s0,t.type==="TrueType"&&!f&&(l=Hp),(d||h)&&(l=y4,c&&(/Symbol/i.test(t.name)?l=w4:/Dingbats/i.test(t.name)?l=v4:/Wingdings/i.test(t.name)&&(l=Hp))),t.defaultEncoding=l}t.differences=a,t.baseEncodingName=o,t.hasEncoding=!!o||a.length>0,t.dict=e,t.toUnicode=await r;const u=await this.buildToUnicode(t);return t.toUnicode=u,s&&(t.cidToGidMap=this.readCidToGidMap(s,u)),t}_simpleFontToUnicode(e,t=!1){Bs(!e.composite,"Must be a simple font.");const i=[],s=e.defaultEncoding.slice(),r=e.baseEncodingName,a=e.differences;for(const l in a){const c=a[l];c!==".notdef"&&(s[l]=c)}const o=Wl();for(const l in s){let c=s[l];if(c==="")continue;let h=o[c];if(h!==void 0){i[l]=String.fromCharCode(h);continue}let u=0;switch(c[0]){case"G":c.length===3&&(u=parseInt(c.substring(1),16));break;case"g":c.length===5&&(u=parseInt(c.substring(1),16));break;case"C":case"c":if(c.length>=3&&c.length<=4){const d=c.substring(1);if(t){u=parseInt(d,16);break}if(u=+d,Number.isNaN(u)&&Number.isInteger(parseInt(d,16)))return this._simpleFontToUnicode(e,!0)}break;case"u":h=Ag(c,o),h!==-1&&(u=h);break;default:switch(c){case"f_h":case"f_t":case"T_h":i[l]=c.replaceAll("_","");continue}break}if(u>0&&u<=1114111&&Number.isInteger(u)){if(r&&u===+l){const d=zp(r);if(d&&(c=d[l])){i[l]=String.fromCharCode(o[c]);continue}}i[l]=String.fromCodePoint(u)}}return i}async buildToUnicode(e){var t,i;if(e.hasIncludedToUnicodeMap=((t=e.toUnicode)==null?void 0:t.length)>0,e.hasIncludedToUnicodeMap)return!e.composite&&e.hasEncoding&&(e.fallbackToUnicode=this._simpleFontToUnicode(e)),e.toUnicode;if(!e.composite)return new ap(this._simpleFontToUnicode(e));if(e.composite&&(e.cMap.builtInCMap&&!(e.cMap instanceof $f)||((i=e.cidSystemInfo)==null?void 0:i.registry)==="Adobe"&&(e.cidSystemInfo.ordering==="GB1"||e.cidSystemInfo.ordering==="CNS1"||e.cidSystemInfo.ordering==="Japan1"||e.cidSystemInfo.ordering==="Korea1"))){const{registry:s,ordering:r}=e.cidSystemInfo,a=_e.get(`${s}-${r}-UCS2`),o=await qx.create({encoding:a,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null}),l=[],c=[];return e.cMap.forEach(function(h,u){if(u>65535)throw new Ee("Max size of CID is 65,535");const d=o.lookup(u);if(d){c.length=0;for(let f=0,g=d.length;f<g;f+=2)c.push((d.charCodeAt(f)<<8)+d.charCodeAt(f+1));l[h]=String.fromCharCode(...c)}}),new ap(l)}return new ho(e.firstChar,e.lastChar)}async readToUnicode(e){if(!e)return null;if(e instanceof _e){const t=await qx.create({encoding:e,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null});return t instanceof $f?new ho(0,65535):new ap(t.getMap())}if(e instanceof hn)try{const t=await qx.create({encoding:e,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null});if(t instanceof $f)return new ho(0,65535);const i=new Array(t.length);return t.forEach(function(s,r){if(typeof r=="number"){i[s]=String.fromCodePoint(r);return}r.length%2!==0&&(r="\0"+r);const a=[];for(let o=0;o<r.length;o+=2){const l=r.charCodeAt(o)<<8|r.charCodeAt(o+1);if((l&63488)!==55296){a.push(l);continue}o+=2;const c=r.charCodeAt(o)<<8|r.charCodeAt(o+1);a.push(((l&1023)<<10)+(c&1023)+65536)}i[s]=String.fromCodePoint(...a)}),new ap(i)}catch(t){if(t instanceof sr)return null;if(this.options.ignoreErrors)return he(`readToUnicode - ignoring ToUnicode data: "${t}".`),null;throw t}return null}readCidToGidMap(e,t){const i=[];for(let s=0,r=e.length;s<r;s++){const a=e[s++]<<8|e[s],o=s>>1;a===0&&!t.has(o)||(i[o]=a)}return i}extractWidths(e,t,i){const s=this.xref;let r=[],a=0;const o=[];let l;if(i.composite){const u=e.get("DW");a=typeof u=="number"?Math.ceil(u):1e3;const d=e.get("W");if(Array.isArray(d))for(let f=0,g=d.length;f<g;f++){let m=s.fetchIfRef(d[f++]);if(!Number.isInteger(m))break;const x=s.fetchIfRef(d[f]);if(Array.isArray(x))for(const p of x){const y=s.fetchIfRef(p);typeof y=="number"&&(r[m]=y),m++}else if(Number.isInteger(x)){const p=s.fetchIfRef(d[++f]);if(typeof p!="number")continue;for(let y=m;y<=x;y++)r[y]=p}else break}if(i.vertical){const f=e.getArray("DW2");let g=Gr(f,2)?f:[880,-1e3];if(l=[g[1],a*.5,g[0]],g=e.get("W2"),Array.isArray(g))for(let m=0,x=g.length;m<x;m++){let p=s.fetchIfRef(g[m++]);if(!Number.isInteger(p))break;const y=s.fetchIfRef(g[m]);if(Array.isArray(y))for(let w=0,v=y.length;w<v;w++){const _=[s.fetchIfRef(y[w++]),s.fetchIfRef(y[w++]),s.fetchIfRef(y[w])];Gr(_,null)&&(o[p]=_),p++}else if(Number.isInteger(y)){const w=[s.fetchIfRef(g[++m]),s.fetchIfRef(g[++m]),s.fetchIfRef(g[++m])];if(!Gr(w,null))continue;for(let v=p;v<=y;v++)o[v]=w}else break}}}else{const u=e.get("Widths");if(Array.isArray(u)){let d=i.firstChar;for(const g of u){const m=s.fetchIfRef(g);typeof m=="number"&&(r[d]=m),d++}const f=t.get("MissingWidth");a=typeof f=="number"?f:0}else{const d=e.get("BaseFont");if(d instanceof _e){const f=this.getBaseFontMetrics(d.name);r=this.buildCharCodeToWidth(f.widths,i),a=f.defaultWidth}}}let c=!0,h=a;for(const u in r){const d=r[u];if(d){if(!h){h=d;continue}if(h!==d){c=!1;break}}}c?i.flags|=oo.FixedPitch:i.flags&=~oo.FixedPitch,i.defaultWidth=a,i.widths=r,i.defaultVMetrics=l,i.vmetrics=o}isSerifFont(e){const t=e.split("-",1)[0];return t in C4()||/serif/gi.test(t)}getBaseFontMetrics(e){let t=0,i=Object.create(null),s=!1,a=ty()[e]||e;const o=yz();a in o||(a=this.isSerifFont(e)?"Times-Roman":"Helvetica");const l=o[a];return typeof l=="number"?(t=l,s=!0):i=l(),{defaultWidth:t,monospace:s,widths:i}}buildCharCodeToWidth(e,t){const i=Object.create(null),s=t.differences,r=t.defaultEncoding;for(let a=0;a<256;a++){if(a in s&&e[s[a]]){i[a]=e[s[a]];continue}if(a in r&&e[r[a]]){i[a]=e[r[a]];continue}}return i}preEvaluateFont(e){const t=e;let i=e.get("Subtype");if(!(i instanceof _e))throw new Ee("invalid font Subtype");let s=!1,r;if(i.name==="Type0"){const h=e.get("DescendantFonts");if(!h)throw new Ee("Descendant fonts are not specified");if(e=Array.isArray(h)?this.xref.fetchIfRef(h[0]):h,!(e instanceof fe))throw new Ee("Descendant font is not a dictionary.");if(i=e.get("Subtype"),!(i instanceof _e))throw new Ee("invalid font Subtype");s=!0}let a=e.get("FirstChar");Number.isInteger(a)||(a=0);let o=e.get("LastChar");Number.isInteger(o)||(o=s?65535:255);const l=e.get("FontDescriptor"),c=e.get("ToUnicode")||t.get("ToUnicode");if(l){r=new sG;const h=t.getRaw("Encoding");if(h instanceof _e)r.update(h.name);else if(h instanceof st)r.update(h.toString());else if(h instanceof fe){for(const d of h.getRawValues())if(d instanceof _e)r.update(d.name);else if(d instanceof st)r.update(d.toString());else if(Array.isArray(d)){const f=d.length,g=new Array(f);for(let m=0;m<f;m++){const x=d[m];x instanceof _e?g[m]=x.name:(typeof x=="number"||x instanceof st)&&(g[m]=x.toString())}r.update(g.join())}}if(r.update(`${a}-${o}`),c instanceof hn){const d=c.str||c,f=d.buffer?new Uint8Array(d.buffer.buffer,0,d.bufferLength):new Uint8Array(d.bytes.buffer,d.start,d.end-d.start);r.update(f)}else c instanceof _e&&r.update(c.name);const u=e.get("Widths")||t.get("Widths");if(Array.isArray(u)){const d=[];for(const f of u)(typeof f=="number"||f instanceof st)&&d.push(f.toString());r.update(d.join())}if(s){r.update("compositeFont");const d=e.get("W")||t.get("W");if(Array.isArray(d)){const g=[];for(const m of d)if(typeof m=="number"||m instanceof st)g.push(m.toString());else if(Array.isArray(m)){const x=[];for(const p of m)(typeof p=="number"||p instanceof st)&&x.push(p.toString());g.push(`[${x.join()}]`)}r.update(g.join())}const f=e.getRaw("CIDToGIDMap")||t.getRaw("CIDToGIDMap");f instanceof _e?r.update(f.name):f instanceof st?r.update(f.toString()):f instanceof hn&&r.update(f.peekBytes())}}return{descriptor:l,dict:e,baseDict:t,composite:s,type:i.name,firstChar:a,lastChar:o,toUnicode:c,hash:r?r.hexdigest():""}}async translateFont({descriptor:e,dict:t,baseDict:i,composite:s,type:r,firstChar:a,lastChar:o,toUnicode:l,cssFontInfo:c}){const h=r==="Type3";if(!e)if(h)e=fe.empty;else{let F=t.get("BaseFont");if(!(F instanceof _e))throw new Ee("Base font is not specified");F=F.name.replaceAll(/[,_]/g,"-");const X=this.getBaseFontMetrics(F),z=F.split("-",1)[0],K=(this.isSerifFont(z)?oo.Serif:0)|(X.monospace?oo.FixedPitch:0)|(V7()[z]?oo.Symbolic:oo.Nonsymbolic),j={type:r,name:F,loadedName:i.loadedName,systemFontInfo:null,widths:X.widths,defaultWidth:X.defaultWidth,isSimulatedFlags:!0,flags:K,firstChar:a,lastChar:o,toUnicode:l,xHeight:0,capHeight:0,italicAngle:0,isType3Font:h},ae=t.get("Widths"),ge=hk(F);let ue=null;ge&&(ue=await this.fetchStandardFontData(ge),j.isInternalFont=!!ue),!j.isInternalFont&&this.options.useSystemFonts&&(j.systemFontInfo=zk(this.systemFontCache,this.idFactory,this.options.standardFontDataUrl,F,ge,r));const pe=await this.extractDataStructures(t,j);if(Array.isArray(ae)){const de=[];let O=a;for(const Y of ae){const le=this.xref.fetchIfRef(Y);typeof le=="number"&&(de[O]=le),O++}pe.widths=de}else pe.widths=this.buildCharCodeToWidth(X.widths,pe);return new Ek(F,ue,pe,this.options)}let u=e.get("FontName"),d=t.get("BaseFont");typeof u=="string"&&(u=_e.get(u)),typeof d=="string"&&(d=_e.get(d));const f=u==null?void 0:u.name,g=d==null?void 0:d.name;if(h?f||(u=_e.get(r)):f!==g&&(gn(`The FontDescriptor's FontName is "${f}" but should be the same as the Font's BaseFont "${g}".`),f&&g&&(g.startsWith(f)||!uk(f)&&uk(g))&&(u=null),u||(u=d)),!(u instanceof _e))throw new Ee("invalid font name");let m,x,p,y,w;try{if(m=e.get("FontFile","FontFile2","FontFile3"),m)if(m instanceof hn){if(m.isEmpty)throw new Ee("FontFile is empty")}else throw new Ee("FontFile should be a stream")}catch(F){if(!this.options.ignoreErrors)throw F;he(`translateFont - fetching "${u.name}" font file: "${F}".`),m=null}let v=!1,_=null,C=null;if(m){if(m.dict){const F=m.dict.get("Subtype");F instanceof _e&&(x=F.name),p=m.dict.get("Length1"),y=m.dict.get("Length2"),w=m.dict.get("Length3")}}else if(c){const F=E4(u.name);F&&(c.fontFamily=`${c.fontFamily}-PdfJS-XFA`,c.metrics=F.metrics||null,_=F.factors||null,m=await this.fetchStandardFontData(F.name),v=!!m,i=t=BR(u.name),s=!0)}else if(!h){const F=hk(u.name);F&&(m=await this.fetchStandardFontData(F),v=!!m),!v&&this.options.useSystemFonts&&(C=zk(this.systemFontCache,this.idFactory,this.options.standardFontDataUrl,u.name,F,r))}const k=Ch(t.getArray("FontMatrix"),Dd),I=p0(e.getArray("FontBBox")||t.getArray("FontBBox"),h?[0,0,0,0]:void 0);let S=e.get("Ascent");typeof S!="number"&&(S=void 0);let R=e.get("Descent");typeof R!="number"&&(R=void 0);let P=e.get("XHeight");typeof P!="number"&&(P=0);let D=e.get("CapHeight");typeof D!="number"&&(D=0);let U=e.get("Flags");Number.isInteger(U)||(U=0);let T=e.get("ItalicAngle");typeof T!="number"&&(T=0);const G={type:r,name:u.name,subtype:x,file:m,length1:p,length2:y,length3:w,isInternalFont:v,loadedName:i.loadedName,composite:s,fixedPitch:!1,fontMatrix:k,firstChar:a,lastChar:o,toUnicode:l,bbox:I,ascent:S,descent:R,xHeight:P,capHeight:D,flags:U,italicAngle:T,isType3Font:h,cssFontInfo:c,scaleFactors:_,systemFontInfo:C};if(s){const F=i.get("Encoding");F instanceof _e&&(G.cidEncoding=F.name);const X=await qx.create({encoding:F,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null});G.cMap=X,G.vertical=G.cMap.vertical}const M=await this.extractDataStructures(t,G);return this.extractWidths(t,e,M),new Ek(u.name,m,M,this.options)}static buildFontPaths(e,t,i,s){function r(a){const o=`${e.loadedName}_path_${a}`;try{if(e.renderer.hasBuiltPath(a))return;i.send("commonobj",[o,"FontPath",e.renderer.getPathJs(a)])}catch(l){if(s.ignoreErrors){he(`buildFontPaths - ignoring ${o} glyph: "${l}".`);return}throw l}}for(const a of t){r(a.fontChar);const o=a.accent;o!=null&&o.fontChar&&r(o.fontChar)}}static get fallbackFontDict(){const e=new fe;return e.set("BaseFont",_e.get("Helvetica")),e.set("Type",_e.get("FallbackType")),e.set("Subtype",_e.get("FallbackType")),e.set("Encoding",_e.get("WinAnsiEncoding")),Ze(this,"fallbackFontDict",e)}}var Xb,Rd,Hg,VR,qR;class Ew{constructor({loadedName:e,font:t,dict:i}){B(this,Hg);B(this,Xb,!1);B(this,Rd,null);this.loadedName=e,this.font=t,this.dict=i,this.type3Dependencies=t.isType3Font?new Set:null}send(e){b(this,Xb)||(N(this,Xb,!0),e.send("commonobj",[this.loadedName,"Font",this.font.exportData()]))}fallback(e,t){this.font.data&&(this.font.disableFontFace=!0,Sg.buildFontPaths(this.font,this.font.glyphCacheValues,e,t))}loadType3Data(e,t,i){if(b(this,Rd))return b(this,Rd);const{font:s,type3Dependencies:r}=this;Bs(s.isType3Font,"Must be a Type3 font.");const a=e.clone({ignoreErrors:!1}),o=new Ji(e.type3FontRefs);this.dict.objId&&!o.has(this.dict.objId)&&o.put(this.dict.objId),a.type3FontRefs=o;let l=Promise.resolve();const c=this.dict.get("CharProcs"),h=this.dict.get("Resources")||t,u=Object.create(null),[d,f,g,m]=s.bbox,x=g-d,p=m-f,y=Math.hypot(x,p);for(const w of c.getKeys())l=l.then(()=>{const v=c.get(w),_=new Ar;return a.getOperatorList({stream:v,task:i,resources:h,operatorList:_}).then(()=>{switch(_.fnArray[0]){case ne.setCharWidthAndBounds:L(this,Hg,VR).call(this,_,y);break;case ne.setCharWidth:y||L(this,Hg,qR).call(this,_);break}u[w]=_.getIR();for(const C of _.dependencies)r.add(C)}).catch(function(C){he(`Type3 font resource "${w}" is not available.`);const k=new Ar;u[w]=k.getIR()})});return N(this,Rd,l.then(()=>{s.charProcOperatorList=u,this._bbox&&(s.isCharBBox=!0,s.bbox=this._bbox)})),b(this,Rd)}}Xb=new WeakMap,Rd=new WeakMap,Hg=new WeakSet,VR=function(e,t=NaN){const i=Dn.normalizeRect(e.argsArray[0].slice(2)),s=i[2]-i[0],r=i[3]-i[1],a=Math.hypot(s,r);s===0||r===0?(e.fnArray.splice(0,1),e.argsArray.splice(0,1)):(t===0||Math.round(a/t)>=10)&&(this._bbox??(this._bbox=[1/0,1/0,-1/0,-1/0]),Dn.rectBoundingBox(...i,this._bbox));let o=0,l=e.length;for(;o<l;){switch(e.fnArray[o]){case ne.setCharWidthAndBounds:break;case ne.setStrokeColorSpace:case ne.setFillColorSpace:case ne.setStrokeColor:case ne.setStrokeColorN:case ne.setFillColor:case ne.setFillColorN:case ne.setStrokeGray:case ne.setFillGray:case ne.setStrokeRGBColor:case ne.setFillRGBColor:case ne.setStrokeCMYKColor:case ne.setFillCMYKColor:case ne.shadingFill:case ne.setRenderingIntent:e.fnArray.splice(o,1),e.argsArray.splice(o,1),l--;continue;case ne.setGState:const[c]=e.argsArray[o];let h=0,u=c.length;for(;h<u;){const[d]=c[h];switch(d){case"TR":case"TR2":case"HT":case"BG":case"BG2":case"UCR":case"UCR2":c.splice(h,1),u--;continue}h++}break}o++}},qR=function(e){let t=1;const i=e.length;for(;t<i;){switch(e.fnArray[t]){case ne.constructPath:const s=e.argsArray[t][2];this._bbox??(this._bbox=[1/0,1/0,-1/0,-1/0]),Dn.rectBoundingBox(...s,this._bbox);break}t++}};class i3{constructor(e=new WR){this.state=e,this.stateStack=[]}save(){const e=this.state;this.stateStack.push(this.state),this.state=e.clone()}restore(){const e=this.stateStack.pop();e&&(this.state=e)}transform(e){this.state.ctm=Dn.transform(this.state.ctm,e)}}class oG{constructor(){this.ctm=new Float32Array(el),this.fontName=null,this.fontSize=0,this.loadedName=null,this.font=null,this.fontMatrix=Dd,this.textMatrix=el.slice(),this.textLineMatrix=el.slice(),this.charSpacing=0,this.wordSpacing=0,this.leading=0,this.textHScale=1,this.textRise=0}setTextMatrix(e,t,i,s,r,a){const o=this.textMatrix;o[0]=e,o[1]=t,o[2]=i,o[3]=s,o[4]=r,o[5]=a}setTextLineMatrix(e,t,i,s,r,a){const o=this.textLineMatrix;o[0]=e,o[1]=t,o[2]=i,o[3]=s,o[4]=r,o[5]=a}translateTextMatrix(e,t){const i=this.textMatrix;i[4]=i[0]*e+i[2]*t+i[4],i[5]=i[1]*e+i[3]*t+i[5]}translateTextLineMatrix(e,t){const i=this.textLineMatrix;i[4]=i[0]*e+i[2]*t+i[4],i[5]=i[1]*e+i[3]*t+i[5]}carriageReturn(){this.translateTextLineMatrix(0,-this.leading),this.textMatrix=this.textLineMatrix.slice()}clone(){const e=Object.create(this);return e.textMatrix=this.textMatrix.slice(),e.textLineMatrix=this.textLineMatrix.slice(),e.fontMatrix=this.fontMatrix.slice(),e}}class WR{constructor(){this.ctm=new Float32Array(el),this.font=null,this.textRenderingMode=WT.FILL,this._fillColorSpace=this._strokeColorSpace=Nn.gray,this.patternFillColorSpace=null,this.patternStrokeColorSpace=null,this.currentPointX=this.currentPointY=0,this.pathMinMax=new Float32Array([1/0,1/0,-1/0,-1/0]),this.pathBuffer=[]}get fillColorSpace(){return this._fillColorSpace}set fillColorSpace(e){this._fillColorSpace=this.patternFillColorSpace=e}get strokeColorSpace(){return this._strokeColorSpace}set strokeColorSpace(e){this._strokeColorSpace=this.patternStrokeColorSpace=e}clone({newPath:e=!1}={}){const t=Object.create(this);return e&&(t.pathBuffer=[],t.pathMinMax=new Float32Array([1/0,1/0,-1/0,-1/0])),t}}const qf=class qf{static get opMap(){return Ze(this,"opMap",Object.assign(Object.create(null),{w:{id:ne.setLineWidth,numArgs:1,variableArgs:!1},J:{id:ne.setLineCap,numArgs:1,variableArgs:!1},j:{id:ne.setLineJoin,numArgs:1,variableArgs:!1},M:{id:ne.setMiterLimit,numArgs:1,variableArgs:!1},d:{id:ne.setDash,numArgs:2,variableArgs:!1},ri:{id:ne.setRenderingIntent,numArgs:1,variableArgs:!1},i:{id:ne.setFlatness,numArgs:1,variableArgs:!1},gs:{id:ne.setGState,numArgs:1,variableArgs:!1},q:{id:ne.save,numArgs:0,variableArgs:!1},Q:{id:ne.restore,numArgs:0,variableArgs:!1},cm:{id:ne.transform,numArgs:6,variableArgs:!1},m:{id:ne.moveTo,numArgs:2,variableArgs:!1},l:{id:ne.lineTo,numArgs:2,variableArgs:!1},c:{id:ne.curveTo,numArgs:6,variableArgs:!1},v:{id:ne.curveTo2,numArgs:4,variableArgs:!1},y:{id:ne.curveTo3,numArgs:4,variableArgs:!1},h:{id:ne.closePath,numArgs:0,variableArgs:!1},re:{id:ne.rectangle,numArgs:4,variableArgs:!1},S:{id:ne.stroke,numArgs:0,variableArgs:!1},s:{id:ne.closeStroke,numArgs:0,variableArgs:!1},f:{id:ne.fill,numArgs:0,variableArgs:!1},F:{id:ne.fill,numArgs:0,variableArgs:!1},"f*":{id:ne.eoFill,numArgs:0,variableArgs:!1},B:{id:ne.fillStroke,numArgs:0,variableArgs:!1},"B*":{id:ne.eoFillStroke,numArgs:0,variableArgs:!1},b:{id:ne.closeFillStroke,numArgs:0,variableArgs:!1},"b*":{id:ne.closeEOFillStroke,numArgs:0,variableArgs:!1},n:{id:ne.endPath,numArgs:0,variableArgs:!1},W:{id:ne.clip,numArgs:0,variableArgs:!1},"W*":{id:ne.eoClip,numArgs:0,variableArgs:!1},BT:{id:ne.beginText,numArgs:0,variableArgs:!1},ET:{id:ne.endText,numArgs:0,variableArgs:!1},Tc:{id:ne.setCharSpacing,numArgs:1,variableArgs:!1},Tw:{id:ne.setWordSpacing,numArgs:1,variableArgs:!1},Tz:{id:ne.setHScale,numArgs:1,variableArgs:!1},TL:{id:ne.setLeading,numArgs:1,variableArgs:!1},Tf:{id:ne.setFont,numArgs:2,variableArgs:!1},Tr:{id:ne.setTextRenderingMode,numArgs:1,variableArgs:!1},Ts:{id:ne.setTextRise,numArgs:1,variableArgs:!1},Td:{id:ne.moveText,numArgs:2,variableArgs:!1},TD:{id:ne.setLeadingMoveText,numArgs:2,variableArgs:!1},Tm:{id:ne.setTextMatrix,numArgs:6,variableArgs:!1},"T*":{id:ne.nextLine,numArgs:0,variableArgs:!1},Tj:{id:ne.showText,numArgs:1,variableArgs:!1},TJ:{id:ne.showSpacedText,numArgs:1,variableArgs:!1},"'":{id:ne.nextLineShowText,numArgs:1,variableArgs:!1},'"':{id:ne.nextLineSetSpacingShowText,numArgs:3,variableArgs:!1},d0:{id:ne.setCharWidth,numArgs:2,variableArgs:!1},d1:{id:ne.setCharWidthAndBounds,numArgs:6,variableArgs:!1},CS:{id:ne.setStrokeColorSpace,numArgs:1,variableArgs:!1},cs:{id:ne.setFillColorSpace,numArgs:1,variableArgs:!1},SC:{id:ne.setStrokeColor,numArgs:4,variableArgs:!0},SCN:{id:ne.setStrokeColorN,numArgs:33,variableArgs:!0},sc:{id:ne.setFillColor,numArgs:4,variableArgs:!0},scn:{id:ne.setFillColorN,numArgs:33,variableArgs:!0},G:{id:ne.setStrokeGray,numArgs:1,variableArgs:!1},g:{id:ne.setFillGray,numArgs:1,variableArgs:!1},RG:{id:ne.setStrokeRGBColor,numArgs:3,variableArgs:!1},rg:{id:ne.setFillRGBColor,numArgs:3,variableArgs:!1},K:{id:ne.setStrokeCMYKColor,numArgs:4,variableArgs:!1},k:{id:ne.setFillCMYKColor,numArgs:4,variableArgs:!1},sh:{id:ne.shadingFill,numArgs:1,variableArgs:!1},BI:{id:ne.beginInlineImage,numArgs:0,variableArgs:!1},ID:{id:ne.beginImageData,numArgs:0,variableArgs:!1},EI:{id:ne.endInlineImage,numArgs:1,variableArgs:!1},Do:{id:ne.paintXObject,numArgs:1,variableArgs:!1},MP:{id:ne.markPoint,numArgs:1,variableArgs:!1},DP:{id:ne.markPointProps,numArgs:2,variableArgs:!1},BMC:{id:ne.beginMarkedContent,numArgs:1,variableArgs:!1},BDC:{id:ne.beginMarkedContentProps,numArgs:2,variableArgs:!1},EMC:{id:ne.endMarkedContent,numArgs:0,variableArgs:!1},BX:{id:ne.beginCompat,numArgs:0,variableArgs:!1},EX:{id:ne.endCompat,numArgs:0,variableArgs:!1},BM:null,BD:null,true:null,fa:null,fal:null,fals:null,false:null,nu:null,nul:null,null:null}))}constructor(e,t,i=new i3){this.parser=new A0({lexer:new Wo(e,qf.opMap),xref:t}),this.stateManager=i,this.nonProcessedArgs=[],this._isPathOp=!1,this._numInvalidPathOPS=0}get savedStatesDepth(){return this.stateManager.stateStack.length}read(e){let t=e.args;for(;;){const i=this.parser.getObj();if(i instanceof is){const s=i.cmd,r=qf.opMap[s];if(!r){he(`Unknown command "${s}".`);continue}const a=r.id,o=r.numArgs;let l=t!==null?t.length:0;if(this._isPathOp||(this._numInvalidPathOPS=0),this._isPathOp=a>=ne.moveTo&&a<=ne.endPath,r.variableArgs)l>o&&gn(`Command ${s}: expected [0, ${o}] args, but received ${l} args.`);else{if(l!==o){const c=this.nonProcessedArgs;for(;l>o;)c.push(t.shift()),l--;for(;l<o&&c.length!==0;)t===null&&(t=[]),t.unshift(c.pop()),l++}if(l<o){const c=`command ${s}: expected ${o} args, but received ${l} args.`;if(this._isPathOp&&++this._numInvalidPathOPS>qf.MAX_INVALID_PATH_OPS)throw new Ee(`Invalid ${c}`);he(`Skipping ${c}`),t!==null&&(t.length=0);continue}}return this.preprocessCommand(a,t),e.fn=a,e.args=t,!0}if(i===Ls)return!1;if(i!==null&&(t===null&&(t=[]),t.push(i),t.length>33))throw new Ee("Too many arguments")}}preprocessCommand(e,t){switch(e|0){case ne.save:this.stateManager.save();break;case ne.restore:this.stateManager.restore();break;case ne.transform:this.stateManager.transform(t);break}}};ze(qf,"MAX_INVALID_PATH_OPS",10);let Ig=qf;class lG extends Ig{constructor(e){super(new Yr(e))}parse(){const e={fn:0,args:[]},t={fontSize:0,fontName:"",fontColor:new Uint8ClampedArray(3)};try{for(;e.args.length=0,!!this.read(e);){if(this.savedStatesDepth!==0)continue;const{fn:i,args:s}=e;switch(i|0){case ne.setFont:const[r,a]=s;r instanceof _e&&(t.fontName=r.name),typeof a=="number"&&a>0&&(t.fontSize=a);break;case ne.setFillRGBColor:Nn.rgb.getRgbItem(s,0,t.fontColor,0);break;case ne.setFillGray:Nn.gray.getRgbItem(s,0,t.fontColor,0);break;case ne.setFillCMYKColor:Nn.cmyk.getRgbItem(s,0,t.fontColor,0);break}}}catch(i){he(`parseDefaultAppearance - ignoring errors: "${i}".`)}return t}}function R4(n){return new lG(n).parse()}class cG extends Ig{constructor(e,t,i,s){var r;super(e),this.stream=e,this.evaluatorOptions=t,this.xref=i,this.globalColorSpaceCache=s,this.resources=(r=e.dict)==null?void 0:r.get("Resources")}parse(){const e={fn:0,args:[]};let t={scaleFactor:1,fontSize:0,fontName:"",fontColor:new Uint8ClampedArray(3),fillColorSpace:Nn.gray},i=!1;const s=[];try{for(;e.args.length=0,!(i||!this.read(e));){const{fn:r,args:a}=e;switch(r|0){case ne.save:s.push({scaleFactor:t.scaleFactor,fontSize:t.fontSize,fontName:t.fontName,fontColor:t.fontColor.slice(),fillColorSpace:t.fillColorSpace});break;case ne.restore:t=s.pop()||t;break;case ne.setTextMatrix:t.scaleFactor*=Math.hypot(a[0],a[1]);break;case ne.setFont:const[o,l]=a;o instanceof _e&&(t.fontName=o.name),typeof l=="number"&&l>0&&(t.fontSize=l*t.scaleFactor);break;case ne.setFillColorSpace:t.fillColorSpace=Nn.parse({cs:a[0],xref:this.xref,resources:this.resources,pdfFunctionFactory:this._pdfFunctionFactory,globalColorSpaceCache:this.globalColorSpaceCache,localColorSpaceCache:this._localColorSpaceCache});break;case ne.setFillColor:t.fillColorSpace.getRgbItem(a,0,t.fontColor,0);break;case ne.setFillRGBColor:Nn.rgb.getRgbItem(a,0,t.fontColor,0);break;case ne.setFillGray:Nn.gray.getRgbItem(a,0,t.fontColor,0);break;case ne.setFillCMYKColor:Nn.cmyk.getRgbItem(a,0,t.fontColor,0);break;case ne.showText:case ne.showSpacedText:case ne.nextLineShowText:case ne.nextLineSetSpacingShowText:i=!0;break}}}catch(r){he(`parseAppearanceStream - ignoring errors: "${r}".`)}return this.stream.reset(),delete t.scaleFactor,delete t.fillColorSpace,t}get _localColorSpaceCache(){return Ze(this,"_localColorSpaceCache",new UR)}get _pdfFunctionFactory(){const e=new zR({xref:this.xref,isEvalSupported:this.evaluatorOptions.isEvalSupported});return Ze(this,"_pdfFunctionFactory",e)}}function hG(n,e,t,i){return new cG(n,e,t,i).parse()}function ic(n,e){if(n[0]===n[1]&&n[1]===n[2]){const t=n[0]/255;return`${_n(t)} ${e?"g":"G"}`}return Array.from(n,t=>_n(t/255)).join(" ")+` ${e?"rg":"RG"}`}function uG({fontSize:n,fontName:e,fontColor:t}){return`/${m4(e)} ${n} Tf ${ic(t,!0)}`}class Gl{constructor(e,t){this.xref=e,this.widths=null,this.firstChar=1/0,this.lastChar=-1/0,this.fontFamily=t;const i=new OffscreenCanvas(1,1);this.ctxMeasure=i.getContext("2d",{willReadFrequently:!0}),Gl._fontNameId||(Gl._fontNameId=1),this.fontName=_e.get(`InvalidPDFjsFont_${t}_${Gl._fontNameId++}`)}get fontDescriptorRef(){if(!Gl._fontDescriptorRef){const e=new fe(this.xref);e.set("Type",_e.get("FontDescriptor")),e.set("FontName",this.fontName),e.set("FontFamily","MyriadPro Regular"),e.set("FontBBox",[0,0,0,0]),e.set("FontStretch",_e.get("Normal")),e.set("FontWeight",400),e.set("ItalicAngle",0),Gl._fontDescriptorRef=this.xref.getNewPersistentRef(e)}return Gl._fontDescriptorRef}get descendantFontRef(){const e=new fe(this.xref);e.set("BaseFont",this.fontName),e.set("Type",_e.get("Font")),e.set("Subtype",_e.get("CIDFontType0")),e.set("CIDToGIDMap",_e.get("Identity")),e.set("FirstChar",this.firstChar),e.set("LastChar",this.lastChar),e.set("FontDescriptor",this.fontDescriptorRef),e.set("DW",1e3);const t=[],i=[...this.widths.entries()].sort();let s=null,r=null;for(const[o,l]of i){if(!s){s=o,r=[l];continue}o===s+r.length?r.push(l):(t.push(s,r),s=o,r=[l])}s&&t.push(s,r),e.set("W",t);const a=new fe(this.xref);return a.set("Ordering","Identity"),a.set("Registry","Adobe"),a.set("Supplement",0),e.set("CIDSystemInfo",a),this.xref.getNewPersistentRef(e)}get baseFontRef(){const e=new fe(this.xref);return e.set("BaseFont",this.fontName),e.set("Type",_e.get("Font")),e.set("Subtype",_e.get("Type0")),e.set("Encoding",_e.get("Identity-H")),e.set("DescendantFonts",[this.descendantFontRef]),e.set("ToUnicode",_e.get("Identity-H")),this.xref.getNewPersistentRef(e)}get resources(){const e=new fe(this.xref),t=new fe(this.xref);return t.set(this.fontName.name,this.baseFontRef),e.set("Font",t),e}_createContext(){return this.widths=new Map,this.ctxMeasure.font=`1000px ${this.fontFamily}`,this.ctxMeasure}createFontResources(e){const t=this._createContext();for(const i of e.split(/\r\n?|\n/))for(const s of i.split("")){const r=s.charCodeAt(0);if(this.widths.has(r))continue;const a=t.measureText(s),o=Math.ceil(a.width);this.widths.set(r,o),this.firstChar=Math.min(r,this.firstChar),this.lastChar=Math.max(r,this.lastChar)}return this.resources}static getFirstPositionInfo(e,t,i){const[s,r,a,o]=e;let l=a-s,c=o-r;t%180!==0&&([l,c]=[c,l]);const h=i0*i,u=_3*i;return{coords:[0,c+u-h],bbox:[0,0,l,c],matrix:t!==0?S3(t,c,h):void 0}}createAppearance(e,t,i,s,r,a){const o=this._createContext(),l=[];let c=-1/0;for(const U of e.split(/\r\n?|\n/)){l.push(U);const T=o.measureText(U).width;c=Math.max(c,T);for(const G of hU(U)){const M=String.fromCodePoint(G);let F=this.widths.get(G);if(F===void 0){const X=o.measureText(M);F=Math.ceil(X.width),this.widths.set(G,F),this.firstChar=Math.min(G,this.firstChar),this.lastChar=Math.max(G,this.lastChar)}}}c*=s/1e3;const[h,u,d,f]=t;let g=d-h,m=f-u;i%180!==0&&([g,m]=[m,g]);let x=1;c>g&&(x=g/c);let p=1;const y=i0*s,w=_3*s,v=y*l.length;v>m&&(p=m/v);const _=Math.min(x,p),C=s*_,k=["q",`0 0 ${_n(g)} ${_n(m)} re W n`,"BT",`1 0 0 1 0 ${_n(m+w)} Tm 0 Tc ${ic(r,!0)}`,`/${this.fontName.name} ${_n(C)} Tf`],{resources:I}=this;if(a=typeof a=="number"&&a>=0&&a<=1?a:1,a!==1){k.push("/R0 gs");const U=new fe(this.xref),T=new fe(this.xref);T.set("ca",a),T.set("CA",a),T.set("Type",_e.get("ExtGState")),U.set("R0",T),I.set("ExtGState",U)}const S=_n(y);for(const U of l)k.push(`0 -${S} Td <${fU(U)}> Tj`);k.push("ET","Q");const R=k.join(`
`),P=new fe(this.xref);if(P.set("Subtype",_e.get("Form")),P.set("Type",_e.get("XObject")),P.set("BBox",[0,0,g,m]),P.set("Length",R.length),P.set("Resources",I),i){const U=S3(i,g,m);P.set("Matrix",U)}const D=new Yr(R);return D.dict=P,D}}const dG=["m/d","m/d/yy","mm/dd/yy","mm/yy","d-mmm","d-mmm-yy","dd-mmm-yy","yy-mm-dd","mmm-yy","mmmm-yy","mmm d, yyyy","mmmm d, yyyy","m/d/yy h:MM tt","m/d/yy HH:MM"],fG=["HH:MM","h:MM tt","HH:MM:ss","h:MM:ss tt"];class KR{constructor(e,t,i){this.root=e,this.xref=t,this._type=i}getAll(){const e=new Map;if(!this.root)return e;const t=this.xref,i=new Ji;i.put(this.root);const s=[this.root];for(;s.length>0;){const r=t.fetchIfRef(s.shift());if(!(r instanceof fe))continue;if(r.has("Kids")){const o=r.get("Kids");if(!Array.isArray(o))continue;for(const l of o){if(i.has(l))throw new Ee(`Duplicate entry in "${this._type}" tree.`);s.push(l),i.put(l)}continue}const a=r.get(this._type);if(Array.isArray(a))for(let o=0,l=a.length;o<l;o+=2)e.set(t.fetchIfRef(a[o]),t.fetchIfRef(a[o+1]))}return e}getRaw(e){if(!this.root)return null;const t=this.xref;let i=t.fetchIfRef(this.root),s=0;const r=10;for(;i.has("Kids");){if(++s>r)return he(`Search depth limit reached for "${this._type}" tree.`),null;const o=i.get("Kids");if(!Array.isArray(o))return null;let l=0,c=o.length-1;for(;l<=c;){const h=l+c>>1,u=t.fetchIfRef(o[h]),d=u.get("Limits");if(e<t.fetchIfRef(d[0]))c=h-1;else if(e>t.fetchIfRef(d[1]))l=h+1;else{i=u;break}}if(l>c)return null}const a=i.get(this._type);if(Array.isArray(a)){let o=0,l=a.length-2;for(;o<=l;){const c=o+l>>1,h=c+(c&1),u=t.fetchIfRef(a[h]);if(e<u)l=h-2;else if(e>u)o=h+2;else return a[h+1]}}return null}get(e){return this.xref.fetchIfRef(this.getRaw(e))}}class mf extends KR{constructor(e,t){super(e,t,"Names")}}class M3 extends KR{constructor(e,t){super(e,t,"Nums")}}function M4(){nj(),sU(),ZH(),Go.cleanup()}function Wk(n){return n instanceof fe?n.has("UF")?n.get("UF"):n.has("F")?n.get("F"):n.has("Unix")?n.get("Unix"):n.has("Mac")?n.get("Mac"):n.has("DOS")?n.get("DOS"):null:null}function gG(n){return n.substring(n.lastIndexOf("/")+1)}var Yb;class $7{constructor(e,t,i=!1){B(this,Yb,!1);e instanceof fe&&(this.xref=t,this.root=e,e.has("FS")&&(this.fs=e.get("FS")),e.has("RF")&&he("Related file specifications are not supported"),i||(e.has("EF")?N(this,Yb,!0):he("Non-embedded file specifications are not supported")))}get filename(){let e="";const t=Wk(this.root);return t&&typeof t=="string"&&(e=Tn(t,!0).replaceAll("\\\\","\\").replaceAll("\\/","/").replaceAll("\\","/")),Ze(this,"filename",e||"unnamed")}get content(){var t;if(!b(this,Yb))return null;this._contentRef||(this._contentRef=Wk((t=this.root)==null?void 0:t.get("EF")));let e=null;if(this._contentRef){const i=this.xref.fetchIfRef(this._contentRef);i instanceof hn?e=i.getBytes():he("Embedded file specification points to non-existing/invalid content")}else he("Embedded file specification does not have any content");return e}get description(){var i;let e="";const t=(i=this.root)==null?void 0:i.get("Desc");return t&&typeof t=="string"&&(e=Tn(t)),Ze(this,"description",e)}get serializable(){return{rawFilename:this.filename,filename:gG(this.filename),content:this.content,description:this.description}}}Yb=new WeakMap;const oa={NoError:0,EndOfDocument:-1,UnterminatedCdat:-2,UnterminatedXmlDeclaration:-3,UnterminatedDoctypeDeclaration:-4,UnterminatedComment:-5,MalformedElement:-6,OutOfMemory:-7,UnterminatedAttributeValue:-8,UnterminatedElement:-9,ElementNeverBegun:-10};function Tf(n,e){const t=n[e];return t===" "||t===`
`||t==="\r"||t==="	"}function mG(n){for(let e=0,t=n.length;e<t;e++)if(!Tf(n,e))return!1;return!0}class XR{_resolveEntities(e){return e.replaceAll(/&([^;]+);/g,(t,i)=>{if(i.substring(0,2)==="#x")return String.fromCodePoint(parseInt(i.substring(2),16));if(i.substring(0,1)==="#")return String.fromCodePoint(parseInt(i.substring(1),10));switch(i){case"lt":return"<";case"gt":return">";case"amp":return"&";case"quot":return'"';case"apos":return"'"}return this.onResolveEntity(i)})}_parseContent(e,t){const i=[];let s=t;function r(){for(;s<e.length&&Tf(e,s);)++s}for(;s<e.length&&!Tf(e,s)&&e[s]!==">"&&e[s]!=="/";)++s;const a=e.substring(t,s);for(r();s<e.length&&e[s]!==">"&&e[s]!=="/"&&e[s]!=="?";){r();let o="",l="";for(;s<e.length&&!Tf(e,s)&&e[s]!=="=";)o+=e[s],++s;if(r(),e[s]!=="=")return null;++s,r();const c=e[s];if(c!=='"'&&c!=="'")return null;const h=e.indexOf(c,++s);if(h<0)return null;l=e.substring(s,h),i.push({name:o,value:this._resolveEntities(l)}),s=h+1,r()}return{name:a,attributes:i,parsed:s-t}}_parseProcessingInstruction(e,t){let i=t;function s(){for(;i<e.length&&Tf(e,i);)++i}for(;i<e.length&&!Tf(e,i)&&e[i]!==">"&&e[i]!=="?"&&e[i]!=="/";)++i;const r=e.substring(t,i);s();const a=i;for(;i<e.length&&(e[i]!=="?"||e[i+1]!==">");)++i;const o=e.substring(a,i);return{name:r,value:o,parsed:i-t}}parseXml(e){let t=0;for(;t<e.length;){const i=e[t];let s=t;if(i==="<"){++s;const r=e[s];let a;switch(r){case"/":if(++s,a=e.indexOf(">",s),a<0){this.onError(oa.UnterminatedElement);return}this.onEndElement(e.substring(s,a)),s=a+1;break;case"?":++s;const o=this._parseProcessingInstruction(e,s);if(e.substring(s+o.parsed,s+o.parsed+2)!=="?>"){this.onError(oa.UnterminatedXmlDeclaration);return}this.onPi(o.name,o.value),s+=o.parsed+2;break;case"!":if(e.substring(s+1,s+3)==="--"){if(a=e.indexOf("-->",s+3),a<0){this.onError(oa.UnterminatedComment);return}this.onComment(e.substring(s+3,a)),s=a+3}else if(e.substring(s+1,s+8)==="[CDATA["){if(a=e.indexOf("]]>",s+8),a<0){this.onError(oa.UnterminatedCdat);return}this.onCdata(e.substring(s+8,a)),s=a+3}else if(e.substring(s+1,s+8)==="DOCTYPE"){const h=e.indexOf("[",s+8);let u=!1;if(a=e.indexOf(">",s+8),a<0){this.onError(oa.UnterminatedDoctypeDeclaration);return}if(h>0&&a>h){if(a=e.indexOf("]>",s+8),a<0){this.onError(oa.UnterminatedDoctypeDeclaration);return}u=!0}const d=e.substring(s+8,a+(u?1:0));this.onDoctype(d),s=a+(u?2:1)}else{this.onError(oa.MalformedElement);return}break;default:const l=this._parseContent(e,s);if(l===null){this.onError(oa.MalformedElement);return}let c=!1;if(e.substring(s+l.parsed,s+l.parsed+2)==="/>")c=!0;else if(e.substring(s+l.parsed,s+l.parsed+1)!==">"){this.onError(oa.UnterminatedElement);return}this.onBeginElement(l.name,l.attributes,c),s+=l.parsed+(c?2:1);break}}else{for(;s<e.length&&e[s]!=="<";)s++;const r=e.substring(t,s);this.onText(this._resolveEntities(r))}t=s}}onResolveEntity(e){return`&${e};`}onPi(e,t){}onComment(e){}onCdata(e){}onDoctype(e){}onText(e){}onBeginElement(e,t,i){}onEndElement(e){}onError(e){}}class pp{constructor(e,t){this.nodeName=e,this.nodeValue=t,Object.defineProperty(this,"parentNode",{value:null,writable:!0})}get firstChild(){var e;return(e=this.childNodes)==null?void 0:e[0]}get nextSibling(){const e=this.parentNode.childNodes;if(!e)return;const t=e.indexOf(this);if(t!==-1)return e[t+1]}get textContent(){return this.childNodes?this.childNodes.map(e=>e.textContent).join(""):this.nodeValue||""}get children(){return this.childNodes||[]}hasChildNodes(){var e;return((e=this.childNodes)==null?void 0:e.length)>0}searchNode(e,t){var a;if(t>=e.length)return this;const i=e[t];if(i.name.startsWith("#")&&t<e.length-1)return this.searchNode(e,t+1);const s=[];let r=this;for(;;){if(i.name===r.nodeName)if(i.pos===0){const o=r.searchNode(e,t+1);if(o!==null)return o}else{if(s.length===0)return null;{const[o]=s.pop();let l=0;for(const c of o.childNodes)if(i.name===c.nodeName){if(l===i.pos)return c.searchNode(e,t+1);l++}return r.searchNode(e,t+1)}}if(((a=r.childNodes)==null?void 0:a.length)>0)s.push([r,0]),r=r.childNodes[0];else{if(s.length===0)return null;for(;s.length!==0;){const[o,l]=s.pop(),c=l+1;if(c<o.childNodes.length){s.push([o,c]),r=o.childNodes[c];break}}if(s.length===0)return null}}}dump(e){if(this.nodeName==="#text"){e.push(Qf(this.nodeValue));return}if(e.push(`<${this.nodeName}`),this.attributes)for(const t of this.attributes)e.push(` ${t.name}="${Qf(t.value)}"`);if(this.hasChildNodes()){e.push(">");for(const t of this.childNodes)t.dump(e);e.push(`</${this.nodeName}>`)}else this.nodeValue?e.push(`>${Qf(this.nodeValue)}</${this.nodeName}>`):e.push("/>")}}class ny extends XR{constructor({hasAttributes:e=!1,lowerCaseName:t=!1}){super(),this._currentFragment=null,this._stack=null,this._errorCode=oa.NoError,this._hasAttributes=e,this._lowerCaseName=t}parseFromString(e){if(this._currentFragment=[],this._stack=[],this._errorCode=oa.NoError,this.parseXml(e),this._errorCode!==oa.NoError)return;const[t]=this._currentFragment;if(t)return{documentElement:t}}onText(e){if(mG(e))return;const t=new pp("#text",e);this._currentFragment.push(t)}onCdata(e){const t=new pp("#text",e);this._currentFragment.push(t)}onBeginElement(e,t,i){this._lowerCaseName&&(e=e.toLowerCase());const s=new pp(e);s.childNodes=[],this._hasAttributes&&(s.attributes=t),this._currentFragment.push(s),!i&&(this._stack.push(this._currentFragment),this._currentFragment=s.childNodes)}onEndElement(e){this._currentFragment=this._stack.pop()||[];const t=this._currentFragment.at(-1);if(!t)return null;for(const i of t.childNodes)i.parentNode=t;return t}onError(e){this._errorCode=e}}class pG{constructor(e){e=this._repair(e);const i=new ny({lowerCaseName:!0}).parseFromString(e);this._metadataMap=new Map,this._data=e,i&&this._parse(i)}_repair(e){return e.replace(/^[^<]+/,"").replaceAll(/>\\376\\377([^<]+)/g,function(t,i){const s=i.replaceAll(/\\([0-3])([0-7])([0-7])/g,function(a,o,l,c){return String.fromCharCode(o*64+l*8+c*1)}).replaceAll(/&(amp|apos|gt|lt|quot);/g,function(a,o){switch(o){case"amp":return"&";case"apos":return"'";case"gt":return">";case"lt":return"<";case"quot":return'"'}throw new Error(`_repair: ${o} isn't defined.`)}),r=[">"];for(let a=0,o=s.length;a<o;a+=2){const l=s.charCodeAt(a)*256+s.charCodeAt(a+1);l>=32&&l<127&&l!==60&&l!==62&&l!==38?r.push(String.fromCharCode(l)):r.push("&#x"+(65536+l).toString(16).substring(1)+";")}return r.join("")})}_getSequence(e){const t=e.nodeName;return t!=="rdf:bag"&&t!=="rdf:seq"&&t!=="rdf:alt"?null:e.childNodes.filter(i=>i.nodeName==="rdf:li")}_parseArray(e){if(!e.hasChildNodes())return;const[t]=e.childNodes,i=this._getSequence(t)||[];this._metadataMap.set(e.nodeName,i.map(s=>s.textContent.trim()))}_parse(e){let t=e.documentElement;if(t.nodeName!=="rdf:rdf")for(t=t.firstChild;t&&t.nodeName!=="rdf:rdf";)t=t.nextSibling;if(!(!t||t.nodeName!=="rdf:rdf"||!t.hasChildNodes())){for(const i of t.childNodes)if(i.nodeName==="rdf:description")for(const s of i.childNodes){const r=s.nodeName;switch(r){case"#text":continue;case"dc:creator":case"dc:subject":this._parseArray(s);continue}this._metadataMap.set(r,s.textContent.trim())}}}get serializable(){return{parsedData:this._metadataMap,rawData:this._data}}}const Kk=40,co={PAGE_CONTENT:1,STREAM_CONTENT:2,OBJECT:3,ANNOTATION:4,ELEMENT:5};var F5,YR,wo,e6,t6,JR,ZR;const pu=class pu{constructor(e,t,i){B(this,F5);this.xref=e,this.dict=t,this.ref=i instanceof st?i:null,this.roleMap=new Map,this.structParentIds=null}init(){this.readRoleMap()}addAnnotationIdToPage(e,t){L(this,F5,YR).call(this,e,t,co.ANNOTATION)}readRoleMap(){const e=this.dict.get("RoleMap");if(e instanceof fe)for(const[t,i]of e)i instanceof _e&&this.roleMap.set(t,i.name)}static async canCreateStructureTree({catalogRef:e,pdfManager:t,newAnnotationsByPage:i}){var a;if(!(e instanceof st))return he("Cannot save the struct tree: no catalog reference."),!1;let s=0,r=!0;for(const[o,l]of i){const{ref:c}=await t.getPage(o);if(!(c instanceof st)){he(`Cannot save the struct tree: page ${o} has no ref.`),r=!0;break}for(const h of l)(a=h.accessibilityData)!=null&&a.type&&(h.parentTreeId=s++,r=!1)}if(r){for(const o of i.values())for(const l of o)delete l.parentTreeId;return!1}return!0}static async createStructureTree({newAnnotationsByPage:e,xref:t,catalogRef:i,pdfManager:s,changes:r}){const a=await s.ensureCatalog("cloneDict"),o=new la;o.put(i,a);const l=t.getNewTemporaryRef();a.set("StructTreeRoot",l);const c=new fe(t);c.set("Type",_e.get("StructTreeRoot"));const h=t.getNewTemporaryRef();c.set("ParentTree",h);const u=[];c.set("K",u),o.put(l,c);const d=new fe(t),f=[];d.set("Nums",f);const g=await L(this,wo,e6).call(this,{newAnnotationsByPage:e,structTreeRootRef:l,structTreeRoot:null,kids:u,nums:f,xref:t,pdfManager:s,changes:r,cache:o});c.set("ParentTreeNextKey",g),o.put(h,d);for(const[m,x]of o.items())r.put(m,{data:x})}async canUpdateStructTree({pdfManager:e,newAnnotationsByPage:t}){var l,c;if(!this.ref)return he("Cannot update the struct tree: no root reference."),!1;let i=this.dict.get("ParentTreeNextKey");if(!Number.isInteger(i)||i<0)return he("Cannot update the struct tree: invalid next key."),!1;const s=this.dict.get("ParentTree");if(!(s instanceof fe))return he("Cannot update the struct tree: ParentTree isn't a dict."),!1;const r=s.get("Nums");if(!Array.isArray(r))return he("Cannot update the struct tree: nums isn't an array."),!1;const a=new M3(s,this.xref);for(const h of t.keys()){const{pageDict:u}=await e.getPage(h);if(!u.has("StructParents"))continue;const d=u.get("StructParents");if(!Number.isInteger(d)||!Array.isArray(a.get(d)))return he(`Cannot save the struct tree: page ${h} has a wrong id.`),!1}let o=!0;for(const[h,u]of t){const{pageDict:d}=await e.getPage(h);L(l=pu,wo,JR).call(l,{elements:u,xref:this.xref,pageDict:d,numberTree:a});for(const f of u)(c=f.accessibilityData)!=null&&c.type&&(f.accessibilityData.structParent>=0||(f.parentTreeId=i++),o=!1)}if(o){for(const h of t.values())for(const u of h)delete u.parentTreeId,delete u.structTreeParent;return!1}return!0}async updateStructureTree({newAnnotationsByPage:e,pdfManager:t,changes:i}){var f;const{ref:s,xref:r}=this,a=this.dict.clone(),o=new la;o.put(s,a);let l=a.getRaw("ParentTree"),c;l instanceof st?c=r.fetch(l):(c=l,l=r.getNewTemporaryRef(),a.set("ParentTree",l)),c=c.clone(),o.put(l,c);let h=c.getRaw("Nums"),u=null;h instanceof st&&(u=h,h=r.fetch(u)),h=h.slice(),u||c.set("Nums",h);const d=await L(f=pu,wo,e6).call(f,{newAnnotationsByPage:e,structTreeRootRef:s,structTreeRoot:this,kids:null,nums:h,xref:r,pdfManager:t,changes:i,cache:o});if(d!==-1){a.set("ParentTreeNextKey",d),u&&o.put(u,h);for(const[g,m]of o.items())i.put(g,{data:m})}}};F5=new WeakSet,YR=function(e,t,i){if(!(e instanceof st)||t<0)return;this.structParentIds||(this.structParentIds=new la);let s=this.structParentIds.get(e);s||(s=[],this.structParentIds.put(e,s)),s.push([t,i])},wo=new WeakSet,e6=async function({newAnnotationsByPage:e,structTreeRootRef:t,structTreeRoot:i,kids:s,nums:r,xref:a,pdfManager:o,changes:l,cache:c}){var f,g;const h=_e.get("OBJR");let u=-1,d;for(const[m,x]of e){const p=await o.getPage(m),{ref:y}=p,w=y instanceof st;for(const{accessibilityData:v,ref:_,parentTreeId:C,structTreeParent:k}of x){if(!(v!=null&&v.type))continue;const{structParent:I}=v;if(i&&Number.isInteger(I)&&I>=0){let D=(d||(d=new Map)).get(m);D===void 0&&(D=new QR(i,p.pageDict).collectObjects(y),d.set(m,D));const U=D==null?void 0:D.get(I);if(U){const T=a.fetch(U).clone();L(f=pu,wo,t6).call(f,T,v),l.put(U,{data:T});continue}}u=Math.max(u,C);const S=a.getNewTemporaryRef(),R=new fe(a);L(g=pu,wo,t6).call(g,R,v),await L(this,wo,ZR).call(this,{structTreeParent:k,tagDict:R,newTagRef:S,structTreeRootRef:t,fallbackKids:s,xref:a,cache:c});const P=new fe(a);R.set("K",P),P.set("Type",h),w&&P.set("Pg",y),P.set("Obj",_),c.put(S,R),r.push(C,S)}}return u+1},t6=function(e,{type:t,title:i,lang:s,alt:r,expanded:a,actualText:o}){e.set("S",_e.get(t)),i&&e.set("T",fo(i)),s&&e.set("Lang",fo(s)),r&&e.set("Alt",fo(r)),a&&e.set("E",fo(a)),o&&e.set("ActualText",fo(o))},JR=function({elements:e,xref:t,pageDict:i,numberTree:s}){const r=new Map;for(const c of e)if(c.structTreeParentId){const h=parseInt(c.structTreeParentId.split("_mc")[1],10);let u=r.get(h);u||(u=[],r.set(h,u)),u.push(c)}const a=i.get("StructParents");if(!Number.isInteger(a))return;const o=s.get(a),l=(c,h,u)=>{const d=r.get(c);if(d){const f=h.getRaw("P"),g=t.fetchIfRef(f);if(f instanceof st&&g instanceof fe){const m={ref:u,dict:h};for(const x of d)x.structTreeParent=m}return!0}return!1};for(const c of o){if(!(c instanceof st))continue;const h=t.fetch(c),u=h.get("K");if(Number.isInteger(u)){l(u,h,c);continue}if(Array.isArray(u))for(let d of u){if(d=t.fetchIfRef(d),Number.isInteger(d)&&l(d,h,c))break;if(!(d instanceof fe))continue;if(!Oi(d.get("Type"),"MCR"))break;const f=d.get("MCID");if(Number.isInteger(f)&&l(f,h,c))break}}},ZR=async function({structTreeParent:e,tagDict:t,newTagRef:i,structTreeRootRef:s,fallbackKids:r,xref:a,cache:o}){let l=null,c;e?({ref:l}=e,c=e.dict.getRaw("P")||s):c=s,t.set("P",c);const h=a.fetchIfRef(c);if(!h){r.push(i);return}let u=o.get(c);u||(u=h.clone(),o.put(c,u));const d=u.getRaw("K");let f=d instanceof st?o.get(d):null;if(!f){f=a.fetchIfRef(d),f=Array.isArray(f)?f.slice():[d];const m=a.getNewTemporaryRef();u.set("K",m),o.put(m,f)}const g=f.indexOf(l);f.splice(g>=0?g+1:f.length,0,i)},B(pu,wo);let Wp=pu;class bG{constructor(e,t){this.tree=e,this.xref=e.xref,this.dict=t,this.kids=[],this.parseKids()}get role(){const e=this.dict.get("S"),t=e instanceof _e?e.name:"",{root:i}=this.tree;return i.roleMap.get(t)??t}parseKids(){let e=null;const t=this.dict.getRaw("Pg");t instanceof st&&(e=t.toString());const i=this.dict.get("K");if(Array.isArray(i))for(const s of i){const r=this.parseKid(e,this.xref.fetchIfRef(s));r&&this.kids.push(r)}else{const s=this.parseKid(e,i);s&&this.kids.push(s)}}parseKid(e,t){if(Number.isInteger(t))return this.tree.pageDict.objId!==e?null:new Qx({type:co.PAGE_CONTENT,mcid:t,pageObjId:e});if(!(t instanceof fe))return null;const i=t.getRaw("Pg");i instanceof st&&(e=i.toString());const s=t.get("Type")instanceof _e?t.get("Type").name:null;if(s==="MCR"){if(this.tree.pageDict.objId!==e)return null;const r=t.getRaw("Stm");return new Qx({type:co.STREAM_CONTENT,refObjId:r instanceof st?r.toString():null,pageObjId:e,mcid:t.get("MCID")})}if(s==="OBJR"){if(this.tree.pageDict.objId!==e)return null;const r=t.getRaw("Obj");return new Qx({type:co.OBJECT,refObjId:r instanceof st?r.toString():null,pageObjId:e})}return new Qx({type:co.ELEMENT,dict:t})}}class Qx{constructor({type:e,dict:t=null,mcid:i=null,pageObjId:s=null,refObjId:r=null}){this.type=e,this.dict=t,this.mcid=i,this.pageObjId=s,this.refObjId=r,this.parentNode=null}}class QR{constructor(e,t){this.root=e,this.xref=(e==null?void 0:e.xref)??null,this.rootDict=(e==null?void 0:e.dict)??null,this.pageDict=t,this.nodes=[]}collectObjects(e){var a;if(!this.root||!this.rootDict||!(e instanceof st))return null;const t=this.rootDict.get("ParentTree");if(!t)return null;const i=(a=this.root.structParentIds)==null?void 0:a.get(e);if(!i)return null;const s=new Map,r=new M3(t,this.xref);for(const[o]of i){const l=r.getRaw(o);l instanceof st&&s.set(o,l)}return s}parse(e){var o,l;if(!this.root||!this.rootDict||!(e instanceof st))return;const t=this.rootDict.get("ParentTree");if(!t)return;const i=this.pageDict.get("StructParents"),s=(o=this.root.structParentIds)==null?void 0:o.get(e);if(!Number.isInteger(i)&&!s)return;const r=new Map,a=new M3(t,this.xref);if(Number.isInteger(i)){const c=a.get(i);if(Array.isArray(c))for(const h of c)h instanceof st&&this.addNode(this.xref.fetch(h),r)}if(s)for(const[c,h]of s){const u=a.get(c);if(u){const d=this.addNode(this.xref.fetchIfRef(u),r);((l=d==null?void 0:d.kids)==null?void 0:l.length)===1&&d.kids[0].type===co.OBJECT&&(d.kids[0].type=h)}}}addNode(e,t,i=0){if(i>Kk)return he("StructTree MAX_DEPTH reached."),null;if(!(e instanceof fe))return null;if(t.has(e))return t.get(e);const s=new bG(this,e);t.set(e,s);const r=e.get("P");if(!(r instanceof fe)||Oi(r.get("Type"),"StructTreeRoot"))return this.addTopLevelNode(e,s)||t.delete(e),s;const a=this.addNode(r,t,i+1);if(!a)return s;let o=!1;for(const l of a.kids)l.type===co.ELEMENT&&l.dict===e&&(l.parentNode=s,o=!0);return o||t.delete(e),s}addTopLevelNode(e,t){const i=this.rootDict.get("K");if(!i)return!1;if(i instanceof fe)return i.objId!==e.objId?!1:(this.nodes[0]=t,!0);if(!Array.isArray(i))return!0;let s=!1;for(let r=0;r<i.length;r++){const a=i[r];(a==null?void 0:a.toString())===e.objId&&(this.nodes[r]=t,s=!0)}return s}get serializable(){function e(i,s,r=0){if(r>Kk){he("StructTree too deep to be fully serialized.");return}const a=Object.create(null);a.role=i.role,a.children=[],s.children.push(a);let o=i.dict.get("Alt");typeof o!="string"&&(o=i.dict.get("ActualText")),typeof o=="string"&&(a.alt=Tn(o));const l=i.dict.get("A");if(l instanceof fe){const h=p0(l.getArray("BBox"),null);if(h)a.bbox=h;else{const u=l.get("Width"),d=l.get("Height");typeof u=="number"&&u>0&&typeof d=="number"&&d>0&&(a.bbox=[0,0,u,d])}}const c=i.dict.get("Lang");typeof c=="string"&&(a.lang=Tn(c));for(const h of i.kids){const u=h.type===co.ELEMENT?h.parentNode:null;if(u){e(u,a,r+1);continue}else h.type===co.PAGE_CONTENT||h.type===co.STREAM_CONTENT?a.children.push({type:"content",id:`p${h.pageObjId}_mc${h.mcid}`}):h.type===co.OBJECT?a.children.push({type:"object",id:h.refObjId}):h.type===co.ANNOTATION&&a.children.push({type:"annotation",id:`${eU}${h.refObjId}`})}}const t=Object.create(null);t.children=[],t.role="Root";for(const i of this.nodes)i&&e(i,t);return t}}const xG=n=>n instanceof st,P3=tU.bind(null,xG,Oi);function Tw(n){return n instanceof fe&&(n=n.get("D")),P3(n)?n:null}function Xk(n){let e=n.get("D");if(e){if(e instanceof _e&&(e=e.name),typeof e=="string")return Tn(e,!0);if(P3(e))return JSON.stringify(e)}return null}var xg,Xn,as,$R,eM,tM,nM,iM,sM,n6,rM,aM;const B5=class B5{constructor(e,t){B(this,as);B(this,xg,null);B(this,Xn,null);ze(this,"builtInCMapCache",new Map);ze(this,"fontCache",new la);ze(this,"globalColorSpaceCache",new Gj);ze(this,"globalImageCache",new X7);ze(this,"nonBlendModesSet",new Ji);ze(this,"pageDictCache",new la);ze(this,"pageIndexCache",new la);ze(this,"pageKidsCountCache",new la);ze(this,"standardFontDataCache",new Map);ze(this,"systemFontCache",new Map);if(this.pdfManager=e,this.xref=t,N(this,Xn,t.getCatalogObj()),!(b(this,Xn)instanceof fe))throw new Ee("Catalog object is not a dictionary.");this.toplevelPagesDict}cloneDict(){return b(this,Xn).clone()}get version(){const e=b(this,Xn).get("Version");if(e instanceof _e){if(JT.test(e.name))return Ze(this,"version",e.name);he(`Invalid PDF catalog version: ${e.name}`)}return Ze(this,"version",null)}get lang(){const e=b(this,Xn).get("Lang");return Ze(this,"lang",e&&typeof e=="string"?Tn(e):null)}get needsRendering(){const e=b(this,Xn).get("NeedsRendering");return Ze(this,"needsRendering",typeof e=="boolean"?e:!1)}get collection(){let e=null;try{const t=b(this,Xn).get("Collection");t instanceof fe&&t.size>0&&(e=t)}catch(t){if(t instanceof bi)throw t;gn("Cannot fetch Collection entry; assuming no collection is present.")}return Ze(this,"collection",e)}get acroForm(){let e=null;try{const t=b(this,Xn).get("AcroForm");t instanceof fe&&t.size>0&&(e=t)}catch(t){if(t instanceof bi)throw t;gn("Cannot fetch AcroForm entry; assuming no forms are present.")}return Ze(this,"acroForm",e)}get acroFormRef(){const e=b(this,Xn).getRaw("AcroForm");return Ze(this,"acroFormRef",e instanceof st?e:null)}get metadata(){var i;const e=b(this,Xn).getRaw("Metadata");if(!(e instanceof st))return Ze(this,"metadata",null);let t=null;try{const s=this.xref.fetch(e,!((i=this.xref.encrypt)!=null&&i.encryptMetadata));if(s instanceof hn&&s.dict instanceof fe){const r=s.dict.get("Type"),a=s.dict.get("Subtype");if(Oi(r,"Metadata")&&Oi(a,"XML")){const o=Lp(s.getString());o&&(t=new pG(o).serializable)}}}catch(s){if(s instanceof bi)throw s;gn(`Skipping invalid Metadata: "${s}".`)}return Ze(this,"metadata",t)}get markInfo(){let e=null;try{e=L(this,as,$R).call(this)}catch(t){if(t instanceof bi)throw t;he("Unable to read mark info.")}return Ze(this,"markInfo",e)}get structTreeRoot(){let e=null;try{e=L(this,as,eM).call(this)}catch(t){if(t instanceof bi)throw t;he("Unable read to structTreeRoot info.")}return Ze(this,"structTreeRoot",e)}get toplevelPagesDict(){const e=b(this,Xn).get("Pages");if(!(e instanceof fe))throw new Ee("Invalid top-level pages dictionary.");return Ze(this,"toplevelPagesDict",e)}get documentOutline(){let e=null;try{e=L(this,as,tM).call(this)}catch(t){if(t instanceof bi)throw t;he("Unable to read document outline.")}return Ze(this,"documentOutline",e)}get permissions(){let e=null;try{e=L(this,as,nM).call(this)}catch(t){if(t instanceof bi)throw t;he("Unable to read permissions.")}return Ze(this,"permissions",e)}get optionalContentConfig(){let e=null;try{const t=b(this,Xn).get("OCProperties");if(!t)return Ze(this,"optionalContentConfig",null);const i=t.get("D");if(!i)return Ze(this,"optionalContentConfig",null);const s=t.get("OCGs");if(!Array.isArray(s))return Ze(this,"optionalContentConfig",null);const r=new la;for(const a of s)!(a instanceof st)||r.has(a)||r.put(a,L(this,as,iM).call(this,a));e=L(this,as,sM).call(this,i,r)}catch(t){if(t instanceof bi)throw t;he(`Unable to read optional content config: ${t}`)}return Ze(this,"optionalContentConfig",e)}setActualNumPages(e=null){N(this,xg,e)}get hasActualNumPages(){return b(this,xg)!==null}get _pagesCount(){const e=this.toplevelPagesDict.get("Count");if(!Number.isInteger(e))throw new Ee("Page count in top-level pages dictionary is not an integer.");return Ze(this,"_pagesCount",e)}get numPages(){return b(this,xg)??this._pagesCount}get destinations(){var i;const e=L(this,as,n6).call(this),t=Object.create(null);for(const s of e)if(s instanceof mf)for(const[r,a]of s.getAll()){const o=Tw(a);o&&(t[Tn(r,!0)]=o)}else if(s instanceof fe)for(const[r,a]of s){const o=Tw(a);o&&(t[i=Tn(r,!0)]||(t[i]=o))}return Ze(this,"destinations",t)}getDestination(e){if(this.hasOwnProperty("destinations"))return this.destinations[e]??null;const t=L(this,as,n6).call(this);for(const i of t)if(i instanceof mf||i instanceof fe){const s=Tw(i.get(e));if(s)return s}if(t.length){const i=this.destinations[e];if(i)return i}return null}get pageLabels(){let e=null;try{e=L(this,as,rM).call(this)}catch(t){if(t instanceof bi)throw t;he("Unable to read page labels.")}return Ze(this,"pageLabels",e)}get pageLayout(){const e=b(this,Xn).get("PageLayout");let t="";if(e instanceof _e)switch(e.name){case"SinglePage":case"OneColumn":case"TwoColumnLeft":case"TwoColumnRight":case"TwoPageLeft":case"TwoPageRight":t=e.name}return Ze(this,"pageLayout",t)}get pageMode(){const e=b(this,Xn).get("PageMode");let t="UseNone";if(e instanceof _e)switch(e.name){case"UseNone":case"UseOutlines":case"UseThumbs":case"FullScreen":case"UseOC":case"UseAttachments":t=e.name}return Ze(this,"pageMode",t)}get viewerPreferences(){const e=b(this,Xn).get("ViewerPreferences");if(!(e instanceof fe))return Ze(this,"viewerPreferences",null);let t=null;for(const[i,s]of e){let r;switch(i){case"HideToolbar":case"HideMenubar":case"HideWindowUI":case"FitWindow":case"CenterWindow":case"DisplayDocTitle":case"PickTrayByPDFSize":typeof s=="boolean"&&(r=s);break;case"NonFullScreenPageMode":if(s instanceof _e)switch(s.name){case"UseNone":case"UseOutlines":case"UseThumbs":case"UseOC":r=s.name;break;default:r="UseNone"}break;case"Direction":if(s instanceof _e)switch(s.name){case"L2R":case"R2L":r=s.name;break;default:r="L2R"}break;case"ViewArea":case"ViewClip":case"PrintArea":case"PrintClip":if(s instanceof _e)switch(s.name){case"MediaBox":case"CropBox":case"BleedBox":case"TrimBox":case"ArtBox":r=s.name;break;default:r="CropBox"}break;case"PrintScaling":if(s instanceof _e)switch(s.name){case"None":case"AppDefault":r=s.name;break;default:r="AppDefault"}break;case"Duplex":if(s instanceof _e)switch(s.name){case"Simplex":case"DuplexFlipShortEdge":case"DuplexFlipLongEdge":r=s.name;break;default:r="None"}break;case"PrintPageRange":Array.isArray(s)&&s.length%2===0&&s.every((o,l,c)=>Number.isInteger(o)&&o>0&&(l===0||o>=c[l-1])&&o<=this.numPages)&&(r=s);break;case"NumCopies":Number.isInteger(s)&&s>0&&(r=s);break;default:he(`Ignoring non-standard key in ViewerPreferences: ${i}.`);continue}if(r===void 0){he(`Bad value, for key "${i}", in ViewerPreferences: ${s}.`);continue}t??(t=Object.create(null)),t[i]=r}return Ze(this,"viewerPreferences",t)}get openAction(){const e=b(this,Xn).get("OpenAction"),t=Object.create(null);if(e instanceof fe){const i=new fe(this.xref);i.set("A",e);const s={url:null,dest:null,action:null};B5.parseDestDictionary({destDict:i,resultObj:s}),Array.isArray(s.dest)?t.dest=s.dest:s.action&&(t.action=s.action)}else P3(e)&&(t.dest=e);return Ze(this,"openAction",f4(t)>0?t:null)}get attachments(){const e=b(this,Xn).get("Names");let t=null;if(e instanceof fe&&e.has("EmbeddedFiles")){const i=new mf(e.getRaw("EmbeddedFiles"),this.xref);for(const[s,r]of i.getAll()){const a=new $7(r,this.xref);t??(t=Object.create(null)),t[Tn(s,!0)]=a.serializable}}return Ze(this,"attachments",t)}get xfaImages(){const e=b(this,Xn).get("Names");let t=null;if(e instanceof fe&&e.has("XFAImages")){const i=new mf(e.getRaw("XFAImages"),this.xref);for(const[s,r]of i.getAll())r instanceof hn&&(t??(t=new Map),t.set(Tn(s,!0),r.getBytes()))}return Ze(this,"xfaImages",t)}get jsActions(){const e=L(this,as,aM).call(this);let t=Q5(this.xref,b(this,Xn),qB);if(e){t||(t=Object.create(null));for(const[i,s]of e)i in t?t[i].push(s):t[i]=[s]}return Ze(this,"jsActions",t)}async cleanup(e=!1){M4(),this.globalColorSpaceCache.clear(),this.globalImageCache.clear(e),this.pageKidsCountCache.clear(),this.pageIndexCache.clear(),this.pageDictCache.clear(),this.nonBlendModesSet.clear();for(const{dict:t}of await Promise.all(this.fontCache))delete t.cacheKey;this.fontCache.clear(),this.builtInCMapCache.clear(),this.standardFontDataCache.clear(),this.systemFontCache.clear()}async getPageDict(e){const t=[this.toplevelPagesDict],i=new Ji,s=b(this,Xn).getRaw("Pages");s instanceof st&&i.put(s);const r=this.xref,a=this.pageKidsCountCache,o=this.pageIndexCache,l=this.pageDictCache;let c=0;for(;t.length;){const h=t.pop();if(h instanceof st){const g=a.get(h);if(g>=0&&c+g<=e){c+=g;continue}if(i.has(h))throw new Ee("Pages tree contains circular reference.");i.put(h);const m=await(l.get(h)||r.fetchAsync(h));if(m instanceof fe){let x=m.getRaw("Type");if(x instanceof st&&(x=await r.fetchAsync(x)),Oi(x,"Page")||!m.has("Kids")){if(a.has(h)||a.put(h,1),o.has(h)||o.put(h,c),c===e)return[m,h];c++;continue}}t.push(m);continue}if(!(h instanceof fe))throw new Ee("Page dictionary kid reference points to wrong type of object.");const{objId:u}=h;let d=h.getRaw("Count");if(d instanceof st&&(d=await r.fetchAsync(d)),Number.isInteger(d)&&d>=0&&(u&&!a.has(u)&&a.put(u,d),c+d<=e)){c+=d;continue}let f=h.getRaw("Kids");if(f instanceof st&&(f=await r.fetchAsync(f)),!Array.isArray(f)){let g=h.getRaw("Type");if(g instanceof st&&(g=await r.fetchAsync(g)),Oi(g,"Page")||!h.has("Kids")){if(c===e)return[h,null];c++;continue}throw new Ee("Page dictionary kids object is not an array.")}for(let g=f.length-1;g>=0;g--){const m=f[g];t.push(m),h===this.toplevelPagesDict&&m instanceof st&&!l.has(m)&&l.put(m,r.fetchAsync(m))}}throw new Error(`Page index ${e} not found.`)}async getAllPageDicts(e=!1){const{ignoreErrors:t}=this.pdfManager.evaluatorOptions,i=[{currentNode:this.toplevelPagesDict,posInKids:0}],s=new Ji,r=b(this,Xn).getRaw("Pages");r instanceof st&&s.put(r);const a=new Map,o=this.xref,l=this.pageIndexCache;let c=0;function h(d,f){f&&!l.has(f)&&l.put(f,c),a.set(c++,[d,f])}function u(d){if(d instanceof kh&&!e)throw d;e&&t&&c===0&&(he(`getAllPageDicts - Skipping invalid first page: "${d}".`),d=fe.empty),a.set(c++,[d,null])}for(;i.length>0;){const d=i.at(-1),{currentNode:f,posInKids:g}=d;let m=f.getRaw("Kids");if(m instanceof st)try{m=await o.fetchAsync(m)}catch(w){u(w);break}if(!Array.isArray(m)){u(new Ee("Page dictionary kids object is not an array."));break}if(g>=m.length){i.pop();continue}const x=m[g];let p;if(x instanceof st){if(s.has(x)){u(new Ee("Pages tree contains circular reference."));break}s.put(x);try{p=await o.fetchAsync(x)}catch(w){u(w);break}}else p=x;if(!(p instanceof fe)){u(new Ee("Page dictionary kid reference points to wrong type of object."));break}let y=p.getRaw("Type");if(y instanceof st)try{y=await o.fetchAsync(y)}catch(w){u(w);break}Oi(y,"Page")||!p.has("Kids")?h(p,x instanceof st?x:null):i.push({currentNode:p,posInKids:0}),d.posInKids++}return a}getPageIndex(e){const t=this.pageIndexCache.get(e);if(t!==void 0)return Promise.resolve(t);const i=this.xref;function s(o){let l=0,c;return i.fetchAsync(o).then(function(h){if(C3(o,e)&&!YT(h,"Page")&&!(h instanceof fe&&!h.has("Type")&&h.has("Contents")))throw new Ee("The reference does not point to a /Page dictionary.");if(!h)return null;if(!(h instanceof fe))throw new Ee("Node must be a dictionary.");return c=h.getRaw("Parent"),h.getAsync("Parent")}).then(function(h){if(!h)return null;if(!(h instanceof fe))throw new Ee("Parent must be a dictionary.");return h.getAsync("Kids")}).then(function(h){if(!h)return null;const u=[];let d=!1;for(const f of h){if(!(f instanceof st))throw new Ee("Kid must be a reference.");if(C3(f,o)){d=!0;break}u.push(i.fetchAsync(f).then(function(g){if(!(g instanceof fe))throw new Ee("Kid node must be a dictionary.");g.has("Count")?l+=g.get("Count"):l++}))}if(!d)throw new Ee("Kid reference not found in parent's kids.");return Promise.all(u).then(()=>[l,c])})}let r=0;const a=o=>s(o).then(l=>{if(!l)return this.pageIndexCache.put(e,r),r;const[c,h]=l;return r+=c,a(h)});return a(e)}get baseUrl(){const e=b(this,Xn).get("URI");if(e instanceof fe){const t=e.get("Base");if(typeof t=="string"){const i=k3(t,null,{tryConvertEncoding:!0});if(i)return Ze(this,"baseUrl",i.href)}}return Ze(this,"baseUrl",this.pdfManager.docBaseUrl)}static parseDestDictionary({destDict:e,resultObj:t,docBaseUrl:i=null,docAttachments:s=null}){if(!(e instanceof fe)){he("parseDestDictionary: `destDict` must be a dictionary.");return}let r=e.get("A"),a,o;if(r instanceof fe||(e.has("Dest")?r=e.get("Dest"):(r=e.get("AA"),r instanceof fe&&(r.has("D")?r=r.get("D"):r.has("U")&&(r=r.get("U"))))),r instanceof fe){const l=r.get("S");if(!(l instanceof _e)){he("parseDestDictionary: Invalid type in Action dictionary.");return}const c=l.name;switch(c){case"ResetForm":const h=r.get("Flags"),u=((typeof h=="number"?h:0)&1)===0,d=[],f=[];for(const R of r.get("Fields")||[])R instanceof st?f.push(R.toString()):typeof R=="string"&&d.push(Tn(R));t.resetForm={fields:d,refs:f,include:u};break;case"URI":a=r.get("URI"),a instanceof _e&&(a="/"+a.name);break;case"GoTo":o=r.get("D");break;case"Launch":case"GoToR":const g=r.get("F");if(g instanceof fe){const R=new $7(g,null,!0),{rawFilename:P}=R.serializable;a=P}else typeof g=="string"&&(a=g);const m=Xk(r);m&&typeof a=="string"&&(a=a.split("#",1)[0]+"#"+m);const x=r.get("NewWindow");typeof x=="boolean"&&(t.newWindow=x);break;case"GoToE":const p=r.get("T");let y;if(s&&p instanceof fe){const R=p.get("R"),P=p.get("N");Oi(R,"C")&&typeof P=="string"&&(y=s[Tn(P,!0)])}if(y){t.attachment=y;const R=Xk(r);R&&(t.attachmentDest=R)}else he('parseDestDictionary - unimplemented "GoToE" action.');break;case"Named":const w=r.get("N");w instanceof _e&&(t.action=w.name);break;case"SetOCGState":const v=r.get("State"),_=r.get("PreserveRB");if(!Array.isArray(v)||v.length===0)break;const C=[];for(const R of v)if(R instanceof _e)switch(R.name){case"ON":case"OFF":case"Toggle":C.push(R.name);break}else R instanceof st&&C.push(R.toString());if(C.length!==v.length)break;t.setOCGState={state:C,preserveRB:typeof _=="boolean"?_:!0};break;case"JavaScript":const k=r.get("JS");let I;k instanceof hn?I=k.getString():typeof k=="string"&&(I=k);const S=I&&$T(Tn(I,!0));if(S){a=S.url,t.newWindow=S.newWindow;break}default:if(c==="JavaScript"||c==="SubmitForm")break;he(`parseDestDictionary - unsupported action: "${c}".`);break}}else e.has("Dest")&&(o=e.get("Dest"));if(typeof a=="string"){const l=k3(a,i,{addDefaultProtocol:!0,tryConvertEncoding:!0});l&&(t.url=l.href),t.unsafeUrl=a}o&&(o instanceof _e&&(o=o.name),typeof o=="string"?t.dest=Tn(o,!0):P3(o)&&(t.dest=o))}};xg=new WeakMap,Xn=new WeakMap,as=new WeakSet,$R=function(){const e=b(this,Xn).get("MarkInfo");if(!(e instanceof fe))return null;const t={Marked:!1,UserProperties:!1,Suspects:!1};for(const i in t){const s=e.get(i);typeof s=="boolean"&&(t[i]=s)}return t},eM=function(){const e=b(this,Xn).getRaw("StructTreeRoot"),t=this.xref.fetchIfRef(e);if(!(t instanceof fe))return null;const i=new Wp(this.xref,t,e);return i.init(),i},tM=function(){let e=b(this,Xn).get("Outlines");if(!(e instanceof fe)||(e=e.getRaw("First"),!(e instanceof st)))return null;const t={items:[]},i=[{obj:e,parent:t}],s=new Ji;s.put(e);const r=this.xref,a=new Uint8ClampedArray(3);for(;i.length>0;){const o=i.shift(),l=r.fetchIfRef(o.obj);if(l===null)continue;l.has("Title")||he("Invalid outline item encountered.");const c={url:null,dest:null,action:null};B5.parseDestDictionary({destDict:l,resultObj:c,docBaseUrl:this.baseUrl,docAttachments:this.attachments});const h=l.get("Title"),u=l.get("F")||0,d=l.getArray("C"),f=l.get("Count");let g=a;Gr(d,3)&&(d[0]!==0||d[1]!==0||d[2]!==0)&&(g=Nn.rgb.getRgb(d,0));const m={action:c.action,attachment:c.attachment,dest:c.dest,url:c.url,unsafeUrl:c.unsafeUrl,newWindow:c.newWindow,setOCGState:c.setOCGState,title:typeof h=="string"?Tn(h):"",color:g,count:Number.isInteger(f)?f:void 0,bold:!!(u&2),italic:!!(u&1),items:[]};o.parent.items.push(m),e=l.getRaw("First"),e instanceof st&&!s.has(e)&&(i.push({obj:e,parent:m}),s.put(e)),e=l.getRaw("Next"),e instanceof st&&!s.has(e)&&(i.push({obj:e,parent:o.parent}),s.put(e))}return t.items.length>0?t.items:null},nM=function(){const e=this.xref.trailer.get("Encrypt");if(!(e instanceof fe))return null;let t=e.get("P");if(typeof t!="number")return null;t+=2**32;const i=[];for(const s in L_){const r=L_[s];t&r&&i.push(r)}return i},iM=function(e){const t=this.xref.fetch(e),i={id:e.toString(),name:null,intent:null,usage:{print:null,view:null},rbGroups:[]},s=t.get("Name");typeof s=="string"&&(i.name=Tn(s));let r=t.getArray("Intent");Array.isArray(r)||(r=[r]),r.every(h=>h instanceof _e)&&(i.intent=r.map(h=>h.name));const a=t.get("Usage");if(!(a instanceof fe))return i;const o=i.usage,l=a.get("Print");if(l instanceof fe){const h=l.get("PrintState");if(h instanceof _e)switch(h.name){case"ON":case"OFF":o.print={printState:h.name}}}const c=a.get("View");if(c instanceof fe){const h=c.get("ViewState");if(h instanceof _e)switch(h.name){case"ON":case"OFF":o.view={viewState:h.name}}}return i},sM=function(e,t){function i(h){const u=[];if(Array.isArray(h))for(const d of h)d instanceof st&&t.has(d)&&u.push(d.toString());return u}function s(h,u=0){if(!Array.isArray(h))return null;const d=[];for(const g of h){if(g instanceof st&&t.has(g)){l.put(g),d.push(g.toString());continue}const m=r(g,u);m&&d.push(m)}if(u>0)return d;const f=[];for(const[g]of t.items())l.has(g)||f.push(g.toString());return f.length&&d.push({name:null,order:f}),d}function r(h,u){if(++u>c)return he("parseNestedOrder - reached MAX_NESTED_LEVELS."),null;const d=o.fetchIfRef(h);if(!Array.isArray(d))return null;const f=o.fetchIfRef(d[0]);if(typeof f!="string")return null;const g=s(d.slice(1),u);return g!=null&&g.length?{name:Tn(f),order:g}:null}function a(h){if(Array.isArray(h))for(const u of h){const d=o.fetchIfRef(u);if(!Array.isArray(d)||!d.length)continue;const f=new Set;for(const g of d)g instanceof st&&t.has(g)&&!f.has(g.toString())&&(f.add(g.toString()),t.get(g).rbGroups.push(f))}}const o=this.xref,l=new Ji,c=10;return a(e.get("RBGroups")),{name:typeof e.get("Name")=="string"?Tn(e.get("Name")):null,creator:typeof e.get("Creator")=="string"?Tn(e.get("Creator")):null,baseState:e.get("BaseState")instanceof _e?e.get("BaseState").name:null,on:i(e.get("ON")),off:i(e.get("OFF")),order:s(e.get("Order")),groups:[...t]}},n6=function(){const e=b(this,Xn).get("Names"),t=[];return e!=null&&e.has("Dests")&&t.push(new mf(e.getRaw("Dests"),this.xref)),b(this,Xn).has("Dests")&&t.push(b(this,Xn).get("Dests")),t},rM=function(){const e=b(this,Xn).getRaw("PageLabels");if(!e)return null;const t=new Array(this.numPages);let i=null,s="";const a=new M3(e,this.xref).getAll();let o="",l=1;for(let c=0,h=this.numPages;c<h;c++){const u=a.get(c);if(u!==void 0){if(!(u instanceof fe))throw new Ee("PageLabel is not a dictionary.");if(u.has("Type")&&!Oi(u.get("Type"),"PageLabel"))throw new Ee("Invalid type in PageLabel dictionary.");if(u.has("S")){const d=u.get("S");if(!(d instanceof _e))throw new Ee("Invalid style in PageLabel dictionary.");i=d.name}else i=null;if(u.has("P")){const d=u.get("P");if(typeof d!="string")throw new Ee("Invalid prefix in PageLabel dictionary.");s=Tn(d)}else s="";if(u.has("St")){const d=u.get("St");if(!(Number.isInteger(d)&&d>=1))throw new Ee("Invalid start in PageLabel dictionary.");l=d}else l=1}switch(i){case"D":o=l;break;case"R":case"r":o=oU(l,i==="r");break;case"A":case"a":const d=26,m=i==="a"?97:65,x=l-1;o=String.fromCharCode(m+x%d).repeat(Math.floor(x/d)+1);break;default:if(i)throw new Ee(`Invalid style "${i}" in PageLabel dictionary.`);o=""}t[c]=s+o,l++}return t},aM=function(){const e=b(this,Xn).get("Names");let t=null;function i(r,a){if(!(a instanceof fe)||!Oi(a.get("S"),"JavaScript"))return;let o=a.get("JS");if(o instanceof hn)o=o.getString();else if(typeof o!="string")return;o=Tn(o,!0).replaceAll("\0",""),o&&(t||(t=new Map)).set(r,o)}if(e instanceof fe&&e.has("JavaScript")){const r=new mf(e.getRaw("JavaScript"),this.xref);for(const[a,o]of r.getAll())i(Tn(a,!0),o)}const s=b(this,Xn).get("OpenAction");return s&&i("OpenAction",s),t};let Kp=B5;function yG(n){return n instanceof st||n instanceof fe||n instanceof hn||Array.isArray(n)}function wG(n,e){if(n instanceof fe)n=n.getRawValues();else if(n instanceof hn)n=n.dict.getRawValues();else if(!Array.isArray(n))return;for(const t of n)yG(t)&&e.push(t)}var Jb,i6;const Vv=class Vv{constructor(e,t,i){B(this,Jb);ze(this,"refSet",new Ji);this.dict=e,this.keys=t,this.xref=i}async load(){const{keys:e,dict:t}=this,i=[];for(const s of e){const r=t.getRaw(s);r!==void 0&&i.push(r)}await L(this,Jb,i6).call(this,i),this.refSet=null}static async load(e,t,i){if(i.stream.isDataLoaded)return;await new Vv(e,t,i).load()}};Jb=new WeakSet,i6=async function(e){const t=[],i=[];for(;e.length;){let s=e.pop();if(s instanceof st){if(this.refSet.has(s))continue;try{this.refSet.put(s),s=this.xref.fetch(s)}catch(r){if(!(r instanceof bi)){he(`ObjectLoader.#walk - requesting all data: "${r}".`),await this.xref.stream.manager.requestAllChunks();return}t.push(s),i.push({begin:r.begin,end:r.end})}}if(s instanceof hn){const r=s.getBaseStreams();if(r){let a=!1;for(const o of r)o.isDataLoaded||(a=!0,i.push({begin:o.start,end:o.end}));a&&t.push(s)}}wG(s,e)}if(i.length){await this.xref.stream.manager.requestRanges(i);for(const s of t)s instanceof st&&this.refSet.remove(s);await L(this,Jb,i6).call(this,t)}};let Eg=Vv;const iy=Symbol(),Fd=Symbol(),Li=Symbol(),Fh=Symbol(),yo=Symbol(),Lf=Symbol(),s3=Symbol(),Xo=Symbol(),Vl=Symbol(),Le=Symbol("content"),go=Symbol("data"),Tg=Symbol(),we=Symbol("extra"),ti=Symbol(),ux=Symbol(),s6=Symbol(),oM=Symbol(),Bd=Symbol(),sy=Symbol(),Xp=Symbol(),bp=Symbol(),P4=Symbol(),cr=Symbol(),xp=Symbol(),Hs=Symbol(),Rg=Symbol(),yc=Symbol(),Zi=Symbol(),Qt=Symbol(),Xi=Symbol(),ei=Symbol(),Yp=Symbol(),Rf=Symbol(),r6=Symbol(),r3=Symbol(),N4=Symbol(),of=Symbol(),Ff=Symbol(),R0=Symbol(),yp=Symbol(),r0=Symbol(),b0=Symbol(),Jp=Symbol(),Zp=Symbol(),vG=Symbol(),Yi=Symbol("namespaceId"),On=Symbol("nodeName"),$c=Symbol(),Zl=Symbol(),a6=Symbol(),a0=Symbol(),sc=Symbol(),ca=Symbol(),Kg=Symbol(),Eh=Symbol(),lM=Symbol("root"),op=Symbol(),e0=Symbol(),o6=Symbol(),cM=Symbol(),fa=Symbol(),Vo=Symbol(),ms=Symbol(),hM=Symbol(),Gt=Symbol(),wp=Symbol(),Rn=Symbol(),qn=Symbol("uid"),cl=Symbol(),$i={config:{id:0,check:n=>n.startsWith("http://www.xfa.org/schema/xci/")},connectionSet:{id:1,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-connection-set/")},datasets:{id:2,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-data/")},form:{id:3,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-form/")},localeSet:{id:4,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-locale-set/")},pdf:{id:5,check:n=>n==="http://ns.adobe.com/xdp/pdf/"},signature:{id:6,check:n=>n==="http://www.w3.org/2000/09/xmldsig#"},sourceSet:{id:7,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-source-set/")},stylesheet:{id:8,check:n=>n==="http://www.w3.org/1999/XSL/Transform"},template:{id:9,check:n=>n.startsWith("http://www.xfa.org/schema/xfa-template/")},xdc:{id:10,check:n=>n.startsWith("http://www.xfa.org/schema/xdc/")},xdp:{id:11,check:n=>n==="http://ns.adobe.com/xdp/"},xfdf:{id:12,check:n=>n==="http://ns.adobe.com/xfdf/"},xhtml:{id:13,check:n=>n==="http://www.w3.org/1999/xhtml"},xmpmeta:{id:14,check:n=>n==="http://ns.adobe.com/xmpmeta/"}},_G={pt:n=>n,cm:n=>n/2.54*72,mm:n=>n/(10*2.54)*72,in:n=>n*72,px:n=>n},kG=/([+-]?\d+\.?\d*)(.*)/;function ry(n){return n.startsWith("'")||n.startsWith('"')?n.slice(1,-1):n}function Zt({data:n,defaultValue:e,validate:t}){if(!n)return e;n=n.trim();const i=parseInt(n,10);return!isNaN(i)&&t(i)?i:e}function N3({data:n,defaultValue:e,validate:t}){if(!n)return e;n=n.trim();const i=parseFloat(n);return!isNaN(i)&&t(i)?i:e}function ay({data:n,defaultValue:e,validate:t}){return n?(n=n.trim(),t(n)?n:e):e}function Fe(n,e){return ay({data:n,defaultValue:e[0],validate:t=>e.includes(t)})}function bt(n,e="0"){if(e||(e="0"),!n)return bt(e);const t=n.trim().match(kG);if(!t)return bt(e);const[,i,s]=t,r=parseFloat(i);if(isNaN(r))return bt(e);if(r===0)return 0;const a=_G[s];return a?a(r):r}function Yk(n){if(!n)return{num:1,den:1};const e=n.split(":",2).map(s=>parseFloat(s.trim())).filter(s=>!isNaN(s));if(e.length===1&&e.push(1),e.length===0)return{num:1,den:1};const[t,i]=e;return{num:t,den:i}}function hl(n){return n?n.trim().split(/\s+/).map(e=>({excluded:e[0]==="-",viewname:e.substring(1)})):[]}function CG(n,e=[0,0,0]){let[t,i,s]=e;if(!n)return{r:t,g:i,b:s};const r=n.split(",",3).map(a=>Us(parseInt(a.trim(),10),0,255)).map(a=>isNaN(a)?0:a);return r.length<3?{r:t,g:i,b:s}:([t,i,s]=r,{r:t,g:i,b:s})}function AG(n){if(!n)return{x:-1,y:-1,width:-1,height:-1};const t=n.split(",",4).map(o=>bt(o.trim(),"-1"));if(t.length<4||t[2]<0||t[3]<0)return{x:-1,y:-1,width:-1,height:-1};const[i,s,r,a]=t;return{x:i,y:s,width:r,height:a}}class Tt{static get FAILURE(){return Ze(this,"FAILURE",new Tt(!1,null,null,null))}static get EMPTY(){return Ze(this,"EMPTY",new Tt(!0,null,null,null))}constructor(e,t,i,s){this.success=e,this.html=t,this.bbox=i,this.breakNode=s}isBreak(){return!!this.breakNode}static breakNode(e){return new Tt(!1,null,null,e)}static success(e,t=null){return new Tt(!0,e,t,null)}}class SG{constructor(e){this.fonts=new Map,this.cache=new Map,this.warned=new Set,this.defaultFont=null,this.add(e)}add(e,t=null){for(const s of e)this.addPdfFont(s);for(const s of this.fonts.values())s.regular||(s.regular=s.italic||s.bold||s.bolditalic);if(!t||t.size===0)return;const i=this.fonts.get("PdfJS-Fallback-PdfJS-XFA");for(const s of t)this.fonts.set(s,i)}addPdfFont(e){var o,l,c;const t=e.cssFontInfo,i=t.fontFamily;let s=this.fonts.get(i);s||(s=Object.create(null),this.fonts.set(i,s),this.defaultFont||(this.defaultFont=s));let r="";const a=parseFloat(t.fontWeight);parseFloat(t.italicAngle)!==0?r=a>=700?"bolditalic":"italic":a>=700&&(r="bold"),r||((e.name.includes("Bold")||(o=e.psName)!=null&&o.includes("Bold"))&&(r="bold"),(e.name.includes("Italic")||e.name.endsWith("It")||(l=e.psName)!=null&&l.includes("Italic")||(c=e.psName)!=null&&c.endsWith("It"))&&(r+="italic")),r||(r="regular"),s[r]=e}getDefault(){return this.defaultFont}find(e,t=!0){var o,l;let i=this.fonts.get(e)||this.cache.get(e);if(i)return i;const s=/,|-|_| |bolditalic|bold|italic|regular|it/gi;let r=e.replaceAll(s,"");if(i=this.fonts.get(r),i)return this.cache.set(e,i),i;r=r.toLowerCase();const a=[];for(const[c,h]of this.fonts.entries())c.replaceAll(s,"").toLowerCase().startsWith(r)&&a.push(h);if(a.length===0)for(const[,c]of this.fonts.entries())(o=c.regular.name)!=null&&o.replaceAll(s,"").toLowerCase().startsWith(r)&&a.push(c);if(a.length===0){r=r.replaceAll(/psmt|mt/gi,"");for(const[c,h]of this.fonts.entries())c.replaceAll(s,"").toLowerCase().startsWith(r)&&a.push(h)}if(a.length===0)for(const c of this.fonts.values())(l=c.regular.name)!=null&&l.replaceAll(s,"").toLowerCase().startsWith(r)&&a.push(c);return a.length>=1?(a.length!==1&&t&&he(`XFA - Too many choices to guess the correct font: ${e}`),this.cache.set(e,a[0]),a[0]):(t&&!this.warned.has(e)&&(this.warned.add(e),he(`XFA - Cannot find the font: ${e}`)),null)}}function O4(n,e){return n.posture==="italic"?n.weight==="bold"?e.bolditalic:e.italic:n.weight==="bold"?e.bold:e.regular}function IG(n,e=!1){let t=null;if(n){const a=ry(n.typeface),o=n[ei].fontFinder.find(a);t=O4(n,o)}if(!t)return{lineHeight:12,lineGap:2,lineNoGap:10};const i=n.size||10,s=t.lineHeight?Math.max(e?0:1.2,t.lineHeight):1.2,r=t.lineGap===void 0?.2:t.lineGap;return{lineHeight:s*i,lineGap:r*i,lineNoGap:Math.max(1,s-r)*i}}const EG=1.02;class Jk{constructor(e,t,i,s){if(this.lineHeight=i,this.paraMargin=t||{top:0,bottom:0,left:0,right:0},!e){[this.pdfFont,this.xfaFont]=this.defaultFont(s);return}this.xfaFont={typeface:e.typeface,posture:e.posture,weight:e.weight,size:e.size,letterSpacing:e.letterSpacing};const r=s.find(e.typeface);if(!r){[this.pdfFont,this.xfaFont]=this.defaultFont(s);return}this.pdfFont=O4(e,r),this.pdfFont||([this.pdfFont,this.xfaFont]=this.defaultFont(s))}defaultFont(e){const t=e.find("Helvetica",!1)||e.find("Myriad Pro",!1)||e.find("Arial",!1)||e.getDefault();if(t!=null&&t.regular){const s=t.regular,a={typeface:s.cssFontInfo.fontFamily,posture:"normal",weight:"normal",size:10,letterSpacing:0};return[s,a]}return[null,{typeface:"Courier",posture:"normal",weight:"normal",size:10,letterSpacing:0}]}}class TG{constructor(e,t,i,s){this.fontFinder=s,this.stack=[new Jk(e,t,i,s)]}pushData(e,t,i){const s=this.stack.at(-1);for(const a of["typeface","posture","weight","size","letterSpacing"])e[a]||(e[a]=s.xfaFont[a]);for(const a of["top","bottom","left","right"])isNaN(t[a])&&(t[a]=s.paraMargin[a]);const r=new Jk(e,t,i||s.lineHeight,this.fontFinder);r.pdfFont||(r.pdfFont=s.pdfFont),this.stack.push(r)}popFont(){this.stack.pop()}topFont(){return this.stack.at(-1)}}class RG{constructor(e,t,i,s){this.glyphs=[],this.fontSelector=new TG(e,t,i,s),this.extraHeight=0}pushData(e,t,i){this.fontSelector.pushData(e,t,i)}popFont(e){return this.fontSelector.popFont()}addPara(){const e=this.fontSelector.topFont();this.extraHeight+=e.paraMargin.top+e.paraMargin.bottom}addString(e){if(!e)return;const t=this.fontSelector.topFont(),i=t.xfaFont.size;if(t.pdfFont){const s=t.xfaFont.letterSpacing,r=t.pdfFont,a=r.lineHeight||1.2,o=t.lineHeight||Math.max(1.2,a)*i,l=r.lineGap===void 0?.2:r.lineGap,c=a-l,h=Math.max(1,c)*i,u=i/1e3,d=r.defaultWidth||r.charsToGlyphs(" ")[0].width;for(const f of e.split(/[\u2029\n]/)){const g=r.encodeString(f).join(""),m=r.charsToGlyphs(g);for(const x of m){const p=x.width||d;this.glyphs.push([p*u+s,o,h,x.unicode,!1])}this.glyphs.push([0,0,0,`
`,!0])}this.glyphs.pop();return}for(const s of e.split(/[\u2029\n]/)){for(const r of s.split(""))this.glyphs.push([i,1.2*i,i,r,!1]);this.glyphs.push([0,0,0,`
`,!0])}this.glyphs.pop()}compute(e){let t=-1,i=0,s=0,r=0,a=0,o=0,l=!1,c=!0;for(let h=0,u=this.glyphs.length;h<u;h++){const[d,f,g,m,x]=this.glyphs[h],p=m===" ",y=c?g:f;if(x){s=Math.max(s,a),a=0,r+=o,o=y,t=-1,i=0,c=!1;continue}if(p){a+d>e?(s=Math.max(s,a),a=0,r+=o,o=y,t=-1,i=0,l=!0,c=!1):(o=Math.max(y,o),i=a,a+=d,t=h);continue}if(a+d>e){r+=o,o=y,t!==-1?(h=t,s=Math.max(s,i),a=0,t=-1,i=0):(s=Math.max(s,a),a=d),l=!0,c=!1;continue}a+=d,o=Math.max(y,o)}return s=Math.max(s,a),r+=o+this.extraHeight,{width:EG*s,height:r,isBroken:l}}}const Zk=/^[^.[]+/,MG=/^[^\]]+/,Ua={dot:0,dotDot:1,dotHash:2,dotBracket:3,dotParen:4},uM=new Map([["$data",(n,e)=>n.datasets?n.datasets.data:n],["$record",(n,e)=>(n.datasets?n.datasets.data:n)[Hs]()[0]],["$template",(n,e)=>n.template],["$connectionSet",(n,e)=>n.connectionSet],["$form",(n,e)=>n.form],["$layout",(n,e)=>n.layout],["$host",(n,e)=>n.host],["$dataWindow",(n,e)=>n.dataWindow],["$event",(n,e)=>n.event],["!",(n,e)=>n.datasets],["$xfa",(n,e)=>n],["xfa",(n,e)=>n],["$",(n,e)=>e]]),Qk=new WeakMap;function PG(n){return n=n.trim(),n==="*"?1/0:parseInt(n,10)||0}function dM(n,e,t=!0){let i=n.match(Zk);if(!i)return null;let[s]=i;const r=[{name:s,cacheName:"."+s,index:0,js:null,formCalc:null,operator:Ua.dot}];let a=s.length;for(;a<n.length;){const o=a;if(n.charAt(a++)==="["){if(i=n.slice(a).match(MG),!i)return he("XFA - Invalid index in SOM expression"),null;r.at(-1).index=PG(i[0]),a+=i[0].length+1;continue}let c;switch(n.charAt(a)){case".":if(!e)return null;a++,c=Ua.dotDot;break;case"#":a++,c=Ua.dotHash;break;case"[":if(t)return he("XFA - SOM expression contains a FormCalc subexpression which is not supported for now."),null;c=Ua.dotBracket;break;case"(":if(t)return he("XFA - SOM expression contains a JavaScript subexpression which is not supported for now."),null;c=Ua.dotParen;break;default:c=Ua.dot;break}if(i=n.slice(a).match(Zk),!i)break;[s]=i,a+=s.length,r.push({name:s,cacheName:n.slice(o,a),operator:c,index:0,js:null,formCalc:null})}return r}function S0(n,e,t,i=!0,s=!0){const r=dM(t,i);if(!r)return null;const a=uM.get(r[0].name);let o=0,l;a?(l=!0,n=[a(n,e)],o=1):(l=e===null,n=[e||n]);for(let c=r.length;o<c;o++){const{name:h,cacheName:u,operator:d,index:f}=r[o],g=[];for(const m of n){if(!m.isXFAObject)continue;let x,p;if(s&&(p=Qk.get(m),p||(p=new Map,Qk.set(m,p)),x=p.get(u)),!x){switch(d){case Ua.dot:x=m[Xp](h,!1);break;case Ua.dotDot:x=m[Xp](h,!0);break;case Ua.dotHash:x=m[sy](h),x=x.isXFAObjectArray?x.children:[x];break}s&&p.set(u,x)}x.length>0&&g.push(x)}if(g.length===0&&!l&&o===0){if(e=e[Qt](),!e)return null;o=-1,n=[e];continue}n=isFinite(f)?g.filter(m=>f<m.length).map(m=>m[f]):g.flat()}return n.length===0?null:n}function NG(n,e,t){const i=dM(t);if(!i||i.some(a=>a.operator===Ua.dotDot))return null;const s=uM.get(i[0].name);let r=0;s?(n=s(n,e),r=1):n=e||n;for(let a=i.length;r<a;r++){const{name:o,operator:l,index:c}=i[r];if(!isFinite(c))return i[r].index=0,n.createNodes(i.slice(r));let h;switch(l){case Ua.dot:h=n[Xp](o,!1);break;case Ua.dotDot:h=n[Xp](o,!0);break;case Ua.dotHash:h=n[sy](o),h=h.isXFAObjectArray?h.children:[h];break}if(h.length===0)return n.createNodes(i.slice(r));if(c<h.length){const u=h[c];if(!u.isXFAObject)return he("XFA - Cannot create a node."),null;n=u}else return i[r].index=c-h.length,n.createNodes(i.slice(r))}return null}const $x=Symbol(),$h=Symbol(),pf=Symbol(),dn=Symbol("_children"),Rw=Symbol(),k0=Symbol(),Mw=Symbol(),$k=Symbol(),Pw=Symbol(),eC=Symbol(),Nw=Symbol(),lp=Symbol(),e9=Symbol(),lo=Symbol("parent"),Dm=Symbol(),Lm=Symbol(),Ow=Symbol();let l6=0;const fM=$i.datasets.id;class Ce{constructor(e,t,i=!1){this[Yi]=e,this[On]=t,this[Nw]=i,this[lo]=null,this[dn]=[],this[qn]=`${t}${l6++}`,this[ei]=null}get isXFAObject(){return!0}get isXFAObjectArray(){return!1}createNodes(e){let t=this,i=null;for(const{name:s,index:r}of e){for(let a=0,o=isFinite(r)?r:0;a<=o;a++){const l=t[Yi]===fM?-1:t[Yi];i=new Ql(l,s),t[Li](i)}t=i}return i}[Zl](e){if(!this[Nw]||!this[a6](e))return!1;const t=e[On],i=this[t];if(i instanceof ce){if(i.push(e))return this[Li](e),!0}else return i!==null&&this[Eh](i),this[t]=e,this[Li](e),!0;let s="";return this.id?s=` (id: ${this.id})`:this.name&&(s=` (name: ${this.name} ${this.h.value})`),he(`XFA - node "${this[On]}"${s} has already enough "${t}"!`),!1}[a6](e){return this.hasOwnProperty(e[On])&&e[Yi]===this[Yi]}[yp](){return!1}[iy](){return!1}[N4](){return!1}[of](){return!1}[ca](){this.para&&this[Xi]()[we].paraStack.pop()}[Kg](){this[Xi]()[we].paraStack.push(this.para)}[o6](e){this.id&&this[Yi]===$i.template.id&&e.set(this.id,this)}[Xi](){return this[ei].template}[r0](){return!1}[b0](){return!1}[Li](e){e[lo]=this,this[dn].push(e),!e[ei]&&this[ei]&&(e[ei]=this[ei])}[Eh](e){const t=this[dn].indexOf(e);this[dn].splice(t,1)}[Yp](){return this.hasOwnProperty("value")}[fa](e){}[a0](e){}[ti](){}[yo](e){delete this[Nw],this[s3]&&(e.clean(this[s3]),delete this[s3])}[r6](e){return this[dn].indexOf(e)}[r3](e,t){t[lo]=this,this[dn].splice(e,0,t),!t[ei]&&this[ei]&&(t[ei]=this[ei])}[Jp](){return!this.name}[vG](){return""}[ms](){return this[dn].length===0?this[Le]:this[dn].map(e=>e[ms]()).join("")}get[pf](){const e=Object.getPrototypeOf(this);if(!e._attributes){const t=e._attributes=new Set;for(const i of Object.getOwnPropertyNames(this)){if(this[i]===null||this[i]instanceof Ce||this[i]instanceof ce)break;t.add(i)}}return Ze(this,pf,e._attributes)}[R0](e){let t=this;for(;t;){if(t===e)return!0;t=t[Qt]()}return!1}[Qt](){return this[lo]}[Zi](){return this[Qt]()}[Hs](e=null){return e?this[e]:this[dn]}[Tg](){const e=Object.create(null);this[Le]&&(e.$content=this[Le]);for(const t of Object.getOwnPropertyNames(this)){const i=this[t];i!==null&&(i instanceof Ce?e[t]=i[Tg]():i instanceof ce?i.isEmpty()||(e[t]=i.dump()):e[t]=i)}return e}[Rn](){return null}[Gt](){return Tt.EMPTY}*[Rg](){for(const e of this[Hs]())yield e}*[$k](e,t){for(const i of this[Rg]())if(!e||t===e.has(i[On])){const s=this[Bd](),r=i[Gt](s);r.success||(this[we].failingNode=i),yield r}}[ux](){return null}[Fd](e,t){this[we].children.push(e)}[Bd](){}[Fh]({filter:e=null,include:t=!0}){if(!this[we].generator)this[we].generator=this[$k](e,t);else{const i=this[Bd](),s=this[we].failingNode[Gt](i);if(!s.success)return s;s.html&&this[Fd](s.html,s.bbox),delete this[we].failingNode}for(;;){const i=this[we].generator.next();if(i.done)break;const s=i.value;if(!s.success)return s;s.html&&this[Fd](s.html,s.bbox)}return this[we].generator=null,Tt.EMPTY}[cM](e){this[Lm]=new Set(Object.keys(e))}[eC](e){const t=this[pf],i=this[Lm];return[...e].filter(s=>t.has(s)&&!i.has(s))}[op](e,t=new Set){for(const i of this[dn])i[Dm](e,t)}[Dm](e,t){const i=this[Pw](e,t);i?this[$x](i,e,t):this[op](e,t)}[Pw](e,t){const{use:i,usehref:s}=this;if(!i&&!s)return null;let r=null,a=null,o=null,l=i;if(s?(l=s,s.startsWith("#som(")&&s.endsWith(")")?a=s.slice(5,-1):s.startsWith(".#som(")&&s.endsWith(")")?a=s.slice(6,-1):s.startsWith("#")?o=s.slice(1):s.startsWith(".#")&&(o=s.slice(2))):i.startsWith("#")?o=i.slice(1):a=i,this.use=this.usehref="",o?r=e.get(o):(r=S0(e.get(lM),this,a,!0,!1),r&&(r=r[0])),!r)return he(`XFA - Invalid prototype reference: ${l}.`),null;if(r[On]!==this[On])return he(`XFA - Incompatible prototype: ${r[On]} !== ${this[On]}.`),null;if(t.has(r))return he("XFA - Cycle detected in prototypes use."),null;t.add(r);const c=r[Pw](e,t);return c&&r[$x](c,e,t),r[op](e,t),t.delete(r),r}[$x](e,t,i){if(i.has(e)){he("XFA - Cycle detected in prototypes use.");return}!this[Le]&&e[Le]&&(this[Le]=e[Le]),new Set(i).add(e);for(const r of this[eC](e[Lm]))this[r]=e[r],this[Lm]&&this[Lm].add(r);for(const r of Object.getOwnPropertyNames(this)){if(this[pf].has(r))continue;const a=this[r],o=e[r];if(a instanceof ce){for(const l of a[dn])l[Dm](t,i);for(let l=a[dn].length,c=o[dn].length;l<c;l++){const h=e[dn][l][Xo]();if(a.push(h))h[lo]=this,this[dn].push(h),h[Dm](t,i);else break}continue}if(a!==null){a[op](t,i),o&&a[$x](o,t,i);continue}if(o!==null){const l=o[Xo]();l[lo]=this,this[r]=l,this[dn].push(l),l[Dm](t,i)}}}static[Rw](e){return Array.isArray(e)?e.map(t=>Ce[Rw](t)):typeof e=="object"&&e!==null?Object.assign({},e):e}[Xo](){const e=Object.create(Object.getPrototypeOf(this));for(const t of Object.getOwnPropertySymbols(this))try{e[t]=this[t]}catch{Ze(e,t,this[t])}e[qn]=`${e[On]}${l6++}`,e[dn]=[];for(const t of Object.getOwnPropertyNames(this)){if(this[pf].has(t)){e[t]=Ce[Rw](this[t]);continue}const i=this[t];e[t]=i instanceof ce?new ce(i[lp]):null}for(const t of this[dn]){const i=t[On],s=t[Xo]();e[dn].push(s),s[lo]=e,e[i]===null?e[i]=s:e[i][dn].push(s)}return e}[Hs](e=null){return e?this[dn].filter(t=>t[On]===e):this[dn]}[sy](e){return this[e]}[Xp](e,t,i=!0){return Array.from(this[bp](e,t,i))}*[bp](e,t,i=!0){if(e==="parent"){yield this[lo];return}for(const s of this[dn])s[On]===e&&(yield s),s.name===e&&(yield s),(t||s[Jp]())&&(yield*s[bp](e,t,!1));i&&this[pf].has(e)&&(yield new D4(this,e,this[e]))}}class ce{constructor(e=1/0){this[lp]=e,this[dn]=[]}get isXFAObject(){return!1}get isXFAObjectArray(){return!0}push(e){return this[dn].length<=this[lp]?(this[dn].push(e),!0):(he(`XFA - node "${e[On]}" accepts no more than ${this[lp]} children`),!1)}isEmpty(){return this[dn].length===0}dump(){return this[dn].length===1?this[dn][0][Tg]():this[dn].map(e=>e[Tg]())}[Xo](){const e=new ce(this[lp]);return e[dn]=this[dn].map(t=>t[Xo]()),e}get children(){return this[dn]}clear(){this[dn].length=0}}class D4{constructor(e,t,i){this[lo]=e,this[On]=t,this[Le]=i,this[Vl]=!1,this[qn]=`attribute${l6++}`}[Qt](){return this[lo]}[Ff](){return!0}[P4](){return this[Le].trim()}[fa](e){e=e.value||"",this[Le]=e.toString()}[ms](){return this[Le]}[R0](e){return this[lo]===e||this[lo][R0](e)}}class Ql extends Ce{constructor(e,t,i={}){if(super(e,t),this[Le]="",this[k0]=null,t!=="#text"){const s=new Map;this[$h]=s;for(const[r,a]of Object.entries(i))s.set(r,new D4(this,r,a));if(i.hasOwnProperty($c)){const r=i[$c].xfa.dataNode;r!==void 0&&(r==="dataGroup"?this[k0]=!1:r==="dataValue"&&(this[k0]=!0))}}this[Vl]=!1}[wp](e){const t=this[On];if(t==="#text"){e.push(Qf(this[Le]));return}const i=w7(t),s=this[Yi]===fM?"xfa:":"";e.push(`<${s}${i}`);for(const[r,a]of this[$h].entries()){const o=w7(r);e.push(` ${o}="${Qf(a[Le])}"`)}if(this[k0]!==null&&(this[k0]?e.push(' xfa:dataNode="dataValue"'):e.push(' xfa:dataNode="dataGroup"')),!this[Le]&&this[dn].length===0){e.push("/>");return}if(e.push(">"),this[Le])typeof this[Le]=="string"?e.push(Qf(this[Le])):this[Le][wp](e);else for(const r of this[dn])r[wp](e);e.push(`</${s}${i}>`)}[Zl](e){if(this[Le]){const t=new Ql(this[Yi],"#text");this[Li](t),t[Le]=this[Le],this[Le]=""}return this[Li](e),!0}[a0](e){this[Le]+=e}[ti](){if(this[Le]&&this[dn].length>0){const e=new Ql(this[Yi],"#text");this[Li](e),e[Le]=this[Le],delete this[Le]}}[Gt](){return this[On]==="#text"?Tt.success({name:"#text",value:this[Le]}):Tt.EMPTY}[Hs](e=null){return e?this[dn].filter(t=>t[On]===e):this[dn]}[oM](){return this[$h]}[sy](e){const t=this[$h].get(e);return t!==void 0?t:this[Hs](e)}*[bp](e,t){const i=this[$h].get(e);i&&(yield i);for(const s of this[dn])s[On]===e&&(yield s),t&&(yield*s[bp](e,t))}*[s6](e,t){const i=this[$h].get(e);i&&(!t||!i[Vl])&&(yield i);for(const s of this[dn])yield*s[s6](e,t)}*[xp](e,t,i){for(const s of this[dn])s[On]===e&&(!i||!s[Vl])&&(yield s),t&&(yield*s[xp](e,t,i))}[Ff](){return this[k0]===null?this[dn].length===0||this[dn][0][Yi]===$i.xhtml.id:this[k0]}[P4](){return this[k0]===null?this[dn].length===0?this[Le].trim():this[dn][0][Yi]===$i.xhtml.id?this[dn][0][ms]().trim():null:this[Le].trim()}[fa](e){e=e.value||"",this[Le]=e.toString()}[Tg](e=!1){const t=Object.create(null);e&&(t.$ns=this[Yi]),this[Le]&&(t.$content=this[Le]),t.$name=this[On],t.children=[];for(const i of this[dn])t.children.push(i[Tg](e));t.attributes=Object.create(null);for(const[i,s]of this[$h])t.attributes[i]=s[Le];return t}}class Hi extends Ce{constructor(e,t){super(e,t),this[Le]=""}[a0](e){this[Le]+=e}[ti](){}}class Wn extends Hi{constructor(e,t,i){super(e,t),this[e9]=i}[ti](){this[Le]=ay({data:this[Le],defaultValue:this[e9][0],validate:e=>this[e9].includes(e)})}[yo](e){super[yo](e),delete this[e9]}}class bn extends Hi{[ti](){this[Le]=this[Le].trim()}}class ul extends Hi{constructor(e,t,i,s){super(e,t),this[Mw]=i,this[Ow]=s}[ti](){this[Le]=Zt({data:this[Le],defaultValue:this[Mw],validate:this[Ow]})}[yo](e){super[yo](e),delete this[Mw],delete this[Ow]}}class bs extends ul{constructor(e,t){super(e,t,0,i=>i===1)}}class gM extends ul{constructor(e,t){super(e,t,1,i=>i===0)}}function Jt(n){return typeof n=="string"?"0px":Number.isInteger(n)?`${n}px`:`${n.toFixed(2)}px`}const tC={anchorType(n,e){const t=n[Zi]();if(!(!t||t.layout&&t.layout!=="position"))switch("transform"in e||(e.transform=""),n.anchorType){case"bottomCenter":e.transform+="translate(-50%, -100%)";break;case"bottomLeft":e.transform+="translate(0,-100%)";break;case"bottomRight":e.transform+="translate(-100%,-100%)";break;case"middleCenter":e.transform+="translate(-50%,-50%)";break;case"middleLeft":e.transform+="translate(0,-50%)";break;case"middleRight":e.transform+="translate(-100%,-50%)";break;case"topCenter":e.transform+="translate(-50%,0)";break;case"topRight":e.transform+="translate(-100%,0)";break}},dimensions(n,e){var r;const t=n[Zi]();let i=n.w;const s=n.h;if((r=t.layout)!=null&&r.includes("row")){const a=t[we],o=n.colSpan;let l;o===-1?(l=Math.sumPrecise(a.columnWidths.slice(a.currentColumn)),a.currentColumn=0):(l=Math.sumPrecise(a.columnWidths.slice(a.currentColumn,a.currentColumn+o)),a.currentColumn=(a.currentColumn+n.colSpan)%a.columnWidths.length),isNaN(l)||(i=n.w=l)}e.width=i!==""?Jt(i):"auto",e.height=s!==""?Jt(s):"auto"},position(n,e){const t=n[Zi]();t!=null&&t.layout&&t.layout!=="position"||(e.position="absolute",e.left=Jt(n.x),e.top=Jt(n.y))},rotate(n,e){n.rotate&&("transform"in e||(e.transform=""),e.transform+=`rotate(-${n.rotate}deg)`,e.transformOrigin="top left")},presence(n,e){switch(n.presence){case"invisible":e.visibility="hidden";break;case"hidden":case"inactive":e.display="none";break}},hAlign(n,e){if(n[On]==="para")switch(n.hAlign){case"justifyAll":e.textAlign="justify-all";break;case"radix":e.textAlign="left";break;default:e.textAlign=n.hAlign}else switch(n.hAlign){case"left":e.alignSelf="start";break;case"center":e.alignSelf="center";break;case"right":e.alignSelf="end";break}},margin(n,e){n.margin&&(e.margin=n.margin[Rn]().margin)}};function mM(n,e){n[Zi]().layout==="position"&&(n.minW>0&&(e.minWidth=Jt(n.minW)),n.maxW>0&&(e.maxWidth=Jt(n.maxW)),n.minH>0&&(e.minHeight=Jt(n.minH)),n.maxH>0&&(e.maxHeight=Jt(n.maxH)))}function nC(n,e,t,i,s,r){const a=new RG(e,t,i,s);return typeof n=="string"?a.addString(n):n[sc](a),a.compute(r)}function L4(n,e){let t=null,i=null,s=!1;if((!n.w||!n.h)&&n.value){let r=0,a=0;n.margin&&(r=n.margin.leftInset+n.margin.rightInset,a=n.margin.topInset+n.margin.bottomInset);let o=null,l=null;n.para&&(l=Object.create(null),o=n.para.lineHeight===""?null:n.para.lineHeight,l.top=n.para.spaceAbove===""?0:n.para.spaceAbove,l.bottom=n.para.spaceBelow===""?0:n.para.spaceBelow,l.left=n.para.marginLeft===""?0:n.para.marginLeft,l.right=n.para.marginRight===""?0:n.para.marginRight);let c=n.font;if(!c){const d=n[Xi]();let f=n[Qt]();for(;f&&f!==d;){if(f.font){c=f.font;break}f=f[Qt]()}}const h=(n.w||e.width)-r,u=n[ei].fontFinder;if(n.value.exData&&n.value.exData[Le]&&n.value.exData.contentType==="text/html"){const d=nC(n.value.exData[Le],c,l,o,u,h);i=d.width,t=d.height,s=d.isBroken}else{const d=n.value[ms]();if(d){const f=nC(d,c,l,o,u,h);i=f.width,t=f.height,s=f.isBroken}}i!==null&&!n.w&&(i+=r),t!==null&&!n.h&&(t+=a)}return{w:i,h:t,isBroken:s}}function pM(n,e,t){let i;if(n.w!==""&&n.h!=="")i=[n.x,n.y,n.w,n.h];else{if(!t)return null;let s=n.w;if(s===""){if(n.maxW===0){const a=n[Zi]();s=a.layout==="position"&&a.w!==""?0:n.minW}else s=Math.min(n.maxW,t.width);e.attributes.style.width=Jt(s)}let r=n.h;if(r===""){if(n.maxH===0){const a=n[Zi]();r=a.layout==="position"&&a.h!==""?0:n.minH}else r=Math.min(n.maxH,t.height);e.attributes.style.height=Jt(r)}i=[n.x,n.y,s,r]}return i}function oy(n){var t;const e=n[Zi]();if((t=e.layout)!=null&&t.includes("row")){const i=e[we],s=n.colSpan;let r;s===-1?r=Math.sumPrecise(i.columnWidths.slice(i.currentColumn)):r=Math.sumPrecise(i.columnWidths.slice(i.currentColumn,i.currentColumn+s)),isNaN(r)||(n.w=r)}e.layout&&e.layout!=="position"&&(n.x=n.y=0),n.layout==="table"&&n.w===""&&Array.isArray(n.columnWidths)&&(n.w=Math.sumPrecise(n.columnWidths))}function bM(n){switch(n.layout){case"position":return"xfaPosition";case"lr-tb":return"xfaLrTb";case"rl-row":return"xfaRlRow";case"rl-tb":return"xfaRlTb";case"row":return"xfaRow";case"table":return"xfaTable";case"tb":return"xfaTb";default:return"xfaPosition"}}function $r(n,...e){const t=Object.create(null);for(const i of e){const s=n[i];if(s!==null){if(tC.hasOwnProperty(i)){tC[i](n,t);continue}if(s instanceof Ce){const r=s[Rn]();r?Object.assign(t,r):he(`(DEBUG) - XFA - style for ${i} not implemented yet`)}}}return t}function Ud(n,e){const{attributes:t}=e,{style:i}=t,s={name:"div",attributes:{class:["xfaWrapper"],style:Object.create(null)},children:[]};if(t.class.push("xfaWrapped"),n.border){const{widths:r,insets:a}=n.border[we];let o,l,c=a[0],h=a[3];const u=a[0]+a[2],d=a[1]+a[3];switch(n.border.hand){case"even":c-=r[0]/2,h-=r[3]/2,o=`calc(100% + ${(r[1]+r[3])/2-d}px)`,l=`calc(100% + ${(r[0]+r[2])/2-u}px)`;break;case"left":c-=r[0],h-=r[3],o=`calc(100% + ${r[1]+r[3]-d}px)`,l=`calc(100% + ${r[0]+r[2]-u}px)`;break;case"right":o=d?`calc(100% - ${d}px)`:"100%",l=u?`calc(100% - ${u}px)`:"100%";break}const f=["xfaBorder"];Xg(n.border)&&f.push("xfaPrintOnly");const g={name:"div",attributes:{class:f,style:{top:`${c}px`,left:`${h}px`,width:o,height:l}},children:[]};for(const m of["border","borderWidth","borderColor","borderRadius","borderStyle"])i[m]!==void 0&&(g.attributes.style[m]=i[m],delete i[m]);s.children.push(g,e)}else s.children.push(e);for(const r of["background","backgroundClip","top","left","width","height","minWidth","minHeight","maxWidth","maxHeight","transform","transformOrigin","visibility"])i[r]!==void 0&&(s.attributes.style[r]=i[r],delete i[r]);return s.attributes.style.position=i.position==="absolute"?"absolute":"relative",delete i.position,i.alignSelf&&(s.attributes.style.alignSelf=i.alignSelf,delete i.alignSelf),s}function xM(n){const e=bt(n.textIndent,"0px");if(e>=0)return;const i="padding"+((n.textAlign==="right"?"right":"left")==="left"?"Left":"Right"),s=bt(n[i],"0px");n[i]=`${s-e}px`}function F4(n,e){switch(n.access){case"nonInteractive":e.push("xfaNonInteractive");break;case"readOnly":e.push("xfaReadOnly");break;case"protected":e.push("xfaDisabled");break}}function Xg(n){return n.relevant.length>0&&!n.relevant[0].excluded&&n.relevant[0].viewname==="print"}function yM(n){const e=n[Xi]()[we].paraStack;return e.length?e.at(-1):null}function wM(n,e,t){var i;if((i=t.attributes.class)!=null&&i.includes("xfaRich")){e&&(n.h===""&&(e.height="auto"),n.w===""&&(e.width="auto"));const s=yM(n);if(s){const r=t.attributes.style;switch(r.display="flex",r.flexDirection="column",s.vAlign){case"top":r.justifyContent="start";break;case"bottom":r.justifyContent="end";break;case"middle":r.justifyContent="center";break}const a=s[Rn]();for(const[o,l]of Object.entries(a))o in r||(r[o]=l)}}}function vM(n,e,t,i){if(!t){delete i.fontFamily;return}const s=ry(n.typeface);i.fontFamily=`"${s}"`;const r=t.find(s);if(r){const{fontFamily:a}=r.regular.cssFontInfo;a!==s&&(i.fontFamily=`"${a}"`);const o=yM(e);if(o&&o.lineHeight!==""||i.lineHeight)return;const l=O4(n,r);l&&(i.lineHeight=Math.max(1.2,l.lineHeight))}}function _M(n){const e=k3(n,null,{addDefaultProtocol:!0,tryConvertEncoding:!0});return e?e.href:null}function kM(n,e){return{name:"div",attributes:{class:[n.layout==="lr-tb"?"xfaLr":"xfaRl"]},children:e}}function CM(n){if(!n[we])return null;const t={name:"div",attributes:n[we].attributes,children:n[we].children};if(n[we].failingNode){const i=n[we].failingNode[ux]();i&&(n.layout.endsWith("-tb")?t.children.push(kM(n,[i])):t.children.push(i))}return t.children.length===0?null:t}function AM(n,e,t){const i=n[we],s=i.availableSpace,[r,a,o,l]=t;switch(n.layout){case"position":{i.width=Math.max(i.width,r+o),i.height=Math.max(i.height,a+l),i.children.push(e);break}case"lr-tb":case"rl-tb":(!i.line||i.attempt===1)&&(i.line=kM(n,[]),i.children.push(i.line),i.numberInLine=0),i.numberInLine+=1,i.line.children.push(e),i.attempt===0?(i.currentWidth+=o,i.height=Math.max(i.height,i.prevHeight+l)):(i.currentWidth=o,i.prevHeight=i.height,i.height+=l,i.attempt=0),i.width=Math.max(i.width,i.currentWidth);break;case"rl-row":case"row":{i.children.push(e),i.width+=o,i.height=Math.max(i.height,l);const c=Jt(i.height);for(const h of i.children)h.attributes.style.height=c;break}case"table":{i.width=Us(o,i.width,s.width),i.height+=l,i.children.push(e);break}case"tb":{i.width=Us(o,i.width,s.width),i.height+=l,i.children.push(e);break}}}function SM(n){const e=n[we].availableSpace,t=n.margin?n.margin.topInset+n.margin.bottomInset:0,i=n.margin?n.margin.leftInset+n.margin.rightInset:0;switch(n.layout){case"lr-tb":case"rl-tb":return n[we].attempt===0?{width:e.width-i-n[we].currentWidth,height:e.height-t-n[we].prevHeight}:{width:e.width-i,height:e.height-t-n[we].height};case"rl-row":case"row":return{width:Math.sumPrecise(n[we].columnWidths.slice(n[we].currentColumn)),height:e.height-i};case"table":case"tb":return{width:e.width-i,height:e.height-t-n[we].height};case"position":default:return e}}function OG(n){let e=n.w===""?NaN:n.w,t=n.h===""?NaN:n.h,[i,s]=[0,0];switch(n.anchorType||""){case"bottomCenter":[i,s]=[e/2,t];break;case"bottomLeft":[i,s]=[0,t];break;case"bottomRight":[i,s]=[e,t];break;case"middleCenter":[i,s]=[e/2,t/2];break;case"middleLeft":[i,s]=[0,t/2];break;case"middleRight":[i,s]=[e,t/2];break;case"topCenter":[i,s]=[e/2,0];break;case"topRight":[i,s]=[e,0];break}let r,a;switch(n.rotate||0){case 0:[r,a]=[-i,-s];break;case 90:[r,a]=[-s,i],[e,t]=[t,-e];break;case 180:[r,a]=[i,s],[e,t]=[-e,-t];break;case 270:[r,a]=[s,-i],[e,t]=[-t,e];break}return[n.x+r+Math.min(0,e),n.y+a+Math.min(0,t),Math.abs(e),Math.abs(t)]}function ly(n,e){var l;if(n[Xi]()[we].firstUnsplittable===null||n.w===0||n.h===0)return!0;const t=2,i=n[Zi](),s=((l=i[we])==null?void 0:l.attempt)||0,[,r,a,o]=OG(n);switch(i.layout){case"lr-tb":case"rl-tb":return s===0?n[Xi]()[we].noLayoutFailure?n.w!==""?Math.round(a-e.width)<=t:e.width>t:n.h!==""&&Math.round(o-e.height)>t?!1:n.w!==""?Math.round(a-e.width)<=t?!0:i[we].numberInLine===0?e.height>t:!1:e.width>t:n[Xi]()[we].noLayoutFailure?!0:n.h!==""&&Math.round(o-e.height)>t?!1:n.w===""||Math.round(a-e.width)<=t?e.height>t:i[b0]()?!1:e.height>t;case"table":case"tb":return n[Xi]()[we].noLayoutFailure?!0:n.h!==""&&!n[r0]()?Math.round(o-e.height)<=t:n.w===""||Math.round(a-e.width)<=t?e.height>t:i[b0]()?!1:e.height>t;case"position":if(n[Xi]()[we].noLayoutFailure||n.h===""||Math.round(o+r-e.height)<=t)return!0;const c=n[Xi]()[we].currentContentArea;return o+r>c.h;case"rl-row":case"row":return n[Xi]()[we].noLayoutFailure?!0:n.h!==""?Math.round(o-e.height)<=t:!0;default:return!0}}const $e=$i.template.id,Hd="http://www.w3.org/2000/svg",O3=2,DG=3,LG=5e3,FG=/^H(\d+)$/,BG=new Set(["image/gif","image/jpeg","image/jpg","image/pjpeg","image/png","image/apng","image/x-png","image/bmp","image/x-ms-bmp","image/tiff","image/tif","application/octet-stream"]),UG=[[[66,77],"image/bmp"],[[255,216,255],"image/jpeg"],[[73,73,42,0],"image/tiff"],[[77,77,0,42],"image/tiff"],[[71,73,70,56,57,97],"image/gif"],[[137,80,78,71,13,10,26,10],"image/png"]];function iC(n){if(!n||!n.border)return{w:0,h:0};const e=n.border[cr]();return e?{w:e.widths[0]+e.widths[2]+e.insets[0]+e.insets[2],h:e.widths[1]+e.widths[3]+e.insets[1]+e.insets[3]}:{w:0,h:0}}function B4(n){return n.margin&&(n.margin.topInset||n.margin.rightInset||n.margin.bottomInset||n.margin.leftInset)}function U4(n,e){if(!n.value){const t=new W4({});n[Li](t),n.value=t}n.value[fa](e)}function*H4(n){for(const e of n[Hs]()){if(e instanceof G4){yield*e[Rg]();continue}yield e}}function dx(n){var e;return((e=n.validate)==null?void 0:e.nullTest)==="error"}function cy(n){for(;n;){if(!n.traversal){n[Vo]=n[Qt]()[Vo];return}if(n[Vo])return;let e=null;for(const s of n.traversal[Hs]())if(s.operation==="next"){e=s;break}if(!e||!e.ref){n[Vo]=n[Qt]()[Vo];return}const t=n[Xi]();n[Vo]=++t[Vo];const i=t[e0](e.ref,n);if(!i)return;n=i[0]}}function hy(n,e){var i;const t=n.assist;if(t){const s=t[Gt]();s&&(e.title=s);const a=t.role.match(FG);if(a){const o="heading",l=a[1];e.role=o,e["aria-level"]=l}}if(n.layout==="table")e.role="table";else if(n.layout==="row")e.role="row";else{const s=n[Qt]();s.layout==="row"&&(e.role=((i=s.assist)==null?void 0:i.role)==="TH"?"columnheader":"cell")}}function Xd(n){if(!n.assist)return null;const e=n.assist;return e.speak&&e.speak[Le]!==""?e.speak[Le]:e.toolTip?e.toolTip[Le]:null}function Vh(n){return Tt.success({name:"div",attributes:{class:["xfaRich"],style:Object.create(null)},children:[{name:"span",attributes:{style:Object.create(null)},value:n}]})}function uy(n){const e=n[Xi]();e[we].firstUnsplittable===null&&(e[we].firstUnsplittable=n,e[we].noLayoutFailure=!0)}function dy(n){const e=n[Xi]();e[we].firstUnsplittable===n&&(e[we].noLayoutFailure=!1)}function sC(n){if(n[we]||(n[we]=Object.create(null),n.targetType==="auto"))return!1;const e=n[Xi]();let t=null;if(n.target){if(t=e[e0](n.target,n[Qt]()),!t)return!1;t=t[0]}const{currentPageArea:i,currentContentArea:s}=e[we];if(n.targetType==="pageArea")return t instanceof Mg||(t=null),n.startNew?(n[we].target=t||i,!0):t&&t!==i?(n[we].target=t,!0):!1;t instanceof z4||(t=null);const r=t&&t[Qt]();let a,o=r;if(n.startNew)if(t){const l=r.contentArea.children,c=l.indexOf(s),h=l.indexOf(t);c!==-1&&c<h&&(o=null),a=h-1}else a=i.contentArea.children.indexOf(s);else if(t&&t!==s)a=r.contentArea.children.indexOf(t)-1,o=r===i?null:r;else return!1;return n[we].target=o,n[we].index=a,!0}function rC(n,e,t){const i=n[Xi](),s=i[we].noLayoutFailure,r=e[Zi];e[Zi]=()=>n,i[we].noLayoutFailure=!0;const a=e[Gt](t);n[Fd](a.html,a.bbox),i[we].noLayoutFailure=s,e[Zi]=r}class HG extends bn{constructor(e){super($e,"appearanceFilter"),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||""}}class IM extends Ce{constructor(e){super($e,"arc",!0),this.circular=Zt({data:e.circular,defaultValue:0,validate:t=>t===1}),this.hand=Fe(e.hand,["even","left","right"]),this.id=e.id||"",this.startAngle=N3({data:e.startAngle,defaultValue:0,validate:t=>!0}),this.sweepAngle=N3({data:e.sweepAngle,defaultValue:360,validate:t=>!0}),this.use=e.use||"",this.usehref=e.usehref||"",this.edge=null,this.fill=null}[Gt](){var l;const e=this.edge||new fx({}),t=e[Rn](),i=Object.create(null);((l=this.fill)==null?void 0:l.presence)==="visible"?Object.assign(i,this.fill[Rn]()):i.fill="transparent",i.strokeWidth=Jt(e.presence==="visible"?e.thickness:0),i.stroke=t.color;let s;const r={xmlns:Hd,style:{width:"100%",height:"100%",overflow:"visible"}};if(this.sweepAngle===360)s={name:"ellipse",attributes:{xmlns:Hd,cx:"50%",cy:"50%",rx:"50%",ry:"50%",style:i}};else{const c=this.startAngle*Math.PI/180,h=this.sweepAngle*Math.PI/180,u=this.sweepAngle>180?1:0,[d,f,g,m]=[50*(1+Math.cos(c)),50*(1-Math.sin(c)),50*(1+Math.cos(c+h)),50*(1-Math.sin(c+h))];s={name:"path",attributes:{xmlns:Hd,d:`M ${d} ${f} A 50 50 0 ${u} 0 ${g} ${m}`,vectorEffect:"non-scaling-stroke",style:i}},Object.assign(r,{viewBox:"0 0 100 100",preserveAspectRatio:"none"})}const a={name:"svg",children:[s],attributes:r},o=this[Qt]()[Qt]();return B4(o)?Tt.success({name:"div",attributes:{style:{display:"inline",width:"100%",height:"100%"}},children:[a]}):(a.attributes.style.position="absolute",Tt.success(a))}}class zG extends Ce{constructor(e){super($e,"area",!0),this.colSpan=Zt({data:e.colSpan,defaultValue:1,validate:t=>t>=1||t===-1}),this.id=e.id||"",this.name=e.name||"",this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.x=bt(e.x,"0pt"),this.y=bt(e.y,"0pt"),this.desc=null,this.extras=null,this.area=new ce,this.draw=new ce,this.exObject=new ce,this.exclGroup=new ce,this.field=new ce,this.subform=new ce,this.subformSet=new ce}*[Rg](){yield*H4(this)}[Jp](){return!0}[of](){return!0}[Fd](e,t){const[i,s,r,a]=t;this[we].width=Math.max(this[we].width,i+r),this[we].height=Math.max(this[we].height,s+a),this[we].children.push(e)}[Bd](){return this[we].availableSpace}[Gt](e){const t=$r(this,"position"),i={style:t,id:this[qn],class:["xfaArea"]};Xg(this)&&i.class.push("xfaPrintOnly"),this.name&&(i.xfaName=this.name);const s=[];this[we]={children:s,width:0,height:0,availableSpace:e};const r=this[Fh]({filter:new Set(["area","draw","field","exclGroup","subform","subformSet"]),include:!0});if(!r.success)return r.isBreak()?r:(delete this[we],Tt.FAILURE);t.width=Jt(this[we].width),t.height=Jt(this[we].height);const a={name:"div",attributes:i,children:s},o=[this.x,this.y,this[we].width,this[we].height];return delete this[we],Tt.success(a,o)}}class jG extends Ce{constructor(e){super($e,"assist",!0),this.id=e.id||"",this.role=e.role||"",this.use=e.use||"",this.usehref=e.usehref||"",this.speak=null,this.toolTip=null}[Gt](){var e;return((e=this.toolTip)==null?void 0:e[Le])||null}}class GG extends Ce{constructor(e){super($e,"barcode",!0),this.charEncoding=ay({data:e.charEncoding?e.charEncoding.toLowerCase():"",defaultValue:"",validate:t=>["utf-8","big-five","fontspecific","gbk","gb-18030","gb-2312","ksc-5601","none","shift-jis","ucs-2","utf-16"].includes(t)||t.match(/iso-8859-\d{2}/)}),this.checksum=Fe(e.checksum,["none","1mod10","1mod10_1mod11","2mod10","auto"]),this.dataColumnCount=Zt({data:e.dataColumnCount,defaultValue:-1,validate:t=>t>=0}),this.dataLength=Zt({data:e.dataLength,defaultValue:-1,validate:t=>t>=0}),this.dataPrep=Fe(e.dataPrep,["none","flateCompress"]),this.dataRowCount=Zt({data:e.dataRowCount,defaultValue:-1,validate:t=>t>=0}),this.endChar=e.endChar||"",this.errorCorrectionLevel=Zt({data:e.errorCorrectionLevel,defaultValue:-1,validate:t=>t>=0&&t<=8}),this.id=e.id||"",this.moduleHeight=bt(e.moduleHeight,"5mm"),this.moduleWidth=bt(e.moduleWidth,"0.25mm"),this.printCheckDigit=Zt({data:e.printCheckDigit,defaultValue:0,validate:t=>t===1}),this.rowColumnRatio=Yk(e.rowColumnRatio),this.startChar=e.startChar||"",this.textLocation=Fe(e.textLocation,["below","above","aboveEmbedded","belowEmbedded","none"]),this.truncate=Zt({data:e.truncate,defaultValue:0,validate:t=>t===1}),this.type=Fe(e.type?e.type.toLowerCase():"",["aztec","codabar","code2of5industrial","code2of5interleaved","code2of5matrix","code2of5standard","code3of9","code3of9extended","code11","code49","code93","code128","code128a","code128b","code128c","code128sscc","datamatrix","ean8","ean8add2","ean8add5","ean13","ean13add2","ean13add5","ean13pwcd","fim","logmars","maxicode","msi","pdf417","pdf417macro","plessey","postauscust2","postauscust3","postausreplypaid","postausstandard","postukrm4scc","postusdpbc","postusimb","postusstandard","postus5zip","qrcode","rfid","rss14","rss14expanded","rss14limited","rss14stacked","rss14stackedomni","rss14truncated","telepen","ucc128","ucc128random","ucc128sscc","upca","upcaadd2","upcaadd5","upcapwcd","upce","upceadd2","upceadd5","upcean2","upcean5","upsmaxicode"]),this.upsMode=Fe(e.upsMode,["usCarrier","internationalCarrier","secureSymbol","standardSymbol"]),this.use=e.use||"",this.usehref=e.usehref||"",this.wideNarrowRatio=Yk(e.wideNarrowRatio),this.encrypt=null,this.extras=null}}class VG extends Ce{constructor(e){super($e,"bind",!0),this.match=Fe(e.match,["once","dataRef","global","none"]),this.ref=e.ref||"",this.picture=null}}class c6 extends Ce{constructor(e){super($e,"bindItems"),this.connection=e.connection||"",this.labelRef=e.labelRef||"",this.ref=e.ref||"",this.valueRef=e.valueRef||""}}class qG extends Ce{constructor(e){super($e,"bookend"),this.id=e.id||"",this.leader=e.leader||"",this.trailer=e.trailer||"",this.use=e.use||"",this.usehref=e.usehref||""}}class WG extends bs{constructor(e){super($e,"boolean"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[Gt](e){return Vh(this[Le]===1?"1":"0")}}class EM extends Ce{constructor(e){super($e,"border",!0),this.break=Fe(e.break,["close","open"]),this.hand=Fe(e.hand,["even","left","right"]),this.id=e.id||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.corner=new ce(4),this.edge=new ce(4),this.extras=null,this.fill=null,this.margin=null}[cr](){if(!this[we]){const e=this.edge.children.slice();if(e.length<4){const s=e.at(-1)||new fx({});for(let r=e.length;r<4;r++)e.push(s)}const t=e.map(s=>s.thickness),i=[0,0,0,0];this.margin&&(i[0]=this.margin.topInset,i[1]=this.margin.rightInset,i[2]=this.margin.bottomInset,i[3]=this.margin.leftInset),this[we]={widths:t,insets:i,edges:e}}return this[we]}[Rn](){var s;const{edges:e}=this[cr](),t=e.map(r=>{const a=r[Rn]();return a.color||(a.color="#000000"),a}),i=Object.create(null);if(this.margin&&Object.assign(i,this.margin[Rn]()),((s=this.fill)==null?void 0:s.presence)==="visible"&&Object.assign(i,this.fill[Rn]()),this.corner.children.some(r=>r.radius!==0)){const r=this.corner.children.map(a=>a[Rn]());if(r.length===2||r.length===3){const a=r.at(-1);for(let o=r.length;o<4;o++)r.push(a)}i.borderRadius=r.map(a=>a.radius).join(" ")}switch(this.presence){case"invisible":case"hidden":i.borderStyle="";break;case"inactive":i.borderStyle="none";break;default:i.borderStyle=t.map(r=>r.style).join(" ");break}return i.borderWidth=t.map(r=>r.width).join(" "),i.borderColor=t.map(r=>r.color).join(" "),i}}class KG extends Ce{constructor(e){super($e,"break",!0),this.after=Fe(e.after,["auto","contentArea","pageArea","pageEven","pageOdd"]),this.afterTarget=e.afterTarget||"",this.before=Fe(e.before,["auto","contentArea","pageArea","pageEven","pageOdd"]),this.beforeTarget=e.beforeTarget||"",this.bookendLeader=e.bookendLeader||"",this.bookendTrailer=e.bookendTrailer||"",this.id=e.id||"",this.overflowLeader=e.overflowLeader||"",this.overflowTarget=e.overflowTarget||"",this.overflowTrailer=e.overflowTrailer||"",this.startNew=Zt({data:e.startNew,defaultValue:0,validate:t=>t===1}),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}}class TM extends Ce{constructor(e){super($e,"breakAfter",!0),this.id=e.id||"",this.leader=e.leader||"",this.startNew=Zt({data:e.startNew,defaultValue:0,validate:t=>t===1}),this.target=e.target||"",this.targetType=Fe(e.targetType,["auto","contentArea","pageArea"]),this.trailer=e.trailer||"",this.use=e.use||"",this.usehref=e.usehref||"",this.script=null}}class RM extends Ce{constructor(e){super($e,"breakBefore",!0),this.id=e.id||"",this.leader=e.leader||"",this.startNew=Zt({data:e.startNew,defaultValue:0,validate:t=>t===1}),this.target=e.target||"",this.targetType=Fe(e.targetType,["auto","contentArea","pageArea"]),this.trailer=e.trailer||"",this.use=e.use||"",this.usehref=e.usehref||"",this.script=null}[Gt](e){return this[we]={},Tt.FAILURE}}class XG extends Ce{constructor(e){super($e,"button",!0),this.highlight=Fe(e.highlight,["inverted","none","outline","push"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}[Gt](e){const i=this[Qt]()[Qt](),s={name:"button",attributes:{id:this[qn],class:["xfaButton"],style:{}},children:[]};for(const r of i.event.children){if(r.activity!=="click"||!r.script)continue;const a=$T(r.script[Le]);if(!a)continue;const o=_M(a.url);o&&s.children.push({name:"a",attributes:{id:"link"+this[qn],href:o,newWindow:a.newWindow,class:["xfaLink"],style:{}},children:[]})}return Tt.success(s)}}class YG extends Ce{constructor(e){super($e,"calculate",!0),this.id=e.id||"",this.override=Fe(e.override,["disabled","error","ignore","warning"]),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.message=null,this.script=null}}class JG extends Ce{constructor(e){super($e,"caption",!0),this.id=e.id||"",this.placement=Fe(e.placement,["left","bottom","inline","right","top"]),this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.reserve=Math.ceil(bt(e.reserve)),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.font=null,this.margin=null,this.para=null,this.value=null}[fa](e){U4(this,e)}[cr](e){if(!this[we]){let{width:t,height:i}=e;switch(this.placement){case"left":case"right":case"inline":t=this.reserve<=0?t:this.reserve;break;case"top":case"bottom":i=this.reserve<=0?i:this.reserve;break}this[we]=L4(this,{width:t,height:i})}return this[we]}[Gt](e){if(!this.value)return Tt.EMPTY;this[Kg]();const t=this.value[Gt](e).html;if(!t)return this[ca](),Tt.EMPTY;const i=this.reserve;if(this.reserve<=0){const{w:a,h:o}=this[cr](e);switch(this.placement){case"left":case"right":case"inline":this.reserve=a;break;case"top":case"bottom":this.reserve=o;break}}const s=[];typeof t=="string"?s.push({name:"#text",value:t}):s.push(t);const r=$r(this,"font","margin","visibility");switch(this.placement){case"left":case"right":this.reserve>0&&(r.width=Jt(this.reserve));break;case"top":case"bottom":this.reserve>0&&(r.height=Jt(this.reserve));break}return wM(this,null,t),this[ca](),this.reserve=i,Tt.success({name:"div",attributes:{style:r,class:["xfaCaption"]},children:s})}}class ZG extends bn{constructor(e){super($e,"certificate"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class QG extends Ce{constructor(e){super($e,"certificates",!0),this.credentialServerPolicy=Fe(e.credentialServerPolicy,["optional","required"]),this.id=e.id||"",this.url=e.url||"",this.urlPolicy=e.urlPolicy||"",this.use=e.use||"",this.usehref=e.usehref||"",this.encryption=null,this.issuers=null,this.keyUsage=null,this.oids=null,this.signing=null,this.subjectDNs=null}}class MM extends Ce{constructor(e){super($e,"checkButton",!0),this.id=e.id||"",this.mark=Fe(e.mark,["default","check","circle","cross","diamond","square","star"]),this.shape=Fe(e.shape,["square","round"]),this.size=bt(e.size,"10pt"),this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.extras=null,this.margin=null}[Gt](e){var x,p,y;const t=$r(this,"margin"),i=Jt(this.size);t.width=t.height=i;let s,r,a;const o=this[Qt]()[Qt](),l=o.items.children.length&&o.items.children[0][Gt]().html||[],c={on:(l[0]!==void 0?l[0]:"on").toString(),off:(l[1]!==void 0?l[1]:"off").toString()},u=(((x=o.value)==null?void 0:x[ms]())||"off")===c.on||void 0,d=o[Zi](),f=o[qn];let g;d instanceof DM?(a=d[qn],s="radio",r="xfaRadio",g=((p=d[go])==null?void 0:p[qn])||d[qn]):(s="checkbox",r="xfaCheckbox",g=((y=o[go])==null?void 0:y[qn])||o[qn]);const m={name:"input",attributes:{class:[r],style:t,fieldId:f,dataId:g,type:s,checked:u,xfaOn:c.on,xfaOff:c.off,"aria-label":Xd(o),"aria-required":!1}};return a&&(m.attributes.name=a),dx(o)&&(m.attributes["aria-required"]=!0,m.attributes.required=!0),Tt.success({name:"label",attributes:{class:["xfaLabel"]},children:[m]})}}class PM extends Ce{constructor(e){super($e,"choiceList",!0),this.commitOn=Fe(e.commitOn,["select","exit"]),this.id=e.id||"",this.open=Fe(e.open,["userControl","always","multiSelect","onEntry"]),this.textEntry=Zt({data:e.textEntry,defaultValue:0,validate:t=>t===1}),this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.extras=null,this.margin=null}[Gt](e){var c,h,u;const t=$r(this,"border","margin"),s=this[Qt]()[Qt](),a={fontSize:`calc(${((c=s.font)==null?void 0:c.size)||10}px * var(--total-scale-factor))`},o=[];if(s.items.children.length>0){const d=s.items;let f=0,g=0;d.children.length===2&&(f=d.children[0].save,g=1-f);const m=d.children[f][Gt]().html,x=d.children[g][Gt]().html;let p=!1;const y=((h=s.value)==null?void 0:h[ms]())||"";for(let w=0,v=m.length;w<v;w++){const _={name:"option",attributes:{value:x[w]||m[w],style:a},value:m[w]};x[w]===y&&(_.attributes.selected=p=!0),o.push(_)}p||o.splice(0,0,{name:"option",attributes:{hidden:!0,selected:!0},value:" "})}const l={class:["xfaSelect"],fieldId:s[qn],dataId:((u=s[go])==null?void 0:u[qn])||s[qn],style:t,"aria-label":Xd(s),"aria-required":!1};return dx(s)&&(l["aria-required"]=!0,l.required=!0),this.open==="multiSelect"&&(l.multiple=!0),Tt.success({name:"label",attributes:{class:["xfaLabel"]},children:[{name:"select",children:o,attributes:l}]})}}class $G extends Ce{constructor(e){super($e,"color",!0),this.cSpace=Fe(e.cSpace,["SRGB"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.value=e.value?CG(e.value):"",this.extras=null}[Yp](){return!1}[Rn](){return this.value?Dn.makeHexColor(this.value.r,this.value.g,this.value.b):null}}class eV extends Ce{constructor(e){super($e,"comb"),this.id=e.id||"",this.numberOfCells=Zt({data:e.numberOfCells,defaultValue:0,validate:t=>t>=0}),this.use=e.use||"",this.usehref=e.usehref||""}}class tV extends Ce{constructor(e){super($e,"connect",!0),this.connection=e.connection||"",this.id=e.id||"",this.ref=e.ref||"",this.usage=Fe(e.usage,["exportAndImport","exportOnly","importOnly"]),this.use=e.use||"",this.usehref=e.usehref||"",this.picture=null}}class z4 extends Ce{constructor(e){super($e,"contentArea",!0),this.h=bt(e.h),this.id=e.id||"",this.name=e.name||"",this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.w=bt(e.w),this.x=bt(e.x,"0pt"),this.y=bt(e.y,"0pt"),this.desc=null,this.extras=null}[Gt](e){const t=Jt(this.x),i=Jt(this.y),s={left:t,top:i,width:Jt(this.w),height:Jt(this.h)},r=["xfaContentarea"];return Xg(this)&&r.push("xfaPrintOnly"),Tt.success({name:"div",children:[],attributes:{style:s,class:r,id:this[qn]}})}}class NM extends Ce{constructor(e){super($e,"corner",!0),this.id=e.id||"",this.inverted=Zt({data:e.inverted,defaultValue:0,validate:t=>t===1}),this.join=Fe(e.join,["square","round"]),this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.radius=bt(e.radius),this.stroke=Fe(e.stroke,["solid","dashDot","dashDotDot","dashed","dotted","embossed","etched","lowered","raised"]),this.thickness=bt(e.thickness,"0.5pt"),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Rn](){const e=$r(this,"visibility");return e.radius=Jt(this.join==="square"?0:this.radius),e}}class nV extends Hi{constructor(e){super($e,"date"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ti](){const e=this[Le].trim();this[Le]=e?new Date(e):null}[Gt](e){return Vh(this[Le]?this[Le].toString():"")}}class iV extends Hi{constructor(e){super($e,"dateTime"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ti](){const e=this[Le].trim();this[Le]=e?new Date(e):null}[Gt](e){return Vh(this[Le]?this[Le].toString():"")}}class sV extends Ce{constructor(e){super($e,"dateTimeEdit",!0),this.hScrollPolicy=Fe(e.hScrollPolicy,["auto","off","on"]),this.id=e.id||"",this.picker=Fe(e.picker,["host","none"]),this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.comb=null,this.extras=null,this.margin=null}[Gt](e){var r;const t=$r(this,"border","font","margin"),i=this[Qt]()[Qt](),s={name:"input",attributes:{type:"text",fieldId:i[qn],dataId:((r=i[go])==null?void 0:r[qn])||i[qn],class:["xfaTextfield"],style:t,"aria-label":Xd(i),"aria-required":!1}};return dx(i)&&(s.attributes["aria-required"]=!0,s.attributes.required=!0),Tt.success({name:"label",attributes:{class:["xfaLabel"]},children:[s]})}}class rV extends Hi{constructor(e){super($e,"decimal"),this.fracDigits=Zt({data:e.fracDigits,defaultValue:2,validate:t=>!0}),this.id=e.id||"",this.leadDigits=Zt({data:e.leadDigits,defaultValue:-1,validate:t=>!0}),this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ti](){const e=parseFloat(this[Le].trim());this[Le]=isNaN(e)?null:e}[Gt](e){return Vh(this[Le]!==null?this[Le].toString():"")}}class aV extends Ce{constructor(e){super($e,"defaultUi",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}}class oV extends Ce{constructor(e){super($e,"desc",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.boolean=new ce,this.date=new ce,this.dateTime=new ce,this.decimal=new ce,this.exData=new ce,this.float=new ce,this.image=new ce,this.integer=new ce,this.text=new ce,this.time=new ce}}class lV extends Wn{constructor(e){super($e,"digestMethod",["","SHA1","SHA256","SHA512","RIPEMD160"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||""}}class cV extends Ce{constructor(e){super($e,"digestMethods",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.digestMethod=new ce}}class OM extends Ce{constructor(e){super($e,"draw",!0),this.anchorType=Fe(e.anchorType,["topLeft","bottomCenter","bottomLeft","bottomRight","middleCenter","middleLeft","middleRight","topCenter","topRight"]),this.colSpan=Zt({data:e.colSpan,defaultValue:1,validate:t=>t>=1||t===-1}),this.h=e.h?bt(e.h):"",this.hAlign=Fe(e.hAlign,["left","center","justify","justifyAll","radix","right"]),this.id=e.id||"",this.locale=e.locale||"",this.maxH=bt(e.maxH,"0pt"),this.maxW=bt(e.maxW,"0pt"),this.minH=bt(e.minH,"0pt"),this.minW=bt(e.minW,"0pt"),this.name=e.name||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.relevant=hl(e.relevant),this.rotate=Zt({data:e.rotate,defaultValue:0,validate:t=>t%90===0}),this.use=e.use||"",this.usehref=e.usehref||"",this.w=e.w?bt(e.w):"",this.x=bt(e.x,"0pt"),this.y=bt(e.y,"0pt"),this.assist=null,this.border=null,this.caption=null,this.desc=null,this.extras=null,this.font=null,this.keep=null,this.margin=null,this.para=null,this.traversal=null,this.ui=null,this.value=null,this.setProperty=new ce}[fa](e){U4(this,e)}[Gt](e){if(cy(this),this.presence==="hidden"||this.presence==="inactive")return Tt.EMPTY;oy(this),this[Kg]();const t=this.w,i=this.h,{w:s,h:r,isBroken:a}=L4(this,e);if(s&&this.w===""){if(a&&this[Zi]()[b0]())return this[ca](),Tt.FAILURE;this.w=s}if(r&&this.h===""&&(this.h=r),uy(this),!ly(this,e))return this.w=t,this.h=i,this[ca](),Tt.FAILURE;dy(this);const o=$r(this,"font","hAlign","dimensions","position","presence","rotate","anchorType","border","margin");mM(this,o),o.margin&&(o.padding=o.margin,delete o.margin);const l=["xfaDraw"];this.font&&l.push("xfaFont"),Xg(this)&&l.push("xfaPrintOnly");const c={style:o,id:this[qn],class:l};this.name&&(c.xfaName=this.name);const h={name:"div",attributes:c,children:[]};hy(this,c);const u=pM(this,h,e),d=this.value?this.value[Gt](e).html:null;return d===null?(this.w=t,this.h=i,this[ca](),Tt.success(Ud(this,h),u)):(h.children.push(d),wM(this,o,d),this.w=t,this.h=i,this[ca](),Tt.success(Ud(this,h),u))}}class fx extends Ce{constructor(e){super($e,"edge",!0),this.cap=Fe(e.cap,["square","butt","round"]),this.id=e.id||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.stroke=Fe(e.stroke,["solid","dashDot","dashDotDot","dashed","dotted","embossed","etched","lowered","raised"]),this.thickness=bt(e.thickness,"0.5pt"),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Rn](){const e=$r(this,"visibility");if(Object.assign(e,{linecap:this.cap,width:Jt(this.thickness),color:this.color?this.color[Rn]():"#000000",style:""}),this.presence!=="visible")e.style="none";else switch(this.stroke){case"solid":e.style="solid";break;case"dashDot":e.style="dashed";break;case"dashDotDot":e.style="dashed";break;case"dashed":e.style="dashed";break;case"dotted":e.style="dotted";break;case"embossed":e.style="ridge";break;case"etched":e.style="groove";break;case"lowered":e.style="inset";break;case"raised":e.style="outset";break}return e}}class hV extends Wn{constructor(e){super($e,"encoding",["adbe.x509.rsa_sha1","adbe.pkcs7.detached","adbe.pkcs7.sha1"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||""}}class uV extends Ce{constructor(e){super($e,"encodings",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.encoding=new ce}}class dV extends Ce{constructor(e){super($e,"encrypt",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.certificate=null}}class fV extends Ce{constructor(e){super($e,"encryptData",!0),this.id=e.id||"",this.operation=Fe(e.operation,["encrypt","decrypt"]),this.target=e.target||"",this.use=e.use||"",this.usehref=e.usehref||"",this.filter=null,this.manifest=null}}class gV extends Ce{constructor(e){super($e,"encryption",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.certificate=new ce}}class mV extends Wn{constructor(e){super($e,"encryptionMethod",["","AES256-CBC","TRIPLEDES-CBC","AES128-CBC","AES192-CBC"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||""}}class pV extends Ce{constructor(e){super($e,"encryptionMethods",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.encryptionMethod=new ce}}let bV=class extends Ce{constructor(e){super($e,"event",!0),this.activity=Fe(e.activity,["click","change","docClose","docReady","enter","exit","full","indexChange","initialize","mouseDown","mouseEnter","mouseExit","mouseUp","postExecute","postOpen","postPrint","postSave","postSign","postSubmit","preExecute","preOpen","prePrint","preSave","preSign","preSubmit","ready","validationState"]),this.id=e.id||"",this.listen=Fe(e.listen,["refOnly","refAndDescendents"]),this.name=e.name||"",this.ref=e.ref||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.encryptData=null,this.execute=null,this.script=null,this.signData=null,this.submit=null}};class xV extends Hi{constructor(e){super($e,"exData"),this.contentType=e.contentType||"",this.href=e.href||"",this.id=e.id||"",this.maxLength=Zt({data:e.maxLength,defaultValue:-1,validate:t=>t>=-1}),this.name=e.name||"",this.rid=e.rid||"",this.transferEncoding=Fe(e.transferEncoding,["none","base64","package"]),this.use=e.use||"",this.usehref=e.usehref||""}[N4](){return this.contentType==="text/html"}[Zl](e){return this.contentType==="text/html"&&e[Yi]===$i.xhtml.id?(this[Le]=e,!0):this.contentType==="text/xml"?(this[Le]=e,!0):!1}[Gt](e){return this.contentType!=="text/html"||!this[Le]?Tt.EMPTY:this[Le][Gt](e)}}class yV extends Ce{constructor(e){super($e,"exObject",!0),this.archive=e.archive||"",this.classId=e.classId||"",this.codeBase=e.codeBase||"",this.codeType=e.codeType||"",this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.boolean=new ce,this.date=new ce,this.dateTime=new ce,this.decimal=new ce,this.exData=new ce,this.exObject=new ce,this.float=new ce,this.image=new ce,this.integer=new ce,this.text=new ce,this.time=new ce}}class DM extends Ce{constructor(e){super($e,"exclGroup",!0),this.access=Fe(e.access,["open","nonInteractive","protected","readOnly"]),this.accessKey=e.accessKey||"",this.anchorType=Fe(e.anchorType,["topLeft","bottomCenter","bottomLeft","bottomRight","middleCenter","middleLeft","middleRight","topCenter","topRight"]),this.colSpan=Zt({data:e.colSpan,defaultValue:1,validate:t=>t>=1||t===-1}),this.h=e.h?bt(e.h):"",this.hAlign=Fe(e.hAlign,["left","center","justify","justifyAll","radix","right"]),this.id=e.id||"",this.layout=Fe(e.layout,["position","lr-tb","rl-row","rl-tb","row","table","tb"]),this.maxH=bt(e.maxH,"0pt"),this.maxW=bt(e.maxW,"0pt"),this.minH=bt(e.minH,"0pt"),this.minW=bt(e.minW,"0pt"),this.name=e.name||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.w=e.w?bt(e.w):"",this.x=bt(e.x,"0pt"),this.y=bt(e.y,"0pt"),this.assist=null,this.bind=null,this.border=null,this.calculate=null,this.caption=null,this.desc=null,this.extras=null,this.margin=null,this.para=null,this.traversal=null,this.validate=null,this.connect=new ce,this.event=new ce,this.field=new ce,this.setProperty=new ce}[of](){return!0}[Yp](){return!0}[fa](e){for(const t of this.field.children){if(!t.value){const i=new W4({});t[Li](i),t.value=i}t.value[fa](e)}}[b0](){return this.layout.endsWith("-tb")&&this[we].attempt===0&&this[we].numberInLine>0||this[Qt]()[b0]()}[r0](){var t;const e=this[Zi]();return e[r0]()?this[we]._isSplittable!==void 0?this[we]._isSplittable:this.layout==="position"||this.layout.includes("row")?(this[we]._isSplittable=!1,!1):(t=e.layout)!=null&&t.endsWith("-tb")&&e[we].numberInLine!==0?!1:(this[we]._isSplittable=!0,!0):!1}[ux](){return CM(this)}[Fd](e,t){AM(this,e,t)}[Bd](){return SM(this)}[Gt](e){if(cy(this),this.presence==="hidden"||this.presence==="inactive"||this.h===0||this.w===0)return Tt.EMPTY;oy(this);const t=[],i={id:this[qn],class:[]};F4(this,i.class),this[we]||(this[we]=Object.create(null)),Object.assign(this[we],{children:t,attributes:i,attempt:0,line:null,numberInLine:0,availableSpace:{width:Math.min(this.w||1/0,e.width),height:Math.min(this.h||1/0,e.height)},width:0,height:0,prevHeight:0,currentWidth:0});const s=this[r0]();if(s||uy(this),!ly(this,e))return Tt.FAILURE;const r=new Set(["field"]);if(this.layout.includes("row")){const p=this[Zi]().columnWidths;Array.isArray(p)&&p.length>0&&(this[we].columnWidths=p,this[we].currentColumn=0)}const a=$r(this,"anchorType","dimensions","position","presence","border","margin","hAlign"),o=["xfaExclgroup"],l=bM(this);l&&o.push(l),Xg(this)&&o.push("xfaPrintOnly"),i.style=a,i.class=o,this.name&&(i.xfaName=this.name),this[Kg]();const c=this.layout==="lr-tb"||this.layout==="rl-tb",h=c?O3:1;for(;this[we].attempt<h;this[we].attempt++){c&&this[we].attempt===O3-1&&(this[we].numberInLine=0);const p=this[Fh]({filter:r,include:!0});if(p.success)break;if(p.isBreak())return this[ca](),p;if(c&&this[we].attempt===0&&this[we].numberInLine===0&&!this[Xi]()[we].noLayoutFailure){this[we].attempt=h;break}}if(this[ca](),s||dy(this),this[we].attempt===h)return s||delete this[we],Tt.FAILURE;let u=0,d=0;this.margin&&(u=this.margin.leftInset+this.margin.rightInset,d=this.margin.topInset+this.margin.bottomInset);const f=Math.max(this[we].width+u,this.w||0),g=Math.max(this[we].height+d,this.h||0),m=[this.x,this.y,f,g];this.w===""&&(a.width=Jt(f)),this.h===""&&(a.height=Jt(g));const x={name:"div",attributes:i,children:t};return hy(this,i),delete this[we],Tt.success(Ud(this,x),m)}}class wV extends Ce{constructor(e){super($e,"execute"),this.connection=e.connection||"",this.executeType=Fe(e.executeType,["import","remerge"]),this.id=e.id||"",this.runAt=Fe(e.runAt,["client","both","server"]),this.use=e.use||"",this.usehref=e.usehref||""}}class vV extends Ce{constructor(e){super($e,"extras",!0),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||"",this.boolean=new ce,this.date=new ce,this.dateTime=new ce,this.decimal=new ce,this.exData=new ce,this.extras=new ce,this.float=new ce,this.image=new ce,this.integer=new ce,this.text=new ce,this.time=new ce}}class j4 extends Ce{constructor(e){super($e,"field",!0),this.access=Fe(e.access,["open","nonInteractive","protected","readOnly"]),this.accessKey=e.accessKey||"",this.anchorType=Fe(e.anchorType,["topLeft","bottomCenter","bottomLeft","bottomRight","middleCenter","middleLeft","middleRight","topCenter","topRight"]),this.colSpan=Zt({data:e.colSpan,defaultValue:1,validate:t=>t>=1||t===-1}),this.h=e.h?bt(e.h):"",this.hAlign=Fe(e.hAlign,["left","center","justify","justifyAll","radix","right"]),this.id=e.id||"",this.locale=e.locale||"",this.maxH=bt(e.maxH,"0pt"),this.maxW=bt(e.maxW,"0pt"),this.minH=bt(e.minH,"0pt"),this.minW=bt(e.minW,"0pt"),this.name=e.name||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.relevant=hl(e.relevant),this.rotate=Zt({data:e.rotate,defaultValue:0,validate:t=>t%90===0}),this.use=e.use||"",this.usehref=e.usehref||"",this.w=e.w?bt(e.w):"",this.x=bt(e.x,"0pt"),this.y=bt(e.y,"0pt"),this.assist=null,this.bind=null,this.border=null,this.calculate=null,this.caption=null,this.desc=null,this.extras=null,this.font=null,this.format=null,this.items=new ce(2),this.keep=null,this.margin=null,this.para=null,this.traversal=null,this.ui=null,this.validate=null,this.value=null,this.bindItems=new ce,this.connect=new ce,this.event=new ce,this.setProperty=new ce}[of](){return!0}[fa](e){U4(this,e)}[Gt](e){var p,y,w,v,_;if(cy(this),!this.ui){this.ui=new q4({}),this.ui[ei]=this[ei],this[Li](this.ui);let C;switch(this.items.children.length){case 0:C=new zM({}),this.ui.textEdit=C;break;case 1:C=new MM({}),this.ui.checkButton=C;break;case 2:C=new PM({}),this.ui.choiceList=C;break}this.ui[Li](C)}if(!this.ui||this.presence==="hidden"||this.presence==="inactive"||this.h===0||this.w===0)return Tt.EMPTY;this.caption&&delete this.caption[we],this[Kg]();const t=this.caption?this.caption[Gt](e).html:null,i=this.w,s=this.h;let r=0,a=0;this.margin&&(r=this.margin.leftInset+this.margin.rightInset,a=this.margin.topInset+this.margin.bottomInset);let o=null;if(this.w===""||this.h===""){let C=null,k=null,I=0,S=0;if(this.ui.checkButton)I=S=this.ui.checkButton.size;else{const{w:R,h:P}=L4(this,e);R!==null?(I=R,S=P):S=IG(this.font,!0).lineNoGap}if(o=iC(this.ui[cr]()),I+=o.w,S+=o.h,this.caption){const{w:R,h:P,isBroken:D}=this.caption[cr](e);if(D&&this[Zi]()[b0]())return this[ca](),Tt.FAILURE;switch(C=R,k=P,this.caption.placement){case"left":case"right":case"inline":C+=I;break;case"top":case"bottom":k+=S;break}}else C=I,k=S;C&&this.w===""&&(C+=r,this.w=Math.min(this.maxW<=0?1/0:this.maxW,this.minW+1<C?C:this.minW)),k&&this.h===""&&(k+=a,this.h=Math.min(this.maxH<=0?1/0:this.maxH,this.minH+1<k?k:this.minH))}if(this[ca](),oy(this),uy(this),!ly(this,e))return this.w=i,this.h=s,this[ca](),Tt.FAILURE;dy(this);const l=$r(this,"font","dimensions","position","rotate","anchorType","presence","margin","hAlign");mM(this,l);const c=["xfaField"];this.font&&c.push("xfaFont"),Xg(this)&&c.push("xfaPrintOnly");const h={style:l,id:this[qn],class:c};l.margin&&(l.padding=l.margin,delete l.margin),F4(this,c),this.name&&(h.xfaName=this.name);const u=[],d={name:"div",attributes:h,children:u};hy(this,h);const f=this.border?this.border[Rn]():null,g=pM(this,d,e),m=this.ui[Gt]().html;if(!m)return Object.assign(l,f),Tt.success(Ud(this,d),g);this[Vo]&&((p=m.children)!=null&&p[0]?m.children[0].attributes.tabindex=this[Vo]:m.attributes.tabindex=this[Vo]),(y=m.attributes).style||(y.style=Object.create(null));let x=null;if(this.ui.button?(m.children.length===1&&([x]=m.children.splice(0,1)),Object.assign(m.attributes.style,f)):Object.assign(l,f),u.push(m),this.value){if(this.ui.imageEdit)m.children.push(this.value[Gt]().html);else if(!this.ui.button){let C="";if(this.value.exData)C=this.value.exData[ms]();else if(this.value.text)C=this.value.text[cr]();else{const k=this.value[Gt]().html;k!==null&&(C=k.children[0].value)}this.ui.textEdit&&((w=this.value.text)!=null&&w.maxChars)&&(m.children[0].attributes.maxLength=this.value.text.maxChars),C&&(this.ui.numericEdit&&(C=parseFloat(C),C=isNaN(C)?"":C.toString()),m.children[0].name==="textarea"?m.children[0].attributes.textContent=C:m.children[0].attributes.value=C)}}if(!this.ui.imageEdit&&((v=m.children)!=null&&v[0])&&this.h){o=o||iC(this.ui[cr]());let C=0;if(this.caption&&["top","bottom"].includes(this.caption.placement)){C=this.caption.reserve,C<=0&&(C=this.caption[cr](e).h);const k=this.h-C-a-o.h;m.children[0].attributes.style.height=Jt(k)}else m.children[0].attributes.style.height="100%"}if(x&&m.children.push(x),!t)return m.attributes.class&&m.attributes.class.push("xfaLeft"),this.w=i,this.h=s,Tt.success(Ud(this,d),g);if(this.ui.button)return l.padding&&delete l.padding,t.name==="div"&&(t.name="span"),m.children.push(t),Tt.success(d,g);switch(this.ui.checkButton&&(t.attributes.class[0]="xfaCaptionForCheckButton"),(_=m.attributes).class||(_.class=[]),m.children.splice(0,0,t),this.caption.placement){case"left":m.attributes.class.push("xfaLeft");break;case"right":m.attributes.class.push("xfaRight");break;case"top":m.attributes.class.push("xfaTop");break;case"bottom":m.attributes.class.push("xfaBottom");break;case"inline":m.attributes.class.push("xfaLeft");break}return this.w=i,this.h=s,Tt.success(Ud(this,d),g)}}class _V extends Ce{constructor(e){super($e,"fill",!0),this.id=e.id||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null,this.linear=null,this.pattern=null,this.radial=null,this.solid=null,this.stipple=null}[Rn](){var o;const e=this[Qt](),i=e[Qt]()[Qt](),s=Object.create(null);let r="color",a=r;e instanceof EM&&(r="background-color",a="background",i instanceof q4&&(s.backgroundColor="white")),(e instanceof BM||e instanceof IM)&&(r=a="fill",s.fill="white");for(const l of Object.getOwnPropertyNames(this)){if(l==="extras"||l==="color")continue;const c=this[l];if(!(c instanceof Ce))continue;const h=c[Rn](this.color);return h&&(s[h.startsWith("#")?r:a]=h),s}if((o=this.color)!=null&&o.value){const l=this.color[Rn]();s[l.startsWith("#")?r:a]=l}return s}}class kV extends Ce{constructor(e){super($e,"filter",!0),this.addRevocationInfo=Fe(e.addRevocationInfo,["","required","optional","none"]),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||"",this.version=Zt({data:this.version,defaultValue:5,validate:t=>t>=1&&t<=5}),this.appearanceFilter=null,this.certificates=null,this.digestMethods=null,this.encodings=null,this.encryptionMethods=null,this.handler=null,this.lockDocument=null,this.mdp=null,this.reasons=null,this.timeStamp=null}}class CV extends Hi{constructor(e){super($e,"float"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ti](){const e=parseFloat(this[Le].trim());this[Le]=isNaN(e)?null:e}[Gt](e){return Vh(this[Le]!==null?this[Le].toString():"")}}class AV extends Ce{constructor(e){super($e,"font",!0),this.baselineShift=bt(e.baselineShift),this.fontHorizontalScale=N3({data:e.fontHorizontalScale,defaultValue:100,validate:t=>t>=0}),this.fontVerticalScale=N3({data:e.fontVerticalScale,defaultValue:100,validate:t=>t>=0}),this.id=e.id||"",this.kerningMode=Fe(e.kerningMode,["none","pair"]),this.letterSpacing=bt(e.letterSpacing,"0"),this.lineThrough=Zt({data:e.lineThrough,defaultValue:0,validate:t=>t===1||t===2}),this.lineThroughPeriod=Fe(e.lineThroughPeriod,["all","word"]),this.overline=Zt({data:e.overline,defaultValue:0,validate:t=>t===1||t===2}),this.overlinePeriod=Fe(e.overlinePeriod,["all","word"]),this.posture=Fe(e.posture,["normal","italic"]),this.size=bt(e.size,"10pt"),this.typeface=e.typeface||"Courier",this.underline=Zt({data:e.underline,defaultValue:0,validate:t=>t===1||t===2}),this.underlinePeriod=Fe(e.underlinePeriod,["all","word"]),this.use=e.use||"",this.usehref=e.usehref||"",this.weight=Fe(e.weight,["normal","bold"]),this.extras=null,this.fill=null}[yo](e){super[yo](e),this[ei].usedTypefaces.add(this.typeface)}[Rn](){const e=$r(this,"fill"),t=e.color;return t&&(t==="#000000"?delete e.color:t.startsWith("#")||(e.background=t,e.backgroundClip="text",e.color="transparent")),this.baselineShift&&(e.verticalAlign=Jt(this.baselineShift)),e.fontKerning=this.kerningMode==="none"?"none":"normal",e.letterSpacing=Jt(this.letterSpacing),this.lineThrough!==0&&(e.textDecoration="line-through",this.lineThrough===2&&(e.textDecorationStyle="double")),this.overline!==0&&(e.textDecoration="overline",this.overline===2&&(e.textDecorationStyle="double")),e.fontStyle=this.posture,e.fontSize=Jt(.99*this.size),vM(this,this,this[ei].fontFinder,e),this.underline!==0&&(e.textDecoration="underline",this.underline===2&&(e.textDecorationStyle="double")),e.fontWeight=this.weight,e}}class SV extends Ce{constructor(e){super($e,"format",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.picture=null}}class IV extends bn{constructor(e){super($e,"handler"),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||""}}class EV extends Ce{constructor(e){super($e,"hyphenation"),this.excludeAllCaps=Zt({data:e.excludeAllCaps,defaultValue:0,validate:t=>t===1}),this.excludeInitialCap=Zt({data:e.excludeInitialCap,defaultValue:0,validate:t=>t===1}),this.hyphenate=Zt({data:e.hyphenate,defaultValue:0,validate:t=>t===1}),this.id=e.id||"",this.pushCharacterCount=Zt({data:e.pushCharacterCount,defaultValue:3,validate:t=>t>=0}),this.remainCharacterCount=Zt({data:e.remainCharacterCount,defaultValue:3,validate:t=>t>=0}),this.use=e.use||"",this.usehref=e.usehref||"",this.wordCharacterCount=Zt({data:e.wordCharacterCount,defaultValue:7,validate:t=>t>=0})}}let LM=class extends bn{constructor(e){super($e,"image"),this.aspect=Fe(e.aspect,["fit","actual","height","none","width"]),this.contentType=e.contentType||"",this.href=e.href||"",this.id=e.id||"",this.name=e.name||"",this.transferEncoding=Fe(e.transferEncoding,["base64","none","package"]),this.use=e.use||"",this.usehref=e.usehref||""}[Gt](){var r;if(this.contentType&&!BG.has(this.contentType.toLowerCase()))return Tt.EMPTY;let e=(r=this[ei].images)==null?void 0:r.get(this.href);if(!e&&(this.href||!this[Le])||(!e&&this.transferEncoding==="base64"&&(e=nU(this[Le])),!e))return Tt.EMPTY;if(!this.contentType){for(const[a,o]of UG)if(e.length>a.length&&a.every((l,c)=>l===e[c])){this.contentType=o;break}if(!this.contentType)return Tt.EMPTY}const t=new Blob([e],{type:this.contentType});let i;switch(this.aspect){case"fit":case"actual":break;case"height":i={height:"100%",objectFit:"fill"};break;case"none":i={width:"100%",height:"100%",objectFit:"fill"};break;case"width":i={width:"100%",objectFit:"fill"};break}const s=this[Qt]();return Tt.success({name:"img",attributes:{class:["xfaImage"],style:i,src:URL.createObjectURL(t),alt:s?Xd(s[Qt]()):null}})}};class TV extends Ce{constructor(e){super($e,"imageEdit",!0),this.data=Fe(e.data,["link","embed"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.extras=null,this.margin=null}[Gt](e){return this.data==="embed"?Tt.success({name:"div",children:[],attributes:{}}):Tt.EMPTY}}class RV extends Hi{constructor(e){super($e,"integer"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ti](){const e=parseInt(this[Le].trim(),10);this[Le]=isNaN(e)?null:e}[Gt](e){return Vh(this[Le]!==null?this[Le].toString():"")}}class MV extends Ce{constructor(e){super($e,"issuers",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.certificate=new ce}}class h6 extends Ce{constructor(e){super($e,"items",!0),this.id=e.id||"",this.name=e.name||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.ref=e.ref||"",this.save=Zt({data:e.save,defaultValue:0,validate:t=>t===1}),this.use=e.use||"",this.usehref=e.usehref||"",this.boolean=new ce,this.date=new ce,this.dateTime=new ce,this.decimal=new ce,this.exData=new ce,this.float=new ce,this.image=new ce,this.integer=new ce,this.text=new ce,this.time=new ce}[Gt](){const e=[];for(const t of this[Hs]())e.push(t[ms]());return Tt.success(e)}}class PV extends Ce{constructor(e){super($e,"keep",!0),this.id=e.id||"";const t=["none","contentArea","pageArea"];this.intact=Fe(e.intact,t),this.next=Fe(e.next,t),this.previous=Fe(e.previous,t),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}}class NV extends Ce{constructor(e){super($e,"keyUsage");const t=["","yes","no"];this.crlSign=Fe(e.crlSign,t),this.dataEncipherment=Fe(e.dataEncipherment,t),this.decipherOnly=Fe(e.decipherOnly,t),this.digitalSignature=Fe(e.digitalSignature,t),this.encipherOnly=Fe(e.encipherOnly,t),this.id=e.id||"",this.keyAgreement=Fe(e.keyAgreement,t),this.keyCertSign=Fe(e.keyCertSign,t),this.keyEncipherment=Fe(e.keyEncipherment,t),this.nonRepudiation=Fe(e.nonRepudiation,t),this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||""}}class OV extends Ce{constructor(e){super($e,"line",!0),this.hand=Fe(e.hand,["even","left","right"]),this.id=e.id||"",this.slope=Fe(e.slope,["\\","/"]),this.use=e.use||"",this.usehref=e.usehref||"",this.edge=null}[Gt](){const e=this[Qt]()[Qt](),t=this.edge||new fx({}),i=t[Rn](),s=Object.create(null),r=t.presence==="visible"?t.thickness:0;s.strokeWidth=Jt(r),s.stroke=i.color;let a,o,l,c,h="100%",u="100%";e.w<=r?([a,o,l,c]=["50%",0,"50%","100%"],h=s.strokeWidth):e.h<=r?([a,o,l,c]=[0,"50%","100%","50%"],u=s.strokeWidth):this.slope==="\\"?[a,o,l,c]=[0,0,"100%","100%"]:[a,o,l,c]=[0,"100%","100%",0];const f={name:"svg",children:[{name:"line",attributes:{xmlns:Hd,x1:a,y1:o,x2:l,y2:c,style:s}}],attributes:{xmlns:Hd,width:h,height:u,style:{overflow:"visible"}}};return B4(e)?Tt.success({name:"div",attributes:{style:{display:"inline",width:"100%",height:"100%"}},children:[f]}):(f.attributes.style.position="absolute",Tt.success(f))}}class DV extends Ce{constructor(e){super($e,"linear",!0),this.id=e.id||"",this.type=Fe(e.type,["toRight","toBottom","toLeft","toTop"]),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Rn](e){e=e?e[Rn]():"#FFFFFF";const t=this.type.replace(/([RBLT])/," $1").toLowerCase(),i=this.color?this.color[Rn]():"#000000";return`linear-gradient(${t}, ${e}, ${i})`}}class LV extends Hi{constructor(e){super($e,"lockDocument"),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||""}[ti](){this[Le]=Fe(this[Le],["auto","0","1"])}}class FV extends Ce{constructor(e){super($e,"manifest",!0),this.action=Fe(e.action,["include","all","exclude"]),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.ref=new ce}}class BV extends Ce{constructor(e){super($e,"margin",!0),this.bottomInset=bt(e.bottomInset,"0"),this.id=e.id||"",this.leftInset=bt(e.leftInset,"0"),this.rightInset=bt(e.rightInset,"0"),this.topInset=bt(e.topInset,"0"),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}[Rn](){return{margin:Jt(this.topInset)+" "+Jt(this.rightInset)+" "+Jt(this.bottomInset)+" "+Jt(this.leftInset)}}}class UV extends Ce{constructor(e){super($e,"mdp"),this.id=e.id||"",this.permissions=Zt({data:e.permissions,defaultValue:2,validate:t=>t===1||t===3}),this.signatureType=Fe(e.signatureType,["filler","author"]),this.use=e.use||"",this.usehref=e.usehref||""}}class HV extends Ce{constructor(e){super($e,"medium"),this.id=e.id||"",this.imagingBBox=AG(e.imagingBBox),this.long=bt(e.long),this.orientation=Fe(e.orientation,["portrait","landscape"]),this.short=bt(e.short),this.stock=e.stock||"",this.trayIn=Fe(e.trayIn,["auto","delegate","pageFront"]),this.trayOut=Fe(e.trayOut,["auto","delegate"]),this.use=e.use||"",this.usehref=e.usehref||""}}class zV extends Ce{constructor(e){super($e,"message",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.text=new ce}}class jV extends Ce{constructor(e){super($e,"numericEdit",!0),this.hScrollPolicy=Fe(e.hScrollPolicy,["auto","off","on"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.comb=null,this.extras=null,this.margin=null}[Gt](e){var r;const t=$r(this,"border","font","margin"),i=this[Qt]()[Qt](),s={name:"input",attributes:{type:"text",fieldId:i[qn],dataId:((r=i[go])==null?void 0:r[qn])||i[qn],class:["xfaTextfield"],style:t,"aria-label":Xd(i),"aria-required":!1}};return dx(i)&&(s.attributes["aria-required"]=!0,s.attributes.required=!0),Tt.success({name:"label",attributes:{class:["xfaLabel"]},children:[s]})}}class GV extends Ce{constructor(e){super($e,"occur",!0),this.id=e.id||"",this.initial=e.initial!==""?Zt({data:e.initial,defaultValue:"",validate:t=>!0}):"",this.max=e.max!==""?Zt({data:e.max,defaultValue:1,validate:t=>!0}):"",this.min=e.min!==""?Zt({data:e.min,defaultValue:1,validate:t=>!0}):"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}[yo](){const e=this[Qt](),t=this.min;this.min===""&&(this.min=e instanceof Mg||e instanceof Qp?0:1),this.max===""&&(t===""?this.max=e instanceof Mg||e instanceof Qp?-1:1:this.max=this.min),this.max!==-1&&this.max<this.min&&(this.max=this.min),this.initial===""&&(this.initial=e instanceof V4?1:this.min)}}class VV extends bn{constructor(e){super($e,"oid"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class qV extends Ce{constructor(e){super($e,"oids",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.oid=new ce}}class FM extends Ce{constructor(e){super($e,"overflow"),this.id=e.id||"",this.leader=e.leader||"",this.target=e.target||"",this.trailer=e.trailer||"",this.use=e.use||"",this.usehref=e.usehref||""}[cr](){if(!this[we]){const e=this[Qt](),t=this[Xi](),i=t[e0](this.target,e),s=t[e0](this.leader,e),r=t[e0](this.trailer,e);this[we]={target:(i==null?void 0:i[0])||null,leader:(s==null?void 0:s[0])||null,trailer:(r==null?void 0:r[0])||null,addLeader:!1,addTrailer:!1}}return this[we]}}class Mg extends Ce{constructor(e){super($e,"pageArea",!0),this.blankOrNotBlank=Fe(e.blankOrNotBlank,["any","blank","notBlank"]),this.id=e.id||"",this.initialNumber=Zt({data:e.initialNumber,defaultValue:1,validate:t=>!0}),this.name=e.name||"",this.numbered=Zt({data:e.numbered,defaultValue:1,validate:t=>!0}),this.oddOrEven=Fe(e.oddOrEven,["any","even","odd"]),this.pagePosition=Fe(e.pagePosition,["any","first","last","only","rest"]),this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.desc=null,this.extras=null,this.medium=null,this.occur=null,this.area=new ce,this.contentArea=new ce,this.draw=new ce,this.exclGroup=new ce,this.field=new ce,this.subform=new ce}[Zp](){return this[we]?!this.occur||this.occur.max===-1||this[we].numberOfUse<this.occur.max:(this[we]={numberOfUse:0},!0)}[Lf](){delete this[we]}[yc](){this[we]||(this[we]={numberOfUse:0});const e=this[Qt]();return e.relation==="orderedOccurrence"&&this[Zp]()?(this[we].numberOfUse+=1,this):e[yc]()}[Bd](){return this[we].space||{width:0,height:0}}[Gt](){this[we]||(this[we]={numberOfUse:1});const e=[];this[we].children=e;const t=Object.create(null);if(this.medium&&this.medium.short&&this.medium.long){if(t.width=Jt(this.medium.short),t.height=Jt(this.medium.long),this[we].space={width:this.medium.short,height:this.medium.long},this.medium.orientation==="landscape"){const i=t.width;t.width=t.height,t.height=i,this[we].space={width:this.medium.long,height:this.medium.short}}}else he("XFA - No medium specified in pageArea: please file a bug.");return this[Fh]({filter:new Set(["area","draw","field","subform"]),include:!0}),this[Fh]({filter:new Set(["contentArea"]),include:!0}),Tt.success({name:"div",children:e,attributes:{class:["xfaPage"],id:this[qn],style:t,xfaName:this.name}})}}class Qp extends Ce{constructor(e){super($e,"pageSet",!0),this.duplexImposition=Fe(e.duplexImposition,["longEdge","shortEdge"]),this.id=e.id||"",this.name=e.name||"",this.relation=Fe(e.relation,["orderedOccurrence","duplexPaginated","simplexPaginated"]),this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.occur=null,this.pageArea=new ce,this.pageSet=new ce}[Lf](){for(const e of this.pageArea.children)e[Lf]();for(const e of this.pageSet.children)e[Lf]()}[Zp](){return!this.occur||this.occur.max===-1||this[we].numberOfUse<this.occur.max}[yc](){if(this[we]||(this[we]={numberOfUse:1,pageIndex:-1,pageSetIndex:-1}),this.relation==="orderedOccurrence"){if(this[we].pageIndex+1<this.pageArea.children.length)return this[we].pageIndex+=1,this.pageArea.children[this[we].pageIndex][yc]();if(this[we].pageSetIndex+1<this.pageSet.children.length)return this[we].pageSetIndex+=1,this.pageSet.children[this[we].pageSetIndex][yc]();if(this[Zp]())return this[we].numberOfUse+=1,this[we].pageIndex=-1,this[we].pageSetIndex=-1,this[yc]();const r=this[Qt]();return r instanceof Qp?r[yc]():(this[Lf](),this[yc]())}const e=this[Xi]()[we].pageNumber,t=e%2===0?"even":"odd",i=e===0?"first":"rest";let s=this.pageArea.children.find(r=>r.oddOrEven===t&&r.pagePosition===i);return s||(s=this.pageArea.children.find(r=>r.oddOrEven==="any"&&r.pagePosition===i),s)||(s=this.pageArea.children.find(r=>r.oddOrEven==="any"&&r.pagePosition==="any"),s)?s:this.pageArea.children[0]}}class WV extends Ce{constructor(e){super($e,"para",!0),this.hAlign=Fe(e.hAlign,["left","center","justify","justifyAll","radix","right"]),this.id=e.id||"",this.lineHeight=e.lineHeight?bt(e.lineHeight,"0pt"):"",this.marginLeft=e.marginLeft?bt(e.marginLeft,"0pt"):"",this.marginRight=e.marginRight?bt(e.marginRight,"0pt"):"",this.orphans=Zt({data:e.orphans,defaultValue:0,validate:t=>t>=0}),this.preserve=e.preserve||"",this.radixOffset=e.radixOffset?bt(e.radixOffset,"0pt"):"",this.spaceAbove=e.spaceAbove?bt(e.spaceAbove,"0pt"):"",this.spaceBelow=e.spaceBelow?bt(e.spaceBelow,"0pt"):"",this.tabDefault=e.tabDefault?bt(this.tabDefault):"",this.tabStops=(e.tabStops||"").trim().split(/\s+/).map((t,i)=>i%2===1?bt(t):t),this.textIndent=e.textIndent?bt(e.textIndent,"0pt"):"",this.use=e.use||"",this.usehref=e.usehref||"",this.vAlign=Fe(e.vAlign,["top","bottom","middle"]),this.widows=Zt({data:e.widows,defaultValue:0,validate:t=>t>=0}),this.hyphenation=null}[Rn](){const e=$r(this,"hAlign");return this.marginLeft!==""&&(e.paddingLeft=Jt(this.marginLeft)),this.marginRight!==""&&(e.paddingRight=Jt(this.marginRight)),this.spaceAbove!==""&&(e.paddingTop=Jt(this.spaceAbove)),this.spaceBelow!==""&&(e.paddingBottom=Jt(this.spaceBelow)),this.textIndent!==""&&(e.textIndent=Jt(this.textIndent),xM(e)),this.lineHeight>0&&(e.lineHeight=Jt(this.lineHeight)),this.tabDefault!==""&&(e.tabSize=Jt(this.tabDefault)),this.tabStops.length>0,this.hyphenatation&&Object.assign(e,this.hyphenatation[Rn]()),e}}class KV extends Ce{constructor(e){super($e,"passwordEdit",!0),this.hScrollPolicy=Fe(e.hScrollPolicy,["auto","off","on"]),this.id=e.id||"",this.passwordChar=e.passwordChar||"*",this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.extras=null,this.margin=null}}class XV extends Ce{constructor(e){super($e,"pattern",!0),this.id=e.id||"",this.type=Fe(e.type,["crossHatch","crossDiagonal","diagonalLeft","diagonalRight","horizontal","vertical"]),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Rn](e){e=e?e[Rn]():"#FFFFFF";const t=this.color?this.color[Rn]():"#000000",i=5,s="repeating-linear-gradient",r=`${e},${e} ${i}px,${t} ${i}px,${t} ${2*i}px`;switch(this.type){case"crossHatch":return`${s}(to top,${r}) ${s}(to right,${r})`;case"crossDiagonal":return`${s}(45deg,${r}) ${s}(-45deg,${r})`;case"diagonalLeft":return`${s}(45deg,${r})`;case"diagonalRight":return`${s}(-45deg,${r})`;case"horizontal":return`${s}(to top,${r})`;case"vertical":return`${s}(to right,${r})`}return""}}class YV extends bn{constructor(e){super($e,"picture"),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||""}}class JV extends Ce{constructor(e){super($e,"proto",!0),this.appearanceFilter=new ce,this.arc=new ce,this.area=new ce,this.assist=new ce,this.barcode=new ce,this.bindItems=new ce,this.bookend=new ce,this.boolean=new ce,this.border=new ce,this.break=new ce,this.breakAfter=new ce,this.breakBefore=new ce,this.button=new ce,this.calculate=new ce,this.caption=new ce,this.certificate=new ce,this.certificates=new ce,this.checkButton=new ce,this.choiceList=new ce,this.color=new ce,this.comb=new ce,this.connect=new ce,this.contentArea=new ce,this.corner=new ce,this.date=new ce,this.dateTime=new ce,this.dateTimeEdit=new ce,this.decimal=new ce,this.defaultUi=new ce,this.desc=new ce,this.digestMethod=new ce,this.digestMethods=new ce,this.draw=new ce,this.edge=new ce,this.encoding=new ce,this.encodings=new ce,this.encrypt=new ce,this.encryptData=new ce,this.encryption=new ce,this.encryptionMethod=new ce,this.encryptionMethods=new ce,this.event=new ce,this.exData=new ce,this.exObject=new ce,this.exclGroup=new ce,this.execute=new ce,this.extras=new ce,this.field=new ce,this.fill=new ce,this.filter=new ce,this.float=new ce,this.font=new ce,this.format=new ce,this.handler=new ce,this.hyphenation=new ce,this.image=new ce,this.imageEdit=new ce,this.integer=new ce,this.issuers=new ce,this.items=new ce,this.keep=new ce,this.keyUsage=new ce,this.line=new ce,this.linear=new ce,this.lockDocument=new ce,this.manifest=new ce,this.margin=new ce,this.mdp=new ce,this.medium=new ce,this.message=new ce,this.numericEdit=new ce,this.occur=new ce,this.oid=new ce,this.oids=new ce,this.overflow=new ce,this.pageArea=new ce,this.pageSet=new ce,this.para=new ce,this.passwordEdit=new ce,this.pattern=new ce,this.picture=new ce,this.radial=new ce,this.reason=new ce,this.reasons=new ce,this.rectangle=new ce,this.ref=new ce,this.script=new ce,this.setProperty=new ce,this.signData=new ce,this.signature=new ce,this.signing=new ce,this.solid=new ce,this.speak=new ce,this.stipple=new ce,this.subform=new ce,this.subformSet=new ce,this.subjectDN=new ce,this.subjectDNs=new ce,this.submit=new ce,this.text=new ce,this.textEdit=new ce,this.time=new ce,this.timeStamp=new ce,this.toolTip=new ce,this.traversal=new ce,this.traverse=new ce,this.ui=new ce,this.validate=new ce,this.value=new ce,this.variables=new ce}}class ZV extends Ce{constructor(e){super($e,"radial",!0),this.id=e.id||"",this.type=Fe(e.type,["toEdge","toCenter"]),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Rn](e){e=e?e[Rn]():"#FFFFFF";const t=this.color?this.color[Rn]():"#000000";return`radial-gradient(circle at center, ${this.type==="toEdge"?`${e},${t}`:`${t},${e}`})`}}class QV extends bn{constructor(e){super($e,"reason"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class $V extends Ce{constructor(e){super($e,"reasons",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.reason=new ce}}class BM extends Ce{constructor(e){super($e,"rectangle",!0),this.hand=Fe(e.hand,["even","left","right"]),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.corner=new ce(4),this.edge=new ce(4),this.fill=null}[Gt](){var c;const e=this.edge.children.length?this.edge.children[0]:new fx({}),t=e[Rn](),i=Object.create(null);((c=this.fill)==null?void 0:c.presence)==="visible"?Object.assign(i,this.fill[Rn]()):i.fill="transparent",i.strokeWidth=Jt(e.presence==="visible"?e.thickness:0),i.stroke=t.color;const r=(this.corner.children.length?this.corner.children[0]:new NM({}))[Rn](),o={name:"svg",children:[{name:"rect",attributes:{xmlns:Hd,width:"100%",height:"100%",x:0,y:0,rx:r.radius,ry:r.radius,style:i}}],attributes:{xmlns:Hd,style:{overflow:"visible"},width:"100%",height:"100%"}},l=this[Qt]()[Qt]();return B4(l)?Tt.success({name:"div",attributes:{style:{display:"inline",width:"100%",height:"100%"}},children:[o]}):(o.attributes.style.position="absolute",Tt.success(o))}}class eq extends bn{constructor(e){super($e,"ref"),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||""}}class tq extends bn{constructor(e){super($e,"script"),this.binding=e.binding||"",this.contentType=e.contentType||"",this.id=e.id||"",this.name=e.name||"",this.runAt=Fe(e.runAt,["client","both","server"]),this.use=e.use||"",this.usehref=e.usehref||""}}class u6 extends Ce{constructor(e){super($e,"setProperty"),this.connection=e.connection||"",this.ref=e.ref||"",this.target=e.target||""}}class nq extends Ce{constructor(e){super($e,"signData",!0),this.id=e.id||"",this.operation=Fe(e.operation,["sign","clear","verify"]),this.ref=e.ref||"",this.target=e.target||"",this.use=e.use||"",this.usehref=e.usehref||"",this.filter=null,this.manifest=null}}class iq extends Ce{constructor(e){super($e,"signature",!0),this.id=e.id||"",this.type=Fe(e.type,["PDF1.3","PDF1.6"]),this.use=e.use||"",this.usehref=e.usehref||"",this.border=null,this.extras=null,this.filter=null,this.manifest=null,this.margin=null}}class sq extends Ce{constructor(e){super($e,"signing",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.certificate=new ce}}class rq extends Ce{constructor(e){super($e,"solid",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null}[Rn](e){return e?e[Rn]():"#FFFFFF"}}class aq extends bn{constructor(e){super($e,"speak"),this.disable=Zt({data:e.disable,defaultValue:0,validate:t=>t===1}),this.id=e.id||"",this.priority=Fe(e.priority,["custom","caption","name","toolTip"]),this.rid=e.rid||"",this.use=e.use||"",this.usehref=e.usehref||""}}class oq extends Ce{constructor(e){super($e,"stipple",!0),this.id=e.id||"",this.rate=Zt({data:e.rate,defaultValue:50,validate:t=>t>=0&&t<=100}),this.use=e.use||"",this.usehref=e.usehref||"",this.color=null,this.extras=null}[Rn](e){const t=this.rate/100;return Dn.makeHexColor(Math.round(e.value.r*(1-t)+this.value.r*t),Math.round(e.value.g*(1-t)+this.value.g*t),Math.round(e.value.b*(1-t)+this.value.b*t))}}class UM extends Ce{constructor(e){super($e,"subform",!0),this.access=Fe(e.access,["open","nonInteractive","protected","readOnly"]),this.allowMacro=Zt({data:e.allowMacro,defaultValue:0,validate:t=>t===1}),this.anchorType=Fe(e.anchorType,["topLeft","bottomCenter","bottomLeft","bottomRight","middleCenter","middleLeft","middleRight","topCenter","topRight"]),this.colSpan=Zt({data:e.colSpan,defaultValue:1,validate:t=>t>=1||t===-1}),this.columnWidths=(e.columnWidths||"").trim().split(/\s+/).map(t=>t==="-1"?-1:bt(t)),this.h=e.h?bt(e.h):"",this.hAlign=Fe(e.hAlign,["left","center","justify","justifyAll","radix","right"]),this.id=e.id||"",this.layout=Fe(e.layout,["position","lr-tb","rl-row","rl-tb","row","table","tb"]),this.locale=e.locale||"",this.maxH=bt(e.maxH,"0pt"),this.maxW=bt(e.maxW,"0pt"),this.mergeMode=Fe(e.mergeMode,["consumeData","matchTemplate"]),this.minH=bt(e.minH,"0pt"),this.minW=bt(e.minW,"0pt"),this.name=e.name||"",this.presence=Fe(e.presence,["visible","hidden","inactive","invisible"]),this.relevant=hl(e.relevant),this.restoreState=Fe(e.restoreState,["manual","auto"]),this.scope=Fe(e.scope,["name","none"]),this.use=e.use||"",this.usehref=e.usehref||"",this.w=e.w?bt(e.w):"",this.x=bt(e.x,"0pt"),this.y=bt(e.y,"0pt"),this.assist=null,this.bind=null,this.bookend=null,this.border=null,this.break=null,this.calculate=null,this.desc=null,this.extras=null,this.keep=null,this.margin=null,this.occur=null,this.overflow=null,this.pageSet=null,this.para=null,this.traversal=null,this.validate=null,this.variables=null,this.area=new ce,this.breakAfter=new ce,this.breakBefore=new ce,this.connect=new ce,this.draw=new ce,this.event=new ce,this.exObject=new ce,this.exclGroup=new ce,this.field=new ce,this.proto=new ce,this.setProperty=new ce,this.subform=new ce,this.subformSet=new ce}[Zi](){const e=this[Qt]();return e instanceof G4?e[Zi]():e}[of](){return!0}[b0](){return this.layout.endsWith("-tb")&&this[we].attempt===0&&this[we].numberInLine>0||this[Qt]()[b0]()}*[Rg](){yield*H4(this)}[ux](){return CM(this)}[Fd](e,t){AM(this,e,t)}[Bd](){return SM(this)}[r0](){var t;const e=this[Zi]();return e[r0]()?this[we]._isSplittable!==void 0?this[we]._isSplittable:this.layout==="position"||this.layout.includes("row")?(this[we]._isSplittable=!1,!1):this.keep&&this.keep.intact!=="none"?(this[we]._isSplittable=!1,!1):(t=e.layout)!=null&&t.endsWith("-tb")&&e[we].numberInLine!==0?!1:(this[we]._isSplittable=!0,!0):!1}[Gt](e){var v;if(cy(this),this.break){if(this.break.after!=="auto"||this.break.afterTarget!==""){const _=new TM({targetType:this.break.after,target:this.break.afterTarget,startNew:this.break.startNew.toString()});_[ei]=this[ei],this[Li](_),this.breakAfter.push(_)}if(this.break.before!=="auto"||this.break.beforeTarget!==""){const _=new RM({targetType:this.break.before,target:this.break.beforeTarget,startNew:this.break.startNew.toString()});_[ei]=this[ei],this[Li](_),this.breakBefore.push(_)}if(this.break.overflowTarget!==""){const _=new FM({target:this.break.overflowTarget,leader:this.break.overflowLeader,trailer:this.break.overflowTrailer});_[ei]=this[ei],this[Li](_),this.overflow.push(_)}this[Eh](this.break),this.break=null}if(this.presence==="hidden"||this.presence==="inactive")return Tt.EMPTY;if((this.breakBefore.children.length>1||this.breakAfter.children.length>1)&&he("XFA - Several breakBefore or breakAfter in subforms: please file a bug."),this.breakBefore.children.length>=1){const _=this.breakBefore.children[0];if(sC(_))return Tt.breakNode(_)}if((v=this[we])!=null&&v.afterBreakAfter)return Tt.EMPTY;oy(this);const t=[],i={id:this[qn],class:[]};F4(this,i.class),this[we]||(this[we]=Object.create(null)),Object.assign(this[we],{children:t,line:null,attributes:i,attempt:0,numberInLine:0,availableSpace:{width:Math.min(this.w||1/0,e.width),height:Math.min(this.h||1/0,e.height)},width:0,height:0,prevHeight:0,currentWidth:0});const s=this[Xi](),r=s[we].noLayoutFailure,a=this[r0]();if(a||uy(this),!ly(this,e))return Tt.FAILURE;const o=new Set(["area","draw","exclGroup","field","subform","subformSet"]);if(this.layout.includes("row")){const _=this[Zi]().columnWidths;Array.isArray(_)&&_.length>0&&(this[we].columnWidths=_,this[we].currentColumn=0)}const l=$r(this,"anchorType","dimensions","position","presence","border","margin","hAlign"),c=["xfaSubform"],h=bM(this);if(h&&c.push(h),i.style=l,i.class=c,this.name&&(i.xfaName=this.name),this.overflow){const _=this.overflow[cr]();_.addLeader&&(_.addLeader=!1,rC(this,_.leader,e))}this[Kg]();const u=this.layout==="lr-tb"||this.layout==="rl-tb",d=u?O3:1;for(;this[we].attempt<d;this[we].attempt++){u&&this[we].attempt===O3-1&&(this[we].numberInLine=0);const _=this[Fh]({filter:o,include:!0});if(_.success)break;if(_.isBreak())return this[ca](),_;if(u&&this[we].attempt===0&&this[we].numberInLine===0&&!s[we].noLayoutFailure){this[we].attempt=d;break}}if(this[ca](),a||dy(this),s[we].noLayoutFailure=r,this[we].attempt===d)return this.overflow&&(this[Xi]()[we].overflowNode=this.overflow),a||delete this[we],Tt.FAILURE;if(this.overflow){const _=this.overflow[cr]();_.addTrailer&&(_.addTrailer=!1,rC(this,_.trailer,e))}let f=0,g=0;this.margin&&(f=this.margin.leftInset+this.margin.rightInset,g=this.margin.topInset+this.margin.bottomInset);const m=Math.max(this[we].width+f,this.w||0),x=Math.max(this[we].height+g,this.h||0),p=[this.x,this.y,m,x];if(this.w===""&&(l.width=Jt(m)),this.h===""&&(l.height=Jt(x)),(l.width==="0px"||l.height==="0px")&&t.length===0)return Tt.EMPTY;const y={name:"div",attributes:i,children:t};hy(this,i);const w=Tt.success(Ud(this,y),p);if(this.breakAfter.children.length>=1){const _=this.breakAfter.children[0];if(sC(_))return this[we].afterBreakAfter=w,Tt.breakNode(_)}return delete this[we],w}}class G4 extends Ce{constructor(e){super($e,"subformSet",!0),this.id=e.id||"",this.name=e.name||"",this.relation=Fe(e.relation,["ordered","choice","unordered"]),this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.bookend=null,this.break=null,this.desc=null,this.extras=null,this.occur=null,this.overflow=null,this.breakAfter=new ce,this.breakBefore=new ce,this.subform=new ce,this.subformSet=new ce}*[Rg](){yield*H4(this)}[Zi](){let e=this[Qt]();for(;!(e instanceof UM);)e=e[Qt]();return e}[of](){return!0}}class lq extends Hi{constructor(e){super($e,"subjectDN"),this.delimiter=e.delimiter||",",this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ti](){this[Le]=new Map(this[Le].split(this.delimiter).map(e=>(e=e.split("=",2),e[0]=e[0].trim(),e)))}}class cq extends Ce{constructor(e){super($e,"subjectDNs",!0),this.id=e.id||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||"",this.subjectDN=new ce}}class hq extends Ce{constructor(e){super($e,"submit",!0),this.embedPDF=Zt({data:e.embedPDF,defaultValue:0,validate:t=>t===1}),this.format=Fe(e.format,["xdp","formdata","pdf","urlencoded","xfd","xml"]),this.id=e.id||"",this.target=e.target||"",this.textEncoding=ay({data:e.textEncoding?e.textEncoding.toLowerCase():"",defaultValue:"",validate:t=>["utf-8","big-five","fontspecific","gbk","gb-18030","gb-2312","ksc-5601","none","shift-jis","ucs-2","utf-16"].includes(t)||t.match(/iso-8859-\d{2}/)}),this.use=e.use||"",this.usehref=e.usehref||"",this.xdpContent=e.xdpContent||"",this.encrypt=null,this.encryptData=new ce,this.signData=new ce}}class V4 extends Ce{constructor(e){super($e,"template",!0),this.baseProfile=Fe(e.baseProfile,["full","interactiveForms"]),this.extras=null,this.subform=new ce}[ti](){this.subform.children.length===0&&he("XFA - No subforms in template node."),this.subform.children.length>=2&&he("XFA - Several subforms in template node: please file a bug."),this[Vo]=LG}[r0](){return!0}[e0](e,t){return e.startsWith("#")?[this[Rf].get(e.slice(1))]:S0(this,t,e,!0,!0)}*[hM](){var g,m,x;if(!this.subform.children.length)return Tt.success({name:"div",children:[]});this[we]={overflowNode:null,firstUnsplittable:null,currentContentArea:null,currentPageArea:null,noLayoutFailure:!1,pageNumber:1,pagePosition:"first",oddOrEven:"odd",blankOrNotBlank:"nonBlank",paraStack:[]};const e=this.subform.children[0];e.pageSet[Lf]();const t=e.pageSet.pageArea.children,i={name:"div",children:[]};let s=null,r=null,a=null;if(e.breakBefore.children.length>=1?(r=e.breakBefore.children[0],a=r.target):e.subform.children.length>=1&&e.subform.children[0].breakBefore.children.length>=1?(r=e.subform.children[0].breakBefore.children[0],a=r.target):(g=e.break)!=null&&g.beforeTarget?(r=e.break,a=r.beforeTarget):e.subform.children.length>=1&&((m=e.subform.children[0].break)!=null&&m.beforeTarget)&&(r=e.subform.children[0].break,a=r.beforeTarget),r){const p=this[e0](a,r[Qt]());p instanceof Mg&&(s=p,r[we]={})}s||(s=t[0]),s[we]={numberOfUse:1};const o=s[Qt]();o[we]={numberOfUse:1,pageIndex:o.pageArea.children.indexOf(s),pageSetIndex:0};let l,c=null,h=null,u=!0,d=0,f=0;for(;;){if(u)d=0;else if(i.children.pop(),++d===DG)return he("XFA - Something goes wrong: please file a bug."),i;l=null,this[we].currentPageArea=s;const p=s[Gt]().html;i.children.push(p),c&&(this[we].noLayoutFailure=!0,p.children.push(c[Gt](s[we].space).html),c=null),h&&(this[we].noLayoutFailure=!0,p.children.push(h[Gt](s[we].space).html),h=null);const y=s.contentArea.children,w=p.children.filter(_=>_.attributes.class.includes("xfaContentarea"));u=!1,this[we].firstUnsplittable=null,this[we].noLayoutFailure=!1;const v=_=>{var k;const C=e[ux]();C&&(u||(u=((k=C.children)==null?void 0:k.length)>0),w[_].children.push(C))};for(let _=f,C=y.length;_<C;_++){const k=this[we].currentContentArea=y[_],I={width:k.w,height:k.h};f=0,c&&(w[_].children.push(c[Gt](I).html),c=null),h&&(w[_].children.push(h[Gt](I).html),h=null);const S=e[Gt](I);if(S.success)return S.html?(u||(u=((x=S.html.children)==null?void 0:x.length)>0),w[_].children.push(S.html)):!u&&i.children.length>1&&i.children.pop(),i;if(S.isBreak()){const R=S.breakNode;if(v(_),R.targetType==="auto")continue;R.leader&&(c=this[e0](R.leader,R[Qt]()),c=c?c[0]:null),R.trailer&&(h=this[e0](R.trailer,R[Qt]()),h=h?h[0]:null),R.targetType==="pageArea"?(l=R[we].target,_=1/0):R[we].target?(l=R[we].target,f=R[we].index+1,_=1/0):_=R[we].index;continue}if(this[we].overflowNode){const R=this[we].overflowNode;this[we].overflowNode=null;const P=R[cr](),D=P.target;P.addLeader=P.leader!==null,P.addTrailer=P.trailer!==null,v(_);const U=_;if(_=1/0,D instanceof Mg)l=D;else if(D instanceof z4){const T=y.indexOf(D);T!==-1?T>U?_=T-1:f=T:(l=D[Qt](),f=l.contentArea.children.indexOf(D))}continue}v(_)}this[we].pageNumber+=1,l&&(l[Zp]()?l[we].numberOfUse+=1:l=null),s=l||s[yc](),yield null}}}class HM extends Hi{constructor(e){super($e,"text"),this.id=e.id||"",this.maxChars=Zt({data:e.maxChars,defaultValue:0,validate:t=>t>=0}),this.name=e.name||"",this.rid=e.rid||"",this.use=e.use||"",this.usehref=e.usehref||""}[iy](){return!0}[Zl](e){return e[Yi]===$i.xhtml.id?(this[Le]=e,!0):(he(`XFA - Invalid content in Text: ${e[On]}.`),!1)}[a0](e){this[Le]instanceof Ce||super[a0](e)}[ti](){typeof this[Le]=="string"&&(this[Le]=this[Le].replaceAll(`\r
`,`
`))}[cr](){return typeof this[Le]=="string"?this[Le].split(/[\u2029\u2028\n]/).filter(e=>!!e).join(`
`):this[Le][ms]()}[Gt](e){if(typeof this[Le]=="string"){const t=Vh(this[Le]).html;return this[Le].includes("\u2029")?(t.name="div",t.children=[],this[Le].split("\u2029").map(i=>i.split(/[\u2028\n]/).flatMap(s=>[{name:"span",value:s},{name:"br"}])).forEach(i=>{t.children.push({name:"p",children:i})})):/[\u2028\n]/.test(this[Le])&&(t.name="div",t.children=[],this[Le].split(/[\u2028\n]/).forEach(i=>{t.children.push({name:"span",value:i},{name:"br"})})),Tt.success(t)}return this[Le][Gt](e)}}class zM extends Ce{constructor(e){super($e,"textEdit",!0),this.allowRichText=Zt({data:e.allowRichText,defaultValue:0,validate:t=>t===1}),this.hScrollPolicy=Fe(e.hScrollPolicy,["auto","off","on"]),this.id=e.id||"",this.multiLine=Zt({data:e.multiLine,defaultValue:"",validate:t=>t===0||t===1}),this.use=e.use||"",this.usehref=e.usehref||"",this.vScrollPolicy=Fe(e.vScrollPolicy,["auto","off","on"]),this.border=null,this.comb=null,this.extras=null,this.margin=null}[Gt](e){var r,a;const t=$r(this,"border","font","margin");let i;const s=this[Qt]()[Qt]();return this.multiLine===""&&(this.multiLine=s instanceof OM?1:0),this.multiLine===1?i={name:"textarea",attributes:{dataId:((r=s[go])==null?void 0:r[qn])||s[qn],fieldId:s[qn],class:["xfaTextfield"],style:t,"aria-label":Xd(s),"aria-required":!1}}:i={name:"input",attributes:{type:"text",dataId:((a=s[go])==null?void 0:a[qn])||s[qn],fieldId:s[qn],class:["xfaTextfield"],style:t,"aria-label":Xd(s),"aria-required":!1}},dx(s)&&(i.attributes["aria-required"]=!0,i.attributes.required=!0),Tt.success({name:"label",attributes:{class:["xfaLabel"]},children:[i]})}}class uq extends bn{constructor(e){super($e,"time"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}[ti](){const e=this[Le].trim();this[Le]=e?new Date(e):null}[Gt](e){return Vh(this[Le]?this[Le].toString():"")}}class dq extends Ce{constructor(e){super($e,"timeStamp"),this.id=e.id||"",this.server=e.server||"",this.type=Fe(e.type,["optional","required"]),this.use=e.use||"",this.usehref=e.usehref||""}}class fq extends bn{constructor(e){super($e,"toolTip"),this.id=e.id||"",this.rid=e.rid||"",this.use=e.use||"",this.usehref=e.usehref||""}}class gq extends Ce{constructor(e){super($e,"traversal",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.traverse=new ce}}class mq extends Ce{constructor(e){super($e,"traverse",!0),this.id=e.id||"",this.operation=Fe(e.operation,["next","back","down","first","left","right","up"]),this.ref=e.ref||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.script=null}get name(){return this.operation}[Jp](){return!1}}class q4 extends Ce{constructor(e){super($e,"ui",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.picture=null,this.barcode=null,this.button=null,this.checkButton=null,this.choiceList=null,this.dateTimeEdit=null,this.defaultUi=null,this.imageEdit=null,this.numericEdit=null,this.passwordEdit=null,this.signature=null,this.textEdit=null}[cr](){if(this[we]===void 0){for(const e of Object.getOwnPropertyNames(this)){if(e==="extras"||e==="picture")continue;const t=this[e];if(t instanceof Ce)return this[we]=t,t}this[we]=null}return this[we]}[Gt](e){const t=this[cr]();return t?t[Gt](e):Tt.EMPTY}}class pq extends Ce{constructor(e){super($e,"validate",!0),this.formatTest=Fe(e.formatTest,["warning","disabled","error"]),this.id=e.id||"",this.nullTest=Fe(e.nullTest,["disabled","error","warning"]),this.scriptTest=Fe(e.scriptTest,["error","disabled","warning"]),this.use=e.use||"",this.usehref=e.usehref||"",this.extras=null,this.message=null,this.picture=null,this.script=null}}class W4 extends Ce{constructor(e){super($e,"value",!0),this.id=e.id||"",this.override=Zt({data:e.override,defaultValue:0,validate:t=>t===1}),this.relevant=hl(e.relevant),this.use=e.use||"",this.usehref=e.usehref||"",this.arc=null,this.boolean=null,this.date=null,this.dateTime=null,this.decimal=null,this.exData=null,this.float=null,this.image=null,this.integer=null,this.line=null,this.rectangle=null,this.text=null,this.time=null}[fa](e){var s;const t=this[Qt]();if(t instanceof j4&&(s=t.ui)!=null&&s.imageEdit){this.image||(this.image=new LM({}),this[Li](this.image)),this.image[Le]=e[Le];return}const i=e[On];if(this[i]!==null){this[i][Le]=e[Le];return}for(const r of Object.getOwnPropertyNames(this)){const a=this[r];a instanceof Ce&&(this[r]=null,this[Eh](a))}this[e[On]]=e,this[Li](e)}[ms](){if(this.exData)return typeof this.exData[Le]=="string"?this.exData[Le].trim():this.exData[Le][ms]().trim();for(const e of Object.getOwnPropertyNames(this)){if(e==="image")continue;const t=this[e];if(t instanceof Ce)return(t[Le]||"").toString().trim()}return null}[Gt](e){for(const t of Object.getOwnPropertyNames(this)){const i=this[t];if(i instanceof Ce)return i[Gt](e)}return Tt.EMPTY}}class bq extends Ce{constructor(e){super($e,"variables",!0),this.id=e.id||"",this.use=e.use||"",this.usehref=e.usehref||"",this.boolean=new ce,this.date=new ce,this.dateTime=new ce,this.decimal=new ce,this.exData=new ce,this.float=new ce,this.image=new ce,this.integer=new ce,this.manifest=new ce,this.script=new ce,this.text=new ce,this.time=new ce}[Jp](){return!0}}class D3{static[cl](e,t){if(D3.hasOwnProperty(e)){const i=D3[e](t);return i[cM](t),i}}static appearanceFilter(e){return new HG(e)}static arc(e){return new IM(e)}static area(e){return new zG(e)}static assist(e){return new jG(e)}static barcode(e){return new GG(e)}static bind(e){return new VG(e)}static bindItems(e){return new c6(e)}static bookend(e){return new qG(e)}static boolean(e){return new WG(e)}static border(e){return new EM(e)}static break(e){return new KG(e)}static breakAfter(e){return new TM(e)}static breakBefore(e){return new RM(e)}static button(e){return new XG(e)}static calculate(e){return new YG(e)}static caption(e){return new JG(e)}static certificate(e){return new ZG(e)}static certificates(e){return new QG(e)}static checkButton(e){return new MM(e)}static choiceList(e){return new PM(e)}static color(e){return new $G(e)}static comb(e){return new eV(e)}static connect(e){return new tV(e)}static contentArea(e){return new z4(e)}static corner(e){return new NM(e)}static date(e){return new nV(e)}static dateTime(e){return new iV(e)}static dateTimeEdit(e){return new sV(e)}static decimal(e){return new rV(e)}static defaultUi(e){return new aV(e)}static desc(e){return new oV(e)}static digestMethod(e){return new lV(e)}static digestMethods(e){return new cV(e)}static draw(e){return new OM(e)}static edge(e){return new fx(e)}static encoding(e){return new hV(e)}static encodings(e){return new uV(e)}static encrypt(e){return new dV(e)}static encryptData(e){return new fV(e)}static encryption(e){return new gV(e)}static encryptionMethod(e){return new mV(e)}static encryptionMethods(e){return new pV(e)}static event(e){return new bV(e)}static exData(e){return new xV(e)}static exObject(e){return new yV(e)}static exclGroup(e){return new DM(e)}static execute(e){return new wV(e)}static extras(e){return new vV(e)}static field(e){return new j4(e)}static fill(e){return new _V(e)}static filter(e){return new kV(e)}static float(e){return new CV(e)}static font(e){return new AV(e)}static format(e){return new SV(e)}static handler(e){return new IV(e)}static hyphenation(e){return new EV(e)}static image(e){return new LM(e)}static imageEdit(e){return new TV(e)}static integer(e){return new RV(e)}static issuers(e){return new MV(e)}static items(e){return new h6(e)}static keep(e){return new PV(e)}static keyUsage(e){return new NV(e)}static line(e){return new OV(e)}static linear(e){return new DV(e)}static lockDocument(e){return new LV(e)}static manifest(e){return new FV(e)}static margin(e){return new BV(e)}static mdp(e){return new UV(e)}static medium(e){return new HV(e)}static message(e){return new zV(e)}static numericEdit(e){return new jV(e)}static occur(e){return new GV(e)}static oid(e){return new VV(e)}static oids(e){return new qV(e)}static overflow(e){return new FM(e)}static pageArea(e){return new Mg(e)}static pageSet(e){return new Qp(e)}static para(e){return new WV(e)}static passwordEdit(e){return new KV(e)}static pattern(e){return new XV(e)}static picture(e){return new YV(e)}static proto(e){return new JV(e)}static radial(e){return new ZV(e)}static reason(e){return new QV(e)}static reasons(e){return new $V(e)}static rectangle(e){return new BM(e)}static ref(e){return new eq(e)}static script(e){return new tq(e)}static setProperty(e){return new u6(e)}static signData(e){return new nq(e)}static signature(e){return new iq(e)}static signing(e){return new sq(e)}static solid(e){return new rq(e)}static speak(e){return new aq(e)}static stipple(e){return new oq(e)}static subform(e){return new UM(e)}static subformSet(e){return new G4(e)}static subjectDN(e){return new lq(e)}static subjectDNs(e){return new cq(e)}static submit(e){return new hq(e)}static template(e){return new V4(e)}static text(e){return new HM(e)}static textEdit(e){return new zM(e)}static time(e){return new uq(e)}static timeStamp(e){return new dq(e)}static toolTip(e){return new fq(e)}static traversal(e){return new gq(e)}static traverse(e){return new mq(e)}static ui(e){return new q4(e)}static validate(e){return new pq(e)}static value(e){return new W4(e)}static variables(e){return new bq(e)}}const aC=$i.datasets.id;function t9(n){const e=new HM({});return e[Le]=n,e}class xq{constructor(e){var t;this.root=e,this.datasets=e.datasets,this.data=((t=e.datasets)==null?void 0:t.data)||new Ql($i.datasets.id,"data"),this.emptyMerge=this.data[Hs]().length===0,this.root.form=this.form=e.template[Xo]()}_isConsumeData(){return!this.emptyMerge&&this._mergeMode}_isMatchTemplate(){return!this._isConsumeData()}bind(){return this._bindElement(this.form,this.data),this.form}getData(){return this.data}_bindValue(e,t,i){var s,r;if(e[go]=t,e[Yp]())if(t[Ff]()){const a=t[P4]();e[fa](t9(a))}else if(e instanceof j4&&((r=(s=e.ui)==null?void 0:s.choiceList)==null?void 0:r.open)==="multiSelect"){const a=t[Hs]().map(o=>o[Le].trim()).join(`
`);e[fa](t9(a))}else this._isConsumeData()&&he("XFA - Nodes haven't the same type.");else!t[Ff]()||this._isMatchTemplate()?this._bindElement(e,t):he("XFA - Nodes haven't the same type.")}_findDataByNameToConsume(e,t,i,s){if(!e)return null;let r,a;for(let o=0;o<3;o++){for(r=i[xp](e,!1,!0);a=r.next().value,!!a;)if(t===a[Ff]())return a;if(i[Yi]===$i.datasets.id&&i[On]==="data")break;i=i[Qt]()}return s?(r=this.data[xp](e,!0,!1),a=r.next().value,a||(r=this.data[s6](e,!0),a=r.next().value,a!=null&&a[Ff]())?a:null):null}_setProperties(e,t){if(e.hasOwnProperty("setProperty"))for(const{ref:i,target:s,connection:r}of e.setProperty.children){if(r||!i)continue;const a=S0(this.root,t,i,!1,!1);if(!a){he(`XFA - Invalid reference: ${i}.`);continue}const[o]=a;if(!o[R0](this.data)){he("XFA - Invalid node: must be a data node.");continue}const l=S0(this.root,e,s,!1,!1);if(!l){he(`XFA - Invalid target: ${s}.`);continue}const[c]=l;if(!c[R0](e)){he("XFA - Invalid target: must be a property or subproperty.");continue}const h=c[Qt]();if(c instanceof u6||h instanceof u6){he("XFA - Invalid target: cannot be a setProperty or one of its properties.");continue}if(c instanceof c6||h instanceof c6){he("XFA - Invalid target: cannot be a bindItems or one of its properties.");continue}const u=o[ms](),d=c[On];if(c instanceof D4){const f=Object.create(null);f[d]=u;const g=Reflect.construct(Object.getPrototypeOf(h).constructor,[f]);h[d]=g[d];continue}if(!c.hasOwnProperty(Le)){he("XFA - Invalid node to use in setProperty");continue}c[go]=o,c[Le]=u,c[ti]()}}_bindItems(e,t){if(!e.hasOwnProperty("items")||!e.hasOwnProperty("bindItems")||e.bindItems.isEmpty())return;for(const r of e.items.children)e[Eh](r);e.items.clear();const i=new h6({}),s=new h6({});e[Li](i),e.items.push(i),e[Li](s),e.items.push(s);for(const{ref:r,labelRef:a,valueRef:o,connection:l}of e.bindItems.children){if(l||!r)continue;const c=S0(this.root,t,r,!1,!1);if(!c){he(`XFA - Invalid reference: ${r}.`);continue}for(const h of c){if(!h[R0](this.datasets)){he(`XFA - Invalid ref (${r}): must be a datasets child.`);continue}const u=S0(this.root,h,a,!0,!1);if(!u){he(`XFA - Invalid label: ${a}.`);continue}const[d]=u;if(!d[R0](this.datasets)){he("XFA - Invalid label: must be a datasets child.");continue}const f=S0(this.root,h,o,!0,!1);if(!f){he(`XFA - Invalid value: ${o}.`);continue}const[g]=f;if(!g[R0](this.datasets)){he("XFA - Invalid value: must be a datasets child.");continue}const m=t9(d[ms]()),x=t9(g[ms]());i[Li](m),i.text.push(m),s[Li](x),s.text.push(x)}}}_bindOccurrences(e,t,i){let s;if(t.length>1&&(s=e[Xo](),s[Eh](s.occur),s.occur=null),this._bindValue(e,t[0],i),this._setProperties(e,t[0]),this._bindItems(e,t[0]),t.length===1)return;const r=e[Qt](),a=e[On],o=r[r6](e);for(let l=1,c=t.length;l<c;l++){const h=t[l],u=s[Xo]();r[a].push(u),r[r3](o+l,u),this._bindValue(u,h,i),this._setProperties(u,h),this._bindItems(u,h)}}_createOccurrences(e){if(!this.emptyMerge)return;const{occur:t}=e;if(!t||t.initial<=1)return;const i=e[Qt](),s=e[On];if(!(i[s]instanceof ce))return;let r;e.name?r=i[s].children.filter(l=>l.name===e.name).length:r=i[s].children.length;const a=i[r6](e)+1,o=t.initial-r;if(o){const l=e[Xo]();l[Eh](l.occur),l.occur=null,i[s].push(l),i[r3](a,l);for(let c=1;c<o;c++){const h=l[Xo]();i[s].push(h),i[r3](a+c,h)}}}_getOccurInfo(e){const{name:t,occur:i}=e;if(!i||!t)return[1,1];const s=i.max===-1?1/0:i.max;return[i.min,s]}_setAndBind(e,t){this._setProperties(e,t),this._bindItems(e,t),this._bindElement(e,t)}_bindElement(e,t){const i=[];this._createOccurrences(e);for(const s of e[Hs]()){if(s[go])continue;if(this._mergeMode===void 0&&s[On]==="subform"){this._mergeMode=s.mergeMode==="consumeData";const u=t[Hs]();if(u.length>0)this._bindOccurrences(s,[u[0]],null);else if(this.emptyMerge){const d=t[Yi]===aC?-1:t[Yi],f=s[go]=new Ql(d,s.name||"root");t[Li](f),this._bindElement(s,f)}continue}if(!s[of]())continue;let r=!1,a=null,o=null,l=null;if(s.bind){switch(s.bind.match){case"none":this._setAndBind(s,t);continue;case"global":r=!0;break;case"dataRef":if(!s.bind.ref){he(`XFA - ref is empty in node ${s[On]}.`),this._setAndBind(s,t);continue}o=s.bind.ref;break}s.bind.picture&&(a=s.bind.picture[Le])}const[c,h]=this._getOccurInfo(s);if(o)if(l=S0(this.root,t,o,!0,!1),l===null){if(l=NG(this.data,t,o),!l)continue;this._isConsumeData()&&(l[Vl]=!0),this._setAndBind(s,l);continue}else this._isConsumeData()&&(l=l.filter(u=>!u[Vl])),l.length>h?l=l.slice(0,h):l.length===0&&(l=null),l&&this._isConsumeData()&&l.forEach(u=>{u[Vl]=!0});else{if(!s.name){this._setAndBind(s,t);continue}if(this._isConsumeData()){const u=[];for(;u.length<h;){const d=this._findDataByNameToConsume(s.name,s[Yp](),t,r);if(!d)break;d[Vl]=!0,u.push(d)}l=u.length>0?u:null}else{if(l=t[xp](s.name,!1,this.emptyMerge).next().value,!l){if(c===0){i.push(s);continue}const u=t[Yi]===aC?-1:t[Yi];l=s[go]=new Ql(u,s.name),this.emptyMerge&&(l[Vl]=!0),t[Li](l),this._setAndBind(s,l);continue}this.emptyMerge&&(l[Vl]=!0),l=[l]}}l?this._bindOccurrences(s,l,a):c>0?this._setAndBind(s,t):i.push(s)}i.forEach(s=>s[Qt]()[Eh](s))}}class yq{constructor(e,t){this.data=t,this.dataset=e.datasets||null}serialize(e){const t=[[-1,this.data[Hs]()]];for(;t.length>0;){const s=t.at(-1),[r,a]=s;if(r+1===a.length){t.pop();continue}const o=a[++s[0]],l=e.get(o[qn]);if(l)o[fa](l);else{const h=o[oM]();for(const u of h.values()){const d=e.get(u[qn]);if(d){u[fa](d);break}}}const c=o[Hs]();c.length>0&&t.push([-1,c])}const i=['<xfa:datasets xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/">'];if(this.dataset)for(const s of this.dataset[Hs]())s[On]!=="data"&&s[wp](i);return this.data[wp](i),i.push("</xfa:datasets>"),i.join("")}}const Ue=$i.config.id;class wq extends Ce{constructor(e){super(Ue,"acrobat",!0),this.acrobat7=null,this.autoSave=null,this.common=null,this.validate=null,this.validateApprovalSignatures=null,this.submitUrl=new ce}}class vq extends Ce{constructor(e){super(Ue,"acrobat7",!0),this.dynamicRender=null}}class _q extends Wn{constructor(e){super(Ue,"ADBE_JSConsole",["delegate","Enable","Disable"])}}class kq extends Wn{constructor(e){super(Ue,"ADBE_JSDebugger",["delegate","Enable","Disable"])}}class Cq extends bs{constructor(e){super(Ue,"addSilentPrint")}}class Aq extends bs{constructor(e){super(Ue,"addViewerPreferences")}}class Sq extends gM{constructor(e){super(Ue,"adjustData")}}class Iq extends ul{constructor(e){super(Ue,"adobeExtensionLevel",0,t=>t>=1&&t<=8)}}class Eq extends Ce{constructor(e){super(Ue,"agent",!0),this.name=e.name?e.name.trim():"",this.common=new ce}}class Tq extends Hi{constructor(e){super(Ue,"alwaysEmbed")}}class Rq extends bn{constructor(e){super(Ue,"amd")}}class Mq extends Ce{constructor(e){super(Ue,"area"),this.level=Zt({data:e.level,defaultValue:0,validate:t=>t>=1&&t<=3}),this.name=Fe(e.name,["","barcode","coreinit","deviceDriver","font","general","layout","merge","script","signature","sourceSet","templateCache"])}}class Pq extends Wn{constructor(e){super(Ue,"attributes",["preserve","delegate","ignore"])}}class Nq extends Wn{constructor(e){super(Ue,"autoSave",["disabled","enabled"])}}class Oq extends bn{constructor(e){super(Ue,"base")}}class Dq extends Ce{constructor(e){super(Ue,"batchOutput"),this.format=Fe(e.format,["none","concat","zip","zipCompress"])}}class Lq extends Hi{constructor(e){super(Ue,"behaviorOverride")}[ti](){this[Le]=new Map(this[Le].trim().split(/\s+/).filter(e=>e.includes(":")).map(e=>e.split(":",2)))}}class Fq extends Ce{constructor(e){super(Ue,"cache",!0),this.templateCache=null}}class Bq extends bs{constructor(e){super(Ue,"change")}}class Uq extends Ce{constructor(e){super(Ue,"common",!0),this.data=null,this.locale=null,this.localeSet=null,this.messaging=null,this.suppressBanner=null,this.template=null,this.validationMessaging=null,this.versionControl=null,this.log=new ce}}class Hq extends Ce{constructor(e){super(Ue,"compress"),this.scope=Fe(e.scope,["imageOnly","document"])}}class zq extends bs{constructor(e){super(Ue,"compressLogicalStructure")}}class jq extends gM{constructor(e){super(Ue,"compressObjectStream")}}class Gq extends Ce{constructor(e){super(Ue,"compression",!0),this.compressLogicalStructure=null,this.compressObjectStream=null,this.level=null,this.type=null}}class Vq extends Ce{constructor(e){super(Ue,"config",!0),this.acrobat=null,this.present=null,this.trace=null,this.agent=new ce}}class qq extends Wn{constructor(e){super(Ue,"conformance",["A","B"])}}class Wq extends bs{constructor(e){super(Ue,"contentCopy")}}class Kq extends ul{constructor(e){super(Ue,"copies",1,t=>t>=1)}}class Xq extends bn{constructor(e){super(Ue,"creator")}}class Yq extends ul{constructor(e){super(Ue,"currentPage",0,t=>t>=0)}}class Jq extends Ce{constructor(e){super(Ue,"data",!0),this.adjustData=null,this.attributes=null,this.incrementalLoad=null,this.outputXSL=null,this.range=null,this.record=null,this.startNode=null,this.uri=null,this.window=null,this.xsl=null,this.excludeNS=new ce,this.transform=new ce}}class Zq extends Ce{constructor(e){super(Ue,"debug",!0),this.uri=null}}class Qq extends Hi{constructor(e){super(Ue,"defaultTypeface"),this.writingScript=Fe(e.writingScript,["*","Arabic","Cyrillic","EastEuropeanRoman","Greek","Hebrew","Japanese","Korean","Roman","SimplifiedChinese","Thai","TraditionalChinese","Vietnamese"])}}class $q extends Wn{constructor(e){super(Ue,"destination",["pdf","pcl","ps","webClient","zpl"])}}class eW extends bs{constructor(e){super(Ue,"documentAssembly")}}class tW extends Ce{constructor(e){super(Ue,"driver",!0),this.name=e.name?e.name.trim():"",this.fontInfo=null,this.xdc=null}}class nW extends Wn{constructor(e){super(Ue,"duplexOption",["simplex","duplexFlipLongEdge","duplexFlipShortEdge"])}}class iW extends Wn{constructor(e){super(Ue,"dynamicRender",["forbidden","required"])}}class sW extends bs{constructor(e){super(Ue,"embed")}}class rW extends bs{constructor(e){super(Ue,"encrypt")}}class aW extends Ce{constructor(e){super(Ue,"encryption",!0),this.encrypt=null,this.encryptionLevel=null,this.permissions=null}}class oW extends Wn{constructor(e){super(Ue,"encryptionLevel",["40bit","128bit"])}}class lW extends bn{constructor(e){super(Ue,"enforce")}}class cW extends Ce{constructor(e){super(Ue,"equate"),this.force=Zt({data:e.force,defaultValue:1,validate:t=>t===0}),this.from=e.from||"",this.to=e.to||""}}class hW extends Ce{constructor(e){super(Ue,"equateRange"),this.from=e.from||"",this.to=e.to||"",this._unicodeRange=e.unicodeRange||""}get unicodeRange(){const e=[],t=/U\+([0-9a-fA-F]+)/,i=this._unicodeRange;for(let s of i.split(",").map(r=>r.trim()).filter(r=>!!r))s=s.split("-",2).map(r=>{const a=r.match(t);return a?parseInt(a[1],16):0}),s.length===1&&s.push(s[0]),e.push(s);return Ze(this,"unicodeRange",e)}}class uW extends Hi{constructor(e){super(Ue,"exclude")}[ti](){this[Le]=this[Le].trim().split(/\s+/).filter(e=>e&&["calculate","close","enter","exit","initialize","ready","validate"].includes(e))}}class dW extends bn{constructor(e){super(Ue,"excludeNS")}}class fW extends Wn{constructor(e){super(Ue,"flipLabel",["usePrinterSetting","on","off"])}}class gW extends Ce{constructor(e){super(Ue,"fontInfo",!0),this.embed=null,this.map=null,this.subsetBelow=null,this.alwaysEmbed=new ce,this.defaultTypeface=new ce,this.neverEmbed=new ce}}class mW extends bs{constructor(e){super(Ue,"formFieldFilling")}}class pW extends bn{constructor(e){super(Ue,"groupParent")}}class bW extends Wn{constructor(e){super(Ue,"ifEmpty",["dataValue","dataGroup","ignore","remove"])}}class xW extends bn{constructor(e){super(Ue,"includeXDPContent")}}class yW extends Wn{constructor(e){super(Ue,"incrementalLoad",["none","forwardOnly"])}}class wW extends bs{constructor(e){super(Ue,"incrementalMerge")}}class vW extends bs{constructor(e){super(Ue,"interactive")}}class _W extends Wn{constructor(e){super(Ue,"jog",["usePrinterSetting","none","pageSet"])}}class kW extends Ce{constructor(e){super(Ue,"labelPrinter",!0),this.name=Fe(e.name,["zpl","dpl","ipl","tcpl"]),this.batchOutput=null,this.flipLabel=null,this.fontInfo=null,this.xdc=null}}class CW extends Wn{constructor(e){super(Ue,"layout",["paginate","panel"])}}class AW extends ul{constructor(e){super(Ue,"level",0,t=>t>0)}}class SW extends bs{constructor(e){super(Ue,"linearized")}}class IW extends bn{constructor(e){super(Ue,"locale")}}class EW extends bn{constructor(e){super(Ue,"localeSet")}}class TW extends Ce{constructor(e){super(Ue,"log",!0),this.mode=null,this.threshold=null,this.to=null,this.uri=null}}class RW extends Ce{constructor(e){super(Ue,"map",!0),this.equate=new ce,this.equateRange=new ce}}class MW extends Ce{constructor(e){super(Ue,"mediumInfo",!0),this.map=null}}class PW extends Ce{constructor(e){super(Ue,"message",!0),this.msgId=null,this.severity=null}}class NW extends Ce{constructor(e){super(Ue,"messaging",!0),this.message=new ce}}class OW extends Wn{constructor(e){super(Ue,"mode",["append","overwrite"])}}class DW extends bs{constructor(e){super(Ue,"modifyAnnots")}}class LW extends ul{constructor(e){super(Ue,"msgId",1,t=>t>=1)}}class FW extends bn{constructor(e){super(Ue,"nameAttr")}}class BW extends Hi{constructor(e){super(Ue,"neverEmbed")}}class UW extends ul{constructor(e){super(Ue,"numberOfCopies",null,t=>t>=2&&t<=5)}}class HW extends Ce{constructor(e){super(Ue,"openAction",!0),this.destination=null}}class zW extends Ce{constructor(e){super(Ue,"output",!0),this.to=null,this.type=null,this.uri=null}}class jW extends bn{constructor(e){super(Ue,"outputBin")}}class GW extends Ce{constructor(e){super(Ue,"outputXSL",!0),this.uri=null}}class VW extends Wn{constructor(e){super(Ue,"overprint",["none","both","draw","field"])}}class qW extends bn{constructor(e){super(Ue,"packets")}[ti](){this[Le]!=="*"&&(this[Le]=this[Le].trim().split(/\s+/).filter(e=>["config","datasets","template","xfdf","xslt"].includes(e)))}}class WW extends Ce{constructor(e){super(Ue,"pageOffset"),this.x=Zt({data:e.x,defaultValue:"useXDCSetting",validate:t=>!0}),this.y=Zt({data:e.y,defaultValue:"useXDCSetting",validate:t=>!0})}}class KW extends bn{constructor(e){super(Ue,"pageRange")}[ti](){const e=this[Le].trim().split(/\s+/).map(i=>parseInt(i,10)),t=[];for(let i=0,s=e.length;i<s;i+=2)t.push(e.slice(i,i+2));this[Le]=t}}class XW extends Wn{constructor(e){super(Ue,"pagination",["simplex","duplexShortEdge","duplexLongEdge"])}}class YW extends Wn{constructor(e){super(Ue,"paginationOverride",["none","forceDuplex","forceDuplexLongEdge","forceDuplexShortEdge","forceSimplex"])}}class JW extends ul{constructor(e){super(Ue,"part",1,t=>!1)}}class ZW extends Ce{constructor(e){super(Ue,"pcl",!0),this.name=e.name||"",this.batchOutput=null,this.fontInfo=null,this.jog=null,this.mediumInfo=null,this.outputBin=null,this.pageOffset=null,this.staple=null,this.xdc=null}}class QW extends Ce{constructor(e){super(Ue,"pdf",!0),this.name=e.name||"",this.adobeExtensionLevel=null,this.batchOutput=null,this.compression=null,this.creator=null,this.encryption=null,this.fontInfo=null,this.interactive=null,this.linearized=null,this.openAction=null,this.pdfa=null,this.producer=null,this.renderPolicy=null,this.scriptModel=null,this.silentPrint=null,this.submitFormat=null,this.tagged=null,this.version=null,this.viewerPreferences=null,this.xdc=null}}class $W extends Ce{constructor(e){super(Ue,"pdfa",!0),this.amd=null,this.conformance=null,this.includeXDPContent=null,this.part=null}}class eK extends Ce{constructor(e){super(Ue,"permissions",!0),this.accessibleContent=null,this.change=null,this.contentCopy=null,this.documentAssembly=null,this.formFieldFilling=null,this.modifyAnnots=null,this.plaintextMetadata=null,this.print=null,this.printHighQuality=null}}class tK extends bs{constructor(e){super(Ue,"pickTrayByPDFSize")}}class nK extends bn{constructor(e){super(Ue,"picture")}}class iK extends bs{constructor(e){super(Ue,"plaintextMetadata")}}class sK extends Wn{constructor(e){super(Ue,"presence",["preserve","dissolve","dissolveStructure","ignore","remove"])}}class rK extends Ce{constructor(e){super(Ue,"present",!0),this.behaviorOverride=null,this.cache=null,this.common=null,this.copies=null,this.destination=null,this.incrementalMerge=null,this.layout=null,this.output=null,this.overprint=null,this.pagination=null,this.paginationOverride=null,this.script=null,this.validate=null,this.xdp=null,this.driver=new ce,this.labelPrinter=new ce,this.pcl=new ce,this.pdf=new ce,this.ps=new ce,this.submitUrl=new ce,this.webClient=new ce,this.zpl=new ce}}class aK extends bs{constructor(e){super(Ue,"print")}}class oK extends bs{constructor(e){super(Ue,"printHighQuality")}}class lK extends Wn{constructor(e){super(Ue,"printScaling",["appdefault","noScaling"])}}class cK extends bn{constructor(e){super(Ue,"printerName")}}class hK extends bn{constructor(e){super(Ue,"producer")}}class uK extends Ce{constructor(e){super(Ue,"ps",!0),this.name=e.name||"",this.batchOutput=null,this.fontInfo=null,this.jog=null,this.mediumInfo=null,this.outputBin=null,this.staple=null,this.xdc=null}}let dK=class extends Hi{constructor(e){super(Ue,"range")}[ti](){this[Le]=this[Le].split(",",2).map(e=>e.split("-").map(t=>parseInt(t.trim(),10))).filter(e=>e.every(t=>!isNaN(t))).map(e=>(e.length===1&&e.push(e[0]),e))}};class fK extends Hi{constructor(e){super(Ue,"record")}[ti](){this[Le]=this[Le].trim();const e=parseInt(this[Le],10);!isNaN(e)&&e>=0&&(this[Le]=e)}}class gK extends Hi{constructor(e){super(Ue,"relevant")}[ti](){this[Le]=this[Le].trim().split(/\s+/)}}class mK extends Hi{constructor(e){super(Ue,"rename")}[ti](){this[Le]=this[Le].trim(),(this[Le].toLowerCase().startsWith("xml")||new RegExp("[\\p{L}_][\\p{L}\\d._\\p{M}-]*","u").test(this[Le]))&&he("XFA - Rename: invalid XFA name")}}class pK extends Wn{constructor(e){super(Ue,"renderPolicy",["server","client"])}}class bK extends Wn{constructor(e){super(Ue,"runScripts",["both","client","none","server"])}}class xK extends Ce{constructor(e){super(Ue,"script",!0),this.currentPage=null,this.exclude=null,this.runScripts=null}}class yK extends Wn{constructor(e){super(Ue,"scriptModel",["XFA","none"])}}class wK extends Wn{constructor(e){super(Ue,"severity",["ignore","error","information","trace","warning"])}}class vK extends Ce{constructor(e){super(Ue,"silentPrint",!0),this.addSilentPrint=null,this.printerName=null}}class _K extends Ce{constructor(e){super(Ue,"staple"),this.mode=Fe(e.mode,["usePrinterSetting","on","off"])}}class kK extends bn{constructor(e){super(Ue,"startNode")}}class CK extends ul{constructor(e){super(Ue,"startPage",0,t=>!0)}}class AK extends Wn{constructor(e){super(Ue,"submitFormat",["html","delegate","fdf","xml","pdf"])}}class SK extends bn{constructor(e){super(Ue,"submitUrl")}}class IK extends ul{constructor(e){super(Ue,"subsetBelow",100,t=>t>=0&&t<=100)}}class EK extends bs{constructor(e){super(Ue,"suppressBanner")}}class TK extends bs{constructor(e){super(Ue,"tagged")}}class RK extends Ce{constructor(e){super(Ue,"template",!0),this.base=null,this.relevant=null,this.startPage=null,this.uri=null,this.xsl=null}}class MK extends Wn{constructor(e){super(Ue,"threshold",["trace","error","information","warning"])}}class PK extends Wn{constructor(e){super(Ue,"to",["null","memory","stderr","stdout","system","uri"])}}class NK extends Ce{constructor(e){super(Ue,"templateCache"),this.maxEntries=Zt({data:e.maxEntries,defaultValue:5,validate:t=>t>=0})}}class OK extends Ce{constructor(e){super(Ue,"trace",!0),this.area=new ce}}class DK extends Ce{constructor(e){super(Ue,"transform",!0),this.groupParent=null,this.ifEmpty=null,this.nameAttr=null,this.picture=null,this.presence=null,this.rename=null,this.whitespace=null}}class LK extends Wn{constructor(e){super(Ue,"type",["none","ascii85","asciiHex","ccittfax","flate","lzw","runLength","native","xdp","mergedXDP"])}}class FK extends bn{constructor(e){super(Ue,"uri")}}class BK extends Wn{constructor(e){super(Ue,"validate",["preSubmit","prePrint","preExecute","preSave"])}}class UK extends Hi{constructor(e){super(Ue,"validateApprovalSignatures")}[ti](){this[Le]=this[Le].trim().split(/\s+/).filter(e=>["docReady","postSign"].includes(e))}}class HK extends Wn{constructor(e){super(Ue,"validationMessaging",["allMessagesIndividually","allMessagesTogether","firstMessageOnly","noMessages"])}}class zK extends Wn{constructor(e){super(Ue,"version",["1.7","1.6","1.5","1.4","1.3","1.2"])}}class jK extends Ce{constructor(e){super(Ue,"VersionControl"),this.outputBelow=Fe(e.outputBelow,["warn","error","update"]),this.sourceAbove=Fe(e.sourceAbove,["warn","error"]),this.sourceBelow=Fe(e.sourceBelow,["update","maintain"])}}class GK extends Ce{constructor(e){super(Ue,"viewerPreferences",!0),this.ADBE_JSConsole=null,this.ADBE_JSDebugger=null,this.addViewerPreferences=null,this.duplexOption=null,this.enforce=null,this.numberOfCopies=null,this.pageRange=null,this.pickTrayByPDFSize=null,this.printScaling=null}}class VK extends Ce{constructor(e){super(Ue,"webClient",!0),this.name=e.name?e.name.trim():"",this.fontInfo=null,this.xdc=null}}class qK extends Wn{constructor(e){super(Ue,"whitespace",["preserve","ltrim","normalize","rtrim","trim"])}}class WK extends Hi{constructor(e){super(Ue,"window")}[ti](){const e=this[Le].split(",",2).map(t=>parseInt(t.trim(),10));if(e.some(t=>isNaN(t))){this[Le]=[0,0];return}e.length===1&&e.push(e[0]),this[Le]=e}}class KK extends Ce{constructor(e){super(Ue,"xdc",!0),this.uri=new ce,this.xsl=new ce}}class XK extends Ce{constructor(e){super(Ue,"xdp",!0),this.packets=null}}class YK extends Ce{constructor(e){super(Ue,"xsl",!0),this.debug=null,this.uri=null}}class JK extends Ce{constructor(e){super(Ue,"zpl",!0),this.name=e.name?e.name.trim():"",this.batchOutput=null,this.flipLabel=null,this.fontInfo=null,this.xdc=null}}class L3{static[cl](e,t){if(L3.hasOwnProperty(e))return L3[e](t)}static acrobat(e){return new wq(e)}static acrobat7(e){return new vq(e)}static ADBE_JSConsole(e){return new _q(e)}static ADBE_JSDebugger(e){return new kq(e)}static addSilentPrint(e){return new Cq(e)}static addViewerPreferences(e){return new Aq(e)}static adjustData(e){return new Sq(e)}static adobeExtensionLevel(e){return new Iq(e)}static agent(e){return new Eq(e)}static alwaysEmbed(e){return new Tq(e)}static amd(e){return new Rq(e)}static area(e){return new Mq(e)}static attributes(e){return new Pq(e)}static autoSave(e){return new Nq(e)}static base(e){return new Oq(e)}static batchOutput(e){return new Dq(e)}static behaviorOverride(e){return new Lq(e)}static cache(e){return new Fq(e)}static change(e){return new Bq(e)}static common(e){return new Uq(e)}static compress(e){return new Hq(e)}static compressLogicalStructure(e){return new zq(e)}static compressObjectStream(e){return new jq(e)}static compression(e){return new Gq(e)}static config(e){return new Vq(e)}static conformance(e){return new qq(e)}static contentCopy(e){return new Wq(e)}static copies(e){return new Kq(e)}static creator(e){return new Xq(e)}static currentPage(e){return new Yq(e)}static data(e){return new Jq(e)}static debug(e){return new Zq(e)}static defaultTypeface(e){return new Qq(e)}static destination(e){return new $q(e)}static documentAssembly(e){return new eW(e)}static driver(e){return new tW(e)}static duplexOption(e){return new nW(e)}static dynamicRender(e){return new iW(e)}static embed(e){return new sW(e)}static encrypt(e){return new rW(e)}static encryption(e){return new aW(e)}static encryptionLevel(e){return new oW(e)}static enforce(e){return new lW(e)}static equate(e){return new cW(e)}static equateRange(e){return new hW(e)}static exclude(e){return new uW(e)}static excludeNS(e){return new dW(e)}static flipLabel(e){return new fW(e)}static fontInfo(e){return new gW(e)}static formFieldFilling(e){return new mW(e)}static groupParent(e){return new pW(e)}static ifEmpty(e){return new bW(e)}static includeXDPContent(e){return new xW(e)}static incrementalLoad(e){return new yW(e)}static incrementalMerge(e){return new wW(e)}static interactive(e){return new vW(e)}static jog(e){return new _W(e)}static labelPrinter(e){return new kW(e)}static layout(e){return new CW(e)}static level(e){return new AW(e)}static linearized(e){return new SW(e)}static locale(e){return new IW(e)}static localeSet(e){return new EW(e)}static log(e){return new TW(e)}static map(e){return new RW(e)}static mediumInfo(e){return new MW(e)}static message(e){return new PW(e)}static messaging(e){return new NW(e)}static mode(e){return new OW(e)}static modifyAnnots(e){return new DW(e)}static msgId(e){return new LW(e)}static nameAttr(e){return new FW(e)}static neverEmbed(e){return new BW(e)}static numberOfCopies(e){return new UW(e)}static openAction(e){return new HW(e)}static output(e){return new zW(e)}static outputBin(e){return new jW(e)}static outputXSL(e){return new GW(e)}static overprint(e){return new VW(e)}static packets(e){return new qW(e)}static pageOffset(e){return new WW(e)}static pageRange(e){return new KW(e)}static pagination(e){return new XW(e)}static paginationOverride(e){return new YW(e)}static part(e){return new JW(e)}static pcl(e){return new ZW(e)}static pdf(e){return new QW(e)}static pdfa(e){return new $W(e)}static permissions(e){return new eK(e)}static pickTrayByPDFSize(e){return new tK(e)}static picture(e){return new nK(e)}static plaintextMetadata(e){return new iK(e)}static presence(e){return new sK(e)}static present(e){return new rK(e)}static print(e){return new aK(e)}static printHighQuality(e){return new oK(e)}static printScaling(e){return new lK(e)}static printerName(e){return new cK(e)}static producer(e){return new hK(e)}static ps(e){return new uK(e)}static range(e){return new dK(e)}static record(e){return new fK(e)}static relevant(e){return new gK(e)}static rename(e){return new mK(e)}static renderPolicy(e){return new pK(e)}static runScripts(e){return new bK(e)}static script(e){return new xK(e)}static scriptModel(e){return new yK(e)}static severity(e){return new wK(e)}static silentPrint(e){return new vK(e)}static staple(e){return new _K(e)}static startNode(e){return new kK(e)}static startPage(e){return new CK(e)}static submitFormat(e){return new AK(e)}static submitUrl(e){return new SK(e)}static subsetBelow(e){return new IK(e)}static suppressBanner(e){return new EK(e)}static tagged(e){return new TK(e)}static template(e){return new RK(e)}static templateCache(e){return new NK(e)}static threshold(e){return new MK(e)}static to(e){return new PK(e)}static trace(e){return new OK(e)}static transform(e){return new DK(e)}static type(e){return new LK(e)}static uri(e){return new FK(e)}static validate(e){return new BK(e)}static validateApprovalSignatures(e){return new UK(e)}static validationMessaging(e){return new HK(e)}static version(e){return new zK(e)}static versionControl(e){return new jK(e)}static viewerPreferences(e){return new GK(e)}static webClient(e){return new VK(e)}static whitespace(e){return new qK(e)}static window(e){return new WK(e)}static xdc(e){return new KK(e)}static xdp(e){return new XK(e)}static xsl(e){return new YK(e)}static zpl(e){return new JK(e)}}const ko=$i.connectionSet.id;class ZK extends Ce{constructor(e){super(ko,"connectionSet",!0),this.wsdlConnection=new ce,this.xmlConnection=new ce,this.xsdConnection=new ce}}class QK extends Ce{constructor(e){super(ko,"effectiveInputPolicy"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class $K extends Ce{constructor(e){super(ko,"effectiveOutputPolicy"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class eX extends bn{constructor(e){super(ko,"operation"),this.id=e.id||"",this.input=e.input||"",this.name=e.name||"",this.output=e.output||"",this.use=e.use||"",this.usehref=e.usehref||""}}class tX extends bn{constructor(e){super(ko,"rootElement"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class nX extends bn{constructor(e){super(ko,"soapAction"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class iX extends bn{constructor(e){super(ko,"soapAddress"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class sX extends bn{constructor(e){super(ko,"uri"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class rX extends bn{constructor(e){super(ko,"wsdlAddress"),this.id=e.id||"",this.name=e.name||"",this.use=e.use||"",this.usehref=e.usehref||""}}class aX extends Ce{constructor(e){super(ko,"wsdlConnection",!0),this.dataDescription=e.dataDescription||"",this.name=e.name||"",this.effectiveInputPolicy=null,this.effectiveOutputPolicy=null,this.operation=null,this.soapAction=null,this.soapAddress=null,this.wsdlAddress=null}}class oX extends Ce{constructor(e){super(ko,"xmlConnection",!0),this.dataDescription=e.dataDescription||"",this.name=e.name||"",this.uri=null}}class lX extends Ce{constructor(e){super(ko,"xsdConnection",!0),this.dataDescription=e.dataDescription||"",this.name=e.name||"",this.rootElement=null,this.uri=null}}class F3{static[cl](e,t){if(F3.hasOwnProperty(e))return F3[e](t)}static connectionSet(e){return new ZK(e)}static effectiveInputPolicy(e){return new QK(e)}static effectiveOutputPolicy(e){return new $K(e)}static operation(e){return new eX(e)}static rootElement(e){return new tX(e)}static soapAction(e){return new nX(e)}static soapAddress(e){return new iX(e)}static uri(e){return new sX(e)}static wsdlAddress(e){return new rX(e)}static wsdlConnection(e){return new aX(e)}static xmlConnection(e){return new oX(e)}static xsdConnection(e){return new lX(e)}}const d6=$i.datasets.id;class cX extends Ql{constructor(e){super(d6,"data",e)}[yp](){return!0}}class hX extends Ce{constructor(e){super(d6,"datasets",!0),this.data=null,this.Signature=null}[Zl](e){const t=e[On];(t==="data"&&e[Yi]===d6||t==="Signature"&&e[Yi]===$i.signature.id)&&(this[t]=e),this[Li](e)}}class B3{static[cl](e,t){if(B3.hasOwnProperty(e))return B3[e](t)}static datasets(e){return new hX(e)}static data(e){return new cX(e)}}const zi=$i.localeSet.id;class uX extends Ce{constructor(e){super(zi,"calendarSymbols",!0),this.name="gregorian",this.dayNames=new ce(2),this.eraNames=null,this.meridiemNames=null,this.monthNames=new ce(2)}}class dX extends bn{constructor(e){super(zi,"currencySymbol"),this.name=Fe(e.name,["symbol","isoname","decimal"])}}class fX extends Ce{constructor(e){super(zi,"currencySymbols",!0),this.currencySymbol=new ce(3)}}class gX extends bn{constructor(e){super(zi,"datePattern"),this.name=Fe(e.name,["full","long","med","short"])}}class mX extends Ce{constructor(e){super(zi,"datePatterns",!0),this.datePattern=new ce(4)}}class pX extends Hi{constructor(e){super(zi,"dateTimeSymbols")}}class bX extends bn{constructor(e){super(zi,"day")}}class xX extends Ce{constructor(e){super(zi,"dayNames",!0),this.abbr=Zt({data:e.abbr,defaultValue:0,validate:t=>t===1}),this.day=new ce(7)}}class yX extends bn{constructor(e){super(zi,"era")}}class wX extends Ce{constructor(e){super(zi,"eraNames",!0),this.era=new ce(2)}}class vX extends Ce{constructor(e){super(zi,"locale",!0),this.desc=e.desc||"",this.name="isoname",this.calendarSymbols=null,this.currencySymbols=null,this.datePatterns=null,this.dateTimeSymbols=null,this.numberPatterns=null,this.numberSymbols=null,this.timePatterns=null,this.typeFaces=null}}class _X extends Ce{constructor(e){super(zi,"localeSet",!0),this.locale=new ce}}class kX extends bn{constructor(e){super(zi,"meridiem")}}class CX extends Ce{constructor(e){super(zi,"meridiemNames",!0),this.meridiem=new ce(2)}}class AX extends bn{constructor(e){super(zi,"month")}}class SX extends Ce{constructor(e){super(zi,"monthNames",!0),this.abbr=Zt({data:e.abbr,defaultValue:0,validate:t=>t===1}),this.month=new ce(12)}}class IX extends bn{constructor(e){super(zi,"numberPattern"),this.name=Fe(e.name,["full","long","med","short"])}}class EX extends Ce{constructor(e){super(zi,"numberPatterns",!0),this.numberPattern=new ce(4)}}class TX extends bn{constructor(e){super(zi,"numberSymbol"),this.name=Fe(e.name,["decimal","grouping","percent","minus","zero"])}}class RX extends Ce{constructor(e){super(zi,"numberSymbols",!0),this.numberSymbol=new ce(5)}}class MX extends bn{constructor(e){super(zi,"timePattern"),this.name=Fe(e.name,["full","long","med","short"])}}class PX extends Ce{constructor(e){super(zi,"timePatterns",!0),this.timePattern=new ce(4)}}class NX extends Ce{constructor(e){super(zi,"typeFace",!0),this.name=e.name|""}}class OX extends Ce{constructor(e){super(zi,"typeFaces",!0),this.typeFace=new ce}}class U3{static[cl](e,t){if(U3.hasOwnProperty(e))return U3[e](t)}static calendarSymbols(e){return new uX(e)}static currencySymbol(e){return new dX(e)}static currencySymbols(e){return new fX(e)}static datePattern(e){return new gX(e)}static datePatterns(e){return new mX(e)}static dateTimeSymbols(e){return new pX(e)}static day(e){return new bX(e)}static dayNames(e){return new xX(e)}static era(e){return new yX(e)}static eraNames(e){return new wX(e)}static locale(e){return new vX(e)}static localeSet(e){return new _X(e)}static meridiem(e){return new kX(e)}static meridiemNames(e){return new CX(e)}static month(e){return new AX(e)}static monthNames(e){return new SX(e)}static numberPattern(e){return new IX(e)}static numberPatterns(e){return new EX(e)}static numberSymbol(e){return new TX(e)}static numberSymbols(e){return new RX(e)}static timePattern(e){return new MX(e)}static timePatterns(e){return new PX(e)}static typeFace(e){return new NX(e)}static typeFaces(e){return new OX(e)}}const DX=$i.signature.id;class LX extends Ce{constructor(e){super(DX,"signature",!0)}}class H3{static[cl](e,t){if(H3.hasOwnProperty(e))return H3[e](t)}static signature(e){return new LX(e)}}const FX=$i.stylesheet.id;class BX extends Ce{constructor(e){super(FX,"stylesheet",!0)}}class z3{static[cl](e,t){if(z3.hasOwnProperty(e))return z3[e](t)}static stylesheet(e){return new BX(e)}}const UX=$i.xdp.id;class HX extends Ce{constructor(e){super(UX,"xdp",!0),this.uuid=e.uuid||"",this.timeStamp=e.timeStamp||"",this.config=null,this.connectionSet=null,this.datasets=null,this.localeSet=null,this.stylesheet=new ce,this.template=null}[a6](e){const t=$i[e[On]];return t&&e[Yi]===t.id}}class j3{static[cl](e,t){if(j3.hasOwnProperty(e))return j3[e](t)}static xdp(e){return new HX(e)}}const zX=$i.xhtml.id,n9=Symbol(),jX=new Set(["color","font","font-family","font-size","font-stretch","font-style","font-weight","margin","margin-bottom","margin-left","margin-right","margin-top","letter-spacing","line-height","orphans","page-break-after","page-break-before","page-break-inside","tab-interval","tab-stop","text-align","text-decoration","text-indent","vertical-align","widows","kerning-mode","xfa-font-horizontal-scale","xfa-font-vertical-scale","xfa-spacerun","xfa-tab-stops"]),GX=new Map([["page-break-after","breakAfter"],["page-break-before","breakBefore"],["page-break-inside","breakInside"],["kerning-mode",n=>n==="none"?"none":"normal"],["xfa-font-horizontal-scale",n=>`scaleX(${Math.max(0,parseInt(n)/100).toFixed(2)})`],["xfa-font-vertical-scale",n=>`scaleY(${Math.max(0,parseInt(n)/100).toFixed(2)})`],["xfa-spacerun",""],["xfa-tab-stops",""],["font-size",(n,e)=>(n=e.fontSize=Math.abs(bt(n)),Jt(.99*n))],["letter-spacing",n=>Jt(bt(n))],["line-height",n=>Jt(bt(n))],["margin",n=>Jt(bt(n))],["margin-bottom",n=>Jt(bt(n))],["margin-left",n=>Jt(bt(n))],["margin-right",n=>Jt(bt(n))],["margin-top",n=>Jt(bt(n))],["text-indent",n=>Jt(bt(n))],["font-family",n=>n],["vertical-align",n=>Jt(bt(n))]]),VX=/\s+/g,qX=/[\r\n]+/g,WX=/\r\n?/g;function KX(n,e,t){const i=Object.create(null);if(!n)return i;const s=Object.create(null);for(const[r,a]of n.split(";").map(o=>o.split(":",2))){const o=GX.get(r);if(o==="")continue;let l=a;o&&(l=typeof o=="string"?o:o(a,s)),r.endsWith("scale")?i.transform=i.transform?`${i[r]} ${l}`:l:i[r.replaceAll(/-([a-zA-Z])/g,(c,h)=>h.toUpperCase())]=l}if(i.fontFamily&&vM({typeface:i.fontFamily,weight:i.fontWeight||"normal",posture:i.fontStyle||"normal",size:s.fontSize||0},e,e[ei].fontFinder,i),t&&i.verticalAlign&&i.verticalAlign!=="0px"&&i.fontSize){const o=bt(i.fontSize);i.fontSize=Jt(o*.583),i.verticalAlign=Jt(Math.sign(bt(i.verticalAlign))*o*.333)}return t&&i.fontSize&&(i.fontSize=`calc(${i.fontSize} * var(--total-scale-factor))`),xM(i),i}function XX(n){return n.style?n.style.split(";").filter(e=>!!e.trim()).map(e=>e.split(":",2).map(t=>t.trim())).filter(([e,t])=>(e==="font-family"&&n[ei].usedTypefaces.add(t),jX.has(e))).map(e=>e.join(":")).join(";"):""}const YX=new Set(["body","html"]);class Xa extends Ql{constructor(e,t){super(zX,t),this[n9]=!1,this.style=e.style||""}[yo](e){super[yo](e),this.style=XX(this)}[iy](){return!YX.has(this[On])}[a0](e,t=!1){t?this[n9]=!0:(e=e.replaceAll(qX,""),this.style.includes("xfa-spacerun:yes")||(e=e.replaceAll(VX," "))),e&&(this[Le]+=e)}[sc](e,t=!0){const i=Object.create(null),s={top:NaN,bottom:NaN,left:NaN,right:NaN};let r=null;for(const[a,o]of this.style.split(";").map(l=>l.split(":",2)))switch(a){case"font-family":i.typeface=ry(o);break;case"font-size":i.size=bt(o);break;case"font-weight":i.weight=o;break;case"font-style":i.posture=o;break;case"letter-spacing":i.letterSpacing=bt(o);break;case"margin":const l=o.split(/ \t/).map(c=>bt(c));switch(l.length){case 1:s.top=s.bottom=s.left=s.right=l[0];break;case 2:s.top=s.bottom=l[0],s.left=s.right=l[1];break;case 3:s.top=l[0],s.bottom=l[2],s.left=s.right=l[1];break;case 4:s.top=l[0],s.left=l[1],s.bottom=l[2],s.right=l[3];break}break;case"margin-top":s.top=bt(o);break;case"margin-bottom":s.bottom=bt(o);break;case"margin-left":s.left=bt(o);break;case"margin-right":s.right=bt(o);break;case"line-height":r=bt(o);break}if(e.pushData(i,s,r),this[Le])e.addString(this[Le]);else for(const a of this[Hs]()){if(a[On]==="#text"){e.addString(a[Le]);continue}a[sc](e)}t&&e.popFont()}[Gt](e){const t=[];if(this[we]={children:t},this[Fh]({}),t.length===0&&!this[Le])return Tt.EMPTY;let i;return this[n9]?i=this[Le]?this[Le].replaceAll(WX,`
`):void 0:i=this[Le]||void 0,Tt.success({name:this[On],attributes:{href:this.href,style:KX(this.style,this,this[n9])},children:t,value:i})}}class JX extends Xa{constructor(e){super(e,"a"),this.href=_M(e.href)||""}}class ZX extends Xa{constructor(e){super(e,"b")}[sc](e){e.pushFont({weight:"bold"}),super[sc](e),e.popFont()}}class QX extends Xa{constructor(e){super(e,"body")}[Gt](e){const t=super[Gt](e),{html:i}=t;return i?(i.name="div",i.attributes.class=["xfaRich"],t):Tt.EMPTY}}class $X extends Xa{constructor(e){super(e,"br")}[ms](){return`
`}[sc](e){e.addString(`
`)}[Gt](e){return Tt.success({name:"br"})}}class eY extends Xa{constructor(e){super(e,"html")}[Gt](e){var i;const t=[];if(this[we]={children:t},this[Fh]({}),t.length===0)return Tt.success({name:"div",attributes:{class:["xfaRich"],style:{}},value:this[Le]||""});if(t.length===1){const s=t[0];if((i=s.attributes)!=null&&i.class.includes("xfaRich"))return Tt.success(s)}return Tt.success({name:"div",attributes:{class:["xfaRich"],style:{}},children:t})}}class tY extends Xa{constructor(e){super(e,"i")}[sc](e){e.pushFont({posture:"italic"}),super[sc](e),e.popFont()}}class nY extends Xa{constructor(e){super(e,"li")}}class iY extends Xa{constructor(e){super(e,"ol")}}class sY extends Xa{constructor(e){super(e,"p")}[sc](e){super[sc](e,!1),e.addString(`
`),e.addPara(),e.popFont()}[ms](){return this[Qt]()[Hs]().at(-1)===this?super[ms]():super[ms]()+`
`}}class rY extends Xa{constructor(e){super(e,"span")}}class aY extends Xa{constructor(e){super(e,"sub")}}class oY extends Xa{constructor(e){super(e,"sup")}}class lY extends Xa{constructor(e){super(e,"ul")}}class Pg{static[cl](e,t){if(Pg.hasOwnProperty(e))return Pg[e](t)}static a(e){return new JX(e)}static b(e){return new ZX(e)}static body(e){return new QX(e)}static br(e){return new $X(e)}static html(e){return new eY(e)}static i(e){return new tY(e)}static li(e){return new nY(e)}static ol(e){return new iY(e)}static p(e){return new sY(e)}static span(e){return new rY(e)}static sub(e){return new aY(e)}static sup(e){return new oY(e)}static ul(e){return new lY(e)}}const oC={config:L3,connection:F3,datasets:B3,localeSet:U3,signature:H3,stylesheet:z3,template:D3,xdp:j3,xhtml:Pg};class lC{constructor(e){this.namespaceId=e}[cl](e,t){return new Ql(this.namespaceId,e,t)}}class cY extends Ce{constructor(e){super(-1,"root",Object.create(null)),this.element=null,this[Rf]=e}[Zl](e){return this.element=e,!0}[ti](){super[ti](),this.element.template instanceof V4&&(this[Rf].set(lM,this.element),this.element.template[op](this[Rf]),this.element.template[Rf]=this[Rf])}}class hY extends Ce{constructor(){super(-1,"",Object.create(null))}[Zl](e){return!1}}class uY{constructor(e=null){this._namespaceStack=[],this._nsAgnosticLevel=0,this._namespacePrefixes=new Map,this._namespaces=new Map,this._nextNsId=Math.max(...Object.values($i).map(({id:t})=>t)),this._currentNamespace=e||new lC(++this._nextNsId)}buildRoot(e){return new cY(e)}build({nsPrefix:e,name:t,attributes:i,namespace:s,prefixes:r}){const a=s!==null;if(a&&(this._namespaceStack.push(this._currentNamespace),this._currentNamespace=this._searchNamespace(s)),r&&this._addNamespacePrefix(r),i.hasOwnProperty($c)){const c=oC.datasets,h=i[$c];let u=null;for(const[d,f]of Object.entries(h))if(this._getNamespaceToUse(d)===c){u={xfa:f};break}u?i[$c]=u:delete i[$c]}const o=this._getNamespaceToUse(e),l=(o==null?void 0:o[cl](t,i))||new hY;return l[yp]()&&this._nsAgnosticLevel++,(a||r||l[yp]())&&(l[s3]={hasNamespace:a,prefixes:r,nsAgnostic:l[yp]()}),l}isNsAgnostic(){return this._nsAgnosticLevel>0}_searchNamespace(e){let t=this._namespaces.get(e);if(t)return t;for(const[i,{check:s}]of Object.entries($i))if(s(e)){if(t=oC[i],t)return this._namespaces.set(e,t),t;break}return t=new lC(++this._nextNsId),this._namespaces.set(e,t),t}_addNamespacePrefix(e){for(const{prefix:t,value:i}of e){const s=this._searchNamespace(i);let r=this._namespacePrefixes.get(t);r||(r=[],this._namespacePrefixes.set(t,r)),r.push(s)}}_getNamespaceToUse(e){if(!e)return this._currentNamespace;const t=this._namespacePrefixes.get(e);return(t==null?void 0:t.length)>0?t.at(-1):(he(`Unknown namespace prefix: ${e}.`),null)}clean(e){const{hasNamespace:t,prefixes:i,nsAgnostic:s}=e;t&&(this._currentNamespace=this._namespaceStack.pop()),i&&i.forEach(({prefix:r})=>{this._namespacePrefixes.get(r).pop()}),s&&this._nsAgnosticLevel--}}class G3 extends XR{constructor(e=null,t=!1){super(),this._builder=new uY(e),this._stack=[],this._globalData={usedTypefaces:new Set},this._ids=new Map,this._current=this._builder.buildRoot(this._ids),this._errorCode=oa.NoError,this._whiteRegex=/^\s+$/,this._nbsps=/\xa0+/g,this._richText=t}parse(e){if(this.parseXml(e),this._errorCode===oa.NoError)return this._current[ti](),this._current.element}onText(e){if(e=e.replace(this._nbsps,t=>t.slice(1)+" "),this._richText||this._current[iy]()){this._current[a0](e,this._richText);return}this._whiteRegex.test(e)||this._current[a0](e.trim())}onCdata(e){this._current[a0](e)}_mkAttributes(e,t){let i=null,s=null;const r=Object.create({});for(const{name:a,value:o}of e)if(a==="xmlns")i?he(`XFA - multiple namespace definition in <${t}>`):i=o;else if(a.startsWith("xmlns:")){const l=a.substring(6);s??(s=[]),s.push({prefix:l,value:o})}else{const l=a.indexOf(":");if(l===-1)r[a]=o;else{const c=r[$c]??(r[$c]=Object.create(null)),[h,u]=[a.slice(0,l),a.slice(l+1)],d=c[h]||(c[h]=Object.create(null));d[u]=o}}return[i,s,r]}_getNameAndPrefix(e,t){const i=e.indexOf(":");return i===-1?[e,null]:[e.substring(i+1),t?"":e.substring(0,i)]}onBeginElement(e,t,i){const[s,r,a]=this._mkAttributes(t,e),[o,l]=this._getNameAndPrefix(e,this._builder.isNsAgnostic()),c=this._builder.build({nsPrefix:l,name:o,attributes:a,namespace:s,prefixes:r});if(c[ei]=this._globalData,i){c[ti](),this._current[Zl](c)&&c[o6](this._ids),c[yo](this._builder);return}this._stack.push(this._current),this._current=c}onEndElement(e){const t=this._current;if(t[N4]()&&typeof t[Le]=="string"){const i=new G3;i._globalData=this._globalData;const s=i.parse(t[Le]);t[Le]=null,t[Zl](s)}t[ti](),this._current=this._stack.pop(),this._current[Zl](t)&&t[o6](this._ids),t[yo](this._builder)}onError(e){this._errorCode=e}}class gx{constructor(e){try{this.root=new G3().parse(gx._createDocument(e));const t=new xq(this.root);this.form=t.bind(),this.dataHandler=new yq(this.root,t.getData()),this.form[ei].template=this.form}catch(t){he(`XFA - an error occurred during parsing and binding: ${t}`)}}isValid(){return!!(this.root&&this.form)}_createPagesHelper(){const e=this.form[hM]();return new Promise((t,i)=>{const s=()=>{try{const r=e.next();r.done?t(r.value):setTimeout(s,0)}catch(r){i(r)}};setTimeout(s,0)})}async _createPages(){try{this.pages=await this._createPagesHelper(),this.dims=this.pages.children.map(e=>{const{width:t,height:i}=e.attributes.style;return[0,0,parseInt(t),parseInt(i)]})}catch(e){he(`XFA - an error occurred during layout: ${e}`)}}getBoundingBox(e){return this.dims[e]}async getNumPages(){return this.pages||await this._createPages(),this.dims.length}setImages(e){this.form[ei].images=e}setFonts(e){this.form[ei].fontFinder=new SG(e);const t=[];for(let i of this.form[ei].usedTypefaces)i=ry(i),this.form[ei].fontFinder.find(i)||t.push(i);return t.length>0?t:null}appendFonts(e,t){this.form[ei].fontFinder.add(e,t)}async getPages(){this.pages||await this._createPages();const e=this.pages;return this.pages=null,e}serializeData(e){return this.dataHandler.serialize(e)}static _createDocument(e){return e["/xdp:xdp"]?Object.values(e).join(""):e["xdp:xdp"]}static getRichTextAsHtml(e){if(!e||typeof e!="string")return null;try{let t=new G3(Pg,!0).parse(e);if(!["body","xhtml"].includes(t[On])){const a=Pg.body({});a[Li](t),t=a}const i=t[Gt]();if(!i.success)return null;const{html:s}=i,{attributes:r}=s;return r&&(r.class&&(r.class=r.class.filter(a=>!a.startsWith("xfa"))),r.dir="auto"),{html:s,str:t[ms]()}}catch(t){he(`XFA - an error occurred during parsing of rich text: ${t}`)}return null}}class M0{static createGlobals(e){return Promise.all([e.ensureCatalog("acroForm"),e.ensureDoc("xfaDatasets"),e.ensureCatalog("structTreeRoot"),e.ensureCatalog("baseUrl"),e.ensureCatalog("attachments"),e.ensureCatalog("globalColorSpaceCache")]).then(([t,i,s,r,a,o])=>({pdfManager:e,acroForm:t instanceof fe?t:fe.empty,xfaDatasets:i,structTreeRoot:s,baseUrl:r,attachments:a,globalColorSpaceCache:o}),t=>(he(`createGlobals: "${t}".`),null))}static async create(e,t,i,s,r,a,o){const l=r?await this._getPageIndex(e,t,i.pdfManager):null;return i.pdfManager.ensure(this,"_create",[e,t,i,s,r,a,l,o])}static _create(e,t,i,s,r=!1,a=null,o=null,l=null){const c=e.fetchIfRef(t);if(!(c instanceof fe))return;const{acroForm:h,pdfManager:u}=i,d=t instanceof st?t.toString():`annot_${s.createObjId()}`;let f=c.get("Subtype");f=f instanceof _e?f.name:null;const g={xref:e,ref:t,dict:c,subtype:f,id:d,annotationGlobals:i,collectFields:r,orphanFields:a,needAppearances:!r&&h.get("NeedAppearances")===!0,pageIndex:o,evaluatorOptions:u.evaluatorOptions,pageRef:l};switch(f){case"Link":return new bY(g);case"Text":return new pY(g);case"Widget":let m=uo({dict:c,key:"FT"});switch(m=m instanceof _e?m.name:null,m){case"Tx":return new fY(g);case"Btn":return new gY(g);case"Ch":return new mY(g);case"Sig":return new jM(g)}return he(`Unimplemented widget field type "${m}", falling back to base field type.`),new il(g);case"Popup":return new GM(g);case"FreeText":return new Dw(g);case"Line":return new xY(g);case"Square":return new yY(g);case"Circle":return new wY(g);case"PolyLine":return new VM(g);case"Polygon":return new qM(g);case"Caret":return new vY(g);case"Ink":return new Fm(g);case"Highlight":return new Lw(g);case"Underline":return new _Y(g);case"Squiggly":return new kY(g);case"StrikeOut":return new CY(g);case"Stamp":return new ou(g);case"FileAttachment":return new AY(g);default:return r||he(f?`Unimplemented annotation type "${f}", falling back to base annotation.`:"Annotation is missing the required /Subtype."),new px(g)}}static async _getPageIndex(e,t,i){try{const s=await e.fetchIfRefAsync(t);if(!(s instanceof fe))return-1;const r=s.getRaw("P");if(r instanceof st)try{return await i.ensureCatalog("getPageIndex",[r])}catch(o){gn(`_getPageIndex -- not a valid page reference: "${o}".`)}if(s.has("Kids"))return-1;const a=await i.ensureDoc("numPages");for(let o=0;o<a;o++){const l=await i.getPage(o),c=await i.ensure(l,"annotations");for(const h of c)if(h instanceof st&&C3(h,t))return o}}catch(s){he(`_getPageIndex: "${s}".`)}return-1}static generateImages(e,t,i){if(!i)return he("generateImages: OffscreenCanvas is not supported, cannot save or print some annotations with images."),null;let s;for(const{bitmapId:r,bitmap:a}of e)a&&(s||(s=new Map),s.set(r,ou.createImage(a,t)));return s}static async saveNewAnnotations(e,t,i,s,r){const a=e.xref;let o;const l=[],{isOffscreenCanvasSupported:c}=e.options;for(const h of i)if(!h.deleted)switch(h.annotationType){case pl.FREETEXT:if(!o){const d=new fe(a);d.set("BaseFont",_e.get("Helvetica")),d.set("Type",_e.get("Font")),d.set("Subtype",_e.get("Type1")),d.set("Encoding",_e.get("WinAnsiEncoding")),o=a.getNewTemporaryRef(),r.put(o,{data:d})}l.push(Dw.createNewAnnotation(a,h,r,{evaluator:e,task:t,baseFontRef:o}));break;case pl.HIGHLIGHT:h.quadPoints?l.push(Lw.createNewAnnotation(a,h,r)):l.push(Fm.createNewAnnotation(a,h,r));break;case pl.INK:l.push(Fm.createNewAnnotation(a,h,r));break;case pl.STAMP:const u=c?await(s==null?void 0:s.get(h.bitmapId)):null;if(u!=null&&u.imageStream){const{imageStream:d,smaskStream:f}=u;if(f){const m=a.getNewTemporaryRef();r.put(m,{data:f}),d.dict.set("SMask",m)}const g=u.imageRef=a.getNewTemporaryRef();r.put(g,{data:d}),u.imageStream=u.smaskStream=null}l.push(ou.createNewAnnotation(a,h,r,{image:u}));break;case pl.SIGNATURE:l.push(ou.createNewAnnotation(a,h,r,{}));break}return{annotations:await Promise.all(l)}}static async printNewAnnotations(e,t,i,s,r){if(!s)return null;const{options:a,xref:o}=t,l=[];for(const c of s)if(!c.deleted)switch(c.annotationType){case pl.FREETEXT:l.push(Dw.createNewPrintAnnotation(e,o,c,{evaluator:t,task:i,evaluatorOptions:a}));break;case pl.HIGHLIGHT:c.quadPoints?l.push(Lw.createNewPrintAnnotation(e,o,c,{evaluatorOptions:a})):l.push(Fm.createNewPrintAnnotation(e,o,c,{evaluatorOptions:a}));break;case pl.INK:l.push(Fm.createNewPrintAnnotation(e,o,c,{evaluatorOptions:a}));break;case pl.STAMP:const h=a.isOffscreenCanvasSupported?await(r==null?void 0:r.get(c.bitmapId)):null;if(h!=null&&h.imageStream){const{imageStream:u,smaskStream:d}=h;d&&u.dict.set("SMask",d),h.imageRef=new Cg(u,u.length),h.imageStream=h.smaskStream=null}l.push(ou.createNewPrintAnnotation(e,o,c,{image:h,evaluatorOptions:a}));break;case pl.SIGNATURE:l.push(ou.createNewPrintAnnotation(e,o,c,{evaluatorOptions:a}));break}return Promise.all(l)}}function n1(n,e=new Uint8ClampedArray(3)){if(!Array.isArray(n))return e;const t=e||new Uint8ClampedArray(3);switch(n.length){case 0:return null;case 1:return Nn.gray.getRgbItem(n,0,t,0),t;case 3:return Nn.rgb.getRgbItem(n,0,t,0),t;case 4:return Nn.cmyk.getRgbItem(n,0,t,0),t;default:return e}}function Ir(n){return Array.from(n,e=>e/255)}function mx(n,e){const t=n.getArray("QuadPoints");if(!Gr(t,null)||t.length===0||t.length%8>0)return null;const i=new Float32Array(t.length);for(let s=0,r=t.length;s<r;s+=8){const[a,o,l,c,h,u,d,f]=t.slice(s,s+8),g=Math.min(a,l,h,d),m=Math.max(a,l,h,d),x=Math.min(o,c,u,f),p=Math.max(o,c,u,f);if(e!==null&&(g<e[0]||m>e[2]||x<e[1]||p>e[3]))return null;i.set([g,p,m,p,g,x,m,x],s)}return i}function f6(n,e,t){const i=new Float32Array([1/0,1/0,-1/0,-1/0]);Dn.axialAlignedBoundingBox(e,t,i);const[s,r,a,o]=i;if(s===a||r===o)return[1,0,0,1,n[0],n[1]];const l=(n[2]-n[0])/(a-s),c=(n[3]-n[1])/(o-r);return[l,0,0,c,n[0]-s*l,n[1]-r*c]}class px{constructor(e){const{dict:t,xref:i,annotationGlobals:s,ref:r,orphanFields:a}=e,o=a==null?void 0:a.get(r);o&&t.set("Parent",o),this.setTitle(t.get("T")),this.setContents(t.get("Contents")),this.setModificationDate(t.get("M")),this.setFlags(t.get("F")),this.setRectangle(t.getArray("Rect")),this.setColor(t.getArray("C")),this.setBorderStyle(t),this.setAppearance(t),this.setOptionalContent(t);const l=t.get("MK");this.setBorderAndBackgroundColors(l),this.setRotation(l,t),this.ref=e.ref instanceof st?e.ref:null,this._streams=[],this.appearance&&this._streams.push(this.appearance);const c=!!(this.flags&pi.LOCKED),h=!!(this.flags&pi.LOCKEDCONTENTS);if(this.data={annotationFlags:this.flags,borderStyle:this.borderStyle,color:this.color,backgroundColor:this.backgroundColor,borderColor:this.borderColor,rotation:this.rotation,contentsObj:this._contents,hasAppearance:!!this.appearance,id:e.id,modificationDate:this.modificationDate,rect:this.rectangle,subtype:e.subtype,hasOwnCanvas:!1,noRotate:!!(this.flags&pi.NOROTATE),noHTML:c&&h,isEditable:!1,structParent:-1},s.structTreeRoot){let d=t.get("StructParent");this.data.structParent=d=Number.isInteger(d)&&d>=0?d:-1,s.structTreeRoot.addAnnotationIdToPage(e.pageRef,d)}if(e.collectFields){const d=t.get("Kids");if(Array.isArray(d)){const f=[];for(const g of d)g instanceof st&&f.push(g.toString());f.length!==0&&(this.data.kidIds=f)}this.data.actions=Q5(i,t,KT),this.data.fieldName=this._constructFieldName(t),this.data.pageIndex=e.pageIndex}const u=t.get("IT");u instanceof _e&&(this.data.it=u.name),this._isOffscreenCanvasSupported=e.evaluatorOptions.isOffscreenCanvasSupported,this._fallbackFontDict=null,this._needAppearances=!1}_hasFlag(e,t){return!!(e&t)}_buildFlags(e,t){let{flags:i}=this;return e===void 0?t===void 0?void 0:t?i&~pi.PRINT:i&~pi.HIDDEN|pi.PRINT:e?(i|=pi.PRINT,t?i&~pi.NOVIEW|pi.HIDDEN:i&~pi.HIDDEN|pi.NOVIEW):(i&=~(pi.HIDDEN|pi.NOVIEW),t?i&~pi.PRINT:i|pi.PRINT)}_isViewable(e){return!this._hasFlag(e,pi.INVISIBLE)&&!this._hasFlag(e,pi.NOVIEW)}_isPrintable(e){return this._hasFlag(e,pi.PRINT)&&!this._hasFlag(e,pi.HIDDEN)&&!this._hasFlag(e,pi.INVISIBLE)}mustBeViewed(e,t){var s;const i=(s=e==null?void 0:e.get(this.data.id))==null?void 0:s.noView;return i!==void 0?!i:this.viewable&&!this._hasFlag(this.flags,pi.HIDDEN)}mustBePrinted(e){var i;const t=(i=e==null?void 0:e.get(this.data.id))==null?void 0:i.noPrint;return t!==void 0?!t:this.printable}mustBeViewedWhenEditing(e,t=null){return e?!this.data.isEditable:!(t!=null&&t.has(this.data.id))}get viewable(){return this.data.quadPoints===null?!1:this.flags===0?!0:this._isViewable(this.flags)}get printable(){return this.data.quadPoints===null||this.flags===0?!1:this._isPrintable(this.flags)}_parseStringHelper(e){const t=typeof e=="string"?Tn(e):"",i=t&&jR(t).dir==="rtl"?"rtl":"ltr";return{str:t,dir:i}}setDefaultAppearance(e){const{dict:t,annotationGlobals:i}=e,s=uo({dict:t,key:"DA"})||i.acroForm.get("DA");this._defaultAppearance=typeof s=="string"?s:"",this.data.defaultAppearanceData=R4(this._defaultAppearance)}setTitle(e){this._title=this._parseStringHelper(e)}setContents(e){this._contents=this._parseStringHelper(e)}setModificationDate(e){this.modificationDate=typeof e=="string"?e:null}setFlags(e){this.flags=Number.isInteger(e)&&e>0?e:0,this.flags&pi.INVISIBLE&&this.constructor.name!=="Annotation"&&(this.flags^=pi.INVISIBLE)}hasFlag(e){return this._hasFlag(this.flags,e)}setRectangle(e){this.rectangle=p0(e,[0,0,0,0])}setColor(e){this.color=n1(e)}setLineEndings(e){if(this.lineEndings=["None","None"],Array.isArray(e)&&e.length===2)for(let t=0;t<2;t++){const i=e[t];if(i instanceof _e)switch(i.name){case"None":continue;case"Square":case"Circle":case"Diamond":case"OpenArrow":case"ClosedArrow":case"Butt":case"ROpenArrow":case"RClosedArrow":case"Slash":this.lineEndings[t]=i.name;continue}he(`Ignoring invalid lineEnding: ${i}`)}}setRotation(e,t){this.rotation=0;let i=e instanceof fe?e.get("R")||0:t.get("Rotate")||0;Number.isInteger(i)&&i!==0&&(i%=360,i<0&&(i+=360),i%90===0&&(this.rotation=i))}setBorderAndBackgroundColors(e){e instanceof fe?(this.borderColor=n1(e.getArray("BC"),null),this.backgroundColor=n1(e.getArray("BG"),null)):this.borderColor=this.backgroundColor=null}setBorderStyle(e){if(this.borderStyle=new dY,e instanceof fe)if(e.has("BS")){const t=e.get("BS");if(t instanceof fe){const i=t.get("Type");(!i||Oi(i,"Border"))&&(this.borderStyle.setWidth(t.get("W"),this.rectangle),this.borderStyle.setStyle(t.get("S")),this.borderStyle.setDashArray(t.getArray("D")))}}else if(e.has("Border")){const t=e.getArray("Border");Array.isArray(t)&&t.length>=3&&(this.borderStyle.setHorizontalCornerRadius(t[0]),this.borderStyle.setVerticalCornerRadius(t[1]),this.borderStyle.setWidth(t[2],this.rectangle),t.length===4&&this.borderStyle.setDashArray(t[3],!0))}else this.borderStyle.setWidth(0)}setAppearance(e){this.appearance=null;const t=e.get("AP");if(!(t instanceof fe))return;const i=t.get("N");if(i instanceof hn){this.appearance=i;return}if(!(i instanceof fe))return;const s=e.get("AS");if(!(s instanceof _e)||!i.has(s.name))return;const r=i.get(s.name);r instanceof hn&&(this.appearance=r)}setOptionalContent(e){this.oc=null;const t=e.get("OC");t instanceof _e?he("setOptionalContent: Support for /Name-entry is not implemented."):t instanceof fe&&(this.oc=t)}async loadResources(e,t){const i=await t.dict.getAsync("Resources");return i&&await Eg.load(i,e,i.xref),i}async getOperatorList(e,t,i,s){const{hasOwnCanvas:r,id:a,rect:o}=this.data;let l=this.appearance;const c=!!(r&&i&Hr.DISPLAY);if(c&&(this.width===0||this.height===0))return this.data.hasOwnCanvas=!1,{opList:new Ar,separateForm:!1,separateCanvas:!1};if(!l){if(!c)return{opList:new Ar,separateForm:!1,separateCanvas:!1};l=new Yr(""),l.dict=new fe}const h=l.dict,u=await this.loadResources(_7,l),d=S7(h.getArray("BBox"),[0,0,1,1]),f=Ch(h.getArray("Matrix"),el),g=f6(o,d,f),m=new Ar;let x;return this.oc&&(x=await e.parseMarkedContentProps(this.oc,null)),x!==void 0&&m.addOp(ne.beginMarkedContentProps,["OC",x]),m.addOp(ne.beginAnnotation,[a,o,g,f,c]),await e.getOperatorList({stream:l,task:t,resources:u,operatorList:m,fallbackFontDict:this._fallbackFontDict}),m.addOp(ne.endAnnotation,[]),x!==void 0&&m.addOp(ne.endMarkedContent,[]),this.reset(),{opList:m,separateForm:!1,separateCanvas:c}}async save(e,t,i,s){return null}get overlaysTextContent(){return!1}get hasTextContent(){return!1}async extractTextContent(e,t,i){if(!this.appearance)return;const s=await this.loadResources(k7,this.appearance),r=[],a=[];let o=null;const l={desiredSize:Math.Infinity,ready:!0,enqueue(c,h){for(const u of c.items)u.str!==void 0&&(o||(o=u.transform.slice(-2)),a.push(u.str),u.hasEOL&&(r.push(a.join("").trimEnd()),a.length=0))}};if(await e.getTextContent({stream:this.appearance,task:t,resources:s,includeMarkedContent:!0,keepWhiteSpace:!0,sink:l,viewBox:i}),this.reset(),a.length&&r.push(a.join("").trimEnd()),r.length>1||r[0]){const c=this.appearance.dict,h=S7(c.getArray("BBox"),null),u=Ch(c.getArray("Matrix"),null);this.data.textPosition=this._transformPoint(o,h,u),this.data.textContent=r}}_transformPoint(e,t,i){const{rect:s}=this.data;t||(t=[0,0,1,1]),i||(i=[1,0,0,1,0,0]);const r=f6(s,t,i);r[4]-=s[0],r[5]-=s[1];const a=e.slice();return Dn.applyTransform(a,r),Dn.applyTransform(a,i),a}getFieldObject(){return this.data.kidIds?{id:this.data.id,actions:this.data.actions,name:this.data.fieldName,strokeColor:this.data.borderColor,fillColor:this.data.backgroundColor,type:"",kidIds:this.data.kidIds,page:this.data.pageIndex,rotation:this.rotation}:null}reset(){for(const e of this._streams)e.reset()}_constructFieldName(e){if(!e.has("T")&&!e.has("Parent"))return he("Unknown field name, falling back to empty field name."),"";if(!e.has("Parent"))return Tn(e.get("T"));const t=[];e.has("T")&&t.unshift(Tn(e.get("T")));let i=e;const s=new Ji;for(e.objId&&s.put(e.objId);i.has("Parent")&&(i=i.get("Parent"),!(!(i instanceof fe)||i.objId&&s.has(i.objId)));)i.objId&&s.put(i.objId),i.has("T")&&t.unshift(Tn(i.get("T")));return t.join(".")}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class dY{constructor(){this.width=1,this.rawWidth=1,this.style=hf.SOLID,this.dashArray=[3],this.horizontalCornerRadius=0,this.verticalCornerRadius=0}setWidth(e,t=[0,0,0,0]){if(e instanceof _e){this.width=0;return}if(typeof e=="number"){if(e>0){this.rawWidth=e;const i=(t[2]-t[0])/2,s=(t[3]-t[1])/2;i>0&&s>0&&(e>i||e>s)&&(he(`AnnotationBorderStyle.setWidth - ignoring width: ${e}`),e=1)}this.width=e}}setStyle(e){if(e instanceof _e)switch(e.name){case"S":this.style=hf.SOLID;break;case"D":this.style=hf.DASHED;break;case"B":this.style=hf.BEVELED;break;case"I":this.style=hf.INSET;break;case"U":this.style=hf.UNDERLINE;break}}setDashArray(e,t=!1){if(Array.isArray(e)){let i=!0,s=!0;for(const r of e)if(+r>=0)r>0&&(s=!1);else{i=!1;break}e.length===0||i&&!s?(this.dashArray=e,t&&this.setStyle(_e.get("D"))):this.width=0}else e&&(this.width=0)}setHorizontalCornerRadius(e){Number.isInteger(e)&&(this.horizontalCornerRadius=e)}setVerticalCornerRadius(e){Number.isInteger(e)&&(this.verticalCornerRadius=e)}}class ga extends px{constructor(e){super(e);const{dict:t}=e;if(t.has("IRT")){const s=t.getRaw("IRT");this.data.inReplyTo=s instanceof st?s.toString():null;const r=t.get("RT");this.data.replyType=r instanceof _e?r.name:x7.REPLY}let i=null;if(this.data.replyType===x7.GROUP){const s=t.get("IRT");this.setTitle(s.get("T")),this.data.titleObj=this._title,this.setContents(s.get("Contents")),this.data.contentsObj=this._contents,s.has("CreationDate")?(this.setCreationDate(s.get("CreationDate")),this.data.creationDate=this.creationDate):this.data.creationDate=null,s.has("M")?(this.setModificationDate(s.get("M")),this.data.modificationDate=this.modificationDate):this.data.modificationDate=null,i=s.getRaw("Popup"),s.has("C")?(this.setColor(s.getArray("C")),this.data.color=this.color):this.data.color=null}else this.data.titleObj=this._title,this.setCreationDate(t.get("CreationDate")),this.data.creationDate=this.creationDate,i=t.getRaw("Popup"),t.has("C")||(this.data.color=null);this.data.popupRef=i instanceof st?i.toString():null,t.has("RC")&&(this.data.richText=gx.getRichTextAsHtml(t.get("RC")))}setCreationDate(e){this.creationDate=typeof e=="string"?e:null}_setDefaultAppearance({xref:e,extra:t,strokeColor:i,fillColor:s,blendMode:r,strokeAlpha:a,fillAlpha:o,pointsCallback:l}){const c=this.data.rect=[1/0,1/0,-1/0,-1/0],h=["q"];t&&h.push(t),i&&h.push(`${i[0]} ${i[1]} ${i[2]} RG`),s&&h.push(`${s[0]} ${s[1]} ${s[2]} rg`);const u=this.data.quadPoints||Float32Array.from([this.rectangle[0],this.rectangle[3],this.rectangle[2],this.rectangle[3],this.rectangle[0],this.rectangle[1],this.rectangle[2],this.rectangle[1]]);for(let w=0,v=u.length;w<v;w+=8){const _=l(h,u.subarray(w,w+8));Dn.rectBoundingBox(..._,c)}h.push("Q");const d=new fe(e),f=new fe(e);f.set("Subtype",_e.get("Form"));const g=new Yr(h.join(" "));g.dict=f,d.set("Fm0",g);const m=new fe(e);r&&m.set("BM",_e.get(r)),typeof a=="number"&&m.set("CA",a),typeof o=="number"&&m.set("ca",o);const x=new fe(e);x.set("GS0",m);const p=new fe(e);p.set("ExtGState",x),p.set("XObject",d);const y=new fe(e);y.set("Resources",p),y.set("BBox",c),this.appearance=new Yr("/GS0 gs /Fm0 Do"),this.appearance.dict=y,this._streams.push(this.appearance,g)}static async createNewAnnotation(e,t,i,s){const r=t.ref||(t.ref=e.getNewTemporaryRef()),a=await this.createNewAppearanceStream(t,e,s);let o;if(a){const l=e.getNewTemporaryRef();o=this.createNewDict(t,e,{apRef:l}),i.put(l,{data:a})}else o=this.createNewDict(t,e,{});return Number.isInteger(t.parentTreeId)&&o.set("StructParent",t.parentTreeId),i.put(r,{data:o}),{ref:r}}static async createNewPrintAnnotation(e,t,i,s){const r=await this.createNewAppearanceStream(i,t,s),a=this.createNewDict(i,t,r?{ap:r}:{}),o=new this.prototype.constructor({dict:a,xref:t,annotationGlobals:e,evaluatorOptions:s.evaluatorOptions});return i.ref&&(o.ref=o.refToReplace=i.ref),o}}class il extends px{constructor(e){var d;super(e);const{dict:t,xref:i,annotationGlobals:s}=e,r=this.data;this._needAppearances=e.needAppearances,r.annotationType=Ws.WIDGET,r.fieldName===void 0&&(r.fieldName=this._constructFieldName(t)),r.actions===void 0&&(r.actions=Q5(i,t,KT));let a=uo({dict:t,key:"V",getArray:!0});r.fieldValue=this._decodeFormValue(a);const o=uo({dict:t,key:"DV",getArray:!0});if(r.defaultFieldValue=this._decodeFormValue(o),a===void 0&&s.xfaDatasets){const f=this._title.str;f&&(this._hasValueFromXFA=!0,r.fieldValue=a=s.xfaDatasets.getValue(f))}a===void 0&&r.defaultFieldValue!==null&&(r.fieldValue=r.defaultFieldValue),r.alternativeText=Tn(t.get("TU")||""),this.setDefaultAppearance(e),r.hasAppearance||(r.hasAppearance=this._needAppearances&&r.fieldValue!==void 0&&r.fieldValue!==null);const l=uo({dict:t,key:"FT"});r.fieldType=l instanceof _e?l.name:null;const c=uo({dict:t,key:"DR"}),h=s.acroForm.get("DR"),u=(d=this.appearance)==null?void 0:d.dict.get("Resources");this._fieldResources={localResources:c,acroFormResources:h,appearanceResources:u,mergedResources:fe.merge({xref:i,dictArray:[c,u,h],mergeSubDicts:!0})},r.fieldFlags=uo({dict:t,key:"Ff"}),(!Number.isInteger(r.fieldFlags)||r.fieldFlags<0)&&(r.fieldFlags=0),r.password=this.hasFieldFlag(Jo.PASSWORD),r.readOnly=this.hasFieldFlag(Jo.READONLY),r.required=this.hasFieldFlag(Jo.REQUIRED),r.hidden=this._hasFlag(r.annotationFlags,pi.HIDDEN)||this._hasFlag(r.annotationFlags,pi.NOVIEW)}_decodeFormValue(e){return Array.isArray(e)?e.filter(t=>typeof t=="string").map(t=>Tn(t)):e instanceof _e?Tn(e.name):typeof e=="string"?Tn(e):null}hasFieldFlag(e){return!!(this.data.fieldFlags&e)}_isViewable(e){return!0}mustBeViewed(e,t){return t?this.viewable:super.mustBeViewed(e,t)&&!this._hasFlag(this.flags,pi.NOVIEW)}getRotationMatrix(e){var i;let t=(i=e==null?void 0:e.get(this.data.id))==null?void 0:i.rotation;return t===void 0&&(t=this.rotation),t===0?el:S3(t,this.width,this.height)}getBorderAndBackgroundAppearances(e){var r;let t=(r=e==null?void 0:e.get(this.data.id))==null?void 0:r.rotation;if(t===void 0&&(t=this.rotation),!this.backgroundColor&&!this.borderColor)return"";const i=t===0||t===180?`0 0 ${this.width} ${this.height} re`:`0 0 ${this.height} ${this.width} re`;let s="";if(this.backgroundColor&&(s=`${ic(this.backgroundColor,!0)} ${i} f `),this.borderColor){const a=this.borderStyle.width||1;s+=`${a} w ${ic(this.borderColor,!1)} ${i} S `}return s}async getOperatorList(e,t,i,s){if(i&Hr.ANNOTATIONS_FORMS&&!(this instanceof jM)&&!this.data.noHTML&&!this.data.hasOwnCanvas)return{opList:new Ar,separateForm:!0,separateCanvas:!1};if(!this._hasText)return super.getOperatorList(e,t,i,s);const r=await this._getAppearance(e,t,i,s);if(this.appearance&&r===null)return super.getOperatorList(e,t,i,s);const a=new Ar;if(!this._defaultAppearance||r===null)return{opList:a,separateForm:!1,separateCanvas:!1};const o=!!(this.data.hasOwnCanvas&&i&Hr.DISPLAY),l=[1,0,0,1,0,0],c=[0,0,this.width,this.height],h=f6(this.data.rect,c,l);let u;this.oc&&(u=await e.parseMarkedContentProps(this.oc,null)),u!==void 0&&a.addOp(ne.beginMarkedContentProps,["OC",u]),a.addOp(ne.beginAnnotation,[this.data.id,this.data.rect,h,this.getRotationMatrix(s),o]);const d=new Yr(r);return await e.getOperatorList({stream:d,task:t,resources:this._fieldResources.mergedResources,operatorList:a}),a.addOp(ne.endAnnotation,[]),u!==void 0&&a.addOp(ne.endMarkedContent,[]),{opList:a,separateForm:!1,separateCanvas:o}}_getMKDict(e){const t=new fe(null);return e&&t.set("R",e),this.borderColor&&t.set("BC",Ir(this.borderColor)),this.backgroundColor&&t.set("BG",Ir(this.backgroundColor)),t.size>0?t:null}amendSavedDict(e,t){}setValue(e,t,i,s){const{dict:r,ref:a}=aU(e,this.ref,i);if(!r)e.set("V",t);else if(!s.has(a)){const o=r.clone();return o.set("V",t),s.put(a,{data:o}),o}return null}async save(e,t,i,s){const r=i==null?void 0:i.get(this.data.id),a=this._buildFlags(r==null?void 0:r.noView,r==null?void 0:r.noPrint);let o=r==null?void 0:r.value,l=r==null?void 0:r.rotation;if(o===this.data.fieldValue||o===void 0){if(!this._hasValueFromXFA&&l===void 0&&a===void 0)return;o||(o=this.data.fieldValue)}if(l===void 0&&!this._hasValueFromXFA&&Array.isArray(o)&&Array.isArray(this.data.fieldValue)&&Fp(o,this.data.fieldValue)&&a===void 0)return;l===void 0&&(l=this.rotation);let c=null;if(!this._needAppearances&&(c=await this._getAppearance(e,t,Hr.SAVE,i),c===null&&a===void 0))return;let h=!1;c!=null&&c.needAppearances&&(h=!0,c=null);const{xref:u}=e,d=u.fetchIfRef(this.ref);if(!(d instanceof fe))return;const f=new fe(u);for(const p of d.getKeys())p!=="AP"&&f.set(p,d.getRaw(p));if(a!==void 0&&(f.set("F",a),c===null&&!h)){const p=d.getRaw("AP");p&&f.set("AP",p)}const g={path:this.data.fieldName,value:o},m=this.setValue(f,Array.isArray(o)?o.map(fo):fo(o),u,s);this.amendSavedDict(i,m||f);const x=this._getMKDict(l);if(x&&f.set("MK",x),s.put(this.ref,{data:f,xfa:g,needAppearances:h}),c!==null){const p=u.getNewTemporaryRef(),y=new fe(u);f.set("AP",y),y.set("N",p);const w=this._getSaveFieldResources(u),v=new Yr(c),_=v.dict=new fe(u);_.set("Subtype",_e.get("Form")),_.set("Resources",w);const C=l%180===0?[0,0,this.width,this.height]:[0,0,this.height,this.width];_.set("BBox",C);const k=this.getRotationMatrix(i);k!==el&&_.set("Matrix",k),s.put(p,{data:v,xfa:null,needAppearances:!1})}f.set("M",`D:${m0()}`)}async _getAppearance(e,t,i,s){if(this.data.password)return null;const r=s==null?void 0:s.get(this.data.id);let a,o;if(r&&(a=r.formattedValue||r.value,o=r.rotation),o===void 0&&a===void 0&&!this._needAppearances&&(!this._hasValueFromXFA||this.appearance))return null;const l=this.getBorderAndBackgroundAppearances(s);if(a===void 0&&(a=this.data.fieldValue,!a))return`/Tx BMC q ${l}Q EMC`;if(Array.isArray(a)&&a.length===1&&(a=a[0]),Bs(typeof a=="string","Expected `value` to be a string."),a=a.trimEnd(),this.data.combo){const P=this.data.options.find(({exportValue:D})=>a===D);a=(P==null?void 0:P.displayValue)||a}if(a==="")return`/Tx BMC q ${l}Q EMC`;o===void 0&&(o=this.rotation);let c=-1,h;this.data.multiLine?(h=a.split(/\r\n?|\n/).map(P=>P.normalize("NFC")),c=h.length):h=[a.replace(/\r\n?|\n/,"").normalize("NFC")];const u=1,d=2;let{width:f,height:g}=this;(o===90||o===270)&&([f,g]=[g,f]),this._defaultAppearance||(this.data.defaultAppearanceData=R4(this._defaultAppearance="/Helvetica 0 Tf 0 g"));let m=await il._getFontData(e,t,this.data.defaultAppearanceData,this._fieldResources.mergedResources),x,p,y;const w=[];let v=!1;for(const P of h){const D=m.encodeString(P);D.length>1&&(v=!0),w.push(D.join(""))}if(v&&i&Hr.SAVE)return{needAppearances:!0};if(v&&this._isOffscreenCanvasSupported){const P=this.data.comb?"monospace":"sans-serif",D=new Gl(e.xref,P),U=D.createFontResources(h.join("")),T=U.getRaw("Font");if(this._fieldResources.mergedResources.has("Font")){const F=this._fieldResources.mergedResources.get("Font");for(const X of T.getKeys())F.set(X,T.getRaw(X))}else this._fieldResources.mergedResources.set("Font",T);const G=D.fontName.name;m=await il._getFontData(e,t,{fontName:G,fontSize:0},U);for(let F=0,X=w.length;F<X;F++)w[F]=tR(h[F]);const M=Object.assign(Object.create(null),this.data.defaultAppearanceData);this.data.defaultAppearanceData.fontSize=0,this.data.defaultAppearanceData.fontName=G,[x,p,y]=this._computeFontSize(g-2*u,f-2*d,a,m,c),this.data.defaultAppearanceData=M}else this._isOffscreenCanvasSupported||he("_getAppearance: OffscreenCanvas is not supported, annotation may not render correctly."),[x,p,y]=this._computeFontSize(g-2*u,f-2*d,a,m,c);let _=m.descent;isNaN(_)?_=D_*y:_=Math.max(D_*y,Math.abs(_)*p);const C=Math.min(Math.floor((g-p)/2),u),k=this.data.textAlignment;if(this.data.multiLine)return this._getMultilineAppearance(x,w,m,p,f,g,k,d,C,_,y,s);if(this.data.comb)return this._getCombAppearance(x,m,w[0],p,f,g,d,C,_,y,s);const I=C+_;if(k===0||k>2)return`/Tx BMC q ${l}BT `+x+` 1 0 0 1 ${_n(d)} ${_n(I)} Tm (${kg(w[0])}) Tj ET Q EMC`;const S={shift:0},R=this._renderText(w[0],m,p,f,k,S,d,I);return`/Tx BMC q ${l}BT `+x+` 1 0 0 1 0 0 Tm ${R} ET Q EMC`}static async _getFontData(e,t,i,s){const r=new Ar,a={font:null,clone(){return this}},{fontName:o,fontSize:l}=i;return await e.handleSetFont(s,[o&&_e.get(o),l],null,r,t,a,null),a.font}_getTextWidth(e,t){return Math.sumPrecise(t.charsToGlyphs(e).map(i=>i.width))/1e3}_computeFontSize(e,t,i,s,r){let{fontSize:a}=this.data.defaultAppearanceData,o=(a||12)*i0,l=Math.round(e/o);if(!a){const c=d=>Math.floor(d*100)/100;if(r===-1){const d=this._getTextWidth(i,s);a=c(Math.min(e/i0,t/d)),l=1}else{const d=i.split(/\r\n?|\n/),f=[];for(const m of d){const x=s.encodeString(m).join(""),p=s.charsToGlyphs(x),y=s.getCharPositions(x);f.push({line:x,glyphs:p,positions:y})}const g=m=>{let x=0;for(const p of f){const y=this._splitLine(null,s,m,t,p);if(x+=y.length*m,x>e)return!0}return!1};for(l=Math.max(l,r);;){if(o=e/l,a=c(o/i0),g(a)){l++;continue}break}}const{fontName:h,fontColor:u}=this.data.defaultAppearanceData;this._defaultAppearance=uG({fontSize:a,fontName:h,fontColor:u})}return[this._defaultAppearance,a,e/l]}_renderText(e,t,i,s,r,a,o,l){let c;if(r===1){const u=this._getTextWidth(e,t)*i;c=(s-u)/2}else if(r===2){const u=this._getTextWidth(e,t)*i;c=s-u-o}else c=o;const h=_n(c-a.shift);return a.shift=c,l=_n(l),`${h} ${l} Td (${kg(e)}) Tj`}_getSaveFieldResources(e){var a;const{localResources:t,appearanceResources:i,acroFormResources:s}=this._fieldResources,r=(a=this.data.defaultAppearanceData)==null?void 0:a.fontName;if(!r)return t||fe.empty;for(const o of[t,i])if(o instanceof fe){const l=o.get("Font");if(l instanceof fe&&l.has(r))return o}if(s instanceof fe){const o=s.get("Font");if(o instanceof fe&&o.has(r)){const l=new fe(e);l.set(r,o.getRaw(r));const c=new fe(e);return c.set("Font",l),fe.merge({xref:e,dictArray:[c,t],mergeSubDicts:!0})}}return t||fe.empty}getFieldObject(){return null}}class fY extends il{constructor(e){super(e);const{dict:t}=e;t.has("PMD")&&(this.flags|=pi.HIDDEN,this.data.hidden=!0,he("Barcodes are not supported")),this.data.hasOwnCanvas=this.data.readOnly&&!this.data.noHTML,this._hasText=!0,typeof this.data.fieldValue!="string"&&(this.data.fieldValue="");let i=uo({dict:t,key:"Q"});(!Number.isInteger(i)||i<0||i>2)&&(i=null),this.data.textAlignment=i;let s=uo({dict:t,key:"MaxLen"});(!Number.isInteger(s)||s<0)&&(s=0),this.data.maxLen=s,this.data.multiLine=this.hasFieldFlag(Jo.MULTILINE),this.data.comb=this.hasFieldFlag(Jo.COMB)&&!this.data.multiLine&&!this.data.password&&!this.hasFieldFlag(Jo.FILESELECT)&&this.data.maxLen!==0,this.data.doNotScroll=this.hasFieldFlag(Jo.DONOTSCROLL);const{data:{actions:r}}=this;for(const a of(r==null?void 0:r.Keystroke)||[]){const o=a.trim().match(/^AF(Date|Time)_Keystroke(?:Ex)?\(['"]?([^'"]+)['"]?\);$/);if(o){let l=o[2];const c=parseInt(l,10);!isNaN(c)&&Math.floor(Math.log10(c))+1===o[2].length&&(l=(o[1]==="Date"?dG:fG)[c]??l),this.data[o[1]==="Date"?"dateFormat":"timeFormat"]=l;break}}}get hasTextContent(){return!!this.appearance&&!this._needAppearances}_getCombAppearance(e,t,i,s,r,a,o,l,c,h,u){const d=r/this.data.maxLen,f=this.getBorderAndBackgroundAppearances(u),g=[],m=t.getCharPositions(i);for(const[p,y]of m)g.push(`(${kg(i.substring(p,y))}) Tj`);const x=g.join(` ${_n(d)} 0 Td `);return`/Tx BMC q ${f}BT `+e+` 1 0 0 1 ${_n(o)} ${_n(l+c)} Tm ${x} ET Q EMC`}_getMultilineAppearance(e,t,i,s,r,a,o,l,c,h,u,d){const f=[],g=r-2*l,m={shift:0};for(let y=0,w=t.length;y<w;y++){const v=t[y],_=this._splitLine(v,i,s,g);for(let C=0,k=_.length;C<k;C++){const I=_[C],S=y===0&&C===0?-c-(u-h):-u;f.push(this._renderText(I,i,s,r,o,m,l,S))}}const x=this.getBorderAndBackgroundAppearances(d),p=f.join(`
`);return`/Tx BMC q ${x}BT `+e+` 1 0 0 1 0 ${_n(a)} Tm ${p} ET Q EMC`}_splitLine(e,t,i,s,r={}){e=r.line||e;const a=r.glyphs||t.charsToGlyphs(e);if(a.length<=1)return[e];const o=r.positions||t.getCharPositions(e),l=i/1e3,c=[];let h=-1,u=-1,d=-1,f=0,g=0;for(let m=0,x=a.length;m<x;m++){const[p,y]=o[m],w=a[m],v=w.width*l;w.unicode===" "?g+v>s?(c.push(e.substring(f,p)),f=p,g=v,h=-1,d=-1):(g+=v,h=p,u=y,d=m):g+v>s?h!==-1?(c.push(e.substring(f,u)),f=u,m=d+1,h=-1,g=0):(c.push(e.substring(f,p)),f=p,g=v):g+=v}return f<e.length&&c.push(e.substring(f,e.length)),c}async extractTextContent(e,t,i){await super.extractTextContent(e,t,i);const s=this.data.textContent;if(!s)return;const r=s.join(`
`);if(r===this.data.fieldValue)return;const a=r.replaceAll(/([.*+?^${}()|[\]\\])|(\s+)/g,(o,l)=>l?`\\${l}`:"\\s+");new RegExp(`^\\s*${a}\\s*$`).test(this.data.fieldValue)&&(this.data.textContent=this.data.fieldValue.split(`
`))}getFieldObject(){return{id:this.data.id,value:this.data.fieldValue,defaultValue:this.data.defaultFieldValue||"",multiline:this.data.multiLine,password:this.data.password,charLimit:this.data.maxLen,comb:this.data.comb,editable:!this.data.readOnly,hidden:this.data.hidden,name:this.data.fieldName,rect:this.data.rect,actions:this.data.actions,page:this.data.pageIndex,strokeColor:this.data.borderColor,fillColor:this.data.backgroundColor,rotation:this.rotation,type:"text"}}}class gY extends il{constructor(e){super(e),this.checkedAppearance=null,this.uncheckedAppearance=null;const t=this.hasFieldFlag(Jo.RADIO),i=this.hasFieldFlag(Jo.PUSHBUTTON);this.data.checkBox=!t&&!i,this.data.radioButton=t&&!i,this.data.pushButton=i,this.data.isTooltipOnly=!1,this.data.checkBox?this._processCheckBox(e):this.data.radioButton?this._processRadioButton(e):this.data.pushButton?(this.data.hasOwnCanvas=!0,this.data.noHTML=!1,this._processPushButton(e)):he("Invalid field flags for button widget annotation")}async getOperatorList(e,t,i,s){if(this.data.pushButton)return super.getOperatorList(e,t,i,!1,s);let r=null,a=null;if(s){const l=s.get(this.data.id);r=l?l.value:null,a=l?l.rotation:null}if(r===null&&this.appearance)return super.getOperatorList(e,t,i,s);r==null&&(r=this.data.checkBox?this.data.fieldValue===this.data.exportValue:this.data.fieldValue===this.data.buttonValue);const o=r?this.checkedAppearance:this.uncheckedAppearance;if(o){const l=this.appearance,c=Ch(o.dict.getArray("Matrix"),el);a&&o.dict.set("Matrix",this.getRotationMatrix(s)),this.appearance=o;const h=super.getOperatorList(e,t,i,s);return this.appearance=l,o.dict.set("Matrix",c),h}return{opList:new Ar,separateForm:!1,separateCanvas:!1}}async save(e,t,i,s){if(this.data.checkBox){this._saveCheckbox(e,t,i,s);return}this.data.radioButton&&this._saveRadioButton(e,t,i,s)}async _saveCheckbox(e,t,i,s){if(!i)return;const r=i.get(this.data.id),a=this._buildFlags(r==null?void 0:r.noView,r==null?void 0:r.noPrint);let o=r==null?void 0:r.rotation,l=r==null?void 0:r.value;if(o===void 0&&a===void 0&&(l===void 0||this.data.fieldValue===this.data.exportValue===l))return;let c=e.xref.fetchIfRef(this.ref);if(!(c instanceof fe))return;c=c.clone(),o===void 0&&(o=this.rotation),l===void 0&&(l=this.data.fieldValue===this.data.exportValue);const h={path:this.data.fieldName,value:l?this.data.exportValue:""},u=_e.get(l?this.data.exportValue:"Off");this.setValue(c,u,e.xref,s),c.set("AS",u),c.set("M",`D:${m0()}`),a!==void 0&&c.set("F",a);const d=this._getMKDict(o);d&&c.set("MK",d),s.put(this.ref,{data:c,xfa:h,needAppearances:!1})}async _saveRadioButton(e,t,i,s){if(!i)return;const r=i.get(this.data.id),a=this._buildFlags(r==null?void 0:r.noView,r==null?void 0:r.noPrint);let o=r==null?void 0:r.rotation,l=r==null?void 0:r.value;if(o===void 0&&a===void 0&&(l===void 0||this.data.fieldValue===this.data.buttonValue===l))return;let c=e.xref.fetchIfRef(this.ref);if(!(c instanceof fe))return;c=c.clone(),l===void 0&&(l=this.data.fieldValue===this.data.buttonValue),o===void 0&&(o=this.rotation);const h={path:this.data.fieldName,value:l?this.data.buttonValue:""},u=_e.get(l?this.data.buttonValue:"Off");l&&this.setValue(c,u,e.xref,s),c.set("AS",u),c.set("M",`D:${m0()}`),a!==void 0&&c.set("F",a);const d=this._getMKDict(o);d&&c.set("MK",d),s.put(this.ref,{data:c,xfa:h,needAppearances:!1})}_getDefaultCheckedAppearance(e,t){const{width:i,height:s}=this,r=[0,0,i,s],o=Math.min(i,s)*.8;let l,c;t==="check"?(l={width:.755*o,height:.705*o},c="3"):t==="disc"?(l={width:.791*o,height:.705*o},c="l"):kn(`_getDefaultCheckedAppearance - unsupported type: ${t}`);const h=_n((i-l.width)/2),u=_n((s-l.height)/2),d=`q BT /PdfJsZaDb ${o} Tf 0 g ${h} ${u} Td (${c}) Tj ET Q`,f=new fe(e.xref);f.set("FormType",1),f.set("Subtype",_e.get("Form")),f.set("Type",_e.get("XObject")),f.set("BBox",r),f.set("Matrix",[1,0,0,1,0,0]),f.set("Length",d.length);const g=new fe(e.xref),m=new fe(e.xref);m.set("PdfJsZaDb",this.fallbackFontDict),g.set("Font",m),f.set("Resources",g),this.checkedAppearance=new Yr(d),this.checkedAppearance.dict=f,this._streams.push(this.checkedAppearance)}_processCheckBox(e){const t=e.dict.get("AP");if(!(t instanceof fe))return;const i=t.get("N");if(!(i instanceof fe))return;const s=this._decodeFormValue(e.dict.get("AS"));typeof s=="string"&&(this.data.fieldValue=s);const r=this.data.fieldValue!==null&&this.data.fieldValue!=="Off"?this.data.fieldValue:"Yes",a=this._decodeFormValue(i.getKeys());if(a.length===0)a.push("Off",r);else if(a.length===1)a[0]==="Off"?a.push(r):a.unshift("Off");else if(a.includes(r))a.length=0,a.push("Off",r);else{const c=a.find(h=>h!=="Off");a.length=0,a.push("Off",c)}a.includes(this.data.fieldValue)||(this.data.fieldValue="Off"),this.data.exportValue=a[1];const o=i.get(this.data.exportValue);this.checkedAppearance=o instanceof hn?o:null;const l=i.get("Off");this.uncheckedAppearance=l instanceof hn?l:null,this.checkedAppearance?this._streams.push(this.checkedAppearance):this._getDefaultCheckedAppearance(e,"check"),this.uncheckedAppearance&&this._streams.push(this.uncheckedAppearance),this._fallbackFontDict=this.fallbackFontDict,this.data.defaultFieldValue===null&&(this.data.defaultFieldValue="Off")}_processRadioButton(e){this.data.buttonValue=null;const t=e.dict.get("Parent");if(t instanceof fe){this.parent=e.dict.getRaw("Parent");const o=t.get("V");o instanceof _e&&(this.data.fieldValue=this._decodeFormValue(o))}const i=e.dict.get("AP");if(!(i instanceof fe))return;const s=i.get("N");if(!(s instanceof fe))return;for(const o of s.getKeys())if(o!=="Off"){this.data.buttonValue=this._decodeFormValue(o);break}const r=s.get(this.data.buttonValue);this.checkedAppearance=r instanceof hn?r:null;const a=s.get("Off");this.uncheckedAppearance=a instanceof hn?a:null,this.checkedAppearance?this._streams.push(this.checkedAppearance):this._getDefaultCheckedAppearance(e,"disc"),this.uncheckedAppearance&&this._streams.push(this.uncheckedAppearance),this._fallbackFontDict=this.fallbackFontDict,this.data.defaultFieldValue===null&&(this.data.defaultFieldValue="Off")}_processPushButton(e){const{dict:t,annotationGlobals:i}=e;if(!t.has("A")&&!t.has("AA")&&!this.data.alternativeText){he("Push buttons without action dictionaries are not supported");return}this.data.isTooltipOnly=!t.has("A")&&!t.has("AA"),Kp.parseDestDictionary({destDict:t,resultObj:this.data,docBaseUrl:i.baseUrl,docAttachments:i.attachments})}getFieldObject(){let e="button",t;return this.data.checkBox?(e="checkbox",t=this.data.exportValue):this.data.radioButton&&(e="radiobutton",t=this.data.buttonValue),{id:this.data.id,value:this.data.fieldValue||"Off",defaultValue:this.data.defaultFieldValue,exportValues:t,editable:!this.data.readOnly,name:this.data.fieldName,rect:this.data.rect,hidden:this.data.hidden,actions:this.data.actions,page:this.data.pageIndex,strokeColor:this.data.borderColor,fillColor:this.data.backgroundColor,rotation:this.rotation,type:e}}get fallbackFontDict(){const e=new fe;return e.set("BaseFont",_e.get("ZapfDingbats")),e.set("Type",_e.get("FallbackType")),e.set("Subtype",_e.get("FallbackType")),e.set("Encoding",_e.get("ZapfDingbatsEncoding")),Ze(this,"fallbackFontDict",e)}}class mY extends il{constructor(e){var r;super(e);const{dict:t,xref:i}=e;this.indices=t.getArray("I"),this.hasIndices=Array.isArray(this.indices)&&this.indices.length>0,this.data.options=[];const s=uo({dict:t,key:"Opt"});if(Array.isArray(s))for(let a=0,o=s.length;a<o;a++){const l=i.fetchIfRef(s[a]),c=Array.isArray(l);this.data.options[a]={exportValue:this._decodeFormValue(c?i.fetchIfRef(l[0]):l),displayValue:this._decodeFormValue(c?i.fetchIfRef(l[1]):l)}}if(!this.hasIndices)typeof this.data.fieldValue=="string"?this.data.fieldValue=[this.data.fieldValue]:(r=this.data).fieldValue||(r.fieldValue=[]);else{this.data.fieldValue=[];const a=this.data.options.length;for(const o of this.indices)Number.isInteger(o)&&o>=0&&o<a&&this.data.fieldValue.push(this.data.options[o].exportValue)}this.data.options.length===0&&this.data.fieldValue.length>0&&(this.data.options=this.data.fieldValue.map(a=>({exportValue:a,displayValue:a}))),this.data.combo=this.hasFieldFlag(Jo.COMBO),this.data.multiSelect=this.hasFieldFlag(Jo.MULTISELECT),this._hasText=!0}getFieldObject(){const e=this.data.combo?"combobox":"listbox",t=this.data.fieldValue.length>0?this.data.fieldValue[0]:null;return{id:this.data.id,value:t,defaultValue:this.data.defaultFieldValue,editable:!this.data.readOnly,name:this.data.fieldName,rect:this.data.rect,numItems:this.data.fieldValue.length,multipleSelection:this.data.multiSelect,hidden:this.data.hidden,actions:this.data.actions,items:this.data.options,page:this.data.pageIndex,strokeColor:this.data.borderColor,fillColor:this.data.backgroundColor,rotation:this.rotation,type:e}}amendSavedDict(e,t){var a;if(!this.hasIndices)return;let i=(a=e==null?void 0:e.get(this.data.id))==null?void 0:a.value;Array.isArray(i)||(i=[i]);const s=[],{options:r}=this.data;for(let o=0,l=0,c=r.length;o<c;o++)r[o].exportValue===i[l]&&(s.push(o),l+=1);t.set("I",s)}async _getAppearance(e,t,i,s){if(this.data.combo)return super._getAppearance(e,t,i,s);let r,a;const o=s==null?void 0:s.get(this.data.id);if(o&&(a=o.rotation,r=o.value),a===void 0&&r===void 0&&!this._needAppearances)return null;r===void 0?r=this.data.fieldValue:Array.isArray(r)||(r=[r]);const l=1,c=2;let{width:h,height:u}=this;(a===90||a===270)&&([h,u]=[u,h]);const d=this.data.options.length,f=[];for(let I=0;I<d;I++){const{exportValue:S}=this.data.options[I];r.includes(S)&&f.push(I)}this._defaultAppearance||(this.data.defaultAppearanceData=R4(this._defaultAppearance="/Helvetica 0 Tf 0 g"));const g=await il._getFontData(e,t,this.data.defaultAppearanceData,this._fieldResources.mergedResources);let m,{fontSize:x}=this.data.defaultAppearanceData;if(x)m=this._defaultAppearance;else{const I=(u-l)/d;let S=-1,R;for(const{displayValue:P}of this.data.options){const D=this._getTextWidth(P,g);D>S&&(S=D,R=P)}[m,x]=this._computeFontSize(I,h-2*c,R,g,-1)}const p=x*i0,y=(p-x)/2,w=Math.floor(u/p);let v=0;if(f.length>0){const I=Math.min(...f),S=Math.max(...f);v=Math.max(0,S-w+1),v>I&&(v=I)}const _=Math.min(v+w+1,d),C=["/Tx BMC q",`1 1 ${h} ${u} re W n`];if(f.length){C.push("0.600006 0.756866 0.854904 rg");for(const I of f)v<=I&&I<_&&C.push(`1 ${u-(I-v+1)*p} ${h} ${p} re f`)}C.push("BT",m,`1 0 0 1 0 ${u} Tm`);const k={shift:0};for(let I=v;I<_;I++){const{displayValue:S}=this.data.options[I],R=I===v?y:0;C.push(this._renderText(S,g,x,h,0,k,c,-p+R))}return C.push("ET Q EMC"),C.join(`
`)}}class jM extends il{constructor(e){super(e),this.data.fieldValue=null,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!this.data.hasOwnCanvas}getFieldObject(){return{id:this.data.id,value:null,page:this.data.pageIndex,type:"signature"}}}class pY extends ga{constructor(e){super(e),this.data.noRotate=!0,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1;const{dict:i}=e;this.data.annotationType=Ws.TEXT,this.data.hasAppearance?this.data.name="NoIcon":(this.data.rect[1]=this.data.rect[3]-22,this.data.rect[2]=this.data.rect[0]+22,this.data.name=i.has("Name")?i.get("Name").name:"Note"),i.has("State")?(this.data.state=i.get("State")||null,this.data.stateModel=i.get("StateModel")||null):(this.data.state=null,this.data.stateModel=null)}}class bY extends px{constructor(e){var r;super(e);const{dict:t,annotationGlobals:i}=e;this.data.annotationType=Ws.LINK,this.data.noHTML=!1;const s=mx(t,this.rectangle);s&&(this.data.quadPoints=s),(r=this.data).borderColor||(r.borderColor=this.data.color),Kp.parseDestDictionary({destDict:t,resultObj:this.data,docBaseUrl:i.baseUrl,docAttachments:i.attachments})}}class GM extends px{constructor(e){super(e);const{dict:t}=e;this.data.annotationType=Ws.POPUP,this.data.noHTML=!1,(this.width===0||this.height===0)&&(this.data.rect=null);let i=t.get("Parent");if(!i){he("Popup annotation has a missing or invalid parent annotation.");return}this.data.parentRect=p0(i.getArray("Rect"),null);const s=i.get("RT");if(Oi(s,x7.GROUP)&&(i=i.get("IRT")),i.has("M")?(this.setModificationDate(i.get("M")),this.data.modificationDate=this.modificationDate):this.data.modificationDate=null,i.has("C")?(this.setColor(i.getArray("C")),this.data.color=this.color):this.data.color=null,!this.viewable){const r=i.get("F");this._isViewable(r)&&this.setFlags(r)}this.setTitle(i.get("T")),this.data.titleObj=this._title,this.setContents(i.get("Contents")),this.data.contentsObj=this._contents,i.has("RC")&&(this.data.richText=gx.getRichTextAsHtml(i.get("RC"))),this.data.open=!!t.get("Open")}}class Dw extends ga{constructor(e){var r;super(e),this.data.hasOwnCanvas=this.data.noRotate,this.data.isEditable=!this.data.noHTML,this.data.noHTML=!1;const{annotationGlobals:t,evaluatorOptions:i,xref:s}=e;if(this.data.annotationType=Ws.FREETEXT,this.setDefaultAppearance(e),this._hasAppearance=!!this.appearance,this._hasAppearance){const{fontColor:a,fontSize:o}=hG(this.appearance,i,s,t.globalColorSpaceCache);this.data.defaultAppearanceData.fontColor=a,this.data.defaultAppearanceData.fontSize=o||10}else{(r=this.data.defaultAppearanceData).fontSize||(r.fontSize=10);const{fontColor:a,fontSize:o}=this.data.defaultAppearanceData;if(this._contents.str){this.data.textContent=this._contents.str.split(/\r\n?|\n/).map(u=>u.trimEnd());const{coords:l,bbox:c,matrix:h}=Gl.getFirstPositionInfo(this.rectangle,this.rotation,o);this.data.textPosition=this._transformPoint(l,c,h)}if(this._isOffscreenCanvasSupported){const l=e.dict.get("CA"),c=new Gl(s,"sans-serif");this.appearance=c.createAppearance(this._contents.str,this.rectangle,this.rotation,o,a,l),this._streams.push(this.appearance)}else he("FreeTextAnnotation: OffscreenCanvas is not supported, annotation may not render correctly.")}}get hasTextContent(){return this._hasAppearance}static createNewDict(e,t,{apRef:i,ap:s}){const{color:r,fontSize:a,oldAnnotation:o,rect:l,rotation:c,user:h,value:u}=e,d=o||new fe(t);d.set("Type",_e.get("Annot")),d.set("Subtype",_e.get("FreeText")),o?(d.set("M",`D:${m0()}`),d.delete("RC")):d.set("CreationDate",`D:${m0()}`),d.set("Rect",l);const f=`/Helv ${a} Tf ${ic(r,!0)}`;if(d.set("DA",f),d.set("Contents",fo(u)),d.set("F",4),d.set("Border",[0,0,0]),d.set("Rotate",c),h&&d.set("T",fo(h)),i||s){const g=new fe(t);d.set("AP",g),i?g.set("N",i):g.set("N",s)}return d}static async createNewAppearanceStream(e,t,i){const{baseFontRef:s,evaluator:r,task:a}=i,{color:o,fontSize:l,rect:c,rotation:h,value:u}=e,d=new fe(t),f=new fe(t);if(s)f.set("Helv",s);else{const ue=new fe(t);ue.set("BaseFont",_e.get("Helvetica")),ue.set("Type",_e.get("Font")),ue.set("Subtype",_e.get("Type1")),ue.set("Encoding",_e.get("WinAnsiEncoding")),f.set("Helv",ue)}d.set("Font",f);const g=await il._getFontData(r,a,{fontName:"Helv",fontSize:l},d),[m,x,p,y]=c;let w=p-m,v=y-x;h%180!==0&&([w,v]=[v,w]);const _=u.split(`
`),C=l/1e3;let k=-1/0;const I=[];for(let ue of _){const pe=g.encodeString(ue);if(pe.length>1)return null;ue=pe.join(""),I.push(ue);let de=0;const O=g.charsToGlyphs(ue);for(const Y of O)de+=Y.width*C;k=Math.max(k,de)}let S=1;k>w&&(S=w/k);let R=1;const P=i0*l,D=(i0-_3)*l,U=P*_.length;U>v&&(R=v/U);const T=Math.min(S,R),G=l*T;let M,F,X;switch(h){case 0:X=[1,0,0,1],F=[c[0],c[1],w,v],M=[c[0],c[3]-D];break;case 90:X=[0,1,-1,0],F=[c[1],-c[2],w,v],M=[c[1],-c[0]-D];break;case 180:X=[-1,0,0,-1],F=[-c[2],-c[3],w,v],M=[-c[2],-c[1]-D];break;case 270:X=[0,-1,1,0],F=[-c[3],c[0],w,v],M=[-c[3],c[2]-D];break}const z=["q",`${X.join(" ")} 0 0 cm`,`${F.join(" ")} re W n`,"BT",`${ic(o,!0)}`,`0 Tc /Helv ${_n(G)} Tf`];z.push(`${M.join(" ")} Td (${kg(I[0])}) Tj`);const K=_n(P);for(let ue=1,pe=I.length;ue<pe;ue++){const de=I[ue];z.push(`0 -${K} Td (${kg(de)}) Tj`)}z.push("ET","Q");const j=z.join(`
`),ae=new fe(t);ae.set("FormType",1),ae.set("Subtype",_e.get("Form")),ae.set("Type",_e.get("XObject")),ae.set("BBox",c),ae.set("Resources",d),ae.set("Matrix",[1,0,0,1,-c[0],-c[1]]);const ge=new Yr(j);return ge.dict=ae,ge}}class xY extends ga{constructor(e){super(e);const{dict:t,xref:i}=e;this.data.annotationType=Ws.LINE,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1;const s=S7(t.getArray("L"),[0,0,0,0]);if(this.data.lineCoordinates=Dn.normalizeRect(s),this.setLineEndings(t.getArray("LE")),this.data.lineEndings=this.lineEndings,!this.appearance){const r=this.color?Ir(this.color):[0,0,0],a=t.get("CA"),o=n1(t.getArray("IC"),null),l=o?Ir(o):null,c=l?a:null,h=this.borderStyle.width||1,u=2*h,d=[this.data.lineCoordinates[0]-u,this.data.lineCoordinates[1]-u,this.data.lineCoordinates[2]+u,this.data.lineCoordinates[3]+u];Dn.intersect(this.rectangle,d)||(this.rectangle=d),this._setDefaultAppearance({xref:i,extra:`${h} w`,strokeColor:r,fillColor:l,strokeAlpha:a,fillAlpha:c,pointsCallback:(f,g)=>(f.push(`${s[0]} ${s[1]} m`,`${s[2]} ${s[3]} l`,"S"),[g[0]-h,g[7]-h,g[2]+h,g[3]+h])})}}}class yY extends ga{constructor(e){super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Ws.SQUARE,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1,!this.appearance){const s=this.color?Ir(this.color):[0,0,0],r=t.get("CA"),a=n1(t.getArray("IC"),null),o=a?Ir(a):null,l=o?r:null;if(this.borderStyle.width===0&&!o)return;this._setDefaultAppearance({xref:i,extra:`${this.borderStyle.width} w`,strokeColor:s,fillColor:o,strokeAlpha:r,fillAlpha:l,pointsCallback:(c,h)=>{const u=h[4]+this.borderStyle.width/2,d=h[5]+this.borderStyle.width/2,f=h[6]-h[4]-this.borderStyle.width,g=h[3]-h[7]-this.borderStyle.width;return c.push(`${u} ${d} ${f} ${g} re`),o?c.push("B"):c.push("S"),[h[0],h[7],h[2],h[3]]}})}}}class wY extends ga{constructor(e){super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Ws.CIRCLE,!this.appearance){const s=this.color?Ir(this.color):[0,0,0],r=t.get("CA"),a=n1(t.getArray("IC"),null),o=a?Ir(a):null,l=o?r:null;if(this.borderStyle.width===0&&!o)return;const c=4/3*Math.tan(Math.PI/(2*4));this._setDefaultAppearance({xref:i,extra:`${this.borderStyle.width} w`,strokeColor:s,fillColor:o,strokeAlpha:r,fillAlpha:l,pointsCallback:(h,u)=>{const d=u[0]+this.borderStyle.width/2,f=u[1]-this.borderStyle.width/2,g=u[6]-this.borderStyle.width/2,m=u[7]+this.borderStyle.width/2,x=d+(g-d)/2,p=f+(m-f)/2,y=(g-d)/2*c,w=(m-f)/2*c;return h.push(`${x} ${m} m`,`${x+y} ${m} ${g} ${p+w} ${g} ${p} c`,`${g} ${p-w} ${x+y} ${f} ${x} ${f} c`,`${x-y} ${f} ${d} ${p-w} ${d} ${p} c`,`${d} ${p+w} ${x-y} ${m} ${x} ${m} c`,"h"),o?h.push("B"):h.push("S"),[u[0],u[7],u[2],u[3]]}})}}}class VM extends ga{constructor(e){super(e);const{dict:t,xref:i}=e;this.data.annotationType=Ws.POLYLINE,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1,this.data.vertices=null,this instanceof qM||(this.setLineEndings(t.getArray("LE")),this.data.lineEndings=this.lineEndings);const s=t.getArray("Vertices");if(!Gr(s,null))return;const r=this.data.vertices=Float32Array.from(s);if(!this.appearance){const a=this.color?Ir(this.color):[0,0,0],o=t.get("CA"),l=this.borderStyle.width||1,c=2*l,h=[1/0,1/0,-1/0,-1/0];for(let u=0,d=r.length;u<d;u+=2)Dn.rectBoundingBox(r[u]-c,r[u+1]-c,r[u]+c,r[u+1]+c,h);Dn.intersect(this.rectangle,h)||(this.rectangle=h),this._setDefaultAppearance({xref:i,extra:`${l} w`,strokeColor:a,strokeAlpha:o,pointsCallback:(u,d)=>{for(let f=0,g=r.length;f<g;f+=2)u.push(`${r[f]} ${r[f+1]} ${f===0?"m":"l"}`);return u.push("S"),[d[0],d[7],d[2],d[3]]}})}}}class qM extends VM{constructor(e){super(e),this.data.annotationType=Ws.POLYGON}}class vY extends ga{constructor(e){super(e),this.data.annotationType=Ws.CARET}}class Fm extends ga{constructor(e){super(e),this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1;const{dict:t,xref:i}=e;this.data.annotationType=Ws.INK,this.data.inkLists=[],this.data.isEditable=!this.data.noHTML,this.data.noHTML=!1,this.data.opacity=t.get("CA")||1;const s=t.getArray("InkList");if(Array.isArray(s)){for(let r=0,a=s.length;r<a;++r){if(!Array.isArray(s[r]))continue;const o=new Float32Array(s[r].length);this.data.inkLists.push(o);for(let l=0,c=s[r].length;l<c;l+=2){const h=i.fetchIfRef(s[r][l]),u=i.fetchIfRef(s[r][l+1]);typeof h=="number"&&typeof u=="number"&&(o[l]=h,o[l+1]=u)}}if(!this.appearance){const r=this.color?Ir(this.color):[0,0,0],a=t.get("CA"),o=this.borderStyle.width||1,l=2*o,c=[1/0,1/0,-1/0,-1/0];for(const h of this.data.inkLists)for(let u=0,d=h.length;u<d;u+=2)Dn.rectBoundingBox(h[u]-l,h[u+1]-l,h[u]+l,h[u+1]+l,c);Dn.intersect(this.rectangle,c)||(this.rectangle=c),this._setDefaultAppearance({xref:i,extra:`${o} w`,strokeColor:r,strokeAlpha:a,pointsCallback:(h,u)=>{for(const d of this.data.inkLists){for(let f=0,g=d.length;f<g;f+=2)h.push(`${d[f]} ${d[f+1]} ${f===0?"m":"l"}`);h.push("S")}return[u[0],u[7],u[2],u[3]]}})}}}static createNewDict(e,t,{apRef:i,ap:s}){const{oldAnnotation:r,color:a,opacity:o,paths:l,outlines:c,rect:h,rotation:u,thickness:d,user:f}=e,g=r||new fe(t);g.set("Type",_e.get("Annot")),g.set("Subtype",_e.get("Ink")),g.set(r?"M":"CreationDate",`D:${m0()}`),g.set("Rect",h),g.set("InkList",(c==null?void 0:c.points)||l.points),g.set("F",4),g.set("Rotate",u),f&&g.set("T",fo(f)),c&&g.set("IT",_e.get("InkHighlight"));const m=new fe(t);g.set("BS",m),m.set("W",d),g.set("C",Ir(a)),g.set("CA",o);const x=new fe(t);return g.set("AP",x),i?x.set("N",i):x.set("N",s),g}static async createNewAppearanceStream(e,t,i){if(e.outlines)return this.createNewAppearanceStreamForHighlight(e,t,i);const{color:s,rect:r,paths:a,thickness:o,opacity:l}=e,c=[`${o} w 1 J 1 j`,`${ic(s,!1)}`];l!==1&&c.push("/R0 gs");for(const f of a.lines){c.push(`${_n(f[4])} ${_n(f[5])} m`);for(let g=6,m=f.length;g<m;g+=6)if(isNaN(f[g]))c.push(`${_n(f[g+4])} ${_n(f[g+5])} l`);else{const[x,p,y,w,v,_]=f.slice(g,g+6);c.push([x,p,y,w,v,_].map(_n).join(" ")+" c")}f.length===6&&c.push(`${_n(f[4])} ${_n(f[5])} l`)}c.push("S");const h=c.join(`
`),u=new fe(t);if(u.set("FormType",1),u.set("Subtype",_e.get("Form")),u.set("Type",_e.get("XObject")),u.set("BBox",r),u.set("Length",h.length),l!==1){const f=new fe(t),g=new fe(t),m=new fe(t);m.set("CA",l),m.set("Type",_e.get("ExtGState")),g.set("R0",m),f.set("ExtGState",g),u.set("Resources",f)}const d=new Yr(h);return d.dict=u,d}static async createNewAppearanceStreamForHighlight(e,t,i){const{color:s,rect:r,outlines:{outline:a},opacity:o}=e,l=[`${ic(s,!0)}`,"/R0 gs"];l.push(`${_n(a[4])} ${_n(a[5])} m`);for(let m=6,x=a.length;m<x;m+=6)if(isNaN(a[m]))l.push(`${_n(a[m+4])} ${_n(a[m+5])} l`);else{const[p,y,w,v,_,C]=a.slice(m,m+6);l.push([p,y,w,v,_,C].map(_n).join(" ")+" c")}l.push("h f");const c=l.join(`
`),h=new fe(t);h.set("FormType",1),h.set("Subtype",_e.get("Form")),h.set("Type",_e.get("XObject")),h.set("BBox",r),h.set("Length",c.length);const u=new fe(t),d=new fe(t);u.set("ExtGState",d),h.set("Resources",u);const f=new fe(t);d.set("R0",f),f.set("BM",_e.get("Multiply")),o!==1&&(f.set("ca",o),f.set("Type",_e.get("ExtGState")));const g=new Yr(c);return g.dict=h,g}}class Lw extends ga{constructor(e){var r;super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Ws.HIGHLIGHT,this.data.isEditable=!this.data.noHTML,this.data.noHTML=!1,this.data.opacity=t.get("CA")||1,this.data.quadPoints=mx(t,null)){const a=(r=this.appearance)==null?void 0:r.dict.get("Resources");if(!this.appearance||!(a!=null&&a.has("ExtGState"))){this.appearance&&he("HighlightAnnotation - ignoring built-in appearance stream.");const o=this.color?Ir(this.color):[1,1,0],l=t.get("CA");this._setDefaultAppearance({xref:i,fillColor:o,blendMode:"Multiply",fillAlpha:l,pointsCallback:(c,h)=>(c.push(`${h[0]} ${h[1]} m`,`${h[2]} ${h[3]} l`,`${h[6]} ${h[7]} l`,`${h[4]} ${h[5]} l`,"f"),[h[0],h[7],h[2],h[3]])})}}else this.data.popupRef=null}get overlaysTextContent(){return!0}static createNewDict(e,t,{apRef:i,ap:s}){const{color:r,oldAnnotation:a,opacity:o,rect:l,rotation:c,user:h,quadPoints:u}=e,d=a||new fe(t);if(d.set("Type",_e.get("Annot")),d.set("Subtype",_e.get("Highlight")),d.set(a?"M":"CreationDate",`D:${m0()}`),d.set("CreationDate",`D:${m0()}`),d.set("Rect",l),d.set("F",4),d.set("Border",[0,0,0]),d.set("Rotate",c),d.set("QuadPoints",u),d.set("C",Ir(r)),d.set("CA",o),h&&d.set("T",fo(h)),i||s){const f=new fe(t);d.set("AP",f),f.set("N",i||s)}return d}static async createNewAppearanceStream(e,t,i){const{color:s,rect:r,outlines:a,opacity:o}=e,l=[`${ic(s,!0)}`,"/R0 gs"],c=[];for(const x of a){c.length=0,c.push(`${_n(x[0])} ${_n(x[1])} m`);for(let p=2,y=x.length;p<y;p+=2)c.push(`${_n(x[p])} ${_n(x[p+1])} l`);c.push("h"),l.push(c.join(`
`))}l.push("f*");const h=l.join(`
`),u=new fe(t);u.set("FormType",1),u.set("Subtype",_e.get("Form")),u.set("Type",_e.get("XObject")),u.set("BBox",r),u.set("Length",h.length);const d=new fe(t),f=new fe(t);d.set("ExtGState",f),u.set("Resources",d);const g=new fe(t);f.set("R0",g),g.set("BM",_e.get("Multiply")),o!==1&&(g.set("ca",o),g.set("Type",_e.get("ExtGState")));const m=new Yr(h);return m.dict=u,m}}class _Y extends ga{constructor(e){super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Ws.UNDERLINE,this.data.quadPoints=mx(t,null)){if(!this.appearance){const r=this.color?Ir(this.color):[0,0,0],a=t.get("CA");this._setDefaultAppearance({xref:i,extra:"[] 0 d 0.571 w",strokeColor:r,strokeAlpha:a,pointsCallback:(o,l)=>(o.push(`${l[4]} ${l[5]+1.3} m`,`${l[6]} ${l[7]+1.3} l`,"S"),[l[0],l[7],l[2],l[3]])})}}else this.data.popupRef=null}get overlaysTextContent(){return!0}}class kY extends ga{constructor(e){super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Ws.SQUIGGLY,this.data.quadPoints=mx(t,null)){if(!this.appearance){const r=this.color?Ir(this.color):[0,0,0],a=t.get("CA");this._setDefaultAppearance({xref:i,extra:"[] 0 d 1 w",strokeColor:r,strokeAlpha:a,pointsCallback:(o,l)=>{const c=(l[1]-l[5])/6;let h=c,u=l[4];const d=l[5],f=l[6];o.push(`${u} ${d+h} m`);do u+=2,h=h===0?c:0,o.push(`${u} ${d+h} l`);while(u<f);return o.push("S"),[l[4],d-2*c,f,d+2*c]}})}}else this.data.popupRef=null}get overlaysTextContent(){return!0}}class CY extends ga{constructor(e){super(e);const{dict:t,xref:i}=e;if(this.data.annotationType=Ws.STRIKEOUT,this.data.quadPoints=mx(t,null)){if(!this.appearance){const r=this.color?Ir(this.color):[0,0,0],a=t.get("CA");this._setDefaultAppearance({xref:i,extra:"[] 0 d 1 w",strokeColor:r,strokeAlpha:a,pointsCallback:(o,l)=>(o.push(`${(l[0]+l[4])/2} ${(l[1]+l[5])/2} m`,`${(l[2]+l[6])/2} ${(l[3]+l[7])/2} l`,"S"),[l[0],l[7],l[2],l[3]])})}}else this.data.popupRef=null}get overlaysTextContent(){return!0}}var Md,U5,WM;class ou extends ga{constructor(t){super(t);B(this,Md,null);this.data.annotationType=Ws.STAMP,this.data.hasOwnCanvas=this.data.noRotate,this.data.isEditable=!this.data.noHTML,this.data.noHTML=!1}mustBeViewedWhenEditing(t,i=null){return t?(this.data.isEditable&&(b(this,Md)??N(this,Md,this.data.hasOwnCanvas),this.data.hasOwnCanvas=!0),!0):(b(this,Md)!==null&&(this.data.hasOwnCanvas=b(this,Md),N(this,Md,null)),!(i!=null&&i.has(this.data.id)))}static async createImage(t,i){const{width:s,height:r}=t,a=new OffscreenCanvas(s,r),o=a.getContext("2d",{alpha:!0});o.drawImage(t,0,0);const l=o.getImageData(0,0,s,r).data,c=new Uint32Array(l.buffer),h=c.some(da.isLittleEndian?p=>p>>>24!==255:p=>(p&255)!==255);h&&(o.fillStyle="white",o.fillRect(0,0,s,r),o.drawImage(t,0,0));const u=a.convertToBlob({type:"image/jpeg",quality:1}).then(p=>p.arrayBuffer()),d=_e.get("XObject"),f=_e.get("Image"),g=new fe(i);g.set("Type",d),g.set("Subtype",f),g.set("BitsPerComponent",8),g.set("ColorSpace",_e.get("DeviceRGB")),g.set("Filter",_e.get("DCTDecode")),g.set("BBox",[0,0,s,r]),g.set("Width",s),g.set("Height",r);let m=null;if(h){const p=new Uint8Array(c.length);if(da.isLittleEndian)for(let w=0,v=c.length;w<v;w++)p[w]=c[w]>>>24;else for(let w=0,v=c.length;w<v;w++)p[w]=c[w]&255;const y=new fe(i);y.set("Type",d),y.set("Subtype",f),y.set("BitsPerComponent",8),y.set("ColorSpace",_e.get("DeviceGray")),y.set("Width",s),y.set("Height",r),m=new Ui(p,0,0,y)}return{imageStream:new Ui(await u,0,0,g),smaskStream:m,width:s,height:r}}static createNewDict(t,i,{apRef:s,ap:r}){const{oldAnnotation:a,rect:o,rotation:l,user:c}=t,h=a||new fe(i);if(h.set("Type",_e.get("Annot")),h.set("Subtype",_e.get("Stamp")),h.set(a?"M":"CreationDate",`D:${m0()}`),h.set("Rect",o),h.set("F",4),h.set("Border",[0,0,0]),h.set("Rotate",l),c&&h.set("T",fo(c)),s||r){const u=new fe(i);h.set("AP",u),s?u.set("N",s):u.set("N",r)}return h}static async createNewAppearanceStream(t,i,s){if(t.oldAnnotation)return null;if(t.isSignature)return L(this,U5,WM).call(this,t,i);const{rotation:r}=t,{imageRef:a,width:o,height:l}=s.image,c=new fe(i),h=new fe(i);c.set("XObject",h),h.set("Im0",a);const u=`q ${o} 0 0 ${l} 0 0 cm /Im0 Do Q`,d=new fe(i);if(d.set("FormType",1),d.set("Subtype",_e.get("Form")),d.set("Type",_e.get("XObject")),d.set("BBox",[0,0,o,l]),d.set("Resources",c),r){const g=S3(r,o,l);d.set("Matrix",g)}const f=new Yr(u);return f.dict=d,f}}Md=new WeakMap,U5=new WeakSet,WM=async function(t,i){const{areContours:s,color:r,rect:a,lines:o,thickness:l}=t,c=[`${l} w 1 J 1 j`,`${ic(r,s)}`];for(const f of o){c.push(`${_n(f[4])} ${_n(f[5])} m`);for(let g=6,m=f.length;g<m;g+=6)if(isNaN(f[g]))c.push(`${_n(f[g+4])} ${_n(f[g+5])} l`);else{const[x,p,y,w,v,_]=f.slice(g,g+6);c.push([x,p,y,w,v,_].map(_n).join(" ")+" c")}f.length===6&&c.push(`${_n(f[4])} ${_n(f[5])} l`)}c.push(s?"F":"S");const h=c.join(`
`),u=new fe(i);u.set("FormType",1),u.set("Subtype",_e.get("Form")),u.set("Type",_e.get("XObject")),u.set("BBox",a),u.set("Length",h.length);const d=new Yr(h);return d.dict=u,d},B(ou,U5);class AY extends ga{constructor(e){super(e);const{dict:t,xref:i}=e,s=new $7(t.get("FS"),i);this.data.annotationType=Ws.FILEATTACHMENT,this.data.hasOwnCanvas=this.data.noRotate,this.data.noHTML=!1,this.data.file=s.serializable;const r=t.get("Name");this.data.name=r instanceof _e?Tn(r.name):"PushPin";const a=t.get("ca");this.data.fillAlpha=typeof a=="number"&&a>=0&&a<=1?a:null}}const SY={get r(){return Ze(this,"r",new Uint8Array([7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21]))},get k(){return Ze(this,"k",new Int32Array([-680876936,-389564586,606105819,-1044525330,-176418897,1200080426,-1473231341,-45705983,1770035416,-1958414417,-42063,-1990404162,1804603682,-40341101,-1502002290,1236535329,-165796510,-1069501632,643717713,-373897302,-701558691,38016083,-660478335,-405537848,568446438,-1019803690,-187363961,1163531501,-1444681467,-51403784,1735328473,-1926607734,-378558,-2022574463,1839030562,-35309556,-1530992060,1272893353,-155497632,-1094730640,681279174,-358537222,-722521979,76029189,-640364487,-421815835,530742520,-995338651,-198630844,1126891415,-1416354905,-57434055,1700485571,-1894986606,-1051523,-2054922799,1873313359,-30611744,-1560198380,1309151649,-145523070,-1120210379,718787259,-343485551]))}};function I0(n,e,t){let i=1732584193,s=-271733879,r=-1732584194,a=271733878;const o=t+72&-64,l=new Uint8Array(o);let c,h;for(c=0;c<t;++c)l[c]=n[e++];l[c++]=128;const u=o-8;c<u&&(c=u),l[c++]=t<<3&255,l[c++]=t>>5&255,l[c++]=t>>13&255,l[c++]=t>>21&255,l[c++]=t>>>29&255,c+=3;const d=new Int32Array(16),{k:f,r:g}=SY;for(c=0;c<o;){for(h=0;h<16;++h,c+=4)d[h]=l[c]|l[c+1]<<8|l[c+2]<<16|l[c+3]<<24;let m=i,x=s,p=r,y=a,w,v;for(h=0;h<64;++h){h<16?(w=x&p|~x&y,v=h):h<32?(w=y&x|~y&p,v=5*h+1&15):h<48?(w=x^p^y,v=3*h+5&15):(w=p^(x|~y),v=7*h&15);const _=y,C=m+w+f[h]+d[v]|0,k=g[h];y=p,p=x,x=x+(C<<k|C>>>32-k)|0,m=_}i=i+m|0,s=s+x|0,r=r+p|0,a=a+y|0}return new Uint8Array([i&255,i>>8&255,i>>16&255,i>>>24&255,s&255,s>>8&255,s>>16&255,s>>>24&255,r&255,r>>8&255,r>>16&255,r>>>24&255,a&255,a>>8&255,a>>16&255,a>>>24&255])}function cC(n){try{return Lp(n)}catch(e){return he(`UTF-8 decoding failed: "${e}".`),n}}class IY extends ny{constructor(e){super(e),this.node=null}onEndElement(e){const t=super.onEndElement(e);if(t&&e==="xfa:datasets")throw this.node=t,new Error("Aborting DatasetXMLParser.")}}class EY{constructor(e){if(e.datasets)this.node=new ny({hasAttributes:!0}).parseFromString(e.datasets).documentElement;else{const t=new IY({hasAttributes:!0});try{t.parseFromString(e["xdp:xdp"])}catch{}this.node=t.node}}getValue(e){if(!this.node||!e)return"";const t=this.node.searchNode(QT(e),0);if(!t)return"";const i=t.firstChild;return(i==null?void 0:i.nodeName)==="value"?t.children.map(s=>cC(s.textContent)):cC(t.textContent)}}var Zb,bh,xh,yh,wh,Qb,yg,vh,Pd,Nd,H5,KM;class TY{constructor(e){B(this,H5);B(this,Zb);B(this,bh,1/0);B(this,xh,1/0);B(this,yh,-1/0);B(this,wh,-1/0);B(this,Qb);B(this,yg,[]);B(this,vh,[]);B(this,Pd,-1);B(this,Nd,!1);N(this,Zb,e);const t=N(this,Qb,e.data.quadPoints);for(let i=0,s=t.length;i<s;i+=8)N(this,bh,Math.min(b(this,bh),t[i])),N(this,yh,Math.max(b(this,yh),t[i+2])),N(this,xh,Math.min(b(this,xh),t[i+5])),N(this,wh,Math.max(b(this,wh),t[i+1]))}overlaps(e){return!(b(this,bh)>=b(e,yh)||b(this,yh)<=b(e,bh)||b(this,xh)>=b(e,wh)||b(this,wh)<=b(e,xh))}addGlyph(e,t,i){return L(this,H5,KM).call(this,e,t)?(b(this,vh).length>0&&(b(this,yg).push(b(this,vh).join("")),b(this,vh).length=0),b(this,yg).push(i),N(this,Nd,!0),!0):(this.disableExtraChars(),!1)}addExtraChar(e){b(this,Nd)&&b(this,vh).push(e)}disableExtraChars(){b(this,Nd)&&(N(this,Nd,!1),b(this,vh).length=0)}setText(){b(this,Zb).data.overlaidText=b(this,yg).join("")}}Zb=new WeakMap,bh=new WeakMap,xh=new WeakMap,yh=new WeakMap,wh=new WeakMap,Qb=new WeakMap,yg=new WeakMap,vh=new WeakMap,Pd=new WeakMap,Nd=new WeakMap,H5=new WeakSet,KM=function(e,t){if(b(this,bh)>=e||b(this,yh)<=e||b(this,xh)>=t||b(this,wh)<=t)return!1;const i=b(this,Qb);if(i.length===8)return!0;if(b(this,Pd)>=0){const s=b(this,Pd);if(!(i[s]>=e||i[s+2]<=e||i[s+5]>=t||i[s+1]<=t))return!0;N(this,Pd,-1)}for(let s=0,r=i.length;s<r;s+=8)if(!(i[s]>=e||i[s+2]<=e||i[s+5]>=t||i[s+1]<=t))return N(this,Pd,s),!0;return!1};var Jc;class RY{constructor(e){B(this,Jc,new Map);for(const t of e){if(!t.data.quadPoints)continue;const i=new TY(t);for(const[s,r]of b(this,Jc))s.overlaps(i)&&(r?r.add(i):b(this,Jc).set(s,new Set([i])));b(this,Jc).set(i,null)}}addGlyph(e,t,i,s){const r=e[4]+t/2,a=e[5]+i/2;let o;for(const[l,c]of b(this,Jc)){if(o){o.has(l)?l.addGlyph(r,a,s):l.disableExtraChars();continue}l.addGlyph(r,a,s)&&(o=c)}}addExtraChar(e){for(const t of b(this,Jc).keys())t.addExtraChar(e)}setText(){for(const e of b(this,Jc).keys())e.setText()}}Jc=new WeakMap;class it{constructor(e,t){this.high=e|0,this.low=t|0}and(e){this.high&=e.high,this.low&=e.low}xor(e){this.high^=e.high,this.low^=e.low}shiftRight(e){e>=32?(this.low=this.high>>>e-32|0,this.high=0):(this.low=this.low>>>e|this.high<<32-e,this.high=this.high>>>e|0)}rotateRight(e){let t,i;e&32?(i=this.low,t=this.high):(t=this.low,i=this.high),e&=31,this.low=t>>>e|i<<32-e,this.high=i>>>e|t<<32-e}not(){this.high=~this.high,this.low=~this.low}add(e){const t=(this.low>>>0)+(e.low>>>0);let i=(this.high>>>0)+(e.high>>>0);t>4294967295&&(i+=1),this.low=t|0,this.high=i|0}copyTo(e,t){e[t]=this.high>>>24&255,e[t+1]=this.high>>16&255,e[t+2]=this.high>>8&255,e[t+3]=this.high&255,e[t+4]=this.low>>>24&255,e[t+5]=this.low>>16&255,e[t+6]=this.low>>8&255,e[t+7]=this.low&255}assign(e){this.high=e.high,this.low=e.low}}const MY={get k(){return Ze(this,"k",[new it(1116352408,3609767458),new it(1899447441,602891725),new it(3049323471,3964484399),new it(3921009573,2173295548),new it(961987163,4081628472),new it(1508970993,3053834265),new it(2453635748,2937671579),new it(2870763221,3664609560),new it(3624381080,2734883394),new it(310598401,1164996542),new it(607225278,1323610764),new it(1426881987,3590304994),new it(1925078388,4068182383),new it(2162078206,991336113),new it(2614888103,633803317),new it(3248222580,3479774868),new it(3835390401,2666613458),new it(4022224774,944711139),new it(264347078,2341262773),new it(604807628,2007800933),new it(770255983,1495990901),new it(1249150122,1856431235),new it(1555081692,3175218132),new it(1996064986,2198950837),new it(2554220882,3999719339),new it(2821834349,766784016),new it(2952996808,2566594879),new it(3210313671,3203337956),new it(3336571891,1034457026),new it(3584528711,2466948901),new it(113926993,3758326383),new it(338241895,168717936),new it(666307205,1188179964),new it(773529912,1546045734),new it(1294757372,1522805485),new it(1396182291,2643833823),new it(1695183700,2343527390),new it(1986661051,1014477480),new it(2177026350,1206759142),new it(2456956037,344077627),new it(2730485921,1290863460),new it(2820302411,3158454273),new it(3259730800,3505952657),new it(3345764771,106217008),new it(3516065817,3606008344),new it(3600352804,1432725776),new it(4094571909,1467031594),new it(275423344,851169720),new it(430227734,3100823752),new it(506948616,1363258195),new it(659060556,3750685593),new it(883997877,3785050280),new it(958139571,3318307427),new it(1322822218,3812723403),new it(1537002063,2003034995),new it(1747873779,3602036899),new it(1955562222,1575990012),new it(2024104815,1125592928),new it(2227730452,2716904306),new it(2361852424,442776044),new it(2428436474,593698344),new it(2756734187,3733110249),new it(3204031479,2999351573),new it(3329325298,3815920427),new it(3391569614,3928383900),new it(3515267271,566280711),new it(3940187606,3454069534),new it(4118630271,4000239992),new it(116418474,1914138554),new it(174292421,2731055270),new it(289380356,3203993006),new it(460393269,320620315),new it(685471733,587496836),new it(852142971,1086792851),new it(1017036298,365543100),new it(1126000580,2618297676),new it(1288033470,3409855158),new it(1501505948,4234509866),new it(1607167915,987167468),new it(1816402316,1246189591)])}};function PY(n,e,t,i,s){n.assign(e),n.and(t),s.assign(e),s.not(),s.and(i),n.xor(s)}function NY(n,e,t,i,s){n.assign(e),n.and(t),s.assign(e),s.and(i),n.xor(s),s.assign(t),s.and(i),n.xor(s)}function OY(n,e,t){n.assign(e),n.rotateRight(28),t.assign(e),t.rotateRight(34),n.xor(t),t.assign(e),t.rotateRight(39),n.xor(t)}function DY(n,e,t){n.assign(e),n.rotateRight(14),t.assign(e),t.rotateRight(18),n.xor(t),t.assign(e),t.rotateRight(41),n.xor(t)}function LY(n,e,t){n.assign(e),n.rotateRight(1),t.assign(e),t.rotateRight(8),n.xor(t),t.assign(e),t.shiftRight(7),n.xor(t)}function FY(n,e,t){n.assign(e),n.rotateRight(19),t.assign(e),t.rotateRight(61),n.xor(t),t.assign(e),t.shiftRight(6),n.xor(t)}function XM(n,e,t,i=!1){let s,r,a,o,l,c,h,u;i?(s=new it(3418070365,3238371032),r=new it(1654270250,914150663),a=new it(2438529370,812702999),o=new it(355462360,4144912697),l=new it(1731405415,4290775857),c=new it(2394180231,1750603025),h=new it(3675008525,1694076839),u=new it(1203062813,3204075428)):(s=new it(1779033703,4089235720),r=new it(3144134277,2227873595),a=new it(1013904242,4271175723),o=new it(2773480762,1595750129),l=new it(1359893119,2917565137),c=new it(2600822924,725511199),h=new it(528734635,4215389547),u=new it(1541459225,327033209));const d=Math.ceil((t+17)/128)*128,f=new Uint8Array(d);let g,m;for(g=0;g<t;++g)f[g]=n[e++];f[g++]=128;const x=d-16;g<x&&(g=x),g+=11,f[g++]=t>>>29&255,f[g++]=t>>21&255,f[g++]=t>>13&255,f[g++]=t>>5&255,f[g++]=t<<3&255;const p=new Array(80);for(g=0;g<80;g++)p[g]=new it(0,0);const{k:y}=MY;let w=new it(0,0),v=new it(0,0),_=new it(0,0),C=new it(0,0),k=new it(0,0),I=new it(0,0),S=new it(0,0),R=new it(0,0);const P=new it(0,0),D=new it(0,0),U=new it(0,0),T=new it(0,0);let G;for(g=0;g<d;){for(m=0;m<16;++m)p[m].high=f[g]<<24|f[g+1]<<16|f[g+2]<<8|f[g+3],p[m].low=f[g+4]<<24|f[g+5]<<16|f[g+6]<<8|f[g+7],g+=8;for(m=16;m<80;++m)G=p[m],FY(G,p[m-2],T),G.add(p[m-7]),LY(U,p[m-15],T),G.add(U),G.add(p[m-16]);for(w.assign(s),v.assign(r),_.assign(a),C.assign(o),k.assign(l),I.assign(c),S.assign(h),R.assign(u),m=0;m<80;++m)P.assign(R),DY(U,k,T),P.add(U),PY(U,k,I,S,T),P.add(U),P.add(y[m]),P.add(p[m]),OY(D,w,T),NY(U,w,v,_,T),D.add(U),G=R,R=S,S=I,I=k,C.add(P),k=C,C=_,_=v,v=w,G.assign(P),G.add(D),w=G;s.add(w),r.add(v),a.add(_),o.add(C),l.add(k),c.add(I),h.add(S),u.add(R)}let M;return i?(M=new Uint8Array(48),s.copyTo(M,0),r.copyTo(M,8),a.copyTo(M,16),o.copyTo(M,24),l.copyTo(M,32),c.copyTo(M,40)):(M=new Uint8Array(64),s.copyTo(M,0),r.copyTo(M,8),a.copyTo(M,16),o.copyTo(M,24),l.copyTo(M,32),c.copyTo(M,40),h.copyTo(M,48),u.copyTo(M,56)),M}function BY(n,e,t){return XM(n,e,t,!0)}const UY={get k(){return Ze(this,"k",[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298])}};function $l(n,e){return n>>>e|n<<32-e}function HY(n,e,t){return n&e^~n&t}function zY(n,e,t){return n&e^n&t^e&t}function jY(n){return $l(n,2)^$l(n,13)^$l(n,22)}function GY(n){return $l(n,6)^$l(n,11)^$l(n,25)}function VY(n){return $l(n,7)^$l(n,18)^n>>>3}function qY(n){return $l(n,17)^$l(n,19)^n>>>10}function g6(n,e,t){let i=1779033703,s=3144134277,r=1013904242,a=2773480762,o=1359893119,l=2600822924,c=528734635,h=1541459225;const u=Math.ceil((t+9)/64)*64,d=new Uint8Array(u);let f,g;for(f=0;f<t;++f)d[f]=n[e++];d[f++]=128;const m=u-8;f<m&&(f=m),f+=3,d[f++]=t>>>29&255,d[f++]=t>>21&255,d[f++]=t>>13&255,d[f++]=t>>5&255,d[f++]=t<<3&255;const x=new Uint32Array(64),{k:p}=UY;for(f=0;f<u;){for(g=0;g<16;++g)x[g]=d[f]<<24|d[f+1]<<16|d[f+2]<<8|d[f+3],f+=4;for(g=16;g<64;++g)x[g]=qY(x[g-2])+x[g-7]+VY(x[g-15])+x[g-16]|0;let y=i,w=s,v=r,_=a,C=o,k=l,I=c,S=h,R,P;for(g=0;g<64;++g)R=S+GY(C)+HY(C,k,I)+p[g]+x[g],P=jY(y)+zY(y,w,v),S=I,I=k,k=C,C=_+R|0,_=v,v=w,w=y,y=R+P|0;i=i+y|0,s=s+w|0,r=r+v|0,a=a+_|0,o=o+C|0,l=l+k|0,c=c+I|0,h=h+S|0}return new Uint8Array([i>>24&255,i>>16&255,i>>8&255,i&255,s>>24&255,s>>16&255,s>>8&255,s&255,r>>24&255,r>>16&255,r>>8&255,r&255,a>>24&255,a>>16&255,a>>8&255,a&255,o>>24&255,o>>16&255,o>>8&255,o&255,l>>24&255,l>>16&255,l>>8&255,l&255,c>>24&255,c>>16&255,c>>8&255,c&255,h>>24&255,h>>16&255,h>>8&255,h&255])}const hC=512;class WY extends Jr{constructor(e,t,i){super(t),this.str=e,this.dict=e.dict,this.decrypt=i,this.nextChunk=null,this.initialized=!1}readBlock(){var o;let e;if(this.initialized?e=this.nextChunk:(e=this.str.getBytes(hC),this.initialized=!0),!(e!=null&&e.length)){this.eof=!0;return}this.nextChunk=this.str.getBytes(hC);const t=((o=this.nextChunk)==null?void 0:o.length)>0,i=this.decrypt;e=i(e,!t);const s=this.bufferLength,r=s+e.length;this.ensureBuffer(r).set(e,s),this.bufferLength=r}}class eu{constructor(e){this.a=0,this.b=0;const t=new Uint8Array(256),i=e.length;for(let s=0;s<256;++s)t[s]=s;for(let s=0,r=0;s<256;++s){const a=t[s];r=r+a+e[s%i]&255,t[s]=t[r],t[r]=a}this.s=t}encryptBlock(e){let t=this.a,i=this.b;const s=this.s,r=e.length,a=new Uint8Array(r);for(let o=0;o<r;++o){t=t+1&255;const l=s[t];i=i+l&255;const c=s[i];s[t]=c,s[i]=l,a[o]=e[o]^s[l+c&255]}return this.a=t,this.b=i,a}decryptBlock(e){return this.encryptBlock(e)}encrypt(e){return this.encryptBlock(e)}}class KY{decryptBlock(e){return e}encrypt(e){return e}}class K4{constructor(){ze(this,"_s",new Uint8Array([99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22]));ze(this,"_inv_s",new Uint8Array([82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125]));ze(this,"_mix",new Uint32Array([0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795]));ze(this,"_mixCol",new Uint8Array(256).map((e,t)=>t<128?t<<1:t<<1^27));this.buffer=new Uint8Array(16),this.bufferPosition=0}_expandKey(e){kn("Cannot call `_expandKey` on the base class")}_decrypt(e,t){let i,s,r;const a=new Uint8Array(16);a.set(e);for(let o=0,l=this._keySize;o<16;++o,++l)a[o]^=t[l];for(let o=this._cyclesOfRepetition-1;o>=1;--o){i=a[13],a[13]=a[9],a[9]=a[5],a[5]=a[1],a[1]=i,i=a[14],s=a[10],a[14]=a[6],a[10]=a[2],a[6]=i,a[2]=s,i=a[15],s=a[11],r=a[7],a[15]=a[3],a[11]=i,a[7]=s,a[3]=r;for(let l=0;l<16;++l)a[l]=this._inv_s[a[l]];for(let l=0,c=o*16;l<16;++l,++c)a[l]^=t[c];for(let l=0;l<16;l+=4){const c=this._mix[a[l]],h=this._mix[a[l+1]],u=this._mix[a[l+2]],d=this._mix[a[l+3]];i=c^h>>>8^h<<24^u>>>16^u<<16^d>>>24^d<<8,a[l]=i>>>24&255,a[l+1]=i>>16&255,a[l+2]=i>>8&255,a[l+3]=i&255}}i=a[13],a[13]=a[9],a[9]=a[5],a[5]=a[1],a[1]=i,i=a[14],s=a[10],a[14]=a[6],a[10]=a[2],a[6]=i,a[2]=s,i=a[15],s=a[11],r=a[7],a[15]=a[3],a[11]=i,a[7]=s,a[3]=r;for(let o=0;o<16;++o)a[o]=this._inv_s[a[o]],a[o]^=t[o];return a}_encrypt(e,t){const i=this._s;let s,r,a;const o=new Uint8Array(16);o.set(e);for(let l=0;l<16;++l)o[l]^=t[l];for(let l=1;l<this._cyclesOfRepetition;l++){for(let c=0;c<16;++c)o[c]=i[o[c]];a=o[1],o[1]=o[5],o[5]=o[9],o[9]=o[13],o[13]=a,a=o[2],r=o[6],o[2]=o[10],o[6]=o[14],o[10]=a,o[14]=r,a=o[3],r=o[7],s=o[11],o[3]=o[15],o[7]=a,o[11]=r,o[15]=s;for(let c=0;c<16;c+=4){const h=o[c],u=o[c+1],d=o[c+2],f=o[c+3];s=h^u^d^f,o[c]^=s^this._mixCol[h^u],o[c+1]^=s^this._mixCol[u^d],o[c+2]^=s^this._mixCol[d^f],o[c+3]^=s^this._mixCol[f^h]}for(let c=0,h=l*16;c<16;++c,++h)o[c]^=t[h]}for(let l=0;l<16;++l)o[l]=i[o[l]];a=o[1],o[1]=o[5],o[5]=o[9],o[9]=o[13],o[13]=a,a=o[2],r=o[6],o[2]=o[10],o[6]=o[14],o[10]=a,o[14]=r,a=o[3],r=o[7],s=o[11],o[3]=o[15],o[7]=a,o[11]=r,o[15]=s;for(let l=0,c=this._keySize;l<16;++l,++c)o[l]^=t[c];return o}_decryptBlock2(e,t){const i=e.length;let s=this.buffer,r=this.bufferPosition;const a=[];let o=this.iv;for(let h=0;h<i;++h){if(s[r]=e[h],++r,r<16)continue;const u=this._decrypt(s,this._key);for(let d=0;d<16;++d)u[d]^=o[d];o=s,a.push(u),s=new Uint8Array(16),r=0}if(this.buffer=s,this.bufferLength=r,this.iv=o,a.length===0)return new Uint8Array(0);let l=16*a.length;if(t){const h=a.at(-1);let u=h[15];if(u<=16){for(let d=15,f=16-u;d>=f;--d)if(h[d]!==u){u=0;break}l-=u,a[a.length-1]=h.subarray(0,16-u)}}const c=new Uint8Array(l);for(let h=0,u=0,d=a.length;h<d;++h,u+=16)c.set(a[h],u);return c}decryptBlock(e,t,i=null){const s=e.length,r=this.buffer;let a=this.bufferPosition;if(i)this.iv=i;else{for(let o=0;a<16&&o<s;++o,++a)r[a]=e[o];if(a<16)return this.bufferLength=a,new Uint8Array(0);this.iv=r,e=e.subarray(16)}return this.buffer=new Uint8Array(16),this.bufferLength=0,this.decryptBlock=this._decryptBlock2,this.decryptBlock(e,t)}encrypt(e,t){const i=e.length;let s=this.buffer,r=this.bufferPosition;const a=[];t||(t=new Uint8Array(16));for(let c=0;c<i;++c){if(s[r]=e[c],++r,r<16)continue;for(let u=0;u<16;++u)s[u]^=t[u];const h=this._encrypt(s,this._key);t=h,a.push(h),s=new Uint8Array(16),r=0}if(this.buffer=s,this.bufferLength=r,this.iv=t,a.length===0)return new Uint8Array(0);const o=16*a.length,l=new Uint8Array(o);for(let c=0,h=0,u=a.length;c<u;++c,h+=16)l.set(a[c],h);return l}}class YM extends K4{constructor(t){super();ze(this,"_rcon",new Uint8Array([141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141]));this._cyclesOfRepetition=10,this._keySize=160,this._key=this._expandKey(t)}_expandKey(t){const s=this._s,r=this._rcon,a=new Uint8Array(176);a.set(t);for(let o=16,l=1;o<176;++l){let c=a[o-3],h=a[o-2],u=a[o-1],d=a[o-4];c=s[c],h=s[h],u=s[u],d=s[d],c^=r[l];for(let f=0;f<4;++f)a[o]=c^=a[o-16],o++,a[o]=h^=a[o-16],o++,a[o]=u^=a[o-16],o++,a[o]=d^=a[o-16],o++}return a}}class m6 extends K4{constructor(e){super(),this._cyclesOfRepetition=14,this._keySize=224,this._key=this._expandKey(e)}_expandKey(e){const i=this._s,s=new Uint8Array(240);s.set(e);let r=1,a,o,l,c;for(let h=32,u=1;h<240;++u){h%32===16?(a=i[a],o=i[o],l=i[l],c=i[c]):h%32===0&&(a=s[h-3],o=s[h-2],l=s[h-1],c=s[h-4],a=i[a],o=i[o],l=i[l],c=i[c],a^=r,(r<<=1)>=256&&(r=(r^27)&255));for(let d=0;d<4;++d)s[h]=a^=s[h-32],h++,s[h]=o^=s[h-32],h++,s[h]=l^=s[h-32],h++,s[h]=c^=s[h-32],h++}return s}}class JM{_hash(e,t,i){kn("Abstract method `_hash` called")}checkOwnerPassword(e,t,i,s){const r=new Uint8Array(e.length+56);r.set(e,0),r.set(t,e.length),r.set(i,e.length+t.length);const a=this._hash(e,r,i);return Fp(a,s)}checkUserPassword(e,t,i){const s=new Uint8Array(e.length+8);s.set(e,0),s.set(t,e.length);const r=this._hash(e,s,[]);return Fp(r,i)}getOwnerKey(e,t,i,s){const r=new Uint8Array(e.length+56);r.set(e,0),r.set(t,e.length),r.set(i,e.length+t.length);const a=this._hash(e,r,i);return new m6(a).decryptBlock(s,!1,new Uint8Array(16))}getUserKey(e,t,i){const s=new Uint8Array(e.length+8);s.set(e,0),s.set(t,e.length);const r=this._hash(e,s,[]);return new m6(r).decryptBlock(i,!1,new Uint8Array(16))}}class XY extends JM{_hash(e,t,i){return g6(t,0,t.length)}}class YY extends JM{_hash(e,t,i){let s=g6(t,0,t.length).subarray(0,32),r=[0],a=0;for(;a<64||r.at(-1)>a-32;){const o=e.length+s.length+i.length,l=new Uint8Array(o);let c=0;l.set(e,c),c+=e.length,l.set(s,c),c+=s.length,l.set(i,c);const h=new Uint8Array(o*64);for(let f=0,g=0;f<64;f++,g+=o)h.set(l,g);r=new YM(s.subarray(0,16)).encrypt(h,s.subarray(16,32));const d=Math.sumPrecise(r.slice(0,16))%3;d===0?s=g6(r,0,r.length):d===1?s=BY(r,0,r.length):d===2&&(s=XM(r,0,r.length)),a++}return s.subarray(0,32)}}class uC{constructor(e,t){this.StringCipherConstructor=e,this.StreamCipherConstructor=t}createStream(e,t){const i=new this.StreamCipherConstructor;return new WY(e,t,function(r,a){return i.decryptBlock(r,a)})}decryptString(e){const t=new this.StringCipherConstructor;let i=lr(e);return i=t.decryptBlock(i,!0),ua(i)}encryptString(e){const t=new this.StringCipherConstructor;if(t instanceof K4){const r=16-e.length%16;e+=String.fromCharCode(r).repeat(r);const a=new Uint8Array(16);crypto.getRandomValues(a);let o=lr(e);o=t.encrypt(o,a);const l=new Uint8Array(16+o.length);return l.set(a),l.set(o,16),ua(l)}let i=lr(e);return i=t.encrypt(i),ua(i)}}var Sr,ZM,b6,QM,a3,x6;const Wf=class Wf{constructor(e,t,i){B(this,Sr);const s=e.get("Filter");if(!Oi(s,"Standard"))throw new Ee("unknown encryption method");this.filterName=s.name,this.dict=e;const r=e.get("V");if(!Number.isInteger(r)||r!==1&&r!==2&&r!==4&&r!==5)throw new Ee("unsupported encryption algorithm");this.algorithm=r;let a=e.get("Length");if(!a)if(r<=3)a=40;else{const p=e.get("CF"),y=e.get("StmF");if(p instanceof fe&&y instanceof _e){p.suppressEncryption=!0;const w=p.get(y.name);a=(w==null?void 0:w.get("Length"))||128,a<40&&(a<<=3)}}if(!Number.isInteger(a)||a<40||a%8!==0)throw new Ee("invalid key length");const o=lr(e.get("O")),l=lr(e.get("U")),c=o.subarray(0,32),h=l.subarray(0,32),u=e.get("P"),d=e.get("R"),f=(r===4||r===5)&&e.get("EncryptMetadata")!==!1;this.encryptMetadata=f;const g=lr(t);let m;if(i){if(d===6)try{i=w7(i)}catch{he("CipherTransformFactory: Unable to convert UTF8 encoded password.")}m=lr(i)}let x;if(r!==5)x=L(this,Sr,b6).call(this,g,m,c,h,u,d,a,f);else{const p=o.subarray(32,40),y=o.subarray(40,48),w=l.subarray(0,48),v=l.subarray(32,40),_=l.subarray(40,48),C=lr(e.get("OE")),k=lr(e.get("UE")),I=lr(e.get("Perms"));x=L(this,Sr,ZM).call(this,d,m,c,p,y,w,h,v,_,C,k,I)}if(!x){if(!i)throw new Op("No password given",F_.NEED_PASSWORD);const p=L(this,Sr,QM).call(this,m,c,d,a);x=L(this,Sr,b6).call(this,g,p,c,h,u,d,a,f)}if(!x)throw new Op("Incorrect Password",F_.INCORRECT_PASSWORD);if(r===4&&x.length<16?(this.encryptionKey=new Uint8Array(16),this.encryptionKey.set(x)):this.encryptionKey=x,r>=4){const p=e.get("CF");p instanceof fe&&(p.suppressEncryption=!0),this.cf=p,this.stmf=e.get("StmF")||_e.get("Identity"),this.strf=e.get("StrF")||_e.get("Identity"),this.eff=e.get("EFF")||this.stmf}}static get _defaultPasswordBytes(){return Ze(this,"_defaultPasswordBytes",new Uint8Array([40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122]))}createCipherTransform(e,t){if(this.algorithm===4||this.algorithm===5)return new uC(L(this,Sr,x6).call(this,this.cf,this.strf,e,t,this.encryptionKey),L(this,Sr,x6).call(this,this.cf,this.stmf,e,t,this.encryptionKey));const i=L(this,Sr,a3).call(this,e,t,this.encryptionKey,!1),s=function(){return new eu(i)};return new uC(s,s)}};Sr=new WeakSet,ZM=function(e,t,i,s,r,a,o,l,c,h,u,d){if(t){const g=Math.min(127,t.length);t=t.subarray(0,g)}else t=[];const f=e===6?new YY:new XY;return f.checkUserPassword(t,l,o)?f.getUserKey(t,c,u):t.length&&f.checkOwnerPassword(t,s,a,i)?f.getOwnerKey(t,r,a,h):null},b6=function(e,t,i,s,r,a,o,l){const c=40+i.length+e.length,h=new Uint8Array(c);let u=0,d,f;if(t)for(f=Math.min(32,t.length);u<f;++u)h[u]=t[u];for(d=0;u<32;)h[u++]=Wf._defaultPasswordBytes[d++];h.set(i,u),u+=i.length,h[u++]=r&255,h[u++]=r>>8&255,h[u++]=r>>16&255,h[u++]=r>>>24&255,h.set(e,u),u+=e.length,a>=4&&!l&&(h.fill(255,u,u+4),u+=4);let g=I0(h,0,u);const m=o>>3;if(a>=3)for(d=0;d<50;++d)g=I0(g,0,m);const x=g.subarray(0,m);let p,y;if(a>=3){u=0,h.set(Wf._defaultPasswordBytes,u),u+=32,h.set(e,u),u+=e.length,p=new eu(x),y=p.encryptBlock(I0(h,0,u)),f=x.length;const w=new Uint8Array(f);for(d=1;d<=19;++d){for(let v=0;v<f;++v)w[v]=x[v]^d;p=new eu(w),y=p.encryptBlock(y)}}else p=new eu(x),y=p.encryptBlock(Wf._defaultPasswordBytes);return y.every((w,v)=>s[v]===w)?x:null},QM=function(e,t,i,s){const r=new Uint8Array(32);let a=0;const o=Math.min(32,e.length);for(;a<o;++a)r[a]=e[a];let l=0;for(;a<32;)r[a++]=Wf._defaultPasswordBytes[l++];let c=I0(r,0,a);const h=s>>3;if(i>=3)for(l=0;l<50;++l)c=I0(c,0,c.length);let u,d;if(i>=3){d=t;const f=new Uint8Array(h);for(l=19;l>=0;l--){for(let g=0;g<h;++g)f[g]=c[g]^l;u=new eu(f),d=u.encryptBlock(d)}}else u=new eu(c.subarray(0,h)),d=u.encryptBlock(t);return d},a3=function(e,t,i,s=!1){const r=i.length,a=new Uint8Array(r+9);a.set(i);let o=r;return a[o++]=e&255,a[o++]=e>>8&255,a[o++]=e>>16&255,a[o++]=t&255,a[o++]=t>>8&255,s&&(a[o++]=115,a[o++]=65,a[o++]=108,a[o++]=84),I0(a,0,o).subarray(0,Math.min(r+5,16))},x6=function(e,t,i,s,r){if(!(t instanceof _e))throw new Ee("Invalid crypt filter name.");const a=this,o=e.get(t.name),l=o==null?void 0:o.get("CFM");if(!l||l.name==="None")return function(){return new KY};if(l.name==="V2")return function(){var c;return new eu(L(c=a,Sr,a3).call(c,i,s,r,!1))};if(l.name==="AESV2")return function(){var c;return new YM(L(c=a,Sr,a3).call(c,i,s,r,!0))};if(l.name==="AESV3")return function(){return new m6(r)};throw new Ee("Unknown crypto method")};let p6=Wf;var $b;class JY{constructor(e,t){B(this,$b,null);this.stream=e,this.pdfManager=t,this.entries=[],this._xrefStms=new Set,this._cacheMap=new Map,this._pendingRefs=new Ji,this._newPersistentRefNum=null,this._newTemporaryRefNum=null,this._persistentRefsCache=null}getNewPersistentRef(e){this._newPersistentRefNum===null&&(this._newPersistentRefNum=this.entries.length||1);const t=this._newPersistentRefNum++;return this._cacheMap.set(t,e),st.get(t,0)}getNewTemporaryRef(){if(this._newTemporaryRefNum===null&&(this._newTemporaryRefNum=this.entries.length||1,this._newPersistentRefNum)){this._persistentRefsCache=new Map;for(let e=this._newTemporaryRefNum;e<this._newPersistentRefNum;e++)this._persistentRefsCache.set(e,this._cacheMap.get(e)),this._cacheMap.delete(e)}return st.get(this._newTemporaryRefNum++,0)}resetNewTemporaryRef(){if(this._newTemporaryRefNum=null,this._persistentRefsCache)for(const[e,t]of this._persistentRefsCache)this._cacheMap.set(e,t);this._persistentRefsCache=null}setStartXRef(e){this.startXRefQueue=[e]}parse(e=!1){let t;e?(he("Indexing all PDF objects"),t=this.indexObjects()):t=this.readXRef(),t.assignXref(this),this.trailer=t;let i;try{i=t.get("Encrypt")}catch(r){if(r instanceof bi)throw r;he(`XRef.parse - Invalid "Encrypt" reference: "${r}".`)}if(i instanceof fe){const r=t.get("ID"),a=r!=null&&r.length?r[0]:"";i.suppressEncryption=!0,this.encrypt=new p6(i,a,this.pdfManager.password)}let s;try{s=t.get("Root")}catch(r){if(r instanceof bi)throw r;he(`XRef.parse - Invalid "Root" reference: "${r}".`)}if(s instanceof fe)try{if(s.get("Pages")instanceof fe){this.root=s;return}}catch(r){if(r instanceof bi)throw r;he(`XRef.parse - Invalid "Pages" reference: "${r}".`)}throw e?new Dp("Invalid Root reference."):new Zf}processXRefTable(e){"tableState"in this||(this.tableState={entryNum:0,streamPos:e.lexer.stream.pos,parserBuf1:e.buf1,parserBuf2:e.buf2});const t=this.readXRefTable(e);if(!Cs(t,"trailer"))throw new Ee("Invalid XRef table: could not find trailer dictionary");let i=e.getObj();if(!(i instanceof fe)&&i.dict&&(i=i.dict),!(i instanceof fe))throw new Ee("Invalid XRef table: could not parse trailer dictionary");return delete this.tableState,i}readXRefTable(e){const t=e.lexer.stream,i=this.tableState;t.pos=i.streamPos,e.buf1=i.parserBuf1,e.buf2=i.parserBuf2;let s;for(;;){if(!("firstEntryNum"in i)||!("entryCount"in i)){if(Cs(s=e.getObj(),"trailer"))break;i.firstEntryNum=s,i.entryCount=e.getObj()}let r=i.firstEntryNum;const a=i.entryCount;if(!Number.isInteger(r)||!Number.isInteger(a))throw new Ee("Invalid XRef table: wrong types in subsection header");for(let o=i.entryNum;o<a;o++){i.streamPos=t.pos,i.entryNum=o,i.parserBuf1=e.buf1,i.parserBuf2=e.buf2;const l={};l.offset=e.getObj(),l.gen=e.getObj();const c=e.getObj();if(c instanceof is)switch(c.cmd){case"f":l.free=!0;break;case"n":l.uncompressed=!0;break}if(!Number.isInteger(l.offset)||!Number.isInteger(l.gen)||!(l.free||l.uncompressed))throw new Ee(`Invalid entry in XRef subsection: ${r}, ${a}`);o===0&&l.free&&r===1&&(r=0),this.entries[o+r]||(this.entries[o+r]=l)}i.entryNum=0,i.streamPos=t.pos,i.parserBuf1=e.buf1,i.parserBuf2=e.buf2,delete i.firstEntryNum,delete i.entryCount}if(this.entries[0]&&!this.entries[0].free)throw new Ee("Invalid XRef table: unexpected first object");return s}processXRefStream(e){if(!("streamState"in this)){const{dict:t,pos:i}=e,s=t.get("W"),r=t.get("Index")||[0,t.get("Size")];this.streamState={entryRanges:r,byteWidths:s,entryNum:0,streamPos:i}}return this.readXRefStream(e),delete this.streamState,e.dict}readXRefStream(e){const t=this.streamState;e.pos=t.streamPos;const[i,s,r]=t.byteWidths,a=t.entryRanges;for(;a.length>0;){const[o,l]=a;if(!Number.isInteger(o)||!Number.isInteger(l))throw new Ee(`Invalid XRef range fields: ${o}, ${l}`);if(!Number.isInteger(i)||!Number.isInteger(s)||!Number.isInteger(r))throw new Ee(`Invalid XRef entry fields length: ${o}, ${l}`);for(let c=t.entryNum;c<l;++c){t.entryNum=c,t.streamPos=e.pos;let h=0,u=0,d=0;for(let g=0;g<i;++g){const m=e.getByte();if(m===-1)throw new Ee("Invalid XRef byteWidths 'type'.");h=h<<8|m}i===0&&(h=1);for(let g=0;g<s;++g){const m=e.getByte();if(m===-1)throw new Ee("Invalid XRef byteWidths 'offset'.");u=u<<8|m}for(let g=0;g<r;++g){const m=e.getByte();if(m===-1)throw new Ee("Invalid XRef byteWidths 'generation'.");d=d<<8|m}const f={};switch(f.offset=u,f.gen=d,h){case 0:f.free=!0;break;case 1:f.uncompressed=!0;break;case 2:break;default:throw new Ee(`Invalid XRef entry type: ${h}`)}this.entries[o+c]||(this.entries[o+c]=f)}t.entryNum=0,t.streamPos=e.pos,a.splice(0,2)}}indexObjects(){function o(R,P){let D="",U=R[P];for(;U!==10&&U!==13&&U!==60&&!(++P>=R.length);)D+=String.fromCharCode(U),U=R[P];return D}function l(R,P,D){const U=D.length,T=R.length;let G=0;for(;P<T;){let M=0;for(;M<U&&R[P+M]===D[M];)++M;if(M>=U)break;P++,G++}return G}const c=/\b(endobj|\d+\s+\d+\s+obj|xref|trailer\s*<<)\b/g,h=/\b(startxref|\d+\s+\d+\s+obj)\b/g,u=/^(\d+)\s+(\d+)\s+obj\b/,d=new Uint8Array([116,114,97,105,108,101,114]),f=new Uint8Array([115,116,97,114,116,120,114,101,102]),g=new Uint8Array([47,88,82,101,102]);this.entries.length=0,this._cacheMap.clear();const m=this.stream;m.pos=0;const x=m.getBytes(),p=ua(x),y=x.length;let w=m.start;const v=[],_=[];for(;w<y;){let R=x[w];if(R===9||R===10||R===13||R===32){++w;continue}if(R===37){do{if(++w,w>=y)break;R=x[w]}while(R!==10&&R!==13);continue}const P=o(x,w);let D;if(P.startsWith("xref")&&(P.length===4||/\s/.test(P[4])))w+=l(x,w,d),v.push(w),w+=l(x,w,f);else if(D=u.exec(P)){const U=D[1]|0,T=D[2]|0,G=w+P.length;let M,F=!1;if(!this.entries[U])F=!0;else if(this.entries[U].gen===T)try{new A0({lexer:new Wo(m.makeSubStream(G))}).getObj(),F=!0}catch(j){j instanceof C7?he(`indexObjects -- checking object (${P}): "${j}".`):F=!0}F&&(this.entries[U]={offset:w-m.start,gen:T,uncompressed:!0}),c.lastIndex=G;const X=c.exec(p);X?(M=c.lastIndex+1-w,X[1]!=="endobj"&&(he(`indexObjects: Found "${X[1]}" inside of another "obj", caused by missing "endobj" -- trying to recover.`),M-=X[1].length+1)):M=y-w;const z=x.subarray(w,w+M),K=l(z,0,g);K<M&&z[K+5]<64&&(_.push(w-m.start),this._xrefStms.add(w-m.start)),w+=M}else if(P.startsWith("trailer")&&(P.length===7||/\s/.test(P[7]))){v.push(w);const U=w+P.length;let T;h.lastIndex=U;const G=h.exec(p);G?(T=h.lastIndex+1-w,G[1]!=="startxref"&&(he(`indexObjects: Found "${G[1]}" after "trailer", caused by missing "startxref" -- trying to recover.`),T-=G[1].length+1)):T=y-w,w+=T}else w+=P.length+1}for(const R of _)this.startXRefQueue.push(R),this.readXRef(!0);const C=[];let k=!1;for(const R of v){m.pos=R;const P=new A0({lexer:new Wo(m),xref:this,allowStreams:!0,recoveryMode:!0}),D=P.getObj();if(!Cs(D,"trailer"))continue;const U=P.getObj();U instanceof fe&&(C.push(U),U.has("Encrypt")&&(k=!0))}let I,S;for(const R of[...C,"genFallback",...C]){if(R==="genFallback"){if(!S)break;this._generationFallback=!0;continue}let P=!1;try{const D=R.get("Root");if(!(D instanceof fe))continue;const U=D.get("Pages");if(!(U instanceof fe))continue;const T=U.get("Count");Number.isInteger(T)&&(P=!0)}catch(D){S=D;continue}if(P&&(!k||R.has("Encrypt"))&&R.has("ID"))return R;I=R}if(I)return I;if(this.topDict)return this.topDict;if(!C.length)for(const[R,P]of this.entries.entries()){if(!P)continue;const D=st.get(R,P.gen);let U;try{U=this.fetch(D)}catch{continue}if(U instanceof hn&&(U=U.dict),U instanceof fe&&U.has("Root"))return U}throw new Dp("Invalid PDF structure.")}readXRef(e=!1){const t=this.stream,i=new Set;for(;this.startXRefQueue.length;){try{const s=this.startXRefQueue[0];if(i.has(s)){he("readXRef - skipping XRef table since it was already parsed."),this.startXRefQueue.shift();continue}i.add(s),t.pos=s+t.start;const r=new A0({lexer:new Wo(t),xref:this,allowStreams:!0});let a=r.getObj(),o;if(Cs(a,"xref"))o=this.processXRefTable(r),this.topDict||(this.topDict=o),a=o.get("XRefStm"),Number.isInteger(a)&&!this._xrefStms.has(a)&&(this._xrefStms.add(a),this.startXRefQueue.push(a),b(this,$b)??N(this,$b,a));else if(Number.isInteger(a)){if(!Number.isInteger(r.getObj())||!Cs(r.getObj(),"obj")||!((a=r.getObj())instanceof hn))throw new Ee("Invalid XRef stream");if(o=this.processXRefStream(a),this.topDict||(this.topDict=o),!o)throw new Ee("Failed to read XRef stream")}else throw new Ee("Invalid XRef stream header");a=o.get("Prev"),Number.isInteger(a)?this.startXRefQueue.push(a):a instanceof st&&this.startXRefQueue.push(a.num)}catch(s){if(s instanceof bi)throw s;gn("(while reading XRef): "+s)}this.startXRefQueue.shift()}if(this.topDict)return this.topDict;if(!e)throw new Zf}get lastXRefStreamPos(){return b(this,$b)??(this._xrefStms.size>0?Math.max(...this._xrefStms):null)}getEntry(e){const t=this.entries[e];return t&&!t.free&&t.offset?t:null}fetchIfRef(e,t=!1){return e instanceof st?this.fetch(e,t):e}fetch(e,t=!1){if(!(e instanceof st))throw new Error("ref object is not a reference");const i=e.num,s=this._cacheMap.get(i);if(s!==void 0)return s instanceof fe&&!s.objId&&(s.objId=e.toString()),s;let r=this.getEntry(i);if(r===null)return r;if(this._pendingRefs.has(e))return this._pendingRefs.remove(e),he(`Ignoring circular reference: ${e}.`),iU;this._pendingRefs.put(e);try{r=r.uncompressed?this.fetchUncompressed(e,r,t):this.fetchCompressed(e,r,t),this._pendingRefs.remove(e)}catch(a){throw this._pendingRefs.remove(e),a}return r instanceof fe?r.objId=e.toString():r instanceof hn&&(r.dict.objId=e.toString()),r}fetchUncompressed(e,t,i=!1){const s=e.gen;let r=e.num;if(t.gen!==s){const u=`Inconsistent generation in XRef: ${e}`;if(this._generationFallback&&t.gen<s)return he(u),this.fetchUncompressed(st.get(r,t.gen),t,i);throw new kh(u)}const a=this.stream.makeSubStream(t.offset+this.stream.start),o=new A0({lexer:new Wo(a),xref:this,allowStreams:!0}),l=o.getObj(),c=o.getObj(),h=o.getObj();if(l!==r||c!==s||!(h instanceof is))throw new kh(`Bad (uncompressed) XRef entry: ${e}`);if(h.cmd!=="obj"){if(h.cmd.startsWith("obj")&&(r=parseInt(h.cmd.substring(3),10),!Number.isNaN(r)))return r;throw new kh(`Bad (uncompressed) XRef entry: ${e}`)}return t=this.encrypt&&!i?o.getObj(this.encrypt.createCipherTransform(r,s)):o.getObj(),t instanceof hn||this._cacheMap.set(r,t),t}fetchCompressed(e,t,i=!1){const s=t.offset,r=this.fetch(st.get(s,0));if(!(r instanceof hn))throw new Ee("bad ObjStm stream");const a=r.dict.get("First"),o=r.dict.get("N");if(!Number.isInteger(a)||!Number.isInteger(o))throw new Ee("invalid first and n parameters for ObjStm stream");let l=new A0({lexer:new Wo(r),xref:this,allowStreams:!0});const c=new Array(o),h=new Array(o);for(let f=0;f<o;++f){const g=l.getObj();if(!Number.isInteger(g))throw new Ee(`invalid object number in the ObjStm stream: ${g}`);const m=l.getObj();if(!Number.isInteger(m))throw new Ee(`invalid object offset in the ObjStm stream: ${m}`);c[f]=g,h[f]=m}const u=(r.start||0)+a,d=new Array(o);for(let f=0;f<o;++f){const g=f<o-1?h[f+1]-h[f]:void 0;if(g<0)throw new Ee("Invalid offset in the ObjStm stream.");l=new A0({lexer:new Wo(r.makeSubStream(u+h[f],g,r.dict)),xref:this,allowStreams:!0});const m=l.getObj();if(d[f]=m,m instanceof hn)continue;const x=c[f],p=this.entries[x];p&&p.offset===s&&p.gen===f&&this._cacheMap.set(x,m)}if(t=d[t.gen],t===void 0)throw new kh(`Bad (compressed) XRef entry: ${e}`);return t}async fetchIfRefAsync(e,t){return e instanceof st?this.fetchAsync(e,t):e}async fetchAsync(e,t){try{return this.fetch(e,t)}catch(i){if(!(i instanceof bi))throw i;return await this.pdfManager.requestRange(i.begin,i.end),this.fetchAsync(e,t)}}getCatalogObj(){return this.root}}$b=new WeakMap;const ZY=[0,0,612,792];var z5,Fi,Mf,cp,y6,$M,w6,v6;class dC{constructor({pdfManager:e,xref:t,pageIndex:i,pageDict:s,ref:r,globalIdFactory:a,fontCache:o,builtInCMapCache:l,standardFontDataCache:c,globalColorSpaceCache:h,globalImageCache:u,systemFontCache:d,nonBlendModesSet:f,xfaFactory:g}){B(this,Fi);B(this,z5,null);this.pdfManager=e,this.pageIndex=i,this.pageDict=s,this.xref=t,this.ref=r,this.fontCache=o,this.builtInCMapCache=l,this.standardFontDataCache=c,this.globalColorSpaceCache=h,this.globalImageCache=u,this.systemFontCache=d,this.nonBlendModesSet=f,this.evaluatorOptions=e.evaluatorOptions,this.xfaFactory=g;const m={obj:0};this._localIdFactory=class extends a{static createObjId(){return`p${i}_${++m.obj}`}static getPageObjId(){return`p${r.toString()}`}}}get content(){return this.pageDict.getArray("Contents")}get resources(){const e=L(this,Fi,cp).call(this,"Resources");return Ze(this,"resources",e instanceof fe?e:fe.empty)}get mediaBox(){return Ze(this,"mediaBox",L(this,Fi,y6).call(this,"MediaBox")||ZY)}get cropBox(){return Ze(this,"cropBox",L(this,Fi,y6).call(this,"CropBox")||this.mediaBox)}get userUnit(){const e=this.pageDict.get("UserUnit");return Ze(this,"userUnit",typeof e=="number"&&e>0?e:1)}get view(){const{cropBox:e,mediaBox:t}=this;if(e!==t&&!Fp(e,t)){const i=Dn.intersect(e,t);if(i&&i[2]-i[0]>0&&i[3]-i[1]>0)return Ze(this,"view",i);he("Empty /CropBox and /MediaBox intersection.")}return Ze(this,"view",t)}get rotate(){let e=L(this,Fi,cp).call(this,"Rotate")||0;return e%90!==0?e=0:e>=360?e%=360:e<0&&(e=(e%360+360)%360),Ze(this,"rotate",e)}async getContentStream(){const e=await this.pdfManager.ensure(this,"content");return e instanceof hn?e:Array.isArray(e)?new VU(e,L(this,Fi,$M).bind(this)):new N7}get xfaData(){return Ze(this,"xfaData",this.xfaFactory?{bbox:this.xfaFactory.getBoundingBox(this.pageIndex)}:null)}async saveNewAnnotations(e,t,i,s,r){if(this.xfaFactory)throw new Error("XFA: Cannot save new annotations.");const a=L(this,Fi,Mf).call(this,e),o=new la,l=new Ji;await L(this,Fi,w6).call(this,i,o,l);const c=this.pageDict,h=this.annotations.filter(f=>!(f instanceof st&&o.has(f))),u=await M0.saveNewAnnotations(a,t,i,s,r);for(const{ref:f}of u.annotations)f instanceof st&&!l.has(f)&&h.push(f);const d=c.clone();d.set("Annots",h),r.put(this.ref,{data:d});for(const f of o)r.put(f,{data:null})}async save(e,t,i,s){const r=L(this,Fi,Mf).call(this,e),a=await this._parsedAnnotations,o=[];for(const l of a)o.push(l.save(r,t,i,s).catch(function(c){return he(`save - ignoring annotation data during "${t.name}" task: "${c}".`),null}));return Promise.all(o)}async loadResources(e){await(b(this,z5)??N(this,z5,this.pdfManager.ensure(this,"resources"))),await Eg.load(this.resources,e,this.xref)}async getOperatorList({handler:e,sink:t,task:i,intent:s,cacheKey:r,annotationStorage:a=null,modifiedIds:o=null}){const l=this.getContentStream(),c=this.loadResources(_7),h=L(this,Fi,Mf).call(this,e),u=this.xfaFactory?null:eR(a),d=u==null?void 0:u.get(this.pageIndex);let f=Promise.resolve(null),g=null;if(d){const D=this.pdfManager.ensureDoc("annotationGlobals");let U;const T=new Set;for(const{bitmapId:M,bitmap:F}of d)M&&!F&&!T.has(M)&&T.add(M);const{isOffscreenCanvasSupported:G}=this.evaluatorOptions;if(T.size>0){const M=d.slice();for(const[F,X]of a)F.startsWith(qT)&&X.bitmap&&T.has(X.bitmapId)&&M.push(X);U=M0.generateImages(M,this.xref,G)}else U=M0.generateImages(d,this.xref,G);g=new Ji,f=Promise.all([D,L(this,Fi,w6).call(this,d,g,null)]).then(([M])=>M?M0.printNewAnnotations(M,h,i,d,U):null)}const m=Promise.all([l,c]).then(async([D])=>{const U=await L(this,Fi,v6).call(this,D.dict,_7),T=new Ar(s,t);return e.send("StartRenderPage",{transparency:h.hasBlendModes(U,this.nonBlendModesSet),pageIndex:this.pageIndex,cacheKey:r}),await h.getOperatorList({stream:D,task:i,resources:U,operatorList:T}),T});let[x,p,y]=await Promise.all([m,this._parsedAnnotations,f]);if(y){p=p.filter(D=>!(D.ref&&g.has(D.ref)));for(let D=0,U=y.length;D<U;D++){const T=y[D];if(T.refToReplace){const G=p.findIndex(M=>M.ref&&C3(M.ref,T.refToReplace));G>=0&&(p.splice(G,1,T),y.splice(D--,1),U--)}}p=p.concat(y)}if(p.length===0||s&Hr.ANNOTATIONS_DISABLE)return x.flush(!0),{length:x.totalLength};const w=!!(s&Hr.ANNOTATIONS_FORMS),v=!!(s&Hr.IS_EDITING),_=!!(s&Hr.ANY),C=!!(s&Hr.DISPLAY),k=!!(s&Hr.PRINT),I=[];for(const D of p)(_||C&&D.mustBeViewed(a,w)&&D.mustBeViewedWhenEditing(v,o)||k&&D.mustBePrinted(a))&&I.push(D.getOperatorList(h,i,s,a).catch(function(U){return he(`getOperatorList - ignoring annotation data during "${i.name}" task: "${U}".`),{opList:null,separateForm:!1,separateCanvas:!1}}));const S=await Promise.all(I);let R=!1,P=!1;for(const{opList:D,separateForm:U,separateCanvas:T}of S)x.addOpList(D),R||(R=U),P||(P=T);return x.flush(!0,{form:R,canvas:P}),{length:x.totalLength}}async extractTextContent({handler:e,task:t,includeMarkedContent:i,disableNormalization:s,sink:r,intersector:a=null}){const o=this.getContentStream(),l=this.loadResources(k7),c=this.pdfManager.ensureCatalog("lang"),[h,,u]=await Promise.all([o,l,c]),d=await L(this,Fi,v6).call(this,h.dict,k7);return L(this,Fi,Mf).call(this,e).getTextContent({stream:h,task:t,resources:d,includeMarkedContent:i,disableNormalization:s,sink:r,viewBox:this.view,lang:u,intersector:a})}async getStructTree(){const e=await this.pdfManager.ensureCatalog("structTreeRoot");if(!e)return null;await this._parsedAnnotations;try{const t=await this.pdfManager.ensure(this,"_parseStructTree",[e]);return await this.pdfManager.ensure(t,"serializable")}catch(t){return he(`getStructTree: "${t}".`),null}}_parseStructTree(e){const t=new QR(e,this.pageDict);return t.parse(this.ref),t}async getAnnotationsData(e,t,i){const s=await this._parsedAnnotations;if(s.length===0)return s;const r=[],a=[];let o;const l=!!(i&Hr.ANY),c=!!(i&Hr.DISPLAY),h=!!(i&Hr.PRINT),u=[];for(const d of s){const f=l||c&&d.viewable;(f||h&&d.printable)&&r.push(d.data),d.hasTextContent&&f?(o??(o=L(this,Fi,Mf).call(this,e)),a.push(d.extractTextContent(o,t,[-1/0,-1/0,1/0,1/0]).catch(function(g){he(`getAnnotationsData - ignoring textContent during "${t.name}" task: "${g}".`)}))):d.overlaysTextContent&&f&&u.push(d)}if(u.length>0){const d=new RY(u);a.push(this.extractTextContent({handler:e,task:t,includeMarkedContent:!1,disableNormalization:!1,sink:null,viewBox:this.view,lang:null,intersector:d}).then(()=>{d.setText()}))}return await Promise.all(a),r}get annotations(){const e=L(this,Fi,cp).call(this,"Annots");return Ze(this,"annotations",Array.isArray(e)?e:[])}get _parsedAnnotations(){const e=this.pdfManager.ensure(this,"annotations").then(async t=>{if(t.length===0)return t;const[i,s]=await Promise.all([this.pdfManager.ensureDoc("annotationGlobals"),this.pdfManager.ensureDoc("fieldObjects")]);if(!i)return[];const r=s==null?void 0:s.orphanFields,a=[];for(const h of t)a.push(M0.create(this.xref,h,i,this._localIdFactory,!1,r,this.ref).catch(function(u){return he(`_parsedAnnotations: "${u}".`),null}));const o=[];let l,c;for(const h of await Promise.all(a))if(h){if(h instanceof il){(c||(c=[])).push(h);continue}if(h instanceof GM){(l||(l=[])).push(h);continue}o.push(h)}return c&&o.push(...c),l&&o.push(...l),o});return Ze(this,"_parsedAnnotations",e)}get jsActions(){const e=Q5(this.xref,this.pageDict,WB);return Ze(this,"jsActions",e)}}z5=new WeakMap,Fi=new WeakSet,Mf=function(e){return new Sg({xref:this.xref,handler:e,pageIndex:this.pageIndex,idFactory:this._localIdFactory,fontCache:this.fontCache,builtInCMapCache:this.builtInCMapCache,standardFontDataCache:this.standardFontDataCache,globalColorSpaceCache:this.globalColorSpaceCache,globalImageCache:this.globalImageCache,systemFontCache:this.systemFontCache,options:this.evaluatorOptions})},cp=function(e,t=!1){const i=uo({dict:this.pageDict,key:e,getArray:t,stopWhenFound:!1});return Array.isArray(i)?i.length===1||!(i[0]instanceof fe)?i[0]:fe.merge({xref:this.xref,dictArray:i}):i},y6=function(e){if(this.xfaData)return this.xfaData.bbox;const t=p0(L(this,Fi,cp).call(this,e,!0),null);if(t){if(t[2]-t[0]>0&&t[3]-t[1]>0)return t;he(`Empty, or invalid, /${e} entry.`)}return null},$M=function(e,t){if(this.evaluatorOptions.ignoreErrors){he(`getContentStream - ignoring sub-stream (${t}): "${e}".`);return}throw e},w6=async function(e,t,i){const s=[];for(const r of e)if(r.id){const a=st.fromString(r.id);if(!a){he(`A non-linked annotation cannot be modified: ${r.id}`);continue}if(r.deleted){if(t.put(a,a),r.popupRef){const o=st.fromString(r.popupRef);o&&t.put(o,o)}continue}i==null||i.put(a),r.ref=a,s.push(this.xref.fetchAsync(a).then(o=>{o instanceof fe&&(r.oldAnnotation=o.clone())},()=>{he(`Cannot fetch \`oldAnnotation\` for: ${a}.`)})),delete r.id}await Promise.all(s)},v6=async function(e,t){const i=e==null?void 0:e.get("Resources");return i instanceof fe&&i.size?(await Eg.load(i,t,this.xref),fe.merge({xref:this.xref,dictArray:[i,this.resources],mergeSubDicts:!0})):this.resources};const fC=new Uint8Array([37,80,68,70,45]),gC=new Uint8Array([115,116,97,114,116,120,114,101,102]),QY=new Uint8Array([101,110,100,111,98,106]);function Fw(n,e,t=1024,i=!1){const s=e.length,r=n.peekBytes(t),a=r.length-s;if(a<=0)return!1;if(i){const o=s-1;let l=r.length-1;for(;l>=o;){let c=0;for(;c<s&&r[l-c]===e[o-c];)c++;if(c>=s)return n.pos+=l-o,!0;l--}}else{let o=0;for(;o<=a;){let l=0;for(;l<s&&r[o+l]===e[l];)l++;if(l>=s)return n.pos+=o,!0;o++}}return!1}var _h,ex,Er,_6,tP,nP,iP,sP,k6;class eP{constructor(e,t){B(this,Er);B(this,_h,new Map);B(this,ex,null);if(t.length<=0)throw new Dp("The PDF file is empty, i.e. its size is zero bytes.");this.pdfManager=e,this.stream=t,this.xref=new JY(t,e);const i={font:0};this._globalIdFactory=class{static getDocId(){return`g_${e.docId}`}static createFontId(){return`f${++i.font}`}static createObjId(){kn("Abstract method `createObjId` called.")}static getPageObjId(){kn("Abstract method `getPageObjId` called.")}}}parse(e){this.xref.parse(e),this.catalog=new Kp(this.pdfManager,this.xref)}get linearization(){let e=null;try{e=DH.create(this.stream)}catch(t){if(t instanceof bi)throw t;gn(t)}return Ze(this,"linearization",e)}get startXRef(){const e=this.stream;let t=0;if(this.linearization){if(e.reset(),Fw(e,QY)){e.skip(6);let i=e.peekByte();for(;Va(i);)e.pos++,i=e.peekByte();t=e.pos-e.start}}else{const s=gC.length;let r=!1,a=e.end;for(;!r&&a>0;)a-=1024-s,a<0&&(a=0),e.pos=a,r=Fw(e,gC,1024,!0);if(r){e.skip(9);let o;do o=e.getByte();while(Va(o));let l="";for(;o>=32&&o<=57;)l+=String.fromCharCode(o),o=e.getByte();t=parseInt(l,10),isNaN(t)&&(t=0)}}return Ze(this,"startXRef",t)}checkHeader(){const e=this.stream;if(e.reset(),!Fw(e,fC))return;e.moveStart(),e.skip(fC.length);let t="",i;for(;(i=e.getByte())>32&&t.length<7;)t+=String.fromCharCode(i);JT.test(t)?N(this,ex,t):he(`Invalid PDF header version: ${t}`)}parseStartXRef(){this.xref.setStartXRef(this.startXRef)}get numPages(){let e=0;return this.catalog.hasActualNumPages?e=this.catalog.numPages:this.xfaFactory?e=this.xfaFactory.getNumPages():this.linearization?e=this.linearization.numPages:e=this.catalog.numPages,Ze(this,"numPages",e)}get _xfaStreams(){const{acroForm:e}=this.catalog;if(!e)return null;const t=e.get("XFA"),i=new Map(["xdp:xdp","template","datasets","config","connectionSet","localeSet","stylesheet","/xdp:xdp"].map(s=>[s,null]));if(t instanceof hn&&!t.isEmpty)return i.set("xdp:xdp",t),i;if(!Array.isArray(t)||t.length===0)return null;for(let s=0,r=t.length;s<r;s+=2){let a;if(s===0?a="xdp:xdp":s===r-2?a="/xdp:xdp":a=t[s],!i.has(a))continue;const o=this.xref.fetchIfRef(t[s+1]);!(o instanceof hn)||o.isEmpty||i.set(a,o)}return i}get xfaDatasets(){const e=this._xfaStreams;if(!e)return Ze(this,"xfaDatasets",null);for(const t of["datasets","xdp:xdp"]){const i=e.get(t);if(i)try{const s=Lp(i.getString()),r={[t]:s};return Ze(this,"xfaDatasets",new EY(r))}catch{he("XFA - Invalid utf-8 string.");break}}return Ze(this,"xfaDatasets",null)}get xfaData(){const e=this._xfaStreams;if(!e)return null;const t=Object.create(null);for(const[i,s]of e)if(s)try{t[i]=Lp(s.getString())}catch{return he("XFA - Invalid utf-8 string."),null}return t}get xfaFactory(){let e;return this.pdfManager.enableXfa&&this.catalog.needsRendering&&this.formInfo.hasXfa&&!this.formInfo.hasAcroForm&&(e=this.xfaData),Ze(this,"xfaFactory",e?new gx(e):null)}get isPureXfa(){return this.xfaFactory?this.xfaFactory.isValid():!1}get htmlForXfa(){return this.xfaFactory?this.xfaFactory.getPages():null}loadXfaResources(e,t){return Promise.all([L(this,Er,iP).call(this,e,t).catch(()=>{}),L(this,Er,nP).call(this)])}serializeXfaData(e){return this.xfaFactory?this.xfaFactory.serializeData(e):null}get version(){return this.catalog.version||b(this,ex)}get formInfo(){const e={hasFields:!1,hasAcroForm:!1,hasXfa:!1,hasSignatures:!1},{acroForm:t}=this.catalog;if(!t)return Ze(this,"formInfo",e);try{const i=t.get("Fields"),s=Array.isArray(i)&&i.length>0;e.hasFields=s;const r=t.get("XFA");e.hasXfa=Array.isArray(r)&&r.length>0||r instanceof hn&&!r.isEmpty;const o=!!(t.get("SigFlags")&1),l=o&&L(this,Er,_6).call(this,i);e.hasAcroForm=s&&!l,e.hasSignatures=o}catch(i){if(i instanceof bi)throw i;he(`Cannot fetch form information: "${i}".`)}return Ze(this,"formInfo",e)}get documentInfo(){var a;const{catalog:e,formInfo:t,xref:i}=this,s={PDFFormatVersion:this.version,Language:e.lang,EncryptFilterName:((a=i.encrypt)==null?void 0:a.filterName)??null,IsLinearized:!!this.linearization,IsAcroFormPresent:t.hasAcroForm,IsXFAPresent:t.hasXfa,IsCollectionPresent:!!e.collection,IsSignaturesPresent:t.hasSignatures};let r;try{r=i.trailer.get("Info")}catch(o){if(o instanceof bi)throw o;gn("The document information dictionary is invalid.")}if(!(r instanceof fe))return Ze(this,"documentInfo",s);for(const[o,l]of r){switch(o){case"Title":case"Author":case"Subject":case"Keywords":case"Creator":case"Producer":case"CreationDate":case"ModDate":if(typeof l=="string"){s[o]=Tn(l);continue}break;case"Trapped":if(l instanceof _e){s[o]=l;continue}break;default:let c;switch(typeof l){case"string":c=Tn(l);break;case"number":case"boolean":c=l;break;default:l instanceof _e&&(c=l);break}if(c===void 0){he(`Bad value, for custom key "${o}", in Info: ${l}.`);continue}s.Custom??(s.Custom=Object.create(null)),s.Custom[o]=c;continue}he(`Bad value, for key "${o}", in Info: ${l}.`)}return Ze(this,"documentInfo",s)}get fingerprints(){const t="\0".repeat(16);function i(o){return typeof o=="string"&&o.length===16&&o!==t}const s=this.xref.trailer.get("ID");let r,a;return Array.isArray(s)&&i(s[0])?(r=lr(s[0]),s[1]!==s[0]&&i(s[1])&&(a=lr(s[1]))):r=I0(this.stream.getByteRange(0,1024),0,1024),Ze(this,"fingerprints",[H_(r),a?H_(a):null])}getPage(e){const t=b(this,_h).get(e);if(t)return t;const{catalog:i,linearization:s,xfaFactory:r}=this;let a;return r?a=Promise.resolve([fe.empty,null]):(s==null?void 0:s.pageFirst)===e?a=L(this,Er,sP).call(this,e):a=i.getPageDict(e),a=a.then(([o,l])=>new dC({pdfManager:this.pdfManager,xref:this.xref,pageIndex:e,pageDict:o,ref:l,globalIdFactory:this._globalIdFactory,fontCache:i.fontCache,builtInCMapCache:i.builtInCMapCache,standardFontDataCache:i.standardFontDataCache,globalColorSpaceCache:i.globalColorSpaceCache,globalImageCache:i.globalImageCache,systemFontCache:i.systemFontCache,nonBlendModesSet:i.nonBlendModesSet,xfaFactory:r})),b(this,_h).set(e,a),a}async checkFirstPage(e=!1){if(!e)try{await this.getPage(0)}catch(t){if(t instanceof kh)throw b(this,_h).delete(0),await this.cleanup(),new Zf}}async checkLastPage(e=!1){const{catalog:t,pdfManager:i}=this;t.setActualNumPages();let s;try{if(await Promise.all([i.ensureDoc("xfaFactory"),i.ensureDoc("linearization"),i.ensureCatalog("numPages")]),this.xfaFactory)return;if(this.linearization?s=this.linearization.numPages:s=t.numPages,Number.isInteger(s)){if(s<=1)return}else throw new Ee("Page count is not an integer.");await this.getPage(s-1)}catch(r){if(b(this,_h).delete(s-1),await this.cleanup(),r instanceof kh&&!e)throw new Zf;he(`checkLastPage - invalid /Pages tree /Count: ${s}.`);let a;try{a=await t.getAllPageDicts(e)}catch(o){if(o instanceof kh&&!e)throw new Zf;t.setActualNumPages(1);return}for(const[o,[l,c]]of a){let h;l instanceof Error?(h=Promise.reject(l),h.catch(()=>{})):h=Promise.resolve(new dC({pdfManager:i,xref:this.xref,pageIndex:o,pageDict:l,ref:c,globalIdFactory:this._globalIdFactory,fontCache:t.fontCache,builtInCMapCache:t.builtInCMapCache,standardFontDataCache:t.standardFontDataCache,globalColorSpaceCache:this.globalColorSpaceCache,globalImageCache:t.globalImageCache,systemFontCache:t.systemFontCache,nonBlendModesSet:t.nonBlendModesSet,xfaFactory:null})),b(this,_h).set(o,h)}t.setActualNumPages(a.size)}}async fontFallback(e,t){const{catalog:i,pdfManager:s}=this;for(const r of await Promise.all(i.fontCache))if(r.loadedName===e){r.fallback(t,s.evaluatorOptions);return}}async cleanup(e=!1){return this.catalog?this.catalog.cleanup(e):M4()}get fieldObjects(){const e=this.pdfManager.ensureDoc("formInfo").then(async t=>{if(!t.hasFields)return null;const i=await this.annotationGlobals;if(!i)return null;const{acroForm:s}=i,r=new Ji,a=Object.create(null),o=new Map,l=new la;for(const h of s.get("Fields"))await L(this,Er,k6).call(this,"",null,h,o,i,r,l);const c=[];for(const[h,u]of o)c.push(Promise.all(u).then(d=>{d=d.filter(f=>!!f),d.length>0&&(a[h]=d)}));return await Promise.all(c),{allFields:f4(a)>0?a:null,orphanFields:l}});return Ze(this,"fieldObjects",e)}get hasJSActions(){const e=this.pdfManager.ensureDoc("_parseHasJSActions");return Ze(this,"hasJSActions",e)}async _parseHasJSActions(){const[e,t]=await Promise.all([this.pdfManager.ensureCatalog("jsActions"),this.pdfManager.ensureDoc("fieldObjects")]);return e?!0:t!=null&&t.allFields?Object.values(t.allFields).some(i=>i.some(s=>s.actions!==null)):!1}get calculationOrderIds(){var i;const e=(i=this.catalog.acroForm)==null?void 0:i.get("CO");if(!Array.isArray(e)||e.length===0)return Ze(this,"calculationOrderIds",null);const t=[];for(const s of e)s instanceof st&&t.push(s.toString());return Ze(this,"calculationOrderIds",t.length?t:null)}get annotationGlobals(){return Ze(this,"annotationGlobals",M0.createGlobals(this.pdfManager))}}_h=new WeakMap,ex=new WeakMap,Er=new WeakSet,_6=function(e,t=0){return Array.isArray(e)?e.every(s=>{if(s=this.xref.fetchIfRef(s),!(s instanceof fe))return!1;if(s.has("Kids"))return++t>10?(he("#hasOnlyDocumentSignatures: maximum recursion depth reached"),!1):L(this,Er,_6).call(this,s.get("Kids"),t);const r=Oi(s.get("FT"),"Sig"),a=s.get("Rect"),o=Array.isArray(a)&&a.every(l=>l===0);return r&&o}):!1},tP=function(e,t,i=new Ji){if(Array.isArray(e))for(let s of e){if(s instanceof st){if(i.has(s))continue;i.put(s)}if(s=this.xref.fetchIfRef(s),!(s instanceof fe))continue;if(s.has("Kids")){L(this,Er,tP).call(this,s.get("Kids"),t,i);continue}if(!Oi(s.get("FT"),"Sig"))continue;const a=s.get("V");if(!(a instanceof fe))continue;const o=a.get("SubFilter");o instanceof _e&&t.add(o.name)}},nP=async function(){const e=await this.pdfManager.ensureCatalog("xfaImages");e&&this.xfaFactory.setImages(e)},iP=async function(e,t){const i=await this.pdfManager.ensureCatalog("acroForm");if(!i)return;const s=await i.getAsync("DR");if(!(s instanceof fe))return;await Eg.load(s,["Font"],this.xref);const r=s.get("Font");if(!(r instanceof fe))return;const a=Object.assign(Object.create(null),this.pdfManager.evaluatorOptions,{useSystemFonts:!1}),{builtInCMapCache:o,fontCache:l,standardFontDataCache:c}=this.catalog,h=new Sg({xref:this.xref,handler:e,pageIndex:-1,idFactory:this._globalIdFactory,fontCache:l,builtInCMapCache:o,standardFontDataCache:c,options:a}),u=new Ar,d=[],f={get font(){return d.at(-1)},set font(y){d.push(y)},clone(){return this}},g=(y,w,v)=>h.handleSetFont(s,[_e.get(y),1],null,u,t,f,w,v).catch(_=>(he(`loadXfaFonts: "${_}".`),null)),m=[];for(const[y,w]of r){const v=w.get("FontDescriptor");if(!(v instanceof fe))continue;let _=v.get("FontFamily");_=_.replaceAll(/[ ]+(\d)/g,"$1");const C=v.get("FontWeight"),k=-v.get("ItalicAngle"),I={fontFamily:_,fontWeight:C,italicAngle:k};uU(I)&&m.push(g(y,null,I))}await Promise.all(m);const x=this.xfaFactory.setFonts(d);if(!x)return;a.ignoreErrors=!0,m.length=0,d.length=0;const p=new Set;for(const y of x)E4(`${y}-Regular`)||p.add(y);p.size&&x.push("PdfJS-Fallback");for(const y of x)if(!p.has(y))for(const w of[{name:"Regular",fontWeight:400,italicAngle:0},{name:"Bold",fontWeight:700,italicAngle:0},{name:"Italic",fontWeight:400,italicAngle:12},{name:"BoldItalic",fontWeight:700,italicAngle:12}]){const v=`${y}-${w.name}`;m.push(g(v,BR(v),{fontFamily:y,fontWeight:w.fontWeight,italicAngle:w.italicAngle}))}await Promise.all(m),this.xfaFactory.appendFonts(d,p)},sP=async function(e){const{catalog:t,linearization:i,xref:s}=this,r=st.get(i.objectNumberFirst,0);try{const a=await s.fetchAsync(r);if(a instanceof fe){let o=a.getRaw("Type");if(o instanceof st&&(o=await s.fetchAsync(o)),Oi(o,"Page")||!a.has("Type")&&!a.has("Kids")&&a.has("Contents"))return t.pageKidsCountCache.has(r)||t.pageKidsCountCache.put(r,1),t.pageIndexCache.has(r)||t.pageIndexCache.put(r,0),[a,r]}throw new Ee("The Linearization dictionary doesn't point to a valid Page dictionary.")}catch(a){return he(`_getLinearizationPage: "${a.message}".`),t.getPageDict(e)}},k6=async function(e,t,i,s,r,a,o){const{xref:l}=this;if(!(i instanceof st)||a.has(i))return;a.put(i);const c=await l.fetchAsync(i);if(!(c instanceof fe))return;let h=await c.getAsync("Subtype");switch(h=h instanceof _e?h.name:null,h){case"Link":return}if(c.has("T")){const d=Tn(await c.getAsync("T"));e=e===""?d:`${e}.${d}`}else{let d=c;for(;;){if(d=d.getRaw("Parent")||t,d instanceof st){if(a.has(d))break;d=await l.fetchAsync(d)}if(!(d instanceof fe))break;if(d.has("T")){const f=Tn(await d.getAsync("T"));e=e===""?f:`${e}.${f}`;break}}}if(t&&!c.has("Parent")&&Oi(c.get("Subtype"),"Widget")&&o.put(i,t),s.has(e)||s.set(e,[]),s.get(e).push(M0.create(l,i,r,null,!0,o,null).then(d=>d==null?void 0:d.getFieldObject()).catch(function(d){return he(`#collectFieldObjects: "${d}".`),null})),!c.has("Kids"))return;const u=await c.getAsync("Kids");if(Array.isArray(u))for(const d of u)await L(this,Er,k6).call(this,e,i,d,s,r,a,o)};function $Y(n){if(n){const e=k3(n);if(e)return e.href;he(`Invalid absolute docBaseUrl: "${n}".`)}return null}class rP{constructor({docBaseUrl:e,docId:t,enableXfa:i,evaluatorOptions:s,handler:r,password:a}){this._docBaseUrl=$Y(e),this._docId=t,this._password=a,this.enableXfa=i,s.isOffscreenCanvasSupported&&(s.isOffscreenCanvasSupported=da.isOffscreenCanvasSupported),s.isImageDecoderSupported&&(s.isImageDecoderSupported=da.isImageDecoderSupported),this.evaluatorOptions=Object.freeze(s),Ro.setOptions(s),Cg.setOptions(s),Ar.setOptions(s);const o={...s,handler:r};Go.setOptions(o),qd.setOptions(o),Bp.setOptions(o)}get docId(){return this._docId}get password(){return this._password}get docBaseUrl(){return this._docBaseUrl}ensureDoc(e,t){return this.ensure(this.pdfDocument,e,t)}ensureXRef(e,t){return this.ensure(this.pdfDocument.xref,e,t)}ensureCatalog(e,t){return this.ensure(this.pdfDocument.catalog,e,t)}getPage(e){return this.pdfDocument.getPage(e)}fontFallback(e,t){return this.pdfDocument.fontFallback(e,t)}cleanup(e=!1){return this.pdfDocument.cleanup(e)}async ensure(e,t,i){kn("Abstract method `ensure` called")}requestRange(e,t){kn("Abstract method `requestRange` called")}requestLoadedStream(e=!1){kn("Abstract method `requestLoadedStream` called")}sendProgressiveData(e){kn("Abstract method `sendProgressiveData` called")}updatePassword(e){this._password=e}terminate(e){kn("Abstract method `terminate` called")}}class mC extends rP{constructor(e){super(e);const t=new Ui(e.source);this.pdfDocument=new eP(this,t),this._loadedStreamPromise=Promise.resolve(t)}async ensure(e,t,i){const s=e[t];return typeof s=="function"?s.apply(e,i):s}requestRange(e,t){return Promise.resolve()}requestLoadedStream(e=!1){return this._loadedStreamPromise}terminate(e){}}class eJ extends rP{constructor(e){super(e),this.streamManager=new UU(e.source,{msgHandler:e.handler,length:e.length,disableAutoFetch:e.disableAutoFetch,rangeChunkSize:e.rangeChunkSize}),this.pdfDocument=new eP(this,this.streamManager.getStream())}async ensure(e,t,i){try{const s=e[t];return typeof s=="function"?s.apply(e,i):s}catch(s){if(!(s instanceof bi))throw s;return await this.requestRange(s.begin,s.end),this.ensure(e,t,i)}}requestRange(e,t){return this.streamManager.requestRange(e,t)}requestLoadedStream(e=!1){return this.streamManager.requestAllChunks(e)}sendProgressiveData(e){this.streamManager.onReceiveData({chunk:e})}terminate(e){this.streamManager.abort(e)}}const i9={DATA:1,ERROR:2},cs={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function pC(){}function pa(n){if(n instanceof sr||n instanceof Dp||n instanceof Op||n instanceof B_||n instanceof uw)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||kn('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new sr(n.message);case"InvalidPDFException":return new Dp(n.message);case"PasswordException":return new Op(n.message,n.code);case"ResponseException":return new B_(n.message,n.status,n.missing);case"UnknownErrorException":return new uw(n.message,n.details)}return new uw(n.message,n.toString())}var wg,bo,aP,oP,lP,o3;class bC{constructor(e,t,i){B(this,bo);B(this,wg,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",L(this,bo,aP).bind(this),{signal:b(this,wg).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},i)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,i,s){const r=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:c,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:c.desiredSize},s),h.promise},pull:c=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:cs.PULL,streamId:r,desiredSize:c.desiredSize}),h.promise},cancel:c=>{Bs(c instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:cs.CANCEL,streamId:r,reason:pa(c)}),h.promise}},i)}destroy(){var e;(e=b(this,wg))==null||e.abort(),N(this,wg,null)}}wg=new WeakMap,bo=new WeakSet,aP=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){L(this,bo,lP).call(this,e);return}if(e.callback){const i=e.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===i9.DATA)s.resolve(e.data);else if(e.callback===i9.ERROR)s.reject(pa(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,s=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:i,targetName:s,callback:i9.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:i,targetName:s,callback:i9.ERROR,callbackId:e.callbackId,reason:pa(a)})});return}if(e.streamId){L(this,bo,oP).call(this,e);return}t(e.data)},oP=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(c,h=1,u){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=h,d>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:cs.ENQUEUE,streamId:t,chunk:c},u)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:cs.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){Bs(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:cs.ERROR,streamId:t,reason:pa(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:cs.START_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:cs.START_COMPLETE,streamId:t,reason:pa(c)})})},lP=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case cs.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(pa(e.reason));break;case cs.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(pa(e.reason));break;case cs.PULL:if(!o){r.postMessage({sourceName:i,targetName:s,stream:cs.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||pC).then(function(){r.postMessage({sourceName:i,targetName:s,stream:cs.PULL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:cs.PULL_COMPLETE,streamId:t,reason:pa(c)})});break;case cs.ENQUEUE:if(Bs(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case cs.CLOSE:if(Bs(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),L(this,bo,o3).call(this,a,t);break;case cs.ERROR:Bs(a,"error should have stream controller"),a.controller.error(pa(e.reason)),L(this,bo,o3).call(this,a,t);break;case cs.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(pa(e.reason)),L(this,bo,o3).call(this,a,t);break;case cs.CANCEL:if(!o)break;const l=pa(e.reason);Promise.try(o.onCancel||pC,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:cs.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:cs.CANCEL_COMPLETE,streamId:t,reason:pa(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},o3=async function(e,t){var i,s,r;await Promise.allSettled([(i=e.startCall)==null?void 0:i.promise,(s=e.pullCall)==null?void 0:s.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};async function cP(n,e,t,{encrypt:i=null}){const s=i==null?void 0:i.createCipherTransform(n.num,n.gen);t.push(`${n.num} ${n.gen} obj
`),e instanceof fe?await fy(e,t,s):e instanceof hn?await hP(e,t,s):(Array.isArray(e)||ArrayBuffer.isView(e))&&await uP(e,t,s),t.push(`
endobj
`)}async function fy(n,e,t){e.push("<<");for(const i of n.getKeys())e.push(` /${m4(i)} `),await dP(n.getRaw(i),e,t);e.push(">>")}async function hP(n,e,t){let i=n.getBytes();const{dict:s}=n,[r,a]=await Promise.all([s.getAsync("Filter"),s.getAsync("DecodeParms")]),o=Array.isArray(r)?await s.xref.fetchIfRefAsync(r[0]):r,l=Oi(o,"FlateDecode");if(i.length>=256||l)try{const u=new CompressionStream("deflate"),d=u.writable.getWriter();await d.ready,d.write(i).then(async()=>{await d.ready,await d.close()}).catch(()=>{});const f=await new Response(u.readable).arrayBuffer();i=new Uint8Array(f);let g,m;r?l||(g=Array.isArray(r)?[_e.get("FlateDecode"),...r]:[_e.get("FlateDecode"),r],a&&(m=Array.isArray(a)?[null,...a]:[null,a])):g=_e.get("FlateDecode"),g&&s.set("Filter",g),m&&s.set("DecodeParms",m)}catch(u){gn(`writeStream - cannot compress data: "${u}".`)}let h=ua(i);t&&(h=t.encryptString(h)),s.set("Length",h.length),await fy(s,e,t),e.push(` stream
`,h,`
endstream`)}async function uP(n,e,t){e.push("[");let i=!0;for(const s of n)i?i=!1:e.push(" "),await dP(s,e,t);e.push("]")}async function dP(n,e,t){n instanceof _e?e.push(`/${m4(n.name)}`):n instanceof st?e.push(`${n.num} ${n.gen} R`):Array.isArray(n)||ArrayBuffer.isView(n)?await uP(n,e,t):typeof n=="string"?(t&&(n=t.encryptString(n)),e.push(`(${kg(n)})`)):typeof n=="number"?e.push(_n(n)):typeof n=="boolean"?e.push(n.toString()):n instanceof fe?await fy(n,e,t):n instanceof hn?await hP(n,e,t):n===null?e.push("null"):he(`Unhandled value in writer: ${typeof n}, please file a bug.`)}function Bw(n,e,t,i){for(let s=e+t-1;s>t-1;s--)i[s]=n&255,n>>=8;return t+e}function fP(n,e,t){const i=n.length;for(let s=0;s<i;s++)t[e+s]=n.charCodeAt(s)&255;return e+i}function tJ(n,e){const t=Math.floor(Date.now()/1e3),i=e.filename||"",s=[t.toString(),i,n.toString(),...e.infoMap.values()],r=Math.sumPrecise(s.map(l=>l.length)),a=new Uint8Array(r);let o=0;for(const l of s)o=fP(l,o,a);return ua(I0(a,0,a.length))}function nJ(n,e){const t=new ny({hasAttributes:!0}).parseFromString(n);for(const{xfa:s}of e){if(!s)continue;const{path:r,value:a}=s;if(!r)continue;const o=QT(r);let l=t.documentElement.searchNode(o,0);!l&&o.length>1&&(l=t.documentElement.searchNode([o.at(-1)],0)),l?l.childNodes=Array.isArray(a)?a.map(c=>new pp("value",c)):[new pp("#text",a)]:he(`Node not found for path: ${r}`)}const i=[];return t.documentElement.dump(i),i.join("")}async function iJ({xref:n,acroForm:e,acroFormRef:t,hasXfa:i,hasXfaDatasetsEntry:s,xfaDatasetsRef:r,needAppearances:a,changes:o}){if(i&&!s&&!r&&he("XFA - Cannot save it"),!a&&(!i||!r||s))return;const l=e.clone();if(i&&!s){const c=e.get("XFA").slice();c.splice(2,0,"datasets"),c.splice(3,0,r),l.set("XFA",c)}a&&l.set("NeedAppearances",!0),o.put(t,{data:l})}function sJ({xfaData:n,xfaDatasetsRef:e,changes:t,xref:i}){if(n===null){const r=i.fetchIfRef(e);n=nJ(r.getString(),t)}const s=new Yr(n);s.dict=new fe(i),s.dict.set("Type",_e.get("EmbeddedFile")),t.put(e,{data:s})}async function rJ(n,e,t,i,s){s.push(`xref
`);const r=gP(t);let a=0;for(const{ref:o,data:l}of t)o.num===r[a]&&(s.push(`${r[a]} ${r[a+1]}
`),a+=2),l!==null?(s.push(`${e.toString().padStart(10,"0")} ${Math.min(o.gen,65535).toString().padStart(5,"0")} n\r
`),e+=l.length):s.push(`0000000000 ${Math.min(o.gen+1,65535).toString().padStart(5,"0")} f\r
`);mP(e,n,i),s.push(`trailer
`),await fy(i,s),s.push(`
startxref
`,e.toString(),`
%%EOF
`)}function gP(n){const e=[];for(const{ref:t}of n)t.num===e.at(-2)+e.at(-1)?e[e.length-1]+=1:e.push(t.num,1);return e}async function aJ(n,e,t,i,s){const r=[];let a=0,o=0;for(const{ref:m,data:x}of t){let p;a=Math.max(a,e),x!==null?(p=Math.min(m.gen,65535),r.push([1,e,p]),e+=x.length):(p=Math.min(m.gen+1,65535),r.push([0,0,p])),o=Math.max(o,p)}i.set("Index",gP(t));const l=z_(a),c=z_(o),h=[1,l,c];i.set("W",h),mP(e,n,i);const u=Math.sumPrecise(h),d=new Uint8Array(u*r.length),f=new Ui(d);f.dict=i;let g=0;for(const[m,x,p]of r)g=Bw(m,h[0],g,d),g=Bw(x,h[1],g,d),g=Bw(p,h[2],g,d);await cP(n.newRef,f,s,{}),s.push(`startxref
`,e.toString(),`
%%EOF
`)}function mP(n,e,t){if(Array.isArray(e.fileIds)&&e.fileIds.length>0){const i=tJ(n,e);t.set("ID",[e.fileIds[0],i])}}function oJ(n,e,t){const i=new fe(null);i.set("Prev",n.startXRef);const s=n.newRef;return t?(e.put(s,{data:""}),i.set("Size",s.num+1),i.set("Type",_e.get("XRef"))):i.set("Size",s.num),n.rootRef!==null&&i.set("Root",n.rootRef),n.infoRef!==null&&i.set("Info",n.infoRef),n.encryptRef!==null&&i.set("Encrypt",n.encryptRef),i}async function lJ(n,e,t=[]){const i=[];for(const[s,{data:r}]of n.items()){if(r===null||typeof r=="string"){i.push({ref:s,data:r});continue}await cP(s,r,t,e),i.push({ref:s,data:t.join("")}),t.length=0}return i.sort((s,r)=>s.ref.num-r.ref.num)}async function cJ({originalData:n,xrefInfo:e,changes:t,xref:i=null,hasXfa:s=!1,xfaDatasetsRef:r=null,hasXfaDatasetsEntry:a=!1,needAppearances:o,acroFormRef:l=null,acroForm:c=null,xfaData:h=null,useXrefStream:u=!1}){await iJ({xref:i,acroForm:c,acroFormRef:l,hasXfa:s,hasXfaDatasetsEntry:a,xfaDatasetsRef:r,needAppearances:o,changes:t}),s&&sJ({xfaData:h,xfaDatasetsRef:r,changes:t,xref:i});const d=oJ(e,t,u),f=[],g=await lJ(t,i,f);let m=n.length;const x=n.at(-1);x!==10&&x!==13&&(f.push(`
`),m+=1);for(const{data:v}of g)v!==null&&f.push(v);await(u?aJ(e,m,g,d,f):rJ(e,m,g,d,f));const p=n.length+Math.sumPrecise(f.map(v=>v.length)),y=new Uint8Array(p);y.set(n);let w=n.length;for(const v of f)w=fP(v,w,y);return y}class hJ{constructor(e){this._msgHandler=e,this._contentLength=null,this._fullRequestReader=null,this._rangeRequestReaders=[]}getFullReader(){return Bs(!this._fullRequestReader,"PDFWorkerStream.getFullReader can only be called once."),this._fullRequestReader=new uJ(this._msgHandler),this._fullRequestReader}getRangeReader(e,t){const i=new dJ(e,t,this._msgHandler);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class uJ{constructor(e){this._msgHandler=e,this.onProgress=null,this._contentLength=null,this._isRangeSupported=!1,this._isStreamingSupported=!1;const t=this._msgHandler.sendWithStream("GetReader");this._reader=t.getReader(),this._headersReady=this._msgHandler.sendWithPromise("ReaderHeadersReady").then(i=>{this._isStreamingSupported=i.isStreamingSupported,this._isRangeSupported=i.isRangeSupported,this._contentLength=i.contentLength})}get headersReady(){return this._headersReady}get contentLength(){return this._contentLength}get isStreamingSupported(){return this._isStreamingSupported}get isRangeSupported(){return this._isRangeSupported}async read(){const{value:e,done:t}=await this._reader.read();return t?{value:void 0,done:!0}:{value:e.buffer,done:!1}}cancel(e){this._reader.cancel(e)}}class dJ{constructor(e,t,i){this._msgHandler=i,this.onProgress=null;const s=this._msgHandler.sendWithStream("GetRangeReader",{begin:e,end:t});this._reader=s.getReader()}get isStreamingSupported(){return!1}async read(){const{value:e,done:t}=await this._reader.read();return t?{value:void 0,done:!0}:{value:e.buffer,done:!1}}cancel(e){this._reader.cancel(e)}}class tu{constructor(e){this.name=e,this.terminated=!1,this._capability=Promise.withResolvers()}get finished(){return this._capability.promise}finish(){this._capability.resolve()}terminate(){this.terminated=!0}ensureNotTerminated(){if(this.terminated)throw new Error("Worker task was terminated")}}const qv=class qv{static setup(e,t){let i=!1;e.on("test",s=>{i||(i=!0,e.send("test",s instanceof Uint8Array))}),e.on("configure",s=>{KB(s.verbosity)}),e.on("GetDocRequest",s=>this.createDocumentHandler(s,t))}static createDocumentHandler(e,t){let i,s=!1,r=null;const a=new Set,o=XB(),{docId:l,apiVersion:c}=e,h="5.3.93";if(c!==h)throw new Error(`The API version "${c}" does not match the Worker version "${h}".`);const u=(v,_)=>`The \`${v}.prototype\` contains unexpected enumerable property "${_}", thus breaking e.g. \`for...in\` iteration of ${v}s.`;for(const v in{})throw new Error(u("Object",v));for(const v in[])throw new Error(u("Array",v));const d=l+"_worker";let f=new bC(d,l,t);function g(){if(s)throw new Error("Worker was terminated")}function m(v){a.add(v)}function x(v){v.finish(),a.delete(v)}async function p(v){await i.ensureDoc("checkHeader"),await i.ensureDoc("parseStartXRef"),await i.ensureDoc("parse",[v]),await i.ensureDoc("checkFirstPage",[v]),await i.ensureDoc("checkLastPage",[v]);const _=await i.ensureDoc("isPureXfa");if(_){const S=new tu("loadXfaResources");m(S),await i.ensureDoc("loadXfaResources",[f,S]),x(S)}const[C,k]=await Promise.all([i.ensureDoc("numPages"),i.ensureDoc("fingerprints")]),I=_?await i.ensureDoc("htmlForXfa"):null;return{numPages:C,fingerprints:k,htmlForXfa:I}}async function y({data:v,password:_,disableAutoFetch:C,rangeChunkSize:k,length:I,docBaseUrl:S,enableXfa:R,evaluatorOptions:P}){const D={source:null,disableAutoFetch:C,docBaseUrl:S,docId:l,enableXfa:R,evaluatorOptions:P,handler:f,length:I,password:_,rangeChunkSize:k};if(v)return D.source=v,new mC(D);const U=new hJ(f),T=U.getFullReader(),G=Promise.withResolvers();let M,F=[],X=0;return T.headersReady.then(function(){if(T.isRangeSupported){D.source=U,D.length=T.contentLength,D.disableAutoFetch||(D.disableAutoFetch=T.isStreamingSupported),M=new eJ(D);for(const z of F)M.sendProgressiveData(z);F=[],G.resolve(M),r=null}}).catch(function(z){G.reject(z),r=null}),new Promise(function(z,K){const j=function({value:ae,done:ge}){try{if(g(),ge){if(!M){const ue=ZT(F);F=[],I&&ue.length!==I&&he("reported HTTP length is different from actual"),D.source=ue,M=new mC(D),G.resolve(M)}r=null;return}X+=ae.byteLength,T.isStreamingSupported||f.send("DocProgress",{loaded:X,total:Math.max(X,T.contentLength||0)}),M?M.sendProgressiveData(ae):F.push(ae),T.read().then(j,K)}catch(ue){K(ue)}};T.read().then(j,K)}).catch(function(z){G.reject(z),r=null}),r=z=>{U.cancelAllRequests(z)},G.promise}function w(v){function _(I){g(),f.send("GetDoc",{pdfInfo:I})}function C(I){if(g(),I instanceof Op){const S=new tu(`PasswordException: response ${I.code}`);m(S),f.sendWithPromise("PasswordRequest",I).then(function({password:R}){x(S),i.updatePassword(R),k()}).catch(function(){x(S),f.send("DocException",I)})}else f.send("DocException",pa(I))}function k(){g(),p(!1).then(_,function(I){if(g(),!(I instanceof Zf)){C(I);return}i.requestLoadedStream().then(function(){g(),p(!0).then(_,C)})})}g(),y(v).then(function(I){if(s)throw I.terminate(new sr("Worker was terminated.")),new Error("Worker was terminated");i=I,i.requestLoadedStream(!0).then(S=>{f.send("DataLoaded",{length:S.bytes.byteLength})})}).then(k,C)}return f.on("GetPage",function(v){return i.getPage(v.pageIndex).then(function(_){return Promise.all([i.ensure(_,"rotate"),i.ensure(_,"ref"),i.ensure(_,"userUnit"),i.ensure(_,"view")]).then(function([C,k,I,S]){return{rotate:C,ref:k,refStr:(k==null?void 0:k.toString())??null,userUnit:I,view:S}})})}),f.on("GetPageIndex",function(v){const _=st.get(v.num,v.gen);return i.ensureCatalog("getPageIndex",[_])}),f.on("GetDestinations",function(v){return i.ensureCatalog("destinations")}),f.on("GetDestination",function(v){return i.ensureCatalog("getDestination",[v.id])}),f.on("GetPageLabels",function(v){return i.ensureCatalog("pageLabels")}),f.on("GetPageLayout",function(v){return i.ensureCatalog("pageLayout")}),f.on("GetPageMode",function(v){return i.ensureCatalog("pageMode")}),f.on("GetViewerPreferences",function(v){return i.ensureCatalog("viewerPreferences")}),f.on("GetOpenAction",function(v){return i.ensureCatalog("openAction")}),f.on("GetAttachments",function(v){return i.ensureCatalog("attachments")}),f.on("GetDocJSActions",function(v){return i.ensureCatalog("jsActions")}),f.on("GetPageJSActions",function({pageIndex:v}){return i.getPage(v).then(_=>i.ensure(_,"jsActions"))}),f.on("GetOutline",function(v){return i.ensureCatalog("documentOutline")}),f.on("GetOptionalContentConfig",function(v){return i.ensureCatalog("optionalContentConfig")}),f.on("GetPermissions",function(v){return i.ensureCatalog("permissions")}),f.on("GetMetadata",function(v){return Promise.all([i.ensureDoc("documentInfo"),i.ensureCatalog("metadata")])}),f.on("GetMarkInfo",function(v){return i.ensureCatalog("markInfo")}),f.on("GetData",function(v){return i.requestLoadedStream().then(_=>_.bytes)}),f.on("GetAnnotations",function({pageIndex:v,intent:_}){return i.getPage(v).then(function(C){const k=new tu(`GetAnnotations: page ${v}`);return m(k),C.getAnnotationsData(f,k,_).then(I=>(x(k),I),I=>{throw x(k),I})})}),f.on("GetFieldObjects",function(v){return i.ensureDoc("fieldObjects").then(_=>(_==null?void 0:_.allFields)||null)}),f.on("HasJSActions",function(v){return i.ensureDoc("hasJSActions")}),f.on("GetCalculationOrderIds",function(v){return i.ensureDoc("calculationOrderIds")}),f.on("SaveDocument",async function({isPureXfa:v,numPages:_,annotationStorage:C,filename:k}){const I=[i.requestLoadedStream(),i.ensureCatalog("acroForm"),i.ensureCatalog("acroFormRef"),i.ensureDoc("startXRef"),i.ensureDoc("xref"),i.ensureDoc("linearization"),i.ensureCatalog("structTreeRoot")],S=new la,R=[],P=v?null:eR(C),[D,U,T,G,M,F,X]=await Promise.all(I),z=M.trailer.getRaw("Root")||null;let K;if(P){X?await X.canUpdateStructTree({pdfManager:i,newAnnotationsByPage:P})&&(K=X):await Wp.canCreateStructureTree({catalogRef:z,pdfManager:i,newAnnotationsByPage:P})&&(K=null);const Y=M0.generateImages(C.values(),M,i.evaluatorOptions.isOffscreenCanvasSupported),le=K===void 0?R:[];for(const[$,re]of P)le.push(i.getPage($).then(oe=>{const ee=new tu(`Save (editor): page ${$}`);return m(ee),oe.saveNewAnnotations(f,ee,re,Y,S).finally(function(){x(ee)})}));K===null?R.push(Promise.all(le).then(async()=>{await Wp.createStructureTree({newAnnotationsByPage:P,xref:M,catalogRef:z,pdfManager:i,changes:S})})):K&&R.push(Promise.all(le).then(async()=>{await K.updateStructureTree({newAnnotationsByPage:P,pdfManager:i,changes:S})}))}if(v)R.push(i.ensureDoc("serializeXfaData",[C]));else for(let Y=0;Y<_;Y++)R.push(i.getPage(Y).then(function(le){const $=new tu(`Save: page ${Y}`);return m($),le.save(f,$,C,S).finally(function(){x($)})}));const j=await Promise.all(R);let ae=null;if(v){if(ae=j[0],!ae)return D.bytes}else if(S.size===0)return D.bytes;const ge=T&&U instanceof fe&&S.values().some(Y=>Y.needAppearances),ue=U instanceof fe&&U.get("XFA")||null;let pe=null,de=!1;if(Array.isArray(ue)){for(let Y=0,le=ue.length;Y<le;Y+=2)ue[Y]==="datasets"&&(pe=ue[Y+1],de=!0);pe===null&&(pe=M.getNewTemporaryRef())}else ue&&he("Unsupported XFA type.");let O=Object.create(null);if(M.trailer){const Y=new Map,le=M.trailer.get("Info")||null;if(le instanceof fe)for(const[$,re]of le)typeof re=="string"&&Y.set($,Tn(re));O={rootRef:z,encryptRef:M.trailer.getRaw("Encrypt")||null,newRef:M.getNewTemporaryRef(),infoRef:M.trailer.getRaw("Info")||null,infoMap:Y,fileIds:M.trailer.get("ID")||null,startXRef:F?G:M.lastXRefStreamPos??G,filename:k}}return cJ({originalData:D.bytes,xrefInfo:O,changes:S,xref:M,hasXfa:!!ue,xfaDatasetsRef:pe,hasXfaDatasetsEntry:de,needAppearances:ge,acroFormRef:T,acroForm:U,xfaData:ae,useXrefStream:YT(M.topDict,"XRef")}).finally(()=>{M.resetNewTemporaryRef()})}),f.on("GetOperatorList",function(v,_){const C=v.pageIndex;i.getPage(C).then(function(k){const I=new tu(`GetOperatorList: page ${C}`);m(I);const S=o>=Np.INFOS?Date.now():0;k.getOperatorList({handler:f,sink:_,task:I,intent:v.intent,cacheKey:v.cacheKey,annotationStorage:v.annotationStorage,modifiedIds:v.modifiedIds}).then(function(R){x(I),S&&gn(`page=${C+1} - getOperatorList: time=${Date.now()-S}ms, len=${R.length}`),_.close()},function(R){x(I),!I.terminated&&_.error(R)})})}),f.on("GetTextContent",function(v,_){const{pageIndex:C,includeMarkedContent:k,disableNormalization:I}=v;i.getPage(C).then(function(S){const R=new tu("GetTextContent: page "+C);m(R);const P=o>=Np.INFOS?Date.now():0;S.extractTextContent({handler:f,task:R,sink:_,includeMarkedContent:k,disableNormalization:I}).then(function(){x(R),P&&gn(`page=${C+1} - getTextContent: time=${Date.now()-P}ms`),_.close()},function(D){x(R),!R.terminated&&_.error(D)})})}),f.on("GetStructTree",function(v){return i.getPage(v.pageIndex).then(_=>i.ensure(_,"getStructTree"))}),f.on("FontFallback",function(v){return i.fontFallback(v.id,f)}),f.on("Cleanup",function(v){return i.cleanup(!0)}),f.on("Terminate",function(v){s=!0;const _=[];if(i){i.terminate(new sr("Worker was terminated."));const C=i.cleanup();_.push(C),i=null}else M4();r==null||r(new sr("Worker was terminated."));for(const C of a)_.push(C.finished),C.terminate();return Promise.all(_).then(function(){f.destroy(),f=null})}),f.on("Ready",function(v){w(e),e=null}),d}static initializeFromPort(e){const t=new bC("worker","main",e);this.setup(t,e),t.send("ready",null)}};typeof window>"u"&&!VB&&typeof self<"u"&&typeof self.postMessage=="function"&&"onmessage"in self&&qv.initializeFromPort(self);let C6=qv;globalThis.pdfjsWorker={WorkerMessageHandler:C6};let $p="",e2="";async function fJ(){var t,i;const n=await fetch("/api/config");if(!n.ok)throw new Error("Failed to fetch Google Drive credentials");const e=await n.json();if($p=(t=e.google_drive)==null?void 0:t.api_key,e2=(i=e.google_drive)==null?void 0:i.client_id,!$p||!e2)throw new Error("Google Drive API credentials not configured")}const gJ=["https://www.googleapis.com/auth/drive.readonly","https://www.googleapis.com/auth/drive.file"],mJ=()=>{if(!$p||!e2)throw new Error("Google Drive API credentials not configured");if($p===""||e2==="")throw new Error("Please configure valid Google Drive API credentials")};let s9=null,xC=!1;const pJ=()=>new Promise((n,e)=>{if(typeof gapi>"u"){const t=document.createElement("script");t.src="https://apis.google.com/js/api.js",t.onload=()=>{gapi.load("picker",()=>{n(!0)})},t.onerror=e,document.body.appendChild(t)}else gapi.load("picker",()=>{n(!0)})}),bJ=()=>new Promise((n,e)=>{if(typeof google>"u"){const t=document.createElement("script");t.src="https://accounts.google.com/gsi/client",t.onload=n,t.onerror=e,document.body.appendChild(t)}else n(!0)}),xJ=async()=>s9||new Promise((n,e)=>{google.accounts.oauth2.initTokenClient({client_id:e2,scope:gJ.join(" "),callback:i=>{i.access_token?(s9=i.access_token,n(s9)):e(new Error("Failed to get access token"))},error_callback:i=>{e(new Error(i.message||"OAuth error occurred"))}}).requestAccessToken()}),yJ=async()=>{xC||(await fJ(),mJ(),await Promise.all([pJ(),bJ()]),xC=!0)},wJ=()=>new Promise(async(n,e)=>{try{await yJ();const t=await xJ();if(!t)throw console.error("Failed to get OAuth token"),new Error("Unable to get OAuth token");new google.picker.PickerBuilder().enableFeature(google.picker.Feature.NAV_HIDDEN).enableFeature(google.picker.Feature.MULTISELECT_ENABLED).addView(new google.picker.DocsView().setIncludeFolders(!1).setSelectFolderEnabled(!1).setMimeTypes("application/pdf,text/plain,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.google-apps.document,application/vnd.google-apps.spreadsheet,application/vnd.google-apps.presentation")).setOAuthToken(t).setDeveloperKey($p).setCallback(async s=>{if(s[google.picker.Response.ACTION]===google.picker.Action.PICKED)try{const r=s[google.picker.Response.DOCUMENTS][0],a=r[google.picker.Document.ID],o=r[google.picker.Document.NAME],l=r[google.picker.Document.URL];if(!a||!o)throw new Error("Required file details missing");const c=r[google.picker.Document.MIME_TYPE];let h,u;c.includes("google-apps")?(c.includes("document")?u="text/plain":c.includes("spreadsheet")?u="text/csv":c.includes("presentation")?u="text/plain":u="application/pdf",h=`https://www.googleapis.com/drive/v3/files/${a}/export?mimeType=${encodeURIComponent(u)}`):h=`https://www.googleapis.com/drive/v3/files/${a}?alt=media`;const d=await fetch(h,{headers:{Authorization:`Bearer ${t}`,Accept:"*/*"}});if(!d.ok){const m=await d.text();throw console.error("Download failed:",{status:d.status,statusText:d.statusText,error:m}),new Error(`Failed to download file (${d.status}): ${m}`)}const f=await d.blob(),g={id:a,name:o,url:h,blob:f,headers:{Authorization:`Bearer ${t}`,Accept:"*/*"}};n(g)}catch(r){e(r)}else s[google.picker.Response.ACTION]===google.picker.Action.CANCEL&&n(null)}).build().setVisible(!0)}catch(t){console.error("Google Drive Picker error:",t),e(t)}});/*! @azure/msal-common v15.2.0 2025-02-18 */const Ke={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},r9={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},bx=[Ke.OPENID_SCOPE,Ke.PROFILE_SCOPE,Ke.OFFLINE_ACCESS_SCOPE],yC=[...bx,Ke.EMAIL_SCOPE],zr={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},wC={ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},Mh={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},a9={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},Fs={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},vC={PLAIN:"plain",S256:"S256"},xx={QUERY:"query",FRAGMENT:"fragment"},vJ={...xx,FORM_POST:"form_post"},pP={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},o9={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},Cr={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},An={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},X4="appmetadata",_J="client_info",vp="1",V3={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},ba={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},Qs={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},fi={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},_p={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},_C={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},kC={username:"username",password:"password"},l9={httpSuccess:200,httpBadRequest:400},bf={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},Uw={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},lu={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},kJ={Jwt:"JWT",Jwk:"JWK",Pop:"pop"},CJ=300;/*! @azure/msal-common v15.2.0 2025-02-18 */const Y4="unexpected_error",AJ="post_request_failed";/*! @azure/msal-common v15.2.0 2025-02-18 */const CC={[Y4]:"Unexpected error in authentication.",[AJ]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class Bi extends Error{constructor(e,t,i){const s=t?`${e}: ${t}`:e;super(s),Object.setPrototypeOf(this,Bi.prototype),this.errorCode=e||Ke.EMPTY_STRING,this.errorMessage=t||Ke.EMPTY_STRING,this.subError=i||Ke.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function bP(n,e){return new Bi(n,e?`${CC[n]} ${e}`:CC[n])}/*! @azure/msal-common v15.2.0 2025-02-18 */const J4="client_info_decoding_error",xP="client_info_empty_error",Z4="token_parsing_error",yP="null_or_empty_token",gc="endpoints_resolution_error",wP="network_error",vP="openid_config_error",_P="hash_not_deserialized",Ng="invalid_state",kP="state_mismatch",q3="state_not_found",CP="nonce_mismatch",Q4="auth_time_not_found",AP="max_age_transpired",SJ="multiple_matching_tokens",IJ="multiple_matching_accounts",SP="multiple_matching_appMetadata",IP="request_cannot_be_made",EP="cannot_remove_empty_scope",TP="cannot_append_scopeset",A6="empty_input_scopeset",EJ="device_code_polling_cancelled",TJ="device_code_expired",RJ="device_code_unknown_error",$4="no_account_in_silent_request",RP="invalid_cache_record",ev="invalid_cache_environment",S6="no_account_found",I6="no_crypto_object",E6="unexpected_credential_type",MJ="invalid_assertion",PJ="invalid_client_credential",Ph="token_refresh_required",NJ="user_timeout_reached",MP="token_claims_cnf_required_for_signedjwt",PP="authorization_code_missing_from_server_response",NP="binding_key_not_removed",OP="end_session_endpoint_not_supported",tv="key_id_missing",OJ="no_network_connectivity",DJ="user_canceled",LJ="missing_tenant_id_error",Pn="method_not_implemented",FJ="nested_app_auth_bridge_disabled";/*! @azure/msal-common v15.2.0 2025-02-18 */const AC={[J4]:"The client info could not be parsed/decoded correctly",[xP]:"The client info was empty",[Z4]:"Token cannot be parsed",[yP]:"The token is null or empty",[gc]:"Endpoints cannot be resolved",[wP]:"Network request failed",[vP]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[_P]:"The hash parameters could not be deserialized",[Ng]:"State was not the expected format",[kP]:"State mismatch error",[q3]:"State not found",[CP]:"Nonce mismatch error",[Q4]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[AP]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[SJ]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[IJ]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[SP]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[IP]:"Token request cannot be made without authorization code or refresh token.",[EP]:"Cannot remove null or empty scope from ScopeSet",[TP]:"Cannot append ScopeSet",[A6]:"Empty input ScopeSet cannot be processed",[EJ]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[TJ]:"Device code is expired.",[RJ]:"Device code stopped polling for unknown reasons.",[$4]:"Please pass an account object, silent flow is not supported without account information",[RP]:"Cache record object was null or undefined.",[ev]:"Invalid environment when attempting to create cache entry",[S6]:"No account found in cache for given key.",[I6]:"No crypto object detected.",[E6]:"Unexpected credential type.",[MJ]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[PJ]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Ph]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[NJ]:"User defined timeout for device code polling reached",[MP]:"Cannot generate a POP jwt if the token_claims are not populated",[PP]:"Server response does not contain an authorization code to proceed",[NP]:"Could not remove the credential's binding key from storage.",[OP]:"The provided authority does not support logout",[tv]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[OJ]:"No network connectivity. Check your internet connection.",[DJ]:"User cancelled the flow.",[LJ]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[Pn]:"This method has not been implemented",[FJ]:"The nested app auth bridge is disabled"};class nv extends Bi{constructor(e,t){super(e,t?`${AC[e]}: ${t}`:AC[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,nv.prototype)}}function mt(n,e){return new nv(n,e)}/*! @azure/msal-common v15.2.0 2025-02-18 */const W3={createNewGuid:()=>{throw mt(Pn)},base64Decode:()=>{throw mt(Pn)},base64Encode:()=>{throw mt(Pn)},base64UrlEncode:()=>{throw mt(Pn)},encodeKid:()=>{throw mt(Pn)},async getPublicKeyThumbprint(){throw mt(Pn)},async removeTokenBindingKey(){throw mt(Pn)},async clearKeystore(){throw mt(Pn)},async signJwt(){throw mt(Pn)},async hashString(){throw mt(Pn)}};/*! @azure/msal-common v15.2.0 2025-02-18 */var Pi;(function(n){n[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Info=2]="Info",n[n.Verbose=3]="Verbose",n[n.Trace=4]="Trace"})(Pi||(Pi={}));class Bh{constructor(e,t,i){this.level=Pi.Info;const s=()=>{},r=e||Bh.createDefaultLoggerOptions();this.localCallback=r.loggerCallback||s,this.piiLoggingEnabled=r.piiLoggingEnabled||!1,this.level=typeof r.logLevel=="number"?r.logLevel:Pi.Info,this.correlationId=r.correlationId||Ke.EMPTY_STRING,this.packageName=t||Ke.EMPTY_STRING,this.packageVersion=i||Ke.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Pi.Info}}clone(e,t,i){return new Bh({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:i||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const r=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${Pi[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,r,t.containsPii||!1)}executeCallback(e,t,i){this.localCallback&&this.localCallback(e,t,i)}error(e,t){this.logMessage(e,{logLevel:Pi.Error,containsPii:!1,correlationId:t||Ke.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:Pi.Error,containsPii:!0,correlationId:t||Ke.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:Pi.Warning,containsPii:!1,correlationId:t||Ke.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:Pi.Warning,containsPii:!0,correlationId:t||Ke.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:Pi.Info,containsPii:!1,correlationId:t||Ke.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:Pi.Info,containsPii:!0,correlationId:t||Ke.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:Pi.Verbose,containsPii:!1,correlationId:t||Ke.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:Pi.Verbose,containsPii:!0,correlationId:t||Ke.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:Pi.Trace,containsPii:!1,correlationId:t||Ke.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:Pi.Trace,containsPii:!0,correlationId:t||Ke.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}/*! @azure/msal-common v15.2.0 2025-02-18 */const DP="@azure/msal-common",iv="15.2.0";/*! @azure/msal-common v15.2.0 2025-02-18 */const sv={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};/*! @azure/msal-common v15.2.0 2025-02-18 */function Yg(n,e){const t=BJ(n);try{const i=e(t);return JSON.parse(i)}catch{throw mt(Z4)}}function BJ(n){if(!n)throw mt(yP);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(n);if(!t||t.length<4)throw mt(Z4);return t[2]}function LP(n,e){if(e===0||Date.now()-3e5>n+e)throw mt(AP)}/*! @azure/msal-common v15.2.0 2025-02-18 */function rc(){return Math.round(new Date().getTime()/1e3)}function T6(n,e){const t=Number(n)||0;return rc()+e>t}function UJ(n){return Number(n)>rc()}/*! @azure/msal-common v15.2.0 2025-02-18 */function kp(n){return[GJ(n),VJ(n),qJ(n),WJ(n),KJ(n)].join(Cr.CACHE_KEY_SEPARATOR).toLowerCase()}function gy(n,e,t,i,s){return{credentialType:An.ID_TOKEN,homeAccountId:n,environment:e,clientId:i,secret:t,realm:s}}function my(n,e,t,i,s,r,a,o,l,c,h,u,d,f,g){var x,p;const m={homeAccountId:n,credentialType:An.ACCESS_TOKEN,secret:t,cachedAt:rc().toString(),expiresOn:a.toString(),extendedExpiresOn:o.toString(),environment:e,clientId:i,realm:s,target:r,tokenType:h||fi.BEARER};if(u&&(m.userAssertionHash=u),c&&(m.refreshOn=c.toString()),f&&(m.requestedClaims=f,m.requestedClaimsHash=g),((x=m.tokenType)==null?void 0:x.toLowerCase())!==fi.BEARER.toLowerCase())switch(m.credentialType=An.ACCESS_TOKEN_WITH_AUTH_SCHEME,m.tokenType){case fi.POP:const y=Yg(t,l);if(!((p=y==null?void 0:y.cnf)!=null&&p.kid))throw mt(MP);m.keyId=y.cnf.kid;break;case fi.SSH:m.keyId=d}return m}function FP(n,e,t,i,s,r,a){const o={credentialType:An.REFRESH_TOKEN,homeAccountId:n,environment:e,clientId:i,secret:t};return r&&(o.userAssertionHash=r),s&&(o.familyId=s),a&&(o.expiresOn=a.toString()),o}function rv(n){return n.hasOwnProperty("homeAccountId")&&n.hasOwnProperty("environment")&&n.hasOwnProperty("credentialType")&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("secret")}function HJ(n){return n?rv(n)&&n.hasOwnProperty("realm")&&n.hasOwnProperty("target")&&(n.credentialType===An.ACCESS_TOKEN||n.credentialType===An.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function zJ(n){return n?rv(n)&&n.hasOwnProperty("realm")&&n.credentialType===An.ID_TOKEN:!1}function jJ(n){return n?rv(n)&&n.credentialType===An.REFRESH_TOKEN:!1}function GJ(n){return[n.homeAccountId,n.environment].join(Cr.CACHE_KEY_SEPARATOR).toLowerCase()}function VJ(n){const e=n.credentialType===An.REFRESH_TOKEN&&n.familyId||n.clientId;return[n.credentialType,e,n.realm||""].join(Cr.CACHE_KEY_SEPARATOR).toLowerCase()}function qJ(n){return(n.target||"").toLowerCase()}function WJ(n){return(n.requestedClaimsHash||"").toLowerCase()}function KJ(n){return n.tokenType&&n.tokenType.toLowerCase()!==fi.BEARER.toLowerCase()?n.tokenType.toLowerCase():""}function XJ(n,e){const t=n.indexOf(Qs.CACHE_KEY)===0;let i=!0;return e&&(i=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&i}function YJ(n,e){let t=!1;n&&(t=n.indexOf(_p.THROTTLING_PREFIX)===0);let i=!0;return e&&(i=e.hasOwnProperty("throttleTime")),t&&i}function JJ({environment:n,clientId:e}){return[X4,n,e].join(Cr.CACHE_KEY_SEPARATOR).toLowerCase()}function ZJ(n,e){return e?n.indexOf(X4)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function QJ(n,e){return e?n.indexOf(V3.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function SC(){return rc()+V3.REFRESH_TIME_SECONDS}function c9(n,e,t){n.authorization_endpoint=e.authorization_endpoint,n.token_endpoint=e.token_endpoint,n.end_session_endpoint=e.end_session_endpoint,n.issuer=e.issuer,n.endpointsFromNetwork=t,n.jwks_uri=e.jwks_uri}function Hw(n,e,t){n.aliases=e.aliases,n.preferred_cache=e.preferred_cache,n.preferred_network=e.preferred_network,n.aliasesFromNetwork=t}function IC(n){return n.expiresAt<=rc()}/*! @azure/msal-common v15.2.0 2025-02-18 */const BP="redirect_uri_empty",$J="claims_request_parsing_error",UP="authority_uri_insecure",hp="url_parse_error",HP="empty_url_error",zP="empty_input_scopes_error",jP="invalid_prompt_value",av="invalid_claims",GP="token_request_empty",VP="logout_request_empty",qP="invalid_code_challenge_method",ov="pkce_params_missing",lv="invalid_cloud_discovery_metadata",WP="invalid_authority_metadata",KP="untrusted_authority",py="missing_ssh_jwk",XP="missing_ssh_kid",eZ="missing_nonce_authentication_header",tZ="invalid_authentication_header",YP="cannot_set_OIDCOptions",JP="cannot_allow_platform_broker",ZP="authority_mismatch";/*! @azure/msal-common v15.2.0 2025-02-18 */const nZ={[BP]:"A redirect URI is required for all calls, and none has been set.",[$J]:"Could not parse the given claims request object.",[UP]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[hp]:"URL could not be parsed into appropriate segments.",[HP]:"URL was empty or null.",[zP]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[jP]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[av]:"Given claims parameter must be a stringified JSON object.",[GP]:"Token request was empty and not found in cache.",[VP]:"The logout request was null or undefined.",[qP]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[ov]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[lv]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[WP]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[KP]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[py]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[XP]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[eZ]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[tZ]:"Invalid authentication header provided",[YP]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[JP]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[ZP]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class cv extends Bi{constructor(e){super(e,nZ[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,cv.prototype)}}function xi(n){return new cv(n)}/*! @azure/msal-common v15.2.0 2025-02-18 */class ec{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},i=e.split("&"),s=r=>decodeURIComponent(r.replace(/\+/g," "));return i.forEach(r=>{if(r.trim()){const[a,o]=r.split(/=(.+)/g,2);a&&o&&(t[s(a)]=s(o))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class ss{constructor(e){const t=e?ec.trimArrayEntries([...e]):[],i=t?ec.removeEmptyStringsFromArray(t):[];if(!i||!i.length)throw xi(zP);this.scopes=new Set,i.forEach(s=>this.scopes.add(s))}static fromString(e){const i=(e||Ke.EMPTY_STRING).split(" ");return new ss(i)}static createSearchScopes(e){const t=new ss(e);return t.containsOnlyOIDCScopes()?t.removeScope(Ke.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}containsScope(e){const t=this.printScopesLowerCase().split(" "),i=new ss(t);return e?i.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return yC.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch{throw mt(TP)}}removeScope(e){if(!e)throw mt(EP);this.scopes.delete(e.trim())}removeOIDCScopes(){yC.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw mt(A6);const t=new Set;return e.scopes.forEach(i=>t.add(i.toLowerCase())),this.scopes.forEach(i=>t.add(i.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw mt(A6);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),i=e.getScopeCount(),s=this.getScopeCount();return t.size<s+i}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):Ke.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}/*! @azure/msal-common v15.2.0 2025-02-18 */function K3(n,e){if(!n)throw mt(xP);try{const t=e(n);return JSON.parse(t)}catch{throw mt(J4)}}function Bf(n){if(!n)throw mt(J4);const e=n.split(Cr.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?Ke.EMPTY_STRING:e[1]}}/*! @azure/msal-common v15.2.0 2025-02-18 */function EC(n,e){return!!n&&!!e&&n===e.split(".")[1]}function hv(n,e,t,i){if(i){const{oid:s,sub:r,tid:a,name:o,tfp:l,acr:c}=i,h=a||l||c||"";return{tenantId:h,localAccountId:s||r||"",name:o,isHomeTenant:EC(h,n)}}else return{tenantId:t,localAccountId:e,isHomeTenant:EC(t,n)}}function uv(n,e,t,i){let s=n;if(e){const{isHomeTenant:r,...a}=e;s={...n,...a}}if(t){const{isHomeTenant:r,...a}=hv(n.homeAccountId,n.localAccountId,n.tenantId,t);return s={...s,...a,idTokenClaims:t,idToken:i},s}return s}/*! @azure/msal-common v15.2.0 2025-02-18 */const qo={Default:0,Adfs:1,Dsts:2,Ciam:3};/*! @azure/msal-common v15.2.0 2025-02-18 */function QP(n){return n&&(n.tid||n.tfp||n.acr)||null}/*! @azure/msal-common v15.2.0 2025-02-18 */const o0={AAD:"AAD",OIDC:"OIDC"};/*! @azure/msal-common v15.2.0 2025-02-18 */class Kr{generateAccountId(){return[this.homeAccountId,this.environment].join(Cr.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return Kr.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(Cr.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,i){var c,h,u,d,f,g;const s=new Kr;t.authorityType===qo.Adfs?s.authorityType=o9.ADFS_ACCOUNT_TYPE:t.protocolMode===o0.AAD?s.authorityType=o9.MSSTS_ACCOUNT_TYPE:s.authorityType=o9.GENERIC_ACCOUNT_TYPE;let r;e.clientInfo&&i&&(r=K3(e.clientInfo,i)),s.clientInfo=e.clientInfo,s.homeAccountId=e.homeAccountId,s.nativeAccountId=e.nativeAccountId;const a=e.environment||t&&t.getPreferredCache();if(!a)throw mt(ev);s.environment=a,s.realm=(r==null?void 0:r.utid)||QP(e.idTokenClaims)||"",s.localAccountId=(r==null?void 0:r.uid)||((c=e.idTokenClaims)==null?void 0:c.oid)||((h=e.idTokenClaims)==null?void 0:h.sub)||"";const o=((u=e.idTokenClaims)==null?void 0:u.preferred_username)||((d=e.idTokenClaims)==null?void 0:d.upn),l=(f=e.idTokenClaims)!=null&&f.emails?e.idTokenClaims.emails[0]:null;if(s.username=o||l||"",s.name=((g=e.idTokenClaims)==null?void 0:g.name)||"",s.cloudGraphHostName=e.cloudGraphHostName,s.msGraphHost=e.msGraphHost,e.tenantProfiles)s.tenantProfiles=e.tenantProfiles;else{const m=hv(e.homeAccountId,s.localAccountId,s.realm,e.idTokenClaims);s.tenantProfiles=[m]}return s}static createFromAccountInfo(e,t,i){var r;const s=new Kr;return s.authorityType=e.authorityType||o9.GENERIC_ACCOUNT_TYPE,s.homeAccountId=e.homeAccountId,s.localAccountId=e.localAccountId,s.nativeAccountId=e.nativeAccountId,s.realm=e.tenantId,s.environment=e.environment,s.username=e.username,s.name=e.name,s.cloudGraphHostName=t,s.msGraphHost=i,s.tenantProfiles=Array.from(((r=e.tenantProfiles)==null?void 0:r.values())||[]),s}static generateHomeAccountId(e,t,i,s,r){if(!(t===qo.Adfs||t===qo.Dsts)){if(e)try{const a=K3(e,s.base64Decode);if(a.uid&&a.utid)return`${a.uid}.${a.utid}`}catch{}i.warning("No client info in response")}return(r==null?void 0:r.sub)||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,i){if(!e||!t)return!1;let s=!0;if(i){const r=e.idTokenClaims||{},a=t.idTokenClaims||{};s=r.iat===a.iat&&r.nonce===a.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&s}}/*! @azure/msal-common v15.2.0 2025-02-18 */function $P(n){return n.startsWith("#/")?n.substring(2):n.startsWith("#")||n.startsWith("?")?n.substring(1):n}function X3(n){if(!n||n.indexOf("=")<0)return null;try{const e=$P(n),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.error||t.error_description||t.state)return t}catch{throw mt(_P)}return null}/*! @azure/msal-common v15.2.0 2025-02-18 */class Zn{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw xi(HP);e.includes("#")||(this._urlString=Zn.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return ec.endsWith(t,"?")?t=t.slice(0,-1):ec.endsWith(t,"?/")&&(t=t.slice(0,-2)),ec.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw xi(hp)}if(!e.HostNameAndPort||!e.PathSegments)throw xi(hp);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw xi(UP)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return Zn.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),i=t.PathSegments;return e&&i.length!==0&&(i[0]===Mh.COMMON||i[0]===Mh.ORGANIZATIONS)&&(i[0]=e),Zn.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw xi(hp);const i={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let s=i.AbsolutePath.split("/");return s=s.filter(r=>r&&r.length>0),i.PathSegments=s,i.QueryString&&i.QueryString.endsWith("/")&&(i.QueryString=i.QueryString.substring(0,i.QueryString.length-1)),i}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),i=e.match(t);if(!i)throw xi(hp);return i[2]}static getAbsoluteUrl(e,t){if(e[0]===Ke.FORWARD_SLASH){const s=new Zn(t).getUrlComponents();return s.Protocol+"//"+s.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new Zn(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!X3(e)}}/*! @azure/msal-common v15.2.0 2025-02-18 */const eN={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},TC=eN.endpointMetadata,dv=eN.instanceDiscoveryMetadata,tN=new Set;dv.metadata.forEach(n=>{n.aliases.forEach(e=>{tN.add(e)})});function iZ(n,e){var s;let t;const i=n.canonicalAuthority;if(i){const r=new Zn(i).getUrlComponents().HostNameAndPort;t=RC(r,(s=n.cloudDiscoveryMetadata)==null?void 0:s.metadata,ba.CONFIG,e)||RC(r,dv.metadata,ba.HARDCODED_VALUES,e)||n.knownAuthorities}return t||[]}function RC(n,e,t,i){if(i==null||i.trace(`getAliasesFromMetadata called with source: ${t}`),n&&e){const s=Y3(e,n);if(s)return i==null||i.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),s.aliases;i==null||i.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function sZ(n){return Y3(dv.metadata,n)}function Y3(n,e){for(let t=0;t<n.length;t++){const i=n[t];if(i.aliases.includes(e))return i}return null}/*! @azure/msal-common v15.2.0 2025-02-18 */const nN="cache_quota_exceeded",fv="cache_error_unknown";/*! @azure/msal-common v15.2.0 2025-02-18 */const zw={[nN]:"Exceeded cache storage capacity.",[fv]:"Unexpected error occurred when using cache storage."};class i1 extends Error{constructor(e,t){const i=t||(zw[e]?zw[e]:zw[fv]);super(`${e}: ${i}`),Object.setPrototypeOf(this,i1.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=i}}/*! @azure/msal-common v15.2.0 2025-02-18 */class R6{constructor(e,t,i,s){this.clientId=e,this.cryptoImpl=t,this.commonLogger=i.clone(DP,iv),this.staticAuthorityOptions=s}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const t=this.getAllAccounts(e);return t.length>1?t.sort(s=>s.idTokenClaims?-1:1)[0]:t.length===1?t[0]:null}getBaseAccountInfo(e){const t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap(i=>this.getTenantProfilesFromAccountEntity(i,t==null?void 0:t.tenantId,t))}getTenantedAccountInfoByFilter(e,t,i,s){let r=null,a;if(s&&!this.tenantProfileMatchesFilter(i,s))return null;const o=this.getIdToken(e,t,i.tenantId);return o&&(a=Yg(o.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(a,s))?null:(r=uv(e,i,a,o==null?void 0:o.secret),r)}getTenantProfilesFromAccountEntity(e,t,i){const s=e.getAccountInfo();let r=s.tenantProfiles||new Map;const a=this.getTokenKeys();if(t){const l=r.get(t);if(l)r=new Map([[t,l]]);else return[]}const o=[];return r.forEach(l=>{const c=this.getTenantedAccountInfoByFilter(s,a,l,i);c&&o.push(c)}),o}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}async saveCacheRecord(e,t,i){var s,r,a,o;if(!e)throw mt(RP);try{e.account&&await this.setAccount(e.account,t),e.idToken&&(i==null?void 0:i.idToken)!==!1&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&(i==null?void 0:i.accessToken)!==!1&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&(i==null?void 0:i.refreshToken)!==!1&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(l){throw(s=this.commonLogger)==null||s.error("CacheManager.saveCacheRecord: failed"),l instanceof Error?((r=this.commonLogger)==null||r.errorPii(`CacheManager.saveCacheRecord: ${l.message}`,t),l.name==="QuotaExceededError"||l.name==="NS_ERROR_DOM_QUOTA_REACHED"||l.message.includes("exceeded the quota")?((a=this.commonLogger)==null||a.error("CacheManager.saveCacheRecord: exceeded storage quota",t),new i1(nN)):new i1(l.name,l.message)):((o=this.commonLogger)==null||o.errorPii(`CacheManager.saveCacheRecord: ${l}`,t),new i1(fv))}}async saveAccessToken(e,t){const i={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},s=this.getTokenKeys(),r=ss.fromString(e.target),a=[];s.accessToken.forEach(o=>{if(!this.accessTokenKeyMatchesFilter(o,i,!1))return;const l=this.getAccessTokenCredential(o);l&&this.credentialMatchesFilter(l,i)&&ss.fromString(l.target).intersectingScopeSets(r)&&a.push(this.removeAccessToken(o))}),await Promise.all(a),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e){const t=this.getAccountKeys(),i=[];return t.forEach(s=>{var l;if(!this.isAccountKey(s,e.homeAccountId))return;const r=this.getAccount(s,this.commonLogger);if(!r||e.homeAccountId&&!this.matchHomeAccountId(r,e.homeAccountId)||e.username&&!this.matchUsername(r.username,e.username)||e.environment&&!this.matchEnvironment(r,e.environment)||e.realm&&!this.matchRealm(r,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(r,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(r,e.authorityType))return;const a={localAccountId:e==null?void 0:e.localAccountId,name:e==null?void 0:e.name},o=(l=r.tenantProfiles)==null?void 0:l.filter(c=>this.tenantProfileMatchesFilter(c,a));o&&o.length===0||i.push(r)}),i}isAccountKey(e,t,i){return!(e.split(Cr.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||i&&!e.toLowerCase().includes(i.toLowerCase()))}isCredentialKey(e){if(e.split(Cr.CACHE_KEY_SEPARATOR).length<6)return!1;const t=e.toLowerCase();if(t.indexOf(An.ID_TOKEN.toLowerCase())===-1&&t.indexOf(An.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(An.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(An.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(An.REFRESH_TOKEN.toLowerCase())>-1){const i=`${An.REFRESH_TOKEN}${Cr.CACHE_KEY_SEPARATOR}${this.clientId}${Cr.CACHE_KEY_SEPARATOR}`,s=`${An.REFRESH_TOKEN}${Cr.CACHE_KEY_SEPARATOR}${vp}${Cr.CACHE_KEY_SEPARATOR}`;if(t.indexOf(i.toLowerCase())===-1&&t.indexOf(s.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===An.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===fi.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){const t=this.getKeys(),i={};return t.forEach(s=>{if(!this.isAppMetadata(s))return;const r=this.getAppMetadata(s);r&&(e.environment&&!this.matchEnvironment(r,e.environment)||e.clientId&&!this.matchClientId(r,e.clientId)||(i[s]=r))}),i}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let i=null;return t.forEach(s=>{if(!this.isAuthorityMetadata(s)||s.indexOf(this.clientId)===-1)return;const r=this.getAuthorityMetadata(s);r&&r.aliases.indexOf(e)!==-1&&(i=r)}),i}async removeAllAccounts(){const e=this.getAccountKeys(),t=[];e.forEach(i=>{t.push(this.removeAccount(i))}),await Promise.all(t)}async removeAccount(e){const t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){const t=this.getTokenKeys(),i=e.generateAccountId(),s=[];t.idToken.forEach(r=>{r.indexOf(i)===0&&this.removeIdToken(r)}),t.accessToken.forEach(r=>{r.indexOf(i)===0&&s.push(this.removeAccessToken(r))}),t.refreshToken.forEach(r=>{r.indexOf(i)===0&&this.removeRefreshToken(r)}),await Promise.all(s)}async removeAccessToken(e){const t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===An.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===fi.POP){const s=t.keyId;if(s)try{await this.cryptoImpl.removeTokenBindingKey(s)}catch{throw mt(NP)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t)}),!0}readAccountFromCache(e){const t=Kr.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,i,s,r){this.commonLogger.trace("CacheManager - getIdToken called");const a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:An.ID_TOKEN,clientId:this.clientId,realm:i},o=this.getIdTokensByFilter(a,t),l=o.size;if(l<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(l>1){let c=o;if(!i){const h=new Map;o.forEach((d,f)=>{d.realm===e.tenantId&&h.set(f,d)});const u=h.size;if(u<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),o.values().next().value;if(u===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),h.values().next().value;c=h}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),c.forEach((h,u)=>{this.removeIdToken(u)}),s&&r&&s.addFields({multiMatchedID:o.size},r),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),o.values().next().value}getIdTokensByFilter(e,t){const i=t&&t.idToken||this.getTokenKeys().idToken,s=new Map;return i.forEach(r=>{if(!this.idTokenKeyMatchesFilter(r,{clientId:this.clientId,...e}))return;const a=this.getIdTokenCredential(r);a&&this.credentialMatchesFilter(a,e)&&s.set(r,a)}),s}idTokenKeyMatchesFilter(e,t){const i=e.toLowerCase();return!(t.clientId&&i.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&i.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,i,s,r,a){this.commonLogger.trace("CacheManager - getAccessToken called");const o=ss.createSearchScopes(t.scopes),l=t.authenticationScheme||fi.BEARER,c=l&&l.toLowerCase()!==fi.BEARER.toLowerCase()?An.ACCESS_TOKEN_WITH_AUTH_SCHEME:An.ACCESS_TOKEN,h={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:s||e.tenantId,target:o,tokenType:l,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=i&&i.accessToken||this.getTokenKeys().accessToken,d=[];u.forEach(g=>{if(this.accessTokenKeyMatchesFilter(g,h,!0)){const m=this.getAccessTokenCredential(g);m&&this.credentialMatchesFilter(m,h)&&d.push(m)}});const f=d.length;return f<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):f>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),d.forEach(g=>{this.removeAccessToken(kp(g))}),r&&a&&r.addFields({multiMatchedAT:d.length},a),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),d[0])}accessTokenKeyMatchesFilter(e,t,i){const s=e.toLowerCase();if(t.clientId&&s.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&s.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&s.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&s.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){const r=t.target.asArray();for(let a=0;a<r.length;a++){if(i&&!s.includes(r[a].toLowerCase()))return!1;if(!i&&s.includes(r[a].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const t=this.getTokenKeys(),i=[];return t.accessToken.forEach(s=>{if(!this.accessTokenKeyMatchesFilter(s,e,!0))return;const r=this.getAccessTokenCredential(s);r&&this.credentialMatchesFilter(r,e)&&i.push(r)}),i}getRefreshToken(e,t,i,s,r){this.commonLogger.trace("CacheManager - getRefreshToken called");const a=t?vp:void 0,o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:An.REFRESH_TOKEN,clientId:this.clientId,familyId:a},l=i&&i.refreshToken||this.getTokenKeys().refreshToken,c=[];l.forEach(u=>{if(this.refreshTokenKeyMatchesFilter(u,o)){const d=this.getRefreshTokenCredential(u);d&&this.credentialMatchesFilter(d,o)&&c.push(d)}});const h=c.length;return h<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(h>1&&s&&r&&s.addFields({multiMatchedRT:h},r),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const i=e.toLowerCase();return!(t.familyId&&i.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&i.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&i.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},i=this.getAppMetadataFilteredBy(t),s=Object.keys(i).map(a=>i[a]),r=s.length;if(r<1)return null;if(r>1)throw mt(SP);return s[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===vp)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){const i=e.oid||e.sub;return t===i}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){var i;return t.toLowerCase()===((i=e.name)==null?void 0:i.toLowerCase())}matchUsername(e,t){return!!(e&&typeof e=="string"&&(t==null?void 0:t.toLowerCase())===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const s=iZ(this.staticAuthorityOptions,this.commonLogger);if(s.includes(t)&&s.includes(e.environment))return!0}const i=this.getAuthorityMetadataByAlias(t);return!!(i&&i.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){var i;return((i=e.realm)==null?void 0:i.toLowerCase())===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==An.ACCESS_TOKEN&&e.credentialType!==An.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:ss.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(X4)!==-1}isAuthorityMetadata(e){return e.indexOf(V3.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${V3.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(const i in t)e[i]=t[i];return e}}class rZ extends R6{async setAccount(){throw mt(Pn)}getAccount(){throw mt(Pn)}async setIdTokenCredential(){throw mt(Pn)}getIdTokenCredential(){throw mt(Pn)}async setAccessTokenCredential(){throw mt(Pn)}getAccessTokenCredential(){throw mt(Pn)}async setRefreshTokenCredential(){throw mt(Pn)}getRefreshTokenCredential(){throw mt(Pn)}setAppMetadata(){throw mt(Pn)}getAppMetadata(){throw mt(Pn)}setServerTelemetry(){throw mt(Pn)}getServerTelemetry(){throw mt(Pn)}setAuthorityMetadata(){throw mt(Pn)}getAuthorityMetadata(){throw mt(Pn)}getAuthorityMetadataKeys(){throw mt(Pn)}setThrottlingCache(){throw mt(Pn)}getThrottlingCache(){throw mt(Pn)}removeItem(){throw mt(Pn)}getKeys(){throw mt(Pn)}getAccountKeys(){throw mt(Pn)}getTokenKeys(){throw mt(Pn)}}/*! @azure/msal-common v15.2.0 2025-02-18 */const iN={tokenRenewalOffsetSeconds:CJ,preventCorsPreflight:!1},aZ={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Pi.Info,correlationId:Ke.EMPTY_STRING},oZ={claimsBasedCachingEnabled:!1},lZ={async sendGetRequestAsync(){throw mt(Pn)},async sendPostRequestAsync(){throw mt(Pn)}},cZ={sku:Ke.SKU,version:iv,cpu:Ke.EMPTY_STRING,os:Ke.EMPTY_STRING},hZ={clientSecret:Ke.EMPTY_STRING,clientAssertion:void 0},uZ={azureCloudInstance:sv.None,tenant:`${Ke.DEFAULT_COMMON_TENANT}`},dZ={application:{appName:"",appVersion:""}};function fZ({authOptions:n,systemOptions:e,loggerOptions:t,cacheOptions:i,storageInterface:s,networkInterface:r,cryptoInterface:a,clientCredentials:o,libraryInfo:l,telemetry:c,serverTelemetryManager:h,persistencePlugin:u,serializableCache:d}){const f={...aZ,...t};return{authOptions:gZ(n),systemOptions:{...iN,...e},loggerOptions:f,cacheOptions:{...oZ,...i},storageInterface:s||new rZ(n.clientId,W3,new Bh(f)),networkInterface:r||lZ,cryptoInterface:a||W3,clientCredentials:o||hZ,libraryInfo:{...cZ,...l},telemetry:{...dZ,...c},serverTelemetryManager:h||null,persistencePlugin:u||null,serializableCache:d||null}}function gZ(n){return{clientCapabilities:[],azureCloudOptions:uZ,skipAuthorityMetadataCache:!1,instanceAware:!1,...n}}function M6(n){return n.authOptions.authority.options.protocolMode===o0.OIDC}/*! @azure/msal-common v15.2.0 2025-02-18 */const Ga={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};/*! @azure/msal-common v15.2.0 2025-02-18 */const Yd="client_id",sN="redirect_uri",MC="response_type",mZ="response_mode",pZ="grant_type",bZ="claims",xZ="scope",yZ="refresh_token",wZ="state",vZ="nonce",_Z="prompt",kZ="code",CZ="code_challenge",AZ="code_challenge_method",SZ="code_verifier",IZ="client-request-id",EZ="x-client-SKU",TZ="x-client-VER",RZ="x-client-OS",MZ="x-client-CPU",PZ="x-client-current-telemetry",NZ="x-client-last-telemetry",OZ="x-ms-lib-capability",DZ="x-app-name",LZ="x-app-ver",FZ="post_logout_redirect_uri",BZ="id_token_hint",UZ="device_code",HZ="client_secret",zZ="client_assertion",jZ="client_assertion_type",PC="token_type",NC="req_cnf",GZ="assertion",VZ="requested_token_use",OC="return_spa_code",qZ="nativebroker",WZ="logout_hint",KZ="sid",XZ="login_hint",YZ="domain_hint",JZ="x-client-xtra-sku",gv="brk_client_id",P6="brk_redirect_uri";/*! @azure/msal-common v15.2.0 2025-02-18 */class Pf{static validateRedirectUri(e){if(!e)throw xi(BP)}static validatePrompt(e){const t=[];for(const i in Fs)t.push(Fs[i]);if(t.indexOf(e)<0)throw xi(jP)}static validateClaims(e){try{JSON.parse(e)}catch{throw xi(av)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw xi(ov);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([vC.PLAIN,vC.S256].indexOf(e)<0)throw xi(qP)}}/*! @azure/msal-common v15.2.0 2025-02-18 */function ZZ(n,e,t){if(!e)return;const i=n.get(Yd);i&&n.has(gv)&&(t==null||t.addFields({embeddedClientId:i,embeddedRedirectUri:n.get(sN)},e))}class Cp{constructor(e,t){this.parameters=new Map,this.performanceClient=t,this.correlationId=e}addResponseTypeCode(){this.parameters.set(MC,encodeURIComponent(Ke.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(MC,encodeURIComponent(`${Ke.TOKEN_RESPONSE_TYPE} ${Ke.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(mZ,encodeURIComponent(e||vJ.QUERY))}addNativeBroker(){this.parameters.set(qZ,encodeURIComponent("1"))}addScopes(e,t=!0,i=bx){t&&!i.includes("openid")&&!e.includes("openid")&&i.push("openid");const s=t?[...e||[],...i]:e||[],r=new ss(s);this.parameters.set(xZ,encodeURIComponent(r.printScopes()))}addClientId(e){this.parameters.set(Yd,encodeURIComponent(e))}addRedirectUri(e){Pf.validateRedirectUri(e),this.parameters.set(sN,encodeURIComponent(e))}addPostLogoutRedirectUri(e){Pf.validateRedirectUri(e),this.parameters.set(FZ,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(BZ,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(YZ,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(XZ,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(zr.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(zr.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(KZ,encodeURIComponent(e))}addClaims(e,t){const i=this.addClientCapabilitiesToClaims(e,t);Pf.validateClaims(i),this.parameters.set(bZ,encodeURIComponent(i))}addCorrelationId(e){this.parameters.set(IZ,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(EZ,e.sku),this.parameters.set(TZ,e.version),e.os&&this.parameters.set(RZ,e.os),e.cpu&&this.parameters.set(MZ,e.cpu)}addApplicationTelemetry(e){e!=null&&e.appName&&this.parameters.set(DZ,e.appName),e!=null&&e.appVersion&&this.parameters.set(LZ,e.appVersion)}addPrompt(e){Pf.validatePrompt(e),this.parameters.set(`${_Z}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(wZ,encodeURIComponent(e))}addNonce(e){this.parameters.set(vZ,encodeURIComponent(e))}addCodeChallengeParams(e,t){if(Pf.validateCodeChallengeParams(e,t),e&&t)this.parameters.set(CZ,encodeURIComponent(e)),this.parameters.set(AZ,encodeURIComponent(t));else throw xi(ov)}addAuthorizationCode(e){this.parameters.set(kZ,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(UZ,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(yZ,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(SZ,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(HZ,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(zZ,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(jZ,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(GZ,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(VZ,encodeURIComponent(e))}addGrantType(e){this.parameters.set(pZ,encodeURIComponent(e))}addClientInfo(){this.parameters.set(_J,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([t,i])=>{!this.parameters.has(t)&&i&&this.parameters.set(t,i)})}addClientCapabilitiesToClaims(e,t){let i;if(!e)i={};else try{i=JSON.parse(e)}catch{throw xi(av)}return t&&t.length>0&&(i.hasOwnProperty(a9.ACCESS_TOKEN)||(i[a9.ACCESS_TOKEN]={}),i[a9.ACCESS_TOKEN][a9.XMS_CC]={values:t}),JSON.stringify(i)}addUsername(e){this.parameters.set(kC.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(kC.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(PC,fi.POP),this.parameters.set(NC,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(PC,fi.SSH),this.parameters.set(NC,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(PZ,e.generateCurrentRequestHeaderValue()),this.parameters.set(NZ,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(OZ,_p.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(WZ,encodeURIComponent(e))}addBrokerParameters(e){const t={};t[gv]=e.brokerClientId,t[P6]=e.brokerRedirectUri,this.addExtraQueryParameters(t)}createQueryString(){const e=new Array;return this.parameters.forEach((t,i)=>{e.push(`${i}=${t}`)}),ZZ(this.parameters,this.correlationId,this.performanceClient),e.join("&")}}/*! @azure/msal-common v15.2.0 2025-02-18 */function QZ(n){return n.hasOwnProperty("authorization_endpoint")&&n.hasOwnProperty("token_endpoint")&&n.hasOwnProperty("issuer")&&n.hasOwnProperty("jwks_uri")}/*! @azure/msal-common v15.2.0 2025-02-18 */function $Z(n){return n.hasOwnProperty("tenant_discovery_endpoint")&&n.hasOwnProperty("metadata")}/*! @azure/msal-common v15.2.0 2025-02-18 */function eQ(n){return n.hasOwnProperty("error")&&n.hasOwnProperty("error_description")}/*! @azure/msal-common v15.2.0 2025-02-18 */const Ae={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt"},tQ={NotStarted:0,InProgress:1,Completed:2};/*! @azure/msal-common v15.2.0 2025-02-18 */const x0=(n,e,t,i,s)=>(...r)=>{t.trace(`Executing function ${e}`);const a=i==null?void 0:i.startMeasurement(e,s);if(s){const o=e+"CallCount";i==null||i.incrementFields({[o]:1},s)}try{const o=n(...r);return a==null||a.end({success:!0}),t.trace(`Returning result from ${e}`),o}catch(o){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(o))}catch{t.trace("Unable to print error message.")}throw a==null||a.end({success:!1},o),o}},pt=(n,e,t,i,s)=>(...r)=>{t.trace(`Executing function ${e}`);const a=i==null?void 0:i.startMeasurement(e,s);if(s){const o=e+"CallCount";i==null||i.incrementFields({[o]:1},s)}return i==null||i.setPreQueueTime(e,s),n(...r).then(o=>(t.trace(`Returning result from ${e}`),a==null||a.end({success:!0}),o)).catch(o=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(o))}catch{t.trace("Unable to print error message.")}throw a==null||a.end({success:!1},o),o})};/*! @azure/msal-common v15.2.0 2025-02-18 */class by{constructor(e,t,i,s){this.networkInterface=e,this.logger=t,this.performanceClient=i,this.correlationId=s}async detectRegion(e,t){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(Ae.RegionDiscoveryDetectRegion,this.correlationId);let i=e;if(i)t.region_source=bf.ENVIRONMENT_VARIABLE;else{const r=by.IMDS_OPTIONS;try{const a=await pt(this.getRegionFromIMDS.bind(this),Ae.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(Ke.IMDS_VERSION,r);if(a.status===l9.httpSuccess&&(i=a.body,t.region_source=bf.IMDS),a.status===l9.httpBadRequest){const o=await pt(this.getCurrentVersion.bind(this),Ae.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(r);if(!o)return t.region_source=bf.FAILED_AUTO_DETECTION,null;const l=await pt(this.getRegionFromIMDS.bind(this),Ae.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(o,r);l.status===l9.httpSuccess&&(i=l.body,t.region_source=bf.IMDS)}}catch{return t.region_source=bf.FAILED_AUTO_DETECTION,null}}return i||(t.region_source=bf.FAILED_AUTO_DETECTION),i||null}async getRegionFromIMDS(e,t){var i;return(i=this.performanceClient)==null||i.addQueueMeasurement(Ae.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${Ke.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,Ke.IMDS_TIMEOUT)}async getCurrentVersion(e){var t;(t=this.performanceClient)==null||t.addQueueMeasurement(Ae.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const i=await this.networkInterface.sendGetRequestAsync(`${Ke.IMDS_ENDPOINT}?format=json`,e);return i.status===l9.httpBadRequest&&i.body&&i.body["newest-versions"]&&i.body["newest-versions"].length>0?i.body["newest-versions"][0]:null}catch{return null}}}by.IMDS_OPTIONS={headers:{Metadata:"true"}};/*! @azure/msal-common v15.2.0 2025-02-18 */class kr{constructor(e,t,i,s,r,a,o,l){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=i,this.authorityOptions=s,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=r,this.performanceClient=o,this.correlationId=a,this.managedIdentity=l||!1,this.regionDiscovery=new by(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(Ke.CIAM_AUTH_URL))return qo.Ciam;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case Ke.ADFS:return qo.Adfs;case Ke.DSTS:return qo.Dsts}return qo.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new Zn(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw mt(gc)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw mt(gc)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw mt(gc)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw mt(OP);return this.replacePath(this.metadata.end_session_endpoint)}else throw mt(gc)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw mt(gc)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw mt(gc)}canReplaceTenant(e){return e.PathSegments.length===1&&!kr.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===qo.Default&&this.protocolMode===o0.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const s=new Zn(this.metadata.canonical_authority).getUrlComponents(),r=s.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((o,l)=>{let c=r[l];if(l===0&&this.canReplaceTenant(s)){const h=new Zn(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];c!==h&&(this.logger.verbose(`Replacing tenant domain name ${c} with id ${h}`),c=h)}o!==c&&(t=t.replace(`/${c}/`,`/${o}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===qo.Adfs||this.protocolMode!==o0.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var s,r;(s=this.performanceClient)==null||s.addQueueMeasurement(Ae.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await pt(this.updateCloudDiscoveryMetadata.bind(this),Ae.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const i=await pt(this.updateEndpointMetadata.bind(this),Ae.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:i}),(r=this.performanceClient)==null||r.addFields({cloudDiscoverySource:t,authorityEndpointSource:i},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:SC(),jwks_uri:""}),e}updateCachedMetadata(e,t,i){t!==ba.CACHE&&(i==null?void 0:i.source)!==ba.CACHE&&(e.expiresAt=SC(),e.canonical_authority=this.canonicalAuthority);const s=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(s,e),this.metadata=e}async updateEndpointMetadata(e){var s,r,a;(s=this.performanceClient)==null||s.addQueueMeasurement(Ae.AuthorityUpdateEndpointMetadata,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===ba.HARDCODED_VALUES&&(r=this.authorityOptions.azureRegionConfiguration)!=null&&r.azureRegion&&t.metadata){const o=await pt(this.updateMetadataWithRegionalInformation.bind(this),Ae.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);c9(e,o,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let i=await pt(this.getEndpointMetadataFromNetwork.bind(this),Ae.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(i)return(a=this.authorityOptions.azureRegionConfiguration)!=null&&a.azureRegion&&(i=await pt(this.updateMetadataWithRegionalInformation.bind(this),Ae.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(i)),c9(e,i,!0),ba.NETWORK;throw mt(vP,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),c9(e,t,!1),{source:ba.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const s=this.getEndpointMetadataFromHardcodedValues();if(s)return c9(e,s,!1),{source:ba.HARDCODED_VALUES,metadata:s};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const i=IC(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!i?(this.logger.verbose("Found endpoint metadata in the cache."),{source:ba.CACHE}):(i&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new Zn(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw xi(WP)}return null}async getEndpointMetadataFromNetwork(){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(Ae.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const s=await this.networkInterface.sendGetRequestAsync(t,e);return QZ(s.body)?s.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(s){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${s}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in TC?TC[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var i,s,r;(i=this.performanceClient)==null||i.addQueueMeasurement(Ae.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const t=(s=this.authorityOptions.azureRegionConfiguration)==null?void 0:s.azureRegion;if(t){if(t!==Ke.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Uw.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,kr.replaceWithRegionalInformation(e,t);const a=await pt(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),Ae.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)((r=this.authorityOptions.azureRegionConfiguration)==null?void 0:r.environmentRegion,this.regionDiscoveryMetadata);if(a)return this.regionDiscoveryMetadata.region_outcome=Uw.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=a,kr.replaceWithRegionalInformation(e,a);this.regionDiscoveryMetadata.region_outcome=Uw.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(Ae.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const i=await pt(this.getCloudDiscoveryMetadataFromNetwork.bind(this),Ae.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(i)return Hw(e,i,!0),ba.NETWORK;throw xi(KP)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||Ke.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||Ke.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||Ke.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),Hw(e,t,!1),ba.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const s=sZ(this.hostnameAndPort);if(s)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),Hw(e,s,!1),ba.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const i=IC(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!i?(this.logger.verbose("Found cloud discovery metadata in the cache."),ba.CACHE):(i&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===qo.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),kr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=Y3(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),xi(lv)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),kr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(Ae.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${Ke.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let i=null;try{const r=await this.networkInterface.sendGetRequestAsync(e,t);let a,o;if($Z(r.body))a=r.body,o=a.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${a.tenant_discovery_endpoint}`);else if(eQ(r.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${r.status}`),a=r.body,a.error===Ke.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${a.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${a.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),o=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),i=Y3(o,this.hostnameAndPort)}catch(r){if(r instanceof Bi)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${r.errorCode}
Error Description: ${r.errorMessage}`);else{const a=r;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${a.name}
Error Description: ${a.message}`)}return null}return i||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),i=kr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),i}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&Zn.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let i;if(t&&t.azureCloudInstance!==sv.None){const s=t.tenant?t.tenant:Ke.DEFAULT_COMMON_TENANT;i=`${t.azureCloudInstance}/${s}/`}return i||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return Ke.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw mt(gc)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return tN.has(e)}static isPublicCloudAuthority(e){return Ke.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,i){const s=new Zn(e);s.validateAsUri();const r=s.getUrlComponents();let a=`${t}.${r.HostNameAndPort}`;this.isPublicCloudAuthority(r.HostNameAndPort)&&(a=`${t}.${Ke.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const o=Zn.constructAuthorityUriFromObject({...s.getUrlComponents(),HostNameAndPort:a}).urlString;return i?`${o}?${i}`:o}static replaceWithRegionalInformation(e,t){const i={...e};return i.authorization_endpoint=kr.buildRegionalAuthorityString(i.authorization_endpoint,t),i.token_endpoint=kr.buildRegionalAuthorityString(i.token_endpoint,t),i.end_session_endpoint&&(i.end_session_endpoint=kr.buildRegionalAuthorityString(i.end_session_endpoint,t)),i}static transformCIAMAuthority(e){let t=e;const s=new Zn(e).getUrlComponents();if(s.PathSegments.length===0&&s.HostNameAndPort.endsWith(Ke.CIAM_AUTH_URL)){const r=s.HostNameAndPort.split(".")[0];t=`${t}${r}${Ke.AAD_TENANT_DOMAIN_SUFFIX}`}return t}}kr.reservedTenantDomains=new Set(["{tenant}","{tenantid}",Mh.COMMON,Mh.CONSUMERS,Mh.ORGANIZATIONS]);function nQ(n){var s;const i=(s=new Zn(n).getUrlComponents().PathSegments.slice(-1)[0])==null?void 0:s.toLowerCase();switch(i){case Mh.COMMON:case Mh.ORGANIZATIONS:case Mh.CONSUMERS:return;default:return i}}function rN(n){return n.endsWith(Ke.FORWARD_SLASH)?n:`${n}${Ke.FORWARD_SLASH}`}function iQ(n){const e=n.cloudDiscoveryMetadata;let t;if(e)try{t=JSON.parse(e)}catch{throw xi(lv)}return{canonicalAuthority:n.authority?rN(n.authority):void 0,knownAuthorities:n.knownAuthorities,cloudDiscoveryMetadata:t}}/*! @azure/msal-common v15.2.0 2025-02-18 */async function aN(n,e,t,i,s,r,a){a==null||a.addQueueMeasurement(Ae.AuthorityFactoryCreateDiscoveredInstance,r);const o=kr.transformCIAMAuthority(rN(n)),l=new kr(o,e,t,i,s,r,a);try{return await pt(l.resolveEndpointsAsync.bind(l),Ae.AuthorityResolveEndpointsAsync,s,a,r)(),l}catch{throw mt(gc)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class Uh extends Bi{constructor(e,t,i,s,r){super(e,t,i),this.name="ServerError",this.errorNo=s,this.status=r,Object.setPrototypeOf(this,Uh.prototype)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class Kl{static generateThrottlingStorageKey(e){return`${_p.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t){var r;const i=Kl.generateThrottlingStorageKey(t),s=e.getThrottlingCache(i);if(s){if(s.throttleTime<Date.now()){e.removeItem(i);return}throw new Uh(((r=s.errorCodes)==null?void 0:r.join(" "))||Ke.EMPTY_STRING,s.errorMessage,s.subError)}}static postProcess(e,t,i){if(Kl.checkResponseStatus(i)||Kl.checkResponseForRetryAfter(i)){const s={throttleTime:Kl.calculateThrottleTime(parseInt(i.headers[zr.RETRY_AFTER])),error:i.body.error,errorCodes:i.body.error_codes,errorMessage:i.body.error_description,subError:i.body.suberror};e.setThrottlingCache(Kl.generateThrottlingStorageKey(t),s)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(zr.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){const t=e<=0?0:e,i=Date.now()/1e3;return Math.floor(Math.min(i+(t||_p.DEFAULT_THROTTLE_TIME_SECONDS),i+_p.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,i,s){const r={clientId:t,authority:i.authority,scopes:i.scopes,homeAccountIdentifier:s,claims:i.claims,authenticationScheme:i.authenticationScheme,resourceRequestMethod:i.resourceRequestMethod,resourceRequestUri:i.resourceRequestUri,shrClaims:i.shrClaims,sshKid:i.sshKid},a=this.generateThrottlingStorageKey(r);e.removeItem(a)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class xy extends Bi{constructor(e,t,i){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,xy.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=i}}function DC(n,e,t){return new xy(n,e,t)}/*! @azure/msal-common v15.2.0 2025-02-18 */class mv{constructor(e,t){this.config=fZ(e),this.logger=new Bh(this.config.loggerOptions,DP,iv),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[zr.CONTENT_TYPE]=Ke.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Ga.HOME_ACCOUNT_ID:try{const i=Bf(e.credential);t[zr.CCS_HEADER]=`Oid:${i.uid}@${i.utid}`}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case Ga.UPN:t[zr.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}async executePostToTokenEndpoint(e,t,i,s,r,a){var l;a&&((l=this.performanceClient)==null||l.addQueueMeasurement(a,r));const o=await this.sendPostRequest(s,e,{body:t,headers:i},r);return this.config.serverTelemetryManager&&o.status<500&&o.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),o}async sendPostRequest(e,t,i,s){var a,o,l;Kl.preProcess(this.cacheManager,e);let r;try{r=await pt(this.networkClient.sendPostRequestAsync.bind(this.networkClient),Ae.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,s)(t,i);const c=r.headers||{};(o=this.performanceClient)==null||o.addFields({refreshTokenSize:((a=r.body.refresh_token)==null?void 0:a.length)||0,httpVerToken:c[zr.X_MS_HTTP_VERSION]||"",requestId:c[zr.X_MS_REQUEST_ID]||""},s)}catch(c){if(c instanceof xy){const h=c.responseHeaders;throw h&&((l=this.performanceClient)==null||l.addFields({httpVerToken:h[zr.X_MS_HTTP_VERSION]||"",requestId:h[zr.X_MS_REQUEST_ID]||"",contentTypeHeader:h[zr.CONTENT_TYPE]||void 0,contentLengthHeader:h[zr.CONTENT_LENGTH]||void 0,httpStatus:c.httpStatus},s)),c.error}throw c instanceof Bi?c:mt(wP)}return Kl.postProcess(this.cacheManager,e,r),r}async updateAuthority(e,t){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(Ae.UpdateTokenEndpointAuthority,t);const i=`https://${e}/${this.authority.tenant}/`,s=await aN(i,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=s}createTokenQueryParameters(e){const t=new Cp(e.correlationId,this.performanceClient);return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.addCorrelationId(e.correlationId),t.createQueryString()}}/*! @azure/msal-common v15.2.0 2025-02-18 */const J3="no_tokens_found",oN="native_account_unavailable",pv="refresh_token_expired",sQ="interaction_required",rQ="consent_required",aQ="login_required",yy="bad_token";/*! @azure/msal-common v15.2.0 2025-02-18 */const LC=[sQ,rQ,aQ,yy],oQ=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],lQ={[J3]:"No refresh token found in the cache. Please sign-in.",[oN]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[pv]:"Refresh token has expired.",[yy]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class sl extends Bi{constructor(e,t,i,s,r,a,o,l){super(e,t,i),Object.setPrototypeOf(this,sl.prototype),this.timestamp=s||Ke.EMPTY_STRING,this.traceId=r||Ke.EMPTY_STRING,this.correlationId=a||Ke.EMPTY_STRING,this.claims=o||Ke.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=l}}function FC(n,e,t){const i=!!n&&LC.indexOf(n)>-1,s=!!t&&oQ.indexOf(t)>-1,r=!!e&&LC.some(a=>e.indexOf(a)>-1);return i||r||s}function N6(n){return new sl(n,lQ[n])}/*! @azure/msal-common v15.2.0 2025-02-18 */class tl{static setRequestState(e,t,i){const s=tl.generateLibraryState(e,i);return t?`${s}${Ke.RESOURCE_DELIM}${t}`:s}static generateLibraryState(e,t){if(!e)throw mt(I6);const i={id:e.createNewGuid()};t&&(i.meta=t);const s=JSON.stringify(i);return e.base64Encode(s)}static parseRequestState(e,t){if(!e)throw mt(I6);if(!t)throw mt(Ng);try{const i=t.split(Ke.RESOURCE_DELIM),s=i[0],r=i.length>1?i.slice(1).join(Ke.RESOURCE_DELIM):Ke.EMPTY_STRING,a=e.base64Decode(s),o=JSON.parse(a);return{userRequestState:r||Ke.EMPTY_STRING,libraryState:o}}catch{throw mt(Ng)}}}/*! @azure/msal-common v15.2.0 2025-02-18 */const cQ={SW:"sw",UHW:"uhw"};class Og{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(Ae.PopTokenGenerateCnf,e.correlationId);const i=await pt(this.generateKid.bind(this),Ae.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),s=this.cryptoUtils.base64UrlEncode(JSON.stringify(i));return{kid:i.kid,reqCnfString:s}}async generateKid(e){var i;return(i=this.performanceClient)==null||i.addQueueMeasurement(Ae.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:cQ.SW}}async signPopToken(e,t,i){return this.signPayload(e,t,i)}async signPayload(e,t,i,s){const{resourceRequestMethod:r,resourceRequestUri:a,shrClaims:o,shrNonce:l,shrOptions:c}=i,h=a?new Zn(a):void 0,u=h==null?void 0:h.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:rc(),m:r==null?void 0:r.toUpperCase(),u:u==null?void 0:u.HostNameAndPort,nonce:l||this.cryptoUtils.createNewGuid(),p:u==null?void 0:u.AbsolutePath,q:u!=null&&u.QueryString?[[],u.QueryString]:void 0,client_claims:o||void 0,...s},t,c,i.correlationId)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class hQ{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}/*! @azure/msal-common v15.2.0 2025-02-18 */function uQ(n){var i,s;const e="code=",t=(i=n.error_uri)==null?void 0:i.lastIndexOf(e);return t&&t>=0?(s=n.error_uri)==null?void 0:s.substring(t+e.length):void 0}class Jd{constructor(e,t,i,s,r,a,o){this.clientId=e,this.cacheStorage=t,this.cryptoObj=i,this.logger=s,this.serializableCache=r,this.persistencePlugin=a,this.performanceClient=o}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?mt(q3,"Cached State"):mt(q3,"Server State");let i,s;try{i=decodeURIComponent(e.state)}catch{throw mt(Ng,e.state)}try{s=decodeURIComponent(t)}catch{throw mt(Ng,e.state)}if(i!==s)throw mt(kP);if(e.error||e.error_description||e.suberror){const r=uQ(e);throw FC(e.error,e.error_description,e.suberror)?new sl(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",r):new Uh(e.error||"",e.error_description,e.suberror,r)}}validateTokenResponse(e,t){var i;if(e.error||e.error_description||e.suberror){const s=`Error(s): ${e.error_codes||Ke.NOT_AVAILABLE} - Timestamp: ${e.timestamp||Ke.NOT_AVAILABLE} - Description: ${e.error_description||Ke.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||Ke.NOT_AVAILABLE} - Trace ID: ${e.trace_id||Ke.NOT_AVAILABLE}`,r=(i=e.error_codes)!=null&&i.length?e.error_codes[0]:void 0,a=new Uh(e.error,s,e.suberror,r,e.status);if(t&&e.status&&e.status>=r9.SERVER_ERROR_RANGE_START&&e.status<=r9.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${a}`);return}else if(t&&e.status&&e.status>=r9.CLIENT_ERROR_RANGE_START&&e.status<=r9.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${a}`);return}throw FC(e.error,e.error_description,e.suberror)?new sl(e.error,e.error_description,e.suberror,e.timestamp||Ke.EMPTY_STRING,e.trace_id||Ke.EMPTY_STRING,e.correlation_id||Ke.EMPTY_STRING,e.claims||Ke.EMPTY_STRING,r):a}}async handleServerTokenResponse(e,t,i,s,r,a,o,l,c){var g;(g=this.performanceClient)==null||g.addQueueMeasurement(Ae.HandleServerTokenResponse,e.correlation_id);let h;if(e.id_token){if(h=Yg(e.id_token||Ke.EMPTY_STRING,this.cryptoObj.base64Decode),r&&r.nonce&&h.nonce!==r.nonce)throw mt(CP);if(s.maxAge||s.maxAge===0){const m=h.auth_time;if(!m)throw mt(Q4);LP(m,s.maxAge)}}this.homeAccountIdentifier=Kr.generateHomeAccountId(e.client_info||Ke.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,h);let u;r&&r.state&&(u=tl.parseRequestState(this.cryptoObj,r.state)),e.key_id=e.key_id||s.sshKid||void 0;const d=this.generateCacheRecord(e,t,i,s,h,a,r);let f;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),f=new hQ(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(f)),o&&!l&&d.account){const m=d.account.generateAccountKey();if(!this.cacheStorage.getAccount(m))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await Jd.generateAuthenticationResult(this.cryptoObj,t,d,!1,s,h,u,void 0,c)}await this.cacheStorage.saveCacheRecord(d,s.correlationId,s.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&f&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(f))}return Jd.generateAuthenticationResult(this.cryptoObj,t,d,!1,s,h,u,e,c)}generateCacheRecord(e,t,i,s,r,a,o){const l=t.getPreferredCache();if(!l)throw mt(ev);const c=QP(r);let h,u;e.id_token&&r&&(h=gy(this.homeAccountIdentifier,l,e.id_token,this.clientId,c||""),u=bv(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,r,e.client_info,l,c,o,void 0,this.logger));let d=null;if(e.access_token){const m=e.scope?ss.fromString(e.scope):new ss(s.scopes||[]),x=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,p=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,y=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,w=i+x,v=w+p,_=y&&y>0?i+y:void 0;d=my(this.homeAccountIdentifier,l,e.access_token,this.clientId,c||t.tenant||"",m.printScopes(),w,v,this.cryptoObj.base64Decode,_,e.token_type,a,e.key_id,s.claims,s.requestedClaimsHash)}let f=null;if(e.refresh_token){let m;if(e.refresh_token_expires_in){const x=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;m=i+x}f=FP(this.homeAccountIdentifier,l,e.refresh_token,this.clientId,e.foci,a,m)}let g=null;return e.foci&&(g={clientId:this.clientId,environment:l,familyId:e.foci}),{account:u,idToken:h,accessToken:d,refreshToken:f,appMetadata:g}}static async generateAuthenticationResult(e,t,i,s,r,a,o,l,c){var w,v,_,C,k;let h=Ke.EMPTY_STRING,u=[],d=null,f,g,m=Ke.EMPTY_STRING;if(i.accessToken){if(i.accessToken.tokenType===fi.POP&&!r.popKid){const I=new Og(e),{secret:S,keyId:R}=i.accessToken;if(!R)throw mt(tv);h=await I.signPopToken(S,R,r)}else h=i.accessToken.secret;u=ss.fromString(i.accessToken.target).asArray(),d=new Date(Number(i.accessToken.expiresOn)*1e3),f=new Date(Number(i.accessToken.extendedExpiresOn)*1e3),i.accessToken.refreshOn&&(g=new Date(Number(i.accessToken.refreshOn)*1e3))}i.appMetadata&&(m=i.appMetadata.familyId===vp?vp:"");const x=(a==null?void 0:a.oid)||(a==null?void 0:a.sub)||"",p=(a==null?void 0:a.tid)||"";l!=null&&l.spa_accountid&&i.account&&(i.account.nativeAccountId=l==null?void 0:l.spa_accountid);const y=i.account?uv(i.account.getAccountInfo(),void 0,a,(w=i.idToken)==null?void 0:w.secret):null;return{authority:t.canonicalAuthority,uniqueId:x,tenantId:p,scopes:u,account:y,idToken:((v=i==null?void 0:i.idToken)==null?void 0:v.secret)||"",idTokenClaims:a||{},accessToken:h,fromCache:s,expiresOn:d,extExpiresOn:f,refreshOn:g,correlationId:r.correlationId,requestId:c||Ke.EMPTY_STRING,familyId:m,tokenType:((_=i.accessToken)==null?void 0:_.tokenType)||Ke.EMPTY_STRING,state:o?o.userRequestState:Ke.EMPTY_STRING,cloudGraphHostName:((C=i.account)==null?void 0:C.cloudGraphHostName)||Ke.EMPTY_STRING,msGraphHost:((k=i.account)==null?void 0:k.msGraphHost)||Ke.EMPTY_STRING,code:l==null?void 0:l.spa_code,fromNativeBroker:!1}}}function bv(n,e,t,i,s,r,a,o,l,c,h){h==null||h.verbose("setCachedAccount called");const d=n.getAccountKeys().find(p=>p.startsWith(t));let f=null;d&&(f=n.getAccount(d));const g=f||Kr.createAccount({homeAccountId:t,idTokenClaims:s,clientInfo:r,environment:a,cloudGraphHostName:l==null?void 0:l.cloud_graph_host_name,msGraphHost:l==null?void 0:l.msgraph_host,nativeAccountId:c},e,i),m=g.tenantProfiles||[],x=o||g.realm;if(x&&!m.find(p=>p.tenantId===x)){const p=hv(t,g.localAccountId,x,s);m.push(p)}return g.tenantProfiles=m,g}/*! @azure/msal-common v15.2.0 2025-02-18 */async function lN(n,e,t){return typeof n=="string"?n:n({clientId:e,tokenEndpoint:t})}/*! @azure/msal-common v15.2.0 2025-02-18 */class cN extends mv{constructor(e,t){var i;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=(i=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:i.defaultScopes}async getAuthCodeUrl(e){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(Ae.GetAuthCodeUrl,e.correlationId);const t=await pt(this.createAuthCodeUrlQueryString.bind(this),Ae.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return Zn.appendQueryString(this.authority.authorizationEndpoint,t)}async acquireToken(e,t){var o,l;if((o=this.performanceClient)==null||o.addQueueMeasurement(Ae.AuthClientAcquireToken,e.correlationId),!e.code)throw mt(IP);const i=rc(),s=await pt(this.executeTokenRequest.bind(this),Ae.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),r=(l=s.headers)==null?void 0:l[zr.X_MS_REQUEST_ID],a=new Jd(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return a.validateTokenResponse(s.body),pt(a.handleServerTokenResponse.bind(a),Ae.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(s.body,this.authority,i,e,t,void 0,void 0,void 0,r)}handleFragmentResponse(e,t){if(new Jd(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw mt(PP);return e}getLogoutUri(e){if(!e)throw xi(VP);const t=this.createLogoutUrlQueryString(e);return Zn.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){var c,h;(c=this.performanceClient)==null||c.addQueueMeasurement(Ae.AuthClientExecuteTokenRequest,t.correlationId);const i=this.createTokenQueryParameters(t),s=Zn.appendQueryString(e.tokenEndpoint,i),r=await pt(this.createTokenRequestBody.bind(this),Ae.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);let a;if(t.clientInfo)try{const u=K3(t.clientInfo,this.cryptoUtils.base64Decode);a={credential:`${u.uid}${Cr.CLIENT_INFO_SEPARATOR}${u.utid}`,type:Ga.HOME_ACCOUNT_ID}}catch(u){this.logger.verbose("Could not parse client info for CCS Header: "+u)}const o=this.createTokenRequestHeaders(a||t.ccsCredential),l={clientId:((h=t.tokenBodyParameters)==null?void 0:h.clientId)||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return pt(this.executePostToTokenEndpoint.bind(this),Ae.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(s,r,o,l,t.correlationId,Ae.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var s,r;(s=this.performanceClient)==null||s.addQueueMeasurement(Ae.AuthClientCreateTokenRequestBody,e.correlationId);const t=new Cp(e.correlationId,this.performanceClient);if(t.addClientId(e.embeddedClientId||((r=e.tokenBodyParameters)==null?void 0:r[Yd])||this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):Pf.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.oidcDefaultScopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!M6(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;t.addClientAssertion(await lN(a.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(a.assertionType)}if(t.addGrantType(pP.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme===fi.POP){const a=new Og(this.cryptoUtils,this.performanceClient);let o;e.popKid?o=this.cryptoUtils.encodeKid(e.popKid):o=(await pt(a.generateCnf.bind(a),Ae.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(o)}else if(e.authenticationScheme===fi.SSH)if(e.sshJwk)t.addSshJwk(e.sshJwk);else throw xi(py);(!ec.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities);let i;if(e.clientInfo)try{const a=K3(e.clientInfo,this.cryptoUtils.base64Decode);i={credential:`${a.uid}${Cr.CLIENT_INFO_SEPARATOR}${a.utid}`,type:Ga.HOME_ACCOUNT_ID}}catch(a){this.logger.verbose("Could not parse client info for CCS Header: "+a)}else i=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&i)switch(i.type){case Ga.HOME_ACCOUNT_ID:try{const a=Bf(i.credential);t.addCcsOid(a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case Ga.UPN:t.addCcsUpn(i.credential);break}return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[OC])&&t.addExtraQueryParameters({[OC]:"1"}),t.createQueryString()}async createAuthCodeUrlQueryString(e){var r,a,o,l,c,h,u,d,f,g;const t=e.correlationId||this.config.cryptoInterface.createNewGuid();(r=this.performanceClient)==null||r.addQueueMeasurement(Ae.AuthClientCreateQueryString,t);const i=new Cp(t,this.performanceClient);i.addClientId(e.embeddedClientId||((a=e.extraQueryParameters)==null?void 0:a[Yd])||this.config.authOptions.clientId);const s=[...e.scopes||[],...e.extraScopesToConsent||[]];if(i.addScopes(s,!0,this.oidcDefaultScopes),i.addRedirectUri(e.redirectUri),i.addCorrelationId(t),i.addResponseMode(e.responseMode),i.addResponseTypeCode(),i.addLibraryInfo(this.config.libraryInfo),M6(this.config)||i.addApplicationTelemetry(this.config.telemetry.application),i.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&i.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&i.addPrompt(e.prompt),e.domainHint&&(i.addDomainHint(e.domainHint),(o=this.performanceClient)==null||o.addFields({domainHintFromRequest:!0},t)),(l=this.performanceClient)==null||l.addFields({prompt:e.prompt},t),e.prompt!==Fs.SELECT_ACCOUNT)if(e.sid&&e.prompt===Fs.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),i.addSid(e.sid),(c=this.performanceClient)==null||c.addFields({sidFromRequest:!0},t);else if(e.account){const m=this.extractAccountSid(e.account);let x=this.extractLoginHint(e.account);if(x&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),x=null),x){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),i.addLoginHint(x),(h=this.performanceClient)==null||h.addFields({loginHintFromClaim:!0},t);try{const p=Bf(e.account.homeAccountId);i.addCcsOid(p)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(m&&e.prompt===Fs.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),i.addSid(m),(u=this.performanceClient)==null||u.addFields({sidFromClaim:!0},t);try{const p=Bf(e.account.homeAccountId);i.addCcsOid(p)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),i.addLoginHint(e.loginHint),i.addCcsUpn(e.loginHint),(d=this.performanceClient)==null||d.addFields({loginHintFromRequest:!0},t);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),i.addLoginHint(e.account.username),(f=this.performanceClient)==null||f.addFields({loginHintFromUpn:!0},t);try{const p=Bf(e.account.homeAccountId);i.addCcsOid(p)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),i.addLoginHint(e.loginHint),i.addCcsUpn(e.loginHint),(g=this.performanceClient)==null||g.addFields({loginHintFromRequest:!0},t));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&i.addNonce(e.nonce),e.state&&i.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&i.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.embeddedClientId&&i.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),this.addExtraQueryParams(e,i),e.platformBroker&&(i.addNativeBroker(),e.authenticationScheme===fi.POP)){const m=new Og(this.cryptoUtils);let x;e.popKid?x=this.cryptoUtils.encodeKid(e.popKid):x=(await pt(m.generateCnf.bind(m),Ae.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,i.addPopToken(x)}return i.createQueryString()}createLogoutUrlQueryString(e){const t=new Cp(e.correlationId,this.performanceClient);return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}addExtraQueryParams(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){var t;return((t=e.idTokenClaims)==null?void 0:t.sid)||null}extractLoginHint(e){var t;return((t=e.idTokenClaims)==null?void 0:t.login_hint)||null}}/*! @azure/msal-common v15.2.0 2025-02-18 */const dQ=300;class fQ extends mv{constructor(e,t){super(e,t)}async acquireToken(e){var a,o;(a=this.performanceClient)==null||a.addQueueMeasurement(Ae.RefreshTokenClientAcquireToken,e.correlationId);const t=rc(),i=await pt(this.executeTokenRequest.bind(this),Ae.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),s=(o=i.headers)==null?void 0:o[zr.X_MS_REQUEST_ID],r=new Jd(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return r.validateTokenResponse(i.body),pt(r.handleServerTokenResponse.bind(r),Ae.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(i.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,s)}async acquireTokenByRefreshToken(e){var i;if(!e)throw xi(GP);if((i=this.performanceClient)==null||i.addQueueMeasurement(Ae.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw mt($4);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await pt(this.acquireTokenWithCachedRefreshToken.bind(this),Ae.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(s){const r=s instanceof sl&&s.errorCode===J3,a=s instanceof Uh&&s.errorCode===_C.INVALID_GRANT_ERROR&&s.subError===_C.CLIENT_MISMATCH_ERROR;if(r||a)return pt(this.acquireTokenWithCachedRefreshToken.bind(this),Ae.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw s}return pt(this.acquireTokenWithCachedRefreshToken.bind(this),Ae.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){var r,a,o;(r=this.performanceClient)==null||r.addQueueMeasurement(Ae.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const i=x0(this.cacheManager.getRefreshToken.bind(this.cacheManager),Ae.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!i)throw N6(J3);if(i.expiresOn&&T6(i.expiresOn,e.refreshTokenExpirationOffsetSeconds||dQ))throw(a=this.performanceClient)==null||a.addFields({rtExpiresOnMs:Number(i.expiresOn)},e.correlationId),N6(pv);const s={...e,refreshToken:i.secret,authenticationScheme:e.authenticationScheme||fi.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Ga.HOME_ACCOUNT_ID}};try{return await pt(this.acquireToken.bind(this),Ae.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(s)}catch(l){if(l instanceof sl&&((o=this.performanceClient)==null||o.addFields({rtExpiresOnMs:Number(i.expiresOn)},e.correlationId),l.subError===yy)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const c=kp(i);this.cacheManager.removeRefreshToken(c)}throw l}}async executeTokenRequest(e,t){var l,c;(l=this.performanceClient)==null||l.addQueueMeasurement(Ae.RefreshTokenClientExecuteTokenRequest,e.correlationId);const i=this.createTokenQueryParameters(e),s=Zn.appendQueryString(t.tokenEndpoint,i),r=await pt(this.createTokenRequestBody.bind(this),Ae.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),a=this.createTokenRequestHeaders(e.ccsCredential),o={clientId:((c=e.tokenBodyParameters)==null?void 0:c.clientId)||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return pt(this.executePostToTokenEndpoint.bind(this),Ae.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(s,r,a,o,e.correlationId,Ae.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var s,r,a;(s=this.performanceClient)==null||s.addQueueMeasurement(Ae.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const t=e.correlationId,i=new Cp(t,this.performanceClient);if(i.addClientId(e.embeddedClientId||((r=e.tokenBodyParameters)==null?void 0:r[Yd])||this.config.authOptions.clientId),e.redirectUri&&i.addRedirectUri(e.redirectUri),i.addScopes(e.scopes,!0,(a=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:a.defaultScopes),i.addGrantType(pP.REFRESH_TOKEN_GRANT),i.addClientInfo(),i.addLibraryInfo(this.config.libraryInfo),i.addApplicationTelemetry(this.config.telemetry.application),i.addThrottling(),this.serverTelemetryManager&&!M6(this.config)&&i.addServerTelemetry(this.serverTelemetryManager),i.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&i.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const o=this.config.clientCredentials.clientAssertion;i.addClientAssertion(await lN(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),i.addClientAssertionType(o.assertionType)}if(e.authenticationScheme===fi.POP){const o=new Og(this.cryptoUtils,this.performanceClient);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await pt(o.generateCnf.bind(o),Ae.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,i.addPopToken(l)}else if(e.authenticationScheme===fi.SSH)if(e.sshJwk)i.addSshJwk(e.sshJwk);else throw xi(py);if((!ec.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&i.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Ga.HOME_ACCOUNT_ID:try{const o=Bf(e.ccsCredential.credential);i.addCcsOid(o)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case Ga.UPN:i.addCcsUpn(e.ccsCredential.credential);break}return e.embeddedClientId&&i.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&i.addExtraQueryParameters(e.tokenBodyParameters),i.createQueryString()}}/*! @azure/msal-common v15.2.0 2025-02-18 */class gQ extends mv{constructor(e,t){super(e,t)}async acquireCachedToken(e){var l;(l=this.performanceClient)==null||l.addQueueMeasurement(Ae.SilentFlowClientAcquireCachedToken,e.correlationId);let t=lu.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!ec.isEmptyObj(e.claims))throw this.setCacheOutcome(lu.FORCE_REFRESH_OR_CLAIMS,e.correlationId),mt(Ph);if(!e.account)throw mt($4);const i=e.account.tenantId||nQ(e.authority),s=this.cacheManager.getTokenKeys(),r=this.cacheManager.getAccessToken(e.account,e,s,i,this.performanceClient,e.correlationId);if(r){if(UJ(r.cachedAt)||T6(r.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(lu.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),mt(Ph);r.refreshOn&&T6(r.refreshOn,0)&&(t=lu.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(lu.NO_CACHED_ACCESS_TOKEN,e.correlationId),mt(Ph);const a=e.authority||this.authority.getPreferredCache(),o={account:this.cacheManager.readAccountFromCache(e.account),accessToken:r,idToken:this.cacheManager.getIdToken(e.account,s,i,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await pt(this.generateResultFromCacheRecord.bind(this),Ae.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(o,e),t]}setCacheOutcome(e,t){var i,s;(i=this.serverTelemetryManager)==null||i.setCacheOutcome(e),(s=this.performanceClient)==null||s.addFields({cacheOutcome:e},t),e!==lu.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(Ae.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let i;if(e.idToken&&(i=Yg(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){const r=i==null?void 0:i.auth_time;if(!r)throw mt(Q4);LP(r,t.maxAge)}return Jd.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,i)}}/*! @azure/msal-common v15.2.0 2025-02-18 */const mQ={sendGetRequestAsync:()=>Promise.reject(mt(Pn)),sendPostRequestAsync:()=>Promise.reject(mt(Pn))};/*! @azure/msal-common v15.2.0 2025-02-18 */const BC=",",hN="|";function pQ(n){const{skus:e,libraryName:t,libraryVersion:i,extensionName:s,extensionVersion:r}=n,a=new Map([[0,[t,i]],[2,[s,r]]]);let o=[];if(e!=null&&e.length){if(o=e.split(BC),o.length<4)return e}else o=Array.from({length:4},()=>hN);return a.forEach((l,c)=>{var h,u;l.length===2&&((h=l[0])!=null&&h.length)&&((u=l[1])!=null&&u.length)&&bQ({skuArr:o,index:c,skuName:l[0],skuVersion:l[1]})}),o.join(BC)}function bQ(n){const{skuArr:e,index:t,skuName:i,skuVersion:s}=n;t>=e.length||(e[t]=[i,s].join(hN))}class t2{constructor(e,t){this.cacheOutcome=lu.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||Ke.EMPTY_STRING,this.wrapperVer=e.wrapperVer||Ke.EMPTY_STRING,this.telemetryCacheKey=Qs.CACHE_KEY+Cr.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${Qs.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],i=this.getNativeBrokerErrorCode();i!=null&&i.length&&t.push(`broker_error=${i}`);const s=t.join(Qs.VALUE_SEPARATOR),r=this.getRegionDiscoveryFields(),a=[e,r].join(Qs.VALUE_SEPARATOR);return[Qs.SCHEMA_VERSION,a,s].join(Qs.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=t2.maxErrorsToSend(e),i=e.failedRequests.slice(0,2*t).join(Qs.VALUE_SEPARATOR),s=e.errors.slice(0,t).join(Qs.VALUE_SEPARATOR),r=e.errors.length,a=t<r?Qs.OVERFLOW_TRUE:Qs.OVERFLOW_FALSE,o=[r,a].join(Qs.VALUE_SEPARATOR);return[Qs.SCHEMA_VERSION,e.cacheHits,i,s,o].join(Qs.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=Qs.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof Bi?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(Qs.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){const e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){const e=this.getLastRequests(),t=t2.maxErrorsToSend(e),i=e.errors.length;if(t===i)this.cacheManager.removeItem(this.telemetryCacheKey);else{const s={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,s)}}static maxErrorsToSend(e){let t,i=0,s=0;const r=e.errors.length;for(t=0;t<r;t++){const a=e.failedRequests[2*t]||Ke.EMPTY_STRING,o=e.failedRequests[2*t+1]||Ke.EMPTY_STRING,l=e.errors[t]||Ke.EMPTY_STRING;if(s+=a.toString().length+o.toString().length+l.length+3,s<Qs.MAX_LAST_HEADER_BYTES)i+=1;else break}return i}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||Ke.EMPTY_STRING),e.push(this.regionSource||Ke.EMPTY_STRING),e.push(this.regionOutcome||Ke.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return pQ(e)}}/*! @azure/msal-common v15.2.0 2025-02-18 */const uN="missing_kid_error",dN="missing_alg_error";/*! @azure/msal-common v15.2.0 2025-02-18 */const xQ={[uN]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[dN]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class xv extends Bi{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,xv.prototype)}}function UC(n){return new xv(n,xQ[n])}/*! @azure/msal-common v15.2.0 2025-02-18 */class yv{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw UC(uN);if(!e.alg)throw UC(dN);const t=new yv({typ:e.typ||kJ.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}/*! @azure/msal-common v15.2.0 2025-02-18 */class HC{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class yQ{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:tQ.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new HC}}startPerformanceMeasurement(){return new HC}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const wv="pkce_not_created",O6="crypto_nonexistent",wy="empty_navigate_uri",fN="hash_empty_error",vv="no_state_in_hash",gN="hash_does_not_contain_known_properties",mN="unable_to_parse_state",pN="state_interaction_type_mismatch",bN="interaction_in_progress",xN="popup_window_error",yN="empty_window_error",Zd="user_cancelled",wQ="monitor_popup_timeout",wN="monitor_window_timeout",vN="redirect_in_iframe",_N="block_iframe_reload",kN="block_nested_popups",vQ="iframe_closed_prematurely",vy="silent_logout_unsupported",CN="no_account_error",_Q="silent_prompt_value_error",AN="no_token_request_cache_error",SN="unable_to_parse_token_request_cache_error",_v="no_cached_authority_error",kQ="auth_request_not_set_error",CQ="invalid_cache_type",_y="non_browser_environment",Nf="database_not_open",Z3="no_network_connectivity",IN="post_request_failed",EN="get_request_failed",D6="failed_to_parse_response",TN="unable_to_load_token",kv="crypto_key_not_found",RN="auth_code_required",MN="auth_code_or_nativeAccountId_required",PN="spa_code_and_nativeAccountId_present",Cv="database_unavailable",NN="unable_to_acquire_token_from_native_platform",ON="native_handshake_timeout",DN="native_extension_not_installed",yx="native_connection_not_established",Q3="uninitialized_public_client_application",LN="native_prompt_not_supported",FN="invalid_base64_string",BN="invalid_pop_token_request",UN="failed_to_build_headers",HN="failed_to_parse_headers";/*! @azure/msal-browser v4.5.0 2025-02-26 */const cc="For more visit: aka.ms/msaljs/browser-errors",AQ={[wv]:"The PKCE code challenge and verifier could not be generated.",[O6]:"The crypto object or function is not available.",[wy]:"Navigation URI is empty. Please check stack trace for more info.",[fN]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${cc}`,[vv]:"Hash does not contain state. Please verify that the request originated from msal.",[gN]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${cc}`,[mN]:"Unable to parse state. Please verify that the request originated from msal.",[pN]:"Hash contains state but the interaction type does not match the caller.",[bN]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${cc}`,[xN]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[yN]:"window.open returned null or undefined window object.",[Zd]:"User cancelled the flow.",[wQ]:`Token acquisition in popup failed due to timeout.  ${cc}`,[wN]:`Token acquisition in iframe failed due to timeout.  ${cc}`,[vN]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[_N]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${cc}`,[kN]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[vQ]:"The iframe being monitored was closed prematurely.",[vy]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[CN]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[_Q]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[AN]:"No token request found in cache.",[SN]:"The cached token request could not be parsed.",[_v]:"No cached authority found.",[kQ]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[CQ]:"Invalid cache type",[_y]:"Login and token requests are not supported in non-browser environments.",[Nf]:"Database is not open!",[Z3]:"No network connectivity. Check your internet connection.",[IN]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[EN]:"Network request failed. Please check the network trace to determine root cause.",[D6]:"Failed to parse network response. Check network trace.",[TN]:"Error loading token to cache.",[kv]:"Cryptographic Key or Keypair not found in browser storage.",[RN]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[MN]:"An authorization code or nativeAccountId must be provided to this flow.",[PN]:"Request cannot contain both spa code and native account id.",[Cv]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[NN]:`Unable to acquire token from native platform.  ${cc}`,[ON]:"Timed out while attempting to establish connection to browser extension",[DN]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[yx]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${cc}`,[Q3]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${cc}`,[LN]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[FN]:"Invalid base64 encoded string.",[BN]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[UN]:"Failed to build request headers object.",[HN]:"Failed to parse response headers"};class wx extends Bi{constructor(e,t){super(e,AQ[e],t),Object.setPrototypeOf(this,wx.prototype),this.name="BrowserAuthError"}}function Ft(n,e){return new wx(n,e)}/*! @azure/msal-browser v4.5.0 2025-02-26 */const Ha={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},Uf={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},yu={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},hr={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},zC={GET:"GET",POST:"POST"},li={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},Th={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},h9={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},Si={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var nn;(function(n){n.Redirect="redirect",n.Popup="popup",n.Silent="silent",n.None="none"})(nn||(nn={}));const jC={scopes:bx},zN="jwk",L6="msal.db",SQ=1,IQ=`${L6}.keys`,ya={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},EQ=[ya.Default,ya.Skip,ya.RefreshTokenAndNetwork],TQ="msal.browser.log.level",RQ="msal.browser.log.pii";/*! @azure/msal-browser v4.5.0 2025-02-26 */function u9(n){return encodeURIComponent(Av(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Qd(n){return jN(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Av(n){return jN(new TextEncoder().encode(n))}function jN(n){const e=Array.from(n,t=>String.fromCodePoint(t)).join("");return btoa(e)}/*! @azure/msal-browser v4.5.0 2025-02-26 */function l0(n){return new TextDecoder().decode($3(n))}function $3(n){let e=n.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw Ft(FN)}const t=atob(e);return Uint8Array.from(t,i=>i.codePointAt(0)||0)}/*! @azure/msal-browser v4.5.0 2025-02-26 */const MQ="RSASSA-PKCS1-v1_5",ky="AES-GCM",GN="HKDF",Sv="SHA-256",PQ=2048,NQ=new Uint8Array([1,0,1]),GC="0123456789abcdef",VC=new Uint32Array(1),VN="raw",qN="encrypt",WN="decrypt",OQ="deriveKey",DQ="crypto_subtle_undefined",Iv={name:MQ,hash:Sv,modulusLength:PQ,publicExponent:NQ};function LQ(n){if(!window)throw Ft(_y);if(!window.crypto)throw Ft(O6);if(!n&&!window.crypto.subtle)throw Ft(O6,DQ)}async function KN(n,e,t){e==null||e.addQueueMeasurement(Ae.Sha256Digest,t);const s=new TextEncoder().encode(n);return window.crypto.subtle.digest(Sv,s)}function FQ(n){return window.crypto.getRandomValues(n)}function jw(){return window.crypto.getRandomValues(VC),VC[0]}function rl(){const n=Date.now(),e=jw()*1024+(jw()&1023),t=new Uint8Array(16),i=Math.trunc(e/2**30),s=e&2**30-1,r=jw();t[0]=n/2**40,t[1]=n/2**32,t[2]=n/2**24,t[3]=n/2**16,t[4]=n/2**8,t[5]=n,t[6]=112|i>>>8,t[7]=i,t[8]=128|s>>>24,t[9]=s>>>16,t[10]=s>>>8,t[11]=s,t[12]=r>>>24,t[13]=r>>>16,t[14]=r>>>8,t[15]=r;let a="";for(let o=0;o<t.length;o++)a+=GC.charAt(t[o]>>>4),a+=GC.charAt(t[o]&15),(o===3||o===5||o===7||o===9)&&(a+="-");return a}async function BQ(n,e){return window.crypto.subtle.generateKey(Iv,n,e)}async function Gw(n){return window.crypto.subtle.exportKey(zN,n)}async function UQ(n,e,t){return window.crypto.subtle.importKey(zN,n,Iv,e,t)}async function HQ(n,e){return window.crypto.subtle.sign(Iv,n,e)}async function zQ(){const n=await window.crypto.subtle.generateKey({name:ky,length:256},!0,[qN,WN]);return window.crypto.subtle.exportKey(VN,n)}async function qC(n){return window.crypto.subtle.importKey(VN,n,GN,!1,[OQ])}async function XN(n,e,t){return window.crypto.subtle.deriveKey({name:GN,salt:e,hash:Sv,info:new TextEncoder().encode(t)},n,{name:ky,length:256},!1,[qN,WN])}async function jQ(n,e,t){const i=new TextEncoder().encode(e),s=window.crypto.getRandomValues(new Uint8Array(16)),r=await XN(n,s,t),a=await window.crypto.subtle.encrypt({name:ky,iv:new Uint8Array(12)},r,i);return{data:Qd(new Uint8Array(a)),nonce:Qd(s)}}async function GQ(n,e,t,i){const s=$3(i),r=await XN(n,$3(e),t),a=await window.crypto.subtle.decrypt({name:ky,iv:new Uint8Array(12)},r,s);return new TextDecoder().decode(a)}async function YN(n){const e=await KN(n),t=new Uint8Array(e);return Qd(t)}/*! @azure/msal-browser v4.5.0 2025-02-26 */const n2="storage_not_supported",F6="stubbed_public_client_application_called",e5="in_mem_redirect_unavailable";/*! @azure/msal-browser v4.5.0 2025-02-26 */const l3={[n2]:"Given storage configuration option was not supported.",[F6]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[e5]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};l3[n2],l3[F6],l3[e5];class Ev extends Bi{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,Ev.prototype)}}function Tv(n){return new Ev(n,l3[n])}/*! @azure/msal-browser v4.5.0 2025-02-26 */function VQ(n){n.location.hash="",typeof n.history.replaceState=="function"&&n.history.replaceState(null,"",`${n.location.origin}${n.location.pathname}${n.location.search}`)}function qQ(n){const e=n.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function Rv(){return window.parent!==window}function WQ(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${Ha.POPUP_NAME_PREFIX}.`)===0}function t0(){return typeof window<"u"&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function KQ(){const e=new Zn(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function XQ(){if(Zn.hashContainsKnownProperties(window.location.hash)&&Rv())throw Ft(_N)}function YQ(n){if(Rv()&&!n)throw Ft(vN)}function JQ(){if(WQ())throw Ft(kN)}function JN(){if(typeof window>"u")throw Ft(_y)}function ZN(n){if(!n)throw Ft(Q3)}function Mv(n){JN(),XQ(),JQ(),ZN(n)}function WC(n,e){if(Mv(n),YQ(e.system.allowRedirectInIframe),e.cache.cacheLocation===hr.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw Tv(e5)}function QN(n){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(n).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function ZQ(){return rl()}/*! @azure/msal-browser v4.5.0 2025-02-26 */class t5{navigateInternal(e,t){return t5.defaultNavigateWindow(e,t)}navigateExternal(e,t){return t5.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(i=>{setTimeout(()=>{i(!0)},t.timeout)})}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class QQ{async sendGetRequestAsync(e,t){let i,s={},r=0;const a=KC(t);try{i=await fetch(e,{method:zC.GET,headers:a})}catch{throw Ft(window.navigator.onLine?EN:Z3)}s=XC(i.headers);try{return r=i.status,{headers:s,body:await i.json(),status:r}}catch{throw DC(Ft(D6),r,s)}}async sendPostRequestAsync(e,t){const i=t&&t.body||"",s=KC(t);let r,a=0,o={};try{r=await fetch(e,{method:zC.POST,headers:s,body:i})}catch{throw Ft(window.navigator.onLine?IN:Z3)}o=XC(r.headers);try{return a=r.status,{headers:o,body:await r.json(),status:a}}catch{throw DC(Ft(D6),a,o)}}}function KC(n){try{const e=new Headers;if(!(n&&n.headers))return e;const t=n.headers;return Object.entries(t).forEach(([i,s])=>{e.append(i,s)}),e}catch{throw Ft(UN)}}function XC(n){try{const e={};return n.forEach((t,i)=>{e[i]=t}),e}catch{throw Ft(HN)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const $Q=6e4,B6=1e4,e$=3e4,t$=2e3;function n$({auth:n,cache:e,system:t,telemetry:i},s){const r={clientId:Ke.EMPTY_STRING,authority:`${Ke.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:Ke.EMPTY_STRING,authorityMetadata:Ke.EMPTY_STRING,redirectUri:typeof window<"u"?t0():"",postLogoutRedirectUri:Ke.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:o0.AAD,OIDCOptions:{serverResponseType:xx.FRAGMENT,defaultScopes:[Ke.OPENID_SCOPE,Ke.PROFILE_SCOPE,Ke.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:sv.None,tenant:Ke.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},a={cacheLocation:hr.SessionStorage,temporaryCacheLocation:hr.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===hr.LocalStorage),claimsBasedCachingEnabled:!1},o={loggerCallback:()=>{},logLevel:Pi.Info,piiLoggingEnabled:!1},c={...{...iN,loggerOptions:o,networkClient:s?new QQ:mQ,navigationClient:new t5,loadFrameTimeout:0,windowHashTimeout:(t==null?void 0:t.loadFrameTimeout)||$Q,iframeHashTimeout:(t==null?void 0:t.loadFrameTimeout)||B6,navigateFrameWait:0,redirectNavigationTimeout:e$,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:(t==null?void 0:t.nativeBrokerHandshakeTimeout)||t$,pollIntervalMilliseconds:Ha.DEFAULT_POLL_INTERVAL_MS},...t,loggerOptions:(t==null?void 0:t.loggerOptions)||o},h={application:{appName:Ke.EMPTY_STRING,appVersion:Ke.EMPTY_STRING},client:new yQ};if((n==null?void 0:n.protocolMode)!==o0.OIDC&&(n!=null&&n.OIDCOptions)&&new Bh(c.loggerOptions).warning(JSON.stringify(xi(YP))),n!=null&&n.protocolMode&&n.protocolMode!==o0.AAD&&(c!=null&&c.allowPlatformBroker))throw xi(JP);return{auth:{...r,...n,OIDCOptions:{...r.OIDCOptions,...n==null?void 0:n.OIDCOptions}},cache:{...a,...e},system:c,telemetry:{...h,...i}}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const i$="@azure/msal-browser",Cy="4.5.0";/*! @azure/msal-browser v4.5.0 2025-02-26 */class Pv{static loggerCallback(e,t){switch(e){case Pi.Error:console.error(t);return;case Pi.Info:console.info(t);return;case Pi.Verbose:return;case Pi.Warning:console.warn(t);return;default:return}}constructor(e){var l;this.browserEnvironment=typeof window<"u",this.config=n$(e,this.browserEnvironment);let t;try{t=window[hr.SessionStorage]}catch{}const i=t==null?void 0:t.getItem(TQ),s=(l=t==null?void 0:t.getItem(RQ))==null?void 0:l.toLowerCase(),r=s==="true"?!0:s==="false"?!1:void 0,a={...this.config.system.loggerOptions},o=i&&Object.keys(Pi).includes(i)?Pi[i]:void 0;o&&(a.loggerCallback=Pv.loggerCallback,a.logLevel=o),r!==void 0&&(a.piiLoggingEnabled=r),this.logger=new Bh(a,i$,Cy),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class $d extends Pv{getModuleName(){return $d.MODULE_NAME}getId(){return $d.ID}async initialize(){return this.available=typeof window<"u",this.available}}$d.MODULE_NAME="";$d.ID="StandardOperatingContext";/*! @azure/msal-browser v4.5.0 2025-02-26 */class s${constructor(){this.dbName=L6,this.version=SQ,this.tableName=IQ,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const i=window.indexedDB.open(this.dbName,this.version);i.addEventListener("upgradeneeded",s=>{s.target.result.createObjectStore(this.tableName)}),i.addEventListener("success",s=>{const r=s;this.db=r.target.result,this.dbOpen=!0,e()}),i.addEventListener("error",()=>t(Ft(Cv)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,i)=>{if(!this.db)return i(Ft(Nf));const a=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);a.addEventListener("success",o=>{const l=o;this.closeConnection(),t(l.target.result)}),a.addEventListener("error",o=>{this.closeConnection(),i(o)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((i,s)=>{if(!this.db)return s(Ft(Nf));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);o.addEventListener("success",()=>{this.closeConnection(),i()}),o.addEventListener("error",l=>{this.closeConnection(),s(l)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,i)=>{if(!this.db)return i(Ft(Nf));const a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);a.addEventListener("success",()=>{this.closeConnection(),t()}),a.addEventListener("error",o=>{this.closeConnection(),i(o)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(Ft(Nf));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();r.addEventListener("success",a=>{const o=a;this.closeConnection(),e(o.target.result)}),r.addEventListener("error",a=>{this.closeConnection(),t(a)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,i)=>{if(!this.db)return i(Ft(Nf));const a=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);a.addEventListener("success",o=>{const l=o;this.closeConnection(),t(l.target.result===1)}),a.addEventListener("error",o=>{this.closeConnection(),i(o)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const i=window.indexedDB.deleteDatabase(L6),s=setTimeout(()=>t(!1),200);i.addEventListener("success",()=>(clearTimeout(s),e(!0))),i.addEventListener("blocked",()=>(clearTimeout(s),e(!0))),i.addEventListener("error",()=>(clearTimeout(s),t(!1)))})}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class Ay{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,i)=>{e.push(i)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class r${constructor(e){this.inMemoryCache=new Ay,this.indexedDBCache=new s$,this.logger=e}handleDatabaseAccessError(e){if(e instanceof wx&&e.errorCode===Cv)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(i){this.handleDatabaseAccessError(i)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(i){this.handleDatabaseAccessError(i)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(i){this.handleDatabaseAccessError(i)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class Dg{constructor(e,t,i){this.logger=e,LQ(i??!1),this.cache=new r$(this.logger),this.performanceClient=t}createNewGuid(){return rl()}base64Encode(e){return Av(e)}base64Decode(e){return l0(e)}base64UrlEncode(e){return u9(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){var h;const t=(h=this.performanceClient)==null?void 0:h.startMeasurement(Ae.CryptoOptsGetPublicKeyThumbprint,e.correlationId),i=await BQ(Dg.EXTRACTABLE,Dg.POP_KEY_USAGES),s=await Gw(i.publicKey),r={e:s.e,kty:s.kty,n:s.n},a=YC(r),o=await this.hashString(a),l=await Gw(i.privateKey),c=await UQ(l,!1,["sign"]);return await this.cache.setItem(o,{privateKey:c,publicKey:i.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),o}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,i,s){var w;const r=(w=this.performanceClient)==null?void 0:w.startMeasurement(Ae.CryptoOptsSignJwt,s),a=await this.cache.getItem(t);if(!a)throw Ft(kv);const o=await Gw(a.publicKey),l=YC(o),c=u9(JSON.stringify({kid:t})),h=yv.getShrHeaderString({...i==null?void 0:i.header,alg:o.alg,kid:c}),u=u9(h);e.cnf={jwk:JSON.parse(l)};const d=u9(JSON.stringify(e)),f=`${u}.${d}`,m=new TextEncoder().encode(f),x=await HQ(a.privateKey,m),p=Qd(new Uint8Array(x)),y=`${f}.${p}`;return r&&r.end({success:!0}),y}async hashString(e){return YN(e)}}Dg.POP_KEY_USAGES=["sign","verify"];Dg.EXTRACTABLE=!0;function YC(n){return JSON.stringify(n,Object.keys(n).sort())}/*! @azure/msal-browser v4.5.0 2025-02-26 */const a$=24*60*60*1e3,U6={Lax:"Lax",None:"None"};class $N{initialize(){return Promise.resolve()}getItem(e){const t=`${encodeURIComponent(e)}`,i=document.cookie.split(";");for(let s=0;s<i.length;s++){const r=i[s],[a,...o]=decodeURIComponent(r).trim().split("="),l=o.join("=");if(a===t)return l}return""}getUserData(){throw mt(Pn)}setItem(e,t,i,s=!0,r=U6.Lax){let a=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=${r};`;if(i){const o=o$(i);a+=`expires=${o};`}(s||r===U6.None)&&(a+="Secure;"),document.cookie=a}async setUserData(){return Promise.reject(mt(Pn))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(i=>{const s=decodeURIComponent(i).trim().split("=");t.push(s[0])}),t}containsKey(e){return this.getKeys().includes(e)}}function o$(n){const e=new Date;return new Date(e.getTime()+n*a$).toUTCString()}/*! @azure/msal-browser v4.5.0 2025-02-26 */function H6(n){const e=n.getItem(Th.ACCOUNT_KEYS);return e?JSON.parse(e):[]}function z6(n,e){const t=e.getItem(`${Th.TOKEN_KEYS}.${n}`);if(t){const i=JSON.parse(t);if(i&&i.hasOwnProperty("idToken")&&i.hasOwnProperty("accessToken")&&i.hasOwnProperty("refreshToken"))return i}return{idToken:[],accessToken:[],refreshToken:[]}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const JC="msal.cache.encryption",l$="msal.broadcast.cache";class c${constructor(e,t,i){if(!window.localStorage)throw Tv(n2);this.memoryStorage=new Ay,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=i,this.broadcast=new BroadcastChannel(l$)}async initialize(e){this.initialized=!0;const t=new $N,i=t.getItem(JC);let s={key:"",id:""};if(i)try{s=JSON.parse(i)}catch{}if(s.key&&s.id){const r=x0($3,Ae.Base64Decode,this.logger,this.performanceClient,e)(s.key);this.encryptionCookie={id:s.id,key:await pt(qC,Ae.GenerateHKDF,this.logger,this.performanceClient,e)(r)},await pt(this.importExistingCache.bind(this),Ae.ImportExistingCache,this.logger,this.performanceClient,e)(e)}else{this.clear();const r=rl(),a=await pt(zQ,Ae.GenerateBaseKey,this.logger,this.performanceClient,e)(),o=x0(Qd,Ae.UrlEncodeArr,this.logger,this.performanceClient,e)(new Uint8Array(a));this.encryptionCookie={id:r,key:await pt(qC,Ae.GenerateHKDF,this.logger,this.performanceClient,e)(a)};const l={id:r,key:o};t.setItem(JC,JSON.stringify(l),0,!0,U6.None)}this.broadcast.addEventListener("message",this.updateCache.bind(this))}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw Ft(Q3);return this.memoryStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,i){if(!this.initialized||!this.encryptionCookie)throw Ft(Q3);const{data:s,nonce:r}=await pt(jQ,Ae.Encrypt,this.logger,this.performanceClient,i)(this.encryptionCookie.key,t,this.getContext(e)),a={id:this.encryptionCookie.id,nonce:r,data:s};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(a)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear(),H6(this).forEach(i=>this.removeItem(i));const t=z6(this.clientId,this);t.idToken.forEach(i=>this.removeItem(i)),t.accessToken.forEach(i=>this.removeItem(i)),t.refreshToken.forEach(i=>this.removeItem(i)),this.getKeys().forEach(i=>{(i.startsWith(Ke.CACHE_PREFIX)||i.indexOf(this.clientId)!==-1)&&this.removeItem(i)})}async importExistingCache(e){if(!this.encryptionCookie)return;let t=H6(this);t=await this.importArray(t,e),this.setItem(Th.ACCOUNT_KEYS,JSON.stringify(t));const i=z6(this.clientId,this);i.idToken=await this.importArray(i.idToken,e),i.accessToken=await this.importArray(i.accessToken,e),i.refreshToken=await this.importArray(i.refreshToken,e),this.setItem(`${Th.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(i))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const i=this.getItem(e);if(!i)return null;let s;try{s=JSON.parse(i)}catch{return null}return!s.id||!s.nonce||!s.data?(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),null):s.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):pt(GQ,Ae.Decrypt,this.logger,this.performanceClient,t)(this.encryptionCookie.key,s.nonce,this.getContext(e),s.data)}async importArray(e,t){const i=[],s=[];return e.forEach(r=>{const a=this.getItemFromEncryptedCache(r,t).then(o=>{o?(this.memoryStorage.setItem(r,o),i.push(r)):this.removeItem(r)});s.push(a)}),await Promise.all(s),i}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(Ae.LocalStorageUpdated);t.add({isBackground:!0});const{key:i,value:s,context:r}=e.data;if(!i){this.logger.error("Broadcast event missing key"),t.end({success:!1,errorCode:"noKey"});return}if(r&&r!==this.clientId){this.logger.trace(`Ignoring broadcast event from clientId: ${r}`),t.end({success:!1,errorCode:"contextMismatch"});return}s?(this.memoryStorage.setItem(i,s),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(i),this.logger.verbose("Removed item from internal cache")),t.end({success:!0})}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class h${constructor(){if(!window.sessionStorage)throw Tv(n2)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */function eO(n,e){if(!e)return null;try{return tl.parseRequestState(n,e).libraryState.meta}catch{throw mt(Ng)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const an={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};/*! @azure/msal-browser v4.5.0 2025-02-26 */class j6 extends R6{constructor(e,t,i,s,r,a,o){super(e,i,s,o),this.cacheConfig=t,this.logger=s,this.internalStorage=new Ay,this.browserStorage=ZC(e,t.cacheLocation,s,r),this.temporaryCacheStorage=ZC(e,t.temporaryCacheLocation,s,r),this.cookieStorage=new $N,this.performanceClient=r,this.eventHandler=a}async initialize(e){await this.browserStorage.initialize(e)}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&typeof t=="object"?t:null}catch{return null}}getAccount(e){this.logger.trace("BrowserCacheManager.getAccount called");const t=this.browserStorage.getUserData(e);if(!t)return this.removeAccountKeyFromMap(e),null;const i=this.validateAndParseJson(t);return!i||!Kr.isAccountEntity(i)?(this.removeAccountKeyFromMap(e),null):R6.toObject(new Kr,i)}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const i=e.generateAccountKey();await pt(this.browserStorage.setUserData.bind(this.browserStorage),Ae.SetUserData,this.logger,this.performanceClient)(i,JSON.stringify(e),t);const s=this.addAccountKeyToMap(i);this.cacheConfig.cacheLocation===hr.LocalStorage&&s&&this.eventHandler.emitEvent(an.ACCOUNT_ADDED,void 0,e.getAccountInfo())}getAccountKeys(){return H6(this.browserStorage)}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const t=this.getAccountKeys();return t.indexOf(e)===-1?(t.push(e),this.browserStorage.setItem(Th.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const t=this.getAccountKeys(),i=t.indexOf(e);i>-1?(t.splice(i,1),this.browserStorage.setItem(Th.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}async removeAccountContext(e){await super.removeAccountContext(e),this.cacheConfig.cacheLocation===hr.LocalStorage&&this.eventHandler.emitEvent(an.ACCOUNT_REMOVED,void 0,e.getAccountInfo())}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,An.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,An.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,An.REFRESH_TOKEN)}getTokenKeys(){return z6(this.clientId,this.browserStorage)}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");const i=this.getTokenKeys();switch(t){case An.ID_TOKEN:i.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),i.idToken.push(e));break;case An.ACCESS_TOKEN:i.accessToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),i.accessToken.push(e));break;case An.REFRESH_TOKEN:i.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),i.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),mt(E6)}this.browserStorage.setItem(`${Th.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(i))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");const i=this.getTokenKeys();switch(t){case An.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const s=i.idToken.indexOf(e);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),i.idToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case An.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const r=i.accessToken.indexOf(e);r>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),i.accessToken.splice(r,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case An.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const a=i.refreshToken.indexOf(e);a>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),i.refreshToken.splice(a,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),mt(E6)}this.browserStorage.setItem(`${Th.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(i))}getIdTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.ID_TOKEN),null;const i=this.validateAndParseJson(t);return!i||!zJ(i)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.ID_TOKEN),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),i)}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const i=kp(e);await pt(this.browserStorage.setUserData.bind(this.browserStorage),Ae.SetUserData,this.logger,this.performanceClient)(i,JSON.stringify(e),t),this.addTokenKey(i,An.ID_TOKEN)}getAccessTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.ACCESS_TOKEN),null;const i=this.validateAndParseJson(t);return!i||!HJ(i)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.ACCESS_TOKEN),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),i)}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const i=kp(e);await pt(this.browserStorage.setUserData.bind(this.browserStorage),Ae.SetUserData,this.logger,this.performanceClient)(i,JSON.stringify(e),t),this.addTokenKey(i,An.ACCESS_TOKEN)}getRefreshTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.REFRESH_TOKEN),null;const i=this.validateAndParseJson(t);return!i||!jJ(i)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,An.REFRESH_TOKEN),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),i)}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const i=kp(e);await pt(this.browserStorage.setUserData.bind(this.browserStorage),Ae.SetUserData,this.logger,this.performanceClient)(i,JSON.stringify(e),t),this.addTokenKey(i,An.REFRESH_TOKEN)}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const i=this.validateAndParseJson(t);return!i||!ZJ(e,i)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),i)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const t=JJ(e);this.browserStorage.setItem(t,JSON.stringify(e))}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const i=this.validateAndParseJson(t);return!i||!XJ(e,i)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),i)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.browserStorage.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const i=this.validateAndParseJson(t);return i&&QJ(e,i)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),i):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(t=>this.isAuthorityMetadata(t))}setWrapperMetadata(e,t){this.internalStorage.setItem(h9.WRAPPER_SKU,e),this.internalStorage.setItem(h9.WRAPPER_VER,t)}getWrapperMetadata(){const e=this.internalStorage.getItem(h9.WRAPPER_SKU)||Ke.EMPTY_STRING,t=this.internalStorage.getItem(h9.WRAPPER_VER)||Ke.EMPTY_STRING;return[e,t]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){const e=this.generateCacheKey(wC.ACTIVE_ACCOUNT_FILTERS),t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const i=this.validateAndParseJson(t);return i?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:i.homeAccountId,localAccountId:i.localAccountId,tenantId:i.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const t=this.generateCacheKey(wC.ACTIVE_ACCOUNT_FILTERS);if(e){this.logger.verbose("setActiveAccount: Active account set");const i={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(i))}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t);this.eventHandler.emitEvent(an.ACTIVE_ACCOUNT_CHANGED)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const i=this.validateAndParseJson(t);return!i||!YJ(e,i)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),i)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.browserStorage.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){const i=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const r=this.cookieStorage.getItem(i);if(r)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),r}const s=this.temporaryCacheStorage.getItem(i);if(!s){if(this.cacheConfig.cacheLocation===hr.LocalStorage){const r=this.browserStorage.getItem(i);if(r)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),r}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),s}setTemporaryCache(e,t,i){const s=i?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(s,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(s,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach(e=>{(e.indexOf(Ke.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{(e.indexOf(Ke.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(e)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(Ae.ClearTokensAndKeysWithClaims,t);const i=this.getTokenKeys(),s=[];i.accessToken.forEach(r=>{const a=this.getAccessTokenCredential(r);a!=null&&a.requestedClaimsHash&&r.includes(a.requestedClaimsHash.toLowerCase())&&s.push(this.removeAccessToken(r))}),await Promise.all(s),s.length>0&&this.logger.warning(`${s.length} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):ec.startsWith(e,Ke.CACHE_PREFIX)?e:`${Ke.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:t}}=tl.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${li.AUTHORITY}.${t}`)}generateNonceKey(e){const{libraryState:{id:t}}=tl.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${li.NONCE_IDTOKEN}.${t}`)}generateStateKey(e){const{libraryState:{id:t}}=tl.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${li.REQUEST_STATE}.${t}`)}getCachedAuthority(e){const t=this.generateStateKey(e),i=this.getTemporaryCache(t);if(!i)return null;const s=this.generateAuthorityKey(i);return this.getTemporaryCache(s)}updateCacheEntries(e,t,i,s,r){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const a=this.generateStateKey(e);this.setTemporaryCache(a,e,!1);const o=this.generateNonceKey(e);this.setTemporaryCache(o,t,!1);const l=this.generateAuthorityKey(e);if(this.setTemporaryCache(l,i,!1),r){const c={credential:r.homeAccountId,type:Ga.HOME_ACCOUNT_ID};this.setTemporaryCache(li.CCS_CREDENTIAL,JSON.stringify(c),!0)}else if(s){const c={credential:s,type:Ga.UPN};this.setTemporaryCache(li.CCS_CREDENTIAL,JSON.stringify(c),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{t.indexOf(e)!==-1&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(li.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(li.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(li.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(li.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(li.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(li.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const t=this.generateStateKey(e),i=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${i}`),this.resetRequestCache(i||Ke.EMPTY_STRING)}}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(t.indexOf(li.REQUEST_STATE)===-1)return;const i=this.temporaryCacheStorage.getItem(t);if(!i)return;const s=eO(this.cryptoImpl,i);s&&s.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${i}`),this.resetRequestCache(i))}),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=Av(JSON.stringify(e));this.setTemporaryCache(li.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(li.REQUEST_PARAMS,!0);if(!t)throw Ft(AN);let i;try{i=JSON.parse(l0(t))}catch(s){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${s}`),Ft(SN)}if(this.removeTemporaryItem(this.generateCacheKey(li.REQUEST_PARAMS)),!i.authority){const s=this.generateAuthorityKey(e),r=this.getTemporaryCache(s);if(!r)throw Ft(_v);i.authority=r}return i}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(li.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${Ke.CACHE_PREFIX}.${li.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const t=`${Ke.CACHE_PREFIX}.${li.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw Ft(bN);this.setTemporaryCache(t,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(t)}async hydrateCache(e,t){var o,l,c;const i=gy((o=e.account)==null?void 0:o.homeAccountId,(l=e.account)==null?void 0:l.environment,e.idToken,this.clientId,e.tenantId);let s;t.claims&&(s=await this.cryptoImpl.hashString(t.claims));const r=my((c=e.account)==null?void 0:c.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,l0,void 0,e.tokenType,void 0,t.sshKid,t.claims,s),a={idToken:i,accessToken:r};return this.saveCacheRecord(a,e.correlationId)}async saveCacheRecord(e,t,i){try{await super.saveCacheRecord(e,t,i)}catch(s){if(s instanceof i1&&this.performanceClient&&t)try{const r=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:r.refreshToken.length,cacheIdCount:r.idToken.length,cacheAtCount:r.accessToken.length},t)}catch{}throw s}}}function ZC(n,e,t,i){try{switch(e){case hr.LocalStorage:return new c$(n,t,i);case hr.SessionStorage:return new h$;case hr.MemoryStorage:default:break}}catch(s){t.error(s)}return new Ay}const u$=(n,e,t,i)=>{const s={cacheLocation:hr.MemoryStorage,temporaryCacheLocation:hr.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new j6(n,s,W3,e,t,i)};/*! @azure/msal-browser v4.5.0 2025-02-26 */function d$(n,e,t,i){return n.verbose("getAllAccounts called"),t?e.getAllAccounts(i):[]}function f$(n,e,t){if(e.trace("getAccount called"),Object.keys(n).length===0)return e.warning("getAccount: No accountFilter provided"),null;const i=t.getAccountInfoFilteredBy(n);return i?(e.verbose("getAccount: Account matching provided filter found, returning"),i):(e.verbose("getAccount: No matching account found, returning null"),null)}function g$(n,e,t){if(e.trace("getAccountByUsername called"),!n)return e.warning("getAccountByUsername: No username provided"),null;const i=t.getAccountInfoFilteredBy({username:n});return i?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${n}`),i):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function m$(n,e,t){if(e.trace("getAccountByHomeId called"),!n)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const i=t.getAccountInfoFilteredBy({homeAccountId:n});return i?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${n}`),i):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function p$(n,e,t){if(e.trace("getAccountByLocalId called"),!n)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const i=t.getAccountInfoFilteredBy({localAccountId:n});return i?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${n}`),i):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function b$(n,e){e.setActiveAccount(n)}function x$(n){return n.getActiveAccount()}/*! @azure/msal-browser v4.5.0 2025-02-26 */const y$="msal.broadcast.event";class w${constructor(e){this.eventCallbacks=new Map,this.logger=e||new Bh({}),this.broadcastChannel=new BroadcastChannel(y$),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,i){if(typeof window<"u"){const s=i||ZQ();return this.eventCallbacks.has(s)?(this.logger.error(`Event callback with id: ${s} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(s,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${s}`),s)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,i,s){const r={eventType:e,interactionType:t||null,payload:i||null,error:s||null,timestamp:Date.now()};switch(e){case an.ACCOUNT_ADDED:case an.ACCOUNT_REMOVED:case an.ACTIVE_ACCOUNT_CHANGED:this.broadcastChannel.postMessage(r);break;default:this.invokeCallbacks(r);break}}invokeCallbacks(e){this.eventCallbacks.forEach(([t,i],s)=>{(i.length===0||i.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${s}: ${e.eventType}`),t.apply(null,[e]))})}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){this.broadcastChannel.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel.removeEventListener("message",this.invokeCrossTabCallbacks)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class tO{constructor(e,t,i,s,r,a,o,l,c){this.config=e,this.browserStorage=t,this.browserCrypto=i,this.networkClient=this.config.system.networkClient,this.eventHandler=r,this.navigationClient=a,this.nativeMessageHandler=l,this.correlationId=c||rl(),this.logger=s.clone(Ha.MSAL_SKU,Cy,this.correlationId),this.performanceClient=o}async clearCacheOnLogout(e){if(e){Kr.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(Kr.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return Zn.getAbsoluteUrl(t,t0())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const i={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new t2(i,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,i=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(Ae.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const s={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},r=e.requestAuthority||this.config.auth.authority,a=i!=null&&i.length?i==="true":this.config.auth.instanceAware,o=t&&a?this.config.auth.authority.replace(Zn.getDomainFromUrl(r),t.environment):r,l=kr.generateAuthority(o,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await pt(aN,Ae.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(l,this.config.system.networkClient,this.browserStorage,s,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw xi(ZP);return c}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const v$=32;async function nO(n,e,t){n.addQueueMeasurement(Ae.GeneratePkceCodes,t);const i=x0(_$,Ae.GenerateCodeVerifier,e,n,t)(n,e,t),s=await pt(k$,Ae.GenerateCodeChallengeFromVerifier,e,n,t)(i,n,e,t);return{verifier:i,challenge:s}}function _$(n,e,t){try{const i=new Uint8Array(v$);return x0(FQ,Ae.GetRandomValues,e,n,t)(i),Qd(i)}catch{throw Ft(wv)}}async function k$(n,e,t,i){e.addQueueMeasurement(Ae.GenerateCodeChallengeFromVerifier,i);try{const s=await pt(KN,Ae.Sha256Digest,t,e,i)(n,e,i);return Qd(new Uint8Array(s))}catch{throw Ft(wv)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */async function Nv(n,e,t,i){t.addQueueMeasurement(Ae.InitializeBaseRequest,n.correlationId);const s=n.authority||e.auth.authority,r=[...n&&n.scopes||[]],a={...n,correlationId:n.correlationId,authority:s,scopes:r};if(!a.authenticationScheme)a.authenticationScheme=fi.BEARER,i.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(a.authenticationScheme===fi.SSH){if(!n.sshJwk)throw xi(py);if(!n.sshKid)throw xi(XP)}i.verbose(`Authentication Scheme set to "${a.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&n.claims&&!ec.isEmptyObj(n.claims)&&(a.requestedClaimsHash=await YN(n.claims)),a}async function C$(n,e,t,i,s){i.addQueueMeasurement(Ae.InitializeSilentRequest,n.correlationId);const r=await pt(Nv,Ae.InitializeBaseRequest,s,i,n.correlationId)(n,t,i,s);return{...n,...r,account:e,forceRefresh:n.forceRefresh||!1}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class Jg extends tO{async initializeAuthorizationCodeRequest(e,t){this.performanceClient.addQueueMeasurement(Ae.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);const i=t||await pt(nO,Ae.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),s={...e,redirectUri:e.redirectUri,code:Ke.EMPTY_STRING,codeVerifier:i.verifier};return e.codeChallenge=i.challenge,e.codeChallengeMethod=Ke.S256_CODE_CHALLENGE_METHOD,s}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e==null?void 0:e.correlationId);const t={correlationId:this.correlationId||rl(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const i=this.getLogoutHintFromIdTokenClaims(e.account);i&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=i)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Zn.getAbsoluteUrl(e.postLogoutRedirectUri,t0())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Zn.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,t0())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Zn.getAbsoluteUrl(t0(),t0())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(Ae.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const t=await pt(this.getClientConfiguration.bind(this),Ae.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new cN(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:i,requestAzureCloudOptions:s,requestExtraQueryParameters:r,account:a}=e;this.performanceClient.addQueueMeasurement(Ae.StandardInteractionClientGetClientConfiguration,this.correlationId);const o=await pt(this.getDiscoveredAuthority.bind(this),Ae.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:i,requestAzureCloudOptions:s,requestExtraQueryParameters:r,account:a}),l=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:o,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:l.loggerCallback,piiLoggingEnabled:l.piiLoggingEnabled,logLevel:l.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:Ha.MSAL_SKU,version:Cy,cpu:Ke.EMPTY_STRING,os:Ke.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(Ae.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const i=this.getRedirectUri(e.redirectUri),s={interactionType:t},r=tl.setRequestState(this.browserCrypto,e&&e.state||Ke.EMPTY_STRING,s),o={...await pt(Nv,Ae.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:i,state:r,nonce:e.nonce||rl(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return o;const l=e.account||this.browserStorage.getActiveAccount();return l&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${l.homeAccountId}`,this.correlationId),o.account=l),o}}/*! @azure/msal-browser v4.5.0 2025-02-26 */const A$="ContentError",iO="user_switch";/*! @azure/msal-browser v4.5.0 2025-02-26 */const S$="USER_INTERACTION_REQUIRED",I$="USER_CANCEL",E$="NO_NETWORK",T$="PERSISTENT_ERROR",R$="DISABLED",M$="ACCOUNT_UNAVAILABLE";/*! @azure/msal-browser v4.5.0 2025-02-26 */const P$=-2147186943,N$={[iO]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Xl extends Bi{constructor(e,t,i){super(e,t),Object.setPrototypeOf(this,Xl.prototype),this.name="NativeAuthError",this.ext=i}}function Of(n){if(n.ext&&n.ext.status&&(n.ext.status===T$||n.ext.status===R$)||n.ext&&n.ext.error&&n.ext.error===P$)return!0;switch(n.errorCode){case A$:return!0;default:return!1}}function G6(n,e,t){if(t&&t.status)switch(t.status){case M$:return N6(oN);case S$:return new sl(n,e);case I$:return Ft(Zd);case E$:return Ft(Z3)}return new Xl(n,N$[n]||e,t)}/*! @azure/msal-browser v4.5.0 2025-02-26 */class sO extends Jg{async acquireToken(e){this.performanceClient.addQueueMeasurement(Ae.SilentCacheClientAcquireToken,e.correlationId);const t=this.initializeServerTelemetryManager(Si.acquireTokenSilent_silentFlow),i=await pt(this.getClientConfiguration.bind(this),Ae.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),s=new gQ(i,this.performanceClient);this.logger.verbose("Silent auth client created");try{const a=(await pt(s.acquireCachedToken.bind(s),Ae.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),a}catch(r){throw r instanceof wx&&r.errorCode===kv&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),r}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t==null?void 0:t.account)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class s1 extends tO{constructor(e,t,i,s,r,a,o,l,c,h,u,d){var g;super(e,t,i,s,r,a,l,c,d),this.apiId=o,this.accountId=h,this.nativeMessageHandler=c,this.nativeStorageManager=u,this.silentCacheClient=new sO(e,this.nativeStorageManager,i,s,r,a,l,c,d);const f=this.nativeMessageHandler.getExtensionId()===Uf.PREFERRED_EXTENSION_ID?"chrome":(g=this.nativeMessageHandler.getExtensionId())!=null&&g.length?"unknown":void 0;this.skus=t2.makeExtraSkuString({libraryName:Ha.MSAL_SKU,libraryVersion:Cy,extensionName:f,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[JZ]:this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(Ae.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const t=this.performanceClient.startMeasurement(Ae.NativeInteractionClientAcquireToken,e.correlationId),i=rc(),s=this.initializeServerTelemetryManager(this.apiId);try{const r=await this.initializeNativeRequest(e);try{const h=await this.acquireTokensFromCache(this.accountId,r);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),h}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...a}=r,o={method:yu.GetToken,request:a},l=await this.nativeMessageHandler.sendMessage(o),c=this.validateNativeResponse(l);return await this.handleNativeResponse(c,r,i).then(h=>(t.end({success:!0,isNativeBroker:!0,requestId:h.requestId}),s.clearNativeBrokerErrorCode(),h)).catch(h=>{throw t.end({success:!1,errorCode:h.errorCode,subErrorCode:h.subError,isNativeBroker:!0}),h})}catch(r){throw r instanceof Xl&&s.setNativeBrokerErrorCode(r.errorCode),r}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:ss.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),mt(S6);const i=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!i)throw mt(S6);try{const s=this.createSilentCacheRequest(t,i),r=await this.silentCacheClient.acquireToken(s),a={...i,idTokenClaims:r==null?void 0:r.idTokenClaims,idToken:r==null?void 0:r.idToken};return{...r,account:a}}catch(s){throw s}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...i}=e;delete i.onRedirectNavigate;const s=await this.initializeNativeRequest(i),r={method:yu.GetToken,request:s};try{const l=await this.nativeMessageHandler.sendMessage(r);this.validateNativeResponse(l)}catch(l){if(l instanceof Xl&&(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(l.errorCode),Of(l)))throw l}this.browserStorage.setTemporaryCache(li.NATIVE_REQUEST,JSON.stringify(s),!0);const a={apiId:Si.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(o,a)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const i=this.browserStorage.getCachedNativeRequest();if(!i)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&(e==null||e.addFields({errorCode:"no_cached_request"},t)),null;const{prompt:s,...r}=i;s&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(li.NATIVE_REQUEST));const a={method:yu.GetToken,request:r},o=rc();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const l=await this.nativeMessageHandler.sendMessage(a);this.validateNativeResponse(l);const c=this.handleNativeResponse(l,r,o);this.browserStorage.setInteractionInProgress(!1);const h=await c;return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),h}catch(l){throw this.browserStorage.setInteractionInProgress(!1),l}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,i){var h;this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const s=Yg(e.id_token,l0),r=this.createHomeAccountIdentifier(e,s),a=(h=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId}))==null?void 0:h.homeAccountId;if(r!==a&&e.account.id!==t.accountId)throw G6(iO);const o=await this.getDiscoveredAuthority({requestAuthority:t.authority}),l=bv(this.browserStorage,o,r,l0,s,e.client_info,void 0,s.tid,void 0,e.account.id,this.logger),c=await this.generateAuthenticationResult(e,t,s,l,o.canonicalAuthority,i);return await this.cacheAccount(l),await this.cacheNativeTokens(e,t,r,s,e.access_token,c.tenantId,i),c}createHomeAccountIdentifier(e,t){return Kr.generateHomeAccountId(e.client_info||Ke.EMPTY_STRING,qo.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?ss.fromString(e.scope):ss.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===fi.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const i=new Og(this.browserCrypto),s={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw mt(tv);return i.signPopToken(e.access_token,t.keyId,s)}else return e.access_token}async generateAuthenticationResult(e,t,i,s,r,a){const o=this.addTelemetryFromNativeResponse(e),l=e.scope?ss.fromString(e.scope):ss.fromString(t.scope),c=e.account.properties||{},h=c.UID||i.oid||i.sub||Ke.EMPTY_STRING,u=c.TenantId||i.tid||Ke.EMPTY_STRING,d=uv(s.getAccountInfo(),void 0,i,e.id_token);d.nativeAccountId!==e.account.id&&(d.nativeAccountId=e.account.id);const f=await this.generatePopAccessToken(e,t),g=t.tokenType===fi.POP?fi.POP:fi.BEARER;return{authority:r,uniqueId:h,tenantId:u,scopes:l.asArray(),account:d,idToken:e.id_token,idTokenClaims:i,accessToken:f,fromCache:o?this.isResponseFromCache(o):!1,expiresOn:new Date(Number(a+e.expires_in)*1e3),tokenType:g,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e).catch(t=>{this.logger.error(`Error occurred while removing account context from browser storage. ${t}`)})}cacheNativeTokens(e,t,i,s,r,a,o){const l=gy(i,t.authority,e.id_token||"",t.clientId,s.tid||""),c=t.tokenType===fi.POP?Ke.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,h=o+c,u=this.generateScopes(e,t),d=my(i,t.authority,r,t.clientId,s.tid||a,u.printScopes(),h,0,l0,void 0,t.tokenType,void 0,t.keyId),f={idToken:l,accessToken:d};return this.nativeStorageManager.saveCacheRecord(f,this.correlationId,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw bP(Y4,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const i=new Zn(t);i.validateAsUri();const{scopes:s,...r}=e,a=new ss(s||[]);a.appendScopes(bx);const o=()=>{switch(this.apiId){case Si.ssoSilent:case Si.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Fs.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case Fs.NONE:case Fs.CONSENT:case Fs.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),Ft(LN)}},l={...r,accountId:this.accountId,clientId:this.config.auth.clientId,authority:i.urlString,scope:a.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:o(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(l.signPopToken&&e.popKid)throw Ft(BN);if(this.handleExtraBrokerParams(l),l.extraParameters=l.extraParameters||{},l.extraParameters.telemetry=Uf.MATS_TELEMETRY,e.authenticationScheme===fi.POP){const c={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},h=new Og(this.browserCrypto);let u;if(l.keyId)u=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:l.keyId})),l.signPopToken=!1;else{const d=await pt(h.generateCnf.bind(h),Ae.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(c,this.logger);u=d.reqCnfString,l.keyId=d.kid,l.signPopToken=!0}l.reqCnf=u}return this.addRequestSKUs(l),l}handleExtraBrokerParams(e){var r;const t=e.extraParameters&&e.extraParameters.hasOwnProperty(gv)&&e.extraParameters.hasOwnProperty(P6)&&e.extraParameters.hasOwnProperty(Yd);if(!e.embeddedClientId&&!t)return;let i="";const s=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,i=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[P6],i=e.extraParameters[Yd]),e.extraParameters={child_client_id:i,child_redirect_uri:s},(r=this.performanceClient)==null||r.addFields({embeddedClientId:i,embeddedRedirectUri:s},e.correlationId)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class Yl{constructor(e,t,i,s){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=s,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=i,this.handshakeEvent=i.startMeasurement(Ae.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:Uf.CHANNEL_ID,extensionId:this.extensionId,responseId:rl(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise((i,s)=>{this.resolvers.set(t.responseId,{resolve:i,reject:s})})}static async createProvider(e,t,i){e.trace("NativeMessageHandler - createProvider called.");try{const s=new Yl(e,t,i,Uf.PREFERRED_EXTENSION_ID);return await s.sendHandshakeRequest(),s}catch{const r=new Yl(e,t,i);return await r.sendHandshakeRequest(),r}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Uf.CHANNEL_ID,extensionId:this.extensionId,responseId:rl(),body:{method:yu.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=t=>{this.onChannelMessage(t)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,i)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:i}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),i(Ft(ON)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(!(!t.channel||t.channel!==Uf.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===yu.HandshakeRequest){const i=this.handshakeResolvers.get(t.responseId);if(!i){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);return}this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),i.reject(Ft(DN))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,i=this.resolvers.get(t.responseId),s=this.handshakeResolvers.get(t.responseId);try{const r=t.body.method;if(r===yu.Response){if(!i)return;const a=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(a)}`),a.status!=="Success")i.reject(G6(a.code,a.description,a.ext));else if(a.result)a.result.code&&a.result.description?i.reject(G6(a.result.code,a.result.description,a.result.ext)):i.resolve(a.result);else throw bP(Y4,"Event does not contain result.");this.resolvers.delete(t.responseId)}else if(r===yu.HandshakeResponse){if(!s){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),s.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(r){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${r}`),this.logger.errorPii(`Unable to parse ${e}`),i?i.reject(r):s&&s.reject(r)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isPlatformBrokerAvailable(e,t,i,s){if(t.trace("isPlatformBrokerAvailable called"),!e.system.allowPlatformBroker)return t.trace("isPlatformBrokerAvailable: allowPlatformBroker is not enabled, returning false"),!1;if(!i)return t.trace("isPlatformBrokerAvailable: Platform extension provider is not initialized, returning false"),!1;if(s)switch(s){case fi.BEARER:case fi.POP:return t.trace("isPlatformBrokerAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformBrokerAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class Ov{constructor(e,t,i,s,r){this.authModule=e,this.browserStorage=t,this.authCodeRequest=i,this.logger=s,this.performanceClient=r}async handleCodeResponse(e,t){this.performanceClient.addQueueMeasurement(Ae.HandleCodeResponse,t.correlationId);let i;try{i=this.authModule.handleFragmentResponse(e,t.state)}catch(s){throw s instanceof Uh&&s.subError===Zd?Ft(Zd):s}return pt(this.handleCodeResponseFromServer.bind(this),Ae.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(i,t)}async handleCodeResponseFromServer(e,t,i=!0){if(this.performanceClient.addQueueMeasurement(Ae.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await pt(this.authModule.updateAuthority.bind(this.authModule),Ae.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),i&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const r=this.createCcsCredentials(t);r&&(this.authCodeRequest.ccsCredential=r)}return await pt(this.authModule.acquireToken.bind(this.authModule),Ae.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Ga.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:Ga.UPN}:null}}/*! @azure/msal-browser v4.5.0 2025-02-26 */function rO(n,e,t){const i=X3(n);if(!i)throw $P(n)?(t.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),t.errorPii(`The ${e} detected is: ${n}`),Ft(gN)):(t.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),Ft(fN));return i}function O$(n,e,t){if(!n.state)throw Ft(vv);const i=eO(e,n.state);if(!i)throw Ft(mN);if(i.interactionType!==t)throw Ft(pN)}/*! @azure/msal-browser v4.5.0 2025-02-26 */class D$ extends Jg{constructor(e,t,i,s,r,a,o,l,c,h){super(e,t,i,s,r,a,o,c,h),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=l}acquireToken(e,t){try{const s={popupName:this.generatePopupName(e.scopes||bx,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,s,t)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),s.popup=this.openSizedPopup("about:blank",s),this.acquireTokenPopupAsync(e,s,t))}catch(i){return Promise.reject(i)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),i={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:(e==null?void 0:e.popupWindowAttributes)||{},popupWindowParent:(e==null?void 0:e.popupWindowParent)??window},s=e&&e.authority,r=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,i,s,r)):(this.logger.verbose("asyncPopup set to false, opening popup"),i.popup=this.openSizedPopup("about:blank",i),this.logoutPopupAsync(t,i,s,r))}catch(t){return Promise.reject(t)}}async acquireTokenPopupAsync(e,t,i){var a;this.logger.verbose("acquireTokenPopupAsync called");const s=this.initializeServerTelemetryManager(Si.acquireTokenPopup),r=await pt(this.initializeAuthorizationRequest.bind(this),Ae.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,nn.Popup);t.popup&&QN(r.authority);try{const o=await pt(this.initializeAuthorizationCodeRequest.bind(this),Ae.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(r,i),l=await pt(this.createAuthCodeClient.bind(this),Ae.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:s,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),c=Yl.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let h;c&&(h=this.performanceClient.startMeasurement(Ae.FetchAccountIdWithNativeBroker,e.correlationId));const u=await l.getAuthCodeUrl({...r,platformBroker:c}),d=new Ov(l,this.browserStorage,o,this.logger,this.performanceClient),f=this.initiateAuthRequest(u,t);this.eventHandler.emitEvent(an.POPUP_OPENED,nn.Popup,{popupWindow:f},null);const g=await this.monitorPopupForHash(f,t.popupWindowParent),m=x0(rO,Ae.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(g,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(Kl.removeThrottle(this.browserStorage,this.config.auth.clientId,o),m.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),h&&h.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw Ft(yx);const p=new s1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Si.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,m.accountId,this.nativeStorage,r.correlationId),{userRequestState:y}=tl.parseRequestState(this.browserCrypto,r.state);return await p.acquireToken({...r,state:y,prompt:void 0})}return await d.handleCodeResponse(m,r)}catch(o){throw(a=t.popup)==null||a.close(),o instanceof Bi&&(o.setCorrelationId(this.correlationId),s.cacheFailedRequest(o)),o}}async logoutPopupAsync(e,t,i,s){var a,o,l,c;this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(an.LOGOUT_START,nn.Popup,e);const r=this.initializeServerTelemetryManager(Si.logoutPopup);try{await this.clearCacheOnLogout(e.account);const h=await pt(this.createAuthCodeClient.bind(this),Ae.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:i,account:e.account||void 0});try{h.authority.endSessionEndpoint}catch{if((a=e.account)!=null&&a.homeAccountId&&e.postLogoutRedirectUri&&h.authority.protocolMode===o0.OIDC){if(this.browserStorage.removeAccount((o=e.account)==null?void 0:o.homeAccountId),this.eventHandler.emitEvent(an.LOGOUT_SUCCESS,nn.Popup,e),s){const f={apiId:Si.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},g=Zn.getAbsoluteUrl(s,t0());await this.navigationClient.navigateInternal(g,f)}(l=t.popup)==null||l.close();return}}const u=h.getLogoutUri(e);this.eventHandler.emitEvent(an.LOGOUT_SUCCESS,nn.Popup,e);const d=this.openPopup(u,t);if(this.eventHandler.emitEvent(an.POPUP_OPENED,nn.Popup,{popupWindow:d},null),await this.monitorPopupForHash(d,t.popupWindowParent).catch(()=>{}),s){const f={apiId:Si.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},g=Zn.getAbsoluteUrl(s,t0());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${g}`),await this.navigationClient.navigateInternal(g,f)}else this.logger.verbose("No main window navigation requested")}catch(h){throw(c=t.popup)==null||c.close(),h instanceof Bi&&(h.setCorrelationId(this.correlationId),r.cacheFailedRequest(h)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(an.LOGOUT_FAILURE,nn.Popup,null,h),this.eventHandler.emitEvent(an.LOGOUT_END,nn.Popup),h}this.eventHandler.emitEvent(an.LOGOUT_END,nn.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),Ft(wy)}monitorPopupForHash(e,t){return new Promise((i,s)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const r=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(r),s(Ft(Zd));return}let a="";try{a=e.location.href}catch{}if(!a||a==="about:blank")return;clearInterval(r);let o="";const l=this.config.auth.OIDCOptions.serverResponseType;e&&(l===xx.QUERY?o=e.location.search:o=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),i(o)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let i;if(t.popup?(i=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),i.location.assign(e)):typeof t.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),i=this.openSizedPopup(e,t)),!i)throw Ft(yN);return i.focus&&i.focus(),this.currentWindow=i,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),i}catch(i){throw this.logger.error("error opening popup "+i.message),this.browserStorage.setInteractionInProgress(!1),Ft(xN)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:i,popupWindowParent:s}){var f,g,m,x;const r=s.screenLeft?s.screenLeft:s.screenX,a=s.screenTop?s.screenTop:s.screenY,o=s.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=s.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let c=(f=i.popupSize)==null?void 0:f.width,h=(g=i.popupSize)==null?void 0:g.height,u=(m=i.popupPosition)==null?void 0:m.top,d=(x=i.popupPosition)==null?void 0:x.left;return(!c||c<0||c>o)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=Ha.POPUP_WIDTH),(!h||h<0||h>l)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),h=Ha.POPUP_HEIGHT),(!u||u<0||u>l)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,l/2-Ha.POPUP_HEIGHT/2+a)),(!d||d<0||d>o)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),d=Math.max(0,o/2-Ha.POPUP_WIDTH/2+r)),s.open(e,t,`width=${c}, height=${h}, top=${u}, left=${d}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(nn.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${Ha.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${Ha.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class QC{constructor(e,t,i,s,r){this.authModule=e,this.browserStorage=t,this.authCodeRequest=i,this.logger=s,this.performanceClient=r}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(li.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(li.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const i={apiId:Si.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if(typeof t.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),t.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await t.navigationClient.navigateExternal(e,i);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await t.navigationClient.navigateExternal(e,i);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Ft(wy)}async handleCodeResponse(e,t){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const i=this.browserStorage.generateStateKey(t),s=this.browserStorage.getTemporaryCache(i);if(!s)throw mt(q3,"Cached State");let r;try{r=this.authModule.handleFragmentResponse(e,s)}catch(c){throw c instanceof Uh&&c.subError===Zd?Ft(Zd):c}const a=this.browserStorage.generateNonceKey(s),o=this.browserStorage.getTemporaryCache(a);if(this.authCodeRequest.code=r.code,r.cloud_instance_host_name&&await pt(this.authModule.updateAuthority.bind(this.authModule),Ae.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(r.cloud_instance_host_name,this.authCodeRequest.correlationId),r.nonce=o||void 0,r.state=s,r.client_info)this.authCodeRequest.clientInfo=r.client_info;else{const c=this.checkCcsCredentials();c&&(this.authCodeRequest.ccsCredential=c)}const l=await this.authModule.acquireToken(this.authCodeRequest,r);return this.browserStorage.cleanRequestByState(t),l}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(li.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}/*! @azure/msal-browser v4.5.0 2025-02-26 */function L$(){if(typeof window>"u"||typeof window.performance>"u"||typeof window.performance.getEntriesByType!="function")return;const n=window.performance.getEntriesByType("navigation"),e=n.length?n[0]:void 0;return e==null?void 0:e.type}class F$ extends Jg{constructor(e,t,i,s,r,a,o,l,c,h){super(e,t,i,s,r,a,o,c,h),this.nativeStorage=l}async acquireToken(e){const t=await pt(this.initializeAuthorizationRequest.bind(this),Ae.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,nn.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);const i=this.initializeServerTelemetryManager(Si.acquireTokenRedirect),s=r=>{r.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(an.RESTORE_FROM_BFCACHE,nn.Redirect))};try{const r=await pt(this.initializeAuthorizationCodeRequest.bind(this),Ae.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(t),a=await pt(this.createAuthCodeClient.bind(this),Ae.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),o=new QC(a,this.browserStorage,r,this.logger,this.performanceClient),l=await a.getAuthCodeUrl({...t,platformBroker:Yl.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),c=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${c}`),window.addEventListener("pageshow",s),await o.initiateAuthRequest(l,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(r){throw r instanceof Bi&&(r.setCorrelationId(this.correlationId),i.cacheFailedRequest(r)),window.removeEventListener("pageshow",s),this.browserStorage.cleanRequestByState(t.state),r}}async handleRedirectPromise(e="",t){const i=this.initializeServerTelemetryManager(Si.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[s,r]=this.getRedirectResponse(e||"");if(!s)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(nn.Redirect),L$()!=="back_forward"?t.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const a=this.browserStorage.getTemporaryCache(li.ORIGIN_URI,!0)||Ke.EMPTY_STRING,o=Zn.removeHashFromUrl(a),l=Zn.removeHashFromUrl(window.location.href);if(o===l&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),a.indexOf("#")>-1&&qQ(a),await this.handleResponse(s,i);if(this.config.auth.navigateToLoginRequestUrl){if(!Rv()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(li.URL_HASH,r,!0);const c={apiId:Si.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let h=!0;if(!a||a==="null"){const u=KQ();this.browserStorage.setTemporaryCache(li.ORIGIN_URI,u,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),h=await this.navigationClient.navigateInternal(u,c)}else this.logger.verbose(`Navigating to loginRequestUrl: ${a}`),h=await this.navigationClient.navigateInternal(a,c);if(!h)return await this.handleResponse(s,i)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(s,i);return null}catch(s){throw s instanceof Bi&&(s.setCorrelationId(this.correlationId),i.cacheFailedRequest(s)),this.browserStorage.cleanRequestByInteractionType(nn.Redirect),s}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(this.config.auth.OIDCOptions.serverResponseType===xx.QUERY?t=window.location.search:t=window.location.hash);let i=X3(t);if(i){try{O$(i,this.browserCrypto,nn.Redirect)}catch(r){return r instanceof Bi&&this.logger.error(`Interaction type validation failed due to ${r.errorCode}: ${r.errorMessage}`),[null,""]}return VQ(window),this.logger.verbose("Hash contains known properties, returning response hash"),[i,t]}const s=this.browserStorage.getTemporaryCache(li.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(li.URL_HASH)),s&&(i=X3(s),i)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[i,s]):[null,""]}async handleResponse(e,t){const i=e.state;if(!i)throw Ft(vv);const s=this.browserStorage.getCachedRequest(i);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Ft(yx);const l=new s1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Si.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,s.correlationId),{userRequestState:c}=tl.parseRequestState(this.browserCrypto,i);return l.acquireToken({...s,state:c,prompt:void 0}).finally(()=>{this.browserStorage.cleanRequestByState(i)})}const r=this.browserStorage.getCachedAuthority(i);if(!r)throw Ft(_v);const a=await pt(this.createAuthCodeClient.bind(this),Ae.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:r});return Kl.removeThrottle(this.browserStorage,this.config.auth.clientId,s),new QC(a,this.browserStorage,s,this.logger,this.performanceClient).handleCodeResponse(e,i)}async logout(e){var s,r;this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),i=this.initializeServerTelemetryManager(Si.logout);try{this.eventHandler.emitEvent(an.LOGOUT_START,nn.Redirect,e),await this.clearCacheOnLogout(t.account);const a={apiId:Si.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=await pt(this.createAuthCodeClient.bind(this),Ae.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:e&&e.authority,requestExtraQueryParameters:e==null?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(o.authority.protocolMode===o0.OIDC)try{o.authority.endSessionEndpoint}catch{if((s=t.account)!=null&&s.homeAccountId){this.browserStorage.removeAccount((r=t.account)==null?void 0:r.homeAccountId),this.eventHandler.emitEvent(an.LOGOUT_SUCCESS,nn.Redirect,t);return}}const l=o.getLogoutUri(t);if(this.eventHandler.emitEvent(an.LOGOUT_SUCCESS,nn.Redirect,t),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(l)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,a);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,a);return}}catch(a){throw a instanceof Bi&&(a.setCorrelationId(this.correlationId),i.cacheFailedRequest(a)),this.eventHandler.emitEvent(an.LOGOUT_FAILURE,nn.Redirect,null,a),this.eventHandler.emitEvent(an.LOGOUT_END,nn.Redirect),a}this.eventHandler.emitEvent(an.LOGOUT_END,nn.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return Zn.getAbsoluteUrl(t,t0())}}/*! @azure/msal-browser v4.5.0 2025-02-26 */async function B$(n,e,t,i,s){if(e.addQueueMeasurement(Ae.SilentHandlerInitiateAuthRequest,i),!n)throw t.info("Navigate url is empty"),Ft(wy);return s?pt(H$,Ae.SilentHandlerLoadFrame,t,e,i)(n,s,e,i):x0(z$,Ae.SilentHandlerLoadFrameSync,t,e,i)(n)}async function U$(n,e,t,i,s,r,a){return i.addQueueMeasurement(Ae.SilentHandlerMonitorIframeForHash,r),new Promise((o,l)=>{e<B6&&s.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${B6}ms). This may result in timeouts.`);const c=window.setTimeout(()=>{window.clearInterval(h),l(Ft(wN))},e),h=window.setInterval(()=>{let u="";const d=n.contentWindow;try{u=d?d.location.href:""}catch{}if(!u||u==="about:blank")return;let f="";d&&(a===xx.QUERY?f=d.location.search:f=d.location.hash),window.clearTimeout(c),window.clearInterval(h),o(f)},t)}).finally(()=>{x0(j$,Ae.RemoveHiddenIframe,s,i,r)(n)})}function H$(n,e,t,i){return t.addQueueMeasurement(Ae.SilentHandlerLoadFrame,i),new Promise((s,r)=>{const a=aO();window.setTimeout(()=>{if(!a){r("Unable to load iframe");return}a.src=n,s(a)},e)})}function z$(n){const e=aO();return e.src=n,e}function aO(){const n=document.createElement("iframe");return n.className="msalSilentIframe",n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(n),n}function j$(n){document.body===n.parentNode&&document.body.removeChild(n)}/*! @azure/msal-browser v4.5.0 2025-02-26 */class G$ extends Jg{constructor(e,t,i,s,r,a,o,l,c,h,u){super(e,t,i,s,r,a,l,h,u),this.apiId=o,this.nativeStorage=c}async acquireToken(e){this.performanceClient.addQueueMeasurement(Ae.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==Fs.NONE&&t.prompt!==Fs.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${Fs.NONE}`),t.prompt=Fs.NONE):t.prompt=Fs.NONE;const i=await pt(this.initializeAuthorizationRequest.bind(this),Ae.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,nn.Silent);QN(i.authority);const s=this.initializeServerTelemetryManager(this.apiId);let r;try{return r=await pt(this.createAuthCodeClient.bind(this),Ae.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:s,requestAuthority:i.authority,requestAzureCloudOptions:i.azureCloudOptions,requestExtraQueryParameters:i.extraQueryParameters,account:i.account}),await pt(this.silentTokenHelper.bind(this),Ae.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(r,i)}catch(a){if(a instanceof Bi&&(a.setCorrelationId(this.correlationId),s.cacheFailedRequest(a)),!r||!(a instanceof Bi)||a.errorCode!==Ha.INVALID_GRANT_ERROR)throw a;this.performanceClient.addFields({retryError:a.errorCode},this.correlationId);const o=await pt(this.initializeAuthorizationRequest.bind(this),Ae.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,nn.Silent);return await pt(this.silentTokenHelper.bind(this),Ae.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(r,o)}}logout(){return Promise.reject(Ft(vy))}async silentTokenHelper(e,t){const i=t.correlationId;this.performanceClient.addQueueMeasurement(Ae.SilentIframeClientTokenHelper,i);const s=await pt(this.initializeAuthorizationCodeRequest.bind(this),Ae.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,i)(t),r=await pt(e.getAuthCodeUrl.bind(e),Ae.GetAuthCodeUrl,this.logger,this.performanceClient,i)({...t,platformBroker:Yl.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}),a=new Ov(e,this.browserStorage,s,this.logger,this.performanceClient),o=await pt(B$,Ae.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,i)(r,this.performanceClient,this.logger,i,this.config.system.navigateFrameWait),l=this.config.auth.OIDCOptions.serverResponseType,c=await pt(U$,Ae.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,i)(o,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,i,l),h=x0(rO,Ae.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(c,l,this.logger);if(h.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Ft(yx);const u=new s1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,h.accountId,this.browserStorage,i),{userRequestState:d}=tl.parseRequestState(this.browserCrypto,t.state);return pt(u.acquireToken.bind(u),Ae.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,i)({...t,state:d,prompt:t.prompt||Fs.NONE})}return pt(a.handleCodeResponse.bind(a),Ae.HandleCodeResponse,this.logger,this.performanceClient,i)(h,t)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class V$ extends Jg{async acquireToken(e){this.performanceClient.addQueueMeasurement(Ae.SilentRefreshClientAcquireToken,e.correlationId);const t=await pt(Nv,Ae.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),i={...e,...t};e.redirectUri&&(i.redirectUri=this.getRedirectUri(e.redirectUri));const s=this.initializeServerTelemetryManager(Si.acquireTokenSilent_silentFlow),r=await this.createRefreshTokenClient({serverTelemetryManager:s,authorityUrl:i.authority,azureCloudOptions:i.azureCloudOptions,account:i.account});return pt(r.acquireTokenByRefreshToken.bind(r),Ae.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(i).catch(a=>{throw a.setCorrelationId(this.correlationId),s.cacheFailedRequest(a),a})}logout(){return Promise.reject(Ft(vy))}async createRefreshTokenClient(e){const t=await pt(this.getClientConfiguration.bind(this),Ae.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new fQ(t,this.performanceClient)}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class q${constructor(e,t,i,s){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=i,this.cryptoObj=s}async loadExternalTokens(e,t,i){if(!this.isBrowserEnvironment)throw Ft(_y);const s=e.correlationId||rl(),r=t.id_token?Yg(t.id_token,l0):void 0,a={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.authority?new kr(kr.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,a,this.logger,e.correlationId||rl()):void 0,l=await this.loadAccount(e,i.clientInfo||t.client_info||"",s,r,o),c=await this.loadIdToken(t,l.homeAccountId,l.environment,l.realm,s),h=await this.loadAccessToken(e,t,l.homeAccountId,l.environment,l.realm,i,s),u=await this.loadRefreshToken(t,l.homeAccountId,l.environment,s);return this.generateAuthenticationResult(e,{account:l,idToken:c,accessToken:h,refreshToken:u},r,o)}async loadAccount(e,t,i,s,r){if(this.logger.verbose("TokenCache - loading account"),e.account){const c=Kr.createFromAccountInfo(e.account);return await this.storage.setAccount(c,i),c}else if(!r||!t&&!s)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Ft(TN);const a=Kr.generateHomeAccountId(t,r.authorityType,this.logger,this.cryptoObj,s),o=s==null?void 0:s.tid,l=bv(this.storage,r,a,l0,s,t,r.hostnameAndPort,o,void 0,void 0,this.logger);return await this.storage.setAccount(l,i),l}async loadIdToken(e,t,i,s,r){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const a=gy(t,i,e.id_token,this.config.auth.clientId,s);return await this.storage.setIdTokenCredential(a,r),a}async loadAccessToken(e,t,i,s,r,a,o){if(t.access_token)if(t.expires_in){if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const l=t.scope?ss.fromString(t.scope):new ss(e.scopes),c=a.expiresOn||t.expires_in+new Date().getTime()/1e3,h=a.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+new Date().getTime()/1e3,u=my(i,s,t.access_token,this.config.auth.clientId,r,l.printScopes(),c,h,l0);return await this.storage.setAccessTokenCredential(u,o),u}async loadRefreshToken(e,t,i,s){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const r=FP(t,i,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(r,s),r}generateAuthenticationResult(e,t,i,s){var h,u,d;let r="",a=[],o=null,l;t!=null&&t.accessToken&&(r=t.accessToken.secret,a=ss.fromString(t.accessToken.target).asArray(),o=new Date(Number(t.accessToken.expiresOn)*1e3),l=new Date(Number(t.accessToken.extendedExpiresOn)*1e3));const c=t.account;return{authority:s?s.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:a,account:c.getAccountInfo(),idToken:((h=t.idToken)==null?void 0:h.secret)||"",idTokenClaims:i||{},accessToken:r,fromCache:!0,expiresOn:o,correlationId:e.correlationId||"",requestId:"",extExpiresOn:l,familyId:((u=t.refreshToken)==null?void 0:u.familyId)||"",tokenType:((d=t==null?void 0:t.accessToken)==null?void 0:d.tokenType)||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromNativeBroker:!1}}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class W$ extends cN{constructor(e){super(e),this.includeRedirectUri=!1}}/*! @azure/msal-browser v4.5.0 2025-02-26 */class K$ extends Jg{constructor(e,t,i,s,r,a,o,l,c,h){super(e,t,i,s,r,a,l,c,h),this.apiId=o}async acquireToken(e){if(!e.code)throw Ft(RN);const t=await pt(this.initializeAuthorizationRequest.bind(this),Ae.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,nn.Silent),i=this.initializeServerTelemetryManager(this.apiId);try{const s={...t,code:e.code},r=await pt(this.getClientConfiguration.bind(this),Ae.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:i,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),a=new W$(r);this.logger.verbose("Auth code client created");const o=new Ov(a,this.browserStorage,s,this.logger,this.performanceClient);return await pt(o.handleCodeResponseFromServer.bind(o),Ae.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(s){throw s instanceof Bi&&(s.setCorrelationId(this.correlationId),i.cacheFailedRequest(s)),s}}logout(){return Promise.reject(Ft(vy))}}/*! @azure/msal-browser v4.5.0 2025-02-26 */function xl(n){const e=n==null?void 0:n.idTokenClaims;if(e!=null&&e.tfp||e!=null&&e.acr)return"B2C";if(e!=null&&e.tid){if((e==null?void 0:e.tid)==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function d9(n,e){try{Mv(n)}catch(t){throw e.end({success:!1},t),t}}class Sy{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Dg(this.logger,this.performanceClient):W3,this.eventHandler=new w$(this.logger),this.browserStorage=this.isBrowserEnvironment?new j6(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,iQ(this.config.auth)):u$(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler);const t={cacheLocation:hr.MemoryStorage,temporaryCacheLocation:hr.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new j6(this.config.auth.clientId,t,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new q$(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const i=new Sy(e);return await i.initialize(t),i}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(an.INITIALIZE_END);return}const t=(e==null?void 0:e.correlationId)||this.getRequestCorrelationId(),i=this.config.system.allowPlatformBroker,s=this.performanceClient.startMeasurement(Ae.InitializeClientApplication,t);if(this.eventHandler.emitEvent(an.INITIALIZE_START),await pt(this.browserStorage.initialize.bind(this.browserStorage),Ae.InitializeCache,this.logger,this.performanceClient,t)(t),i)try{this.nativeExtensionProvider=await Yl.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(r){this.logger.verbose(r)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await pt(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),Ae.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t),this.initialized=!0,this.eventHandler.emitEvent(an.INITIALIZE_END),s.end({allowPlatformBroker:i,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),ZN(this.initialized),this.isBrowserEnvironment){const t=e||"";let i=this.redirectResponse.get(t);return typeof i>"u"?(i=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,i),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),i}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const t=this.getAllAccounts(),i=this.browserStorage.getCachedNativeRequest(),s=i&&Yl.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,r=s?i==null?void 0:i.correlationId:this.browserStorage.getTemporaryCache(li.CORRELATION_ID,!0)||"",a=this.performanceClient.startMeasurement(Ae.AcquireTokenRedirect,r);this.eventHandler.emitEvent(an.HANDLE_REDIRECT_START,nn.Redirect);let o;if(s&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const l=new s1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Si.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,i.accountId,this.nativeInternalStorage,i.correlationId);o=pt(l.handleRedirectPromise.bind(l),Ae.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(this.performanceClient,a.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const l=this.createRedirectClient(r);o=pt(l.handleRedirectPromise.bind(l),Ae.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(e,a)}return o.then(l=>(l?(t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(an.LOGIN_SUCCESS,nn.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(an.ACQUIRE_TOKEN_SUCCESS,nn.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),a.end({success:!0,accountType:xl(l.account)})):a.event.errorCode?a.end({success:!1}):a.discard(),this.eventHandler.emitEvent(an.HANDLE_REDIRECT_END,nn.Redirect),l)).catch(l=>{const c=l;throw t.length>0?this.eventHandler.emitEvent(an.ACQUIRE_TOKEN_FAILURE,nn.Redirect,null,c):this.eventHandler.emitEvent(an.LOGIN_FAILURE,nn.Redirect,null,c),this.eventHandler.emitEvent(an.HANDLE_REDIRECT_END,nn.Redirect),a.end({success:!1},c),l})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const i=this.performanceClient.startMeasurement(Ae.AcquireTokenPreRedirect,t);i.add({accountType:xl(e.account),scenarioId:e.scenarioId});const s=e.onRedirectNavigate;if(s)e.onRedirectNavigate=a=>{const o=typeof s=="function"?s(a):void 0;return o!==!1?i.end({success:!0}):i.discard(),o};else{const a=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=o=>{const l=typeof a=="function"?a(o):void 0;return l!==!1?i.end({success:!0}):i.discard(),l}}const r=this.getAllAccounts().length>0;try{WC(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),r?this.eventHandler.emitEvent(an.ACQUIRE_TOKEN_START,nn.Redirect,e):this.eventHandler.emitEvent(an.LOGIN_START,nn.Redirect,e);let a;return this.nativeExtensionProvider&&this.canUsePlatformBroker(e)?a=new s1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Si.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,i).catch(l=>{if(l instanceof Xl&&Of(l))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(l instanceof sl)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),l}):a=this.createRedirectClient(t).acquireToken(e),await a}catch(a){throw i.end({success:!1},a),r?this.eventHandler.emitEvent(an.ACQUIRE_TOKEN_FAILURE,nn.Redirect,null,a):this.eventHandler.emitEvent(an.LOGIN_FAILURE,nn.Redirect,null,a),a}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),i=this.performanceClient.startMeasurement(Ae.AcquireTokenPopup,t);i.add({scenarioId:e.scenarioId,accountType:xl(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),d9(this.initialized,i),this.browserStorage.setInteractionInProgress(!0)}catch(o){return Promise.reject(o)}const s=this.getAllAccounts();s.length>0?this.eventHandler.emitEvent(an.ACQUIRE_TOKEN_START,nn.Popup,e):this.eventHandler.emitEvent(an.LOGIN_START,nn.Popup,e);let r;const a=this.getPreGeneratedPkceCodes(t);return this.canUsePlatformBroker(e)?r=this.acquireTokenNative({...e,correlationId:t},Si.acquireTokenPopup).then(o=>(this.browserStorage.setInteractionInProgress(!1),i.end({success:!0,isNativeBroker:!0,accountType:xl(o.account)}),o)).catch(o=>{if(o instanceof Xl&&Of(o))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e,a);if(o instanceof sl)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e,a);throw this.browserStorage.setInteractionInProgress(!1),o}):r=this.createPopupClient(t).acquireToken(e,a),r.then(o=>(s.length<this.getAllAccounts().length?this.eventHandler.emitEvent(an.LOGIN_SUCCESS,nn.Popup,o):this.eventHandler.emitEvent(an.ACQUIRE_TOKEN_SUCCESS,nn.Popup,o),i.end({success:!0,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,accountType:xl(o.account)}),o)).catch(o=>(s.length>0?this.eventHandler.emitEvent(an.ACQUIRE_TOKEN_FAILURE,nn.Popup,null,o):this.eventHandler.emitEvent(an.LOGIN_FAILURE,nn.Popup,null,o),i.end({success:!1},o),Promise.reject(o))).finally(()=>this.config.system.asyncPopups&&this.preGeneratePkceCodes(t))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var r,a;const t=this.getRequestCorrelationId(e),i={...e,prompt:e.prompt,correlationId:t};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Ae.SsoSilent,t),(r=this.ssoSilentMeasurement)==null||r.add({scenarioId:e.scenarioId,accountType:xl(e.account)}),d9(this.initialized,this.ssoSilentMeasurement),(a=this.ssoSilentMeasurement)==null||a.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(an.SSO_SILENT_START,nn.Silent,i);let s;return this.canUsePlatformBroker(i)?s=this.acquireTokenNative(i,Si.ssoSilent).catch(o=>{if(o instanceof Xl&&Of(o))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(i.correlationId).acquireToken(i);throw o}):s=this.createSilentIframeClient(i.correlationId).acquireToken(i),s.then(o=>{var l;return this.eventHandler.emitEvent(an.SSO_SILENT_SUCCESS,nn.Silent,o),(l=this.ssoSilentMeasurement)==null||l.end({success:!0,isNativeBroker:o.fromNativeBroker,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,accountType:xl(o.account)}),o}).catch(o=>{var l;throw this.eventHandler.emitEvent(an.SSO_SILENT_FAILURE,nn.Silent,null,o),(l=this.ssoSilentMeasurement)==null||l.end({success:!1},o),o}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const i=this.performanceClient.startMeasurement(Ae.AcquireTokenByCode,t);d9(this.initialized,i),this.eventHandler.emitEvent(an.ACQUIRE_TOKEN_BY_CODE_START,nn.Silent,e),i.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Ft(PN);if(e.code){const s=e.code;let r=this.hybridAuthCodeResponses.get(s);return r?(this.logger.verbose("Existing acquireTokenByCode request found",t),i.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),r=this.acquireTokenByCodeAsync({...e,correlationId:t}).then(a=>(this.eventHandler.emitEvent(an.ACQUIRE_TOKEN_BY_CODE_SUCCESS,nn.Silent,a),this.hybridAuthCodeResponses.delete(s),i.end({success:!0,isNativeBroker:a.fromNativeBroker,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:xl(a.account)}),a)).catch(a=>{throw this.hybridAuthCodeResponses.delete(s),this.eventHandler.emitEvent(an.ACQUIRE_TOKEN_BY_CODE_FAILURE,nn.Silent,null,a),i.end({success:!1},a),a}),this.hybridAuthCodeResponses.set(s,r)),await r}else if(e.nativeAccountId)if(this.canUsePlatformBroker(e,e.nativeAccountId)){const s=await this.acquireTokenNative({...e,correlationId:t},Si.acquireTokenByCode,e.nativeAccountId).catch(r=>{throw r instanceof Xl&&Of(r)&&(this.nativeExtensionProvider=void 0),r});return i.end({accountType:xl(s.account),success:!0}),s}else throw Ft(NN);else throw Ft(MN)}catch(s){throw this.eventHandler.emitEvent(an.ACQUIRE_TOKEN_BY_CODE_FAILURE,nn.Silent,null,s),i.end({success:!1},s),s}}async acquireTokenByCodeAsync(e){var s;return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Ae.AcquireTokenByCodeAsync,e.correlationId),(s=this.acquireTokenByCodeAsyncMeasurement)==null||s.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(r=>{var a;return(a=this.acquireTokenByCodeAsyncMeasurement)==null||a.end({success:!0,fromCache:r.fromCache,isNativeBroker:r.fromNativeBroker}),r}).catch(r=>{var a;throw(a=this.acquireTokenByCodeAsyncMeasurement)==null||a.end({success:!1},r),r}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(Ae.AcquireTokenFromCache,e.correlationId),t){case ya.Default:case ya.AccessToken:case ya.AccessTokenAndRefreshToken:const i=this.createSilentCacheClient(e.correlationId);return pt(i.acquireToken.bind(i),Ae.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw mt(Ph)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(Ae.AcquireTokenByRefreshToken,e.correlationId),t){case ya.Default:case ya.AccessTokenAndRefreshToken:case ya.RefreshToken:case ya.RefreshTokenAndNetwork:const i=this.createSilentRefreshClient(e.correlationId);return pt(i.acquireToken.bind(i),Ae.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw mt(Ph)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(Ae.AcquireTokenBySilentIframe,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return pt(t.acquireToken.bind(t),Ae.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return WC(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return Mv(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){return d$(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return f$(e,this.logger,this.browserStorage)}getAccountByUsername(e){return g$(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return m$(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return p$(e,this.logger,this.browserStorage)}setActiveAccount(e){b$(e,this.browserStorage)}getActiveAccount(){return x$(this.browserStorage)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const i=Kr.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(i,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,i){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Ft(yx);return new s1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,i||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!Yl.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isPlatformBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Fs.NONE:case Fs.CONSENT:case Fs.LOGIN:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new D$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new F$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new G$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Si.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new sO(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new V$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new K$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Si.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return JN(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){if(this.config.cache.cacheLocation!==hr.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.subscribeCrossTab()}disableAccountStorageEvents(){if(this.config.cache.cacheLocation!==hr.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.unsubscribeCrossTab()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e!=null&&e.correlationId?e.correlationId:this.isBrowserEnvironment?rl():Ke.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||jC})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||jC})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),i=this.performanceClient.startMeasurement(Ae.AcquireTokenSilent,t);i.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),d9(this.initialized,i),this.logger.verbose("acquireTokenSilent called",t);const s=e.account||this.getActiveAccount();if(!s)throw Ft(CN);i.add({accountType:xl(s)});const r={clientId:this.config.auth.clientId,authority:e.authority||Ke.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:s.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},a=JSON.stringify(r),o=this.activeSilentTokenRequests.get(a);if(typeof o>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);const l=pt(this.acquireTokenSilentAsync.bind(this),Ae.AcquireTokenSilentAsync,this.logger,this.performanceClient,t)({...e,correlationId:t},s).then(c=>(this.activeSilentTokenRequests.delete(a),i.end({success:!0,fromCache:c.fromCache,isNativeBroker:c.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length}),c)).catch(c=>{throw this.activeSilentTokenRequests.delete(a),i.end({success:!1},c),c});return this.activeSilentTokenRequests.set(a,l),{...await l,state:e.state}}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),i.discard(),{...await o,state:e.state}}async acquireTokenSilentAsync(e,t){const i=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(Ae.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(an.ACQUIRE_TOKEN_START,nn.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",i);const s=await pt(C$,Ae.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),r=e.cacheLookupPolicy||ya.Default;return this.acquireTokenSilentNoIframe(s,r).catch(async o=>{if(X$(o,r))if(this.activeIframeRequest)if(r!==ya.Skip){const[c,h]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${h}`,s.correlationId);const u=this.performanceClient.startMeasurement(Ae.AwaitConcurrentIframe,s.correlationId);u.add({awaitIframeCorrelationId:h});const d=await c;if(u.end({success:d}),d)return this.logger.verbose(`Parallel iframe request with correlationId: ${h} succeeded. Retrying cache and/or RT redemption`,s.correlationId),this.acquireTokenSilentNoIframe(s,r);throw this.logger.info(`Iframe request with correlationId: ${h} failed. Interaction is required.`),o}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",s.correlationId),pt(this.acquireTokenBySilentIframe.bind(this),Ae.AcquireTokenBySilentIframe,this.logger,this.performanceClient,s.correlationId)(s);else{let c;return this.activeIframeRequest=[new Promise(h=>{c=h}),s.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",s.correlationId),pt(this.acquireTokenBySilentIframe.bind(this),Ae.AcquireTokenBySilentIframe,this.logger,this.performanceClient,s.correlationId)(s).then(h=>(c(!0),h)).catch(h=>{throw c(!1),h}).finally(()=>{this.activeIframeRequest=void 0})}else throw o}).then(o=>(this.eventHandler.emitEvent(an.ACQUIRE_TOKEN_SUCCESS,nn.Silent,o),e.correlationId&&this.performanceClient.addFields({fromCache:o.fromCache,isNativeBroker:o.fromNativeBroker},e.correlationId),o)).catch(o=>{throw this.eventHandler.emitEvent(an.ACQUIRE_TOKEN_FAILURE,nn.Silent,null,o),o}).finally(()=>{document.removeEventListener("visibilitychange",i)})}async acquireTokenSilentNoIframe(e,t){return Yl.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,Si.acquireTokenSilent_silentFlow).catch(async i=>{throw i instanceof Xl&&Of(i)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,mt(Ph)):i})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),pt(this.acquireTokenFromCache.bind(this),Ae.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,t).catch(i=>{if(t===ya.AccessToken)throw i;return this.eventHandler.emitEvent(an.ACQUIRE_TOKEN_NETWORK_START,nn.Silent,e),pt(this.acquireTokenByRefreshToken.bind(this),Ae.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,t)}))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await pt(nO,Ae.GeneratePkceCodes,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),Promise.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose(`${t?"Found":"Did not find"} pre-generated PKCE codes`),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}}function X$(n,e){const t=!(n instanceof sl&&n.subError!==yy),i=n.errorCode===Ha.INVALID_GRANT_ERROR||n.errorCode===Ph,s=t&&i||n.errorCode===J3||n.errorCode===pv,r=EQ.includes(e);return s&&r}/*! @azure/msal-browser v4.5.0 2025-02-26 */async function Y$(n,e){const t=new $d(n);return await t.initialize(),Sy.createController(t,e)}/*! @azure/msal-browser v4.5.0 2025-02-26 */class Dv{static async createPublicClientApplication(e){const t=await Y$(e);return new Dv(e,t)}constructor(e,t){this.controller=t||new Sy(new $d(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}const bu=class bu{constructor(){ze(this,"clientId","");ze(this,"sharepointUrl","");ze(this,"sharepointTenantId","");ze(this,"msalInstance",null);ze(this,"currentAuthorityType","personal")}static getInstance(){return bu.instance||(bu.instance=new bu),bu.instance}async initialize(e){e&&this.currentAuthorityType!==e&&(this.currentAuthorityType=e,this.msalInstance=null),await this.getCredentials()}async ensureInitialized(e){await this.initialize(e)}async getCredentials(){var o,l,c;const t=await fetch("/api/config",{headers:{"Content-Type":"application/json"},credentials:"include"});if(!t.ok)throw new Error("Failed to fetch OneDrive credentials");const i=await t.json(),s=(o=i.onedrive)==null?void 0:o.client_id,r=(l=i.onedrive)==null?void 0:l.sharepoint_url,a=(c=i.onedrive)==null?void 0:c.sharepoint_tenant_id;if(!s)throw new Error("OneDrive configuration is incomplete");this.clientId=s,this.sharepointUrl=r,this.sharepointTenantId=a}async getMsalInstance(e){if(await this.ensureInitialized(e),!this.msalInstance){const i={auth:{authority:`https://login.microsoftonline.com/${this.currentAuthorityType==="organizations"?this.sharepointTenantId||"common":"consumers"}`,clientId:this.clientId}};this.msalInstance=new Dv(i),this.msalInstance.initialize&&await this.msalInstance.initialize()}return this.msalInstance}getAuthorityType(){return this.currentAuthorityType}getSharepointUrl(){return this.sharepointUrl}getSharepointTenantId(){return this.sharepointTenantId}getBaseUrl(){if(this.currentAuthorityType==="organizations"){if(!this.sharepointUrl||this.sharepointUrl==="")throw new Error("Sharepoint URL not configured");let e=this.sharepointUrl.replace(/^https?:\/\//,"");return e=e.replace(/\/$/,""),`https://${e}`}else return"https://onedrive.live.com/picker"}};ze(bu,"instance");let i2=bu;async function V6(n,e){const t=i2.getInstance();await t.ensureInitialized(e);const r={scopes:t.getAuthorityType()==="organizations"?[`${n||t.getBaseUrl()}/.default`]:["OneDrive.ReadWrite"]};let a="";try{a=(await(await t.getMsalInstance(e)).acquireTokenSilent(r)).accessToken}catch{const l=await t.getMsalInstance(e);try{const c=await l.loginPopup(r);l.setActiveAccount(c.account),c.idToken&&(a=(await l.acquireTokenSilent(r)).accessToken)}catch(c){throw new Error("Failed to login: "+(c instanceof Error?c.message:String(c)))}}if(!a)throw new Error("Failed to acquire access token");return a}function J$(){var i;const n=kl(),e=i2.getInstance(),t={sdk:"8.0",entry:{oneDrive:{}},authentication:{},messaging:{origin:((i=window==null?void 0:window.location)==null?void 0:i.origin)||"",channelId:n},typesAndSources:{mode:"files",pivots:{oneDrive:!0,recent:!0}}};return e.getAuthorityType()!=="organizations"&&(t.entry.oneDrive={files:{}}),t}async function Z$(n,e){const t=await V6(void 0,e);if(!t)throw new Error("Unable to retrieve OneDrive access token.");const i=`${n["@sharePoint.endpoint"]}/drives/${n.parentReference.driveId}/items/${n.id}`,s=await fetch(i,{headers:{Authorization:`Bearer ${t}`}});if(!s.ok)throw new Error(`Failed to fetch file information: ${s.status} ${s.statusText}`);const a=(await s.json())["@content.downloadUrl"];if(!a)throw new Error("Download URL not found in file data");const o=await fetch(a);if(!o.ok)throw new Error(`Failed to download file: ${o.status} ${o.statusText}`);return await o.blob()}async function Q$(n){if(typeof window>"u")throw new Error("Not in browser environment");const e=i2.getInstance();return await e.initialize(n),new Promise((t,i)=>{let s=null,r=null;const a=J$(),o=e.getBaseUrl(),l=d=>{var g;if(d.source!==s)return;const f=d.data;if((f==null?void 0:f.type)==="initialize"&&(f==null?void 0:f.channelId)===a.messaging.channelId){if(r=(g=d.ports)==null?void 0:g[0],!r)return;r.addEventListener("message",c),r.start(),r.postMessage({type:"activate"})}},c=async d=>{const f=d.data;switch(f.type){case"notification":break;case"command":{r==null||r.postMessage({type:"acknowledge",id:f.id});const g=f.data;switch(g.command){case"authenticate":{try{const m=e.getAuthorityType()==="organizations"?g.resource:void 0,x=await V6(m,n);if(x)r==null||r.postMessage({type:"result",id:f.id,data:{result:"token",token:x}});else throw new Error("Could not retrieve auth token")}catch{r==null||r.postMessage({type:"result",id:f.id,data:{result:"error",error:{code:"tokenError",message:"Failed to get token"}}})}break}case"close":{h(),t(null);break}case"pick":{r==null||r.postMessage({type:"result",id:f.id,data:{result:"success"}}),h(),t(g);break}default:{r==null||r.postMessage({result:"error",error:{code:"unsupportedCommand",message:g.command},isExpected:!0});break}}break}}};function h(){window.removeEventListener("message",l),r&&r.removeEventListener("message",c),s&&(s.close(),s=null)}(async()=>{try{const d=await V6(void 0,n);if(!d)return i(new Error("Failed to acquire access token"));if(s=window.open("","OneDrivePicker","width=800,height=600"),!s)return i(new Error("Failed to open OneDrive picker window"));const f=new URLSearchParams({filePicker:JSON.stringify(a)});let g="";e.getAuthorityType()==="organizations"?g=o+`/_layouts/15/FilePicker.aspx?${f}`:g=o+`?${f}`;const m=s.document.createElement("form");m.setAttribute("action",g),m.setAttribute("method","POST");const x=s.document.createElement("input");x.setAttribute("type","hidden"),x.setAttribute("name","access_token"),x.setAttribute("value",d),m.appendChild(x),s.document.body.appendChild(m),m.submit(),window.addEventListener("message",l)}catch(d){s&&s.close(),i(d)}})()})}async function $$(n){const e=await Q$(n);if(!e||!e.items||e.items.length===0)return null;const t=e.items[0];return{blob:await Z$(t,n),name:t.name}}function $C(n,e,t){const i=n.slice();return i[34]=e[t],i}function eee(n){let e;const t=n[20].default,i=zs(t,n,n[31],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r[1]&1)&&js(i,t,s,s[31],e?Vs(t,s[31],r,null):Gs(s[31]),null)},i(s){e||(H(i,s),e=!0)},o(s){q(i,s),e=!1},d(s){i&&i.d(s)}}}function tee(n){let e,t;return e=new yi({props:{content:n[12].t("More"),$$slots:{default:[eee]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&4096&&(r.content=i[12].t("More")),s[1]&1&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function eA(n){let e,t,i,s=Object.keys(n[9]).length>3,r,a,o,l=ni(Object.keys(n[9])),c=[];for(let d=0;d<l.length;d+=1)c[d]=tA($C(n,l,d));const h=d=>q(c[d],1,1,()=>{c[d]=null});let u=s&&nA(n);return{c(){e=ie("div");for(let d=0;d<c.length;d+=1)c[d].c();i=Se(),u&&u.c(),r=Se(),a=ie("hr"),this.h()},l(d){e=se(d,"DIV",{class:!0});var f=V(e);for(let g=0;g<c.length;g+=1)c[g].l(f);f.forEach(E),i=Ie(d),u&&u.l(d),r=Ie(d),a=se(d,"HR",{class:!0}),this.h()},h(){A(e,"class",t=(n[10]?"":"max-h-28")+" overflow-y-auto scrollbar-thin"),A(a,"class","border-black/5 dark:border-white/5 my-1")},m(d,f){te(d,e,f);for(let g=0;g<c.length;g+=1)c[g]&&c[g].m(e,null);te(d,i,f),u&&u.m(d,f),te(d,r,f),te(d,a,f),o=!0},p(d,f){if(f[0]&513){l=ni(Object.keys(d[9]));let g;for(g=0;g<l.length;g+=1){const m=$C(d,l,g);c[g]?(c[g].p(m,f),H(c[g],1)):(c[g]=tA(m),c[g].c(),H(c[g],1),c[g].m(e,null))}for(yt(),g=l.length;g<c.length;g+=1)h(g);wt()}(!o||f[0]&1024&&t!==(t=(d[10]?"":"max-h-28")+" overflow-y-auto scrollbar-thin"))&&A(e,"class",t),f[0]&512&&(s=Object.keys(d[9]).length>3),s?u?u.p(d,f):(u=nA(d),u.c(),u.m(r.parentNode,r)):u&&(u.d(1),u=null)},i(d){if(!o){for(let f=0;f<l.length;f+=1)H(c[f]);o=!0}},o(d){c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)q(c[f]);o=!1},d(d){d&&(E(e),E(i),E(r),E(a)),vo(c,d),u&&u.d(d)}}}function nee(n){let e,t,i,s,r=n[9][n[34]].name+"",a,o;return t=new ZD({}),{c(){e=ie("div"),be(t.$$.fragment),i=Se(),s=ie("div"),a=At(r),this.h()},l(l){e=se(l,"DIV",{class:!0});var c=V(e);ve(t.$$.fragment,c),c.forEach(E),i=Ie(l),s=se(l,"DIV",{class:!0});var h=V(s);a=St(h,r),h.forEach(E),this.h()},h(){A(e,"class","shrink-0"),A(s,"class","truncate")},m(l,c){te(l,e,c),xe(t,e,null),te(l,i,c),te(l,s,c),W(s,a),o=!0},p(l,c){(!o||c[0]&512)&&r!==(r=l[9][l[34]].name+"")&&Pt(a,r)},i(l){o||(H(t.$$.fragment,l),o=!0)},o(l){q(t.$$.fragment,l),o=!1},d(l){l&&(E(e),E(i),E(s)),ye(t)}}}function tA(n){var f;let e,t,i,s,r,a,o,l,c,h;i=new yi({props:{content:((f=n[9][n[34]])==null?void 0:f.description)??"",placement:"top-start",className:"flex flex-1 gap-2 items-center",$$slots:{default:[nee]},$$scope:{ctx:n}}});function u(...g){return n[21](n[34],...g)}a=new JD({props:{state:n[9][n[34]].enabled}}),a.$on("change",u);function d(){return n[22](n[34])}return{c(){e=ie("button"),t=ie("div"),be(i.$$.fragment),s=Se(),r=ie("div"),be(a.$$.fragment),o=Se(),this.h()},l(g){e=se(g,"BUTTON",{class:!0});var m=V(e);t=se(m,"DIV",{class:!0});var x=V(t);ve(i.$$.fragment,x),x.forEach(E),s=Ie(m),r=se(m,"DIV",{class:!0});var p=V(r);ve(a.$$.fragment,p),p.forEach(E),o=Ie(m),m.forEach(E),this.h()},h(){A(t,"class","flex-1 truncate"),A(r,"class","shrink-0"),A(e,"class","flex w-full justify-between gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl")},m(g,m){te(g,e,m),W(e,t),xe(i,t,null),W(e,s),W(e,r),xe(a,r,null),W(e,o),l=!0,c||(h=xt(e,"click",d),c=!0)},p(g,m){var y;n=g;const x={};m[0]&512&&(x.content=((y=n[9][n[34]])==null?void 0:y.description)??""),m[0]&512|m[1]&1&&(x.$$scope={dirty:m,ctx:n}),i.$set(x);const p={};m[0]&512&&(p.state=n[9][n[34]].enabled),a.$set(p)},i(g){l||(H(i.$$.fragment,g),H(a.$$.fragment,g),l=!0)},o(g){q(i.$$.fragment,g),q(a.$$.fragment,g),l=!1},d(g){g&&E(e),ye(i),ye(a),c=!1,h()}}}function nA(n){let e,t,i,s,r,a,o;return{c(){e=ie("button"),t=lt("svg"),i=lt("path"),this.h()},l(l){e=se(l,"BUTTON",{class:!0,title:!0});var c=V(e);t=ct(c,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var h=V(t);i=ct(h,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(i).forEach(E),h.forEach(E),c.forEach(E),this.h()},h(){A(i,"stroke-linecap","round"),A(i,"stroke-linejoin","round"),A(i,"d","m19.5 8.25-7.5 7.5-7.5-7.5"),A(t,"xmlns","http://www.w3.org/2000/svg"),A(t,"fill","none"),A(t,"viewBox","0 0 24 24"),A(t,"stroke-width","2.5"),A(t,"stroke","currentColor"),A(t,"class",s="size-3 transition-transform duration-200 "+(n[10]?"rotate-180":"")+" text-gray-300 dark:text-gray-600"),A(e,"class","flex w-full justify-center items-center text-sm font-medium cursor-pointer rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800"),A(e,"title",r=n[10]?n[12].t("Show Less"):n[12].t("Show All"))},m(l,c){te(l,e,c),W(e,t),W(t,i),a||(o=xt(e,"click",n[23]),a=!0)},p(l,c){c[0]&1024&&s!==(s="size-3 transition-transform duration-200 "+(l[10]?"rotate-180":"")+" text-gray-300 dark:text-gray-600")&&A(t,"class",s),c[0]&5120&&r!==(r=l[10]?l[12].t("Show Less"):l[12].t("Show All"))&&A(e,"title",r)},d(l){l&&E(e),a=!1,o()}}}function iee(n){let e,t,i,s=n[12].t("Capture")+"",r,a;return e=new rD({}),{c(){be(e.$$.fragment),t=Se(),i=ie("div"),r=At(s),this.h()},l(o){ve(e.$$.fragment,o),t=Ie(o),i=se(o,"DIV",{class:!0});var l=V(i);r=St(l,s),l.forEach(E),this.h()},h(){A(i,"class","line-clamp-1")},m(o,l){xe(e,o,l),te(o,t,l),te(o,i,l),W(i,r),a=!0},p(o,l){(!a||l[0]&4096)&&s!==(s=o[12].t("Capture")+"")&&Pt(r,s)},i(o){a||(H(e.$$.fragment,o),a=!0)},o(o){q(e.$$.fragment,o),a=!1},d(o){o&&(E(t),E(i)),ye(e,o)}}}function see(n){let e,t;return e=new ha({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl "+(n[11]?"":"opacity-50"),$$slots:{default:[iee]},$$scope:{ctx:n}}}),e.$on("click",n[24]),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&2048&&(r.class="flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl "+(i[11]?"":"opacity-50")),s[0]&4096|s[1]&1&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function ree(n){let e,t,i,s=n[12].t("Upload Files")+"",r,a;return e=new aD({}),{c(){be(e.$$.fragment),t=Se(),i=ie("div"),r=At(s),this.h()},l(o){ve(e.$$.fragment,o),t=Ie(o),i=se(o,"DIV",{class:!0});var l=V(i);r=St(l,s),l.forEach(E),this.h()},h(){A(i,"class","line-clamp-1")},m(o,l){xe(e,o,l),te(o,t,l),te(o,i,l),W(i,r),a=!0},p(o,l){(!a||l[0]&4096)&&s!==(s=o[12].t("Upload Files")+"")&&Pt(r,s)},i(o){a||(H(e.$$.fragment,o),a=!0)},o(o){q(e.$$.fragment,o),a=!1},d(o){o&&(E(t),E(i)),ye(e,o)}}}function aee(n){let e,t;return e=new ha({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl "+(n[11]?"":"opacity-50"),$$slots:{default:[ree]},$$scope:{ctx:n}}}),e.$on("click",n[25]),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&2048&&(r.class="flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl "+(i[11]?"":"opacity-50")),s[0]&4096|s[1]&1&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function iA(n){var a,o,l,c;let e,t,i,s=((o=(a=n[13])==null?void 0:a.features)==null?void 0:o.enable_google_drive_integration)&&sA(n),r=((c=(l=n[13])==null?void 0:l.features)==null?void 0:c.enable_onedrive_integration)&&rA(n);return{c(){s&&s.c(),e=Se(),r&&r.c(),t=Xt()},l(h){s&&s.l(h),e=Ie(h),r&&r.l(h),t=Xt()},m(h,u){s&&s.m(h,u),te(h,e,u),r&&r.m(h,u),te(h,t,u),i=!0},p(h,u){var d,f,g,m;(f=(d=h[13])==null?void 0:d.features)!=null&&f.enable_google_drive_integration?s?(s.p(h,u),u[0]&8192&&H(s,1)):(s=sA(h),s.c(),H(s,1),s.m(e.parentNode,e)):s&&(yt(),q(s,1,1,()=>{s=null}),wt()),(m=(g=h[13])==null?void 0:g.features)!=null&&m.enable_onedrive_integration?r?(r.p(h,u),u[0]&8192&&H(r,1)):(r=rA(h),r.c(),H(r,1),r.m(t.parentNode,t)):r&&(yt(),q(r,1,1,()=>{r=null}),wt())},i(h){i||(H(s),H(r),i=!0)},o(h){q(s),q(r),i=!1},d(h){h&&(E(e),E(t)),s&&s.d(h),r&&r.d(h)}}}function sA(n){let e,t;return e=new ha({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$slots:{default:[oee]},$$scope:{ctx:n}}}),e.$on("click",n[26]),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&4096|s[1]&1&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function oee(n){let e,t,i,s,r,a,o,l,c,h=n[12].t("Google Drive")+"",u;return{c(){e=lt("svg"),t=lt("path"),i=lt("path"),s=lt("path"),r=lt("path"),a=lt("path"),o=lt("path"),l=Se(),c=ie("div"),u=At(h),this.h()},l(d){e=ct(d,"svg",{xmlns:!0,viewBox:!0,class:!0});var f=V(e);t=ct(f,"path",{d:!0,fill:!0}),V(t).forEach(E),i=ct(f,"path",{d:!0,fill:!0}),V(i).forEach(E),s=ct(f,"path",{d:!0,fill:!0}),V(s).forEach(E),r=ct(f,"path",{d:!0,fill:!0}),V(r).forEach(E),a=ct(f,"path",{d:!0,fill:!0}),V(a).forEach(E),o=ct(f,"path",{d:!0,fill:!0}),V(o).forEach(E),f.forEach(E),l=Ie(d),c=se(d,"DIV",{class:!0});var g=V(c);u=St(g,h),g.forEach(E),this.h()},h(){A(t,"d","m6.6 66.85 3.85 6.65c.8 1.4 1.95 2.5 3.3 3.3l13.75-23.8h-27.5c0 1.55.4 3.1 1.2 4.5z"),A(t,"fill","#0066da"),A(i,"d","m43.65 25-13.75-23.8c-1.35.8-2.5 1.9-3.3 3.3l-25.4 44a9.06 9.06 0 0 0 -1.2 4.5h27.5z"),A(i,"fill","#00ac47"),A(s,"d","m73.55 76.8c1.35-.8 2.5-1.9 3.3-3.3l1.6-2.75 7.65-13.25c.8-1.4 1.2-2.95 1.2-4.5h-27.502l5.852 11.5z"),A(s,"fill","#ea4335"),A(r,"d","m43.65 25 13.75-23.8c-1.35-.8-2.9-1.2-4.5-1.2h-18.5c-1.6 0-3.15.45-4.5 1.2z"),A(r,"fill","#00832d"),A(a,"d","m59.8 53h-32.3l-13.75 23.8c1.35.8 2.9 1.2 4.5 1.2h50.8c1.6 0 3.15-.45 4.5-1.2z"),A(a,"fill","#2684fc"),A(o,"d","m73.4 26.5-12.7-22c-.8-1.4-1.95-2.5-3.3-3.3l-13.75 23.8 16.15 28h27.45c0-1.55-.4-3.1-1.2-4.5z"),A(o,"fill","#ffba00"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 87.3 78"),A(e,"class","w-5 h-5"),A(c,"class","line-clamp-1")},m(d,f){te(d,e,f),W(e,t),W(e,i),W(e,s),W(e,r),W(e,a),W(e,o),te(d,l,f),te(d,c,f),W(c,u)},p(d,f){f[0]&4096&&h!==(h=d[12].t("Google Drive")+"")&&Pt(u,h)},d(d){d&&(E(e),E(l),E(c))}}}function rA(n){let e,t;return e=new II({props:{$$slots:{default:[dee]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&20544|s[1]&1&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function lee(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,v,_,C,k,I=n[12].t("Microsoft OneDrive")+"",S;return{c(){e=lt("svg"),t=lt("mask"),i=lt("path"),s=lt("g"),r=lt("path"),a=lt("path"),o=lt("path"),l=lt("path"),c=lt("defs"),h=lt("linearGradient"),u=lt("stop"),d=lt("stop"),f=lt("linearGradient"),g=lt("stop"),m=lt("stop"),x=lt("linearGradient"),p=lt("stop"),y=lt("stop"),w=lt("linearGradient"),v=lt("stop"),_=lt("stop"),C=Se(),k=ie("div"),S=At(I),this.h()},l(R){e=ct(R,"svg",{xmlns:!0,viewBox:!0,class:!0,fill:!0});var P=V(e);t=ct(P,"mask",{id:!0,style:!0,maskUnits:!0,x:!0,y:!0,width:!0,height:!0});var D=V(t);i=ct(D,"path",{d:!0,fill:!0}),V(i).forEach(E),D.forEach(E),s=ct(P,"g",{mask:!0});var U=V(s);r=ct(U,"path",{d:!0,fill:!0}),V(r).forEach(E),a=ct(U,"path",{d:!0,fill:!0}),V(a).forEach(E),o=ct(U,"path",{d:!0,fill:!0}),V(o).forEach(E),l=ct(U,"path",{d:!0,fill:!0}),V(l).forEach(E),U.forEach(E),c=ct(P,"defs",{});var T=V(c);h=ct(T,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var G=V(h);u=ct(G,"stop",{"stop-color":!0}),V(u).forEach(E),d=ct(G,"stop",{offset:!0,"stop-color":!0}),V(d).forEach(E),G.forEach(E),f=ct(T,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var M=V(f);g=ct(M,"stop",{"stop-color":!0}),V(g).forEach(E),m=ct(M,"stop",{offset:!0,"stop-color":!0}),V(m).forEach(E),M.forEach(E),x=ct(T,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var F=V(x);p=ct(F,"stop",{"stop-color":!0}),V(p).forEach(E),y=ct(F,"stop",{offset:!0,"stop-color":!0}),V(y).forEach(E),F.forEach(E),w=ct(T,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var X=V(w);v=ct(X,"stop",{"stop-color":!0}),V(v).forEach(E),_=ct(X,"stop",{offset:!0,"stop-color":!0}),V(_).forEach(E),X.forEach(E),T.forEach(E),P.forEach(E),C=Ie(R),k=se(R,"DIV",{class:!0});var z=V(k);S=St(z,I),z.forEach(E),this.h()},h(){A(i,"d","M7.82979 26C3.50549 26 0 22.5675 0 18.3333C0 14.1921 3.35322 10.8179 7.54613 10.6716C9.27535 7.87166 12.4144 6 16 6C20.6308 6 24.5169 9.12183 25.5829 13.3335C29.1316 13.3603 32 16.1855 32 19.6667C32 23.0527 29 26 25.8723 25.9914L7.82979 26Z"),A(i,"fill","#C4C4C4"),A(t,"id","mask0_87_7796"),tn(t,"mask-type","alpha"),A(t,"maskUnits","userSpaceOnUse"),A(t,"x","0"),A(t,"y","6"),A(t,"width","32"),A(t,"height","20"),A(r,"d","M7.83017 26.0001C5.37824 26.0001 3.18957 24.8966 1.75391 23.1691L18.0429 16.3335L30.7089 23.4647C29.5926 24.9211 27.9066 26.0001 26.0004 25.9915C23.1254 26.0001 12.0629 26.0001 7.83017 26.0001Z"),A(r,"fill","url(#paint0_linear_87_7796)"),A(a,"d","M25.5785 13.3149L18.043 16.3334L30.709 23.4647C31.5199 22.4065 32.0004 21.0916 32.0004 19.6669C32.0004 16.1857 29.1321 13.3605 25.5833 13.3337C25.5817 13.3274 25.5801 13.3212 25.5785 13.3149Z"),A(a,"fill","url(#paint1_linear_87_7796)"),A(o,"d","M7.06445 10.7028L18.0423 16.3333L25.5779 13.3148C24.5051 9.11261 20.6237 6 15.9997 6C12.4141 6 9.27508 7.87166 7.54586 10.6716C7.3841 10.6773 7.22358 10.6877 7.06445 10.7028Z"),A(o,"fill","url(#paint2_linear_87_7796)"),A(l,"d","M1.7535 23.1687L18.0425 16.3331L7.06471 10.7026C3.09947 11.0792 0 14.3517 0 18.3331C0 20.1665 0.657197 21.8495 1.7535 23.1687Z"),A(l,"fill","url(#paint3_linear_87_7796)"),A(s,"mask","url(#mask0_87_7796)"),A(u,"stop-color","#2086B8"),A(d,"offset","1"),A(d,"stop-color","#46D3F6"),A(h,"id","paint0_linear_87_7796"),A(h,"x1","4.42591"),A(h,"y1","24.6668"),A(h,"x2","27.2309"),A(h,"y2","23.2764"),A(h,"gradientUnits","userSpaceOnUse"),A(g,"stop-color","#1694DB"),A(m,"offset","1"),A(m,"stop-color","#62C3FE"),A(f,"id","paint1_linear_87_7796"),A(f,"x1","23.8302"),A(f,"y1","19.6668"),A(f,"x2","30.2108"),A(f,"y2","15.2082"),A(f,"gradientUnits","userSpaceOnUse"),A(p,"stop-color","#0D3D78"),A(y,"offset","1"),A(y,"stop-color","#063B83"),A(x,"id","paint2_linear_87_7796"),A(x,"x1","8.51037"),A(x,"y1","7.33333"),A(x,"x2","23.3335"),A(x,"y2","15.9348"),A(x,"gradientUnits","userSpaceOnUse"),A(v,"stop-color","#16589B"),A(_,"offset","1"),A(_,"stop-color","#1464B7"),A(w,"id","paint3_linear_87_7796"),A(w,"x1","-0.340429"),A(w,"y1","19.9998"),A(w,"x2","14.5634"),A(w,"y2","14.4649"),A(w,"gradientUnits","userSpaceOnUse"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 32 32"),A(e,"class","w-5 h-5"),A(e,"fill","none"),A(k,"class","line-clamp-1")},m(R,P){te(R,e,P),W(e,t),W(t,i),W(e,s),W(s,r),W(s,a),W(s,o),W(s,l),W(e,c),W(c,h),W(h,u),W(h,d),W(c,f),W(f,g),W(f,m),W(c,x),W(x,p),W(x,y),W(c,w),W(w,v),W(w,_),te(R,C,P),te(R,k,P),W(k,S)},p(R,P){P[0]&4096&&I!==(I=R[12].t("Microsoft OneDrive")+"")&&Pt(S,I)},d(R){R&&(E(e),E(C),E(k))}}}function cee(n){let e,t=n[12].t("Microsoft OneDrive (personal)")+"",i;return{c(){e=ie("div"),i=At(t),this.h()},l(s){e=se(s,"DIV",{class:!0});var r=V(e);i=St(r,t),r.forEach(E),this.h()},h(){A(e,"class","line-clamp-1")},m(s,r){te(s,e,r),W(e,i)},p(s,r){r[0]&4096&&t!==(t=s[12].t("Microsoft OneDrive (personal)")+"")&&Pt(i,t)},d(s){s&&E(e)}}}function hee(n){let e,t,i=n[12].t("Microsoft OneDrive (work/school)")+"",s,r,a,o="Includes SharePoint";return{c(){e=ie("div"),t=ie("div"),s=At(i),r=Se(),a=ie("div"),a.textContent=o,this.h()},l(l){e=se(l,"DIV",{class:!0});var c=V(e);t=se(c,"DIV",{class:!0});var h=V(t);s=St(h,i),h.forEach(E),r=Ie(c),a=se(c,"DIV",{class:!0,"data-svelte-h":!0}),_o(a)!=="svelte-1rwtj43"&&(a.textContent=o),c.forEach(E),this.h()},h(){A(t,"class","line-clamp-1"),A(a,"class","text-xs text-gray-500"),A(e,"class","flex flex-col")},m(l,c){te(l,e,c),W(e,t),W(t,s),W(e,r),W(e,a)},p(l,c){c[0]&4096&&i!==(i=l[12].t("Microsoft OneDrive (work/school)")+"")&&Pt(s,i)},d(l){l&&E(e)}}}function uee(n){let e,t,i,s;return e=new ha({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$slots:{default:[cee]},$$scope:{ctx:n}}}),e.$on("click",n[27]),i=new ha({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$slots:{default:[hee]},$$scope:{ctx:n}}}),i.$on("click",n[28]),{c(){be(e.$$.fragment),t=Se(),be(i.$$.fragment)},l(r){ve(e.$$.fragment,r),t=Ie(r),ve(i.$$.fragment,r)},m(r,a){xe(e,r,a),te(r,t,a),xe(i,r,a),s=!0},p(r,a){const o={};a[0]&4096|a[1]&1&&(o.$$scope={dirty:a,ctx:r}),e.$set(o);const l={};a[0]&4096|a[1]&1&&(l.$$scope={dirty:a,ctx:r}),i.$set(l)},i(r){s||(H(e.$$.fragment,r),H(i.$$.fragment,r),s=!0)},o(r){q(e.$$.fragment,r),q(i.$$.fragment,r),s=!1},d(r){r&&E(t),ye(e,r),ye(i,r)}}}function dee(n){let e,t,i,s;return e=new EI({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl w-full",$$slots:{default:[lee]},$$scope:{ctx:n}}}),i=new TI({props:{class:"w-[calc(100vw-2rem)] max-w-[280px] rounded-xl px-1 py-1 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-sm",side:n[14]?"bottom":"right",sideOffset:n[14]?5:0,alignOffset:n[14]?0:-8,$$slots:{default:[uee]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment),t=Se(),be(i.$$.fragment)},l(r){ve(e.$$.fragment,r),t=Ie(r),ve(i.$$.fragment,r)},m(r,a){xe(e,r,a),te(r,t,a),xe(i,r,a),s=!0},p(r,a){const o={};a[0]&4096|a[1]&1&&(o.$$scope={dirty:a,ctx:r}),e.$set(o);const l={};a[0]&16384&&(l.side=r[14]?"bottom":"right"),a[0]&16384&&(l.sideOffset=r[14]?5:0),a[0]&16384&&(l.alignOffset=r[14]?0:-8),a[0]&4160|a[1]&1&&(l.$$scope={dirty:a,ctx:r}),i.$set(l)},i(r){s||(H(e.$$.fragment,r),H(i.$$.fragment,r),s=!0)},o(r){q(e.$$.fragment,r),q(i.$$.fragment,r),s=!1},d(r){r&&E(t),ye(e,r),ye(i,r)}}}function fee(n){let e=Object.keys(n[9]).length>0,t,i,s,r,a,o,l,c=e&&eA(n);i=new yi({props:{content:n[2].length!==n[1].length?n[12].t("Model(s) do not support file upload"):n[11]?"":n[12].t("You do not have permission to upload files."),className:"w-full",$$slots:{default:[see]},$$scope:{ctx:n}}}),r=new yi({props:{content:n[2].length!==n[1].length?n[12].t("Model(s) do not support file upload"):n[11]?"":n[12].t("You do not have permission to upload files."),className:"w-full",$$slots:{default:[aee]},$$scope:{ctx:n}}});let h=n[11]&&iA(n);return{c(){c&&c.c(),t=Se(),be(i.$$.fragment),s=Se(),be(r.$$.fragment),a=Se(),h&&h.c(),o=Xt()},l(u){c&&c.l(u),t=Ie(u),ve(i.$$.fragment,u),s=Ie(u),ve(r.$$.fragment,u),a=Ie(u),h&&h.l(u),o=Xt()},m(u,d){c&&c.m(u,d),te(u,t,d),xe(i,u,d),te(u,s,d),xe(r,u,d),te(u,a,d),h&&h.m(u,d),te(u,o,d),l=!0},p(u,d){d[0]&512&&(e=Object.keys(u[9]).length>0),e?c?(c.p(u,d),d[0]&512&&H(c,1)):(c=eA(u),c.c(),H(c,1),c.m(t.parentNode,t)):c&&(yt(),q(c,1,1,()=>{c=null}),wt());const f={};d[0]&6150&&(f.content=u[2].length!==u[1].length?u[12].t("Model(s) do not support file upload"):u[11]?"":u[12].t("You do not have permission to upload files.")),d[0]&6152|d[1]&1&&(f.$$scope={dirty:d,ctx:u}),i.$set(f);const g={};d[0]&6150&&(g.content=u[2].length!==u[1].length?u[12].t("Model(s) do not support file upload"):u[11]?"":u[12].t("You do not have permission to upload files.")),d[0]&6160|d[1]&1&&(g.$$scope={dirty:d,ctx:u}),r.$set(g),u[11]?h?(h.p(u,d),d[0]&2048&&H(h,1)):(h=iA(u),h.c(),H(h,1),h.m(o.parentNode,o)):h&&(yt(),q(h,1,1,()=>{h=null}),wt())},i(u){l||(H(c),H(i.$$.fragment,u),H(r.$$.fragment,u),H(h),l=!0)},o(u){q(c),q(i.$$.fragment,u),q(r.$$.fragment,u),q(h),l=!1},d(u){u&&(E(t),E(s),E(a),E(o)),c&&c.d(u),ye(i,u),ye(r,u),h&&h.d(u)}}}function gee(n){let e,t,i;return t=new Q6({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-sm",sideOffset:10,alignOffset:-8,side:"top",align:"start",transition:V5,$$slots:{default:[fee]},$$scope:{ctx:n}}}),{c(){e=ie("div"),be(t.$$.fragment),this.h()},l(s){e=se(s,"DIV",{slot:!0});var r=V(e);ve(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"slot","content")},m(s,r){te(s,e,r),xe(t,e,null),i=!0},p(s,r){const a={};r[0]&32383|r[1]&1&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(H(t.$$.fragment,s),i=!0)},o(s){q(t.$$.fragment,s),i=!1},d(s){s&&E(e),ye(t)}}}function mee(n){let e,t,i,s,r,a,o;function l(h){n[29](h)}let c={$$slots:{content:[gee],default:[tee]},$$scope:{ctx:n}};return n[8]!==void 0&&(c.show=n[8]),i=new $6({props:c}),Et.push(()=>Kt(i,"show",l)),i.$on("change",n[30]),{c(){e=ie("input"),t=Se(),be(i.$$.fragment),this.h()},l(h){e=se(h,"INPUT",{id:!0,type:!0,accept:!0,capture:!0,style:!0}),t=Ie(h),ve(i.$$.fragment,h),this.h()},h(){A(e,"id","camera-input"),A(e,"type","file"),A(e,"accept","image/*"),A(e,"capture","environment"),tn(e,"display","none")},m(h,u){te(h,e,u),te(h,t,u),xe(i,h,u),r=!0,a||(o=xt(e,"change",n[17]),a=!0)},p(h,u){const d={};u[0]&32383|u[1]&1&&(d.$$scope={dirty:u,ctx:h}),!s&&u[0]&256&&(s=!0,d.show=h[8],Wt(()=>s=!1)),i.$set(d)},i(h){r||(H(i.$$.fragment,h),r=!0)},o(h){q(i.$$.fragment,h),r=!1},d(h){h&&(E(e),E(t)),ye(i,h),a=!1,o()}}}function pee(n,e,t){let i,s,r,a,o;Oe(n,zd,j=>t(32,i=j)),Oe(n,w0,j=>t(19,s=j)),Oe(n,Gg,j=>t(13,a=j)),Oe(n,tx,j=>t(14,o=j));let{$$slots:l={},$$scope:c}=e;const h=qs("i18n");Oe(n,h,j=>t(12,r=j));let{selectedToolIds:u=[]}=e,{selectedModels:d=[]}=e,{fileUploadCapableModels:f=[]}=e,{screenCaptureHandler:g}=e,{uploadFilesHandler:m}=e,{inputFilesHandler:x}=e,{uploadGoogleDriveHandler:p}=e,{uploadOneDriveHandler:y}=e,{onClose:w}=e,v={},_=!1,C=!1,k=!0;const I=async()=>{i===null&&await zd.set(await Z6(localStorage.token)),t(9,v=i.reduce((j,ae,ge,ue)=>(j[ae.id]={name:ae.name,description:ae.meta.description,enabled:u.includes(ae.id)},j),{}))},S=()=>{const j=navigator.userAgent||navigator.vendor||window.opera;return/android|iphone|ipad|ipod|windows phone/i.test(j)};function R(j){var ge;const ae=Array.from((ge=j.target)==null?void 0:ge.files);ae&&ae.length>0&&x(ae)}const P=async(j,ae)=>{const ge=ae.detail;await un(),ge?t(0,u=[...u,j]):t(0,u=u.filter(ue=>ue!==j))},D=j=>{t(9,v[j].enabled=!v[j].enabled,v)},U=()=>{t(10,C=!C)},T=()=>{if(k)if(!S())g();else{const j=document.getElementById("camera-input");j&&j.click()}},G=()=>{k&&m()},M=()=>{p()},F=()=>{y("personal")},X=()=>{y("organizations")};function z(j){_=j,t(8,_)}const K=j=>{j.detail===!1&&w()};return n.$$set=j=>{"selectedToolIds"in j&&t(0,u=j.selectedToolIds),"selectedModels"in j&&t(1,d=j.selectedModels),"fileUploadCapableModels"in j&&t(2,f=j.fileUploadCapableModels),"screenCaptureHandler"in j&&t(3,g=j.screenCaptureHandler),"uploadFilesHandler"in j&&t(4,m=j.uploadFilesHandler),"inputFilesHandler"in j&&t(18,x=j.inputFilesHandler),"uploadGoogleDriveHandler"in j&&t(5,p=j.uploadGoogleDriveHandler),"uploadOneDriveHandler"in j&&t(6,y=j.uploadOneDriveHandler),"onClose"in j&&t(7,w=j.onClose),"$$scope"in j&&t(31,c=j.$$scope)},n.$$.update=()=>{var j,ae;n.$$.dirty[0]&256&&_&&I(),n.$$.dirty[0]&524294&&t(11,k=f.length===d.length&&((s==null?void 0:s.role)==="admin"||((ae=(j=s==null?void 0:s.permissions)==null?void 0:j.chat)==null?void 0:ae.file_upload)))},[u,d,f,g,m,p,y,w,_,v,C,k,r,a,o,h,S,R,x,s,l,P,D,U,T,G,M,F,X,z,K,c]}class bee extends Ht{constructor(e){super(),zt(this,e,pee,mee,qt,{selectedToolIds:0,selectedModels:1,fileUploadCapableModels:2,screenCaptureHandler:3,uploadFilesHandler:4,inputFilesHandler:18,uploadGoogleDriveHandler:5,uploadOneDriveHandler:6,onClose:7},null,[-1,-1])}}function aA(n,e,t){const i=n.slice();return i[9]=e[t],i}function oA(n,e,t){const i=n.slice();return i[12]=e[t],i}function lA(n,e,t){const i=n.slice();return i[15]=e[t],i}function cA(n){let e,t,i,s,r=n[3].length>0&&hA(n),a=ni(n[1]),o=[];for(let c=0;c<a.length;c+=1)o[c]=dA(lA(n,a,c));const l=c=>q(o[c],1,1,()=>{o[c]=null});return{c(){r&&r.c(),e=Se(),t=ie("div"),i=ie("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){r&&r.l(c),e=Ie(c),t=se(c,"DIV",{class:!0});var h=V(t);i=se(h,"DIV",{class:!0});var u=V(i);for(let d=0;d<o.length;d+=1)o[d].l(u);u.forEach(E),h.forEach(E),this.h()},h(){A(i,"class","text-sm dark:text-gray-300 mb-1"),A(t,"class","px-5 pb-3 w-full flex flex-col justify-center")},m(c,h){r&&r.m(c,h),te(c,e,h),te(c,t,h),W(t,i);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(i,null);s=!0},p(c,h){if(c[3].length>0?r?r.p(c,h):(r=hA(c),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),h&2){a=ni(c[1]);let u;for(u=0;u<a.length;u+=1){const d=lA(c,a,u);o[u]?(o[u].p(d,h),H(o[u],1)):(o[u]=dA(d),o[u].c(),H(o[u],1),o[u].m(i,null))}for(yt(),u=a.length;u<o.length;u+=1)l(u);wt()}},i(c){if(!s){for(let h=0;h<a.length;h+=1)H(o[h]);s=!0}},o(c){o=o.filter(Boolean);for(let h=0;h<o.length;h+=1)q(o[h]);s=!1},d(c){c&&(E(e),E(t)),r&&r.d(c),vo(o,c)}}}function hA(n){let e,t,i=n[2].t("Tools")+"",s;return{c(){e=ie("div"),t=ie("div"),s=At(i),this.h()},l(r){e=se(r,"DIV",{class:!0});var a=V(e);t=se(a,"DIV",{class:!0});var o=V(t);s=St(o,i),o.forEach(E),a.forEach(E),this.h()},h(){A(t,"class","text-base font-medium self-center"),A(e,"class","flex justify-between dark:text-gray-300 px-5 pb-1")},m(r,a){te(r,e,a),W(e,t),W(t,s)},p(r,a){a&4&&i!==(i=r[2].t("Tools")+"")&&Pt(s,i)},d(r){r&&E(e)}}}function uA(n){var s,r;let e,t=((r=(s=n[15])==null?void 0:s.meta)==null?void 0:r.description)+"",i;return{c(){e=ie("div"),i=At(t),this.h()},l(a){e=se(a,"DIV",{class:!0});var o=V(e);i=St(o,t),o.forEach(E),this.h()},h(){A(e,"class","text-xs text-gray-500")},m(a,o){te(a,e,o),W(e,i)},p(a,o){var l,c;o&2&&t!==(t=((c=(l=a[15])==null?void 0:l.meta)==null?void 0:c.description)+"")&&Pt(i,t)},d(a){a&&E(e)}}}function xee(n){var l,c,h;let e,t,i=((l=n[15])==null?void 0:l.name)+"",s,r,a,o=((h=(c=n[15])==null?void 0:c.meta)==null?void 0:h.description)&&uA(n);return{c(){e=ie("div"),t=ie("div"),s=At(i),r=Se(),o&&o.c(),a=Se(),this.h()},l(u){e=se(u,"DIV",{});var d=V(e);t=se(d,"DIV",{class:!0});var f=V(t);s=St(f,i),f.forEach(E),r=Ie(d),o&&o.l(d),d.forEach(E),a=Ie(u),this.h()},h(){A(t,"class","text-sm font-medium dark:text-gray-100 text-gray-800")},m(u,d){te(u,e,d),W(e,t),W(t,s),W(e,r),o&&o.m(e,null),te(u,a,d)},p(u,d){var f,g,m;d&2&&i!==(i=((f=u[15])==null?void 0:f.name)+"")&&Pt(s,i),(m=(g=u[15])==null?void 0:g.meta)!=null&&m.description?o?o.p(u,d):(o=uA(u),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(u){u&&(E(e),E(a)),o&&o.d()}}}function dA(n){let e,t;return e=new jg({props:{buttonClassName:"w-full mb-0.5",$$slots:{default:[xee]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s&262146&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function fA(n){let e,t,i=n[2].t("Tool Servers")+"",s,r,a,o,l=n[2].t("KMA LLM TextSum can use tools provided by any OpenAPI server.")+"",c,h,u,d,f=n[2].t("Learn more about OpenAPI tool servers.")+"",g,m,x,p,y=ni(n[3]),w=[];for(let _=0;_<y.length;_+=1)w[_]=mA(aA(n,y,_));const v=_=>q(w[_],1,1,()=>{w[_]=null});return{c(){e=ie("div"),t=ie("div"),s=At(i),r=Se(),a=ie("div"),o=ie("div"),c=At(l),h=Se(),u=ie("br"),d=ie("a"),g=At(f),m=Se(),x=ie("div");for(let _=0;_<w.length;_+=1)w[_].c();this.h()},l(_){e=se(_,"DIV",{class:!0});var C=V(e);t=se(C,"DIV",{class:!0});var k=V(t);s=St(k,i),k.forEach(E),C.forEach(E),r=Ie(_),a=se(_,"DIV",{class:!0});var I=V(a);o=se(I,"DIV",{class:!0});var S=V(o);c=St(S,l),h=Ie(S),u=se(S,"BR",{}),d=se(S,"A",{class:!0,href:!0,target:!0});var R=V(d);g=St(R,f),R.forEach(E),S.forEach(E),m=Ie(I),x=se(I,"DIV",{class:!0});var P=V(x);for(let D=0;D<w.length;D+=1)w[D].l(P);P.forEach(E),I.forEach(E),this.h()},h(){A(t,"class","text-base font-medium self-center"),A(e,"class","flex justify-between dark:text-gray-300 px-5 pb-0.5"),A(d,"class","underline"),A(d,"href","openapi-servers"),A(d,"target","_blank"),A(o,"class","text-xs text-gray-600 dark:text-gray-300 mb-2"),A(x,"class","text-sm dark:text-gray-300 mb-1"),A(a,"class","px-5 pb-5 w-full flex flex-col justify-center")},m(_,C){te(_,e,C),W(e,t),W(t,s),te(_,r,C),te(_,a,C),W(a,o),W(o,c),W(o,h),W(o,u),W(o,d),W(d,g),W(a,m),W(a,x);for(let k=0;k<w.length;k+=1)w[k]&&w[k].m(x,null);p=!0},p(_,C){if((!p||C&4)&&i!==(i=_[2].t("Tool Servers")+"")&&Pt(s,i),(!p||C&4)&&l!==(l=_[2].t("KMA LLM TextSum can use tools provided by any OpenAPI server.")+"")&&Pt(c,l),(!p||C&4)&&f!==(f=_[2].t("Learn more about OpenAPI tool servers.")+"")&&Pt(g,f),C&8){y=ni(_[3]);let k;for(k=0;k<y.length;k+=1){const I=aA(_,y,k);w[k]?(w[k].p(I,C),H(w[k],1)):(w[k]=mA(I),w[k].c(),H(w[k],1),w[k].m(x,null))}for(yt(),k=y.length;k<w.length;k+=1)v(k);wt()}},i(_){if(!p){for(let C=0;C<y.length;C+=1)H(w[C]);p=!0}},o(_){w=w.filter(Boolean);for(let C=0;C<w.length;C+=1)q(w[C]);p=!1},d(_){_&&(E(e),E(r),E(a)),vo(w,_)}}}function yee(n){var p,y,w,v,_,C,k,I,S,R;let e,t,i=((w=(y=(p=n[9])==null?void 0:p.openapi)==null?void 0:y.info)==null?void 0:w.title)+"",s,r,a=((C=(_=(v=n[9])==null?void 0:v.openapi)==null?void 0:_.info)==null?void 0:C.version)+"",o,l,c,h=((S=(I=(k=n[9])==null?void 0:k.openapi)==null?void 0:I.info)==null?void 0:S.description)+"",u,d,f,g=((R=n[9])==null?void 0:R.url)+"",m,x;return{c(){e=ie("div"),t=ie("div"),s=At(i),r=At(" - v"),o=At(a),l=Se(),c=ie("div"),u=At(h),d=Se(),f=ie("div"),m=At(g),x=Se(),this.h()},l(P){e=se(P,"DIV",{});var D=V(e);t=se(D,"DIV",{class:!0});var U=V(t);s=St(U,i),r=St(U," - v"),o=St(U,a),U.forEach(E),l=Ie(D),c=se(D,"DIV",{class:!0});var T=V(c);u=St(T,h),T.forEach(E),d=Ie(D),f=se(D,"DIV",{class:!0});var G=V(f);m=St(G,g),G.forEach(E),D.forEach(E),x=Ie(P),this.h()},h(){A(t,"class","text-sm font-medium dark:text-gray-100 text-gray-800"),A(c,"class","text-xs text-gray-500"),A(f,"class","text-xs text-gray-500")},m(P,D){te(P,e,D),W(e,t),W(t,s),W(t,r),W(t,o),W(e,l),W(e,c),W(c,u),W(e,d),W(e,f),W(f,m),te(P,x,D)},p(P,D){var U,T,G,M,F,X,z,K,j,ae;D&8&&i!==(i=((G=(T=(U=P[9])==null?void 0:U.openapi)==null?void 0:T.info)==null?void 0:G.title)+"")&&Pt(s,i),D&8&&a!==(a=((X=(F=(M=P[9])==null?void 0:M.openapi)==null?void 0:F.info)==null?void 0:X.version)+"")&&Pt(o,a),D&8&&h!==(h=((j=(K=(z=P[9])==null?void 0:z.openapi)==null?void 0:K.info)==null?void 0:j.description)+"")&&Pt(u,h),D&8&&g!==(g=((ae=P[9])==null?void 0:ae.url)+"")&&Pt(m,g)},d(P){P&&(E(e),E(x))}}}function gA(n){var c,h;let e,t,i=((c=n[12])==null?void 0:c.name)+"",s,r,a,o=((h=n[12])==null?void 0:h.description)+"",l;return{c(){e=ie("div"),t=ie("div"),s=At(i),r=Se(),a=ie("div"),l=At(o),this.h()},l(u){e=se(u,"DIV",{class:!0});var d=V(e);t=se(d,"DIV",{class:!0});var f=V(t);s=St(f,i),f.forEach(E),r=Ie(d),a=se(d,"DIV",{});var g=V(a);l=St(g,o),g.forEach(E),d.forEach(E),this.h()},h(){A(t,"class","font-medium text-gray-800 dark:text-gray-100"),A(e,"class","my-1")},m(u,d){te(u,e,d),W(e,t),W(t,s),W(e,r),W(e,a),W(a,l)},p(u,d){var f,g;d&8&&i!==(i=((f=u[12])==null?void 0:f.name)+"")&&Pt(s,i),d&8&&o!==(o=((g=u[12])==null?void 0:g.description)+"")&&Pt(l,o)},d(u){u&&E(e)}}}function wee(n){var r;let e,t,i=ni(((r=n[9])==null?void 0:r.specs)??[]),s=[];for(let a=0;a<i.length;a+=1)s[a]=gA(oA(n,i,a));return{c(){e=ie("div");for(let a=0;a<s.length;a+=1)s[a].c();t=Se(),this.h()},l(a){e=se(a,"DIV",{slot:!0});var o=V(e);for(let l=0;l<s.length;l+=1)s[l].l(o);t=Ie(o),o.forEach(E),this.h()},h(){A(e,"slot","content")},m(a,o){te(a,e,o);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);W(e,t)},p(a,o){var l;if(o&8){i=ni(((l=a[9])==null?void 0:l.specs)??[]);let c;for(c=0;c<i.length;c+=1){const h=oA(a,i,c);s[c]?s[c].p(h,o):(s[c]=gA(h),s[c].c(),s[c].m(e,t))}for(;c<s.length;c+=1)s[c].d(1);s.length=i.length}},d(a){a&&E(e),vo(s,a)}}}function mA(n){let e,t;return e=new jg({props:{buttonClassName:"w-full",chevron:!0,$$slots:{content:[wee],default:[yee]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s&262152&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function vee(n){let e,t,i,s=n[2].t("Available Tools")+"",r,a,o,l,c,h,u,d,f;l=new qg({props:{className:"size-5"}});let g=n[1].length>0&&cA(n),m=n[3].length>0&&fA(n);return{c(){e=ie("div"),t=ie("div"),i=ie("div"),r=At(s),a=Se(),o=ie("button"),be(l.$$.fragment),c=Se(),g&&g.c(),h=Se(),m&&m.c(),this.h()},l(x){e=se(x,"DIV",{});var p=V(e);t=se(p,"DIV",{class:!0});var y=V(t);i=se(y,"DIV",{class:!0});var w=V(i);r=St(w,s),w.forEach(E),a=Ie(y),o=se(y,"BUTTON",{class:!0});var v=V(o);ve(l.$$.fragment,v),v.forEach(E),y.forEach(E),c=Ie(p),g&&g.l(p),h=Ie(p),m&&m.l(p),p.forEach(E),this.h()},h(){A(i,"class","text-lg font-medium self-center"),A(o,"class","self-center"),A(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-0.5")},m(x,p){te(x,e,p),W(e,t),W(t,i),W(i,r),W(t,a),W(t,o),xe(l,o,null),W(e,c),g&&g.m(e,null),W(e,h),m&&m.m(e,null),u=!0,d||(f=xt(o,"click",n[7]),d=!0)},p(x,p){(!u||p&4)&&s!==(s=x[2].t("Available Tools")+"")&&Pt(r,s),x[1].length>0?g?(g.p(x,p),p&2&&H(g,1)):(g=cA(x),g.c(),H(g,1),g.m(e,h)):g&&(yt(),q(g,1,1,()=>{g=null}),wt()),x[3].length>0?m?(m.p(x,p),p&8&&H(m,1)):(m=fA(x),m.c(),H(m,1),m.m(e,null)):m&&(yt(),q(m,1,1,()=>{m=null}),wt())},i(x){u||(H(l.$$.fragment,x),H(g),H(m),u=!0)},o(x){q(l.$$.fragment,x),q(g),q(m),u=!1},d(x){x&&E(e),ye(l),g&&g.d(),m&&m.d(),d=!1,f()}}}function _ee(n){let e,t,i;function s(a){n[8](a)}let r={size:"md",$$slots:{default:[vee]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new nL({props:r}),Et.push(()=>Kt(e,"show",s)),{c(){be(e.$$.fragment)},l(a){ve(e.$$.fragment,a)},m(a,o){xe(e,a,o),i=!0},p(a,[o]){const l={};o&262159&&(l.$$scope={dirty:o,ctx:a}),!t&&o&1&&(t=!0,l.show=a[0],Wt(()=>t=!1)),e.$set(l)},i(a){i||(H(e.$$.fragment,a),i=!0)},o(a){q(e.$$.fragment,a),i=!1},d(a){ye(e,a)}}}function kee(n,e,t){let i,s,r;Oe(n,zd,d=>t(6,i=d)),Oe(n,AI,d=>t(3,r=d));let{show:a=!1}=e,{selectedToolIds:o=[]}=e,l=[];const c=qs("i18n");Oe(n,c,d=>t(2,s=d));const h=()=>{t(0,a=!1)};function u(d){a=d,t(0,a)}return n.$$set=d=>{"show"in d&&t(0,a=d.show),"selectedToolIds"in d&&t(5,o=d.selectedToolIds)},n.$$.update=()=>{n.$$.dirty&96&&t(1,l=(i??[]).filter(d=>o.includes(d.id)))},[a,l,s,r,c,o,i,h,u]}class Cee extends Ht{constructor(e){super(),zt(this,e,kee,_ee,qt,{show:0,selectedToolIds:5})}}function Aee(n){let e,t;return{c(){e=lt("svg"),t=lt("path"),this.h()},l(i){e=ct(i,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=V(e);t=ct(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),V(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"fill-rule","evenodd"),A(t,"d","M12 5a7 7 0 0 0-7 7v1.17c.313-.11.65-.17 1-.17h2a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H6a3 3 0 0 1-3-3v-6a9 9 0 0 1 18 0v6a3 3 0 0 1-3 3h-2a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h2c.35 0 .687.06 1 .17V12a7 7 0 0 0-7-7Z"),A(t,"clip-rule","evenodd"),A(e,"aria-hidden","true"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","currentColor"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width",n[1]),A(e,"stroke","currentColor"),A(e,"class",n[0])},m(i,s){te(i,e,s),W(e,t)},p(i,[s]){s&2&&A(e,"stroke-width",i[1]),s&1&&A(e,"class",i[0])},i:It,o:It,d(i){i&&E(e)}}}function See(n,e,t){let{className:i="w-4 h-4"}=e,{strokeWidth:s="0"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class Iee extends Ht{constructor(e){super(),zt(this,e,See,Aee,qt,{className:0,strokeWidth:1})}}function Eee(n){let e,t;return{c(){e=lt("svg"),t=lt("path"),this.h()},l(i){e=ct(i,"svg",{class:!0,"stroke-width":!0,"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0});var s=V(e);t=ct(s,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),V(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"stroke","currentColor"),A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"stroke-width","2"),A(t,"d","m3 16 5-7 6 6.5m6.5 2.5L16 13l-4.286 6M14 10h.01M4 19h16a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1Z"),A(e,"class",n[0]),A(e,"stroke-width",n[1]),A(e,"aria-hidden","true"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24")},m(i,s){te(i,e,s),W(e,t)},p(i,[s]){s&1&&A(e,"class",i[0]),s&2&&A(e,"stroke-width",i[1])},i:It,o:It,d(i){i&&E(e)}}}function Tee(n,e,t){let{className:i="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class Ree extends Ht{constructor(e){super(),zt(this,e,Tee,Eee,qt,{className:0,strokeWidth:1})}}function Mee(n){let e,t,i;return{c(){e=lt("svg"),t=lt("path"),i=lt("path"),this.h()},l(s){e=ct(s,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,"aria-hidden":!0,stroke:!0,class:!0});var r=V(e);t=ct(r,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(t).forEach(E),i=ct(r,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(i).forEach(E),r.forEach(E),this.h()},h(){A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"d","M21.75 6.75a4.5 4.5 0 0 1-4.884 4.484c-1.076-.091-2.264.071-2.95.904l-7.152 8.684a2.548 2.548 0 1 1-3.586-3.586l8.684-7.152c.833-.686.995-1.874.904-2.95a4.5 4.5 0 0 1 6.336-4.486l-3.276 3.276a3.004 3.004 0 0 0 2.25 2.25l3.276-3.276c.256.565.398 1.192.398 1.852Z"),A(i,"stroke-linecap","round"),A(i,"stroke-linejoin","round"),A(i,"d","M4.867 19.125h.008v.008h-.008v-.008Z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width",n[1]),A(e,"aria-hidden","true"),A(e,"stroke","currentColor"),A(e,"class",n[0])},m(s,r){te(s,e,r),W(e,t),W(e,i)},p(s,[r]){r&2&&A(e,"stroke-width",s[1]),r&1&&A(e,"class",s[0])},i:It,o:It,d(s){s&&E(e)}}}function Pee(n,e,t){let{className:i="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class Nee extends Ht{constructor(e){super(),zt(this,e,Pee,Mee,qt,{className:0,strokeWidth:1})}}function pA(n,e,t){const i=n.slice();return i[125]=e[t],i[127]=t,i}function bA(n,e,t){const i=n.slice();return i[128]=e[t],i[130]=t,i}function xA(n){var G;let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,v,_,C,k,I=n[8]===!1&&((G=n[14])==null?void 0:G.currentId)&&yA(n),S=n[0]!==void 0&&wA(n);function R(M){n[70](M)}let P={show:n[9],command:n[18],insertTextHandler:n[51],onUpload:n[67],onSelect:n[68]};n[2]!==void 0&&(P.files=n[2]),l=new lD({props:P}),n[69](l),Et.push(()=>Kt(l,"files",R));const D=[Dee,Oee],U=[];function T(M,F){return M[28]?0:1}return p=T(n),y=U[p]=D[p](n),{c(){e=ie("div"),t=ie("div"),i=ie("div"),s=ie("div"),I&&I.c(),r=Se(),a=ie("div"),S&&S.c(),o=Se(),be(l.$$.fragment),u=Se(),d=ie("div"),f=ie("div"),g=ie("div"),m=ie("input"),x=Se(),y.c(),this.h()},l(M){e=se(M,"DIV",{class:!0});var F=V(e);t=se(F,"DIV",{class:!0});var X=V(t);i=se(X,"DIV",{class:!0});var z=V(i);s=se(z,"DIV",{class:!0});var K=V(s);I&&I.l(K),K.forEach(E),r=Ie(z),a=se(z,"DIV",{class:!0});var j=V(a);S&&S.l(j),o=Ie(j),ve(l.$$.fragment,j),j.forEach(E),z.forEach(E),X.forEach(E),u=Ie(F),d=se(F,"DIV",{class:!0});var ae=V(d);f=se(ae,"DIV",{class:!0});var ge=V(f);g=se(ge,"DIV",{class:!0});var ue=V(g);m=se(ue,"INPUT",{type:!0}),x=Ie(ue),y.l(ue),ue.forEach(E),ge.forEach(E),ae.forEach(E),F.forEach(E),this.h()},h(){var M,F;A(s,"class","relative"),A(a,"class","w-full relative"),A(i,"class",h="flex flex-col px-3 "+(((M=n[43])==null?void 0:M.widescreenMode)??null?"max-w-full":"max-w-6xl")+" w-full"),A(t,"class","mx-auto inset-x-0 bg-transparent flex justify-center"),A(m,"type","file"),m.hidden=!0,m.multiple=!0,A(g,"class",""),A(f,"class",w=(((F=n[43])==null?void 0:F.widescreenMode)??null?"max-w-full":"max-w-6xl")+" px-2.5 mx-auto inset-x-0"),A(d,"class",v=n[10]?"bg-transparent":"bg-white dark:bg-gray-900"),A(e,"class","w-full font-primary")},m(M,F){te(M,e,F),W(e,t),W(t,i),W(i,s),I&&I.m(s,null),W(i,r),W(i,a),S&&S.m(a,null),W(a,o),xe(l,a,null),W(e,u),W(e,d),W(d,f),W(f,g),W(g,m),n[71](m),W(g,x),U[p].m(g,null),_=!0,C||(k=[xt(m,"change",n[72]),xt(m,"change",n[73])],C=!0)},p(M,F){var K,j,ae;M[8]===!1&&((K=M[14])!=null&&K.currentId)?I?I.p(M,F):(I=yA(M),I.c(),I.m(s,null)):I&&(I.d(1),I=null),M[0]!==void 0?S?(S.p(M,F),F[0]&1&&H(S,1)):(S=wA(M),S.c(),H(S,1),S.m(a,o)):S&&(yt(),q(S,1,1,()=>{S=null}),wt());const X={};F[0]&512&&(X.show=M[9]),F[0]&262144&&(X.command=M[18]),F[0]&4&&(X.onUpload=M[67]),F[0]&1&&(X.onSelect=M[68]),!c&&F[0]&4&&(c=!0,X.files=M[2],Wt(()=>c=!1)),l.$set(X),(!_||F[1]&4096&&h!==(h="flex flex-col px-3 "+(((j=M[43])==null?void 0:j.widescreenMode)??null?"max-w-full":"max-w-6xl")+" w-full"))&&A(i,"class",h);let z=p;p=T(M),p===z?U[p].p(M,F):(yt(),q(U[z],1,1,()=>{U[z]=null}),wt(),y=U[p],y?y.p(M,F):(y=U[p]=D[p](M),y.c()),H(y,1),y.m(g,null)),(!_||F[1]&4096&&w!==(w=(((ae=M[43])==null?void 0:ae.widescreenMode)??null?"max-w-full":"max-w-6xl")+" px-2.5 mx-auto inset-x-0"))&&A(f,"class",w),(!_||F[0]&1024&&v!==(v=M[10]?"bg-transparent":"bg-white dark:bg-gray-900"))&&A(d,"class",v)},i(M){_||(H(S),H(l.$$.fragment,M),H(y),_=!0)},o(M){q(S),q(l.$$.fragment,M),q(y),_=!1},d(M){M&&E(e),I&&I.d(),S&&S.d(),n[69](null),ye(l),n[71](null),U[p].d(),C=!1,Zr(k)}}}function yA(n){let e,t,i='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z" clip-rule="evenodd"></path></svg>',s,r;return{c(){e=ie("div"),t=ie("button"),t.innerHTML=i,this.h()},l(a){e=se(a,"DIV",{class:!0});var o=V(e);t=se(o,"BUTTON",{class:!0,"data-svelte-h":!0}),_o(t)!=="svelte-h8r9o0"&&(t.innerHTML=i),o.forEach(E),this.h()},h(){A(t,"class","bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full pointer-events-auto"),A(e,"class","absolute -top-12 left-0 right-0 flex justify-center z-30 pointer-events-none")},m(a,o){te(a,e,o),W(e,t),s||(r=xt(t,"click",n[64]),s=!0)},p:It,d(a){a&&E(e),s=!1,r()}}}function wA(n){let e,t,i,s,r,a,o,l,c,h=n[0].name+"",u,d,f,g,m,x,p,y;return m=new qg({}),{c(){e=ie("div"),t=ie("div"),i=ie("div"),s=ie("img"),a=Se(),o=ie("div"),l=At("Talking to "),c=ie("span"),u=At(h),d=Se(),f=ie("div"),g=ie("button"),be(m.$$.fragment),this.h()},l(w){e=se(w,"DIV",{class:!0});var v=V(e);t=se(v,"DIV",{class:!0});var _=V(t);i=se(_,"DIV",{class:!0});var C=V(i);s=se(C,"IMG",{crossorigin:!0,alt:!0,class:!0,src:!0}),a=Ie(C),o=se(C,"DIV",{class:!0});var k=V(o);l=St(k,"Talking to "),c=se(k,"SPAN",{class:!0});var I=V(c);u=St(I,h),I.forEach(E),k.forEach(E),C.forEach(E),d=Ie(_),f=se(_,"DIV",{});var S=V(f);g=se(S,"BUTTON",{class:!0});var R=V(g);ve(m.$$.fragment,R),R.forEach(E),S.forEach(E),_.forEach(E),v.forEach(E),this.h()},h(){var w,v,_;A(s,"crossorigin","anonymous"),A(s,"alt","model profile"),A(s,"class","size-3.5 max-w-[28px] object-cover rounded-full"),g0(s.src,r=((_=(v=(w=n[21].find(n[65]))==null?void 0:w.info)==null?void 0:v.meta)==null?void 0:_.profile_image_url)??(n[44].language==="dg-DG"?`${Yo}/doge.png`:`${Yo}/static/favicon.png`))||A(s,"src",r),A(c,"class","font-medium"),A(o,"class","translate-y-[0.5px]"),A(i,"class","pl-[1px] flex items-center gap-2 text-sm dark:text-gray-500"),A(g,"class","flex items-center dark:text-gray-500"),A(t,"class","flex items-center justify-between w-full"),A(e,"class","px-3 pb-0.5 pt-1.5 text-left w-full flex flex-col absolute bottom-0 left-0 right-0 bg-linear-to-t from-white dark:from-gray-900 z-10")},m(w,v){te(w,e,v),W(e,t),W(t,i),W(i,s),W(i,a),W(i,o),W(o,l),W(o,c),W(c,u),W(t,d),W(t,f),W(f,g),xe(m,g,null),x=!0,p||(y=xt(g,"click",n[66]),p=!0)},p(w,v){var _,C,k;(!x||v[0]&2097153|v[1]&8192&&!g0(s.src,r=((k=(C=(_=w[21].find(w[65]))==null?void 0:_.info)==null?void 0:C.meta)==null?void 0:k.profile_image_url)??(w[44].language==="dg-DG"?`${Yo}/doge.png`:`${Yo}/static/favicon.png`)))&&A(s,"src",r),(!x||v[0]&1)&&h!==(h=w[0].name+"")&&Pt(u,h)},i(w){x||(H(m.$$.fragment,w),x=!0)},o(w){q(m.$$.fragment,w),x=!1},d(w){w&&E(e),ye(m),p=!1,y()}}}function Oee(n){var j,ae,ge,ue,pe,de;let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,v,_,C,k=n[2].length>0&&vA(n);const I=[Hee,Uee],S=[];function R(O,Y){var le;return((le=O[43])==null?void 0:le.richTextInput)??!0?0:1}r=R(n),a=S[r]=I[r](n);function P(O){n[102](O)}let D={selectedModels:n[0]?[n[0].id]:n[13],fileUploadCapableModels:n[37],screenCaptureHandler:n[53],inputFilesHandler:n[55],uploadFilesHandler:n[98],uploadGoogleDriveHandler:n[99],uploadOneDriveHandler:n[100],onClose:n[101],$$slots:{default:[zee]},$$scope:{ctx:n}};n[3]!==void 0&&(D.selectedToolIds=n[3]),h=new bee({props:D}),Et.push(()=>Kt(h,"selectedToolIds",P));let U=n[20]&&(n[39]||n[38]&&n[38].length>0||n[40]||n[41]||n[42])&&CA(n),T=(!((j=n[14])!=null&&j.currentId)||((ae=n[14].messages[n[14].currentId])==null?void 0:ae.done)==!0)&&(((ge=n[20])==null?void 0:ge.role)==="admin"||(((de=(pe=(ue=n[20])==null?void 0:ue.permissions)==null?void 0:pe.chat)==null?void 0:de.stt)??!0))&&RA(n);const G=[Qee,Zee,Jee],M=[];function F(O,Y){var le,$,re,oe,ee;return O[15]&&O[15].length>0||O[14].currentId&&((le=O[14].messages[O[14].currentId])==null?void 0:le.done)!=!0?0:O[1]===""&&O[2].length===0&&((($=O[20])==null?void 0:$.role)==="admin"||(((ee=(oe=(re=O[20])==null?void 0:re.permissions)==null?void 0:oe.chat)==null?void 0:ee.call)??!0))?1:2}x=F(n),p=M[x]=G[x](n);function X(O,Y){var le,$;return($=(le=O[19])==null?void 0:le.license_metadata)!=null&&$.input_footer?ite:nte}let z=X(n),K=z(n);return{c(){e=ie("form"),t=ie("div"),k&&k.c(),i=Se(),s=ie("div"),a.c(),o=Se(),l=ie("div"),c=ie("div"),be(h.$$.fragment),d=Se(),U&&U.c(),f=Se(),g=ie("div"),T&&T.c(),m=Se(),p.c(),w=Se(),K.c(),this.h()},l(O){e=se(O,"FORM",{class:!0});var Y=V(e);t=se(Y,"DIV",{class:!0,dir:!0});var le=V(t);k&&k.l(le),i=Ie(le),s=se(le,"DIV",{class:!0});var $=V(s);a.l($),$.forEach(E),o=Ie(le),l=se(le,"DIV",{class:!0,dir:!0});var re=V(l);c=se(re,"DIV",{class:!0});var oe=V(c);ve(h.$$.fragment,oe),d=Ie(oe),U&&U.l(oe),oe.forEach(E),f=Ie(re),g=se(re,"DIV",{class:!0});var ee=V(g);T&&T.l(ee),m=Ie(ee),p.l(ee),ee.forEach(E),re.forEach(E),le.forEach(E),w=Ie(Y),K.l(Y),Y.forEach(E),this.h()},h(){var O;A(s,"class","px-2.5"),A(c,"class","ml-1 self-end flex items-center flex-1 max-w-[80%]"),A(g,"class","self-end flex space-x-1 mr-1 shrink-0"),A(l,"class","flex justify-between mt-0.5 mb-2.5 mx-0.5 max-w-full"),A(l,"dir","ltr"),A(t,"class","flex-1 flex flex-col relative w-full shadow-lg rounded-3xl border border-gray-50 dark:border-gray-850 hover:border-gray-100 focus-within:border-gray-100 hover:dark:border-gray-800 focus-within:dark:border-gray-800 transition px-1 bg-white/90 dark:bg-gray-400/5 dark:text-gray-100"),A(t,"dir",y=((O=n[43])==null?void 0:O.chatDirection)??"auto"),A(e,"class","w-full flex flex-col gap-1.5")},m(O,Y){te(O,e,Y),W(e,t),k&&k.m(t,null),W(t,i),W(t,s),S[r].m(s,null),W(t,o),W(t,l),W(l,c),xe(h,c,null),W(c,d),U&&U.m(c,null),W(l,f),W(l,g),T&&T.m(g,null),W(g,m),M[x].m(g,null),W(e,w),K.m(e,null),v=!0,_||(C=xt(e,"submit",zg(n[111])),_=!0)},p(O,Y){var oe,ee,Q,je,Re,Ne,He;O[2].length>0?k?(k.p(O,Y),Y[0]&4&&H(k,1)):(k=vA(O),k.c(),H(k,1),k.m(t,i)):k&&(yt(),q(k,1,1,()=>{k=null}),wt());let le=r;r=R(O),r===le?S[r].p(O,Y):(yt(),q(S[le],1,1,()=>{S[le]=null}),wt(),a=S[r],a?a.p(O,Y):(a=S[r]=I[r](O),a.c()),H(a,1),a.m(s,null));const $={};Y[0]&8193&&($.selectedModels=O[0]?[O[0].id]:O[13]),Y[1]&64&&($.fileUploadCapableModels=O[37]),Y[1]&1&&($.uploadFilesHandler=O[98]),Y[1]&8192&&($.uploadGoogleDriveHandler=O[99]),Y[4]&128&&($.$$scope={dirty:Y,ctx:O}),!u&&Y[0]&8&&(u=!0,$.selectedToolIds=O[3],Wt(()=>u=!1)),h.$set($),O[20]&&(O[39]||O[38]&&O[38].length>0||O[40]||O[41]||O[42])?U?(U.p(O,Y),Y[0]&1048576|Y[1]&3968&&H(U,1)):(U=CA(O),U.c(),H(U,1),U.m(c,null)):U&&(yt(),q(U,1,1,()=>{U=null}),wt()),(!((oe=O[14])!=null&&oe.currentId)||((ee=O[14].messages[O[14].currentId])==null?void 0:ee.done)==!0)&&(((Q=O[20])==null?void 0:Q.role)==="admin"||(((Ne=(Re=(je=O[20])==null?void 0:je.permissions)==null?void 0:Re.chat)==null?void 0:Ne.stt)??!0))?T?(T.p(O,Y),Y[0]&1064960&&H(T,1)):(T=RA(O),T.c(),H(T,1),T.m(g,m)):T&&(yt(),q(T,1,1,()=>{T=null}),wt());let re=x;x=F(O),x===re?M[x].p(O,Y):(yt(),q(M[re],1,1,()=>{M[re]=null}),wt(),p=M[x],p?p.p(O,Y):(p=M[x]=G[x](O),p.c()),H(p,1),p.m(g,null)),(!v||Y[1]&4096&&y!==(y=((He=O[43])==null?void 0:He.chatDirection)??"auto"))&&A(t,"dir",y),z===(z=X(O))&&K?K.p(O,Y):(K.d(1),K=z(O),K&&(K.c(),K.m(e,null)))},i(O){v||(H(k),H(a),H(h.$$.fragment,O),H(U),H(T),H(p),v=!0)},o(O){q(k),q(a),q(h.$$.fragment,O),q(U),q(T),q(p),v=!1},d(O){O&&E(e),k&&k.d(),S[r].d(),ye(h),U&&U.d(),T&&T.d(),M[x].d(),K.d(),_=!1,C()}}}function Dee(n){let e,t,i;function s(a){n[76](a)}let r={onCancel:n[74],onConfirm:n[75]};return n[28]!==void 0&&(r.recording=n[28]),e=new QD({props:r}),Et.push(()=>Kt(e,"recording",s)),{c(){be(e.$$.fragment)},l(a){ve(e.$$.fragment,a)},m(a,o){xe(e,a,o),i=!0},p(a,o){const l={};o[0]&268435456&&(l.onCancel=a[74]),o[0]&268435458|o[1]&4096&&(l.onConfirm=a[75]),!t&&o[0]&268435456&&(t=!0,l.recording=a[28],Wt(()=>t=!1)),e.$set(l)},i(a){i||(H(e.$$.fragment,a),i=!0)},o(a){q(e.$$.fragment,a),i=!1},d(a){ye(e,a)}}}function vA(n){let e,t,i=ni(n[2]),s=[];for(let a=0;a<i.length;a+=1)s[a]=kA(bA(n,i,a));const r=a=>q(s[a],1,1,()=>{s[a]=null});return{c(){e=ie("div");for(let a=0;a<s.length;a+=1)s[a].c();this.h()},l(a){e=se(a,"DIV",{class:!0});var o=V(e);for(let l=0;l<s.length;l+=1)s[l].l(o);o.forEach(E),this.h()},h(){A(e,"class","mx-2 mt-2.5 -mb-1 flex items-center flex-wrap gap-2")},m(a,o){te(a,e,o);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);t=!0},p(a,o){if(o[0]&8197|o[1]&12320){i=ni(a[2]);let l;for(l=0;l<i.length;l+=1){const c=bA(a,i,l);s[l]?(s[l].p(c,o),H(s[l],1)):(s[l]=kA(c),s[l].c(),H(s[l],1),s[l].m(e,null))}for(yt(),l=i.length;l<s.length;l+=1)r(l);wt()}},i(a){if(!t){for(let o=0;o<i.length;o+=1)H(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)q(s[o]);t=!1},d(a){a&&E(e),vo(s,a)}}}function Lee(n){var r,a;let e,t;function i(){return n[79](n[130])}function s(){return n[80](n[128])}return e=new RI({props:{item:n[128],name:n[128].name,type:n[128].type,size:(r=n[128])==null?void 0:r.size,loading:n[128].status==="uploading",dismissible:!0,edit:!0,modal:["file","collection"].includes((a=n[128])==null?void 0:a.type)}}),e.$on("dismiss",i),e.$on("click",s),{c(){be(e.$$.fragment)},l(o){ve(e.$$.fragment,o)},m(o,l){xe(e,o,l),t=!0},p(o,l){var h,u;n=o;const c={};l[0]&4&&(c.item=n[128]),l[0]&4&&(c.name=n[128].name),l[0]&4&&(c.type=n[128].type),l[0]&4&&(c.size=(h=n[128])==null?void 0:h.size),l[0]&4&&(c.loading=n[128].status==="uploading"),l[0]&4&&(c.modal=["file","collection"].includes((u=n[128])==null?void 0:u.type)),e.$set(c)},i(o){t||(H(e.$$.fragment,o),t=!0)},o(o){q(e.$$.fragment,o),t=!1},d(o){ye(e,o)}}}function Fee(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m;i=new eD({props:{src:n[128].url,alt:"",imageClassName:" size-14 rounded-xl object-cover"}});let x=(n[0]?n[36].length===0:n[13].length!==n[36].length)&&_A(n);function p(){return n[78](n[130])}return{c(){e=ie("div"),t=ie("div"),be(i.$$.fragment),s=Se(),x&&x.c(),r=Se(),a=ie("div"),o=ie("button"),l=lt("svg"),c=lt("path"),d=Se(),this.h()},l(y){e=se(y,"DIV",{class:!0});var w=V(e);t=se(w,"DIV",{class:!0});var v=V(t);ve(i.$$.fragment,v),s=Ie(v),x&&x.l(v),v.forEach(E),r=Ie(w),a=se(w,"DIV",{class:!0});var _=V(a);o=se(_,"BUTTON",{class:!0,type:!0,"aria-label":!0});var C=V(o);l=ct(C,"svg",{xmlns:!0,viewBox:!0,fill:!0,"aria-hidden":!0,class:!0});var k=V(l);c=ct(k,"path",{d:!0}),V(c).forEach(E),k.forEach(E),C.forEach(E),_.forEach(E),d=Ie(w),w.forEach(E),this.h()},h(){var y;A(t,"class","relative flex items-center"),A(c,"d","M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"),A(l,"xmlns","http://www.w3.org/2000/svg"),A(l,"viewBox","0 0 20 20"),A(l,"fill","currentColor"),A(l,"aria-hidden","true"),A(l,"class","size-4"),A(o,"class",h="bg-white text-black border border-white rounded-full "+(((y=n[43])==null?void 0:y.highContrastMode)??!1?"":"outline-hidden focus:outline-hidden group-hover:visible invisible transition")),A(o,"type","button"),A(o,"aria-label",u=n[44].t("Remove file")),A(a,"class","absolute -top-1 -right-1"),A(e,"class","relative group")},m(y,w){te(y,e,w),W(e,t),xe(i,t,null),W(t,s),x&&x.m(t,null),W(e,r),W(e,a),W(a,o),W(o,l),W(l,c),W(e,d),f=!0,g||(m=xt(o,"click",p),g=!0)},p(y,w){var _;n=y;const v={};w[0]&4&&(v.src=n[128].url),i.$set(v),(n[0]?n[36].length===0:n[13].length!==n[36].length)?x?(x.p(n,w),w[0]&8193|w[1]&32&&H(x,1)):(x=_A(n),x.c(),H(x,1),x.m(t,null)):x&&(yt(),q(x,1,1,()=>{x=null}),wt()),(!f||w[1]&4096&&h!==(h="bg-white text-black border border-white rounded-full "+(((_=n[43])==null?void 0:_.highContrastMode)??!1?"":"outline-hidden focus:outline-hidden group-hover:visible invisible transition")))&&A(o,"class",h),(!f||w[1]&8192&&u!==(u=n[44].t("Remove file")))&&A(o,"aria-label",u)},i(y){f||(H(i.$$.fragment,y),H(x),f=!0)},o(y){q(i.$$.fragment,y),q(x),f=!1},d(y){y&&E(e),ye(i),x&&x.d(),g=!1,m()}}}function _A(n){let e,t;return e=new yi({props:{className:" absolute top-1 left-1",content:n[44].t("{{ models }}",{models:[...n[0]?[n[0]]:n[13]].filter(n[77]).join(", ")}),$$slots:{default:[Bee]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&8193|s[1]&8224&&(r.content=i[44].t("{{ models }}",{models:[...i[0]?[i[0]]:i[13]].filter(i[77]).join(", ")})),s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Bee(n){let e,t;return{c(){e=lt("svg"),t=lt("path"),this.h()},l(i){e=ct(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,"aria-hidden":!0,class:!0});var s=V(e);t=ct(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),V(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"fill-rule","evenodd"),A(t,"d","M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"),A(t,"clip-rule","evenodd"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 24 24"),A(e,"fill","currentColor"),A(e,"aria-hidden","true"),A(e,"class","size-4 fill-yellow-300")},m(i,s){te(i,e,s),W(e,t)},p:It,d(i){i&&E(e)}}}function kA(n){let e,t,i,s;const r=[Fee,Lee],a=[];function o(l,c){return l[128].type==="image"?0:1}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=Xt()},l(l){t.l(l),i=Xt()},m(l,c){a[e].m(l,c),te(l,i,c),s=!0},p(l,c){let h=e;e=o(l),e===h?a[e].p(l,c):(yt(),q(a[h],1,1,()=>{a[h]=null}),wt(),t=a[e],t?t.p(l,c):(t=a[e]=r[e](l),t.c()),H(t,1),t.m(i.parentNode,i))},i(l){s||(H(t),s=!0)},o(l){q(t),s=!1},d(l){l&&E(i),a[e].d(l)}}}function Uee(n){let e,t,i,s,r;return{c(){e=ie("textarea"),this.h()},l(a){e=se(a,"TEXTAREA",{id:!0,dir:!0,class:!0,placeholder:!0,rows:!0}),V(e).forEach(E),this.h()},h(){var a;A(e,"id","chat-input"),A(e,"dir",t=((a=n[43])==null?void 0:a.chatDirection)??"auto"),A(e,"class","scrollbar-hidden bg-transparent dark:text-gray-200 outline-hidden w-full pt-3 px-1 resize-none"),A(e,"placeholder",i=n[17]?n[17]:n[44].t("Send a Message")),A(e,"rows","1")},m(a,o){te(a,e,o),n[88](e),xo(e,n[1]),s||(r=[xt(e,"input",n[89]),xt(e,"input",n[90]),xt(e,"click",n[91]),xt(e,"compositionstart",n[92]),xt(e,"compositionend",n[93]),xt(e,"keydown",n[94]),xt(e,"input",n[95]),xt(e,"focus",n[96]),xt(e,"paste",n[97])],s=!0)},p(a,o){var l;o[1]&4096&&t!==(t=((l=a[43])==null?void 0:l.chatDirection)??"auto")&&A(e,"dir",t),o[0]&131072|o[1]&8192&&i!==(i=a[17]?a[17]:a[44].t("Send a Message"))&&A(e,"placeholder",i),o[0]&2&&xo(e,a[1])},i:It,o:It,d(a){a&&E(e),n[88](null),s=!1,Zr(r)}}}function Hee(n){var r,a,o,l,c,h;let e,t,i,s={id:"chat-input",onChange:n[81],json:!0,messageInput:!0,showFormattingButtons:!1,insertPromptAsRichText:((r=n[43])==null?void 0:r.insertPromptAsRichText)??!1,shiftEnter:!(((a=n[43])==null?void 0:a.ctrlEnterToSend)??!1)&&(!n[45]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)),placeholder:n[17]?n[17]:n[44].t("Send a Message"),largeTextAsFile:(((o=n[43])==null?void 0:o.largeTextAsFile)??!1)&&!n[35],autocomplete:((c=(l=n[19])==null?void 0:l.features)==null?void 0:c.enable_autocomplete_generation)&&(((h=n[43])==null?void 0:h.promptAutocomplete)??!1),generateAutoCompletion:n[82],oncompositionstart:n[83],oncompositionend:n[84]};return t=new $D({props:s}),n[85](t),t.$on("keydown",n[86]),t.$on("paste",n[87]),{c(){e=ie("div"),be(t.$$.fragment),this.h()},l(u){e=se(u,"DIV",{class:!0,id:!0});var d=V(e);ve(t.$$.fragment,d),d.forEach(E),this.h()},h(){A(e,"class","scrollbar-hidden rtl:text-right ltr:text-left bg-transparent dark:text-gray-100 outline-hidden w-full pt-2.5 pb-[5px] px-1 resize-none h-fit max-h-80 overflow-auto"),A(e,"id","chat-input-container")},m(u,d){te(u,e,d),xe(t,e,null),i=!0},p(u,d){var g,m,x,p,y,w;const f={};d[0]&262146&&(f.onChange=u[81]),d[1]&4096&&(f.insertPromptAsRichText=((g=u[43])==null?void 0:g.insertPromptAsRichText)??!1),d[1]&20480&&(f.shiftEnter=!(((m=u[43])==null?void 0:m.ctrlEnterToSend)??!1)&&(!u[45]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))),d[0]&131072|d[1]&8192&&(f.placeholder=u[17]?u[17]:u[44].t("Send a Message")),d[1]&4112&&(f.largeTextAsFile=(((x=u[43])==null?void 0:x.largeTextAsFile)??!1)&&!u[35]),d[0]&524288|d[1]&4096&&(f.autocomplete=((y=(p=u[19])==null?void 0:p.features)==null?void 0:y.enable_autocomplete_generation)&&(((w=u[43])==null?void 0:w.promptAutocomplete)??!1)),d[0]&4210688|d[1]&8192&&(f.generateAutoCompletion=u[82]),d[0]&536870912&&(f.oncompositionstart=u[83]),d[0]&536870912&&(f.oncompositionend=u[84]),t.$set(f)},i(u){i||(H(t.$$.fragment,u),i=!0)},o(u){q(t.$$.fragment,u),i=!1},d(u){u&&E(e),n[85](null),ye(t)}}}function zee(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" aria-hidden="true" fill="currentColor" class="size-5"><path d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"></path></svg>';return{c(){e=ie("div"),e.innerHTML=t,this.h()},l(i){e=se(i,"DIV",{class:!0,"data-svelte-h":!0}),_o(e)!=="svelte-cdbbcu"&&(e.innerHTML=t),this.h()},h(){A(e,"class","bg-transparent hover:bg-gray-100 text-gray-800 dark:text-white dark:hover:bg-gray-800 rounded-full p-1.5 outline-hidden focus:outline-hidden")},m(i,s){te(i,e,s)},p:It,d(i){i&&E(e)}}}function CA(n){let e,t,i,s,r=[],a=new Map,o,l,c,h,u=n[39]&&AA(n),d=ni(n[38]);const f=p=>p[125].id;for(let p=0;p<d.length;p+=1){let y=pA(n,d,p),w=f(y);a.set(w,r[p]=SA(w,y))}let g=n[40]&&IA(n),m=n[41]&&EA(n),x=n[42]&&TA(n);return{c(){e=ie("div"),t=Se(),i=ie("div"),u&&u.c(),s=Se();for(let p=0;p<r.length;p+=1)r[p].c();o=Se(),g&&g.c(),l=Se(),m&&m.c(),c=Se(),x&&x.c(),this.h()},l(p){e=se(p,"DIV",{class:!0}),V(e).forEach(E),t=Ie(p),i=se(p,"DIV",{class:!0});var y=V(i);u&&u.l(y),s=Ie(y);for(let w=0;w<r.length;w+=1)r[w].l(y);o=Ie(y),g&&g.l(y),l=Ie(y),m&&m.l(y),c=Ie(y),x&&x.l(y),y.forEach(E),this.h()},h(){A(e,"class","flex self-center w-[1px] h-4 mx-1.5 bg-gray-50 dark:bg-gray-800"),A(i,"class","flex gap-1 items-center overflow-x-auto scrollbar-none flex-1")},m(p,y){te(p,e,y),te(p,t,y),te(p,i,y),u&&u.m(i,null),W(i,s);for(let w=0;w<r.length;w+=1)r[w]&&r[w].m(i,null);W(i,o),g&&g.m(i,null),W(i,l),m&&m.m(i,null),W(i,c),x&&x.m(i,null),h=!0},p(p,y){p[39]?u?(u.p(p,y),y[1]&256&&H(u,1)):(u=AA(p),u.c(),H(u,1),u.m(i,s)):u&&(yt(),q(u,1,1,()=>{u=null}),wt()),y[0]&16|y[1]&128&&(d=ni(p[38]),yt(),r=j5(r,y,f,1,p,d,a,i,G5,SA,o,pA),wt()),p[40]?g?(g.p(p,y),y[1]&512&&H(g,1)):(g=IA(p),g.c(),H(g,1),g.m(i,l)):g&&(yt(),q(g,1,1,()=>{g=null}),wt()),p[41]?m?(m.p(p,y),y[1]&1024&&H(m,1)):(m=EA(p),m.c(),H(m,1),m.m(i,c)):m&&(yt(),q(m,1,1,()=>{m=null}),wt()),p[42]?x?(x.p(p,y),y[1]&2048&&H(x,1)):(x=TA(p),x.c(),H(x,1),x.m(i,null)):x&&(yt(),q(x,1,1,()=>{x=null}),wt())},i(p){if(!h){H(u);for(let y=0;y<d.length;y+=1)H(r[y]);H(g),H(m),H(x),h=!0}},o(p){q(u);for(let y=0;y<r.length;y+=1)q(r[y]);q(g),q(m),q(x),h=!1},d(p){p&&(E(e),E(t),E(i)),u&&u.d();for(let y=0;y<r.length;y+=1)r[y].d();g&&g.d(),m&&m.d(),x&&x.d()}}}function AA(n){let e,t;return e=new yi({props:{content:n[44].t("{{COUNT}} Available Tools",{COUNT:n[16].length+n[3].length}),$$slots:{default:[jee]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&65544|s[1]&8192&&(r.content=i[44].t("{{COUNT}} Available Tools",{COUNT:i[16].length+i[3].length})),s[0]&67174408|s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function jee(n){let e,t,i,s,r=n[16].length+n[3].length+"",a,o,l,c;return t=new Nee({props:{className:"size-4",strokeWidth:"1.75"}}),{c(){e=ie("button"),be(t.$$.fragment),i=Se(),s=ie("span"),a=At(r),this.h()},l(h){e=se(h,"BUTTON",{class:!0,"aria-label":!0,type:!0});var u=V(e);ve(t.$$.fragment,u),i=Ie(u),s=se(u,"SPAN",{class:!0});var d=V(s);a=St(d,r),d.forEach(E),u.forEach(E),this.h()},h(){A(s,"class","text-sm font-medium text-gray-600 dark:text-gray-300"),A(e,"class","translate-y-[0.5px] flex gap-1 items-center text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200 rounded-lg p-1 self-center transition"),A(e,"aria-label","Available Tools"),A(e,"type","button")},m(h,u){te(h,e,u),xe(t,e,null),W(e,i),W(e,s),W(s,a),o=!0,l||(c=xt(e,"click",n[103]),l=!0)},p(h,u){(!o||u[0]&65544)&&r!==(r=h[16].length+h[3].length+"")&&Pt(a,r)},i(h){o||(H(t.$$.fragment,h),o=!0)},o(h){q(t.$$.fragment,h),o=!1},d(h){h&&E(e),ye(t),l=!1,c()}}}function Gee(n){let e,t;return e=new sL({props:{className:"size-4",strokeWidth:"1.75"}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p:It,i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Vee(n){let e,t,i,s,r;return{c(){e=ie("div"),t=ie("img"),this.h()},l(a){e=se(a,"DIV",{class:!0});var o=V(e);t=se(o,"IMG",{src:!0,class:!0,style:!0,alt:!0}),o.forEach(E),this.h()},h(){g0(t.src,i=n[125].icon)||A(t,"src",i),A(t,"class",s="size-3.5 "+(n[125].icon.includes("svg")?"dark:invert-[80%]":"")),tn(t,"fill","currentColor"),A(t,"alt",r=n[125].name),A(e,"class","size-4 items-center flex justify-center")},m(a,o){te(a,e,o),W(e,t)},p(a,o){o[1]&128&&!g0(t.src,i=a[125].icon)&&A(t,"src",i),o[1]&128&&s!==(s="size-3.5 "+(a[125].icon.includes("svg")?"dark:invert-[80%]":""))&&A(t,"class",s),o[1]&128&&r!==(r=a[125].name)&&A(t,"alt",r)},i:It,o:It,d(a){a&&E(e)}}}function qee(n){var x;let e,t,i,s,r,a=((x=n[125])==null?void 0:x.name)+"",o,l,c,h,u;const d=[Vee,Gee],f=[];function g(p,y){var w;return(w=p[125])!=null&&w.icon?0:1}t=g(n),i=f[t]=d[t](n);function m(){return n[104](n[125])}return{c(){e=ie("button"),i.c(),s=Se(),r=ie("span"),o=At(a),this.h()},l(p){e=se(p,"BUTTON",{type:!0,class:!0});var y=V(e);i.l(y),s=Ie(y),r=se(y,"SPAN",{class:!0});var w=V(r);o=St(w,a),w.forEach(E),y.forEach(E),this.h()},h(){A(r,"class","hidden @xl:block whitespace-nowrap overflow-hidden text-ellipsis leading-none pr-0.5"),A(e,"type","button"),A(e,"class",l="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(n[4].includes(n[125].id)?"text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300  ")+" capitalize")},m(p,y){te(p,e,y),f[t].m(e,null),W(e,s),W(e,r),W(r,o),c=!0,h||(u=xt(e,"click",zg(m)),h=!0)},p(p,y){var v;n=p;let w=t;t=g(n),t===w?f[t].p(n,y):(yt(),q(f[w],1,1,()=>{f[w]=null}),wt(),i=f[t],i?i.p(n,y):(i=f[t]=d[t](n),i.c()),H(i,1),i.m(e,s)),(!c||y[1]&128)&&a!==(a=((v=n[125])==null?void 0:v.name)+"")&&Pt(o,a),(!c||y[0]&16|y[1]&128&&l!==(l="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(n[4].includes(n[125].id)?"text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300  ")+" capitalize"))&&A(e,"class",l)},i(p){c||(H(i),c=!0)},o(p){q(i),c=!1},d(p){p&&E(e),f[t].d(),h=!1,u()}}}function SA(n,e){var r;let t,i,s;return i=new yi({props:{content:(r=e[125])==null?void 0:r.description,placement:"top",$$slots:{default:[qee]},$$scope:{ctx:e}}}),{key:n,first:null,c(){t=Xt(),be(i.$$.fragment),this.h()},l(a){t=Xt(),ve(i.$$.fragment,a),this.h()},h(){this.first=t},m(a,o){te(a,t,o),xe(i,a,o),s=!0},p(a,o){var c;e=a;const l={};o[1]&128&&(l.content=(c=e[125])==null?void 0:c.description),o[0]&16|o[1]&128|o[4]&128&&(l.$$scope={dirty:o,ctx:e}),i.$set(l)},i(a){s||(H(i.$$.fragment,a),s=!0)},o(a){q(i.$$.fragment,a),s=!1},d(a){a&&E(t),ye(i,a)}}}function IA(n){let e,t;return e=new yi({props:{content:n[44].t("Search the internet"),placement:"top",$$slots:{default:[Wee]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[1]&8192&&(r.content=i[44].t("Search the internet")),s[0]&64|s[1]&12288|s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Wee(n){let e,t,i,s,r=n[44].t("Web Search")+"",a,o,l,c,h;return t=new iL({props:{className:"size-4",strokeWidth:"1.75"}}),{c(){e=ie("button"),be(t.$$.fragment),i=Se(),s=ie("span"),a=At(r),this.h()},l(u){e=se(u,"BUTTON",{type:!0,class:!0});var d=V(e);ve(t.$$.fragment,d),i=Ie(d),s=se(d,"SPAN",{class:!0});var f=V(s);a=St(f,r),f.forEach(E),d.forEach(E),this.h()},h(){var u;A(s,"class","hidden @xl:block whitespace-nowrap overflow-hidden text-ellipsis leading-none pr-0.5"),A(e,"type","button"),A(e,"class",o="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(n[6]||(((u=n[43])==null?void 0:u.webSearch)??!1)==="always"?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 "))},m(u,d){te(u,e,d),xe(t,e,null),W(e,i),W(e,s),W(s,a),l=!0,c||(h=xt(e,"click",zg(n[105])),c=!0)},p(u,d){var f;(!l||d[1]&8192)&&r!==(r=u[44].t("Web Search")+"")&&Pt(a,r),(!l||d[0]&64|d[1]&4096&&o!==(o="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(u[6]||(((f=u[43])==null?void 0:f.webSearch)??!1)==="always"?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 ")))&&A(e,"class",o)},i(u){l||(H(t.$$.fragment,u),l=!0)},o(u){q(t.$$.fragment,u),l=!1},d(u){u&&E(e),ye(t),c=!1,h()}}}function EA(n){let e,t;return e=new yi({props:{content:n[44].t("Generate an image"),placement:"top",$$slots:{default:[Kee]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[1]&8192&&(r.content=i[44].t("Generate an image")),s[0]&32|s[1]&8192|s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Kee(n){let e,t,i,s,r=n[44].t("Image")+"",a,o,l,c,h;return t=new Ree({props:{className:"size-4",strokeWidth:"1.75"}}),{c(){e=ie("button"),be(t.$$.fragment),i=Se(),s=ie("span"),a=At(r),this.h()},l(u){e=se(u,"BUTTON",{type:!0,class:!0});var d=V(e);ve(t.$$.fragment,d),i=Ie(d),s=se(d,"SPAN",{class:!0});var f=V(s);a=St(f,r),f.forEach(E),d.forEach(E),this.h()},h(){A(s,"class","hidden @xl:block whitespace-nowrap overflow-hidden text-ellipsis leading-none pr-0.5"),A(e,"type","button"),A(e,"class",o="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(n[5]?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 "))},m(u,d){te(u,e,d),xe(t,e,null),W(e,i),W(e,s),W(s,a),l=!0,c||(h=xt(e,"click",zg(n[106])),c=!0)},p(u,d){(!l||d[1]&8192)&&r!==(r=u[44].t("Image")+"")&&Pt(a,r),(!l||d[0]&32&&o!==(o="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm rounded-full transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(u[5]?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 ")))&&A(e,"class",o)},i(u){l||(H(t.$$.fragment,u),l=!0)},o(u){q(t.$$.fragment,u),l=!1},d(u){u&&E(e),ye(t),c=!1,h()}}}function TA(n){let e,t;return e=new yi({props:{content:n[44].t("Execute code for analysis"),placement:"top",$$slots:{default:[Xee]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[1]&8192&&(r.content=i[44].t("Execute code for analysis")),s[0]&128|s[1]&12288|s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Xee(n){let e,t,i,s,r=n[44].t("Code Interpreter")+"",a,o,l,c,h,u;return t=new $O({props:{className:"size-4",strokeWidth:"1.75"}}),{c(){e=ie("button"),be(t.$$.fragment),i=Se(),s=ie("span"),a=At(r),this.h()},l(d){e=se(d,"BUTTON",{"aria-label":!0,"aria-pressed":!0,type:!0,class:!0});var f=V(e);ve(t.$$.fragment,f),i=Ie(f),s=se(f,"SPAN",{class:!0});var g=V(s);a=St(g,r),g.forEach(E),f.forEach(E),this.h()},h(){var d;A(s,"class","hidden @xl:block whitespace-nowrap overflow-hidden text-ellipsis leading-none pr-0.5"),A(e,"aria-label",o=n[7]?n[44].t("Disable Code Interpreter"):n[44].t("Enable Code Interpreter")),A(e,"aria-pressed",n[7]),A(e,"type","button"),A(e,"class",l="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm transition-colors duration-300 max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(n[7]?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 ")+" "+(((d=n[43])==null?void 0:d.highContrastMode)??!1?"m-1":"focus:outline-hidden rounded-full"))},m(d,f){te(d,e,f),xe(t,e,null),W(e,i),W(e,s),W(s,a),c=!0,h||(u=xt(e,"click",zg(n[107])),h=!0)},p(d,f){var g;(!c||f[1]&8192)&&r!==(r=d[44].t("Code Interpreter")+"")&&Pt(a,r),(!c||f[0]&128|f[1]&8192&&o!==(o=d[7]?d[44].t("Disable Code Interpreter"):d[44].t("Enable Code Interpreter")))&&A(e,"aria-label",o),(!c||f[0]&128)&&A(e,"aria-pressed",d[7]),(!c||f[0]&128|f[1]&4096&&l!==(l="px-2 @xl:px-2.5 py-2 flex gap-1.5 items-center text-sm transition-colors duration-300 max-w-full overflow-hidden hover:bg-gray-50 dark:hover:bg-gray-800 "+(d[7]?" text-sky-500 dark:text-sky-300 bg-sky-50 dark:bg-sky-200/5":"bg-transparent text-gray-600 dark:text-gray-300 ")+" "+(((g=d[43])==null?void 0:g.highContrastMode)??!1?"m-1":"focus:outline-hidden rounded-full")))&&A(e,"class",l)},i(d){c||(H(t.$$.fragment,d),c=!0)},o(d){q(t.$$.fragment,d),c=!1},d(d){d&&E(e),ye(t),h=!1,u()}}}function RA(n){let e,t;return e=new yi({props:{content:n[44].t("Dictate"),$$slots:{default:[Yee]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[1]&8192&&(r.content=i[44].t("Dictate")),s[0]&268435456|s[1]&8192|s[4]&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Yee(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 translate-y-[0.5px]"><path d="M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"></path><path d="M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"></path></svg>',i,s;return{c(){e=ie("button"),e.innerHTML=t,this.h()},l(r){e=se(r,"BUTTON",{id:!0,class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),_o(e)!=="svelte-4nqm9k"&&(e.innerHTML=t),this.h()},h(){A(e,"id","voice-input-button"),A(e,"class","text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200 transition rounded-full p-1.5 mr-0.5 self-center"),A(e,"type","button"),A(e,"aria-label","Voice Input")},m(r,a){te(r,e,a),i||(s=xt(e,"click",n[108]),i=!0)},p:It,d(r){r&&E(e),i=!1,s()}}}function Jee(n){let e,t,i;return t=new yi({props:{content:n[44].t("Send message"),$$slots:{default:[$ee]},$$scope:{ctx:n}}}),{c(){e=ie("div"),be(t.$$.fragment),this.h()},l(s){e=se(s,"DIV",{class:!0});var r=V(e);ve(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"class","flex items-center")},m(s,r){te(s,e,r),xe(t,e,null),i=!0},p(s,r){const a={};r[1]&8192&&(a.content=s[44].t("Send message")),r[0]&6|r[4]&128&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(H(t.$$.fragment,s),i=!0)},o(s){q(t.$$.fragment,s),i=!1},d(s){s&&E(e),ye(t)}}}function Zee(n){let e,t,i;return t=new yi({props:{content:n[44].t("Voice mode"),$$slots:{default:[ete]},$$scope:{ctx:n}}}),{c(){e=ie("div"),be(t.$$.fragment),this.h()},l(s){e=se(s,"DIV",{class:!0});var r=V(e);ve(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"class","flex items-center")},m(s,r){te(s,e,r),xe(t,e,null),i=!0},p(s,r){const a={};r[1]&8192&&(a.content=s[44].t("Voice mode")),r[0]&532480|r[1]&45056|r[4]&128&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(H(t.$$.fragment,s),i=!0)},o(s){q(t.$$.fragment,s),i=!1},d(s){s&&E(e),ye(t)}}}function Qee(n){let e,t,i;return t=new yi({props:{content:n[44].t("Stop"),$$slots:{default:[tte]},$$scope:{ctx:n}}}),{c(){e=ie("div"),be(t.$$.fragment),this.h()},l(s){e=se(s,"DIV",{class:!0});var r=V(e);ve(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"class","flex items-center")},m(s,r){te(s,e,r),xe(t,e,null),i=!0},p(s,r){const a={};r[1]&8192&&(a.content=s[44].t("Stop")),r[0]&4096|r[4]&128&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(H(t.$$.fragment,s),i=!0)},o(s){q(t.$$.fragment,s),i=!1},d(s){s&&E(e),ye(t)}}}function $ee(n){let e,t,i,s,r;return{c(){e=ie("button"),t=lt("svg"),i=lt("path"),this.h()},l(a){e=se(a,"BUTTON",{id:!0,class:!0,type:!0});var o=V(e);t=ct(o,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var l=V(t);i=ct(l,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),V(i).forEach(E),l.forEach(E),o.forEach(E),this.h()},h(){A(i,"fill-rule","evenodd"),A(i,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),A(i,"clip-rule","evenodd"),A(t,"xmlns","http://www.w3.org/2000/svg"),A(t,"viewBox","0 0 16 16"),A(t,"fill","currentColor"),A(t,"class","size-5"),A(e,"id","send-message-button"),A(e,"class",s=(n[1]===""&&n[2].length===0?"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled":"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ")+" transition rounded-full p-1.5 self-center"),A(e,"type","submit"),e.disabled=r=n[1]===""&&n[2].length===0},m(a,o){te(a,e,o),W(e,t),W(t,i)},p(a,o){o[0]&6&&s!==(s=(a[1]===""&&a[2].length===0?"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled":"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ")+" transition rounded-full p-1.5 self-center")&&A(e,"class",s),o[0]&6&&r!==(r=a[1]===""&&a[2].length===0)&&(e.disabled=r)},d(a){a&&E(e)}}}function ete(n){let e,t,i,s,r,a;return t=new Iee({props:{className:"size-5"}}),{c(){e=ie("button"),be(t.$$.fragment),this.h()},l(o){e=se(o,"BUTTON",{class:!0,type:!0,"aria-label":!0});var l=V(e);ve(t.$$.fragment,l),l.forEach(E),this.h()},h(){A(e,"class","bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full p-1.5 self-center"),A(e,"type","button"),A(e,"aria-label",i=n[44].t("Voice mode"))},m(o,l){te(o,e,l),xe(t,e,null),s=!0,r||(a=xt(e,"click",n[110]),r=!0)},p(o,l){(!s||l[1]&8192&&i!==(i=o[44].t("Voice mode")))&&A(e,"aria-label",i)},i(o){s||(H(t.$$.fragment,o),s=!0)},o(o){q(t.$$.fragment,o),s=!1},d(o){o&&E(e),ye(t),r=!1,a()}}}function tte(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z" clip-rule="evenodd"></path></svg>',i,s;return{c(){e=ie("button"),e.innerHTML=t,this.h()},l(r){e=se(r,"BUTTON",{class:!0,"data-svelte-h":!0}),_o(e)!=="svelte-nqxd5x"&&(e.innerHTML=t),this.h()},h(){A(e,"class","bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5")},m(r,a){te(r,e,a),i||(s=xt(e,"click",n[109]),i=!0)},p:It,d(r){r&&E(e),i=!1,s()}}}function nte(n){let e;return{c(){e=ie("div"),this.h()},l(t){e=se(t,"DIV",{class:!0}),V(e).forEach(E),this.h()},h(){A(e,"class","mb-1")},m(t,i){te(t,e,i)},p:It,d(t){t&&E(e)}}}function ite(n){var s,r;let e,t,i=n_.sanitize(_g((r=(s=n[19])==null?void 0:s.license_metadata)==null?void 0:r.input_footer))+"";return{c(){e=ie("div"),t=new yI(!1),this.h()},l(a){e=se(a,"DIV",{class:!0});var o=V(e);t=wI(o,!1),o.forEach(E),this.h()},h(){t.a=null,A(e,"class","text-xs text-gray-500 text-center line-clamp-1 marked")},m(a,o){te(a,e,o),t.m(i,e)},p(a,o){var l,c;o[0]&524288&&i!==(i=n_.sanitize(_g((c=(l=a[19])==null?void 0:l.license_metadata)==null?void 0:c.input_footer))+"")&&t.p(i)},d(a){a&&E(e)}}}function ste(n){let e,t,i,s,r,a,o,l,c,h;e=new tL({props:{show:n[34]}});function u(x){n[61](x)}let d={selectedToolIds:n[3]};n[26]!==void 0&&(d.show=n[26]),i=new Cee({props:d}),Et.push(()=>Kt(i,"show",u));function f(x){n[63](x)}let g={variables:n[24],onSave:n[62]};n[23]!==void 0&&(g.show=n[23]),a=new oD({props:g}),Et.push(()=>Kt(a,"show",f));let m=n[27]&&xA(n);return{c(){be(e.$$.fragment),t=Se(),be(i.$$.fragment),r=Se(),be(a.$$.fragment),l=Se(),m&&m.c(),c=Xt()},l(x){ve(e.$$.fragment,x),t=Ie(x),ve(i.$$.fragment,x),r=Ie(x),ve(a.$$.fragment,x),l=Ie(x),m&&m.l(x),c=Xt()},m(x,p){xe(e,x,p),te(x,t,p),xe(i,x,p),te(x,r,p),xe(a,x,p),te(x,l,p),m&&m.m(x,p),te(x,c,p),h=!0},p(x,p){const y={};p[1]&8&&(y.show=x[34]),e.$set(y);const w={};p[0]&8&&(w.selectedToolIds=x[3]),!s&&p[0]&67108864&&(s=!0,w.show=x[26],Wt(()=>s=!1)),i.$set(w);const v={};p[0]&16777216&&(v.variables=x[24]),p[0]&33554432&&(v.onSave=x[62]),!o&&p[0]&8388608&&(o=!0,v.show=x[23],Wt(()=>o=!1)),a.$set(v),x[27]?m?(m.p(x,p),p[0]&134217728&&H(m,1)):(m=xA(x),m.c(),H(m,1),m.m(c.parentNode,c)):m&&(yt(),q(m,1,1,()=>{m=null}),wt())},i(x){h||(H(e.$$.fragment,x),H(i.$$.fragment,x),H(a.$$.fragment,x),H(m),h=!0)},o(x){q(e.$$.fragment,x),q(i.$$.fragment,x),q(a.$$.fragment,x),q(m),h=!1},d(x){x&&(E(t),E(r),E(l),E(c)),ye(e,x),ye(i,x),ye(a,x),m&&m.d(x)}}}function rte(n,e,t){let i,s,r,a,o,l,c,h;Oe(n,Gg,J=>t(19,i=J)),Oe(n,ja,J=>t(43,s=J)),Oe(n,Od,J=>t(113,a=J)),Oe(n,w0,J=>t(20,o=J)),Oe(n,Vg,J=>t(21,l=J)),Oe(n,tx,J=>t(45,c=J)),Oe(n,Jw,J=>t(46,h=J)),ql.workerSrc=import.meta.url+"pdfjs-dist/build/pdf.worker.mjs";const u=Ka(),d=qs("i18n");Oe(n,d,J=>t(44,r=J));let{transparentBackground:f=!1}=e,{onChange:g=()=>{}}=e,{createMessagePair:m}=e,{stopResponse:x}=e,{autoScroll:p=!1}=e,{atSelectedModel:y=void 0}=e,{selectedModels:w}=e,v=[],{history:_}=e,{taskIds:C=null}=e,{prompt:k=""}=e,{files:I=[]}=e,{toolServers:S=[]}=e,{selectedToolIds:R=[]}=e,{selectedFilterIds:P=[]}=e,{imageGenerationEnabled:D=!1}=e,{webSearchEnabled:U=!1}=e,{codeInterpreterEnabled:T=!1}=e,G=!1,M={},F={};const X=async J=>{t(24,M=ID(J)),Object.keys(M).length>0&&t(23,G=!0)},z=async J=>{if(J.includes("{{CLIPBOARD}}")){const Xe=await navigator.clipboard.readText().catch(tt=>(on.error(r.t("Failed to read clipboard contents")),"{{CLIPBOARD}}")),kt=await navigator.clipboard.read();let _t=null;for(const tt of kt)for(const Rt of tt.types)if(Rt.startsWith("image/")){const Z=await tt.getType(Rt);_t=URL.createObjectURL(Z)}_t&&t(2,I=[...I,{type:"image",url:_t}]),J=J.replaceAll("{{CLIPBOARD}}",Xe)}if(J.includes("{{USER_LOCATION}}")){let Xe;try{Xe=await wD()}catch{on.error(r.t("Location access not allowed")),Xe="LOCATION_UNKNOWN"}J=J.replaceAll("{{USER_LOCATION}}",String(Xe))}if(J.includes("{{USER_NAME}}")){const Xe=(o==null?void 0:o.name)||"User";J=J.replaceAll("{{USER_NAME}}",Xe)}if(J.includes("{{USER_LANGUAGE}}")){const Xe=localStorage.getItem("locale")||"en-US";J=J.replaceAll("{{USER_LANGUAGE}}",Xe)}if(J.includes("{{CURRENT_DATE}}")){const Xe=vD();J=J.replaceAll("{{CURRENT_DATE}}",Xe)}if(J.includes("{{CURRENT_TIME}}")){const Xe=_D();J=J.replaceAll("{{CURRENT_TIME}}",Xe)}if(J.includes("{{CURRENT_DATETIME}}")){const Xe=kD();J=J.replaceAll("{{CURRENT_DATETIME}}",Xe)}if(J.includes("{{CURRENT_TIMEZONE}}")){const Xe=CD();J=J.replaceAll("{{CURRENT_TIMEZONE}}",Xe)}if(J.includes("{{CURRENT_WEEKDAY}}")){const Xe=AD();J=J.replaceAll("{{CURRENT_WEEKDAY}}",Xe)}return X(J),J},K=J=>{const Xe=document.getElementById("chat-input");if(Xe)if((s==null?void 0:s.richTextInput)??!0)re.replaceVariables(J),re.focus();else{const _t=(Xe.value||"").replace(/{{\s*([^|}]+)(?:\|[^}]*)?\s*}}/g,(tt,Rt)=>{const Z=Rt.trim();return J.hasOwnProperty(Z)?String(J[Z]):tt});Xe.value=_t,Xe.focus(),Xe.dispatchEvent(new Event("input",{bubbles:!0}))}},j=async J=>{const Xe=document.getElementById("chat-input");Xe&&(J=await z(J||""),(s==null?void 0:s.richTextInput)??!0?(re==null||re.setText(J),re==null||re.focus()):(Xe.value=J,t(1,k=J),Xe.focus(),Xe.dispatchEvent(new Event("input"))))},ae=()=>{const J=(_t,tt)=>{var at,We;if(typeof _t!="string"||tt==null)return"";const Rt=_t.slice(0,tt),Z=_t.slice(tt),Te=((at=Rt.match(/(?:^|\s)([^\s]*)$/))==null?void 0:at[1])||"",Pe=((We=Z.match(/^([^\s]*)/))==null?void 0:We[1])||"";return Te+Pe},Xe=document.getElementById("chat-input");let kt="";if(Xe)if((s==null?void 0:s.richTextInput)??!0)kt=re==null?void 0:re.getWordAtDocPos();else{const _t=Xe?Xe.selectionStart:k.length;kt=J(k,_t)}return kt},ge=J=>{const Xe=(_t,tt)=>{let Rt=tt,Z=tt;for(;Rt>0&&!/\s/.test(_t[Rt-1]);)--Rt;for(;Z<_t.length&&!/\s/.test(_t[Z]);)++Z;return{start:Rt,end:Z}},kt=document.getElementById("chat-input");if(kt)if((s==null?void 0:s.richTextInput)??!0)re==null||re.replaceCommandWithText(J);else{const _t=kt.selectionStart,{start:tt,end:Rt}=Xe(k,_t);t(1,k=k.slice(0,tt)+J+k.slice(Rt)),kt.focus(),kt.setSelectionRange(tt+J.length,tt+J.length)}},ue=async J=>{const Xe=document.getElementById("chat-input");if(!Xe)return;if(J=await z(J),pe)ge(J);else if((s==null?void 0:s.richTextInput)??!0)re==null||re.insertContent(J);else{const _t=Xe.selectionStart;t(1,k=k.slice(0,_t)+J+k.slice(_t)),Xe.focus(),Xe.setSelectionRange(_t+J.length,_t+J.length)}await un();const kt=document.getElementById("chat-input-container");if(kt&&(kt.scrollTop=kt.scrollHeight),await un(),Xe){Xe.focus(),Xe.dispatchEvent(new Event("input"));const _t=o_(k);if(_t.length>0){const tt=_t.at(0);if(await un(),!((s==null?void 0:s.richTextInput)??!0)){Xe.setSelectionRange(tt.startIndex,tt.endIndex+1),Xe.focus();const Rt=((tt==null?void 0:tt.startIndex)-(tt==null?void 0:tt.startIndex)%Xe.cols)/Xe.cols,Z=Xe.clientHeight/Xe.rows;Xe.scrollTop=Z*Rt}}else Xe.scrollTop=Xe.scrollHeight}};let pe="",{showCommands:de=!1}=e,O=!1,Y=!1,le=!1,$=!1,re,oe,ee,Q,je=!1,Re=!1,{placeholder:Ne=""}=e,He=[],Be=[],Je=[],ht=[],ot=[],Ye=[],rt=!1,me=!1,Mt=!1,ut=!1;const dt=()=>{const J=document.getElementById("messages-container");J.scrollTo({top:J.scrollHeight,behavior:"smooth"})},Ve=async()=>{try{const J=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"never"},audio:!1}),Xe=document.createElement("video");Xe.srcObject=J,await Xe.play();const kt=document.createElement("canvas");kt.width=Xe.videoWidth,kt.height=Xe.videoHeight,kt.getContext("2d").drawImage(Xe,0,0,kt.width,kt.height),J.getTracks().forEach(Rt=>Rt.stop()),window.focus();const tt=kt.toDataURL("image/png");t(2,I=[...I,{type:"image",url:tt}]),Xe.srcObject=null}catch(J){console.error("Error capturing screen:",J)}},Ot=async(J,Xe=!1)=>{var tt,Rt,Z,Te,Pe,at,We,Ge;if((o==null?void 0:o.role)!=="admin"&&!(((Rt=(tt=o==null?void 0:o.permissions)==null?void 0:tt.chat)==null?void 0:Rt.file_upload)??!0))return on.error(r.t("You do not have permission to upload files.")),null;const kt=kl(),_t={type:"file",file:"",id:null,url:"",name:J.name,collection_name:"",status:"uploading",size:J.size,error:"",itemId:kt,...Xe?{context:"full"}:{}};if(_t.size==0)return on.error(r.t("You cannot upload an empty file.")),null;if(t(2,I=[...I,_t]),a){const nt=await yD(J,pdfjsLib).catch(et=>(on.error(r.t("Failed to extract content from the file: {{error}}",{error:et})),null));if(nt===null)return on.error(r.t("Failed to extract content from the file.")),t(2,I=I.filter(et=>(et==null?void 0:et.itemId)!==kt)),null;J.name,J.size,_t.status="uploaded",_t.type="text",_t.content=nt,_t.id=kl(),t(2,I)}else try{let nt=null;(J.type.startsWith("audio/")||J.type.startsWith("video/"))&&((Te=(Z=s==null?void 0:s.audio)==null?void 0:Z.stt)!=null&&Te.language)&&(nt={language:(at=(Pe=s==null?void 0:s.audio)==null?void 0:Pe.stt)==null?void 0:at.language});const et=await YD(localStorage.token,J,nt);et?(et.id,_t.name,(We=et==null?void 0:et.meta)==null||We.collection_name,et.error&&(console.warn("File upload warning:",et.error),on.warning(et.error)),_t.status="uploaded",_t.file=et,_t.id=et.id,_t.collection_name=((Ge=et==null?void 0:et.meta)==null?void 0:Ge.collection_name)||(et==null?void 0:et.collection_name),_t.url=`${dD}/files/${et.id}`,t(2,I)):t(2,I=I.filter(vt=>(vt==null?void 0:vt.itemId)!==kt))}catch(nt){on.error(`${nt}`),t(2,I=I.filter(et=>(et==null?void 0:et.itemId)!==kt))}},rn=async J=>{var Xe,kt,_t;if((((Xe=i==null?void 0:i.file)==null?void 0:Xe.max_count)??null)!==null&&I.length+J.length>((kt=i==null?void 0:i.file)==null?void 0:kt.max_count)){on.error(r.t("You can only chat with a maximum of {{maxCount}} file(s) at a time.",{maxCount:(_t=i==null?void 0:i.file)==null?void 0:_t.max_count}));return}J.forEach(async tt=>{var Rt,Z,Te,Pe;if(tt.name,tt.type,tt.size,tt.name.split(".").at(-1),(((Rt=i==null?void 0:i.file)==null?void 0:Rt.max_size)??null)!==null&&tt.size>(((Z=i==null?void 0:i.file)==null?void 0:Z.max_size)??0)*1024*1024){tt.size,(((Te=i==null?void 0:i.file)==null?void 0:Te.max_size)??0)*1024*1024,on.error(r.t("File size should not exceed {{maxSize}} MB.",{maxSize:(Pe=i==null?void 0:i.file)==null?void 0:Pe.max_size}));return}if(tt.type.startsWith("image/")){if(He.length===0){on.error(r.t("Selected model(s) do not support image inputs"));return}const at=async(Ge,nt={},et={})=>{var Ci,gr,os,Co,fl,Ao;const vt=(nt==null?void 0:nt.imageCompression)??!1,En=((gr=(Ci=et==null?void 0:et.file)==null?void 0:Ci.image_compression)==null?void 0:gr.width)??null,vn=((Co=(os=et==null?void 0:et.file)==null?void 0:os.image_compression)==null?void 0:Co.height)??null;if(!vt&&!En&&!vn)return Ge;let cn=null,jn=null;return vt&&(cn=((fl=nt==null?void 0:nt.imageCompressionSize)==null?void 0:fl.width)??null,jn=((Ao=nt==null?void 0:nt.imageCompressionSize)==null?void 0:Ao.height)??null),En&&(cn===null||cn>En)&&(cn=En),vn&&(jn===null||jn>vn)&&(jn=vn),cn||jn?await SD(Ge,cn,jn):Ge};let We=new FileReader;We.onload=async Ge=>{let nt=Ge.target.result;nt=await at(nt,s,i),t(2,I=[...I,{type:"image",url:`${nt}`}])},We.readAsDataURL(tt.type==="image/heic"?await cD({blob:tt,toType:"image/jpeg"}):tt)}else Ot(tt)})},Me=J=>{var Xe,kt;J.preventDefault(),(kt=(Xe=J.dataTransfer)==null?void 0:Xe.types)!=null&&kt.includes("Files")?t(34,je=!0):t(34,je=!1)},Dt=()=>{t(34,je=!1)},gt=async J=>{var Xe,kt;if(J.preventDefault(),(Xe=J.dataTransfer)!=null&&Xe.files){const _t=Array.from((kt=J.dataTransfer)==null?void 0:kt.files);_t&&_t.length>0&&rn(_t)}t(34,je=!1)},jt=J=>{J.key==="Shift"&&t(35,Re=!0),J.key==="Escape"&&t(34,je=!1)},Fn=J=>{J.key==="Shift"&&t(35,Re=!1)},Kn=()=>{},ci=()=>{t(35,Re=!1)};ol(async()=>{t(27,Y=!0),window.setTimeout(()=>{const Xe=document.getElementById("chat-input");Xe==null||Xe.focus()},0),window.addEventListener("keydown",jt),window.addEventListener("keyup",Fn),window.addEventListener("focus",Kn),window.addEventListener("blur",ci),await un();const J=document.getElementById("chat-container");J==null||J.addEventListener("dragover",Me),J==null||J.addEventListener("drop",gt),J==null||J.addEventListener("dragleave",Dt)}),Gh(()=>{window.removeEventListener("keydown",jt),window.removeEventListener("keyup",Fn),window.removeEventListener("focus",Kn),window.removeEventListener("blur",ci);const J=document.getElementById("chat-container");J&&(J==null||J.removeEventListener("dragover",Me),J==null||J.removeEventListener("drop",gt),J==null||J.removeEventListener("dragleave",Dt))});function ji(J){O=J,t(26,O)}const xs=J=>{t(25,F={...F,...J}),K(F)};function hi(J){G=J,t(23,G)}const qi=()=>{t(8,p=!0),dt()},ys=J=>J.id===y.id,ki=()=>{t(0,y=void 0)},Tr=J=>{const{type:Xe,data:kt}=J;if(Xe==="file"){if(I.find(_t=>_t.id===kt.id))return;t(2,I=[...I,{...kt,status:"processed"}])}else u("upload",J)},Ks=J=>{var _t;const{type:Xe,data:kt}=J;Xe==="model"&&t(0,y=kt),(_t=document.getElementById("chat-input"))==null||_t.focus()};function Ss(J){Et[J?"unshift":"push"](()=>{ee=J,t(32,ee)})}function De(J){I=J,t(2,I)}function qe(J){Et[J?"unshift":"push"](()=>{oe=J,t(31,oe)})}function ft(){Q=this.files,t(33,Q)}const Vt=async()=>{if(Q&&Q.length>0){const J=Array.from(Q);rn(J)}else on.error(r.t("File not found."));t(31,oe.value="",oe)},sn=async()=>{var J;t(28,le=!1),await un(),(J=document.getElementById("chat-input"))==null||J.focus()},Bn=async J=>{var _t;const{text:Xe,filename:kt}=J;t(28,le=!1),await un(),ue(Xe),await un(),(_t=document.getElementById("chat-input"))==null||_t.focus(),((s==null?void 0:s.speechAutoSend)??!1)&&u("submit",k)};function Cn(J){le=J,t(28,le)}const Un=J=>!He.includes(J),zn=J=>{I.splice(J,1),t(2,I)},dl=async J=>{I.splice(J,1),t(2,I)},fr=J=>{},Qg=J=>{t(1,k=J.md),t(18,pe=ae())},$g=async J=>{(v.length===0||!v.at(0))&&on.error(r.t("Please select a model first."));const Xe=await UD(localStorage.token,v.at(0),J,_!=null&&_.currentId?Oa(_,_.currentId):null).catch(kt=>null);return Xe},em=()=>t(29,$=!0),tm=()=>t(29,$=!1);function nm(J){Et[J?"unshift":"push"](()=>{re=J,t(30,re)})}const im=async J=>{var _t;J=J.detail.event;const Xe=J.ctrlKey||J.metaKey,kt=document.getElementById("commands-container");if(J.key==="Escape"&&x(),Xe&&J.key==="Enter"&&J.shiftKey&&(J.preventDefault(),m(k)),k===""&&Xe&&J.key.toLowerCase()==="r"){J.preventDefault();const tt=[...document.getElementsByClassName("regenerate-response-button")].at(-1);tt==null||tt.click()}if(k===""&&J.key=="ArrowUp"){J.preventDefault();const tt=[...document.getElementsByClassName("user-message")].at(-1);if(tt){tt.scrollIntoView({block:"center"});const Rt=[...document.getElementsByClassName("edit-user-message-button")].at(-1);Rt==null||Rt.click()}}if(kt){if(kt&&J.key==="ArrowUp"&&(J.preventDefault(),ee.selectUp(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),kt&&J.key==="ArrowDown"&&(J.preventDefault(),ee.selectDown(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),kt&&J.key==="Tab"){J.preventDefault();const tt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);tt==null||tt.click()}if(kt&&J.key==="Enter"){J.preventDefault();const tt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);tt?tt==null||tt.click():(_t=document.getElementById("send-message-button"))==null||_t.click()}}else if(!c||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)){if($)return;((s==null?void 0:s.ctrlEnterToSend)??!1?(J.key==="Enter"||J.keyCode===13)&&Xe:(J.key==="Enter"||J.keyCode===13)&&!J.shiftKey)&&(J.preventDefault(),(k!==""||I.length>0)&&u("submit",k))}J.key==="Escape"&&(t(0,y=void 0),t(3,R=[]),t(4,P=[]),t(6,U=!1),t(5,D=!1),t(7,T=!1))},sm=async J=>{J=J.detail.event;const Xe=J.clipboardData||window.clipboardData;if(Xe&&Xe.items){for(const kt of Xe.items)if(kt.type.indexOf("image")!==-1){const _t=kt.getAsFile(),tt=new FileReader;tt.onload=function(Rt){t(2,I=[...I,{type:"image",url:`${Rt.target.result}`}])},tt.readAsDataURL(_t)}else if(kt.type==="text/plain"&&((s==null?void 0:s.largeTextAsFile)??!1)&&!Re){const _t=Xe.getData("text/plain");if(_t.length>r_){J.preventDefault();const tt=new Blob([_t],{type:"text/plain"}),Rt=new File([tt],`Pasted_Text_${Date.now()}.txt`,{type:"text/plain"});await Ot(Rt,!0)}}}};function rm(J){Et[J?"unshift":"push"](()=>{re=J,t(30,re)})}function am(){k=this.value,t(1,k)}const om=()=>{t(18,pe=ae())},lm=()=>{t(18,pe=ae())},cm=()=>t(29,$=!0),hm=()=>t(29,$=!1),um=async J=>{var _t;const Xe=J.ctrlKey||J.metaKey,kt=document.getElementById("commands-container");if(J.key==="Escape"&&x(),Xe&&J.key==="Enter"&&J.shiftKey&&(J.preventDefault(),m(k)),k===""&&Xe&&J.key.toLowerCase()==="r"){J.preventDefault();const tt=[...document.getElementsByClassName("regenerate-response-button")].at(-1);tt==null||tt.click()}if(k===""&&J.key=="ArrowUp"){J.preventDefault();const tt=[...document.getElementsByClassName("user-message")].at(-1),Rt=[...document.getElementsByClassName("edit-user-message-button")].at(-1);tt==null||tt.scrollIntoView({block:"center"}),Rt==null||Rt.click()}if(kt){if(kt&&J.key==="ArrowUp"){J.preventDefault(),ee.selectUp();const tt=document.getElementById("command-options-container"),Rt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);if(Rt&&tt){const Z=Rt.offsetTop,Te=Rt.offsetHeight,Pe=tt.clientHeight;tt.scrollTop=Z-Pe/2+Te/2}}if(kt&&J.key==="ArrowDown"){J.preventDefault(),ee.selectDown();const tt=document.getElementById("command-options-container"),Rt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);if(Rt&&tt){const Z=Rt.offsetTop,Te=Rt.offsetHeight,Pe=tt.clientHeight;tt.scrollTop=Z-Pe/2+Te/2}}if(kt&&J.key==="Enter"){J.preventDefault();const tt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);J.shiftKey?t(1,k=`${k}
`):tt?tt==null||tt.click():(_t=document.getElementById("send-message-button"))==null||_t.click()}if(kt&&J.key==="Tab"){J.preventDefault();const tt=[...document.getElementsByClassName("selected-command-option-button")].at(-1);tt==null||tt.click()}}else if(!c||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)){if($)return;const tt=J.ctrlKey||J.metaKey,Rt=(s==null?void 0:s.ctrlEnterToSend)??!1?(J.key==="Enter"||J.keyCode===13)&&tt:(J.key==="Enter"||J.keyCode===13)&&!J.shiftKey;Rt&&J.preventDefault(),(k!==""||I.length>0)&&Rt&&u("submit",k)}if(J.key==="Tab"){const tt=o_(k);if(tt.length>0){const Rt=tt.at(0);if(Rt&&J.target instanceof HTMLTextAreaElement){J.preventDefault(),J.target.setSelectionRange(Rt==null?void 0:Rt.startIndex,Rt.endIndex+1),J.target.focus();const Z=((Rt==null?void 0:Rt.startIndex)-(Rt==null?void 0:Rt.startIndex)%J.target.cols)/J.target.cols,Te=J.target.clientHeight/J.target.rows;J.target.scrollTop=Te*Z}}J.target.style.height="",J.target.style.height=Math.min(J.target.scrollHeight,320)+"px"}J.key==="Escape"&&(t(0,y=void 0),t(3,R=[]),t(4,P=[]),t(6,U=!1),t(5,D=!1),t(7,T=!1))},dm=async J=>{J.target.style.height="",J.target.style.height=Math.min(J.target.scrollHeight,320)+"px"},ke=async J=>{J.target.style.height="",J.target.style.height=Math.min(J.target.scrollHeight,320)+"px"},Oy=async J=>{const Xe=J.clipboardData||window.clipboardData;if(Xe&&Xe.items){for(const kt of Xe.items)if(kt.type.indexOf("image")!==-1){const _t=kt.getAsFile(),tt=new FileReader;tt.onload=function(Rt){t(2,I=[...I,{type:"image",url:`${Rt.target.result}`}])},tt.readAsDataURL(_t)}else if(kt.type==="text/plain"&&((s==null?void 0:s.largeTextAsFile)??!1)&&!Re){const _t=Xe.getData("text/plain");if(_t.length>r_){J.preventDefault();const tt=new Blob([_t],{type:"text/plain"}),Rt=new File([tt],`Pasted_Text_${Date.now()}.txt`,{type:"text/plain"});await Ot(Rt,!0)}}}},Dy=()=>{oe.click()},Ly=async()=>{try{const J=await wJ();if(J){const Xe=new File([J.blob],J.name,{type:J.blob.type});await Ot(Xe)}}catch(J){console.error("Google Drive Error:",J),on.error(r.t("Error accessing Google Drive: {{error}}",{error:J.message}))}},Fy=async J=>{try{const Xe=await $$(J);if(Xe){const kt=new File([Xe.blob],Xe.name,{type:Xe.blob.type||"application/octet-stream"});await Ot(kt)}}catch(Xe){console.error("OneDrive Error:",Xe)}},By=async()=>{await un();const J=document.getElementById("chat-input");J==null||J.focus()};function Uy(J){R=J,t(3,R)}const Hy=()=>{t(26,O=!O)},zy=J=>{P.includes(J.id)?t(4,P=P.filter(Xe=>Xe!==J.id)):t(4,P=[...P,J.id])},jy=()=>t(6,U=!U),Gy=()=>t(5,D=!D),Vy=()=>t(7,T=!T),qy=async()=>{try{let J=await navigator.mediaDevices.getUserMedia({audio:!0}).catch(function(Xe){return on.error(r.t("Permission denied when accessing microphone: {{error}}",{error:Xe})),null});J&&(t(28,le=!0),J.getTracks().forEach(kt=>kt.stop())),J=null}catch{on.error(r.t("Permission denied when accessing microphone"))}},Wy=()=>{x()},Ky=async()=>{var J,Xe,kt,_t,tt;if(w.length>1){on.error(r.t("Select only one model to call"));return}if(i.audio.stt.engine==="web"){on.error(r.t("Call feature is not supported when using Web STT engine"));return}try{let Rt=await navigator.mediaDevices.getUserMedia({audio:!0});Rt&&Rt.getTracks().forEach(Te=>Te.stop()),Rt=null,((Xe=(J=s.audio)==null?void 0:J.tts)==null?void 0:Xe.engine)==="browser-kokoro"&&(h||(await Jw.set(new rL({dtype:((tt=(_t=(kt=s.audio)==null?void 0:kt.tts)==null?void 0:_t.engineConfig)==null?void 0:tt.dtype)??"fp32"})),await h.init())),Fa.set(!0),Ki.set(!0)}catch{on.error(r.t("Permission denied when accessing media devices"))}},Xy=()=>{u("submit",k)};return n.$$set=J=>{"transparentBackground"in J&&t(10,f=J.transparentBackground),"onChange"in J&&t(56,g=J.onChange),"createMessagePair"in J&&t(11,m=J.createMessagePair),"stopResponse"in J&&t(12,x=J.stopResponse),"autoScroll"in J&&t(8,p=J.autoScroll),"atSelectedModel"in J&&t(0,y=J.atSelectedModel),"selectedModels"in J&&t(13,w=J.selectedModels),"history"in J&&t(14,_=J.history),"taskIds"in J&&t(15,C=J.taskIds),"prompt"in J&&t(1,k=J.prompt),"files"in J&&t(2,I=J.files),"toolServers"in J&&t(16,S=J.toolServers),"selectedToolIds"in J&&t(3,R=J.selectedToolIds),"selectedFilterIds"in J&&t(4,P=J.selectedFilterIds),"imageGenerationEnabled"in J&&t(5,D=J.imageGenerationEnabled),"webSearchEnabled"in J&&t(6,U=J.webSearchEnabled),"codeInterpreterEnabled"in J&&t(7,T=J.codeInterpreterEnabled),"showCommands"in J&&t(9,de=J.showCommands),"placeholder"in J&&t(17,Ne=J.placeholder)},n.$$.update=()=>{var J,Xe,kt,_t,tt,Rt,Z,Te,Pe;n.$$.dirty[0]&8193&&t(22,v=y!==void 0?[y.id]:w),n.$$.dirty[0]&254|n.$$.dirty[1]&33554432&&g({prompt:k,files:I.filter(at=>at.type!=="image").map(at=>({...at,user:void 0,access_control:void 0})),selectedToolIds:R,selectedFilterIds:P,imageGenerationEnabled:D,webSearchEnabled:U,codeInterpreterEnabled:T}),n.$$.dirty[0]&262144&&t(9,de=["/","#","@"].includes(pe==null?void 0:pe.charAt(0))||(pe==null?void 0:pe.slice(0,2))==="\\#"),n.$$.dirty[0]&2105345&&t(36,He=(y!=null&&y.id?[y.id]:w).filter(at=>{var We,Ge,nt,et;return((et=(nt=(Ge=(We=l.find(vt=>vt.id===at))==null?void 0:We.info)==null?void 0:Ge.meta)==null?void 0:nt.capabilities)==null?void 0:et.vision)??!0})),n.$$.dirty[0]&2105345&&t(37,Be=(y!=null&&y.id?[y.id]:w).filter(at=>{var We,Ge,nt,et;return((et=(nt=(Ge=(We=l.find(vt=>vt.id===at))==null?void 0:We.info)==null?void 0:Ge.meta)==null?void 0:nt.capabilities)==null?void 0:et.file_upload)??!0})),n.$$.dirty[0]&2105345&&t(58,Je=(y!=null&&y.id?[y.id]:w).filter(at=>{var We,Ge,nt,et;return((et=(nt=(Ge=(We=l.find(vt=>vt.id===at))==null?void 0:We.info)==null?void 0:Ge.meta)==null?void 0:nt.capabilities)==null?void 0:et.web_search)??!0})),n.$$.dirty[0]&2105345&&t(59,ht=(y!=null&&y.id?[y.id]:w).filter(at=>{var We,Ge,nt,et;return((et=(nt=(Ge=(We=l.find(vt=>vt.id===at))==null?void 0:We.info)==null?void 0:Ge.meta)==null?void 0:nt.capabilities)==null?void 0:et.image_generation)??!0})),n.$$.dirty[0]&2105345&&t(60,ot=(y!=null&&y.id?[y.id]:w).filter(at=>{var We,Ge,nt,et;return((et=(nt=(Ge=(We=l.find(vt=>vt.id===at))==null?void 0:We.info)==null?void 0:Ge.meta)==null?void 0:nt.capabilities)==null?void 0:et.code_interpreter)??!0})),n.$$.dirty[0]&2105345&&t(38,Ye=(y!=null&&y.id?[y.id]:w).map(at=>{var We;return((We=l.find(Ge=>Ge.id===at)||{})==null?void 0:We.filters)??[]}).reduce((at,We)=>at.filter(Ge=>We.some(nt=>nt.id===Ge.id)))),n.$$.dirty[0]&65544&&t(39,rt=S.length+R.length>0),n.$$.dirty[0]&1581057|n.$$.dirty[1]&134217728&&t(40,me=(y!=null&&y.id?[y.id]:w).length===Je.length&&((J=i==null?void 0:i.features)==null?void 0:J.enable_web_search)&&(o.role==="admin"||((kt=(Xe=o==null?void 0:o.permissions)==null?void 0:Xe.features)==null?void 0:kt.web_search))),n.$$.dirty[0]&1581057|n.$$.dirty[1]&268435456&&t(41,Mt=(y!=null&&y.id?[y.id]:w).length===ht.length&&((_t=i==null?void 0:i.features)==null?void 0:_t.enable_image_generation)&&(o.role==="admin"||((Rt=(tt=o==null?void 0:o.permissions)==null?void 0:tt.features)==null?void 0:Rt.image_generation))),n.$$.dirty[0]&1581057|n.$$.dirty[1]&536870912&&t(42,ut=(y!=null&&y.id?[y.id]:w).length===ot.length&&((Z=i==null?void 0:i.features)==null?void 0:Z.enable_code_interpreter)&&(o.role==="admin"||((Pe=(Te=o==null?void 0:o.permissions)==null?void 0:Te.features)==null?void 0:Pe.code_interpreter)))},[y,k,I,R,P,D,U,T,p,de,f,m,x,w,_,C,S,Ne,pe,i,o,l,v,G,M,F,O,Y,le,$,re,oe,ee,Q,je,Re,He,Be,Ye,rt,me,Mt,ut,s,r,c,h,u,d,K,ae,ue,dt,Ve,Ot,rn,g,j,Je,ht,ot,ji,xs,hi,qi,ys,ki,Tr,Ks,Ss,De,qe,ft,Vt,sn,Bn,Cn,Un,zn,dl,fr,Qg,$g,em,tm,nm,im,sm,rm,am,om,lm,cm,hm,um,dm,ke,Oy,Dy,Ly,Fy,By,Uy,Hy,zy,jy,Gy,Vy,qy,Wy,Ky,Xy]}class oO extends Ht{constructor(e){super(),zt(this,e,rte,ste,qt,{transparentBackground:10,onChange:56,createMessagePair:11,stopResponse:12,autoScroll:8,atSelectedModel:0,selectedModels:13,history:14,taskIds:15,prompt:1,files:2,toolServers:16,selectedToolIds:3,selectedFilterIds:4,imageGenerationEnabled:5,webSearchEnabled:6,codeInterpreterEnabled:7,setText:57,showCommands:9,placeholder:17},null,[-1,-1,-1,-1,-1])}get setText(){return this.$$.ctx[57]}}function MA(n,e,t){const i=n.slice();return i[13]=e[t],i[14]=e,i[15]=t,i}function PA(n){let e,t,i,s;const r=[ote,ate],a=[];function o(l,c){return l[15]===0?0:1}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=Xt()},l(l){t.l(l),i=Xt()},m(l,c){a[e].m(l,c),te(l,i,c),s=!0},p(l,c){t.p(l,c)},i(l){s||(H(t),s=!0)},o(l){q(t),s=!1},d(l){l&&E(i),a[e].d(l)}}}function ate(n){let e,t,i;return t=new yi({props:{content:n[5].t("Remove Model"),$$slots:{default:[lte]},$$scope:{ctx:n}}}),{c(){e=ie("div"),be(t.$$.fragment),this.h()},l(s){e=se(s,"DIV",{class:!0});var r=V(e);ve(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"class","self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]")},m(s,r){te(s,e,r),xe(t,e,null),i=!0},p(s,r){const a={};r&32&&(a.content=s[5].t("Remove Model")),r&65539&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(H(t.$$.fragment,s),i=!0)},o(s){q(t.$$.fragment,s),i=!1},d(s){s&&E(e),ye(t)}}}function ote(n){let e,t,i;return t=new yi({props:{content:n[5].t("Add Model"),$$slots:{default:[cte]},$$scope:{ctx:n}}}),{c(){e=ie("div"),be(t.$$.fragment),this.h()},l(s){e=se(s,"DIV",{class:!0});var r=V(e);ve(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"class","self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]")},m(s,r){te(s,e,r),xe(t,e,null),i=!0},p(s,r){const a={};r&32&&(a.content=s[5].t("Add Model")),r&65539&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(H(t.$$.fragment,s),i=!0)},o(s){q(t.$$.fragment,s),i=!1},d(s){s&&E(e),ye(t)}}}function lte(n){let e,t,i,s,r;function a(){return n[12](n[15])}return{c(){e=ie("button"),t=lt("svg"),i=lt("path"),this.h()},l(o){e=se(o,"BUTTON",{"aria-label":!0});var l=V(e);t=ct(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var c=V(t);i=ct(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(i).forEach(E),c.forEach(E),l.forEach(E),this.h()},h(){A(i,"stroke-linecap","round"),A(i,"stroke-linejoin","round"),A(i,"d","M19.5 12h-15"),A(t,"xmlns","http://www.w3.org/2000/svg"),A(t,"fill","none"),A(t,"viewBox","0 0 24 24"),A(t,"stroke-width","2"),A(t,"stroke","currentColor"),A(t,"class","size-3"),e.disabled=n[1],A(e,"aria-label","Remove Model")},m(o,l){te(o,e,l),W(e,t),W(t,i),s||(r=xt(e,"click",a),s=!0)},p(o,l){n=o,l&2&&(e.disabled=n[1])},d(o){o&&E(e),s=!1,r()}}}function cte(n){let e,t,i,s,r;return{c(){e=ie("button"),t=lt("svg"),i=lt("path"),this.h()},l(a){e=se(a,"BUTTON",{class:!0,"aria-label":!0});var o=V(e);t=ct(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var l=V(t);i=ct(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(i).forEach(E),l.forEach(E),o.forEach(E),this.h()},h(){A(i,"stroke-linecap","round"),A(i,"stroke-linejoin","round"),A(i,"d","M12 6v12m6-6H6"),A(t,"xmlns","http://www.w3.org/2000/svg"),A(t,"fill","none"),A(t,"viewBox","0 0 24 24"),A(t,"stroke-width","2"),A(t,"stroke","currentColor"),A(t,"class","size-3.5"),A(e,"class",""),e.disabled=n[1],A(e,"aria-label","Add Model")},m(a,o){te(a,e,o),W(e,t),W(t,i),s||(r=xt(e,"click",n[11]),s=!0)},p(a,o){o&2&&(e.disabled=a[1])},d(a){a&&E(e),s=!1,r()}}}function NA(n){var f,g,m,x,p,y,w,v,_,C,k;let e,t,i,s,r,a,o,l,c;function h(I){n[10](I,n[13],n[14],n[15])}let u={id:`${n[15]}`,placeholder:n[5].t("Select a model"),items:n[3].map(DA),showTemporaryChatControl:((f=n[6])==null?void 0:f.role)==="user"?(((x=(m=(g=n[6])==null?void 0:g.permissions)==null?void 0:m.chat)==null?void 0:x.temporary)??!0)&&!(((w=(y=(p=n[6])==null?void 0:p.permissions)==null?void 0:y.chat)==null?void 0:w.temporary_enforced)??!1):!0,pinModelHandler:n[9]};n[13]!==void 0&&(u.value=n[13]),s=new hL({props:u}),Et.push(()=>Kt(s,"value",h));let d=(((v=n[6])==null?void 0:v.role)==="admin"||(((k=(C=(_=n[6])==null?void 0:_.permissions)==null?void 0:C.chat)==null?void 0:k.multiple_models)??!0))&&PA(n);return{c(){e=ie("div"),t=ie("div"),i=ie("div"),be(s.$$.fragment),o=Se(),d&&d.c(),l=Se(),this.h()},l(I){e=se(I,"DIV",{class:!0});var S=V(e);t=se(S,"DIV",{class:!0});var R=V(t);i=se(R,"DIV",{class:!0});var P=V(i);ve(s.$$.fragment,P),P.forEach(E),R.forEach(E),o=Ie(S),d&&d.l(S),l=Ie(S),S.forEach(E),this.h()},h(){var I;A(i,"class",a="max-w-full "+(((I=n[4])==null?void 0:I.highContrastMode)??!1?"m-1":"mr-1")),A(t,"class","overflow-hidden w-full"),A(e,"class","flex w-full max-w-fit")},m(I,S){te(I,e,S),W(e,t),W(t,i),xe(s,i,null),W(e,o),d&&d.m(e,null),W(e,l),c=!0},p(I,S){var P,D,U,T,G,M,F,X,z,K,j,ae;n=I;const R={};S&32&&(R.placeholder=n[5].t("Select a model")),S&8&&(R.items=n[3].map(DA)),S&64&&(R.showTemporaryChatControl=((P=n[6])==null?void 0:P.role)==="user"?(((T=(U=(D=n[6])==null?void 0:D.permissions)==null?void 0:U.chat)==null?void 0:T.temporary)??!0)&&!(((F=(M=(G=n[6])==null?void 0:G.permissions)==null?void 0:M.chat)==null?void 0:F.temporary_enforced)??!1):!0),!r&&S&1&&(r=!0,R.value=n[13],Wt(()=>r=!1)),s.$set(R),(!c||S&16&&a!==(a="max-w-full "+(((X=n[4])==null?void 0:X.highContrastMode)??!1?"m-1":"mr-1")))&&A(i,"class",a),((z=n[6])==null?void 0:z.role)==="admin"||(((ae=(j=(K=n[6])==null?void 0:K.permissions)==null?void 0:j.chat)==null?void 0:ae.multiple_models)??!0)?d?(d.p(n,S),S&64&&H(d,1)):(d=PA(n),d.c(),H(d,1),d.m(e,l)):d&&(yt(),q(d,1,1,()=>{d=null}),wt())},i(I){c||(H(s.$$.fragment,I),H(d),c=!0)},o(I){q(s.$$.fragment,I),q(d),c=!1},d(I){I&&E(e),ye(s),d&&d.d()}}}function OA(n){let e,t,i=n[5].t("Set as default")+"",s,r,a;return{c(){e=ie("div"),t=ie("button"),s=At(i),this.h()},l(o){e=se(o,"DIV",{class:!0});var l=V(e);t=se(l,"BUTTON",{});var c=V(t);s=St(c,i),c.forEach(E),l.forEach(E),this.h()},h(){A(e,"class","absolute text-left mt-[1px] ml-1 text-[0.7rem] text-gray-600 dark:text-gray-400 font-primary")},m(o,l){te(o,e,l),W(e,t),W(t,s),r||(a=xt(t,"click",n[8]),r=!0)},p(o,l){l&32&&i!==(i=o[5].t("Set as default")+"")&&Pt(s,i)},d(o){o&&E(e),r=!1,a()}}}function hte(n){let e,t,i,s,r=ni(n[0]),a=[];for(let c=0;c<r.length;c+=1)a[c]=NA(MA(n,r,c));const o=c=>q(a[c],1,1,()=>{a[c]=null});let l=n[2]&&OA(n);return{c(){e=ie("div");for(let c=0;c<a.length;c+=1)a[c].c();t=Se(),l&&l.c(),i=Xt(),this.h()},l(c){e=se(c,"DIV",{class:!0});var h=V(e);for(let u=0;u<a.length;u+=1)a[u].l(h);h.forEach(E),t=Ie(c),l&&l.l(c),i=Xt(),this.h()},h(){A(e,"class","flex flex-col w-full items-start")},m(c,h){te(c,e,h);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(e,null);te(c,t,h),l&&l.m(c,h),te(c,i,h),s=!0},p(c,[h]){if(h&635){r=ni(c[0]);let u;for(u=0;u<r.length;u+=1){const d=MA(c,r,u);a[u]?(a[u].p(d,h),H(a[u],1)):(a[u]=NA(d),a[u].c(),H(a[u],1),a[u].m(e,null))}for(yt(),u=r.length;u<a.length;u+=1)o(u);wt()}c[2]?l?l.p(c,h):(l=OA(c),l.c(),l.m(i.parentNode,i)):l&&(l.d(1),l=null)},i(c){if(!s){for(let h=0;h<r.length;h+=1)H(a[h]);s=!0}},o(c){a=a.filter(Boolean);for(let h=0;h<a.length;h+=1)q(a[h]);s=!1},d(c){c&&(E(e),E(t),E(i)),vo(a,c),l&&l.d(c)}}}const DA=n=>({value:n.id,label:n.name,model:n});function ute(n,e,t){let i,s,r,a;Oe(n,Vg,x=>t(3,i=x)),Oe(n,ja,x=>t(4,s=x)),Oe(n,w0,x=>t(6,a=x));const o=qs("i18n");Oe(n,o,x=>t(5,r=x));let{selectedModels:l=[""]}=e,{disabled:c=!1}=e,{showSetDefault:h=!0}=e;const u=async()=>{if(l.filter(p=>p==="").length){on.error(r.t("Choose a model before saving..."));return}ja.set({...s,models:l}),await l_(localStorage.token,{ui:s}),on.success(r.t("Default model updated"))},d=async x=>{let p=(s==null?void 0:s.pinnedModels)??[];p.includes(x)?p=p.filter(y=>y!==x):p=[...new Set([...p,x])],ja.set({...s,pinnedModels:p}),await l_(localStorage.token,{ui:s})};function f(x,p,y,w){y[w]=x,t(0,l),t(3,i)}const g=()=>{t(0,l=[...l,""])},m=x=>{l.splice(x,1),t(0,l),t(3,i)};return n.$$set=x=>{"selectedModels"in x&&t(0,l=x.selectedModels),"disabled"in x&&t(1,c=x.disabled),"showSetDefault"in x&&t(2,h=x.showSetDefault)},n.$$.update=()=>{n.$$.dirty&9&&l.length>0&&i.length>0&&t(0,l=l.map(x=>i.map(p=>p.id).includes(x)?x:""))},[l,c,h,i,s,r,a,o,u,d,f,g,m]}class dte extends Ht{constructor(e){super(),zt(this,e,ute,hte,qt,{selectedModels:0,disabled:1,showSetDefault:2})}}function fte(n){let e,t;return{c(){e=lt("svg"),t=lt("path"),this.h()},l(i){e=ct(i,"svg",{xmlns:!0,viewBox:!0,stroke:!0,fill:!0,class:!0,"stroke-width":!0});var s=V(e);t=ct(s,"path",{d:!0}),V(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"d","M18.75 12.75h1.5a.75.75 0 0 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM12 6a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 6ZM12 18a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 18ZM3.75 6.75h1.5a.75.75 0 1 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM5.25 18.75h-1.5a.75.75 0 0 1 0-1.5h1.5a.75.75 0 0 1 0 1.5ZM3 12a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 3 12ZM9 3.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5ZM12.75 12a2.25 2.25 0 1 1 4.5 0 2.25 2.25 0 0 1-4.5 0ZM9 15.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 24 24"),A(e,"stroke","currentColor"),A(e,"fill","currentColor"),A(e,"class",n[0]),A(e,"stroke-width",n[1])},m(i,s){te(i,e,s),W(e,t)},p(i,[s]){s&1&&A(e,"class",i[0]),s&2&&A(e,"stroke-width",i[1])},i:It,o:It,d(i){i&&E(e)}}}function gte(n,e,t){let{className:i="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class lO extends Ht{constructor(e){super(),zt(this,e,gte,fte,qt,{className:0,strokeWidth:1})}}function mte(n){let e;const t=n[14].default,i=zs(t,n,n[24],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&16777216)&&js(i,t,s,s[24],e?Vs(t,s[24],r,null):Gs(s[24]),null)},i(s){e||(H(i,s),e=!0)},o(s){q(i,s),e=!1},d(s){i&&i.d(s)}}}function LA(n){let e,t;return e=new ha({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",id:"chat-controls-button",$$slots:{default:[pte]},$$scope:{ctx:n}}}),e.$on("click",n[15]),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s&16777248&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function pte(n){let e,t,i,s=n[5].t("Controls")+"",r,a;return e=new lO({props:{className:" size-4",strokeWidth:"0.5"}}),{c(){be(e.$$.fragment),t=Se(),i=ie("div"),r=At(s),this.h()},l(o){ve(e.$$.fragment,o),t=Ie(o),i=se(o,"DIV",{class:!0});var l=V(i);r=St(l,s),l.forEach(E),this.h()},h(){A(i,"class","flex items-center")},m(o,l){xe(e,o,l),te(o,t,l),te(o,i,l),W(i,r),a=!0},p(o,l){(!a||l&32)&&s!==(s=o[5].t("Controls")+"")&&Pt(r,s)},i(o){a||(H(e.$$.fragment,o),a=!0)},o(o){q(e.$$.fragment,o),a=!1},d(o){o&&(E(t),E(i)),ye(e,o)}}}function FA(n){let e,t;return e=new ha({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",id:"chat-share-button",$$slots:{default:[bte]},$$scope:{ctx:n}}}),e.$on("click",n[16]),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s&16777248&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function bte(n){let e,t,i,s,r=n[5].t("Share")+"",a;return{c(){e=lt("svg"),t=lt("path"),i=Se(),s=ie("div"),a=At(r),this.h()},l(o){e=ct(o,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var l=V(e);t=ct(l,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),V(t).forEach(E),l.forEach(E),i=Ie(o),s=se(o,"DIV",{class:!0});var c=V(s);a=St(c,r),c.forEach(E),this.h()},h(){A(t,"fill-rule","evenodd"),A(t,"d","M15.75 4.5a3 3 0 1 1 .825 2.066l-8.421 4.679a3.002 3.002 0 0 1 0 1.51l8.421 4.679a3 3 0 1 1-.729 1.31l-8.421-4.678a3 3 0 1 1 0-4.132l8.421-4.679a3 3 0 0 1-.096-.755Z"),A(t,"clip-rule","evenodd"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 24 24"),A(e,"fill","currentColor"),A(e,"class","size-4"),A(s,"class","flex items-center")},m(o,l){te(o,e,l),W(e,t),te(o,i,l),te(o,s,l),W(s,a)},p(o,l){l&32&&r!==(r=o[5].t("Share")+"")&&Pt(a,r)},d(o){o&&(E(e),E(i),E(s))}}}function xte(n){let e,t,i,s=n[5].t("Overview")+"",r,a;return e=new fL({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){be(e.$$.fragment),t=Se(),i=ie("div"),r=At(s),this.h()},l(o){ve(e.$$.fragment,o),t=Ie(o),i=se(o,"DIV",{class:!0});var l=V(i);r=St(l,s),l.forEach(E),this.h()},h(){A(i,"class","flex items-center")},m(o,l){xe(e,o,l),te(o,t,l),te(o,i,l),W(i,r),a=!0},p(o,l){(!a||l&32)&&s!==(s=o[5].t("Overview")+"")&&Pt(r,s)},i(o){a||(H(e.$$.fragment,o),a=!0)},o(o){q(e.$$.fragment,o),a=!1},d(o){o&&(E(t),E(i)),ye(e,o)}}}function yte(n){let e,t,i,s=n[5].t("Artifacts")+"",r,a;return e=new tD({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){be(e.$$.fragment),t=Se(),i=ie("div"),r=At(s),this.h()},l(o){ve(e.$$.fragment,o),t=Ie(o),i=se(o,"DIV",{class:!0});var l=V(i);r=St(l,s),l.forEach(E),this.h()},h(){A(i,"class","flex items-center")},m(o,l){xe(e,o,l),te(o,t,l),te(o,i,l),W(i,r),a=!0},p(o,l){(!a||l&32)&&s!==(s=o[5].t("Artifacts")+"")&&Pt(r,s)},i(o){a||(H(e.$$.fragment,o),a=!0)},o(o){q(e.$$.fragment,o),a=!1},d(o){o&&(E(t),E(i)),ye(e,o)}}}function wte(n){let e,t,i,s,r=n[5].t("Download")+"",a;return{c(){e=lt("svg"),t=lt("path"),i=Se(),s=ie("div"),a=At(r),this.h()},l(o){e=ct(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var l=V(e);t=ct(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(t).forEach(E),l.forEach(E),i=Ie(o),s=se(o,"DIV",{class:!0});var c=V(s);a=St(c,r),c.forEach(E),this.h()},h(){A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"d","M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width","1.5"),A(e,"stroke","currentColor"),A(e,"class","size-4"),A(s,"class","flex items-center")},m(o,l){te(o,e,l),W(e,t),te(o,i,l),te(o,s,l),W(s,a)},p(o,l){l&32&&r!==(r=o[5].t("Download")+"")&&Pt(a,r)},d(o){o&&(E(e),E(i),E(s))}}}function BA(n){let e,t;return e=new ha({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",$$slots:{default:[vte]},$$scope:{ctx:n}}}),e.$on("click",n[19]),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s&16777248&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function vte(n){let e,t=n[5].t("Export chat (.json)")+"",i;return{c(){e=ie("div"),i=At(t),this.h()},l(s){e=se(s,"DIV",{class:!0});var r=V(e);i=St(r,t),r.forEach(E),this.h()},h(){A(e,"class","flex items-center line-clamp-1")},m(s,r){te(s,e,r),W(e,i)},p(s,r){r&32&&t!==(t=s[5].t("Export chat (.json)")+"")&&Pt(i,t)},d(s){s&&E(e)}}}function _te(n){let e,t=n[5].t("Plain text (.txt)")+"",i;return{c(){e=ie("div"),i=At(t),this.h()},l(s){e=se(s,"DIV",{class:!0});var r=V(e);i=St(r,t),r.forEach(E),this.h()},h(){A(e,"class","flex items-center line-clamp-1")},m(s,r){te(s,e,r),W(e,i)},p(s,r){r&32&&t!==(t=s[5].t("Plain text (.txt)")+"")&&Pt(i,t)},d(s){s&&E(e)}}}function kte(n){let e,t=n[5].t("PDF document (.pdf)")+"",i;return{c(){e=ie("div"),i=At(t),this.h()},l(s){e=se(s,"DIV",{class:!0});var r=V(e);i=St(r,t),r.forEach(E),this.h()},h(){A(e,"class","flex items-center line-clamp-1")},m(s,r){te(s,e,r),W(e,i)},p(s,r){r&32&&t!==(t=s[5].t("PDF document (.pdf)")+"")&&Pt(i,t)},d(s){s&&E(e)}}}function Cte(n){var o,l,c;let e,t,i,s,r,a=(((o=n[6])==null?void 0:o.role)==="admin"||(((c=(l=n[6].permissions)==null?void 0:l.chat)==null?void 0:c.export)??!0))&&BA(n);return t=new ha({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",$$slots:{default:[_te]},$$scope:{ctx:n}}}),t.$on("click",n[20]),s=new ha({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",$$slots:{default:[kte]},$$scope:{ctx:n}}}),s.$on("click",n[21]),{c(){a&&a.c(),e=Se(),be(t.$$.fragment),i=Se(),be(s.$$.fragment)},l(h){a&&a.l(h),e=Ie(h),ve(t.$$.fragment,h),i=Ie(h),ve(s.$$.fragment,h)},m(h,u){a&&a.m(h,u),te(h,e,u),xe(t,h,u),te(h,i,u),xe(s,h,u),r=!0},p(h,u){var g,m,x;((g=h[6])==null?void 0:g.role)==="admin"||(((x=(m=h[6].permissions)==null?void 0:m.chat)==null?void 0:x.export)??!0)?a?(a.p(h,u),u&64&&H(a,1)):(a=BA(h),a.c(),H(a,1),a.m(e.parentNode,e)):a&&(yt(),q(a,1,1,()=>{a=null}),wt());const d={};u&16777248&&(d.$$scope={dirty:u,ctx:h}),t.$set(d);const f={};u&16777248&&(f.$$scope={dirty:u,ctx:h}),s.$set(f)},i(h){r||(H(a),H(t.$$.fragment,h),H(s.$$.fragment,h),r=!0)},o(h){q(a),q(t.$$.fragment,h),q(s.$$.fragment,h),r=!1},d(h){h&&(E(e),E(i)),a&&a.d(h),ye(t,h),ye(s,h)}}}function Ate(n){let e,t,i,s;return e=new EI({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",$$slots:{default:[wte]},$$scope:{ctx:n}}}),i=new TI({props:{class:"w-full rounded-xl px-1 py-1.5 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",transition:V5,sideOffset:8,$$slots:{default:[Cte]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment),t=Se(),be(i.$$.fragment)},l(r){ve(e.$$.fragment,r),t=Ie(r),ve(i.$$.fragment,r)},m(r,a){xe(e,r,a),te(r,t,a),xe(i,r,a),s=!0},p(r,a){const o={};a&16777248&&(o.$$scope={dirty:a,ctx:r}),e.$set(o);const l={};a&16777312&&(l.$$scope={dirty:a,ctx:r}),i.$set(l)},i(r){s||(H(e.$$.fragment,r),H(i.$$.fragment,r),s=!0)},o(r){q(e.$$.fragment,r),q(i.$$.fragment,r),s=!1},d(r){r&&E(t),ye(e,r),ye(i,r)}}}function Ste(n){let e,t,i,s=n[5].t("Copy")+"",r,a;return e=new nD({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){be(e.$$.fragment),t=Se(),i=ie("div"),r=At(s),this.h()},l(o){ve(e.$$.fragment,o),t=Ie(o),i=se(o,"DIV",{class:!0});var l=V(i);r=St(l,s),l.forEach(E),this.h()},h(){A(i,"class","flex items-center")},m(o,l){xe(e,o,l),te(o,t,l),te(o,i,l),W(i,r),a=!0},p(o,l){(!a||l&32)&&s!==(s=o[5].t("Copy")+"")&&Pt(r,s)},i(o){a||(H(e.$$.fragment,o),a=!0)},o(o){q(e.$$.fragment,o),a=!1},d(o){o&&(E(t),E(i)),ye(e,o)}}}function UA(n){let e,t,i,s,r;return s=new lL({props:{chatId:n[1].id}}),{c(){e=ie("hr"),t=Se(),i=ie("div"),be(s.$$.fragment),this.h()},l(a){e=se(a,"HR",{class:!0}),t=Ie(a),i=se(a,"DIV",{class:!0});var o=V(i);ve(s.$$.fragment,o),o.forEach(E),this.h()},h(){A(e,"class","border-gray-100 dark:border-gray-850 my-0.5"),A(i,"class","flex p-1")},m(a,o){te(a,e,o),te(a,t,o),te(a,i,o),xe(s,i,null),r=!0},p(a,o){const l={};o&2&&(l.chatId=a[1].id),s.$set(l)},i(a){r||(H(s.$$.fragment,a),r=!0)},o(a){q(s.$$.fragment,a),r=!1},d(a){a&&(E(e),E(t),E(i)),ye(s)}}}function Ite(n){var x,p,y;let e,t,i,s,r,a,o,l,c,h,u,d,f=n[4]&&LA(n),g=!n[3]&&(((x=n[6])==null?void 0:x.role)==="admin"||(((y=(p=n[6].permissions)==null?void 0:p.chat)==null?void 0:y.share)??!0))&&FA(n);i=new ha({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",id:"chat-overview-button",$$slots:{default:[xte]},$$scope:{ctx:n}}}),i.$on("click",n[17]),r=new ha({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",id:"chat-overview-button",$$slots:{default:[yte]},$$scope:{ctx:n}}}),r.$on("click",n[18]),o=new II({props:{$$slots:{default:[Ate]},$$scope:{ctx:n}}}),c=new ha({props:{class:"flex gap-2 items-center px-3 py-2 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md select-none w-full",id:"chat-copy-button",$$slots:{default:[Ste]},$$scope:{ctx:n}}}),c.$on("click",n[22]);let m=!n[3]&&UA(n);return{c(){f&&f.c(),e=Se(),g&&g.c(),t=Se(),be(i.$$.fragment),s=Se(),be(r.$$.fragment),a=Se(),be(o.$$.fragment),l=Se(),be(c.$$.fragment),h=Se(),m&&m.c(),u=Xt()},l(w){f&&f.l(w),e=Ie(w),g&&g.l(w),t=Ie(w),ve(i.$$.fragment,w),s=Ie(w),ve(r.$$.fragment,w),a=Ie(w),ve(o.$$.fragment,w),l=Ie(w),ve(c.$$.fragment,w),h=Ie(w),m&&m.l(w),u=Xt()},m(w,v){f&&f.m(w,v),te(w,e,v),g&&g.m(w,v),te(w,t,v),xe(i,w,v),te(w,s,v),xe(r,w,v),te(w,a,v),xe(o,w,v),te(w,l,v),xe(c,w,v),te(w,h,v),m&&m.m(w,v),te(w,u,v),d=!0},p(w,v){var S,R,P;w[4]?f?(f.p(w,v),v&16&&H(f,1)):(f=LA(w),f.c(),H(f,1),f.m(e.parentNode,e)):f&&(yt(),q(f,1,1,()=>{f=null}),wt()),!w[3]&&(((S=w[6])==null?void 0:S.role)==="admin"||(((P=(R=w[6].permissions)==null?void 0:R.chat)==null?void 0:P.share)??!0))?g?(g.p(w,v),v&72&&H(g,1)):(g=FA(w),g.c(),H(g,1),g.m(t.parentNode,t)):g&&(yt(),q(g,1,1,()=>{g=null}),wt());const _={};v&16777248&&(_.$$scope={dirty:v,ctx:w}),i.$set(_);const C={};v&16777248&&(C.$$scope={dirty:v,ctx:w}),r.$set(C);const k={};v&16777312&&(k.$$scope={dirty:v,ctx:w}),o.$set(k);const I={};v&16777248&&(I.$$scope={dirty:v,ctx:w}),c.$set(I),w[3]?m&&(yt(),q(m,1,1,()=>{m=null}),wt()):m?(m.p(w,v),v&8&&H(m,1)):(m=UA(w),m.c(),H(m,1),m.m(u.parentNode,u))},i(w){d||(H(f),H(g),H(i.$$.fragment,w),H(r.$$.fragment,w),H(o.$$.fragment,w),H(c.$$.fragment,w),H(m),d=!0)},o(w){q(f),q(g),q(i.$$.fragment,w),q(r.$$.fragment,w),q(o.$$.fragment,w),q(c.$$.fragment,w),q(m),d=!1},d(w){w&&(E(e),E(t),E(s),E(a),E(l),E(h),E(u)),f&&f.d(w),g&&g.d(w),ye(i,w),ye(r,w),ye(o,w),ye(c,w),m&&m.d(w)}}}function Ete(n){let e,t,i;return t=new Q6({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5  z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:8,side:"bottom",align:"end",transition:V5,$$slots:{default:[Ite]},$$scope:{ctx:n}}}),{c(){e=ie("div"),be(t.$$.fragment),this.h()},l(s){e=se(s,"DIV",{slot:!0});var r=V(e);ve(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"slot","content")},m(s,r){te(s,e,r),xe(t,e,null),i=!0},p(s,r){const a={};r&16777339&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(H(t.$$.fragment,s),i=!0)},o(s){q(t.$$.fragment,s),i=!1},d(s){s&&E(e),ye(t)}}}function Tte(n){let e,t;return e=new $6({props:{$$slots:{content:[Ete],default:[mte]},$$scope:{ctx:n}}}),e.$on("change",n[23]),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,[s]){const r={};s&16777339&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Rte(n,e,t){let i,s,r,a,o;Oe(n,Od,T=>t(3,i=T)),Oe(n,ja,T=>t(25,s=T)),Oe(n,tx,T=>t(4,r=T)),Oe(n,w0,T=>t(6,o=T));let{$$slots:l={},$$scope:c}=e;const{saveAs:h}=uL,u=qs("i18n");Oe(n,u,T=>t(5,a=T));let{shareEnabled:d=!1}=e,{shareHandler:f}=e,{downloadHandler:g}=e,{chat:m}=e,{onClose:x=()=>{}}=e;const p=async()=>{const T=m.chat.history;return Oa(T,T.currentId).reduce((F,X,z,K)=>`${F}### ${X.role.toUpperCase()}
${X.content}

`,"").trim()},y=async()=>{const T=await p();let G=new Blob([T],{type:"text/plain"});h(G,`chat-${m.chat.title}.txt`)},w=async()=>{if((s==null?void 0:s.stylizedPdfExport)??!0){const T=document.getElementById("messages-container");if(T)try{const G=document.documentElement.classList.contains("dark"),M=800,F=1200,X=T.cloneNode(!0);X.classList.add("text-black"),X.classList.add("dark:text-white"),X.style.width=`${M}px`,X.style.position="absolute",X.style.left="-9999px",X.style.height="auto",document.body.appendChild(X);const z=X.scrollHeight;let K=0,j=0;const ae=new u_("p","mm","a4"),ge=210,ue=297;for(;K<z;){X.scrollTop=K,X.style.maxHeight=`${F}px`;const pe=await dL(X,{backgroundColor:G?"#000":"#fff",useCORS:!0,scale:2,width:M,height:Math.min(F,z-K),windowWidth:M}),de=pe.toDataURL("image/png"),O=pe.height*ge/pe.width,Y=0;j>0&&ae.addPage(),G&&(ae.setFillColor(0,0,0),ae.rect(0,0,ge,ue,"F")),ae.addImage(de,"PNG",0,Y,ge,O),K+=F,j++}document.body.removeChild(X),ae.save(`chat-${m.chat.title}.pdf`)}catch(G){console.error("Error generating PDF",G)}}else{const T=await p(),G=new u_,M=15,F=20,X=15,z=20,K=G.internal.pageSize.getWidth(),j=G.internal.pageSize.getHeight(),ae=K-M-X,ge=8;G.setFontSize(ge);const ue=ge*1,pe=T.split(`
`);let de=F;for(let O of pe){const Y=G.splitTextToSize(O,ae);for(let le of Y)de+ue>j-z&&(G.addPage(),de=F),G.text(le,M,de),de+=ue*.5;de+=ue*.1}G.save(`chat-${m.chat.title}.pdf`)}},v=async()=>{if(m.id){let T=null;m.id==="local"||i?T=m:T=await Qw(localStorage.token,m.id);let G=new Blob([JSON.stringify([T])],{type:"application/json"});h(G,`chat-export-${Date.now()}.json`)}},_=async()=>{await Ki.set(!0),await n0.set(!1),await Jl.set(!1)},C=()=>{f()},k=async()=>{await Ki.set(!0),await n0.set(!0),await Jl.set(!1)},I=async()=>{await Ki.set(!0),await Jl.set(!0),await n0.set(!1)},S=()=>{v()},R=()=>{y()},P=()=>{w()},D=async()=>{await J6(await p()).catch(G=>{console.error(G)})&&on.success(a.t("Copied to clipboard"))},U=T=>{T.detail===!1&&x()};return n.$$set=T=>{"shareEnabled"in T&&t(12,d=T.shareEnabled),"shareHandler"in T&&t(0,f=T.shareHandler),"downloadHandler"in T&&t(13,g=T.downloadHandler),"chat"in T&&t(1,m=T.chat),"onClose"in T&&t(2,x=T.onClose),"$$scope"in T&&t(24,c=T.$$scope)},[f,m,x,i,r,a,o,u,p,y,w,v,d,g,l,_,C,k,I,S,R,P,D,U,c]}class Mte extends Ht{constructor(e){super(),zt(this,e,Rte,Tte,qt,{shareEnabled:12,shareHandler:0,downloadHandler:13,chat:1,onClose:2})}}function HA(n,e,t){const i=n.slice();return i[34]=e[t],i}function zA(n){let e,t;return e=new yi({props:{content:n[13].t("New Chat"),$$slots:{default:[Pte]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&8192&&(r.content=i[13].t("New Chat")),s[0]&2050|s[1]&64&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Pte(n){let e,t,i,s,r,a,o;return i=new MI({props:{className:" size-5",strokeWidth:"2"}}),{c(){e=ie("button"),t=ie("div"),be(i.$$.fragment),this.h()},l(l){e=se(l,"BUTTON",{class:!0,"aria-label":!0});var c=V(e);t=se(c,"DIV",{class:!0});var h=V(t);ve(i.$$.fragment,h),h.forEach(E),c.forEach(E),this.h()},h(){A(t,"class","m-auto self-center"),A(e,"class",s="flex "+(n[11]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"),A(e,"aria-label","New Chat")},m(l,c){te(l,e,c),W(e,t),xe(i,t,null),r=!0,a||(o=xt(e,"click",n[24]),a=!0)},p(l,c){(!r||c[0]&2048&&s!==(s="flex "+(l[11]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"))&&A(e,"class",s)},i(l){r||(H(i.$$.fragment,l),r=!0)},o(l){q(i.$$.fragment,l),r=!1},d(l){l&&E(e),ye(i),a=!1,o()}}}function jA(n){let e,t,i;function s(a){n[25](a)}let r={showSetDefault:!n[2]};return n[0]!==void 0&&(r.selectedModels=n[0]),e=new dte({props:r}),Et.push(()=>Kt(e,"selectedModels",s)),{c(){be(e.$$.fragment)},l(a){ve(e.$$.fragment,a)},m(a,o){xe(e,a,o),i=!0},p(a,o){const l={};o[0]&4&&(l.showSetDefault=!a[2]),!t&&o[0]&1&&(t=!0,l.selectedModels=a[0],Wt(()=>t=!1)),e.$set(l)},i(a){i||(H(e.$$.fragment,a),i=!0)},o(a){q(e.$$.fragment,a),i=!1},d(a){ye(e,a)}}}function GA(n){let e,t;return e=new Mte({props:{chat:n[3],shareEnabled:n[2],shareHandler:n[26],downloadHandler:n[27],$$slots:{default:[Nte]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&8&&(r.chat=i[3]),s[0]&4&&(r.shareEnabled=i[2]),s[0]&256&&(r.shareHandler=i[26]),s[0]&512&&(r.downloadHandler=i[27]),s[1]&64&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Nte(n){let e,t='<div class="m-auto self-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"></path></svg></div>';return{c(){e=ie("button"),e.innerHTML=t,this.h()},l(i){e=se(i,"BUTTON",{class:!0,id:!0,"data-svelte-h":!0}),_o(e)!=="svelte-1cq3yl7"&&(e.innerHTML=t),this.h()},h(){A(e,"class","flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),A(e,"id","chat-context-menu-button")},m(i,s){te(i,e,s)},p:It,d(i){i&&E(e)}}}function Ote(n){let e,t,i,s,r,a;return i=new lO({props:{className:" size-5",strokeWidth:"0.5"}}),{c(){e=ie("button"),t=ie("div"),be(i.$$.fragment),this.h()},l(o){e=se(o,"BUTTON",{class:!0,"aria-label":!0});var l=V(e);t=se(l,"DIV",{class:!0});var c=V(t);ve(i.$$.fragment,c),c.forEach(E),l.forEach(E),this.h()},h(){A(t,"class","m-auto self-center"),A(e,"class","flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),A(e,"aria-label","Controls")},m(o,l){te(o,e,l),W(e,t),xe(i,t,null),s=!0,r||(a=xt(e,"click",n[28]),r=!0)},p:It,i(o){s||(H(i.$$.fragment,o),s=!0)},o(o){q(i.$$.fragment,o),s=!1},d(o){o&&E(e),ye(i),r=!1,a()}}}function VA(n){let e,t;return e=new yi({props:{content:n[13].t("New Chat"),$$slots:{default:[Dte]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&8192&&(r.content=i[13].t("New Chat")),s[0]&2050|s[1]&64&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Dte(n){let e,t,i,s,r,a,o;return i=new MI({props:{className:" size-5",strokeWidth:"2"}}),{c(){e=ie("button"),t=ie("div"),be(i.$$.fragment),this.h()},l(l){e=se(l,"BUTTON",{class:!0,"aria-label":!0});var c=V(e);t=se(c,"DIV",{class:!0});var h=V(t);ve(i.$$.fragment,h),h.forEach(E),c.forEach(E),this.h()},h(){A(t,"class","m-auto self-center"),A(e,"class",s="flex "+(n[11]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"),A(e,"aria-label","New Chat")},m(l,c){te(l,e,c),W(e,t),xe(i,t,null),r=!0,a||(o=xt(e,"click",n[29]),a=!0)},p(l,c){(!r||c[0]&2048&&s!==(s="flex "+(l[11]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"))&&A(e,"class",s)},i(l){r||(H(i.$$.fragment,l),r=!0)},o(l){q(i.$$.fragment,l),r=!1},d(l){l&&E(e),ye(i),a=!1,o()}}}function qA(n){var i;let e,t;return e=new gL({props:{className:"max-w-[240px]",role:(i=n[16])==null?void 0:i.role,help:!0,$$slots:{default:[Lte]},$$scope:{ctx:n}}}),e.$on("show",n[30]),{c(){be(e.$$.fragment)},l(s){ve(e.$$.fragment,s)},m(s,r){xe(e,s,r),t=!0},p(s,r){var o;const a={};r[0]&65536&&(a.role=(o=s[16])==null?void 0:o.role),r[0]&73728|r[1]&64&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){t||(H(e.$$.fragment,s),t=!0)},o(s){q(e.$$.fragment,s),t=!1},d(s){ye(e,s)}}}function Lte(n){let e,t,i,s=n[13].t("User menu")+"",r,a,o,l;return{c(){e=ie("div"),t=ie("div"),i=ie("span"),r=At(s),a=Se(),o=ie("img"),this.h()},l(c){e=se(c,"DIV",{class:!0});var h=V(e);t=se(h,"DIV",{class:!0});var u=V(t);i=se(u,"SPAN",{class:!0});var d=V(i);r=St(d,s),d.forEach(E),a=Ie(u),o=se(u,"IMG",{src:!0,class:!0,alt:!0,draggable:!0}),u.forEach(E),h.forEach(E),this.h()},h(){var c;A(i,"class","sr-only"),g0(o.src,l=(c=n[16])==null?void 0:c.profile_image_url)||A(o,"src",l),A(o,"class","size-6 object-cover rounded-full"),A(o,"alt",""),A(o,"draggable","false"),A(t,"class","self-center"),A(e,"class","select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition")},m(c,h){te(c,e,h),W(e,t),W(t,i),W(i,r),W(t,a),W(t,o)},p(c,h){var u;h[0]&8192&&s!==(s=c[13].t("User menu")+"")&&Pt(r,s),h[0]&65536&&!g0(o.src,l=(u=c[16])==null?void 0:u.profile_image_url)&&A(o,"src",l)},d(c){c&&E(e)}}}function WA(n){let e,t,i=n[13].t("Temporary Chat")+"",s;return{c(){e=ie("div"),t=ie("div"),s=At(i),this.h()},l(r){e=se(r,"DIV",{class:!0});var a=V(e);t=se(a,"DIV",{class:!0});var o=V(t);s=St(o,i),o.forEach(E),a.forEach(E),this.h()},h(){A(t,"class","text-xs text-gray-500"),A(e,"class","w-full z-30 text-center")},m(r,a){te(r,e,a),W(e,t),W(t,s)},p(r,a){a[0]&8192&&i!==(i=r[13].t("Temporary Chat")+"")&&Pt(s,i)},d(r){r&&E(e)}}}function KA(n){var c,h,u,d,f,g,m;let e,t,i,s,r,a=(((h=(c=n[18])==null?void 0:c.license_metadata)==null?void 0:h.type)??null)==="trial"&&XA(n),o=(((d=(u=n[18])==null?void 0:u.license_metadata)==null?void 0:d.seats)??null)!==null&&((f=n[18])==null?void 0:f.user_count)>((m=(g=n[18])==null?void 0:g.license_metadata)==null?void 0:m.seats)&&YA(n),l=n[6]&&JA(n);return{c(){e=ie("div"),t=ie("div"),a&&a.c(),i=Se(),o&&o.c(),s=Se(),l&&l.c(),this.h()},l(x){e=se(x,"DIV",{class:!0});var p=V(e);t=se(p,"DIV",{class:!0});var y=V(t);a&&a.l(y),i=Ie(y),o&&o.l(y),s=Ie(y),l&&l.l(y),y.forEach(E),p.forEach(E),this.h()},h(){A(t,"class","flex flex-col gap-1 w-full"),A(e,"class","w-full z-30 mt-5")},m(x,p){te(x,e,p),W(e,t),a&&a.m(t,null),W(t,i),o&&o.m(t,null),W(t,s),l&&l.m(t,null),r=!0},p(x,p){var y,w,v,_,C,k,I;(((w=(y=x[18])==null?void 0:y.license_metadata)==null?void 0:w.type)??null)==="trial"?a?(a.p(x,p),p[0]&262144&&H(a,1)):(a=XA(x),a.c(),H(a,1),a.m(t,i)):a&&(yt(),q(a,1,1,()=>{a=null}),wt()),(((_=(v=x[18])==null?void 0:v.license_metadata)==null?void 0:_.seats)??null)!==null&&((C=x[18])==null?void 0:C.user_count)>((I=(k=x[18])==null?void 0:k.license_metadata)==null?void 0:I.seats)?o?(o.p(x,p),p[0]&262144&&H(o,1)):(o=YA(x),o.c(),H(o,1),o.m(t,s)):o&&(yt(),q(o,1,1,()=>{o=null}),wt()),x[6]?l?(l.p(x,p),p[0]&64&&H(l,1)):(l=JA(x),l.c(),H(l,1),l.m(t,null)):l&&(yt(),q(l,1,1,()=>{l=null}),wt())},i(x){r||(H(a),H(o),H(l),r=!0)},o(x){q(a),q(o),q(l),r=!1},d(x){x&&E(e),a&&a.d(),o&&o.d(),l&&l.d()}}}function XA(n){let e,t;return e=new e4({props:{banner:{type:"info",title:"Trial License",content:n[13].t("You are currently using a trial license. Please contact support to upgrade your license.")}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&8192&&(r.banner={type:"info",title:"Trial License",content:i[13].t("You are currently using a trial license. Please contact support to upgrade your license.")}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function YA(n){let e,t;return e=new e4({props:{banner:{type:"error",title:"License Error",content:n[13].t("Exceeded the number of seats in your license. Please contact support to increase the number of seats.")}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&8192&&(r.banner={type:"error",title:"License Error",content:i[13].t("Exceeded the number of seats in your license. Please contact support to increase the number of seats.")}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function JA(n){let e,t,i=ni(n[17].filter(n[31])),s=[];for(let a=0;a<i.length;a+=1)s[a]=ZA(HA(n,i,a));const r=a=>q(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=Xt()},l(a){for(let o=0;o<s.length;o+=1)s[o].l(a);e=Xt()},m(a,o){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(a,o);te(a,e,o),t=!0},p(a,o){if(o[0]&131200){i=ni(a[17].filter(a[31]));let l;for(l=0;l<i.length;l+=1){const c=HA(a,i,l);s[l]?(s[l].p(c,o),H(s[l],1)):(s[l]=ZA(c),s[l].c(),H(s[l],1),s[l].m(e.parentNode,e))}for(yt(),l=i.length;l<s.length;l+=1)r(l);wt()}},i(a){if(!t){for(let o=0;o<i.length;o+=1)H(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)q(s[o]);t=!1},d(a){a&&E(e),vo(s,a)}}}function ZA(n){let e,t;function i(...s){return n[32](n[34],...s)}return e=new e4({props:{banner:n[34]}}),e.$on("dismiss",i),{c(){be(e.$$.fragment)},l(s){ve(e.$$.fragment,s)},m(s,r){xe(e,s,r),t=!0},p(s,r){n=s;const a={};r[0]&131200&&(a.banner=n[34]),e.$set(a)},i(s){t||(H(e.$$.fragment,s),t=!0)},o(s){q(e.$$.fragment,s),t=!1},d(s){ye(e,s)}}}function Fte(n){var de,O,Y,le,$,re,oe;let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,v,_,C,k,I,S,R,P,D,U,T,G,M;function F(ee){n[21](ee)}let X={chatId:n[10]};n[8]!==void 0&&(X.show=n[8]),e=new cL({props:X}),Et.push(()=>Kt(e,"show",F)),m=new mL({});let z=!n[12]&&zA(n),K=n[5]&&jA(n),j=n[2]&&n[3]&&(n[3].id||n[14])&&GA(n);I=new yi({props:{content:n[13].t("Controls"),$$slots:{default:[Ote]},$$scope:{ctx:n}}});let ae=n[12]&&VA(n),ge=n[16]!==void 0&&n[16]!==null&&qA(n),ue=n[14]&&n[10]==="local"&&WA(n),pe=!n[4].currentId&&!n[10]&&(n[17].length>0||(((O=(de=n[18])==null?void 0:de.license_metadata)==null?void 0:O.type)??null)==="trial"||(((le=(Y=n[18])==null?void 0:Y.license_metadata)==null?void 0:le.seats)??null)!==null&&(($=n[18])==null?void 0:$.user_count)>((oe=(re=n[18])==null?void 0:re.license_metadata)==null?void 0:oe.seats))&&KA(n);return{c(){be(e.$$.fragment),i=Se(),s=ie("button"),r=Se(),a=ie("nav"),o=ie("div"),l=ie("div"),c=Se(),h=ie("div"),u=ie("div"),d=ie("div"),f=ie("button"),g=ie("div"),be(m.$$.fragment),x=Se(),z&&z.c(),y=Se(),w=ie("div"),K&&K.c(),_=Se(),C=ie("div"),j&&j.c(),k=Se(),be(I.$$.fragment),S=Se(),ae&&ae.c(),R=Se(),ge&&ge.c(),P=Se(),ue&&ue.c(),D=Se(),U=ie("div"),pe&&pe.c(),this.h()},l(ee){ve(e.$$.fragment,ee),i=Ie(ee),s=se(ee,"BUTTON",{id:!0,class:!0,"aria-label":!0}),V(s).forEach(E),r=Ie(ee),a=se(ee,"NAV",{class:!0});var Q=V(a);o=se(Q,"DIV",{class:!0});var je=V(o);l=se(je,"DIV",{class:!0}),V(l).forEach(E),c=Ie(je),h=se(je,"DIV",{class:!0});var Re=V(h);u=se(Re,"DIV",{class:!0});var Ne=V(u);d=se(Ne,"DIV",{class:!0});var He=V(d);f=se(He,"BUTTON",{id:!0,class:!0,"aria-label":!0});var Be=V(f);g=se(Be,"DIV",{class:!0});var Je=V(g);ve(m.$$.fragment,Je),Je.forEach(E),Be.forEach(E),x=Ie(He),z&&z.l(He),He.forEach(E),y=Ie(Ne),w=se(Ne,"DIV",{class:!0});var ht=V(w);K&&K.l(ht),ht.forEach(E),_=Ie(Ne),C=se(Ne,"DIV",{class:!0});var ot=V(C);j&&j.l(ot),k=Ie(ot),ve(I.$$.fragment,ot),S=Ie(ot),ae&&ae.l(ot),R=Ie(ot),ge&&ge.l(ot),ot.forEach(E),Ne.forEach(E),Re.forEach(E),je.forEach(E),P=Ie(Q),ue&&ue.l(Q),D=Ie(Q),U=se(Q,"DIV",{class:!0});var Ye=V(U);pe&&pe.l(Ye),Ye.forEach(E),Q.forEach(E),this.h()},h(){A(s,"id","new-chat-button"),A(s,"class","hidden"),A(s,"aria-label","New Chat"),A(l,"class","bg-linear-to-b via-50% from-white via-white to-transparent dark:from-gray-900 dark:via-gray-900 dark:to-transparent pointer-events-none absolute inset-0 -bottom-7 z-[-1]"),A(g,"class","m-auto self-center"),A(f,"id","sidebar-toggle-button"),A(f,"class","cursor-pointer px-2 py-2 flex rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),A(f,"aria-label","Toggle Sidebar"),A(d,"class",p=(n[11]?"md:hidden":"")+" mr-1 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),A(w,"class",v="flex-1 overflow-hidden max-w-full py-0.5 "+(n[11]?"ml-1":"")),A(C,"class","self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),A(u,"class","flex items-center w-full max-w-full"),A(h,"class","flex max-w-full w-full mx-auto px-1 pt-0.5 bg-transparent"),A(o,"class","flex items-center w-full pl-1.5 pr-1"),A(U,"class","absolute top-[100%] left-0 right-0 h-fit"),A(a,"class","sticky top-0 z-30 w-full py-1 -mb-8 flex flex-col items-center drag-region")},m(ee,Q){xe(e,ee,Q),te(ee,i,Q),te(ee,s,Q),te(ee,r,Q),te(ee,a,Q),W(a,o),W(o,l),W(o,c),W(o,h),W(h,u),W(u,d),W(d,f),W(f,g),xe(m,g,null),W(d,x),z&&z.m(d,null),W(u,y),W(u,w),K&&K.m(w,null),W(u,_),W(u,C),j&&j.m(C,null),W(C,k),xe(I,C,null),W(C,S),ae&&ae.m(C,null),W(C,R),ge&&ge.m(C,null),W(a,P),ue&&ue.m(a,null),W(a,D),W(a,U),pe&&pe.m(U,null),T=!0,G||(M=[xt(s,"click",n[22]),xt(f,"click",n[23])],G=!0)},p(ee,Q){var Ne,He,Be,Je,ht,ot,Ye;const je={};Q[0]&1024&&(je.chatId=ee[10]),!t&&Q[0]&256&&(t=!0,je.show=ee[8],Wt(()=>t=!1)),e.$set(je),ee[12]?z&&(yt(),q(z,1,1,()=>{z=null}),wt()):z?(z.p(ee,Q),Q[0]&4096&&H(z,1)):(z=zA(ee),z.c(),H(z,1),z.m(d,null)),(!T||Q[0]&2048&&p!==(p=(ee[11]?"md:hidden":"")+" mr-1 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"))&&A(d,"class",p),ee[5]?K?(K.p(ee,Q),Q[0]&32&&H(K,1)):(K=jA(ee),K.c(),H(K,1),K.m(w,null)):K&&(yt(),q(K,1,1,()=>{K=null}),wt()),(!T||Q[0]&2048&&v!==(v="flex-1 overflow-hidden max-w-full py-0.5 "+(ee[11]?"ml-1":"")))&&A(w,"class",v),ee[2]&&ee[3]&&(ee[3].id||ee[14])?j?(j.p(ee,Q),Q[0]&16396&&H(j,1)):(j=GA(ee),j.c(),H(j,1),j.m(C,k)):j&&(yt(),q(j,1,1,()=>{j=null}),wt());const Re={};Q[0]&8192&&(Re.content=ee[13].t("Controls")),Q[0]&32768|Q[1]&64&&(Re.$$scope={dirty:Q,ctx:ee}),I.$set(Re),ee[12]?ae?(ae.p(ee,Q),Q[0]&4096&&H(ae,1)):(ae=VA(ee),ae.c(),H(ae,1),ae.m(C,R)):ae&&(yt(),q(ae,1,1,()=>{ae=null}),wt()),ee[16]!==void 0&&ee[16]!==null?ge?(ge.p(ee,Q),Q[0]&65536&&H(ge,1)):(ge=qA(ee),ge.c(),H(ge,1),ge.m(C,null)):ge&&(yt(),q(ge,1,1,()=>{ge=null}),wt()),ee[14]&&ee[10]==="local"?ue?ue.p(ee,Q):(ue=WA(ee),ue.c(),ue.m(a,D)):ue&&(ue.d(1),ue=null),!ee[4].currentId&&!ee[10]&&(ee[17].length>0||(((He=(Ne=ee[18])==null?void 0:Ne.license_metadata)==null?void 0:He.type)??null)==="trial"||(((Je=(Be=ee[18])==null?void 0:Be.license_metadata)==null?void 0:Je.seats)??null)!==null&&((ht=ee[18])==null?void 0:ht.user_count)>((Ye=(ot=ee[18])==null?void 0:ot.license_metadata)==null?void 0:Ye.seats))?pe?(pe.p(ee,Q),Q[0]&394256&&H(pe,1)):(pe=KA(ee),pe.c(),H(pe,1),pe.m(U,null)):pe&&(yt(),q(pe,1,1,()=>{pe=null}),wt())},i(ee){T||(H(e.$$.fragment,ee),H(m.$$.fragment,ee),H(z),H(K),H(j),H(I.$$.fragment,ee),H(ae),H(ge),H(pe),T=!0)},o(ee){q(e.$$.fragment,ee),q(m.$$.fragment,ee),q(z),q(K),q(j),q(I.$$.fragment,ee),q(ae),q(ge),q(pe),T=!1},d(ee){ee&&(E(i),E(s),E(r),E(a)),ye(e,ee),ye(m),z&&z.d(),K&&K.d(),j&&j.d(),ye(I),ae&&ae.d(),ge&&ge.d(),ue&&ue.d(),pe&&pe.d(),G=!1,Zr(M)}}}function Bte(n,e,t){let i,s,r,a,o,l,c,h,u,d;Oe(n,SI,j=>t(33,i=j)),Oe(n,cu,j=>t(10,s=j)),Oe(n,Zw,j=>t(11,r=j)),Oe(n,tx,j=>t(12,a=j)),Oe(n,Od,j=>t(14,l=j)),Oe(n,Ki,j=>t(15,c=j)),Oe(n,w0,j=>t(16,h=j)),Oe(n,fD,j=>t(17,u=j)),Oe(n,Gg,j=>t(18,d=j));const f=qs("i18n");Oe(n,f,j=>t(13,o=j));let{initNewChat:g}=e,{title:m=i}=e,{shareEnabled:x=!1}=e,{chat:p}=e,{history:y}=e,{selectedModels:w}=e,{showModelSelector:v=!0}=e,{showBanners:_=!0}=e,C=[],k=!1,I=!1;function S(j){k=j,t(8,k)}const R=()=>{g()},P=()=>{Zw.set(!r)},D=()=>{g()};function U(j){w=j,t(0,w)}const T=()=>{t(8,k=!k)},G=()=>{t(9,I=!I)},M=async()=>{await Ki.set(!c)},F=()=>{g()},X=j=>{j.detail==="archived-chat"&&gD.set(!0)},z=j=>![...JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]"),...C].includes(j.id),K=(j,ae)=>{const ge=ae.detail;j.dismissible?localStorage.setItem("dismissedBannerIds",JSON.stringify([ge,...JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]")].filter(ue=>u.find(pe=>pe.id===ue)))):t(7,C=[...C,ge])};return n.$$set=j=>{"initNewChat"in j&&t(1,g=j.initNewChat),"title"in j&&t(20,m=j.title),"shareEnabled"in j&&t(2,x=j.shareEnabled),"chat"in j&&t(3,p=j.chat),"history"in j&&t(4,y=j.history),"selectedModels"in j&&t(0,w=j.selectedModels),"showModelSelector"in j&&t(5,v=j.showModelSelector),"showBanners"in j&&t(6,_=j.showBanners)},[w,g,x,p,y,v,_,C,k,I,s,r,a,o,l,c,h,u,d,f,m,S,R,P,D,U,T,G,M,F,X,z,K]}class Ute extends Ht{constructor(e){super(),zt(this,e,Bte,Fte,qt,{initNewChat:1,title:20,shareEnabled:2,chat:3,history:4,selectedModels:0,showModelSelector:5,showBanners:6},null,[-1,-1])}}function Ii(n){if(typeof n=="string"||typeof n=="number")return""+n;let e="";if(Array.isArray(n))for(let t=0,i;t<n.length;t++)(i=Ii(n[t]))!==""&&(e+=(e&&" ")+i);else for(let t in n)n[t]&&(e+=(e&&" ")+t);return e}const vx={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:n=>`Node type "${n}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:n=>`The old edge with id=${n} does not exist.`,error009:n=>`Marker type "${n}" doesn't exist.`,error008:(n,{id:e,sourceHandle:t,targetHandle:i})=>`Couldn't create edge for ${n} handle id: "${n==="source"?t:i}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:n=>`Edge type "${n}" not found. Using fallback type "default".`,error012:n=>`Node with id "${n}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(n="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${n}/dist/style.css' or base.css to make sure everything is working properly.`},n5=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]];var ef;(function(n){n.Strict="strict",n.Loose="loose"})(ef||(ef={}));var tc;(function(n){n.Free="free",n.Vertical="vertical",n.Horizontal="horizontal"})(tc||(tc={}));var i5;(function(n){n.Partial="partial",n.Full="full"})(i5||(i5={}));const q6={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var r1;(function(n){n.Bezier="default",n.Straight="straight",n.Step="step",n.SmoothStep="smoothstep",n.SimpleBezier="simplebezier"})(r1||(r1={}));var s5;(function(n){n.Arrow="arrow",n.ArrowClosed="arrowclosed"})(s5||(s5={}));var pn;(function(n){n.Left="left",n.Top="top",n.Right="right",n.Bottom="bottom"})(pn||(pn={}));const QA={[pn.Left]:pn.Right,[pn.Right]:pn.Left,[pn.Top]:pn.Bottom,[pn.Bottom]:pn.Top};function Hte(n,e){if(!n&&!e)return!0;if(!n||!e||n.size!==e.size)return!1;if(!n.size&&!e.size)return!0;for(const t of n.keys())if(!e.has(t))return!1;return!0}function $A(n,e,t){if(!t)return;const i=[];n.forEach((s,r)=>{e!=null&&e.has(r)||i.push(s)}),i.length&&t(i)}function eS(n){return n===null?null:n?"valid":"invalid"}const zte=n=>"id"in n&&"source"in n&&"target"in n,jte=n=>"id"in n&&"position"in n&&!("source"in n)&&!("target"in n),Lv=n=>"id"in n&&"internals"in n&&!("source"in n)&&!("target"in n),Iy=(n,e=[0,0])=>{const{width:t,height:i}=Zg(n),s=n.origin??e,r=t*s[0],a=i*s[1];return{x:n.position.x-r,y:n.position.y-a}},Gte=(n,e={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(n.length===0)return{x:0,y:0,width:0,height:0};const t=n.reduce((i,s)=>{const r=typeof s=="string";let a=!e.nodeLookup&&!r?s:void 0;e.nodeLookup&&(a=r?e.nodeLookup.get(s):Lv(s)?s:e.nodeLookup.get(s.id));const o=a?r5(a,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Ty(i,o)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Ry(t)},Ey=(n,e={})=>{if(n.size===0)return{x:0,y:0,width:0,height:0};let t={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return n.forEach(i=>{if(e.filter===void 0||e.filter(i)){const s=r5(i);t=Ty(t,s)}}),Ry(t)},cO=(n,e,[t,i,s]=[0,0,1],r=!1,a=!1)=>{const o={..._x(e,[t,i,s]),width:e.width/s,height:e.height/s},l=[];for(const c of n.values()){const{measured:h,selectable:u=!0,hidden:d=!1}=c;if(a&&!u||d)continue;const f=h.width??c.width??c.initialWidth??null,g=h.height??c.height??c.initialHeight??null,m=s2(o,Bg(c)),x=(f??0)*(g??0),p=r&&m>0;(!c.internals.handleBounds||p||m>=x||c.dragging)&&l.push(c)}return l},W6=(n,e)=>{const t=new Set;return n.forEach(i=>{t.add(i.id)}),e.filter(i=>t.has(i.source)||t.has(i.target))};function tS(n,e){const t=new Map,i=e!=null&&e.nodes?new Set(e.nodes.map(s=>s.id)):null;return n.forEach(s=>{s.measured.width&&s.measured.height&&((e==null?void 0:e.includeHiddenNodes)||!s.hidden)&&(!i||i.has(s.id))&&t.set(s.id,s)}),t}async function nS({nodes:n,width:e,height:t,panZoom:i,minZoom:s,maxZoom:r},a){if(n.size===0)return Promise.resolve(!1);const o=Ey(n),l=Bv(o,e,t,(a==null?void 0:a.minZoom)??s,(a==null?void 0:a.maxZoom)??r,(a==null?void 0:a.padding)??.1);return await i.setViewport(l,{duration:a==null?void 0:a.duration}),Promise.resolve(!0)}function Vte({nodeId:n,nextPosition:e,nodeLookup:t,nodeOrigin:i=[0,0],nodeExtent:s,onError:r}){const a=t.get(n),o=a.parentId?t.get(a.parentId):void 0,{x:l,y:c}=o?o.internals.positionAbsolute:{x:0,y:0},h=a.origin??i;let u=s;if(a.extent==="parent"&&!a.expandParent)if(!o)r==null||r("005",vx.error005());else{const f=o.measured.width,g=o.measured.height;f&&g&&(u=[[l,c],[l+f,c+g]])}else o&&r2(a.extent)&&(u=[[a.extent[0][0]+l,a.extent[0][1]+c],[a.extent[1][0]+l,a.extent[1][1]+c]]);const d=r2(u)?Fg(e,u,a.measured):e;return{position:{x:d.x-l+a.measured.width*h[0],y:d.y-c+a.measured.height*h[1]},positionAbsolute:d}}async function hO({nodesToRemove:n=[],edgesToRemove:e=[],nodes:t,edges:i,onBeforeDelete:s}){const r=new Set(n.map(d=>d.id)),a=[];for(const d of t){if(d.deletable===!1)continue;const f=r.has(d.id),g=!f&&d.parentId&&a.find(m=>m.id===d.parentId);(f||g)&&a.push(d)}const o=new Set(e.map(d=>d.id)),l=i.filter(d=>d.deletable!==!1),h=W6(a,l);for(const d of l)o.has(d.id)&&!h.find(g=>g.id===d.id)&&h.push(d);if(!s)return{edges:h,nodes:a};const u=await s({nodes:a,edges:h});return typeof u=="boolean"?u?{edges:h,nodes:a}:{edges:[],nodes:[]}:u}const Lg=(n,e=0,t=1)=>Math.min(Math.max(n,e),t),Fg=(n={x:0,y:0},e,t)=>({x:Lg(n.x,e[0][0],e[1][0]-((t==null?void 0:t.width)??0)),y:Lg(n.y,e[0][1],e[1][1]-((t==null?void 0:t.height)??0))});function uO(n,e,t){const{width:i,height:s}=Zg(t),{x:r,y:a}=t.internals.positionAbsolute;return Fg(n,[[r,a],[r+i,a+s]],e)}const iS=(n,e,t)=>n<e?Lg(Math.abs(n-e),1,e)/e:n>t?-Lg(Math.abs(n-t),1,e)/e:0,dO=(n,e,t=15,i=40)=>{const s=iS(n.x,i,e.width-i)*t,r=iS(n.y,i,e.height-i)*t;return[s,r]},Ty=(n,e)=>({x:Math.min(n.x,e.x),y:Math.min(n.y,e.y),x2:Math.max(n.x2,e.x2),y2:Math.max(n.y2,e.y2)}),K6=({x:n,y:e,width:t,height:i})=>({x:n,y:e,x2:n+t,y2:e+i}),Ry=({x:n,y:e,x2:t,y2:i})=>({x:n,y:e,width:t-n,height:i-e}),Bg=(n,e=[0,0])=>{var s,r;const{x:t,y:i}=Lv(n)?n.internals.positionAbsolute:Iy(n,e);return{x:t,y:i,width:((s=n.measured)==null?void 0:s.width)??n.width??n.initialWidth??0,height:((r=n.measured)==null?void 0:r.height)??n.height??n.initialHeight??0}},r5=(n,e=[0,0])=>{var s,r;const{x:t,y:i}=Lv(n)?n.internals.positionAbsolute:Iy(n,e);return{x:t,y:i,x2:t+(((s=n.measured)==null?void 0:s.width)??n.width??n.initialWidth??0),y2:i+(((r=n.measured)==null?void 0:r.height)??n.height??n.initialHeight??0)}},qte=(n,e)=>Ry(Ty(K6(n),K6(e))),s2=(n,e)=>{const t=Math.max(0,Math.min(n.x+n.width,e.x+e.width)-Math.max(n.x,e.x)),i=Math.max(0,Math.min(n.y+n.height,e.y+e.height)-Math.max(n.y,e.y));return Math.ceil(t*i)},sS=n=>Zo(n.width)&&Zo(n.height)&&Zo(n.x)&&Zo(n.y),Zo=n=>!isNaN(n)&&isFinite(n),Wte=(n,e)=>{},Fv=(n,e=[1,1])=>({x:e[0]*Math.round(n.x/e[0]),y:e[1]*Math.round(n.y/e[1])}),_x=({x:n,y:e},[t,i,s],r=!1,a=[1,1])=>{const o={x:(n-t)/s,y:(e-i)/s};return r?Fv(o,a):o},fO=({x:n,y:e},[t,i,s])=>({x:n*s+t,y:e*s+i}),Bv=(n,e,t,i,s,r)=>{const a=e/(n.width*(1+r)),o=t/(n.height*(1+r)),l=Math.min(a,o),c=Lg(l,i,s),h=n.x+n.width/2,u=n.y+n.height/2,d=e/2-h*c,f=t/2-u*c;return{x:d,y:f,zoom:c}},a5=()=>{var n;return typeof navigator<"u"&&((n=navigator==null?void 0:navigator.userAgent)==null?void 0:n.indexOf("Mac"))>=0};function r2(n){return n!==void 0&&n!=="parent"}function Zg(n){var e,t;return{width:((e=n.measured)==null?void 0:e.width)??n.width??n.initialWidth??0,height:((t=n.measured)==null?void 0:t.height)??n.height??n.initialHeight??0}}function rS(n){var e,t;return(((e=n.measured)==null?void 0:e.width)??n.width??n.initialWidth)!==void 0&&(((t=n.measured)==null?void 0:t.height)??n.height??n.initialHeight)!==void 0}function Kte(n,e={width:0,height:0},t,i,s){let r=t;const a={...n};for(;r;){const o=i.get(r);if(r=o==null?void 0:o.parentId,o){const l=o.origin||s;a.x+=o.internals.positionAbsolute.x-(e.width??0)*l[0],a.y+=o.internals.positionAbsolute.y-(e.height??0)*l[1]}}return a}function Vw(n,{snapGrid:e=[0,0],snapToGrid:t=!1,transform:i}){const{x:s,y:r}=c0(n),a=_x({x:s,y:r},i),{x:o,y:l}=t?Fv(a,e):a;return{xSnapped:o,ySnapped:l,...a}}const gO=n=>({width:n.offsetWidth,height:n.offsetHeight}),Xte=n=>{var e;return((e=n.getRootNode)==null?void 0:e.call(n))||(window==null?void 0:window.document)},Yte=["INPUT","SELECT","TEXTAREA"];function Jte(n){var i,s;const e=((s=(i=n.composedPath)==null?void 0:i.call(n))==null?void 0:s[0])||n.target;return Yte.includes(e==null?void 0:e.nodeName)||(e==null?void 0:e.hasAttribute("contenteditable"))||!!(e!=null&&e.closest(".nokey"))}const mO=n=>"clientX"in n,c0=(n,e)=>{var r,a;const t=mO(n),i=t?n.clientX:(r=n.touches)==null?void 0:r[0].clientX,s=t?n.clientY:(a=n.touches)==null?void 0:a[0].clientY;return{x:i-((e==null?void 0:e.left)??0),y:s-((e==null?void 0:e.top)??0)}},aS=(n,e,t,i,s)=>{const r=e.querySelectorAll(`.${n}`);return!r||!r.length?null:Array.from(r).map(a=>{const o=a.getBoundingClientRect();return{id:a.getAttribute("data-handleid"),type:n,nodeId:s,position:a.getAttribute("data-handlepos"),x:(o.left-t.left)/i,y:(o.top-t.top)/i,...gO(a)}})};function Zte({sourceX:n,sourceY:e,targetX:t,targetY:i,sourceControlX:s,sourceControlY:r,targetControlX:a,targetControlY:o}){const l=n*.125+s*.375+a*.375+t*.125,c=e*.125+r*.375+o*.375+i*.125,h=Math.abs(l-n),u=Math.abs(c-e);return[l,c,h,u]}function f9(n,e){return n>=0?.5*n:e*25*Math.sqrt(-n)}function oS({pos:n,x1:e,y1:t,x2:i,y2:s,c:r}){switch(n){case pn.Left:return[e-f9(e-i,r),t];case pn.Right:return[e+f9(i-e,r),t];case pn.Top:return[e,t-f9(t-s,r)];case pn.Bottom:return[e,t+f9(s-t,r)]}}function pO({sourceX:n,sourceY:e,sourcePosition:t=pn.Bottom,targetX:i,targetY:s,targetPosition:r=pn.Top,curvature:a=.25}){const[o,l]=oS({pos:t,x1:n,y1:e,x2:i,y2:s,c:a}),[c,h]=oS({pos:r,x1:i,y1:s,x2:n,y2:e,c:a}),[u,d,f,g]=Zte({sourceX:n,sourceY:e,targetX:i,targetY:s,sourceControlX:o,sourceControlY:l,targetControlX:c,targetControlY:h});return[`M${n},${e} C${o},${l} ${c},${h} ${i},${s}`,u,d,f,g]}function bO({sourceX:n,sourceY:e,targetX:t,targetY:i}){const s=Math.abs(t-n)/2,r=t<n?t+s:t-s,a=Math.abs(i-e)/2,o=i<e?i+a:i-a;return[r,o,s,a]}function Qte({sourceNode:n,targetNode:e,selected:t=!1,zIndex:i=0,elevateOnSelect:s=!1}){if(!s)return i;const r=t||e.selected||n.selected,a=Math.max(n.internals.z||0,e.internals.z||0,1e3);return i+(r?a:0)}function $te({sourceNode:n,targetNode:e,width:t,height:i,transform:s}){const r=Ty(r5(n),r5(e));r.x===r.x2&&(r.x2+=1),r.y===r.y2&&(r.y2+=1);const a={x:-s[0]/s[2],y:-s[1]/s[2],width:t/s[2],height:i/s[2]};return s2(a,Ry(r))>0}const ene=({source:n,sourceHandle:e,target:t,targetHandle:i})=>`xy-edge__${n}${e||""}-${t}${i||""}`,tne=(n,e)=>e.some(t=>t.source===n.source&&t.target===n.target&&(t.sourceHandle===n.sourceHandle||!t.sourceHandle&&!n.sourceHandle)&&(t.targetHandle===n.targetHandle||!t.targetHandle&&!n.targetHandle)),nne=(n,e)=>{if(!n.source||!n.target)return e;let t;return zte(n)?t={...n}:t={...n,id:ene(n)},tne(t,e)?e:(t.sourceHandle===null&&delete t.sourceHandle,t.targetHandle===null&&delete t.targetHandle,e.concat(t))};function xO({sourceX:n,sourceY:e,targetX:t,targetY:i}){const[s,r,a,o]=bO({sourceX:n,sourceY:e,targetX:t,targetY:i});return[`M ${n},${e}L ${t},${i}`,s,r,a,o]}const lS={[pn.Left]:{x:-1,y:0},[pn.Right]:{x:1,y:0},[pn.Top]:{x:0,y:-1},[pn.Bottom]:{x:0,y:1}},ine=({source:n,sourcePosition:e=pn.Bottom,target:t})=>e===pn.Left||e===pn.Right?n.x<t.x?{x:1,y:0}:{x:-1,y:0}:n.y<t.y?{x:0,y:1}:{x:0,y:-1},cS=(n,e)=>Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2));function sne({source:n,sourcePosition:e=pn.Bottom,target:t,targetPosition:i=pn.Top,center:s,offset:r}){const a=lS[e],o=lS[i],l={x:n.x+a.x*r,y:n.y+a.y*r},c={x:t.x+o.x*r,y:t.y+o.y*r},h=ine({source:l,sourcePosition:e,target:c}),u=h.x!==0?"x":"y",d=h[u];let f=[],g,m;const x={x:0,y:0},p={x:0,y:0},[y,w,v,_]=bO({sourceX:n.x,sourceY:n.y,targetX:t.x,targetY:t.y});if(a[u]*o[u]===-1){g=s.x??y,m=s.y??w;const k=[{x:g,y:l.y},{x:g,y:c.y}],I=[{x:l.x,y:m},{x:c.x,y:m}];a[u]===d?f=u==="x"?k:I:f=u==="x"?I:k}else{const k=[{x:l.x,y:c.y}],I=[{x:c.x,y:l.y}];if(u==="x"?f=a.x===d?I:k:f=a.y===d?k:I,e===i){const U=Math.abs(n[u]-t[u]);if(U<=r){const T=Math.min(r-1,r-U);a[u]===d?x[u]=(l[u]>n[u]?-1:1)*T:p[u]=(c[u]>t[u]?-1:1)*T}}if(e!==i){const U=u==="x"?"y":"x",T=a[u]===o[U],G=l[U]>c[U],M=l[U]<c[U];(a[u]===1&&(!T&&G||T&&M)||a[u]!==1&&(!T&&M||T&&G))&&(f=u==="x"?k:I)}const S={x:l.x+x.x,y:l.y+x.y},R={x:c.x+p.x,y:c.y+p.y},P=Math.max(Math.abs(S.x-f[0].x),Math.abs(R.x-f[0].x)),D=Math.max(Math.abs(S.y-f[0].y),Math.abs(R.y-f[0].y));P>=D?(g=(S.x+R.x)/2,m=f[0].y):(g=f[0].x,m=(S.y+R.y)/2)}return[[n,{x:l.x+x.x,y:l.y+x.y},...f,{x:c.x+p.x,y:c.y+p.y},t],g,m,v,_]}function rne(n,e,t,i){const s=Math.min(cS(n,e)/2,cS(e,t)/2,i),{x:r,y:a}=e;if(n.x===r&&r===t.x||n.y===a&&a===t.y)return`L${r} ${a}`;if(n.y===a){const c=n.x<t.x?-1:1,h=n.y<t.y?1:-1;return`L ${r+s*c},${a}Q ${r},${a} ${r},${a+s*h}`}const o=n.x<t.x?1:-1,l=n.y<t.y?-1:1;return`L ${r},${a+s*l}Q ${r},${a} ${r+s*o},${a}`}function o5({sourceX:n,sourceY:e,sourcePosition:t=pn.Bottom,targetX:i,targetY:s,targetPosition:r=pn.Top,borderRadius:a=5,centerX:o,centerY:l,offset:c=20}){const[h,u,d,f,g]=sne({source:{x:n,y:e},sourcePosition:t,target:{x:i,y:s},targetPosition:r,center:{x:o,y:l},offset:c});return[h.reduce((x,p,y)=>{let w="";return y>0&&y<h.length-1?w=rne(h[y-1],p,h[y+1],a):w=`${y===0?"M":"L"}${p.x} ${p.y}`,x+=w,x},""),u,d,f,g]}function hS(n){var e;return n&&!!(n.internals.handleBounds||(e=n.handles)!=null&&e.length)&&!!(n.measured.width||n.width||n.initialWidth)}function ane(n){var u;const{sourceNode:e,targetNode:t}=n;if(!hS(e)||!hS(t))return null;const i=e.internals.handleBounds||uS(e.handles),s=t.internals.handleBounds||uS(t.handles),r=dS((i==null?void 0:i.source)??[],n.sourceHandle),a=dS(n.connectionMode===ef.Strict?(s==null?void 0:s.target)??[]:((s==null?void 0:s.target)??[]).concat((s==null?void 0:s.source)??[]),n.targetHandle);if(!r||!a)return(u=n.onError)==null||u.call(n,"008",vx.error008(r?"target":"source",{id:n.id,sourceHandle:n.sourceHandle,targetHandle:n.targetHandle})),null;const o=(r==null?void 0:r.position)||pn.Bottom,l=(a==null?void 0:a.position)||pn.Top,c=a2(e,r,o),h=a2(t,a,l);return{sourceX:c.x,sourceY:c.y,targetX:h.x,targetY:h.y,sourcePosition:o,targetPosition:l}}function uS(n){if(!n)return null;const e=[],t=[];for(const i of n)i.width=i.width??1,i.height=i.height??1,i.type==="source"?e.push(i):i.type==="target"&&t.push(i);return{source:e,target:t}}function a2(n,e,t=pn.Left,i=!1){const s=((e==null?void 0:e.x)??0)+n.internals.positionAbsolute.x,r=((e==null?void 0:e.y)??0)+n.internals.positionAbsolute.y,{width:a,height:o}=e??Zg(n);if(i)return{x:s+a/2,y:r+o/2};switch((e==null?void 0:e.position)??t){case pn.Top:return{x:s+a/2,y:r};case pn.Right:return{x:s+a,y:r+o/2};case pn.Bottom:return{x:s+a/2,y:r+o};case pn.Left:return{x:s,y:r+o/2}}}function dS(n,e){return n&&(e?n.find(t=>t.id===e):n[0])||null}function X6(n,e){return n?typeof n=="string"?n:`${e?`${e}__`:""}${Object.keys(n).sort().map(i=>`${i}=${n[i]}`).join("&")}`:""}function one(n,{id:e,defaultColor:t,defaultMarkerStart:i,defaultMarkerEnd:s}){const r=new Set;return n.reduce((a,o)=>([o.markerStart||i,o.markerEnd||s].forEach(l=>{if(l&&typeof l=="object"){const c=X6(l,e);r.has(c)||(a.push({id:c,color:l.color||t,...l}),r.add(c))}}),a),[]).sort((a,o)=>a.id.localeCompare(o.id))}const yO={nodeOrigin:[0,0],nodeExtent:n5,elevateNodesOnSelect:!0,defaults:{}},lne={...yO,checkEquality:!0};function wO(n,e){const t={...n};for(const i in e)e[i]!==void 0&&(t[i]=e[i]);return t}function vO(n,e,t,i){var o,l;const s=wO(lne,i),r=new Map(e),a=s!=null&&s.elevateNodesOnSelect?1e3:0;e.clear(),t.clear();for(const c of n){let h=r.get(c.id);if(s.checkEquality&&c===(h==null?void 0:h.internals.userNode))e.set(c.id,h);else{const u=Iy(c,s.nodeOrigin),d=r2(c.extent)?c.extent:s.nodeExtent,f=Fg(u,d,Zg(c));h={...s.defaults,...c,measured:{width:(o=c.measured)==null?void 0:o.width,height:(l=c.measured)==null?void 0:l.height},internals:{positionAbsolute:f,handleBounds:c.measured?h==null?void 0:h.internals.handleBounds:void 0,z:kO(c,a),userNode:c}},e.set(c.id,h)}c.parentId&&_O(h,e,t,i)}}function cne(n,e){if(!n.parentId)return;const t=e.get(n.parentId);t?t.set(n.id,n):e.set(n.parentId,new Map([[n.id,n]]))}function _O(n,e,t,i){const{elevateNodesOnSelect:s,nodeOrigin:r,nodeExtent:a}=wO(yO,i),o=n.parentId,l=e.get(o);if(!l){console.warn(`Parent node ${o} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}cne(n,t);const c=s?1e3:0,{x:h,y:u,z:d}=hne(n,l,r,a,c),{positionAbsolute:f}=n.internals,g=h!==f.x||u!==f.y;(g||d!==n.internals.z)&&(n.internals={...n.internals,positionAbsolute:g?{x:h,y:u}:f,z:d})}function kO(n,e){return(Zo(n.zIndex)?n.zIndex:0)+(n.selected?e:0)}function hne(n,e,t,i,s){const{x:r,y:a}=e.internals.positionAbsolute,o=Zg(n),l=Iy(n,t),c=r2(n.extent)?Fg(l,n.extent,o):l;let h=Fg({x:r+c.x,y:a+c.y},i,o);n.extent==="parent"&&(h=uO(h,o,e));const u=kO(n,s),d=e.internals.z??0;return{x:h.x,y:h.y,z:d>u?d:u}}function une(n,e,t,i=[0,0]){var a;const s=[],r=new Map;for(const o of n){const l=e.get(o.parentId);if(!l)continue;const c=((a=r.get(o.parentId))==null?void 0:a.expandedRect)??Bg(l),h=qte(c,o.rect);r.set(o.parentId,{expandedRect:h,parent:l})}return r.size>0&&r.forEach(({expandedRect:o,parent:l},c)=>{var w;const h=l.internals.positionAbsolute,u=Zg(l),d=l.origin??i,f=o.x<h.x?Math.round(Math.abs(h.x-o.x)):0,g=o.y<h.y?Math.round(Math.abs(h.y-o.y)):0,m=Math.max(u.width,Math.round(o.width)),x=Math.max(u.height,Math.round(o.height)),p=(m-u.width)*d[0],y=(x-u.height)*d[1];(f>0||g>0||p||y)&&(s.push({id:c,type:"position",position:{x:l.position.x-f+p,y:l.position.y-g+y}}),(w=t.get(c))==null||w.forEach(v=>{n.some(_=>_.id===v.id)||s.push({id:v.id,type:"position",position:{x:v.position.x+f,y:v.position.y+g}})})),(u.width<o.width||u.height<o.height||f||g)&&s.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:m+(f?d[0]*f-p:0),height:x+(g?d[1]*g-y:0)}})}),s}function dne(n,e,t,i,s,r){const a=i==null?void 0:i.querySelector(".xyflow__viewport");let o=!1;if(!a)return{changes:[],updatedInternals:o};const l=[],c=window.getComputedStyle(a),{m22:h}=new window.DOMMatrixReadOnly(c.transform),u=[];for(const d of n.values()){const f=e.get(d.id);if(f)if(f.hidden)f.internals={...f.internals,handleBounds:void 0},o=!0;else{const g=gO(d.nodeElement),m=f.measured.width!==g.width||f.measured.height!==g.height;if(!!(g.width&&g.height&&(m||!f.internals.handleBounds||d.force))){const p=d.nodeElement.getBoundingClientRect(),y=r2(f.extent)?f.extent:r;let{positionAbsolute:w}=f.internals;f.parentId&&f.extent==="parent"?w=uO(w,g,e.get(f.parentId)):y&&(w=Fg(w,y,g)),f.measured=g,f.internals={...f.internals,positionAbsolute:w,handleBounds:{source:aS("source",d.nodeElement,p,h,f.id),target:aS("target",d.nodeElement,p,h,f.id)}},f.parentId&&_O(f,e,t,{nodeOrigin:s}),o=!0,m&&(l.push({id:f.id,type:"dimensions",dimensions:g}),f.expandParent&&f.parentId&&u.push({id:f.id,parentId:f.parentId,rect:Bg(f,s)}))}}}if(u.length>0){const d=une(u,e,t,s);l.push(...d)}return{changes:l,updatedInternals:o}}async function fne({delta:n,panZoom:e,transform:t,translateExtent:i,width:s,height:r}){if(!e||!n.x&&!n.y)return Promise.resolve(!1);const a=await e.setViewportConstrained({x:t[0]+n.x,y:t[1]+n.y,zoom:t[2]},[[0,0],[s,r]],i),o=!!a&&(a.x!==t[0]||a.y!==t[1]||a.k!==t[2]);return Promise.resolve(o)}function CO(n,e,t){n.clear(),e.clear();for(const i of t){const{source:s,target:r,sourceHandle:a=null,targetHandle:o=null}=i,l=`${s}-source-${a}`,c=`${r}-target-${o}`,h=n.get(l)||new Map,u=n.get(c)||new Map,d={edgeId:i.id,source:s,target:r,sourceHandle:a,targetHandle:o};e.set(i.id,i),n.set(l,h.set(`${r}-${o}`,d)),n.set(c,u.set(`${s}-${a}`,d))}}function AO(n,e){if(!n.parentId)return!1;const t=e.get(n.parentId);return t?t.selected?!0:AO(t,e):!1}function fS(n,e,t){let i=n;do{if(i!=null&&i.matches(e))return!0;if(i===t)return!1;i=i.parentElement}while(i);return!1}function gne(n,e,t,i){const s=new Map;for(const[r,a]of n)if((a.selected||a.id===i)&&(!a.parentId||!AO(a,n))&&(a.draggable||e&&typeof a.draggable>"u")){const o=n.get(r);o&&s.set(r,{id:r,position:o.position||{x:0,y:0},distance:{x:t.x-o.internals.positionAbsolute.x,y:t.y-o.internals.positionAbsolute.y},extent:o.extent,parentId:o.parentId,origin:o.origin,expandParent:o.expandParent,internals:{positionAbsolute:o.internals.positionAbsolute||{x:0,y:0}},measured:{width:o.measured.width??0,height:o.measured.height??0}})}return s}function qw({nodeId:n,dragItems:e,nodeLookup:t,dragging:i=!0}){var a,o;const s=[];for(const[l,c]of e){const h=(a=t.get(l))==null?void 0:a.internals.userNode;h&&s.push({...h,position:c.position,dragging:i})}if(!n)return[s[0],s];const r=t.get(n).internals.userNode;return[{...r,position:((o=e.get(n))==null?void 0:o.position)||r.position,dragging:i},s]}function mne({onNodeMouseDown:n,getStoreItems:e,onDragStart:t,onDrag:i,onDragStop:s}){let r={x:null,y:null},a=0,o=new Map,l=!1,c={x:0,y:0},h=null,u=!1,d=null,f=!1;function g({noDragClassName:x,handleSelector:p,domNode:y,isSelectable:w,nodeId:v,nodeClickDistance:_=0}){d=Ko(y);function C({x:R,y:P},D){const{nodeLookup:U,nodeExtent:T,snapGrid:G,snapToGrid:M,nodeOrigin:F,onNodeDrag:X,onSelectionDrag:z,onError:K,updateNodePositions:j}=e();r={x:R,y:P};let ae=!1,ge={x:0,y:0,x2:0,y2:0};if(o.size>1&&T){const ue=Ey(o);ge=K6(ue)}for(const[ue,pe]of o){let de={x:R-pe.distance.x,y:P-pe.distance.y};M&&(de=Fv(de,G));let O=[[T[0][0],T[0][1]],[T[1][0],T[1][1]]];if(o.size>1&&T&&!pe.extent){const{positionAbsolute:$}=pe.internals,re=$.x-ge.x+T[0][0],oe=$.x+pe.measured.width-ge.x2+T[1][0],ee=$.y-ge.y+T[0][1],Q=$.y+pe.measured.height-ge.y2+T[1][1];O=[[re,ee],[oe,Q]]}const{position:Y,positionAbsolute:le}=Vte({nodeId:ue,nextPosition:de,nodeLookup:U,nodeExtent:O,nodeOrigin:F,onError:K});ae=ae||pe.position.x!==Y.x||pe.position.y!==Y.y,pe.position=Y,pe.internals.positionAbsolute=le}if(ae&&(j(o,!0),D&&(i||X||!v&&z))){const[ue,pe]=qw({nodeId:v,dragItems:o,nodeLookup:U});i==null||i(D,o,ue,pe),X==null||X(D,ue,pe),v||z==null||z(D,pe)}}async function k(){if(!h)return;const{transform:R,panBy:P,autoPanSpeed:D}=e(),[U,T]=dO(c,h,D);(U!==0||T!==0)&&(r.x=(r.x??0)-U/R[2],r.y=(r.y??0)-T/R[2],await P({x:U,y:T})&&C(r,null)),a=requestAnimationFrame(k)}function I(R){var ae;const{nodeLookup:P,multiSelectionActive:D,nodesDraggable:U,transform:T,snapGrid:G,snapToGrid:M,selectNodesOnDrag:F,onNodeDragStart:X,onSelectionDragStart:z,unselectNodesAndEdges:K}=e();u=!0,(!F||!w)&&!D&&v&&((ae=P.get(v))!=null&&ae.selected||K()),w&&F&&v&&(n==null||n(v));const j=Vw(R.sourceEvent,{transform:T,snapGrid:G,snapToGrid:M});if(r=j,o=gne(P,U,j,v),o.size>0&&(t||X||!v&&z)){const[ge,ue]=qw({nodeId:v,dragItems:o,nodeLookup:P});t==null||t(R.sourceEvent,o,ge,ue),X==null||X(R.sourceEvent,ge,ue),v||z==null||z(R.sourceEvent,ue)}}const S=DL().clickDistance(_).on("start",R=>{const{domNode:P,nodeDragThreshold:D,transform:U,snapGrid:T,snapToGrid:G}=e();f=!1,D===0&&I(R),r=Vw(R.sourceEvent,{transform:U,snapGrid:T,snapToGrid:G}),h=(P==null?void 0:P.getBoundingClientRect())||null,c=c0(R.sourceEvent,h)}).on("drag",R=>{const{autoPanOnNodeDrag:P,transform:D,snapGrid:U,snapToGrid:T,nodeDragThreshold:G}=e(),M=Vw(R.sourceEvent,{transform:D,snapGrid:U,snapToGrid:T});if(R.sourceEvent.type==="touchmove"&&R.sourceEvent.touches.length>1&&(f=!0),!f){if(!l&&P&&u&&(l=!0,k()),!u){const F=M.xSnapped-(r.x??0),X=M.ySnapped-(r.y??0);Math.sqrt(F*F+X*X)>G&&I(R)}(r.x!==M.xSnapped||r.y!==M.ySnapped)&&o&&u&&(c=c0(R.sourceEvent,h),C(M,R.sourceEvent))}}).on("end",R=>{if(!(!u||f)&&(l=!1,u=!1,cancelAnimationFrame(a),o.size>0)){const{nodeLookup:P,updateNodePositions:D,onNodeDragStop:U,onSelectionDragStop:T}=e();if(D(o,!1),s||U||!v&&T){const[G,M]=qw({nodeId:v,dragItems:o,nodeLookup:P,dragging:!1});s==null||s(R.sourceEvent,o,G,M),U==null||U(R.sourceEvent,G,M),v||T==null||T(R.sourceEvent,M)}}}).filter(R=>{const P=R.target;return!R.button&&(!x||!fS(P,`.${x}`,y))&&(!p||fS(P,p,y))});d.call(S)}function m(){d==null||d.on(".drag",null)}return{update:g,destroy:m}}function pne(n,e,t){const i=[],s={x:n.x-t,y:n.y-t,width:t*2,height:t*2};for(const r of e.values())s2(s,Bg(r))>0&&i.push(r);return i}const bne=250;function xne(n,e,t,i){var o,l;let s=[],r=1/0;const a=pne(n,t,e+bne);for(const c of a){const h=[...((o=c.internals.handleBounds)==null?void 0:o.source)??[],...((l=c.internals.handleBounds)==null?void 0:l.target)??[]];for(const u of h){if(i.nodeId===u.nodeId&&i.type===u.type&&i.id===u.id)continue;const{x:d,y:f}=a2(c,u,u.position,!0),g=Math.sqrt(Math.pow(d-n.x,2)+Math.pow(f-n.y,2));g>e||(g<r?(s=[{...u,x:d,y:f}],r=g):g===r&&s.push({...u,x:d,y:f}))}}if(!s.length)return null;if(s.length>1){const c=i.type==="source"?"target":"source";return s.find(h=>h.type===c)??s[0]}return s[0]}function SO(n,e,t,i,s,r=!1){var c,h,u;const a=i.get(n);if(!a)return null;const o=s==="strict"?(c=a.internals.handleBounds)==null?void 0:c[e]:[...((h=a.internals.handleBounds)==null?void 0:h.source)??[],...((u=a.internals.handleBounds)==null?void 0:u.target)??[]],l=(t?o==null?void 0:o.find(d=>d.id===t):o==null?void 0:o[0])??null;return l&&r?{...l,...a2(a,l,l.position,!0)}:l}function IO(n,e){return n||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function yne(n,e){let t=null;return e?t=!0:n&&!e&&(t=!1),t}const EO=()=>!0;function wne(n,{connectionMode:e,connectionRadius:t,handleId:i,nodeId:s,edgeUpdaterType:r,isTarget:a,domNode:o,nodeLookup:l,lib:c,autoPanOnConnect:h,flowId:u,panBy:d,cancelConnection:f,onConnectStart:g,onConnect:m,onConnectEnd:x,isValidConnection:p=EO,onReconnectEnd:y,updateConnection:w,getTransform:v,getFromHandle:_,autoPanSpeed:C}){const k=Xte(n.target);let I=0,S;const{x:R,y:P}=c0(n),D=k==null?void 0:k.elementFromPoint(R,P),U=IO(r,D),T=o==null?void 0:o.getBoundingClientRect();if(!T||!U)return;const G=SO(s,U,i,l,e);if(!G)return;let M=c0(n,T),F=!1,X=null,z=!1,K=null;function j(){if(!h||!T)return;const[le,$]=dO(M,T,C);d({x:le,y:$}),I=requestAnimationFrame(j)}const ae={...G,nodeId:s,type:U,position:G.position},ge=l.get(s),pe={inProgress:!0,isValid:null,from:a2(ge,ae,pn.Left,!0),fromHandle:ae,fromPosition:ae.position,fromNode:ge,to:M,toHandle:null,toPosition:QA[ae.position],toNode:null};w(pe);let de=pe;g==null||g(n,{nodeId:s,handleId:i,handleType:U});function O(le){if(!_()||!ae){Y(le);return}const $=v();M=c0(le,T),S=xne(_x(M,$,!1,[1,1]),t,l,ae),F||(j(),F=!0);const re=TO(le,{handle:S,connectionMode:e,fromNodeId:s,fromHandleId:i,fromType:a?"target":"source",isValidConnection:p,doc:k,lib:c,flowId:u,nodeLookup:l});K=re.handleDomNode,X=re.connection,z=yne(!!S,re.isValid);const oe={...de,isValid:z,to:S&&z?fO({x:S.x,y:S.y},$):M,toHandle:re.toHandle,toPosition:z&&re.toHandle?re.toHandle.position:QA[ae.position],toNode:re.toHandle?l.get(re.toHandle.nodeId):null};z&&S&&de.toHandle&&oe.toHandle&&de.toHandle.type===oe.toHandle.type&&de.toHandle.nodeId===oe.toHandle.nodeId&&de.toHandle.id===oe.toHandle.id&&de.to.x===oe.to.x&&de.to.y===oe.to.y||(w(oe),de=oe)}function Y(le){(S||K)&&X&&z&&(m==null||m(X));const{inProgress:$,...re}=de,oe={...re,toPosition:de.toHandle?de.toPosition:null};x==null||x(le,oe),r&&(y==null||y(le,oe)),f(),cancelAnimationFrame(I),F=!1,z=!1,X=null,K=null,k.removeEventListener("mousemove",O),k.removeEventListener("mouseup",Y),k.removeEventListener("touchmove",O),k.removeEventListener("touchend",Y)}k.addEventListener("mousemove",O),k.addEventListener("mouseup",Y),k.addEventListener("touchmove",O),k.addEventListener("touchend",Y)}function TO(n,{handle:e,connectionMode:t,fromNodeId:i,fromHandleId:s,fromType:r,doc:a,lib:o,flowId:l,isValidConnection:c=EO,nodeLookup:h}){const u=r==="target",d=e?a.querySelector(`.${o}-flow__handle[data-id="${l}-${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`):null,{x:f,y:g}=c0(n),m=a.elementFromPoint(f,g),x=m!=null&&m.classList.contains(`${o}-flow__handle`)?m:d,p={handleDomNode:x,isValid:!1,connection:null,toHandle:null};if(x){const y=IO(void 0,x),w=x.getAttribute("data-nodeid"),v=x.getAttribute("data-handleid"),_=x.classList.contains("connectable"),C=x.classList.contains("connectableend");if(!w||!y)return p;const k={source:u?w:i,sourceHandle:u?v:s,target:u?i:w,targetHandle:u?s:v};p.connection=k;const S=_&&C&&(t===ef.Strict?u&&y==="source"||!u&&y==="target":w!==i||v!==s);p.isValid=S&&c(k),p.toHandle=SO(w,y,v,h,t,!1)}return p}const vne={onPointerDown:wne,isValid:TO},_ne=(n,e)=>n.x!==e.x||n.y!==e.y||n.zoom!==e.k,My=n=>({x:n.x,y:n.y,zoom:n.k}),Ww=({x:n,y:e,zoom:t})=>Y6.translate(n,e).scale(t),Hf=(n,e)=>n.target.closest(`.${e}`),RO=(n,e)=>e===2&&Array.isArray(n)&&n.includes(2),Kw=(n,e=0,t=()=>{})=>{const i=typeof e=="number"&&e>0;return i||t(),i?n.transition().duration(e).on("end",t):n},MO=n=>{const e=n.ctrlKey&&a5()?10:1;return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*e};function kne({zoomPanValues:n,noWheelClassName:e,d3Selection:t,d3Zoom:i,panOnScrollMode:s,panOnScrollSpeed:r,zoomOnPinch:a,onPanZoomStart:o,onPanZoom:l,onPanZoomEnd:c}){return h=>{if(Hf(h,e))return!1;h.preventDefault(),h.stopImmediatePropagation();const u=t.property("__zoom").k||1;if(h.ctrlKey&&a){const x=Cl(h),p=MO(h),y=u*Math.pow(2,p);i.scaleTo(t,y,x,h);return}const d=h.deltaMode===1?20:1;let f=s===tc.Vertical?0:h.deltaX*d,g=s===tc.Horizontal?0:h.deltaY*d;!a5()&&h.shiftKey&&s!==tc.Vertical&&(f=h.deltaY*d,g=0),i.translateBy(t,-(f/u)*r,-(g/u)*r,{internal:!0});const m=My(t.property("__zoom"));clearTimeout(n.panScrollTimeout),n.isPanScrolling||(n.isPanScrolling=!0,o==null||o(h,m)),n.isPanScrolling&&(l==null||l(h,m),n.panScrollTimeout=setTimeout(()=>{c==null||c(h,m),n.isPanScrolling=!1},150))}}function Cne({noWheelClassName:n,preventScrolling:e,d3ZoomHandler:t}){return function(i,s){if(!e&&i.type==="wheel"&&!i.ctrlKey||Hf(i,n))return null;i.preventDefault(),t.call(this,i,s)}}function Ane({zoomPanValues:n,onDraggingChange:e,onPanZoomStart:t}){return i=>{var r,a,o;if((r=i.sourceEvent)!=null&&r.internal)return;const s=My(i.transform);n.mouseButton=((a=i.sourceEvent)==null?void 0:a.button)||0,n.isZoomingOrPanning=!0,n.prevViewport=s,((o=i.sourceEvent)==null?void 0:o.type)==="mousedown"&&e(!0),t&&(t==null||t(i.sourceEvent,s))}}function Sne({zoomPanValues:n,panOnDrag:e,onPaneContextMenu:t,onTransformChange:i,onPanZoom:s}){return r=>{var a,o;n.usedRightMouseButton=!!(t&&RO(e,n.mouseButton??0)),(a=r.sourceEvent)!=null&&a.sync||i([r.transform.x,r.transform.y,r.transform.k]),s&&!((o=r.sourceEvent)!=null&&o.internal)&&(s==null||s(r.sourceEvent,My(r.transform)))}}function Ine({zoomPanValues:n,panOnDrag:e,panOnScroll:t,onDraggingChange:i,onPanZoomEnd:s,onPaneContextMenu:r}){return a=>{var o;if(!((o=a.sourceEvent)!=null&&o.internal)&&(n.isZoomingOrPanning=!1,r&&RO(e,n.mouseButton??0)&&!n.usedRightMouseButton&&a.sourceEvent&&r(a.sourceEvent),n.usedRightMouseButton=!1,i(!1),s&&_ne(n.prevViewport,a.transform))){const l=My(a.transform);n.prevViewport=l,clearTimeout(n.timerId),n.timerId=setTimeout(()=>{s==null||s(a.sourceEvent,l)},t?150:0)}}}function Ene({zoomActivationKeyPressed:n,zoomOnScroll:e,zoomOnPinch:t,panOnDrag:i,panOnScroll:s,zoomOnDoubleClick:r,userSelectionActive:a,noWheelClassName:o,noPanClassName:l,lib:c}){return h=>{var g;const u=n||e,d=t&&h.ctrlKey;if(h.button===1&&h.type==="mousedown"&&(Hf(h,`${c}-flow__node`)||Hf(h,`${c}-flow__edge`)))return!0;if(!i&&!u&&!s&&!r&&!t||a||Hf(h,o)&&h.type==="wheel"||Hf(h,l)&&(h.type!=="wheel"||s&&h.type==="wheel"&&!n)||!t&&h.ctrlKey&&h.type==="wheel")return!1;if(!t&&h.type==="touchstart"&&((g=h.touches)==null?void 0:g.length)>1)return h.preventDefault(),!1;if(!u&&!s&&!d&&h.type==="wheel"||!i&&(h.type==="mousedown"||h.type==="touchstart")||Array.isArray(i)&&!i.includes(h.button)&&h.type==="mousedown")return!1;const f=Array.isArray(i)&&i.includes(h.button)||!h.button||h.button<=1;return(!h.ctrlKey||h.type==="wheel")&&f}}function Tne({domNode:n,minZoom:e,maxZoom:t,paneClickDistance:i,translateExtent:s,viewport:r,onPanZoom:a,onPanZoomStart:o,onPanZoomEnd:l,onDraggingChange:c}){const h={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},u=n.getBoundingClientRect(),d=WL().clickDistance(!Zo(i)||i<0?0:i).scaleExtent([e,t]).translateExtent(s),f=Ko(n).call(d);w({x:r.x,y:r.y,zoom:Lg(r.zoom,e,t)},[[0,0],[u.width,u.height]],s);const g=f.on("wheel.zoom"),m=f.on("dblclick.zoom");d.wheelDelta(MO);function x(D,U){return f?new Promise(T=>{d==null||d.transform(Kw(f,U==null?void 0:U.duration,()=>T(!0)),D)}):Promise.resolve(!1)}function p({noWheelClassName:D,noPanClassName:U,onPaneContextMenu:T,userSelectionActive:G,panOnScroll:M,panOnDrag:F,panOnScrollMode:X,panOnScrollSpeed:z,preventScrolling:K,zoomOnPinch:j,zoomOnScroll:ae,zoomOnDoubleClick:ge,zoomActivationKeyPressed:ue,lib:pe,onTransformChange:de}){G&&!h.isZoomingOrPanning&&y();const Y=M&&!ue&&!G?kne({zoomPanValues:h,noWheelClassName:D,d3Selection:f,d3Zoom:d,panOnScrollMode:X,panOnScrollSpeed:z,zoomOnPinch:j,onPanZoomStart:o,onPanZoom:a,onPanZoomEnd:l}):Cne({noWheelClassName:D,preventScrolling:K,d3ZoomHandler:g});if(f.on("wheel.zoom",Y,{passive:!1}),!G){const $=Ane({zoomPanValues:h,onDraggingChange:c,onPanZoomStart:o});d.on("start",$);const re=Sne({zoomPanValues:h,panOnDrag:F,onPaneContextMenu:!!T,onPanZoom:a,onTransformChange:de});d.on("zoom",re);const oe=Ine({zoomPanValues:h,panOnDrag:F,panOnScroll:M,onPaneContextMenu:T,onPanZoomEnd:l,onDraggingChange:c});d.on("end",oe)}const le=Ene({zoomActivationKeyPressed:ue,panOnDrag:F,zoomOnScroll:ae,panOnScroll:M,zoomOnDoubleClick:ge,zoomOnPinch:j,userSelectionActive:G,noPanClassName:U,noWheelClassName:D,lib:pe});d.filter(le),ge?f.on("dblclick.zoom",m):f.on("dblclick.zoom",null)}function y(){d.on("zoom",null)}async function w(D,U,T){const G=Ww(D),M=d==null?void 0:d.constrain()(G,U,T);return M&&await x(M),new Promise(F=>F(M))}async function v(D,U){const T=Ww(D);return await x(T,U),new Promise(G=>G(T))}function _(D){if(f){const U=Ww(D),T=f.property("__zoom");(T.k!==D.zoom||T.x!==D.x||T.y!==D.y)&&(d==null||d.transform(f,U,null,{sync:!0}))}}function C(){const D=f?iD(f.node()):{x:0,y:0,k:1};return{x:D.x,y:D.y,zoom:D.k}}function k(D,U){return f?new Promise(T=>{d==null||d.scaleTo(Kw(f,U==null?void 0:U.duration,()=>T(!0)),D)}):Promise.resolve(!1)}function I(D,U){return f?new Promise(T=>{d==null||d.scaleBy(Kw(f,U==null?void 0:U.duration,()=>T(!0)),D)}):Promise.resolve(!1)}function S(D){d==null||d.scaleExtent(D)}function R(D){d==null||d.translateExtent(D)}function P(D){const U=!Zo(D)||D<0?0:D;d==null||d.clickDistance(U)}return{update:p,destroy:y,setViewport:v,setViewportConstrained:w,getViewport:C,scaleTo:k,scaleBy:I,setScaleExtent:S,setTranslateExtent:R,syncViewport:_,setClickDistance:P}}var gS;(function(n){n.Line="line",n.Handle="handle"})(gS||(gS={}));function Rne(n){let e,t,i,s,r,a;const o=n[45].default,l=zs(o,n,n[44],null);return{c(){e=ie("div"),l&&l.c(),this.h()},l(c){e=se(c,"DIV",{"data-handleid":!0,"data-nodeid":!0,"data-handlepos":!0,"data-id":!0,class:!0,style:!0,role:!0,tabindex:!0});var h=V(e);l&&l.l(h),h.forEach(E),this.h()},h(){A(e,"data-handleid",n[6]),A(e,"data-nodeid",n[14]),A(e,"data-handlepos",n[2]),A(e,"data-id",t=n[13]+"-"+n[14]+"-"+(n[0]||null)+"-"+n[1]),A(e,"class",i=Ii(["svelte-flow__handle",`svelte-flow__handle-${n[2]}`,"nodrag","nopan",n[2],n[4]])),A(e,"style",n[3]),A(e,"role","button"),A(e,"tabindex","-1"),mn(e,"valid",n[7]),mn(e,"connectingto",n[5]),mn(e,"connectingfrom",n[9]),mn(e,"source",!n[11]),mn(e,"target",n[11]),mn(e,"connectablestart",n[12]),mn(e,"connectableend",n[12]),mn(e,"connectable",n[12]),mn(e,"connectionindicator",n[12]&&(!n[10]||n[8]))},m(c,h){te(c,e,h),l&&l.m(e,null),s=!0,r||(a=[xt(e,"mousedown",n[32]),xt(e,"touchstart",n[32])],r=!0)},p(c,h){l&&l.p&&(!s||h[1]&8192)&&js(l,o,c,c[44],s?Vs(o,c[44],h,null):Gs(c[44]),null),(!s||h[0]&64)&&A(e,"data-handleid",c[6]),(!s||h[0]&4)&&A(e,"data-handlepos",c[2]),(!s||h[0]&8195&&t!==(t=c[13]+"-"+c[14]+"-"+(c[0]||null)+"-"+c[1]))&&A(e,"data-id",t),(!s||h[0]&20&&i!==(i=Ii(["svelte-flow__handle",`svelte-flow__handle-${c[2]}`,"nodrag","nopan",c[2],c[4]])))&&A(e,"class",i),(!s||h[0]&8)&&A(e,"style",c[3]),(!s||h[0]&148)&&mn(e,"valid",c[7]),(!s||h[0]&52)&&mn(e,"connectingto",c[5]),(!s||h[0]&532)&&mn(e,"connectingfrom",c[9]),(!s||h[0]&2068)&&mn(e,"source",!c[11]),(!s||h[0]&2068)&&mn(e,"target",c[11]),(!s||h[0]&4116)&&mn(e,"connectablestart",c[12]),(!s||h[0]&4116)&&mn(e,"connectableend",c[12]),(!s||h[0]&4116)&&mn(e,"connectable",c[12]),(!s||h[0]&5396)&&mn(e,"connectionindicator",c[12]&&(!c[10]||c[8]))},i(c){s||(H(l,c),s=!0)},o(c){q(l,c),s=!1},d(c){c&&E(e),l&&l.d(c),r=!1,Zr(a)}}}function Mne(n,e,t){let i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,v,_,C,k,I,S,R,P,{$$slots:D={},$$scope:U}=e,{id:T=void 0}=e,{type:G="source"}=e,{position:M=pn.Top}=e,{style:F=void 0}=e,{isValidConnection:X=void 0}=e,{onconnect:z=void 0}=e,{ondisconnect:K=void 0}=e,{isConnectable:j=void 0}=e,{class:ae=void 0}=e;const ge=qs("svelteflow__node_id"),ue=qs("svelteflow__node_connectable");Oe(n,ue,Ve=>t(43,P=Ve));const pe=es(),{connectionMode:de,domNode:O,nodeLookup:Y,connectionRadius:le,viewport:$,isValidConnection:re,lib:oe,addEdge:ee,onedgecreate:Q,panBy:je,cancelConnection:Re,updateConnection:Ne,autoPanOnConnect:He,edges:Be,connectionLookup:Je,onconnect:ht,onconnectstart:ot,onconnectend:Ye,flowId:rt,connection:me}=pe;Oe(n,de,Ve=>t(40,d=Ve)),Oe(n,O,Ve=>t(55,S=Ve)),Oe(n,Y,Ve=>t(54,I=Ve)),Oe(n,le,Ve=>t(56,R=Ve)),Oe(n,$,Ve=>t(46,m=Ve)),Oe(n,re,Ve=>t(51,v=Ve)),Oe(n,oe,Ve=>t(53,k=Ve)),Oe(n,Q,Ve=>t(50,w=Ve)),Oe(n,He,Ve=>t(52,C=Ve)),Oe(n,Be,Ve=>t(42,g=Ve)),Oe(n,Je,Ve=>t(41,f=Ve)),Oe(n,ht,Ve=>t(49,y=Ve)),Oe(n,ot,Ve=>t(48,p=Ve)),Oe(n,Ye,Ve=>t(47,x=Ve)),Oe(n,rt,Ve=>t(13,_=Ve)),Oe(n,me,Ve=>t(39,u=Ve));function Mt(Ve){const Ot=mO(Ve);(Ot&&Ve.button===0||!Ot)&&vne.onPointerDown(Ve,{handleId:r,nodeId:ge,isTarget:i,connectionRadius:R,domNode:S,nodeLookup:I,connectionMode:d,lib:k,autoPanOnConnect:C,flowId:_,isValidConnection:X??v,updateConnection:Ne,cancelConnection:Re,panBy:je,onConnect:rn=>{const Me=w?w(rn):rn;Me&&(ee(Me),y==null||y(rn))},onConnectStart:(rn,Me)=>{p==null||p(rn,{nodeId:Me.nodeId,handleId:Me.handleId,handleType:Me.handleType})},onConnectEnd:(rn,Me)=>{x==null||x(rn,Me)},getTransform:()=>[m.x,m.y,m.zoom],getFromHandle:()=>u.fromHandle})}let ut=null,dt;return n.$$set=Ve=>{"id"in Ve&&t(0,T=Ve.id),"type"in Ve&&t(1,G=Ve.type),"position"in Ve&&t(2,M=Ve.position),"style"in Ve&&t(3,F=Ve.style),"isValidConnection"in Ve&&t(33,X=Ve.isValidConnection),"onconnect"in Ve&&t(34,z=Ve.onconnect),"ondisconnect"in Ve&&t(35,K=Ve.ondisconnect),"isConnectable"in Ve&&t(36,j=Ve.isConnectable),"class"in Ve&&t(4,ae=Ve.class),"$$scope"in Ve&&t(44,U=Ve.$$scope)},n.$$.update=()=>{var Ve,Ot,rn,Me,Dt,gt,jt,Fn,Kn;if(n.$$.dirty[0]&2&&t(11,i=G==="target"),n.$$.dirty[1]&4128&&t(12,s=j!==void 0?j:P),n.$$.dirty[0]&1&&t(6,r=T||null),n.$$.dirty[0]&3|n.$$.dirty[1]&3096&&(z||K)&&t(38,dt=f.get(`${ge}-${G}-${T||null}`)),n.$$.dirty[1]&216){if(ut&&!Hte(dt,ut)){const ci=dt??new Map;$A(ut,ci,K),$A(ci,ut,z)}t(37,ut=dt??new Map)}n.$$.dirty[1]&256&&t(10,a=!!u.fromHandle),n.$$.dirty[0]&66|n.$$.dirty[1]&256&&t(9,o=((Ve=u.fromHandle)==null?void 0:Ve.nodeId)===ge&&((Ot=u.fromHandle)==null?void 0:Ot.type)===G&&((rn=u.fromHandle)==null?void 0:rn.id)===r),n.$$.dirty[0]&66|n.$$.dirty[1]&256&&t(5,l=((Me=u.toHandle)==null?void 0:Me.nodeId)===ge&&((Dt=u.toHandle)==null?void 0:Dt.type)===G&&((gt=u.toHandle)==null?void 0:gt.id)===r),n.$$.dirty[0]&66|n.$$.dirty[1]&768&&t(8,c=d===ef.Strict?((jt=u.fromHandle)==null?void 0:jt.type)!==G:ge!==((Fn=u.fromHandle)==null?void 0:Fn.nodeId)||r!==((Kn=u.fromHandle)==null?void 0:Kn.id)),n.$$.dirty[0]&32|n.$$.dirty[1]&256&&t(7,h=l&&u.isValid)},[T,G,M,F,ae,l,r,h,c,o,a,i,s,_,ge,ue,de,O,Y,le,$,re,oe,Q,He,Be,Je,ht,ot,Ye,rt,me,Mt,X,z,K,j,ut,dt,u,d,f,g,P,U,D]}class Ug extends Ht{constructor(e){super(),zt(this,e,Mne,Rne,qt,{id:0,type:1,position:2,style:3,isValidConnection:33,onconnect:34,ondisconnect:35,isConnectable:36,class:4},null,[-1,-1])}}function Pne(n){var l;let e,t,i=((l=n[0])==null?void 0:l.label)+"",s,r,a,o;return e=new Ug({props:{type:"target",position:n[1]??pn.Top}}),a=new Ug({props:{type:"source",position:n[2]??pn.Bottom}}),{c(){be(e.$$.fragment),t=Se(),s=At(i),r=Se(),be(a.$$.fragment)},l(c){ve(e.$$.fragment,c),t=Ie(c),s=St(c,i),r=Ie(c),ve(a.$$.fragment,c)},m(c,h){xe(e,c,h),te(c,t,h),te(c,s,h),te(c,r,h),xe(a,c,h),o=!0},p(c,[h]){var f;const u={};h&2&&(u.position=c[1]??pn.Top),e.$set(u),(!o||h&1)&&i!==(i=((f=c[0])==null?void 0:f.label)+"")&&Pt(s,i);const d={};h&4&&(d.position=c[2]??pn.Bottom),a.$set(d)},i(c){o||(H(e.$$.fragment,c),H(a.$$.fragment,c),o=!0)},o(c){q(e.$$.fragment,c),q(a.$$.fragment,c),o=!1},d(c){c&&(E(t),E(s),E(r)),ye(e,c),ye(a,c)}}}function Nne(n,e,t){const i=["data","targetPosition","sourcePosition"];Qi(e,i);let{data:s={label:"Node"}}=e,{targetPosition:r=void 0}=e,{sourcePosition:a=void 0}=e;return n.$$set=o=>{e=ai(ai({},e),ll(o)),t(3,Qi(e,i)),"data"in o&&t(0,s=o.data),"targetPosition"in o&&t(1,r=o.targetPosition),"sourcePosition"in o&&t(2,a=o.sourcePosition)},[s,r,a]}class PO extends Ht{constructor(e){super(),zt(this,e,Nne,Pne,qt,{data:0,targetPosition:1,sourcePosition:2})}}function One(n){var a;let e=((a=n[0])==null?void 0:a.label)+"",t,i,s,r;return s=new Ug({props:{type:"source",position:n[1]??pn.Bottom}}),{c(){t=At(e),i=Se(),be(s.$$.fragment)},l(o){t=St(o,e),i=Ie(o),ve(s.$$.fragment,o)},m(o,l){te(o,t,l),te(o,i,l),xe(s,o,l),r=!0},p(o,[l]){var h;(!r||l&1)&&e!==(e=((h=o[0])==null?void 0:h.label)+"")&&Pt(t,e);const c={};l&2&&(c.position=o[1]??pn.Bottom),s.$set(c)},i(o){r||(H(s.$$.fragment,o),r=!0)},o(o){q(s.$$.fragment,o),r=!1},d(o){o&&(E(t),E(i)),ye(s,o)}}}function Dne(n,e,t){const i=["data","sourcePosition"];Qi(e,i);let{data:s={label:"Node"}}=e,{sourcePosition:r=void 0}=e;return n.$$set=a=>{e=ai(ai({},e),ll(a)),t(2,Qi(e,i)),"data"in a&&t(0,s=a.data),"sourcePosition"in a&&t(1,r=a.sourcePosition)},[s,r]}class Lne extends Ht{constructor(e){super(),zt(this,e,Dne,One,qt,{data:0,sourcePosition:1})}}function Fne(n){var a;let e=((a=n[0])==null?void 0:a.label)+"",t,i,s,r;return s=new Ug({props:{type:"target",position:n[1]??pn.Top}}),{c(){t=At(e),i=Se(),be(s.$$.fragment)},l(o){t=St(o,e),i=Ie(o),ve(s.$$.fragment,o)},m(o,l){te(o,t,l),te(o,i,l),xe(s,o,l),r=!0},p(o,[l]){var h;(!r||l&1)&&e!==(e=((h=o[0])==null?void 0:h.label)+"")&&Pt(t,e);const c={};l&2&&(c.position=o[1]??pn.Top),s.$set(c)},i(o){r||(H(s.$$.fragment,o),r=!0)},o(o){q(s.$$.fragment,o),r=!1},d(o){o&&(E(t),E(i)),ye(s,o)}}}function Bne(n,e,t){const i=["data","targetPosition"];Qi(e,i);let{data:s={label:"Node"}}=e,{targetPosition:r=void 0}=e;return n.$$set=a=>{e=ai(ai({},e),ll(a)),t(2,Qi(e,i)),"data"in a&&t(0,s=a.data),"targetPosition"in a&&t(1,r=a.targetPosition)},[s,r]}class Une extends Ht{constructor(e){super(),zt(this,e,Bne,Fne,qt,{data:0,targetPosition:1})}}function Hne(n,e,t){const i=[];return Qi(e,i),n.$$set=s=>{e=ai(ai({},e),ll(s)),t(0,Qi(e,i))},[]}class zne extends Ht{constructor(e){super(),zt(this,e,Hne,null,qt,{})}}function mS(n,e,t){if(!e)return;const i=t?e.querySelector(t):e;i&&i.appendChild(n)}function jne(n,{target:e,domNode:t}){return mS(n,t,e),{async update({target:i,domNode:s}){mS(n,s,i)},destroy(){n.parentNode&&n.parentNode.removeChild(n)}}}function Gne(n){let e,t,i,s,r;const a=n[3].default,o=zs(a,n,n[2],null);return{c(){e=ie("div"),o&&o.c()},l(l){e=se(l,"DIV",{});var c=V(e);o&&o.l(c),c.forEach(E)},m(l,c){te(l,e,c),o&&o.m(e,null),i=!0,s||(r=ra(t=jne.call(null,e,{target:".svelte-flow__edgelabel-renderer",domNode:n[0]})),s=!0)},p(l,[c]){o&&o.p&&(!i||c&4)&&js(o,a,l,l[2],i?Vs(a,l[2],c,null):Gs(l[2]),null),t&&Ds(t.update)&&c&1&&t.update.call(null,{target:".svelte-flow__edgelabel-renderer",domNode:l[0]})},i(l){i||(H(o,l),i=!0)},o(l){q(o,l),i=!1},d(l){l&&E(e),o&&o.d(l),s=!1,r()}}}function Vne(n,e,t){let i,{$$slots:s={},$$scope:r}=e;const{domNode:a}=es();return Oe(n,a,o=>t(0,i=o)),n.$$set=o=>{"$$scope"in o&&t(2,r=o.$$scope)},[i,a,r,s]}class qne extends Ht{constructor(e){super(),zt(this,e,Vne,Gne,qt,{})}}function NO(){const{edgeLookup:n,selectionRect:e,selectionRectMode:t,multiselectionKeyPressed:i,addSelectedEdges:s,unselectNodesAndEdges:r,elementsSelectable:a}=es();return o=>{const l=Qe(n).get(o);if(!l){console.warn("012",vx.error012(o));return}(l.selectable||Qe(a)&&typeof l.selectable>"u")&&(e.set(null),t.set(null),l.selected?l.selected&&Qe(i)&&r({nodes:[],edges:[l]}):s([o]))}}function Wne(n){let e,t,i=`translate(-50%, -50%) translate(${n[1]}px,${n[2]}px)`,s,r,a;const o=n[5].default,l=zs(o,n,n[7],null);return{c(){e=ie("div"),l&&l.c(),this.h()},l(c){e=se(c,"DIV",{class:!0,style:!0,role:!0,tabindex:!0});var h=V(e);l&&l.l(h),h.forEach(E),this.h()},h(){A(e,"class","svelte-flow__edge-label"),A(e,"style",t="pointer-events: all;"+n[0]),A(e,"role","button"),A(e,"tabindex","-1"),tn(e,"transform",i)},m(c,h){te(c,e,h),l&&l.m(e,null),s=!0,r||(a=[xt(e,"keyup",Xne),xt(e,"click",n[6])],r=!0)},p(c,h){l&&l.p&&(!s||h&128)&&js(l,o,c,c[7],s?Vs(o,c[7],h,null):Gs(c[7]),null),(!s||h&1&&t!==(t="pointer-events: all;"+c[0]))&&A(e,"style",t);const u=h&1;(h&7&&i!==(i=`translate(-50%, -50%) translate(${c[1]}px,${c[2]}px)`)||u)&&tn(e,"transform",i)},i(c){s||(H(l,c),s=!0)},o(c){q(l,c),s=!1},d(c){c&&E(e),l&&l.d(c),r=!1,Zr(a)}}}function Kne(n){let e,t;return e=new qne({props:{$$slots:{default:[Wne]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,[s]){const r={};s&135&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}const Xne=()=>{};function Yne(n,e,t){let{$$slots:i={},$$scope:s}=e,{style:r=void 0}=e,{x:a=void 0}=e,{y:o=void 0}=e;const l=NO(),c=qs("svelteflow__edge_id"),h=()=>{c&&l(c)};return n.$$set=u=>{"style"in u&&t(0,r=u.style),"x"in u&&t(1,a=u.x),"y"in u&&t(2,o=u.y),"$$scope"in u&&t(7,s=u.$$scope)},[r,a,o,l,c,i,h,s]}class Jne extends Ht{constructor(e){super(),zt(this,e,Yne,Kne,qt,{style:0,x:1,y:2})}}function Zne(n){let e;return{c(){e=lt("path"),this.h()},l(t){e=ct(t,"path",{d:!0,"stroke-opacity":!0,"stroke-width":!0,fill:!0,class:!0}),V(e).forEach(E),this.h()},h(){A(e,"d",n[1]),A(e,"stroke-opacity",0),A(e,"stroke-width",n[10]),A(e,"fill","none"),A(e,"class","svelte-flow__edge-interaction")},m(t,i){te(t,e,i)},p(t,i){i&2&&A(e,"d",t[1])},d(t){t&&E(e)}}}function pS(n){let e,t;return e=new Jne({props:{x:n[3],y:n[4],style:n[5],$$slots:{default:[Qne]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s&8&&(r.x=i[3]),s&16&&(r.y=i[4]),s&32&&(r.style=i[5]),s&4100&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Qne(n){let e;return{c(){e=At(n[2])},l(t){e=St(t,n[2])},m(t,i){te(t,e,i)},p(t,i){i&4&&Pt(e,t[2])},d(t){t&&E(e)}}}function $ne(n){let e,t,i,s,r,a,o=n[10]&&Zne(n),l=n[2]&&pS(n);return{c(){e=lt("path"),i=Se(),o&&o.c(),s=Se(),l&&l.c(),r=Xt(),this.h()},l(c){e=ct(c,"path",{id:!0,d:!0,class:!0,"marker-start":!0,"marker-end":!0,fill:!0,style:!0}),V(e).forEach(E),i=Ie(c),o&&o.l(c),s=Ie(c),l&&l.l(c),r=Xt(),this.h()},h(){A(e,"id",n[0]),A(e,"d",n[1]),A(e,"class",t=Ii(["svelte-flow__edge-path",n[9]])),A(e,"marker-start",n[6]),A(e,"marker-end",n[7]),A(e,"fill","none"),A(e,"style",n[8])},m(c,h){te(c,e,h),te(c,i,h),o&&o.m(c,h),te(c,s,h),l&&l.m(c,h),te(c,r,h),a=!0},p(c,[h]){(!a||h&1)&&A(e,"id",c[0]),(!a||h&2)&&A(e,"d",c[1]),(!a||h&512&&t!==(t=Ii(["svelte-flow__edge-path",c[9]])))&&A(e,"class",t),(!a||h&64)&&A(e,"marker-start",c[6]),(!a||h&128)&&A(e,"marker-end",c[7]),(!a||h&256)&&A(e,"style",c[8]),c[10]&&o.p(c,h),c[2]?l?(l.p(c,h),h&4&&H(l,1)):(l=pS(c),l.c(),H(l,1),l.m(r.parentNode,r)):l&&(yt(),q(l,1,1,()=>{l=null}),wt())},i(c){a||(H(l),a=!0)},o(c){q(l),a=!1},d(c){c&&(E(e),E(i),E(s),E(r)),o&&o.d(c),l&&l.d(c)}}}function eie(n,e,t){let{id:i=void 0}=e,{path:s}=e,{label:r=void 0}=e,{labelX:a=void 0}=e,{labelY:o=void 0}=e,{labelStyle:l=void 0}=e,{markerStart:c=void 0}=e,{markerEnd:h=void 0}=e,{style:u=void 0}=e,{interactionWidth:d=20}=e,{class:f=void 0}=e,g=d===void 0?20:d;return n.$$set=m=>{"id"in m&&t(0,i=m.id),"path"in m&&t(1,s=m.path),"label"in m&&t(2,r=m.label),"labelX"in m&&t(3,a=m.labelX),"labelY"in m&&t(4,o=m.labelY),"labelStyle"in m&&t(5,l=m.labelStyle),"markerStart"in m&&t(6,c=m.markerStart),"markerEnd"in m&&t(7,h=m.markerEnd),"style"in m&&t(8,u=m.style),"interactionWidth"in m&&t(11,d=m.interactionWidth),"class"in m&&t(9,f=m.class)},[i,s,r,a,o,l,c,h,u,f,g,d]}class Py extends Ht{constructor(e){super(),zt(this,e,eie,$ne,qt,{id:0,path:1,label:2,labelX:3,labelY:4,labelStyle:5,markerStart:6,markerEnd:7,style:8,interactionWidth:11,class:9})}}function tie(n){let e,t;return e=new Py({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,[s]){const r={};s&256&&(r.path=i[8]),s&128&&(r.labelX=i[7]),s&64&&(r.labelY=i[6]),s&1&&(r.label=i[0]),s&2&&(r.labelStyle=i[1]),s&8&&(r.markerStart=i[3]),s&16&&(r.markerEnd=i[4]),s&32&&(r.interactionWidth=i[5]),s&4&&(r.style=i[2]),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function nie(n,e,t){let i,s,r;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];Qi(e,a);let{label:o=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:h=void 0}=e,{markerEnd:u=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:f}=e,{sourceY:g}=e,{sourcePosition:m}=e,{targetX:x}=e,{targetY:p}=e,{targetPosition:y}=e;return n.$$set=w=>{e=ai(ai({},e),ll(w)),t(15,Qi(e,a)),"label"in w&&t(0,o=w.label),"labelStyle"in w&&t(1,l=w.labelStyle),"style"in w&&t(2,c=w.style),"markerStart"in w&&t(3,h=w.markerStart),"markerEnd"in w&&t(4,u=w.markerEnd),"interactionWidth"in w&&t(5,d=w.interactionWidth),"sourceX"in w&&t(9,f=w.sourceX),"sourceY"in w&&t(10,g=w.sourceY),"sourcePosition"in w&&t(11,m=w.sourcePosition),"targetX"in w&&t(12,x=w.targetX),"targetY"in w&&t(13,p=w.targetY),"targetPosition"in w&&t(14,y=w.targetPosition)},n.$$.update=()=>{n.$$.dirty&32256&&t(8,[i,s,r]=pO({sourceX:f,sourceY:g,targetX:x,targetY:p,sourcePosition:m,targetPosition:y}),i,(t(7,s),t(9,f),t(10,g),t(12,x),t(13,p),t(11,m),t(14,y)),(t(6,r),t(9,f),t(10,g),t(12,x),t(13,p),t(11,m),t(14,y)))},[o,l,c,h,u,d,r,s,i,f,g,m,x,p,y]}class OO extends Ht{constructor(e){super(),zt(this,e,nie,tie,qt,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function iie(n){let e,t;return e=new Py({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,[s]){const r={};s&256&&(r.path=i[8]),s&128&&(r.labelX=i[7]),s&64&&(r.labelY=i[6]),s&1&&(r.label=i[0]),s&2&&(r.labelStyle=i[1]),s&8&&(r.markerStart=i[3]),s&16&&(r.markerEnd=i[4]),s&32&&(r.interactionWidth=i[5]),s&4&&(r.style=i[2]),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function sie(n,e,t){let i,s,r;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];Qi(e,a);let{label:o=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:h=void 0}=e,{markerEnd:u=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:f}=e,{sourceY:g}=e,{sourcePosition:m}=e,{targetX:x}=e,{targetY:p}=e,{targetPosition:y}=e;return n.$$set=w=>{e=ai(ai({},e),ll(w)),t(15,Qi(e,a)),"label"in w&&t(0,o=w.label),"labelStyle"in w&&t(1,l=w.labelStyle),"style"in w&&t(2,c=w.style),"markerStart"in w&&t(3,h=w.markerStart),"markerEnd"in w&&t(4,u=w.markerEnd),"interactionWidth"in w&&t(5,d=w.interactionWidth),"sourceX"in w&&t(9,f=w.sourceX),"sourceY"in w&&t(10,g=w.sourceY),"sourcePosition"in w&&t(11,m=w.sourcePosition),"targetX"in w&&t(12,x=w.targetX),"targetY"in w&&t(13,p=w.targetY),"targetPosition"in w&&t(14,y=w.targetPosition)},n.$$.update=()=>{n.$$.dirty&32256&&t(8,[i,s,r]=o5({sourceX:f,sourceY:g,targetX:x,targetY:p,sourcePosition:m,targetPosition:y}),i,(t(7,s),t(9,f),t(10,g),t(12,x),t(13,p),t(11,m),t(14,y)),(t(6,r),t(9,f),t(10,g),t(12,x),t(13,p),t(11,m),t(14,y)))},[o,l,c,h,u,d,r,s,i,f,g,m,x,p,y]}class rie extends Ht{constructor(e){super(),zt(this,e,sie,iie,qt,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function aie(n){let e,t;return e=new Py({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,[s]){const r={};s&256&&(r.path=i[8]),s&128&&(r.labelX=i[7]),s&64&&(r.labelY=i[6]),s&1&&(r.label=i[0]),s&2&&(r.labelStyle=i[1]),s&8&&(r.markerStart=i[3]),s&16&&(r.markerEnd=i[4]),s&32&&(r.interactionWidth=i[5]),s&4&&(r.style=i[2]),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function oie(n,e,t){let i,s,r;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","targetX","targetY"];Qi(e,a);let{label:o=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:h=void 0}=e,{markerEnd:u=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:f}=e,{sourceY:g}=e,{targetX:m}=e,{targetY:x}=e;return n.$$set=p=>{e=ai(ai({},e),ll(p)),t(13,Qi(e,a)),"label"in p&&t(0,o=p.label),"labelStyle"in p&&t(1,l=p.labelStyle),"style"in p&&t(2,c=p.style),"markerStart"in p&&t(3,h=p.markerStart),"markerEnd"in p&&t(4,u=p.markerEnd),"interactionWidth"in p&&t(5,d=p.interactionWidth),"sourceX"in p&&t(9,f=p.sourceX),"sourceY"in p&&t(10,g=p.sourceY),"targetX"in p&&t(11,m=p.targetX),"targetY"in p&&t(12,x=p.targetY)},n.$$.update=()=>{n.$$.dirty&7680&&t(8,[i,s,r]=xO({sourceX:f,sourceY:g,targetX:m,targetY:x}),i,(t(7,s),t(9,f),t(10,g),t(11,m),t(12,x)),(t(6,r),t(9,f),t(10,g),t(11,m),t(12,x)))},[o,l,c,h,u,d,r,s,i,f,g,m,x]}class lie extends Ht{constructor(e){super(),zt(this,e,oie,aie,qt,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,targetX:11,targetY:12})}}function cie(n){let e,t;return e=new Py({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,[s]){const r={};s&256&&(r.path=i[8]),s&128&&(r.labelX=i[7]),s&64&&(r.labelY=i[6]),s&1&&(r.label=i[0]),s&2&&(r.labelStyle=i[1]),s&8&&(r.markerStart=i[3]),s&16&&(r.markerEnd=i[4]),s&32&&(r.interactionWidth=i[5]),s&4&&(r.style=i[2]),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function hie(n,e,t){let i,s,r;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];Qi(e,a);let{label:o=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:h=void 0}=e,{markerEnd:u=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:f}=e,{sourceY:g}=e,{sourcePosition:m}=e,{targetX:x}=e,{targetY:p}=e,{targetPosition:y}=e;return n.$$set=w=>{e=ai(ai({},e),ll(w)),t(15,Qi(e,a)),"label"in w&&t(0,o=w.label),"labelStyle"in w&&t(1,l=w.labelStyle),"style"in w&&t(2,c=w.style),"markerStart"in w&&t(3,h=w.markerStart),"markerEnd"in w&&t(4,u=w.markerEnd),"interactionWidth"in w&&t(5,d=w.interactionWidth),"sourceX"in w&&t(9,f=w.sourceX),"sourceY"in w&&t(10,g=w.sourceY),"sourcePosition"in w&&t(11,m=w.sourcePosition),"targetX"in w&&t(12,x=w.targetX),"targetY"in w&&t(13,p=w.targetY),"targetPosition"in w&&t(14,y=w.targetPosition)},n.$$.update=()=>{n.$$.dirty&32256&&t(8,[i,s,r]=o5({sourceX:f,sourceY:g,targetX:x,targetY:p,sourcePosition:m,targetPosition:y,borderRadius:0}),i,(t(7,s),t(9,f),t(10,g),t(12,x),t(13,p),t(11,m),t(14,y)),(t(6,r),t(9,f),t(10,g),t(12,x),t(13,p),t(11,m),t(14,y)))},[o,l,c,h,u,d,r,s,i,f,g,m,x,p,y]}class uie extends Ht{constructor(e){super(),zt(this,e,hie,cie,qt,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function die(n,e){const t=n.set,i=e.set,s=Qe(n),r=Qe(e);let o=s.length===0&&r.length>0?r:s;n.set(o);const l=c=>{const h=t(c);return o=h,i(o),h};n.set=e.set=l,n.update=e.update=c=>l(c(o))}function fie(n,e){const t=n.set,i=e.set;let s=Qe(e);n.set(s);const r=a=>{t(a),i(a),s=a};n.set=e.set=r,n.update=e.update=a=>r(a(s))}const gie=(n,e,t)=>{if(!t)return;const i=Qe(n),s=e.set,r=t.set;let a=t?Qe(t):{x:0,y:0,zoom:1};e.set(a),e.set=o=>(s(o),r(o),a=o,o),t.set=o=>(i==null||i.syncViewport(o),s(o),r(o),a=o,o),e.update=o=>{e.set(o(a))},t.update=o=>{t.set(o(a))}},mie=(n,e,t,i=[0,0],s=n5)=>{const{subscribe:r,set:a,update:o}=$t([]);let l=n,c={},h=!0;const u=m=>(vO(m,e,t,{elevateNodesOnSelect:h,nodeOrigin:i,nodeExtent:s,defaults:c,checkEquality:!1}),l=m,a(l),l),d=m=>u(m(l)),f=m=>{c=m},g=m=>{h=m.elevateNodesOnSelect??h};return u(l),{subscribe:r,set:u,update:d,setDefaultOptions:f,setOptions:g}},pie=(n,e,t,i)=>{const{subscribe:s,set:r,update:a}=$t([]);let o=n,l={};const c=d=>{const f=l?d.map(g=>({...l,...g})):d;CO(e,t,f),o=f,r(o)},h=d=>c(d(o)),u=d=>{l=d};return c(o),{subscribe:s,set:c,update:h,setDefaultOptions:u}},DO={input:Lne,output:Une,default:PO,group:zne},LO={straight:lie,smoothstep:rie,default:OO,step:uie},bie=({nodes:n=[],edges:e=[],width:t,height:i,fitView:s,nodeOrigin:r,nodeExtent:a})=>{const o=new Map,l=new Map,c=new Map,h=new Map,u=r??[0,0],d=a??n5;vO(n,o,l,{nodeExtent:d,nodeOrigin:u,elevateNodesOnSelect:!1,checkEquality:!1}),CO(c,h,e);let f={x:0,y:0,zoom:1};if(s&&t&&i){const g=Ey(o,{filter:m=>!!((m.width||m.initialWidth)&&(m.height||m.initialHeight))});f=Bv(g,t,i,.5,2,.1)}return{flowId:$t(null),nodes:mie(n,o,l,u,d),nodeLookup:Io(o),parentLookup:Io(l),edgeLookup:Io(h),visibleNodes:Io([]),edges:pie(e,c,h),visibleEdges:Io([]),connectionLookup:Io(c),height:$t(500),width:$t(500),minZoom:$t(.5),maxZoom:$t(2),nodeOrigin:$t(u),nodeDragThreshold:$t(1),nodeExtent:$t(d),translateExtent:$t(n5),autoPanOnNodeDrag:$t(!0),autoPanOnConnect:$t(!0),fitViewOnInit:$t(!1),fitViewOnInitDone:$t(!1),fitViewOptions:$t(void 0),panZoom:$t(null),snapGrid:$t(null),dragging:$t(!1),selectionRect:$t(null),selectionKeyPressed:$t(!1),multiselectionKeyPressed:$t(!1),deleteKeyPressed:$t(!1),panActivationKeyPressed:$t(!1),zoomActivationKeyPressed:$t(!1),selectionRectMode:$t(null),selectionMode:$t(i5.Partial),nodeTypes:$t(DO),edgeTypes:$t(LO),viewport:$t(f),connectionMode:$t(ef.Strict),domNode:$t(null),connection:Io(q6),connectionLineType:$t(r1.Bezier),connectionRadius:$t(20),isValidConnection:$t(()=>!0),nodesDraggable:$t(!0),nodesConnectable:$t(!0),elementsSelectable:$t(!0),selectNodesOnDrag:$t(!0),markers:Io([]),defaultMarkerColor:$t("#b1b1b7"),lib:Io("svelte"),onlyRenderVisibleElements:$t(!1),onerror:$t(Wte),ondelete:$t(void 0),onedgecreate:$t(void 0),onconnect:$t(void 0),onconnectstart:$t(void 0),onconnectend:$t(void 0),onbeforedelete:$t(void 0),nodesInitialized:$t(!1),edgesInitialized:$t(!1),viewportInitialized:$t(!1),initialized:Io(!1)}};function xie(n){const e=Kf([n.edges,n.nodes,n.nodeLookup,n.onlyRenderVisibleElements,n.viewport,n.width,n.height],([t,,i,s,r,a,o])=>s&&a&&o?t.filter(c=>{const h=i.get(c.source),u=i.get(c.target);return h&&u&&$te({sourceNode:h,targetNode:u,width:a,height:o,transform:[r.x,r.y,r.zoom]})}):t);return Kf([e,n.nodes,n.nodeLookup,n.connectionMode,n.onerror],([t,,i,s,r])=>t.reduce((o,l)=>{const c=i.get(l.source),h=i.get(l.target);if(!c||!h)return o;const u=ane({id:l.id,sourceNode:c,targetNode:h,sourceHandle:l.sourceHandle||null,targetHandle:l.targetHandle||null,connectionMode:s,onError:r});return u&&o.push({...l,zIndex:Qte({selected:l.selected,zIndex:l.zIndex,sourceNode:c,targetNode:h,elevateOnSelect:!1}),...u}),o},[]))}function yie(n){return Kf([n.nodeLookup,n.onlyRenderVisibleElements,n.width,n.height,n.viewport,n.nodes],([e,t,i,s,r])=>{const a=[r.x,r.y,r.zoom];return t?cO(e,{x:0,y:0,width:i,height:s},a,!0):Array.from(e.values())})}const Ny=Symbol();function FO({nodes:n,edges:e,width:t,height:i,fitView:s,nodeOrigin:r,nodeExtent:a}){const o=bie({nodes:n,edges:e,width:t,height:i,fitView:s,nodeOrigin:r,nodeExtent:a});function l(M){o.nodeTypes.set({...DO,...M})}function c(M){o.edgeTypes.set({...LO,...M})}function h(M){const F=Qe(o.edges);o.edges.set(nne(M,F))}const u=(M,F=!1)=>{var z;const X=Qe(o.nodeLookup);for(const[K,j]of M){const ae=(z=X.get(K))==null?void 0:z.internals.userNode;ae&&(ae.position=j.position,ae.dragging=F)}o.nodes.update(K=>K)};function d(M){var K,j,ae;const F=Qe(o.nodeLookup),{changes:X,updatedInternals:z}=dne(M,F,Qe(o.parentLookup),Qe(o.domNode),Qe(o.nodeOrigin));if(z){if(!Qe(o.fitViewOnInitDone)&&Qe(o.fitViewOnInit)){const ge=Qe(o.fitViewOptions),ue=g({...ge,nodes:ge==null?void 0:ge.nodes});o.fitViewOnInitDone.set(ue)}for(const ge of X){const ue=(K=F.get(ge.id))==null?void 0:K.internals.userNode;if(ue)switch(ge.type){case"dimensions":{const pe={...ue.measured,...ge.dimensions};ge.setAttributes&&(ue.width=((j=ge.dimensions)==null?void 0:j.width)??ue.width,ue.height=((ae=ge.dimensions)==null?void 0:ae.height)??ue.height),ue.measured=pe;break}case"position":ue.position=ge.position??ue.position;break}}o.nodes.update(ge=>ge),Qe(o.nodesInitialized)||o.nodesInitialized.set(!0)}}function f(M){const F=Qe(o.panZoom);if(!F)return Promise.resolve(!1);const X=tS(Qe(o.nodeLookup),M);return nS({nodes:X,width:Qe(o.width),height:Qe(o.height),minZoom:Qe(o.minZoom),maxZoom:Qe(o.maxZoom),panZoom:F},M)}function g(M){const F=Qe(o.panZoom);if(!F)return!1;const X=tS(Qe(o.nodeLookup),M);return nS({nodes:X,width:Qe(o.width),height:Qe(o.height),minZoom:Qe(o.minZoom),maxZoom:Qe(o.maxZoom),panZoom:F},M),X.size>0}function m(M,F){const X=Qe(o.panZoom);return X?X.scaleBy(M,F):Promise.resolve(!1)}function x(M){return m(1.2,M)}function p(M){return m(1/1.2,M)}function y(M){const F=Qe(o.panZoom);F&&(F.setScaleExtent([M,Qe(o.maxZoom)]),o.minZoom.set(M))}function w(M){const F=Qe(o.panZoom);F&&(F.setScaleExtent([Qe(o.minZoom),M]),o.maxZoom.set(M))}function v(M){const F=Qe(o.panZoom);F&&(F.setTranslateExtent(M),o.translateExtent.set(M))}function _(M){let F=!1;return M.forEach(X=>{X.selected&&(X.selected=!1,F=!0)}),F}function C(M){var F;(F=Qe(o.panZoom))==null||F.setClickDistance(M)}function k(M){_((M==null?void 0:M.nodes)||Qe(o.nodes))&&o.nodes.set(Qe(o.nodes)),_((M==null?void 0:M.edges)||Qe(o.edges))&&o.edges.set(Qe(o.edges))}o.deleteKeyPressed.subscribe(async M=>{var F;if(M){const X=Qe(o.nodes),z=Qe(o.edges),K=X.filter(ue=>ue.selected),j=z.filter(ue=>ue.selected),{nodes:ae,edges:ge}=await hO({nodesToRemove:K,edgesToRemove:j,nodes:X,edges:z,onBeforeDelete:Qe(o.onbeforedelete)});(ae.length||ge.length)&&(o.nodes.update(ue=>ue.filter(pe=>!ae.some(de=>de.id===pe.id))),o.edges.update(ue=>ue.filter(pe=>!ge.some(de=>de.id===pe.id))),(F=Qe(o.ondelete))==null||F({nodes:ae,edges:ge}))}});function I(M){const F=Qe(o.multiselectionKeyPressed);o.nodes.update(X=>X.map(z=>{const K=M.includes(z.id),j=F&&z.selected||K;return z.selected=j,z})),F||o.edges.update(X=>X.map(z=>(z.selected=!1,z)))}function S(M){const F=Qe(o.multiselectionKeyPressed);o.edges.update(X=>X.map(z=>{const K=M.includes(z.id),j=F&&z.selected||K;return z.selected=j,z})),F||o.nodes.update(X=>X.map(z=>(z.selected=!1,z)))}function R(M){var X;const F=(X=Qe(o.nodes))==null?void 0:X.find(z=>z.id===M);if(!F){console.warn("012",vx.error012(M));return}o.selectionRect.set(null),o.selectionRectMode.set(null),F.selected?F.selected&&Qe(o.multiselectionKeyPressed)&&k({nodes:[F],edges:[]}):I([M])}function P(M){const F=Qe(o.viewport);return fne({delta:M,panZoom:Qe(o.panZoom),transform:[F.x,F.y,F.zoom],translateExtent:Qe(o.translateExtent),width:Qe(o.width),height:Qe(o.height)})}const D=$t(q6),U=M=>{D.set({...M})};function T(){D.set(q6)}function G(){o.fitViewOnInitDone.set(!1),o.selectionRect.set(null),o.selectionRectMode.set(null),o.snapGrid.set(null),o.isValidConnection.set(()=>!0),k(),T()}return{...o,visibleEdges:xie(o),visibleNodes:yie(o),connection:Kf([D,o.viewport],([M,F])=>M.inProgress?{...M,to:_x(M.to,[F.x,F.y,F.zoom])}:{...M}),markers:Kf([o.edges,o.defaultMarkerColor,o.flowId],([M,F,X])=>one(M,{defaultColor:F,id:X})),initialized:(()=>{let M=!1;const F=Qe(o.nodes).length,X=Qe(o.edges).length;return Kf([o.nodesInitialized,o.edgesInitialized,o.viewportInitialized],([z,K,j])=>M||(F===0?M=j:X===0?M=j&&z:M=j&&z&&K,M))})(),syncNodeStores:M=>die(o.nodes,M),syncEdgeStores:M=>fie(o.edges,M),syncViewport:M=>gie(o.panZoom,o.viewport,M),setNodeTypes:l,setEdgeTypes:c,addEdge:h,updateNodePositions:u,updateNodeInternals:d,zoomIn:x,zoomOut:p,fitView:M=>f(M),setMinZoom:y,setMaxZoom:w,setTranslateExtent:v,setPaneClickDistance:C,unselectNodesAndEdges:k,addSelectedNodes:I,addSelectedEdges:S,handleNodeSelection:R,panBy:P,updateConnection:U,cancelConnection:T,reset:G}}function es(){const n=qs(Ny);if(!n)throw new Error("In order to use useStore you need to wrap your component in a <SvelteFlowProvider />");return n.getStore()}function wie({nodes:n,edges:e,width:t,height:i,fitView:s,nodeOrigin:r,nodeExtent:a}){const o=FO({nodes:n,edges:e,width:t,height:i,fitView:s,nodeOrigin:r,nodeExtent:a});return Ip(Ny,{getStore:()=>o}),o}function vie(n,e){const{panZoom:t,minZoom:i,maxZoom:s,initialViewport:r,viewport:a,dragging:o,translateExtent:l,paneClickDistance:c}=e,h=Tne({domNode:n,minZoom:i,maxZoom:s,translateExtent:l,viewport:r,paneClickDistance:c,onDraggingChange:o.set}),u=h.getViewport();return a.set(u),t.set(h),h.update(e),{update(d){h.update(d)}}}function _ie(n){let e,t,i,s,r;const a=n[35].default,o=zs(a,n,n[34],null);return{c(){e=ie("div"),o&&o.c(),this.h()},l(l){e=se(l,"DIV",{class:!0});var c=V(e);o&&o.l(c),c.forEach(E),this.h()},h(){A(e,"class","svelte-flow__zoom svelte-4xkw84")},m(l,c){te(l,e,c),o&&o.m(e,null),i=!0,s||(r=ra(t=vie.call(null,e,{viewport:n[18],minZoom:n[12],maxZoom:n[13],initialViewport:n[11],dragging:n[23],panZoom:n[19],onPanZoomStart:n[0],onPanZoom:n[1],onPanZoomEnd:n[2],zoomOnScroll:n[5],zoomOnDoubleClick:n[6],zoomOnPinch:n[7],panOnScroll:n[9],panOnDrag:n[10],panOnScrollSpeed:.5,panOnScrollMode:n[3]||tc.Free,zoomActivationKeyPressed:n[14],preventScrolling:typeof n[4]=="boolean"?n[4]:!0,noPanClassName:"nopan",noWheelClassName:"nowheel",userSelectionActive:!!n[15],translateExtent:n[16],lib:n[17],paneClickDistance:n[8],onTransformChange:n[29]})),s=!0)},p(l,c){o&&o.p&&(!i||c[1]&8)&&js(o,a,l,l[34],i?Vs(a,l[34],c,null):Gs(l[34]),null),t&&Ds(t.update)&&c[0]&262143&&t.update.call(null,{viewport:l[18],minZoom:l[12],maxZoom:l[13],initialViewport:l[11],dragging:l[23],panZoom:l[19],onPanZoomStart:l[0],onPanZoom:l[1],onPanZoomEnd:l[2],zoomOnScroll:l[5],zoomOnDoubleClick:l[6],zoomOnPinch:l[7],panOnScroll:l[9],panOnDrag:l[10],panOnScrollSpeed:.5,panOnScrollMode:l[3]||tc.Free,zoomActivationKeyPressed:l[14],preventScrolling:typeof l[4]=="boolean"?l[4]:!0,noPanClassName:"nopan",noWheelClassName:"nowheel",userSelectionActive:!!l[15],translateExtent:l[16],lib:l[17],paneClickDistance:l[8],onTransformChange:l[29]})},i(l){i||(H(o,l),i=!0)},o(l){q(o,l),i=!1},d(l){l&&E(e),o&&o.d(l),s=!1,r()}}}function kie(n,e,t){let i,s,r,a,o,l,c,h,u,d,f,{$$slots:g={},$$scope:m}=e,{initialViewport:x=void 0}=e,{onMoveStart:p=void 0}=e,{onMove:y=void 0}=e,{onMoveEnd:w=void 0}=e,{panOnScrollMode:v}=e,{preventScrolling:_}=e,{zoomOnScroll:C}=e,{zoomOnDoubleClick:k}=e,{zoomOnPinch:I}=e,{panOnDrag:S}=e,{panOnScroll:R}=e,{paneClickDistance:P}=e;const{viewport:D,panZoom:U,selectionRect:T,minZoom:G,maxZoom:M,dragging:F,translateExtent:X,lib:z,panActivationKeyPressed:K,zoomActivationKeyPressed:j,viewportInitialized:ae}=es();Oe(n,T,ue=>t(15,u=ue)),Oe(n,G,ue=>t(12,l=ue)),Oe(n,M,ue=>t(13,c=ue)),Oe(n,X,ue=>t(16,d=ue)),Oe(n,z,ue=>t(17,f=ue)),Oe(n,K,ue=>t(33,o=ue)),Oe(n,j,ue=>t(14,h=ue)),Oe(n,ae,ue=>t(36,a=ue));const ge=ue=>D.set({x:ue[0],y:ue[1],zoom:ue[2]});return ol(()=>{c3(ae,a=!0,a)}),n.$$set=ue=>{"initialViewport"in ue&&t(30,x=ue.initialViewport),"onMoveStart"in ue&&t(0,p=ue.onMoveStart),"onMove"in ue&&t(1,y=ue.onMove),"onMoveEnd"in ue&&t(2,w=ue.onMoveEnd),"panOnScrollMode"in ue&&t(3,v=ue.panOnScrollMode),"preventScrolling"in ue&&t(4,_=ue.preventScrolling),"zoomOnScroll"in ue&&t(5,C=ue.zoomOnScroll),"zoomOnDoubleClick"in ue&&t(6,k=ue.zoomOnDoubleClick),"zoomOnPinch"in ue&&t(7,I=ue.zoomOnPinch),"panOnDrag"in ue&&t(31,S=ue.panOnDrag),"panOnScroll"in ue&&t(32,R=ue.panOnScroll),"paneClickDistance"in ue&&t(8,P=ue.paneClickDistance),"$$scope"in ue&&t(34,m=ue.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&1073741824&&t(11,i=x||{x:0,y:0,zoom:1}),n.$$.dirty[1]&5&&t(10,s=o||S),n.$$.dirty[1]&6&&t(9,r=o||R)},[p,y,w,v,_,C,k,I,P,r,s,i,l,c,h,u,d,f,D,U,T,G,M,F,X,z,K,j,ae,ge,x,S,R,o,m,g]}class Cie extends Ht{constructor(e){super(),zt(this,e,kie,_ie,qt,{initialViewport:30,onMoveStart:0,onMove:1,onMoveEnd:2,panOnScrollMode:3,preventScrolling:4,zoomOnScroll:5,zoomOnDoubleClick:6,zoomOnPinch:7,panOnDrag:31,panOnScroll:32,paneClickDistance:8},null,[-1,-1])}}function Aie(n){let e,t,i,s;const r=n[28].default,a=zs(r,n,n[27],null);return{c(){e=ie("div"),a&&a.c(),this.h()},l(o){e=se(o,"DIV",{class:!0});var l=V(e);a&&a.l(l),l.forEach(E),this.h()},h(){A(e,"class","svelte-flow__pane svelte-1esy7hx"),mn(e,"draggable",n[0]===!0||Array.isArray(n[0])&&n[0].includes(0)),mn(e,"dragging",n[4]),mn(e,"selection",n[1])},m(o,l){te(o,e,l),a&&a.m(e,null),n[29](e),t=!0,i||(s=[xt(e,"click",function(){Ds(n[3]?void 0:g9(n[15],n[2]))&&(n[3]?void 0:g9(n[15],n[2])).apply(this,arguments)}),xt(e,"pointerdown",function(){Ds(n[3]?n[16]:void 0)&&(n[3]?n[16]:void 0).apply(this,arguments)}),xt(e,"pointermove",function(){Ds(n[3]?n[17]:void 0)&&(n[3]?n[17]:void 0).apply(this,arguments)}),xt(e,"pointerup",function(){Ds(n[3]?n[18]:void 0)&&(n[3]?n[18]:void 0).apply(this,arguments)}),xt(e,"contextmenu",function(){Ds(g9(n[19],n[2]))&&g9(n[19],n[2]).apply(this,arguments)})],i=!0)},p(o,l){n=o,a&&a.p&&(!t||l[0]&134217728)&&js(a,r,n,n[27],t?Vs(r,n[27],l,null):Gs(n[27]),null),(!t||l[0]&1)&&mn(e,"draggable",n[0]===!0||Array.isArray(n[0])&&n[0].includes(0)),(!t||l[0]&16)&&mn(e,"dragging",n[4]),(!t||l[0]&2)&&mn(e,"selection",n[1])},i(o){t||(H(a,o),t=!0)},o(o){q(a,o),t=!1},d(o){o&&E(e),a&&a.d(o),n[29](null),i=!1,Zr(s)}}}function g9(n,e){return t=>{t.target===e&&(n==null||n(t))}}function bS(n){return e=>{const t=n.includes(e.id);return e.selected!==t&&(e.selected=t),e}}function Sie(n,e,t){let i,s,r,a,o,l,c,h,u,d,f,g,m,{$$slots:x={},$$scope:p}=e,{panOnDrag:y=void 0}=e,{selectionOnDrag:w=void 0}=e;const v=Ka(),{nodes:_,nodeLookup:C,edges:k,viewport:I,dragging:S,elementsSelectable:R,selectionRect:P,selectionRectMode:D,selectionKeyPressed:U,selectionMode:T,panActivationKeyPressed:G,unselectNodesAndEdges:M}=es();Oe(n,C,O=>t(36,u=O)),Oe(n,k,O=>t(33,l=O)),Oe(n,I,O=>t(35,h=O)),Oe(n,S,O=>t(4,m=O)),Oe(n,R,O=>t(25,f=O)),Oe(n,P,O=>t(24,d=O)),Oe(n,D,O=>t(23,o=O)),Oe(n,U,O=>t(22,a=O)),Oe(n,T,O=>t(34,c=O)),Oe(n,G,O=>t(26,g=O));let F,X=null,z=[],K=!1;function j(O){if(K){K=!1;return}v("paneclick",{event:O}),M(),D.set(null)}function ae(O){var $,re;if(X=F.getBoundingClientRect(),!R||!s||O.button!==0||O.target!==F||!X)return;(re=($=O.target)==null?void 0:$.setPointerCapture)==null||re.call($,O.pointerId);const{x:Y,y:le}=c0(O,X);M(),P.set({width:0,height:0,startX:Y,startY:le,x:Y,y:le})}function ge(O){if(!s||!X||!d)return;K=!0;const Y=c0(O,X),le=d.startX??0,$=d.startY??0,re={...d,x:Y.x<le?Y.x:le,y:Y.y<$?Y.y:$,width:Math.abs(Y.x-le),height:Math.abs(Y.y-$)},oe=z.map(Re=>Re.id),ee=W6(z,l).map(Re=>Re.id);z=cO(u,re,[h.x,h.y,h.zoom],c===i5.Partial,!0);const Q=W6(z,l).map(Re=>Re.id),je=z.map(Re=>Re.id);(oe.length!==je.length||je.some(Re=>!oe.includes(Re)))&&_.update(Re=>Re.map(bS(je))),(ee.length!==Q.length||Q.some(Re=>!ee.includes(Re)))&&k.update(Re=>Re.map(bS(Q))),D.set("user"),P.set(re)}function ue(O){var Y,le;O.button===0&&((le=(Y=O.target)==null?void 0:Y.releasePointerCapture)==null||le.call(Y,O.pointerId),!s&&o==="user"&&O.target===F&&(j==null||j(O)),P.set(null),z.length>0&&c3(D,o="nodes",o),a&&(K=!1))}const pe=O=>{if(Array.isArray(i)&&(i!=null&&i.includes(2))){O.preventDefault();return}v("panecontextmenu",{event:O})};function de(O){Et[O?"unshift":"push"](()=>{F=O,t(2,F)})}return n.$$set=O=>{"panOnDrag"in O&&t(0,y=O.panOnDrag),"selectionOnDrag"in O&&t(20,w=O.selectionOnDrag),"$$scope"in O&&t(27,p=O.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&67108865&&t(21,i=g||y),n.$$.dirty[0]&24117248&&t(1,s=a||d||w&&i!==!0),n.$$.dirty[0]&41943042&&t(3,r=f&&(s||o==="user"))},[y,s,F,r,m,C,k,I,S,R,P,D,U,T,G,j,ae,ge,ue,pe,w,i,a,o,d,f,g,p,x,de]}class Iie extends Ht{constructor(e){super(),zt(this,e,Sie,Aie,qt,{panOnDrag:0,selectionOnDrag:20},null,[-1,-1])}}function Eie(n){let e,t;const i=n[3].default,s=zs(i,n,n[2],null);return{c(){e=ie("div"),s&&s.c(),this.h()},l(r){e=se(r,"DIV",{class:!0,style:!0});var a=V(e);s&&s.l(a),a.forEach(E),this.h()},h(){A(e,"class","svelte-flow__viewport xyflow__viewport svelte-1floaup"),tn(e,"transform","translate("+n[0].x+"px, "+n[0].y+"px) scale("+n[0].zoom+")")},m(r,a){te(r,e,a),s&&s.m(e,null),t=!0},p(r,[a]){s&&s.p&&(!t||a&4)&&js(s,i,r,r[2],t?Vs(i,r[2],a,null):Gs(r[2]),null),(!t||a&1)&&tn(e,"transform","translate("+r[0].x+"px, "+r[0].y+"px) scale("+r[0].zoom+")")},i(r){t||(H(s,r),t=!0)},o(r){q(s,r),t=!1},d(r){r&&E(e),s&&s.d(r)}}}function Tie(n,e,t){let i,{$$slots:s={},$$scope:r}=e;const{viewport:a}=es();return Oe(n,a,o=>t(0,i=o)),n.$$set=o=>{"$$scope"in o&&t(2,r=o.$$scope)},[i,a,r,s]}class Rie extends Ht{constructor(e){super(),zt(this,e,Tie,Eie,qt,{})}}function BO(n,e){const{store:t,onDrag:i,onDragStart:s,onDragStop:r,onNodeMouseDown:a}=e,o=mne({onDrag:i,onDragStart:s,onDragStop:r,onNodeMouseDown:a,getStoreItems:()=>{const c=Qe(t.snapGrid),h=Qe(t.viewport);return{nodes:Qe(t.nodes),nodeLookup:Qe(t.nodeLookup),edges:Qe(t.edges),nodeExtent:Qe(t.nodeExtent),snapGrid:c||[0,0],snapToGrid:!!c,nodeOrigin:Qe(t.nodeOrigin),multiSelectionActive:Qe(t.multiselectionKeyPressed),domNode:Qe(t.domNode),transform:[h.x,h.y,h.zoom],autoPanOnNodeDrag:Qe(t.autoPanOnNodeDrag),nodesDraggable:Qe(t.nodesDraggable),selectNodesOnDrag:Qe(t.selectNodesOnDrag),nodeDragThreshold:Qe(t.nodeDragThreshold),unselectNodesAndEdges:t.unselectNodesAndEdges,updateNodePositions:t.updateNodePositions,panBy:t.panBy}}});function l(c,h){if(h.disabled){o.destroy();return}o.update({domNode:c,noDragClassName:h.noDragClass,handleSelector:h.handleSelector,nodeId:h.nodeId,isSelectable:h.isSelectable,nodeClickDistance:h.nodeClickDistance})}return l(n,e),{update(c){l(n,c)},destroy(){o.destroy()}}}function Mie({width:n,height:e,initialWidth:t,initialHeight:i,measuredWidth:s,measuredHeight:r}){if(s===void 0&&r===void 0){const a=n??t,o=e??i;return{width:a?`width:${a}px;`:"",height:o?`height:${o}px;`:""}}return{width:n?`width:${n}px;`:"",height:e?`height:${e}px;`:""}}function xS(n){let e,t,i,s,r,a=`translate(${n[12]}px, ${n[13]}px)`,o,l,c;var h=n[27];function u(d,f){return{props:{data:d[2],id:d[1],selected:d[3],selectable:d[5],deletable:d[7],sourcePosition:d[14],targetPosition:d[15],zIndex:d[16],dragging:d[9],draggable:d[4],dragHandle:d[19],parentId:d[21],type:d[25],isConnectable:d[28],positionAbsoluteX:d[12],positionAbsoluteY:d[13],width:d[17],height:d[18]}}}return h&&(t=h3(h,u(n))),{c(){e=ie("div"),t&&be(t.$$.fragment),this.h()},l(d){e=se(d,"DIV",{"data-id":!0,class:!0,style:!0});var f=V(e);t&&ve(t.$$.fragment,f),f.forEach(E),this.h()},h(){A(e,"data-id",n[1]),A(e,"class",i=Ii(["svelte-flow__node",`svelte-flow__node-${n[25]}`,n[23]])),A(e,"style",s=(n[10]??"")+";"+n[26].width+n[26].height),mn(e,"dragging",n[9]),mn(e,"selected",n[3]),mn(e,"draggable",n[4]),mn(e,"connectable",n[6]),mn(e,"selectable",n[5]),mn(e,"nopan",n[4]),mn(e,"parent",n[11]),tn(e,"z-index",n[16]),tn(e,"transform",a),tn(e,"visibility",n[20]?"visible":"hidden")},m(d,f){te(d,e,f),t&&xe(t,e,null),n[50](e),o=!0,l||(c=[ra(r=BO.call(null,e,{nodeId:n[1],isSelectable:n[5],disabled:!1,handleSelector:n[19],noDragClass:"nodrag",nodeClickDistance:n[22],onNodeMouseDown:n[31],onDrag:n[47],onDragStart:n[48],onDragStop:n[49],store:n[29]})),xt(e,"click",n[34]),xt(e,"mouseenter",n[51]),xt(e,"mouseleave",n[52]),xt(e,"mousemove",n[53]),xt(e,"contextmenu",n[54])],l=!0)},p(d,f){if(f[0]&134217728&&h!==(h=d[27])){if(t){yt();const m=t;q(m.$$.fragment,1,0,()=>{ye(m,1)}),wt()}h?(t=h3(h,u(d)),be(t.$$.fragment),H(t.$$.fragment,1),xe(t,e,null)):t=null}else if(h){const m={};f[0]&4&&(m.data=d[2]),f[0]&2&&(m.id=d[1]),f[0]&8&&(m.selected=d[3]),f[0]&32&&(m.selectable=d[5]),f[0]&128&&(m.deletable=d[7]),f[0]&16384&&(m.sourcePosition=d[14]),f[0]&32768&&(m.targetPosition=d[15]),f[0]&65536&&(m.zIndex=d[16]),f[0]&512&&(m.dragging=d[9]),f[0]&16&&(m.draggable=d[4]),f[0]&524288&&(m.dragHandle=d[19]),f[0]&2097152&&(m.parentId=d[21]),f[0]&33554432&&(m.type=d[25]),f[0]&268435456&&(m.isConnectable=d[28]),f[0]&4096&&(m.positionAbsoluteX=d[12]),f[0]&8192&&(m.positionAbsoluteY=d[13]),f[0]&131072&&(m.width=d[17]),f[0]&262144&&(m.height=d[18]),t.$set(m)}(!o||f[0]&2)&&A(e,"data-id",d[1]),(!o||f[0]&41943040&&i!==(i=Ii(["svelte-flow__node",`svelte-flow__node-${d[25]}`,d[23]])))&&A(e,"class",i),(!o||f[0]&67109888&&s!==(s=(d[10]??"")+";"+d[26].width+d[26].height))&&A(e,"style",s),r&&Ds(r.update)&&f[0]&4718626&&r.update.call(null,{nodeId:d[1],isSelectable:d[5],disabled:!1,handleSelector:d[19],noDragClass:"nodrag",nodeClickDistance:d[22],onNodeMouseDown:d[31],onDrag:d[47],onDragStart:d[48],onDragStop:d[49],store:d[29]}),(!o||f[0]&41943552)&&mn(e,"dragging",d[9]),(!o||f[0]&41943048)&&mn(e,"selected",d[3]),(!o||f[0]&41943056)&&mn(e,"draggable",d[4]),(!o||f[0]&41943104)&&mn(e,"connectable",d[6]),(!o||f[0]&41943072)&&mn(e,"selectable",d[5]),(!o||f[0]&41943056)&&mn(e,"nopan",d[4]),(!o||f[0]&41945088)&&mn(e,"parent",d[11]);const g=f[0]&67109888;(f[0]&67175424||g)&&tn(e,"z-index",d[16]),(f[0]&67122176&&a!==(a=`translate(${d[12]}px, ${d[13]}px)`)||g)&&tn(e,"transform",a),(f[0]&68158464||g)&&tn(e,"visibility",d[20]?"visible":"hidden")},i(d){o||(t&&H(t.$$.fragment,d),o=!0)},o(d){t&&q(t.$$.fragment,d),o=!1},d(d){d&&E(e),t&&ye(t),n[50](null),l=!1,Zr(c)}}}function Pie(n){let e,t,i=!n[8]&&xS(n);return{c(){i&&i.c(),e=Xt()},l(s){i&&i.l(s),e=Xt()},m(s,r){i&&i.m(s,r),te(s,e,r),t=!0},p(s,r){s[8]?i&&(yt(),q(i,1,1,()=>{i=null}),wt()):i?(i.p(s,r),r[0]&256&&H(i,1)):(i=xS(s),i.c(),H(i,1),i.m(e.parentNode,e))},i(s){t||(H(i),t=!0)},o(s){q(i),t=!1},d(s){s&&E(e),i&&i.d(s)}}}function Nie(n,e,t){let i,s,r,a,o,l,{node:c}=e,{id:h}=e,{data:u={}}=e,{selected:d=!1}=e,{draggable:f=void 0}=e,{selectable:g=void 0}=e,{connectable:m=!0}=e,{deletable:x=!0}=e,{hidden:p=!1}=e,{dragging:y=!1}=e,{resizeObserver:w=null}=e,{style:v=void 0}=e,{type:_="default"}=e,{isParent:C=!1}=e,{positionX:k}=e,{positionY:I}=e,{sourcePosition:S=void 0}=e,{targetPosition:R=void 0}=e,{zIndex:P}=e,{measuredWidth:D=void 0}=e,{measuredHeight:U=void 0}=e,{initialWidth:T=void 0}=e,{initialHeight:G=void 0}=e,{width:M=void 0}=e,{height:F=void 0}=e,{dragHandle:X=void 0}=e,{initialized:z=!1}=e,{parentId:K=void 0}=e,{nodeClickDistance:j=void 0}=e,{class:ae=""}=e;const ge=es(),{nodeTypes:ue,nodeDragThreshold:pe,selectNodesOnDrag:de,handleNodeSelection:O,updateNodeInternals:Y}=ge;Oe(n,ue,me=>t(46,o=me));let le,$=null;const re=Ka(),oe=$t(m);Oe(n,oe,me=>t(28,l=me));let ee,Q,je;Ip("svelteflow__node_id",h),Ip("svelteflow__node_connectable",oe),Gh(()=>{$&&(w==null||w.unobserve($))});function Re(me){g&&(!Qe(de)||!f||Qe(pe)>0)&&O(h),re("nodeclick",{node:c.internals.userNode,event:me})}const Ne=(me,Mt,ut,dt)=>{re("nodedrag",{event:me,targetNode:ut,nodes:dt})},He=(me,Mt,ut,dt)=>{re("nodedragstart",{event:me,targetNode:ut,nodes:dt})},Be=(me,Mt,ut,dt)=>{re("nodedragstop",{event:me,targetNode:ut,nodes:dt})};function Je(me){Et[me?"unshift":"push"](()=>{le=me,t(24,le)})}const ht=me=>re("nodemouseenter",{node:c,event:me}),ot=me=>re("nodemouseleave",{node:c,event:me}),Ye=me=>re("nodemousemove",{node:c,event:me}),rt=me=>re("nodecontextmenu",{node:c,event:me});return n.$$set=me=>{"node"in me&&t(0,c=me.node),"id"in me&&t(1,h=me.id),"data"in me&&t(2,u=me.data),"selected"in me&&t(3,d=me.selected),"draggable"in me&&t(4,f=me.draggable),"selectable"in me&&t(5,g=me.selectable),"connectable"in me&&t(6,m=me.connectable),"deletable"in me&&t(7,x=me.deletable),"hidden"in me&&t(8,p=me.hidden),"dragging"in me&&t(9,y=me.dragging),"resizeObserver"in me&&t(35,w=me.resizeObserver),"style"in me&&t(10,v=me.style),"type"in me&&t(36,_=me.type),"isParent"in me&&t(11,C=me.isParent),"positionX"in me&&t(12,k=me.positionX),"positionY"in me&&t(13,I=me.positionY),"sourcePosition"in me&&t(14,S=me.sourcePosition),"targetPosition"in me&&t(15,R=me.targetPosition),"zIndex"in me&&t(16,P=me.zIndex),"measuredWidth"in me&&t(37,D=me.measuredWidth),"measuredHeight"in me&&t(38,U=me.measuredHeight),"initialWidth"in me&&t(39,T=me.initialWidth),"initialHeight"in me&&t(40,G=me.initialHeight),"width"in me&&t(17,M=me.width),"height"in me&&t(18,F=me.height),"dragHandle"in me&&t(19,X=me.dragHandle),"initialized"in me&&t(20,z=me.initialized),"parentId"in me&&t(21,K=me.parentId),"nodeClickDistance"in me&&t(22,j=me.nodeClickDistance),"class"in me&&t(23,ae=me.class)},n.$$.update=()=>{n.$$.dirty[1]&32&&t(25,i=_||"default"),n.$$.dirty[0]&33554432|n.$$.dirty[1]&32768&&t(45,s=!!o[i]),n.$$.dirty[0]&33554432|n.$$.dirty[1]&32768&&t(27,r=o[i]||PO),n.$$.dirty[1]&16416&&(s||console.warn("003",vx.error003(_))),n.$$.dirty[0]&393216|n.$$.dirty[1]&960&&t(26,a=Mie({width:M,height:F,initialWidth:T,initialHeight:G,measuredWidth:D,measuredHeight:U})),n.$$.dirty[0]&64&&oe.set(!!m),n.$$.dirty[0]&50380802|n.$$.dirty[1]&14336&&((ee&&i!==ee||Q&&S!==Q||je&&R!==je)&&requestAnimationFrame(()=>Y(new Map([[h,{id:h,nodeElement:le,force:!0}]]))),t(42,ee=i),t(43,Q=S),t(44,je=R)),n.$$.dirty[0]&17825792|n.$$.dirty[1]&1040&&w&&(le!==$||!z)&&($&&w.unobserve($),le&&w.observe(le),t(41,$=le))},[c,h,u,d,f,g,m,x,p,y,v,C,k,I,S,R,P,M,F,X,z,K,j,ae,le,i,a,r,l,ge,ue,O,re,oe,Re,w,_,D,U,T,G,$,ee,Q,je,s,o,Ne,He,Be,Je,ht,ot,Ye,rt]}class Oie extends Ht{constructor(e){super(),zt(this,e,Nie,Pie,vI,{node:0,id:1,data:2,selected:3,draggable:4,selectable:5,connectable:6,deletable:7,hidden:8,dragging:9,resizeObserver:35,style:10,type:36,isParent:11,positionX:12,positionY:13,sourcePosition:14,targetPosition:15,zIndex:16,measuredWidth:37,measuredHeight:38,initialWidth:39,initialHeight:40,width:17,height:18,dragHandle:19,initialized:20,parentId:21,nodeClickDistance:22,class:23},null,[-1,-1])}}const{Map:Die}=_I;function yS(n,e,t){const i=n.slice();return i[21]=e[t],i}function wS(n,e){let t,i,s;return i=new Oie({props:{node:e[21],id:e[21].id,data:e[21].data,selected:!!e[21].selected,hidden:!!e[21].hidden,draggable:!!(e[21].draggable||e[2]&&typeof e[21].draggable>"u"),selectable:!!(e[21].selectable||e[3]&&typeof e[21].selectable>"u"),connectable:!!(e[21].connectable||e[4]&&typeof e[21].connectable>"u"),deletable:e[21].deletable??!0,positionX:e[21].internals.positionAbsolute.x,positionY:e[21].internals.positionAbsolute.y,isParent:e[5].has(e[21].id),style:e[21].style,class:e[21].class,type:e[21].type??"default",sourcePosition:e[21].sourcePosition,targetPosition:e[21].targetPosition,dragging:e[21].dragging,zIndex:e[21].internals.z??0,dragHandle:e[21].dragHandle,initialized:rS(e[21]),width:e[21].width,height:e[21].height,initialWidth:e[21].initialWidth,initialHeight:e[21].initialHeight,measuredWidth:e[21].measured.width,measuredHeight:e[21].measured.height,parentId:e[21].parentId,resizeObserver:e[11],nodeClickDistance:e[0]}}),i.$on("nodeclick",e[12]),i.$on("nodemouseenter",e[13]),i.$on("nodemousemove",e[14]),i.$on("nodemouseleave",e[15]),i.$on("nodedrag",e[16]),i.$on("nodedragstart",e[17]),i.$on("nodedragstop",e[18]),i.$on("nodecontextmenu",e[19]),{key:n,first:null,c(){t=Xt(),be(i.$$.fragment),this.h()},l(r){t=Xt(),ve(i.$$.fragment,r),this.h()},h(){this.first=t},m(r,a){te(r,t,a),xe(i,r,a),s=!0},p(r,a){e=r;const o={};a&2&&(o.node=e[21]),a&2&&(o.id=e[21].id),a&2&&(o.data=e[21].data),a&2&&(o.selected=!!e[21].selected),a&2&&(o.hidden=!!e[21].hidden),a&6&&(o.draggable=!!(e[21].draggable||e[2]&&typeof e[21].draggable>"u")),a&10&&(o.selectable=!!(e[21].selectable||e[3]&&typeof e[21].selectable>"u")),a&18&&(o.connectable=!!(e[21].connectable||e[4]&&typeof e[21].connectable>"u")),a&2&&(o.deletable=e[21].deletable??!0),a&2&&(o.positionX=e[21].internals.positionAbsolute.x),a&2&&(o.positionY=e[21].internals.positionAbsolute.y),a&34&&(o.isParent=e[5].has(e[21].id)),a&2&&(o.style=e[21].style),a&2&&(o.class=e[21].class),a&2&&(o.type=e[21].type??"default"),a&2&&(o.sourcePosition=e[21].sourcePosition),a&2&&(o.targetPosition=e[21].targetPosition),a&2&&(o.dragging=e[21].dragging),a&2&&(o.zIndex=e[21].internals.z??0),a&2&&(o.dragHandle=e[21].dragHandle),a&2&&(o.initialized=rS(e[21])),a&2&&(o.width=e[21].width),a&2&&(o.height=e[21].height),a&2&&(o.initialWidth=e[21].initialWidth),a&2&&(o.initialHeight=e[21].initialHeight),a&2&&(o.measuredWidth=e[21].measured.width),a&2&&(o.measuredHeight=e[21].measured.height),a&2&&(o.parentId=e[21].parentId),a&1&&(o.nodeClickDistance=e[0]),i.$set(o)},i(r){s||(H(i.$$.fragment,r),s=!0)},o(r){q(i.$$.fragment,r),s=!1},d(r){r&&E(t),ye(i,r)}}}function Lie(n){let e,t=[],i=new Die,s,r=ni(n[1]);const a=o=>o[21].id;for(let o=0;o<r.length;o+=1){let l=yS(n,r,o),c=a(l);i.set(c,t[o]=wS(c,l))}return{c(){e=ie("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=se(o,"DIV",{class:!0});var l=V(e);for(let c=0;c<t.length;c+=1)t[c].l(l);l.forEach(E),this.h()},h(){A(e,"class","svelte-flow__nodes svelte-tf4uy4")},m(o,l){te(o,e,l);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);s=!0},p(o,[l]){l&2111&&(r=ni(o[1]),yt(),t=j5(t,l,a,1,o,r,i,e,G5,wS,null,yS),wt())},i(o){if(!s){for(let l=0;l<r.length;l+=1)H(t[l]);s=!0}},o(o){for(let l=0;l<t.length;l+=1)q(t[l]);s=!1},d(o){o&&E(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function Fie(n,e,t){let i,s,r,a,o,{nodeClickDistance:l=0}=e;const{visibleNodes:c,nodesDraggable:h,nodesConnectable:u,elementsSelectable:d,updateNodeInternals:f,parentLookup:g}=es();Oe(n,c,I=>t(1,i=I)),Oe(n,h,I=>t(2,s=I)),Oe(n,u,I=>t(4,a=I)),Oe(n,d,I=>t(3,r=I)),Oe(n,g,I=>t(5,o=I));const m=typeof ResizeObserver>"u"?null:new ResizeObserver(I=>{const S=new Map;I.forEach(R=>{const P=R.target.getAttribute("data-id");S.set(P,{id:P,nodeElement:R.target,force:!0})}),f(S)});Gh(()=>{m==null||m.disconnect()});function x(I){Yn.call(this,n,I)}function p(I){Yn.call(this,n,I)}function y(I){Yn.call(this,n,I)}function w(I){Yn.call(this,n,I)}function v(I){Yn.call(this,n,I)}function _(I){Yn.call(this,n,I)}function C(I){Yn.call(this,n,I)}function k(I){Yn.call(this,n,I)}return n.$$set=I=>{"nodeClickDistance"in I&&t(0,l=I.nodeClickDistance)},[l,i,s,r,a,o,c,h,u,d,g,m,x,p,y,w,v,_,C,k]}class Bie extends Ht{constructor(e){super(),zt(this,e,Fie,Lie,qt,{nodeClickDistance:0})}}function vS(n){let e,t,i,s,r,a,o,l;var c=n[27];function h(u,d){return{props:{id:u[0],source:u[1],target:u[2],sourceX:u[14],sourceY:u[15],targetX:u[16],targetY:u[17],sourcePosition:u[18],targetPosition:u[19],animated:u[6],selected:u[7],label:u[10],labelStyle:u[11],data:u[3],style:u[4],interactionWidth:u[21],selectable:u[24],deletable:u[8]??!0,type:u[23],sourceHandleId:u[12],targetHandleId:u[13],markerStart:u[26],markerEnd:u[25]}}}return c&&(i=h3(c,h(n))),{c(){e=lt("svg"),t=lt("g"),i&&be(i.$$.fragment),this.h()},l(u){e=ct(u,"svg",{});var d=V(e);t=ct(d,"g",{class:!0,"data-id":!0,"aria-label":!0,role:!0});var f=V(t);i&&ve(i.$$.fragment,f),f.forEach(E),d.forEach(E),this.h()},h(){A(t,"class",s=Ii(["svelte-flow__edge",n[22]])),A(t,"data-id",n[0]),A(t,"aria-label",r=n[20]===null?void 0:n[20]?n[20]:`Edge from ${n[1]} to ${n[2]}`),A(t,"role","img"),mn(t,"animated",n[6]),mn(t,"selected",n[7]),mn(t,"selectable",n[24]),tn(e,"z-index",n[5])},m(u,d){te(u,e,d),W(e,t),i&&xe(i,t,null),a=!0,o||(l=[xt(t,"click",n[32]),xt(t,"contextmenu",n[41]),xt(t,"mouseenter",n[42]),xt(t,"mouseleave",n[43])],o=!0)},p(u,d){if(d[0]&134217728&&c!==(c=u[27])){if(i){yt();const f=i;q(f.$$.fragment,1,0,()=>{ye(f,1)}),wt()}c?(i=h3(c,h(u)),be(i.$$.fragment),H(i.$$.fragment,1),xe(i,t,null)):i=null}else if(c){const f={};d[0]&1&&(f.id=u[0]),d[0]&2&&(f.source=u[1]),d[0]&4&&(f.target=u[2]),d[0]&16384&&(f.sourceX=u[14]),d[0]&32768&&(f.sourceY=u[15]),d[0]&65536&&(f.targetX=u[16]),d[0]&131072&&(f.targetY=u[17]),d[0]&262144&&(f.sourcePosition=u[18]),d[0]&524288&&(f.targetPosition=u[19]),d[0]&64&&(f.animated=u[6]),d[0]&128&&(f.selected=u[7]),d[0]&1024&&(f.label=u[10]),d[0]&2048&&(f.labelStyle=u[11]),d[0]&8&&(f.data=u[3]),d[0]&16&&(f.style=u[4]),d[0]&2097152&&(f.interactionWidth=u[21]),d[0]&16777216&&(f.selectable=u[24]),d[0]&256&&(f.deletable=u[8]??!0),d[0]&8388608&&(f.type=u[23]),d[0]&4096&&(f.sourceHandleId=u[12]),d[0]&8192&&(f.targetHandleId=u[13]),d[0]&67108864&&(f.markerStart=u[26]),d[0]&33554432&&(f.markerEnd=u[25]),i.$set(f)}(!a||d[0]&4194304&&s!==(s=Ii(["svelte-flow__edge",u[22]])))&&A(t,"class",s),(!a||d[0]&1)&&A(t,"data-id",u[0]),(!a||d[0]&1048582&&r!==(r=u[20]===null?void 0:u[20]?u[20]:`Edge from ${u[1]} to ${u[2]}`))&&A(t,"aria-label",r),(!a||d[0]&4194368)&&mn(t,"animated",u[6]),(!a||d[0]&4194432)&&mn(t,"selected",u[7]),(!a||d[0]&20971520)&&mn(t,"selectable",u[24]),d[0]&32&&tn(e,"z-index",u[5])},i(u){a||(i&&H(i.$$.fragment,u),a=!0)},o(u){i&&q(i.$$.fragment,u),a=!1},d(u){u&&E(e),i&&ye(i),o=!1,Zr(l)}}}function Uie(n){let e,t,i=!n[9]&&vS(n);return{c(){i&&i.c(),e=Xt()},l(s){i&&i.l(s),e=Xt()},m(s,r){i&&i.m(s,r),te(s,e,r),t=!0},p(s,r){s[9]?i&&(yt(),q(i,1,1,()=>{i=null}),wt()):i?(i.p(s,r),r[0]&512&&H(i,1)):(i=vS(s),i.c(),H(i,1),i.m(e.parentNode,e))},i(s){t||(H(i),t=!0)},o(s){q(i),t=!1},d(s){s&&E(e),i&&i.d(s)}}}function Hie(n,e,t){let i,s,r,a,o,l,c,h,u,{id:d}=e,{type:f="default"}=e,{source:g=""}=e,{target:m=""}=e,{data:x={}}=e,{style:p=void 0}=e,{zIndex:y=void 0}=e,{animated:w=!1}=e,{selected:v=!1}=e,{selectable:_=void 0}=e,{deletable:C=void 0}=e,{hidden:k=!1}=e,{label:I=void 0}=e,{labelStyle:S=void 0}=e,{markerStart:R=void 0}=e,{markerEnd:P=void 0}=e,{sourceHandle:D=void 0}=e,{targetHandle:U=void 0}=e,{sourceX:T}=e,{sourceY:G}=e,{targetX:M}=e,{targetY:F}=e,{sourcePosition:X}=e,{targetPosition:z}=e,{ariaLabel:K=void 0}=e,{interactionWidth:j=void 0}=e,{class:ae=""}=e;Ip("svelteflow__edge_id",d);const{edgeLookup:ge,edgeTypes:ue,flowId:pe,elementsSelectable:de}=es();Oe(n,ge,Q=>t(44,l=Q)),Oe(n,ue,Q=>t(40,u=Q)),Oe(n,pe,Q=>t(39,h=Q)),Oe(n,de,Q=>t(38,c=Q));const O=Ka(),Y=NO();function le(Q){const je=l.get(d);je&&(Y(d),O("edgeclick",{event:Q,edge:je}))}function $(Q,je){const Re=l.get(d);Re&&O(je,{event:Q,edge:Re})}const re=Q=>{$(Q,"edgecontextmenu")},oe=Q=>{$(Q,"edgemouseenter")},ee=Q=>{$(Q,"edgemouseleave")};return n.$$set=Q=>{"id"in Q&&t(0,d=Q.id),"type"in Q&&t(34,f=Q.type),"source"in Q&&t(1,g=Q.source),"target"in Q&&t(2,m=Q.target),"data"in Q&&t(3,x=Q.data),"style"in Q&&t(4,p=Q.style),"zIndex"in Q&&t(5,y=Q.zIndex),"animated"in Q&&t(6,w=Q.animated),"selected"in Q&&t(7,v=Q.selected),"selectable"in Q&&t(35,_=Q.selectable),"deletable"in Q&&t(8,C=Q.deletable),"hidden"in Q&&t(9,k=Q.hidden),"label"in Q&&t(10,I=Q.label),"labelStyle"in Q&&t(11,S=Q.labelStyle),"markerStart"in Q&&t(36,R=Q.markerStart),"markerEnd"in Q&&t(37,P=Q.markerEnd),"sourceHandle"in Q&&t(12,D=Q.sourceHandle),"targetHandle"in Q&&t(13,U=Q.targetHandle),"sourceX"in Q&&t(14,T=Q.sourceX),"sourceY"in Q&&t(15,G=Q.sourceY),"targetX"in Q&&t(16,M=Q.targetX),"targetY"in Q&&t(17,F=Q.targetY),"sourcePosition"in Q&&t(18,X=Q.sourcePosition),"targetPosition"in Q&&t(19,z=Q.targetPosition),"ariaLabel"in Q&&t(20,K=Q.ariaLabel),"interactionWidth"in Q&&t(21,j=Q.interactionWidth),"class"in Q&&t(22,ae=Q.class)},n.$$.update=()=>{n.$$.dirty[1]&8&&t(23,i=f||"default"),n.$$.dirty[0]&8388608|n.$$.dirty[1]&512&&t(27,s=u[i]||OO),n.$$.dirty[1]&288&&t(26,r=R?`url('#${X6(R,h)}')`:void 0),n.$$.dirty[1]&320&&t(25,a=P?`url('#${X6(P,h)}')`:void 0),n.$$.dirty[1]&144&&t(24,o=_??c)},[d,g,m,x,p,y,w,v,C,k,I,S,D,U,T,G,M,F,X,z,K,j,ae,i,o,a,r,s,ge,ue,pe,de,le,$,f,_,R,P,c,h,u,re,oe,ee]}class zie extends Ht{constructor(e){super(),zt(this,e,Hie,Uie,vI,{id:0,type:34,source:1,target:2,data:3,style:4,zIndex:5,animated:6,selected:7,selectable:35,deletable:8,hidden:9,label:10,labelStyle:11,markerStart:36,markerEnd:37,sourceHandle:12,targetHandle:13,sourceX:14,sourceY:15,targetX:16,targetY:17,sourcePosition:18,targetPosition:19,ariaLabel:20,interactionWidth:21,class:22},null,[-1,-1])}}function jie(n,e,t){let{onMount:i=void 0}=e,{onDestroy:s=void 0}=e;return ol(()=>(i==null||i(),s)),n.$$set=r=>{"onMount"in r&&t(0,i=r.onMount),"onDestroy"in r&&t(1,s=r.onDestroy)},[i,s]}class Gie extends Ht{constructor(e){super(),zt(this,e,jie,null,qt,{onMount:0,onDestroy:1})}}function _S(n,e,t){const i=n.slice();return i[2]=e[t],i}function kS(n,e){let t,i,s;const r=[e[2]];let a={};for(let o=0;o<r.length;o+=1)a=ai(a,r[o]);return i=new Zie({props:a}),{key:n,first:null,c(){t=Xt(),be(i.$$.fragment),this.h()},l(o){t=Xt(),ve(i.$$.fragment,o),this.h()},h(){this.first=t},m(o,l){te(o,t,l),xe(i,o,l),s=!0},p(o,l){e=o;const c=l&1?Nh(r,[Ep(e[2])]):{};i.$set(c)},i(o){s||(H(i.$$.fragment,o),s=!0)},o(o){q(i.$$.fragment,o),s=!1},d(o){o&&E(t),ye(i,o)}}}function Vie(n){let e,t=[],i=new Map,s,r=ni(n[0]);const a=o=>o[2].id;for(let o=0;o<r.length;o+=1){let l=_S(n,r,o),c=a(l);i.set(c,t[o]=kS(c,l))}return{c(){e=lt("defs");for(let o=0;o<t.length;o+=1)t[o].c()},l(o){e=ct(o,"defs",{});var l=V(e);for(let c=0;c<t.length;c+=1)t[c].l(l);l.forEach(E)},m(o,l){te(o,e,l);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);s=!0},p(o,[l]){l&1&&(r=ni(o[0]),yt(),t=j5(t,l,a,1,o,r,i,e,G5,kS,null,_S),wt())},i(o){if(!s){for(let l=0;l<r.length;l+=1)H(t[l]);s=!0}},o(o){for(let l=0;l<t.length;l+=1)q(t[l]);s=!1},d(o){o&&E(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function qie(n,e,t){let i;const{markers:s}=es();return Oe(n,s,r=>t(0,i=r)),[i,s]}class Wie extends Ht{constructor(e){super(),zt(this,e,qie,Vie,qt,{})}}function Kie(n){let e;return{c(){e=lt("polyline"),this.h()},l(t){e=ct(t,"polyline",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,fill:!0,points:!0}),V(e).forEach(E),this.h()},h(){A(e,"stroke",n[6]),A(e,"stroke-linecap","round"),A(e,"stroke-linejoin","round"),A(e,"stroke-width",n[7]),A(e,"fill",n[6]),A(e,"points","-5,-4 0,0 -5,4 -5,-4")},m(t,i){te(t,e,i)},p(t,i){i&64&&A(e,"stroke",t[6]),i&128&&A(e,"stroke-width",t[7]),i&64&&A(e,"fill",t[6])},d(t){t&&E(e)}}}function Xie(n){let e;return{c(){e=lt("polyline"),this.h()},l(t){e=ct(t,"polyline",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,fill:!0,points:!0}),V(e).forEach(E),this.h()},h(){A(e,"stroke",n[6]),A(e,"stroke-linecap","round"),A(e,"stroke-linejoin","round"),A(e,"stroke-width",n[7]),A(e,"fill","none"),A(e,"points","-5,-4 0,0 -5,4")},m(t,i){te(t,e,i)},p(t,i){i&64&&A(e,"stroke",t[6]),i&128&&A(e,"stroke-width",t[7])},d(t){t&&E(e)}}}function Yie(n){let e,t,i;function s(o,l){if(o[1]===s5.Arrow)return Xie;if(o[1]===s5.ArrowClosed)return Kie}let r=s(n),a=r&&r(n);return{c(){e=lt("marker"),a&&a.c(),this.h()},l(o){e=ct(o,"marker",{class:!0,id:!0,markerWidth:!0,markerHeight:!0,viewBox:!0,markerUnits:!0,orient:!0,refX:!0,refY:!0});var l=V(e);a&&a.l(l),l.forEach(E),this.h()},h(){A(e,"class","svelte-flow__arrowhead"),A(e,"id",n[0]),A(e,"markerWidth",t=`${n[2]}`),A(e,"markerHeight",i=`${n[3]}`),A(e,"viewBox","-10 -10 20 20"),A(e,"markerUnits",n[4]),A(e,"orient",n[5]),A(e,"refX","0"),A(e,"refY","0")},m(o,l){te(o,e,l),a&&a.m(e,null)},p(o,[l]){r===(r=s(o))&&a?a.p(o,l):(a&&a.d(1),a=r&&r(o),a&&(a.c(),a.m(e,null))),l&1&&A(e,"id",o[0]),l&4&&t!==(t=`${o[2]}`)&&A(e,"markerWidth",t),l&8&&i!==(i=`${o[3]}`)&&A(e,"markerHeight",i),l&16&&A(e,"markerUnits",o[4]),l&32&&A(e,"orient",o[5])},i:It,o:It,d(o){o&&E(e),a&&a.d()}}}function Jie(n,e,t){let{id:i}=e,{type:s}=e,{width:r=12.5}=e,{height:a=12.5}=e,{markerUnits:o="strokeWidth"}=e,{orient:l="auto-start-reverse"}=e,{color:c=void 0}=e,{strokeWidth:h=void 0}=e;return n.$$set=u=>{"id"in u&&t(0,i=u.id),"type"in u&&t(1,s=u.type),"width"in u&&t(2,r=u.width),"height"in u&&t(3,a=u.height),"markerUnits"in u&&t(4,o=u.markerUnits),"orient"in u&&t(5,l=u.orient),"color"in u&&t(6,c=u.color),"strokeWidth"in u&&t(7,h=u.strokeWidth)},[i,s,r,a,o,l,c,h]}class Zie extends Ht{constructor(e){super(),zt(this,e,Jie,Yie,qt,{id:0,type:1,width:2,height:3,markerUnits:4,orient:5,color:6,strokeWidth:7})}}function CS(n,e,t){const i=n.slice();return i[14]=e[t],i}function AS(n,e){let t,i,s;return i=new zie({props:{id:e[14].id,source:e[14].source,target:e[14].target,data:e[14].data,style:e[14].style,animated:e[14].animated,selected:e[14].selected,selectable:e[14].selectable??e[1],deletable:e[14].deletable,hidden:e[14].hidden,label:e[14].label,labelStyle:e[14].labelStyle,markerStart:e[14].markerStart,markerEnd:e[14].markerEnd,sourceHandle:e[14].sourceHandle,targetHandle:e[14].targetHandle,sourceX:e[14].sourceX,sourceY:e[14].sourceY,targetX:e[14].targetX,targetY:e[14].targetY,sourcePosition:e[14].sourcePosition,targetPosition:e[14].targetPosition,ariaLabel:e[14].ariaLabel,interactionWidth:e[14].interactionWidth,class:e[14].class,type:e[14].type||"default",zIndex:e[14].zIndex}}),i.$on("edgeclick",e[7]),i.$on("edgecontextmenu",e[8]),i.$on("edgemouseenter",e[9]),i.$on("edgemouseleave",e[10]),{key:n,first:null,c(){t=Xt(),be(i.$$.fragment),this.h()},l(r){t=Xt(),ve(i.$$.fragment,r),this.h()},h(){this.first=t},m(r,a){te(r,t,a),xe(i,r,a),s=!0},p(r,a){e=r;const o={};a&1&&(o.id=e[14].id),a&1&&(o.source=e[14].source),a&1&&(o.target=e[14].target),a&1&&(o.data=e[14].data),a&1&&(o.style=e[14].style),a&1&&(o.animated=e[14].animated),a&1&&(o.selected=e[14].selected),a&3&&(o.selectable=e[14].selectable??e[1]),a&1&&(o.deletable=e[14].deletable),a&1&&(o.hidden=e[14].hidden),a&1&&(o.label=e[14].label),a&1&&(o.labelStyle=e[14].labelStyle),a&1&&(o.markerStart=e[14].markerStart),a&1&&(o.markerEnd=e[14].markerEnd),a&1&&(o.sourceHandle=e[14].sourceHandle),a&1&&(o.targetHandle=e[14].targetHandle),a&1&&(o.sourceX=e[14].sourceX),a&1&&(o.sourceY=e[14].sourceY),a&1&&(o.targetX=e[14].targetX),a&1&&(o.targetY=e[14].targetY),a&1&&(o.sourcePosition=e[14].sourcePosition),a&1&&(o.targetPosition=e[14].targetPosition),a&1&&(o.ariaLabel=e[14].ariaLabel),a&1&&(o.interactionWidth=e[14].interactionWidth),a&1&&(o.class=e[14].class),a&1&&(o.type=e[14].type||"default"),a&1&&(o.zIndex=e[14].zIndex),i.$set(o)},i(r){s||(H(i.$$.fragment,r),s=!0)},o(r){q(i.$$.fragment,r),s=!1},d(r){r&&E(t),ye(i,r)}}}function SS(n){let e,t;return e=new Gie({props:{onMount:n[11],onDestroy:n[12]}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s&4&&(r.onMount=i[11]),s&4&&(r.onDestroy=i[12]),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Qie(n){let e,t,i,s,r=[],a=new Map,o,l;i=new Wie({});let c=ni(n[0]);const h=d=>d[14].id;for(let d=0;d<c.length;d+=1){let f=CS(n,c,d),g=h(f);a.set(g,r[d]=AS(g,f))}let u=n[0].length>0&&SS(n);return{c(){e=ie("div"),t=lt("svg"),be(i.$$.fragment),s=Se();for(let d=0;d<r.length;d+=1)r[d].c();o=Se(),u&&u.c(),this.h()},l(d){e=se(d,"DIV",{class:!0});var f=V(e);t=ct(f,"svg",{class:!0});var g=V(t);ve(i.$$.fragment,g),g.forEach(E),s=Ie(f);for(let m=0;m<r.length;m+=1)r[m].l(f);o=Ie(f),u&&u.l(f),f.forEach(E),this.h()},h(){A(t,"class","svelte-flow__marker"),A(e,"class","svelte-flow__edges")},m(d,f){te(d,e,f),W(e,t),xe(i,t,null),W(e,s);for(let g=0;g<r.length;g+=1)r[g]&&r[g].m(e,null);W(e,o),u&&u.m(e,null),l=!0},p(d,[f]){f&3&&(c=ni(d[0]),yt(),r=j5(r,f,h,1,d,c,a,e,G5,AS,o,CS),wt()),d[0].length>0?u?(u.p(d,f),f&1&&H(u,1)):(u=SS(d),u.c(),H(u,1),u.m(e,null)):u&&(yt(),q(u,1,1,()=>{u=null}),wt())},i(d){if(!l){H(i.$$.fragment,d);for(let f=0;f<c.length;f+=1)H(r[f]);H(u),l=!0}},o(d){q(i.$$.fragment,d);for(let f=0;f<r.length;f+=1)q(r[f]);q(u),l=!1},d(d){d&&E(e),ye(i);for(let f=0;f<r.length;f+=1)r[f].d();u&&u.d()}}}function $ie(n,e,t){let i,s,r,{defaultEdgeOptions:a}=e;const{visibleEdges:o,edgesInitialized:l,edges:{setDefaultOptions:c},elementsSelectable:h}=es();Oe(n,o,p=>t(0,i=p)),Oe(n,l,p=>t(2,r=p)),Oe(n,h,p=>t(1,s=p)),ol(()=>{a&&c(a)});function u(p){Yn.call(this,n,p)}function d(p){Yn.call(this,n,p)}function f(p){Yn.call(this,n,p)}function g(p){Yn.call(this,n,p)}const m=()=>{c3(l,r=!0,r)},x=()=>{c3(l,r=!1,r)};return n.$$set=p=>{"defaultEdgeOptions"in p&&t(6,a=p.defaultEdgeOptions)},[i,s,r,o,l,h,a,u,d,f,g,m,x]}class ese extends Ht{constructor(e){super(),zt(this,e,$ie,Qie,qt,{defaultEdgeOptions:6})}}function IS(n){let e;return{c(){e=ie("div"),this.h()},l(t){e=se(t,"DIV",{class:!0}),V(e).forEach(E),this.h()},h(){A(e,"class","svelte-flow__selection svelte-1iugwpu"),tn(e,"width",typeof n[2]=="string"?n[2]:`${n[2]}px`),tn(e,"height",typeof n[3]=="string"?n[3]:`${n[3]}px`),tn(e,"transform",`translate(${n[0]}px, ${n[1]}px)`)},m(t,i){te(t,e,i)},p(t,i){i&4&&tn(e,"width",typeof t[2]=="string"?t[2]:`${t[2]}px`),i&8&&tn(e,"height",typeof t[3]=="string"?t[3]:`${t[3]}px`),i&3&&tn(e,"transform",`translate(${t[0]}px, ${t[1]}px)`)},d(t){t&&E(e)}}}function tse(n){let e,t=n[4]&&IS(n);return{c(){t&&t.c(),e=Xt()},l(i){t&&t.l(i),e=Xt()},m(i,s){t&&t.m(i,s),te(i,e,s)},p(i,[s]){i[4]?t?t.p(i,s):(t=IS(i),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:It,o:It,d(i){i&&E(e),t&&t.d(i)}}}function nse(n,e,t){let{x:i=0}=e,{y:s=0}=e,{width:r=0}=e,{height:a=0}=e,{isVisible:o=!0}=e;return n.$$set=l=>{"x"in l&&t(0,i=l.x),"y"in l&&t(1,s=l.y),"width"in l&&t(2,r=l.width),"height"in l&&t(3,a=l.height),"isVisible"in l&&t(4,o=l.isVisible)},[i,s,r,a,o]}class UO extends Ht{constructor(e){super(),zt(this,e,nse,tse,qt,{x:0,y:1,width:2,height:3,isVisible:4})}}function ise(n){var i,s,r,a;let e,t;return e=new UO({props:{isVisible:!!(n[0]&&n[1]==="user"),width:(i=n[0])==null?void 0:i.width,height:(s=n[0])==null?void 0:s.height,x:(r=n[0])==null?void 0:r.x,y:(a=n[0])==null?void 0:a.y}}),{c(){be(e.$$.fragment)},l(o){ve(e.$$.fragment,o)},m(o,l){xe(e,o,l),t=!0},p(o,[l]){var h,u,d,f;const c={};l&3&&(c.isVisible=!!(o[0]&&o[1]==="user")),l&1&&(c.width=(h=o[0])==null?void 0:h.width),l&1&&(c.height=(u=o[0])==null?void 0:u.height),l&1&&(c.x=(d=o[0])==null?void 0:d.x),l&1&&(c.y=(f=o[0])==null?void 0:f.y),e.$set(c)},i(o){t||(H(e.$$.fragment,o),t=!0)},o(o){q(e.$$.fragment,o),t=!1},d(o){ye(e,o)}}}function sse(n,e,t){let i,s;const{selectionRect:r,selectionRectMode:a}=es();return Oe(n,r,o=>t(0,i=o)),Oe(n,a,o=>t(1,s=o)),[i,s,r,a]}class rse extends Ht{constructor(e){super(),zt(this,e,sse,ise,qt,{})}}function ES(n){let e,t,i,s,r;return t=new UO({props:{width:"100%",height:"100%",x:0,y:0}}),{c(){e=ie("div"),be(t.$$.fragment),this.h()},l(a){e=se(a,"DIV",{class:!0,style:!0,role:!0,tabindex:!0});var o=V(e);ve(t.$$.fragment,o),o.forEach(E),this.h()},h(){A(e,"class","selection-wrapper nopan svelte-5pxri"),tn(e,"width",n[1].width+"px"),tn(e,"height",n[1].height+"px"),tn(e,"transform","translate("+n[1].x+"px, "+n[1].y+"px)"),A(e,"role","button"),A(e,"tabindex","-1")},m(a,o){te(a,e,o),xe(t,e,null),i=!0,s||(r=[ra(BO.call(null,e,{disabled:!1,store:n[2],onDrag:n[11],onDragStart:n[12],onDragStop:n[13]})),xt(e,"contextmenu",n[7]),xt(e,"click",n[8]),xt(e,"keyup",ose)],s=!0)},p(a,o){(!i||o&2)&&tn(e,"width",a[1].width+"px"),(!i||o&2)&&tn(e,"height",a[1].height+"px"),(!i||o&2)&&tn(e,"transform","translate("+a[1].x+"px, "+a[1].y+"px)")},i(a){i||(H(t.$$.fragment,a),i=!0)},o(a){q(t.$$.fragment,a),i=!1},d(a){a&&E(e),ye(t),s=!1,Zr(r)}}}function ase(n){let e=n[0]==="nodes"&&n[1]&&Zo(n[1].x)&&Zo(n[1].y),t,i,s=e&&ES(n);return{c(){s&&s.c(),t=Xt()},l(r){s&&s.l(r),t=Xt()},m(r,a){s&&s.m(r,a),te(r,t,a),i=!0},p(r,[a]){a&3&&(e=r[0]==="nodes"&&r[1]&&Zo(r[1].x)&&Zo(r[1].y)),e?s?(s.p(r,a),a&3&&H(s,1)):(s=ES(r),s.c(),H(s,1),s.m(t.parentNode,t)):s&&(yt(),q(s,1,1,()=>{s=null}),wt())},i(r){i||(H(s),i=!0)},o(r){q(s),i=!1},d(r){r&&E(t),s&&s.d(r)}}}const ose=()=>{};function lse(n,e,t){let i,s,r;const a=es(),{selectionRectMode:o,nodes:l,nodeLookup:c}=a;Oe(n,o,p=>t(0,r=p)),Oe(n,l,p=>t(9,i=p)),Oe(n,c,p=>t(10,s=p));const h=Ka();let u=null;function d(p){const y=i.filter(w=>w.selected);h("selectioncontextmenu",{nodes:y,event:p})}function f(p){const y=i.filter(w=>w.selected);h("selectionclick",{nodes:y,event:p})}const g=(p,y,w,v)=>{h("nodedrag",{event:p,targetNode:null,nodes:v})},m=(p,y,w,v)=>{h("nodedragstart",{event:p,targetNode:null,nodes:v})},x=(p,y,w,v)=>{h("nodedragstop",{event:p,targetNode:null,nodes:v})};return n.$$.update=()=>{n.$$.dirty&1537&&r==="nodes"&&t(1,u=Ey(s,{filter:p=>!!p.selected}))},[r,u,a,o,l,c,h,d,f,i,s,g,m,x]}class cse extends Ht{constructor(e){super(),zt(this,e,lse,ase,qt,{})}}function yl(n,e){let{enabled:t=!0,trigger:i,type:s="keydown"}=e;function r(a){const o=Array.isArray(i)?i:[i],l={alt:a.altKey,ctrl:a.ctrlKey,shift:a.shiftKey,meta:a.metaKey};for(const c of o){const h={modifier:[],preventDefault:!1,enabled:!0,...c},{modifier:u,key:d,callback:f,preventDefault:g,enabled:m}=h;if(m){if(u.length&&!(Array.isArray(u)?u:[u]).map(y=>typeof y=="string"?[y]:y).some(y=>y.every(w=>l[w])))continue;if(a.key===d){g&&a.preventDefault();const x={node:n,trigger:h,originalEvent:a};n.dispatchEvent(new CustomEvent("shortcut",{detail:x})),f==null||f(x)}}}}return t&&n.addEventListener(s,r),{update:a=>{const{enabled:o=!0,type:l="keydown"}=a;t&&(!o||s!==l)?n.removeEventListener(s,r):!t&&o&&n.addEventListener(l,r),t=o,s=l,i=a.trigger},destroy:()=>{n.removeEventListener(s,r)}}}function hse(n){let e,t,i,s,r,a,o,l,c,h,u,d;return{c:It,l:It,m(f,g){u||(d=[ra(e=yl.call(null,window,{trigger:hs(n[0],n[11]),type:"keydown"})),ra(t=yl.call(null,window,{trigger:hs(n[0],n[12]),type:"keyup"})),ra(i=yl.call(null,window,{trigger:hs(n[1],n[13]),type:"keydown"})),ra(s=yl.call(null,window,{trigger:hs(n[1],n[14]),type:"keyup"})),ra(r=yl.call(null,window,{trigger:hs(n[2],n[15]),type:"keydown"})),ra(a=yl.call(null,window,{trigger:hs(n[2],n[16]),type:"keyup"})),ra(o=yl.call(null,window,{trigger:hs(n[3],n[17]),type:"keydown"})),ra(l=yl.call(null,window,{trigger:hs(n[3],n[18]),type:"keyup"})),ra(c=yl.call(null,window,{trigger:hs(n[4],n[19]),type:"keydown"})),ra(h=yl.call(null,window,{trigger:hs(n[4],n[20]),type:"keyup"})),xt(window,"blur",n[10]),xt(window,"contextmenu",n[10])],u=!0)},p(f,[g]){e&&Ds(e.update)&&g&1&&e.update.call(null,{trigger:hs(f[0],f[11]),type:"keydown"}),t&&Ds(t.update)&&g&1&&t.update.call(null,{trigger:hs(f[0],f[12]),type:"keyup"}),i&&Ds(i.update)&&g&2&&i.update.call(null,{trigger:hs(f[1],f[13]),type:"keydown"}),s&&Ds(s.update)&&g&2&&s.update.call(null,{trigger:hs(f[1],f[14]),type:"keyup"}),r&&Ds(r.update)&&g&4&&r.update.call(null,{trigger:hs(f[2],f[15]),type:"keydown"}),a&&Ds(a.update)&&g&4&&a.update.call(null,{trigger:hs(f[2],f[16]),type:"keyup"}),o&&Ds(o.update)&&g&8&&o.update.call(null,{trigger:hs(f[3],f[17]),type:"keydown"}),l&&Ds(l.update)&&g&8&&l.update.call(null,{trigger:hs(f[3],f[18]),type:"keyup"}),c&&Ds(c.update)&&g&16&&c.update.call(null,{trigger:hs(f[4],f[19]),type:"keydown"}),h&&Ds(h.update)&&g&16&&h.update.call(null,{trigger:hs(f[4],f[20]),type:"keyup"})},i:It,o:It,d(f){u=!1,Zr(d)}}}function HO(n){return n!==null&&typeof n=="object"}function use(n){return HO(n)?n.modifier||[]:[]}function dse(n){return n==null?"":HO(n)?n.key:n}function hs(n,e){return(Array.isArray(n)?n:[n]).map(i=>{const s=dse(i);return{key:s,modifier:use(i),enabled:s!==null,callback:e}})}function fse(n,e,t){let{selectionKey:i="Shift"}=e,{multiSelectionKey:s=a5()?"Meta":"Control"}=e,{deleteKey:r="Backspace"}=e,{panActivationKey:a=" "}=e,{zoomActivationKey:o=a5()?"Meta":"Control"}=e;const{selectionKeyPressed:l,multiselectionKeyPressed:c,deleteKeyPressed:h,panActivationKeyPressed:u,zoomActivationKeyPressed:d,selectionRect:f}=es();function g(){f.set(null),l.set(!1),c.set(!1),h.set(!1),u.set(!1),d.set(!1)}const m=()=>l.set(!0),x=()=>l.set(!1),p=()=>c.set(!0),y=()=>c.set(!1),w=S=>{!(S.originalEvent.ctrlKey||S.originalEvent.metaKey||S.originalEvent.shiftKey)&&!Jte(S.originalEvent)&&h.set(!0)},v=()=>h.set(!1),_=()=>u.set(!0),C=()=>u.set(!1),k=()=>d.set(!0),I=()=>d.set(!1);return n.$$set=S=>{"selectionKey"in S&&t(0,i=S.selectionKey),"multiSelectionKey"in S&&t(1,s=S.multiSelectionKey),"deleteKey"in S&&t(2,r=S.deleteKey),"panActivationKey"in S&&t(3,a=S.panActivationKey),"zoomActivationKey"in S&&t(4,o=S.zoomActivationKey)},[i,s,r,a,o,l,c,h,u,d,g,m,x,p,y,w,v,_,C,k,I]}class gse extends Ht{constructor(e){super(),zt(this,e,fse,hse,qt,{selectionKey:0,multiSelectionKey:1,deleteKey:2,panActivationKey:3,zoomActivationKey:4})}}const mse=n=>({}),TS=n=>({});function RS(n){let e,t,i,s;const r=n[13].connectionLine,a=zs(r,n,n[12],TS);let o=!n[2]&&MS(n);return{c(){e=lt("svg"),t=lt("g"),a&&a.c(),o&&o.c(),this.h()},l(l){e=ct(l,"svg",{width:!0,height:!0,class:!0,style:!0});var c=V(e);t=ct(c,"g",{class:!0});var h=V(t);a&&a.l(h),o&&o.l(h),h.forEach(E),c.forEach(E),this.h()},h(){A(t,"class",i=Ii(["svelte-flow__connection",eS(n[3].isValid)])),A(e,"width",n[5]),A(e,"height",n[6]),A(e,"class","svelte-flow__connectionline"),A(e,"style",n[0])},m(l,c){te(l,e,c),W(e,t),a&&a.m(t,null),o&&o.m(t,null),s=!0},p(l,c){a&&a.p&&(!s||c&4096)&&js(a,r,l,l[12],s?Vs(r,l[12],c,mse):Gs(l[12]),TS),l[2]?o&&(o.d(1),o=null):o?o.p(l,c):(o=MS(l),o.c(),o.m(t,null)),(!s||c&8&&i!==(i=Ii(["svelte-flow__connection",eS(l[3].isValid)])))&&A(t,"class",i),(!s||c&32)&&A(e,"width",l[5]),(!s||c&64)&&A(e,"height",l[6]),(!s||c&1)&&A(e,"style",l[0])},i(l){s||(H(a,l),s=!0)},o(l){q(a,l),s=!1},d(l){l&&E(e),a&&a.d(l),o&&o.d()}}}function MS(n){let e;return{c(){e=lt("path"),this.h()},l(t){e=ct(t,"path",{d:!0,style:!0,fill:!0,class:!0}),V(e).forEach(E),this.h()},h(){A(e,"d",n[4]),A(e,"style",n[1]),A(e,"fill","none"),A(e,"class","svelte-flow__connection-path")},m(t,i){te(t,e,i)},p(t,i){i&16&&A(e,"d",t[4]),i&2&&A(e,"style",t[1])},d(t){t&&E(e)}}}function pse(n){let e,t,i=n[3].inProgress&&RS(n);return{c(){i&&i.c(),e=Xt()},l(s){i&&i.l(s),e=Xt()},m(s,r){i&&i.m(s,r),te(s,e,r),t=!0},p(s,[r]){s[3].inProgress?i?(i.p(s,r),r&8&&H(i,1)):(i=RS(s),i.c(),H(i,1),i.m(e.parentNode,e)):i&&(yt(),q(i,1,1,()=>{i=null}),wt())},i(s){t||(H(i),t=!0)},o(s){q(i),t=!1},d(s){s&&E(e),i&&i.d(s)}}}function bse(n,e,t){let i,s,r,a,{$$slots:o={},$$scope:l}=e,{containerStyle:c=""}=e,{style:h=""}=e,{isCustomComponent:u=!1}=e;const{width:d,height:f,connection:g,connectionLineType:m}=es();Oe(n,d,p=>t(5,r=p)),Oe(n,f,p=>t(6,a=p)),Oe(n,g,p=>t(3,s=p)),Oe(n,m,p=>t(11,i=p));let x=null;return n.$$set=p=>{"containerStyle"in p&&t(0,c=p.containerStyle),"style"in p&&t(1,h=p.style),"isCustomComponent"in p&&t(2,u=p.isCustomComponent),"$$scope"in p&&t(12,l=p.$$scope)},n.$$.update=()=>{if(n.$$.dirty&2060&&s.inProgress&&!u){const{from:p,to:y,fromPosition:w,toPosition:v}=s,_={sourceX:p.x,sourceY:p.y,sourcePosition:w,targetX:y.x,targetY:y.y,targetPosition:v};switch(i){case r1.Bezier:t(4,[x]=pO(_),x);break;case r1.Step:t(4,[x]=o5({..._,borderRadius:0}),x);break;case r1.SmoothStep:t(4,[x]=o5(_),x);break;default:t(4,[x]=xO(_),x)}}},[c,h,u,s,x,r,a,d,f,g,m,i,l,o]}class xse extends Ht{constructor(e){super(),zt(this,e,bse,pse,qt,{containerStyle:0,style:1,isCustomComponent:2})}}function yse(n){let e,t,i;const s=n[8].default,r=zs(s,n,n[7],null);let a=[{class:t=Ii(["svelte-flow__panel",n[1],...n[2]])},{style:n[0]},n[5]],o={};for(let l=0;l<a.length;l+=1)o=ai(o,a[l]);return{c(){e=ie("div"),r&&r.c(),this.h()},l(l){e=se(l,"DIV",{class:!0,style:!0});var c=V(e);r&&r.l(c),c.forEach(E),this.h()},h(){vg(e,o),tn(e,"pointer-events",n[3]?"none":"")},m(l,c){te(l,e,c),r&&r.m(e,null),i=!0},p(l,[c]){r&&r.p&&(!i||c&128)&&js(r,s,l,l[7],i?Vs(s,l[7],c,null):Gs(l[7]),null),vg(e,o=Nh(a,[(!i||c&6&&t!==(t=Ii(["svelte-flow__panel",l[1],...l[2]])))&&{class:t},(!i||c&1)&&{style:l[0]},c&32&&l[5]])),tn(e,"pointer-events",l[3]?"none":"")},i(l){i||(H(r,l),i=!0)},o(l){q(r,l),i=!1},d(l){l&&E(e),r&&r.d(l)}}}function wse(n,e,t){let i;const s=["position","style","class"];let r=Qi(e,s),a,{$$slots:o={},$$scope:l}=e,{position:c="top-right"}=e,{style:h=void 0}=e,{class:u=void 0}=e;const{selectionRectMode:d}=es();return Oe(n,d,f=>t(3,a=f)),n.$$set=f=>{e=ai(ai({},e),ll(f)),t(5,r=Qi(e,s)),"position"in f&&t(6,c=f.position),"style"in f&&t(0,h=f.style),"class"in f&&t(1,u=f.class),"$$scope"in f&&t(7,l=f.$$scope)},n.$$.update=()=>{n.$$.dirty&64&&t(2,i=`${c}`.split("-"))},[h,u,i,a,d,r,c,l,o]}class zO extends Ht{constructor(e){super(),zt(this,e,wse,yse,qt,{position:6,style:0,class:1})}}function PS(n){let e,t;return e=new zO({props:{position:n[1],class:"svelte-flow__attribution","data-message":"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us",$$slots:{default:[vse]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s&2&&(r.position=i[1]),s&4&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function vse(n){let e,t="Svelte Flow";return{c(){e=ie("a"),e.textContent=t,this.h()},l(i){e=se(i,"A",{href:!0,target:!0,rel:!0,"aria-label":!0,"data-svelte-h":!0}),_o(e)!=="svelte-2vm8e4"&&(e.textContent=t),this.h()},h(){A(e,"href","https://svelteflow.dev"),A(e,"target","_blank"),A(e,"rel","noopener noreferrer"),A(e,"aria-label","Svelte Flow attribution")},m(i,s){te(i,e,s)},p:It,d(i){i&&E(e)}}}function _se(n){var s;let e,t,i=!((s=n[0])!=null&&s.hideAttribution)&&PS(n);return{c(){i&&i.c(),e=Xt()},l(r){i&&i.l(r),e=Xt()},m(r,a){i&&i.m(r,a),te(r,e,a),t=!0},p(r,[a]){var o;(o=r[0])!=null&&o.hideAttribution?i&&(yt(),q(i,1,1,()=>{i=null}),wt()):i?(i.p(r,a),a&1&&H(i,1)):(i=PS(r),i.c(),H(i,1),i.m(e.parentNode,e))},i(r){t||(H(i),t=!0)},o(r){q(i),t=!1},d(r){r&&E(e),i&&i.d(r)}}}function kse(n,e,t){let{proOptions:i=void 0}=e,{position:s="bottom-right"}=e;return n.$$set=r=>{"proOptions"in r&&t(0,i=r.proOptions),"position"in r&&t(1,s=r.position)},[i,s]}class Cse extends Ht{constructor(e){super(),zt(this,e,kse,_se,qt,{proOptions:0,position:1})}}function NS(n,{nodeTypes:e,edgeTypes:t,minZoom:i,maxZoom:s,translateExtent:r,paneClickDistance:a}){e!==void 0&&n.setNodeTypes(e),t!==void 0&&n.setEdgeTypes(t),i!==void 0&&n.setMinZoom(i),s!==void 0&&n.setMaxZoom(s),r!==void 0&&n.setTranslateExtent(r),a!==void 0&&n.setPaneClickDistance(a)}const Ase=n=>Object.keys(n);function Sse(n,e){Ase(e).forEach(t=>{const i=e[t];i!==void 0&&n[t].set(i)})}function Ise(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Ese(n="light"){return Io("light",t=>{if(n!=="system"){t(n);return}const i=Ise(),s=()=>t(i!=null&&i.matches?"dark":"light");return t(i!=null&&i.matches?"dark":"light"),i==null||i.addEventListener("change",s),()=>{i==null||i.removeEventListener("change",s)}})}const Tse=n=>({}),OS=n=>({slot:"connectionLine"});function Rse(n){let e;const t=n[75].connectionLine,i=zs(t,n,n[99],OS);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r[3]&64)&&js(i,t,s,s[99],e?Vs(t,s[99],r,Tse):Gs(s[99]),OS)},i(s){e||(H(i,s),e=!0)},o(s){q(i,s),e=!1},d(s){i&&i.d(s)}}}function Mse(n){let e,t,i,s,r,a,o,l,c,h,u,d;return e=new ese({props:{defaultEdgeOptions:n[21]}}),e.$on("edgeclick",n[78]),e.$on("edgecontextmenu",n[79]),e.$on("edgemouseenter",n[80]),e.$on("edgemouseleave",n[81]),i=new xse({props:{containerStyle:n[7],style:n[6],isCustomComponent:n[34].connectionLine,$$slots:{connectionLine:[Rse]},$$scope:{ctx:n}}}),c=new Bie({props:{nodeClickDistance:n[23]}}),c.$on("nodeclick",n[82]),c.$on("nodemouseenter",n[83]),c.$on("nodemousemove",n[84]),c.$on("nodemouseleave",n[85]),c.$on("nodedragstart",n[86]),c.$on("nodedrag",n[87]),c.$on("nodedragstop",n[88]),c.$on("nodecontextmenu",n[89]),u=new cse({}),u.$on("selectionclick",n[90]),u.$on("selectioncontextmenu",n[91]),u.$on("nodedragstart",n[92]),u.$on("nodedrag",n[93]),u.$on("nodedragstop",n[94]),{c(){be(e.$$.fragment),t=Se(),be(i.$$.fragment),s=Se(),r=ie("div"),a=Se(),o=ie("div"),l=Se(),be(c.$$.fragment),h=Se(),be(u.$$.fragment),this.h()},l(f){ve(e.$$.fragment,f),t=Ie(f),ve(i.$$.fragment,f),s=Ie(f),r=se(f,"DIV",{class:!0}),V(r).forEach(E),a=Ie(f),o=se(f,"DIV",{class:!0}),V(o).forEach(E),l=Ie(f),ve(c.$$.fragment,f),h=Ie(f),ve(u.$$.fragment,f),this.h()},h(){A(r,"class","svelte-flow__edgelabel-renderer"),A(o,"class","svelte-flow__viewport-portal")},m(f,g){xe(e,f,g),te(f,t,g),xe(i,f,g),te(f,s,g),te(f,r,g),te(f,a,g),te(f,o,g),te(f,l,g),xe(c,f,g),te(f,h,g),xe(u,f,g),d=!0},p(f,g){const m={};g[0]&2097152&&(m.defaultEdgeOptions=f[21]),e.$set(m);const x={};g[0]&128&&(x.containerStyle=f[7]),g[0]&64&&(x.style=f[6]),g[1]&8&&(x.isCustomComponent=f[34].connectionLine),g[3]&64&&(x.$$scope={dirty:g,ctx:f}),i.$set(x);const p={};g[0]&8388608&&(p.nodeClickDistance=f[23]),c.$set(p)},i(f){d||(H(e.$$.fragment,f),H(i.$$.fragment,f),H(c.$$.fragment,f),H(u.$$.fragment,f),d=!0)},o(f){q(e.$$.fragment,f),q(i.$$.fragment,f),q(c.$$.fragment,f),q(u.$$.fragment,f),d=!1},d(f){f&&(E(t),E(s),E(r),E(a),E(o),E(l),E(h)),ye(e,f),ye(i,f),ye(c,f),ye(u,f)}}}function Pse(n){let e,t,i,s;return e=new Rie({props:{$$slots:{default:[Mse]},$$scope:{ctx:n}}}),i=new rse({}),{c(){be(e.$$.fragment),t=Se(),be(i.$$.fragment)},l(r){ve(e.$$.fragment,r),t=Ie(r),ve(i.$$.fragment,r)},m(r,a){xe(e,r,a),te(r,t,a),xe(i,r,a),s=!0},p(r,a){const o={};a[0]&10485952|a[1]&8|a[3]&64&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){s||(H(e.$$.fragment,r),H(i.$$.fragment,r),s=!0)},o(r){q(e.$$.fragment,r),q(i.$$.fragment,r),s=!1},d(r){r&&E(t),ye(e,r),ye(i,r)}}}function Nse(n){let e,t;return e=new Iie({props:{panOnDrag:n[17]===void 0?!0:n[17],selectionOnDrag:n[18],$$slots:{default:[Pse]},$$scope:{ctx:n}}}),e.$on("paneclick",n[95]),e.$on("panecontextmenu",n[96]),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&131072&&(r.panOnDrag=i[17]===void 0?!0:i[17]),s[0]&262144&&(r.selectionOnDrag=i[18]),s[0]&10485952|s[1]&8|s[3]&64&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Ose(n){let e,t,i,s,r,a,o,l,c,h,u,d;t=new gse({props:{selectionKey:n[1],deleteKey:n[5],panActivationKey:n[2],multiSelectionKey:n[3],zoomActivationKey:n[4]}}),s=new Cie({props:{initialViewport:n[31],onMoveStart:n[8],onMove:n[9],onMoveEnd:n[10],panOnScrollMode:n[11]===void 0?tc.Free:n[11],preventScrolling:n[12]===void 0?!0:n[12],zoomOnScroll:n[13]===void 0?!0:n[13],zoomOnDoubleClick:n[14]===void 0?!0:n[14],zoomOnPinch:n[15]===void 0?!0:n[15],panOnScroll:n[16]===void 0?!1:n[16],panOnDrag:n[17]===void 0?!0:n[17],paneClickDistance:n[22]===void 0?0:n[22],$$slots:{default:[Nse]},$$scope:{ctx:n}}}),a=new Cse({props:{proOptions:n[20],position:n[19]}});const f=n[75].default,g=zs(f,n,n[99],null);let m=[{style:n[24]},{class:l=Ii(["svelte-flow",n[25],n[30]])},{"data-testid":"svelte-flow__wrapper"},n[33],{role:"application"}],x={};for(let p=0;p<m.length;p+=1)x=ai(x,m[p]);return{c(){e=ie("div"),be(t.$$.fragment),i=Se(),be(s.$$.fragment),r=Se(),be(a.$$.fragment),o=Se(),g&&g.c(),this.h()},l(p){e=se(p,"DIV",{style:!0,class:!0,"data-testid":!0,role:!0});var y=V(e);ve(t.$$.fragment,y),i=Ie(y),ve(s.$$.fragment,y),r=Ie(y),ve(a.$$.fragment,y),o=Ie(y),g&&g.l(y),y.forEach(E),this.h()},h(){vg(e,x),Rh(()=>n[98].call(e)),mn(e,"svelte-12wlba6",!0)},m(p,y){te(p,e,y),xe(t,e,null),W(e,i),xe(s,e,null),W(e,r),xe(a,e,null),W(e,o),g&&g.m(e,null),n[97](e),c=YO(e,n[98].bind(e)),h=!0,u||(d=[xt(e,"dragover",n[76]),xt(e,"drop",n[77])],u=!0)},p(p,y){const w={};y[0]&2&&(w.selectionKey=p[1]),y[0]&32&&(w.deleteKey=p[5]),y[0]&4&&(w.panActivationKey=p[2]),y[0]&8&&(w.multiSelectionKey=p[3]),y[0]&16&&(w.zoomActivationKey=p[4]),t.$set(w);const v={};y[0]&256&&(v.onMoveStart=p[8]),y[0]&512&&(v.onMove=p[9]),y[0]&1024&&(v.onMoveEnd=p[10]),y[0]&2048&&(v.panOnScrollMode=p[11]===void 0?tc.Free:p[11]),y[0]&4096&&(v.preventScrolling=p[12]===void 0?!0:p[12]),y[0]&8192&&(v.zoomOnScroll=p[13]===void 0?!0:p[13]),y[0]&16384&&(v.zoomOnDoubleClick=p[14]===void 0?!0:p[14]),y[0]&32768&&(v.zoomOnPinch=p[15]===void 0?!0:p[15]),y[0]&65536&&(v.panOnScroll=p[16]===void 0?!1:p[16]),y[0]&131072&&(v.panOnDrag=p[17]===void 0?!0:p[17]),y[0]&4194304&&(v.paneClickDistance=p[22]===void 0?0:p[22]),y[0]&10879168|y[1]&8|y[3]&64&&(v.$$scope={dirty:y,ctx:p}),s.$set(v);const _={};y[0]&1048576&&(_.proOptions=p[20]),y[0]&524288&&(_.position=p[19]),a.$set(_),g&&g.p&&(!h||y[3]&64)&&js(g,f,p,p[99],h?Vs(f,p[99],y,null):Gs(p[99]),null),vg(e,x=Nh(m,[(!h||y[0]&16777216)&&{style:p[24]},(!h||y[0]&1107296256&&l!==(l=Ii(["svelte-flow",p[25],p[30]])))&&{class:l},{"data-testid":"svelte-flow__wrapper"},y[1]&4&&p[33],{role:"application"}])),mn(e,"svelte-12wlba6",!0)},i(p){h||(H(t.$$.fragment,p),H(s.$$.fragment,p),H(a.$$.fragment,p),H(g,p),h=!0)},o(p){q(t.$$.fragment,p),q(s.$$.fragment,p),q(a.$$.fragment,p),q(g,p),h=!1},d(p){p&&E(e),ye(t),ye(s),ye(a),g&&g.d(p),n[97](null),c(),u=!1,Zr(d)}}}function Dse(n,e,t){let i;const s=["id","nodes","edges","fitView","fitViewOptions","minZoom","maxZoom","initialViewport","viewport","nodeTypes","edgeTypes","selectionKey","selectionMode","panActivationKey","multiSelectionKey","zoomActivationKey","nodesDraggable","nodesConnectable","nodeDragThreshold","elementsSelectable","snapGrid","deleteKey","connectionRadius","connectionLineType","connectionMode","connectionLineStyle","connectionLineContainerStyle","onMoveStart","onMove","onMoveEnd","isValidConnection","translateExtent","nodeExtent","onlyRenderVisibleElements","panOnScrollMode","preventScrolling","zoomOnScroll","zoomOnDoubleClick","zoomOnPinch","panOnScroll","panOnDrag","selectionOnDrag","autoPanOnConnect","autoPanOnNodeDrag","onerror","ondelete","onedgecreate","attributionPosition","proOptions","defaultEdgeOptions","width","height","colorMode","onconnect","onconnectstart","onconnectend","onbeforedelete","oninit","nodeOrigin","paneClickDistance","nodeClickDistance","defaultMarkerColor","style","class"];let r=Qi(e,s),a,o,l=It,c=()=>(l(),l=$v(I,ke=>t(100,o=ke)),I),h,u=It,d=()=>(u(),u=$v(i,ke=>t(30,h=ke)),i);n.$$.on_destroy.push(()=>l()),n.$$.on_destroy.push(()=>u());let{$$slots:f={},$$scope:g}=e;const m=JO(f);let{id:x="1"}=e,{nodes:p}=e,{edges:y}=e,{fitView:w=void 0}=e,{fitViewOptions:v=void 0}=e,{minZoom:_=void 0}=e,{maxZoom:C=void 0}=e,{initialViewport:k=void 0}=e,{viewport:I=void 0}=e;c();let{nodeTypes:S=void 0}=e,{edgeTypes:R=void 0}=e,{selectionKey:P=void 0}=e,{selectionMode:D=void 0}=e,{panActivationKey:U=void 0}=e,{multiSelectionKey:T=void 0}=e,{zoomActivationKey:G=void 0}=e,{nodesDraggable:M=void 0}=e,{nodesConnectable:F=void 0}=e,{nodeDragThreshold:X=void 0}=e,{elementsSelectable:z=void 0}=e,{snapGrid:K=void 0}=e,{deleteKey:j=void 0}=e,{connectionRadius:ae=void 0}=e,{connectionLineType:ge=void 0}=e,{connectionMode:ue=ef.Strict}=e,{connectionLineStyle:pe=""}=e,{connectionLineContainerStyle:de=""}=e,{onMoveStart:O=void 0}=e,{onMove:Y=void 0}=e,{onMoveEnd:le=void 0}=e,{isValidConnection:$=void 0}=e,{translateExtent:re=void 0}=e,{nodeExtent:oe=void 0}=e,{onlyRenderVisibleElements:ee=void 0}=e,{panOnScrollMode:Q=tc.Free}=e,{preventScrolling:je=!0}=e,{zoomOnScroll:Re=!0}=e,{zoomOnDoubleClick:Ne=!0}=e,{zoomOnPinch:He=!0}=e,{panOnScroll:Be=!1}=e,{panOnDrag:Je=!0}=e,{selectionOnDrag:ht=void 0}=e,{autoPanOnConnect:ot=!0}=e,{autoPanOnNodeDrag:Ye=!0}=e,{onerror:rt=void 0}=e,{ondelete:me=void 0}=e,{onedgecreate:Mt=void 0}=e,{attributionPosition:ut=void 0}=e,{proOptions:dt=void 0}=e,{defaultEdgeOptions:Ve=void 0}=e,{width:Ot=void 0}=e,{height:rn=void 0}=e,{colorMode:Me="light"}=e,{onconnect:Dt=void 0}=e,{onconnectstart:gt=void 0}=e,{onconnectend:jt=void 0}=e,{onbeforedelete:Fn=void 0}=e,{oninit:Kn=void 0}=e,{nodeOrigin:ci=void 0}=e,{paneClickDistance:ji=0}=e,{nodeClickDistance:xs=0}=e,{defaultMarkerColor:hi="#b1b1b7"}=e,{style:qi=void 0}=e,{class:ys=void 0}=e,ki,Tr,Ks;const Ss=o||k,De=ZO(Ny)?es():wie({nodes:Qe(p),edges:Qe(y),width:Ot,height:rn,fitView:w,nodeOrigin:ci,nodeExtent:oe});ol(()=>(De.width.set(Tr),De.height.set(Ks),De.domNode.set(ki),De.syncNodeStores(p),De.syncEdgeStores(y),De.syncViewport(I),w!==void 0&&De.fitViewOnInit.set(w),v&&De.fitViewOptions.set(v),NS(De,{nodeTypes:S,edgeTypes:R,minZoom:_,maxZoom:C,translateExtent:re,paneClickDistance:ji}),()=>{De.reset()}));const{initialized:qe}=De;Oe(n,qe,ke=>t(74,a=ke));let ft=!1;function Vt(ke){Yn.call(this,n,ke)}function sn(ke){Yn.call(this,n,ke)}function Bn(ke){Yn.call(this,n,ke)}function Cn(ke){Yn.call(this,n,ke)}function Un(ke){Yn.call(this,n,ke)}function zn(ke){Yn.call(this,n,ke)}function dl(ke){Yn.call(this,n,ke)}function fr(ke){Yn.call(this,n,ke)}function Qg(ke){Yn.call(this,n,ke)}function $g(ke){Yn.call(this,n,ke)}function em(ke){Yn.call(this,n,ke)}function tm(ke){Yn.call(this,n,ke)}function nm(ke){Yn.call(this,n,ke)}function im(ke){Yn.call(this,n,ke)}function sm(ke){Yn.call(this,n,ke)}function rm(ke){Yn.call(this,n,ke)}function am(ke){Yn.call(this,n,ke)}function om(ke){Yn.call(this,n,ke)}function lm(ke){Yn.call(this,n,ke)}function cm(ke){Yn.call(this,n,ke)}function hm(ke){Yn.call(this,n,ke)}function um(ke){Et[ke?"unshift":"push"](()=>{ki=ke,t(28,ki)})}function dm(){Tr=this.clientWidth,Ks=this.clientHeight,t(26,Tr),t(27,Ks)}return n.$$set=ke=>{e=ai(ai({},e),ll(ke)),t(33,r=Qi(e,s)),"id"in ke&&t(35,x=ke.id),"nodes"in ke&&t(36,p=ke.nodes),"edges"in ke&&t(37,y=ke.edges),"fitView"in ke&&t(38,w=ke.fitView),"fitViewOptions"in ke&&t(39,v=ke.fitViewOptions),"minZoom"in ke&&t(40,_=ke.minZoom),"maxZoom"in ke&&t(41,C=ke.maxZoom),"initialViewport"in ke&&t(42,k=ke.initialViewport),"viewport"in ke&&c(t(0,I=ke.viewport)),"nodeTypes"in ke&&t(43,S=ke.nodeTypes),"edgeTypes"in ke&&t(44,R=ke.edgeTypes),"selectionKey"in ke&&t(1,P=ke.selectionKey),"selectionMode"in ke&&t(45,D=ke.selectionMode),"panActivationKey"in ke&&t(2,U=ke.panActivationKey),"multiSelectionKey"in ke&&t(3,T=ke.multiSelectionKey),"zoomActivationKey"in ke&&t(4,G=ke.zoomActivationKey),"nodesDraggable"in ke&&t(46,M=ke.nodesDraggable),"nodesConnectable"in ke&&t(47,F=ke.nodesConnectable),"nodeDragThreshold"in ke&&t(48,X=ke.nodeDragThreshold),"elementsSelectable"in ke&&t(49,z=ke.elementsSelectable),"snapGrid"in ke&&t(50,K=ke.snapGrid),"deleteKey"in ke&&t(5,j=ke.deleteKey),"connectionRadius"in ke&&t(51,ae=ke.connectionRadius),"connectionLineType"in ke&&t(52,ge=ke.connectionLineType),"connectionMode"in ke&&t(53,ue=ke.connectionMode),"connectionLineStyle"in ke&&t(6,pe=ke.connectionLineStyle),"connectionLineContainerStyle"in ke&&t(7,de=ke.connectionLineContainerStyle),"onMoveStart"in ke&&t(8,O=ke.onMoveStart),"onMove"in ke&&t(9,Y=ke.onMove),"onMoveEnd"in ke&&t(10,le=ke.onMoveEnd),"isValidConnection"in ke&&t(54,$=ke.isValidConnection),"translateExtent"in ke&&t(55,re=ke.translateExtent),"nodeExtent"in ke&&t(56,oe=ke.nodeExtent),"onlyRenderVisibleElements"in ke&&t(57,ee=ke.onlyRenderVisibleElements),"panOnScrollMode"in ke&&t(11,Q=ke.panOnScrollMode),"preventScrolling"in ke&&t(12,je=ke.preventScrolling),"zoomOnScroll"in ke&&t(13,Re=ke.zoomOnScroll),"zoomOnDoubleClick"in ke&&t(14,Ne=ke.zoomOnDoubleClick),"zoomOnPinch"in ke&&t(15,He=ke.zoomOnPinch),"panOnScroll"in ke&&t(16,Be=ke.panOnScroll),"panOnDrag"in ke&&t(17,Je=ke.panOnDrag),"selectionOnDrag"in ke&&t(18,ht=ke.selectionOnDrag),"autoPanOnConnect"in ke&&t(58,ot=ke.autoPanOnConnect),"autoPanOnNodeDrag"in ke&&t(59,Ye=ke.autoPanOnNodeDrag),"onerror"in ke&&t(60,rt=ke.onerror),"ondelete"in ke&&t(61,me=ke.ondelete),"onedgecreate"in ke&&t(62,Mt=ke.onedgecreate),"attributionPosition"in ke&&t(19,ut=ke.attributionPosition),"proOptions"in ke&&t(20,dt=ke.proOptions),"defaultEdgeOptions"in ke&&t(21,Ve=ke.defaultEdgeOptions),"width"in ke&&t(63,Ot=ke.width),"height"in ke&&t(64,rn=ke.height),"colorMode"in ke&&t(65,Me=ke.colorMode),"onconnect"in ke&&t(66,Dt=ke.onconnect),"onconnectstart"in ke&&t(67,gt=ke.onconnectstart),"onconnectend"in ke&&t(68,jt=ke.onconnectend),"onbeforedelete"in ke&&t(69,Fn=ke.onbeforedelete),"oninit"in ke&&t(70,Kn=ke.oninit),"nodeOrigin"in ke&&t(71,ci=ke.nodeOrigin),"paneClickDistance"in ke&&t(22,ji=ke.paneClickDistance),"nodeClickDistance"in ke&&t(23,xs=ke.nodeClickDistance),"defaultMarkerColor"in ke&&t(72,hi=ke.defaultMarkerColor),"style"in ke&&t(24,qi=ke.style),"class"in ke&&t(25,ys=ke.class),"$$scope"in ke&&t(99,g=ke.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&201326592&&Tr!==void 0&&Ks!==void 0&&(De.width.set(Tr),De.height.set(Ks)),n.$$.dirty[2]&6400&&!ft&&a&&(Kn==null||Kn(),t(73,ft=!0)),n.$$.dirty[1]&2097135632|n.$$.dirty[2]&1777&&Sse(De,{flowId:x,connectionLineType:ge,connectionRadius:ae,selectionMode:D,snapGrid:K,defaultMarkerColor:hi,nodesDraggable:M,nodesConnectable:F,elementsSelectable:z,onlyRenderVisibleElements:ee,isValidConnection:$,autoPanOnConnect:ot,autoPanOnNodeDrag:Ye,onerror:rt,ondelete:me,onedgecreate:Mt,connectionMode:ue,nodeDragThreshold:X,onconnect:Dt,onconnectstart:gt,onconnectend:jt,onbeforedelete:Fn,nodeOrigin:ci}),n.$$.dirty[0]&4194304|n.$$.dirty[1]&16791040&&NS(De,{nodeTypes:S,edgeTypes:R,minZoom:_,maxZoom:C,translateExtent:re,paneClickDistance:ji}),n.$$.dirty[2]&8&&d(t(29,i=Ese(Me)))},[I,P,U,T,G,j,pe,de,O,Y,le,Q,je,Re,Ne,He,Be,Je,ht,ut,dt,Ve,ji,xs,qi,ys,Tr,Ks,ki,i,h,Ss,qe,r,m,x,p,y,w,v,_,C,k,S,R,D,M,F,X,z,K,ae,ge,ue,$,re,oe,ee,ot,Ye,rt,me,Mt,Ot,rn,Me,Dt,gt,jt,Fn,Kn,ci,hi,ft,a,f,Vt,sn,Bn,Cn,Un,zn,dl,fr,Qg,$g,em,tm,nm,im,sm,rm,am,om,lm,cm,hm,um,dm,g]}class Lse extends Ht{constructor(e){super(),zt(this,e,Dse,Ose,qt,{id:35,nodes:36,edges:37,fitView:38,fitViewOptions:39,minZoom:40,maxZoom:41,initialViewport:42,viewport:0,nodeTypes:43,edgeTypes:44,selectionKey:1,selectionMode:45,panActivationKey:2,multiSelectionKey:3,zoomActivationKey:4,nodesDraggable:46,nodesConnectable:47,nodeDragThreshold:48,elementsSelectable:49,snapGrid:50,deleteKey:5,connectionRadius:51,connectionLineType:52,connectionMode:53,connectionLineStyle:6,connectionLineContainerStyle:7,onMoveStart:8,onMove:9,onMoveEnd:10,isValidConnection:54,translateExtent:55,nodeExtent:56,onlyRenderVisibleElements:57,panOnScrollMode:11,preventScrolling:12,zoomOnScroll:13,zoomOnDoubleClick:14,zoomOnPinch:15,panOnScroll:16,panOnDrag:17,selectionOnDrag:18,autoPanOnConnect:58,autoPanOnNodeDrag:59,onerror:60,ondelete:61,onedgecreate:62,attributionPosition:19,proOptions:20,defaultEdgeOptions:21,width:63,height:64,colorMode:65,onconnect:66,onconnectstart:67,onconnectend:68,onbeforedelete:69,oninit:70,nodeOrigin:71,paneClickDistance:22,nodeClickDistance:23,defaultMarkerColor:72,style:24,class:25},null,[-1,-1,-1,-1])}}function Fse(n){let e;const t=n[7].default,i=zs(t,n,n[6],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,[r]){i&&i.p&&(!e||r&64)&&js(i,t,s,s[6],e?Vs(t,s[6],r,null):Gs(s[6]),null)},i(s){e||(H(i,s),e=!0)},o(s){q(i,s),e=!1},d(s){i&&i.d(s)}}}function Bse(n,e,t){let{$$slots:i={},$$scope:s}=e,{initialNodes:r=void 0}=e,{initialEdges:a=void 0}=e,{initialWidth:o=void 0}=e,{initialHeight:l=void 0}=e,{fitView:c=void 0}=e,{nodeOrigin:h=void 0}=e;const u=FO({nodes:r,edges:a,width:o,height:l,nodeOrigin:h,fitView:c});return Ip(Ny,{getStore:()=>u}),Gh(()=>{u.reset()}),n.$$set=d=>{"initialNodes"in d&&t(0,r=d.initialNodes),"initialEdges"in d&&t(1,a=d.initialEdges),"initialWidth"in d&&t(2,o=d.initialWidth),"initialHeight"in d&&t(3,l=d.initialHeight),"fitView"in d&&t(4,c=d.fitView),"nodeOrigin"in d&&t(5,h=d.nodeOrigin),"$$scope"in d&&t(6,s=d.$$scope)},[r,a,o,l,c,h,s,i]}class Use extends Ht{constructor(e){super(),zt(this,e,Bse,Fse,qt,{initialNodes:0,initialEdges:1,initialWidth:2,initialHeight:3,fitView:4,nodeOrigin:5})}}const Hse=n=>({}),DS=n=>({class:"button-svg"});function zse(n){let e,t,i,s,r;const a=n[8].default,o=zs(a,n,n[7],DS);let l=[{type:"button"},{class:t=Ii(["svelte-flow__controls-button",n[0]])},n[6]],c={};for(let h=0;h<l.length;h+=1)c=ai(c,l[h]);return{c(){e=ie("button"),o&&o.c(),this.h()},l(h){e=se(h,"BUTTON",{type:!0,class:!0});var u=V(e);o&&o.l(u),u.forEach(E),this.h()},h(){vg(e,c),tn(e,"--xy-controls-button-background-color-props",n[1]),tn(e,"--xy-controls-button-background-color-hover-props",n[2]),tn(e,"--xy-controls-button-color-props",n[3]),tn(e,"--xy-controls-button-color-hover-props",n[4]),tn(e,"--xy-controls-button-border-color-props",n[5])},m(h,u){te(h,e,u),o&&o.m(e,null),e.autofocus&&e.focus(),i=!0,s||(r=xt(e,"click",n[9]),s=!0)},p(h,[u]){o&&o.p&&(!i||u&128)&&js(o,a,h,h[7],i?Vs(a,h[7],u,Hse):Gs(h[7]),DS),vg(e,c=Nh(l,[{type:"button"},(!i||u&1&&t!==(t=Ii(["svelte-flow__controls-button",h[0]])))&&{class:t},u&64&&h[6]])),tn(e,"--xy-controls-button-background-color-props",h[1]),tn(e,"--xy-controls-button-background-color-hover-props",h[2]),tn(e,"--xy-controls-button-color-props",h[3]),tn(e,"--xy-controls-button-color-hover-props",h[4]),tn(e,"--xy-controls-button-border-color-props",h[5])},i(h){i||(H(o,h),i=!0)},o(h){q(o,h),i=!1},d(h){h&&E(e),o&&o.d(h),s=!1,r()}}}function jse(n,e,t){const i=["class"];let s=Qi(e,i),{$$slots:r={},$$scope:a}=e,{class:o=void 0}=e,l,c,h,u,d;function f(g){Yn.call(this,n,g)}return n.$$set=g=>{e=ai(ai({},e),ll(g)),t(6,s=Qi(e,i)),"class"in g&&t(0,o=g.class),"$$scope"in g&&t(7,a=g.$$scope)},[o,l,c,h,u,d,s,a,r,f]}class l5 extends Ht{constructor(e){super(),zt(this,e,jse,zse,qt,{class:0})}}function Gse(n){let e,t;return{c(){e=lt("svg"),t=lt("path"),this.h()},l(i){e=ct(i,"svg",{xmlns:!0,viewBox:!0});var s=V(e);t=ct(s,"path",{d:!0}),V(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"d","M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 32 32")},m(i,s){te(i,e,s),W(e,t)},p:It,i:It,o:It,d(i){i&&E(e)}}}class Vse extends Ht{constructor(e){super(),zt(this,e,null,Gse,qt,{})}}function qse(n){let e,t;return{c(){e=lt("svg"),t=lt("path"),this.h()},l(i){e=ct(i,"svg",{xmlns:!0,viewBox:!0});var s=V(e);t=ct(s,"path",{d:!0}),V(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"d","M0 0h32v4.2H0z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 32 5")},m(i,s){te(i,e,s),W(e,t)},p:It,i:It,o:It,d(i){i&&E(e)}}}class Wse extends Ht{constructor(e){super(),zt(this,e,null,qse,qt,{})}}function Kse(n){let e,t;return{c(){e=lt("svg"),t=lt("path"),this.h()},l(i){e=ct(i,"svg",{xmlns:!0,viewBox:!0});var s=V(e);t=ct(s,"path",{d:!0}),V(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"d","M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 32 30")},m(i,s){te(i,e,s),W(e,t)},p:It,i:It,o:It,d(i){i&&E(e)}}}class Xse extends Ht{constructor(e){super(),zt(this,e,null,Kse,qt,{})}}function Yse(n){let e,t;return{c(){e=lt("svg"),t=lt("path"),this.h()},l(i){e=ct(i,"svg",{xmlns:!0,viewBox:!0});var s=V(e);t=ct(s,"path",{d:!0}),V(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"d","M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 25 32")},m(i,s){te(i,e,s),W(e,t)},p:It,i:It,o:It,d(i){i&&E(e)}}}class Jse extends Ht{constructor(e){super(),zt(this,e,null,Yse,qt,{})}}function Zse(n){let e,t;return{c(){e=lt("svg"),t=lt("path"),this.h()},l(i){e=ct(i,"svg",{xmlns:!0,viewBox:!0});var s=V(e);t=ct(s,"path",{d:!0}),V(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"d","M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"viewBox","0 0 25 32")},m(i,s){te(i,e,s),W(e,t)},p:It,i:It,o:It,d(i){i&&E(e)}}}class Qse extends Ht{constructor(e){super(),zt(this,e,null,Zse,qt,{})}}const $se=n=>({}),LS=n=>({}),ere=n=>({}),FS=n=>({});function BS(n){let e,t,i,s;const r=[{class:"svelte-flow__controls-zoomin"},{title:"zoom in"},{"aria-label":"zoom in"},{disabled:n[9]},n[17]];let a={$$slots:{default:[tre]},$$scope:{ctx:n}};for(let c=0;c<r.length;c+=1)a=ai(a,r[c]);e=new l5({props:a}),e.$on("click",n[18]);const o=[{class:"svelte-flow__controls-zoomout"},{title:"zoom out"},{"aria-label":"zoom out"},{disabled:n[10]},n[17]];let l={$$slots:{default:[nre]},$$scope:{ctx:n}};for(let c=0;c<o.length;c+=1)l=ai(l,o[c]);return i=new l5({props:l}),i.$on("click",n[19]),{c(){be(e.$$.fragment),t=Se(),be(i.$$.fragment)},l(c){ve(e.$$.fragment,c),t=Ie(c),ve(i.$$.fragment,c)},m(c,h){xe(e,c,h),te(c,t,h),xe(i,c,h),s=!0},p(c,h){const u=h[0]&131584?Nh(r,[r[0],r[1],r[2],h[0]&512&&{disabled:c[9]},h[0]&131072&&Ep(c[17])]):{};h[1]&32&&(u.$$scope={dirty:h,ctx:c}),e.$set(u);const d=h[0]&132096?Nh(o,[o[0],o[1],o[2],h[0]&1024&&{disabled:c[10]},h[0]&131072&&Ep(c[17])]):{};h[1]&32&&(d.$$scope={dirty:h,ctx:c}),i.$set(d)},i(c){s||(H(e.$$.fragment,c),H(i.$$.fragment,c),s=!0)},o(c){q(e.$$.fragment,c),q(i.$$.fragment,c),s=!1},d(c){c&&E(t),ye(e,c),ye(i,c)}}}function tre(n){let e,t;return e=new Vse({}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function nre(n){let e,t;return e=new Wse({}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function US(n){let e,t;const i=[{class:"svelte-flow__controls-fitview"},{title:"fit view"},{"aria-label":"fit view"},n[17]];let s={$$slots:{default:[ire]},$$scope:{ctx:n}};for(let r=0;r<i.length;r+=1)s=ai(s,i[r]);return e=new l5({props:s}),e.$on("click",n[20]),{c(){be(e.$$.fragment)},l(r){ve(e.$$.fragment,r)},m(r,a){xe(e,r,a),t=!0},p(r,a){const o=a[0]&131072?Nh(i,[i[0],i[1],i[2],Ep(r[17])]):{};a[1]&32&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){t||(H(e.$$.fragment,r),t=!0)},o(r){q(e.$$.fragment,r),t=!1},d(r){ye(e,r)}}}function ire(n){let e,t;return e=new Xse({}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function HS(n){let e,t;const i=[{class:"svelte-flow__controls-interactive"},{title:"toggle interactivity"},{"aria-label":"toggle interactivity"},n[17]];let s={$$slots:{default:[are]},$$scope:{ctx:n}};for(let r=0;r<i.length;r+=1)s=ai(s,i[r]);return e=new l5({props:s}),e.$on("click",n[21]),{c(){be(e.$$.fragment)},l(r){ve(e.$$.fragment,r)},m(r,a){xe(e,r,a),t=!0},p(r,a){const o=a[0]&131072?Nh(i,[i[0],i[1],i[2],Ep(r[17])]):{};a[0]&256|a[1]&32&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){t||(H(e.$$.fragment,r),t=!0)},o(r){q(e.$$.fragment,r),t=!1},d(r){ye(e,r)}}}function sre(n){let e,t;return e=new Jse({}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function rre(n){let e,t;return e=new Qse({}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function are(n){let e,t,i,s;const r=[rre,sre],a=[];function o(l,c){return l[8]?0:1}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=Xt()},l(l){t.l(l),i=Xt()},m(l,c){a[e].m(l,c),te(l,i,c),s=!0},p(l,c){let h=e;e=o(l),e!==h&&(yt(),q(a[h],1,1,()=>{a[h]=null}),wt(),t=a[e],t||(t=a[e]=r[e](l),t.c()),H(t,1),t.m(i.parentNode,i))},i(l){s||(H(t),s=!0)},o(l){q(t),s=!1},d(l){l&&E(i),a[e].d(l)}}}function ore(n){let e,t,i,s,r,a;const o=n[35].before,l=zs(o,n,n[36],FS);let c=n[1]&&BS(n),h=n[2]&&US(n),u=n[3]&&HS(n);const d=n[35].default,f=zs(d,n,n[36],null),g=n[35].after,m=zs(g,n,n[36],LS);return{c(){l&&l.c(),e=Se(),c&&c.c(),t=Se(),h&&h.c(),i=Se(),u&&u.c(),s=Se(),f&&f.c(),r=Se(),m&&m.c()},l(x){l&&l.l(x),e=Ie(x),c&&c.l(x),t=Ie(x),h&&h.l(x),i=Ie(x),u&&u.l(x),s=Ie(x),f&&f.l(x),r=Ie(x),m&&m.l(x)},m(x,p){l&&l.m(x,p),te(x,e,p),c&&c.m(x,p),te(x,t,p),h&&h.m(x,p),te(x,i,p),u&&u.m(x,p),te(x,s,p),f&&f.m(x,p),te(x,r,p),m&&m.m(x,p),a=!0},p(x,p){l&&l.p&&(!a||p[1]&32)&&js(l,o,x,x[36],a?Vs(o,x[36],p,ere):Gs(x[36]),FS),x[1]?c?(c.p(x,p),p[0]&2&&H(c,1)):(c=BS(x),c.c(),H(c,1),c.m(t.parentNode,t)):c&&(yt(),q(c,1,1,()=>{c=null}),wt()),x[2]?h?(h.p(x,p),p[0]&4&&H(h,1)):(h=US(x),h.c(),H(h,1),h.m(i.parentNode,i)):h&&(yt(),q(h,1,1,()=>{h=null}),wt()),x[3]?u?(u.p(x,p),p[0]&8&&H(u,1)):(u=HS(x),u.c(),H(u,1),u.m(s.parentNode,s)):u&&(yt(),q(u,1,1,()=>{u=null}),wt()),f&&f.p&&(!a||p[1]&32)&&js(f,d,x,x[36],a?Vs(d,x[36],p,null):Gs(x[36]),null),m&&m.p&&(!a||p[1]&32)&&js(m,g,x,x[36],a?Vs(g,x[36],p,$se):Gs(x[36]),LS)},i(x){a||(H(l,x),H(c),H(h),H(u),H(f,x),H(m,x),a=!0)},o(x){q(l,x),q(c),q(h),q(u),q(f,x),q(m,x),a=!1},d(x){x&&(E(e),E(t),E(i),E(s),E(r)),l&&l.d(x),c&&c.d(x),h&&h.d(x),u&&u.d(x),f&&f.d(x),m&&m.d(x)}}}function lre(n){let e,t;return e=new zO({props:{class:Ii(["svelte-flow__controls",n[7],n[6]]),position:n[0],"data-testid":"svelte-flow__controls","aria-label":n[4]??"Svelte Flow controls",style:n[5],$$slots:{default:[ore]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&192&&(r.class=Ii(["svelte-flow__controls",i[7],i[6]])),s[0]&1&&(r.position=i[0]),s[0]&16&&(r["aria-label"]=i[4]??"Svelte Flow controls"),s[0]&32&&(r.style=i[5]),s[0]&1806|s[1]&32&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function cre(n,e,t){let i,s,r,a,o,l,c,h,u,d,{$$slots:f={},$$scope:g}=e,{position:m="bottom-left"}=e,{showZoom:x=!0}=e,{showFitView:p=!0}=e,{showLock:y=!0}=e,{buttonBgColor:w=void 0}=e,{buttonBgColorHover:v=void 0}=e,{buttonColor:_=void 0}=e,{buttonColorHover:C=void 0}=e,{buttonBorderColor:k=void 0}=e,{ariaLabel:I=void 0}=e,{style:S=void 0}=e,{orientation:R="vertical"}=e,{fitViewOptions:P=void 0}=e,{class:D=""}=e;const{zoomIn:U,zoomOut:T,fitView:G,viewport:M,minZoom:F,maxZoom:X,nodesDraggable:z,nodesConnectable:K,elementsSelectable:j}=es();Oe(n,M,O=>t(30,l=O)),Oe(n,F,O=>t(31,c=O)),Oe(n,X,O=>t(29,o=O)),Oe(n,z,O=>t(34,d=O)),Oe(n,K,O=>t(33,u=O)),Oe(n,j,O=>t(32,h=O));const ae={bgColor:w,bgColorHover:v,color:_,colorHover:C,borderColor:k},ge=()=>{U()},ue=()=>{T()},pe=()=>{G(P)},de=()=>{t(8,i=!i),z.set(i),K.set(i),j.set(i)};return n.$$set=O=>{"position"in O&&t(0,m=O.position),"showZoom"in O&&t(1,x=O.showZoom),"showFitView"in O&&t(2,p=O.showFitView),"showLock"in O&&t(3,y=O.showLock),"buttonBgColor"in O&&t(22,w=O.buttonBgColor),"buttonBgColorHover"in O&&t(23,v=O.buttonBgColorHover),"buttonColor"in O&&t(24,_=O.buttonColor),"buttonColorHover"in O&&t(25,C=O.buttonColorHover),"buttonBorderColor"in O&&t(26,k=O.buttonBorderColor),"ariaLabel"in O&&t(4,I=O.ariaLabel),"style"in O&&t(5,S=O.style),"orientation"in O&&t(27,R=O.orientation),"fitViewOptions"in O&&t(28,P=O.fitViewOptions),"class"in O&&t(6,D=O.class),"$$scope"in O&&t(36,g=O.$$scope)},n.$$.update=()=>{n.$$.dirty[1]&14&&t(8,i=d||u||h),n.$$.dirty[0]&1073741824|n.$$.dirty[1]&1&&t(10,s=l.zoom<=c),n.$$.dirty[0]&1610612736&&t(9,r=l.zoom>=o),n.$$.dirty[0]&134217728&&t(7,a=R==="horizontal"?"horizontal":"vertical")},[m,x,p,y,I,S,D,a,i,r,s,M,F,X,z,K,j,ae,ge,ue,pe,de,w,v,_,C,k,R,P,o,l,c,h,u,d,f,g]}let hre=class extends Ht{constructor(e){super(),zt(this,e,cre,lre,qt,{position:0,showZoom:1,showFitView:2,showLock:3,buttonBgColor:22,buttonBgColorHover:23,buttonColor:24,buttonColorHover:25,buttonBorderColor:26,ariaLabel:4,style:5,orientation:27,fitViewOptions:28,class:6},null,[-1,-1])}};var h0;(function(n){n.Lines="lines",n.Dots="dots",n.Cross="cross"})(h0||(h0={}));function ure(n){let e,t;return{c(){e=lt("circle"),this.h()},l(i){e=ct(i,"circle",{cx:!0,cy:!0,r:!0,class:!0}),V(e).forEach(E),this.h()},h(){A(e,"cx",n[0]),A(e,"cy",n[0]),A(e,"r",n[0]),A(e,"class",t=Ii(["svelte-flow__background-pattern","dots",n[1]]))},m(i,s){te(i,e,s)},p(i,[s]){s&1&&A(e,"cx",i[0]),s&1&&A(e,"cy",i[0]),s&1&&A(e,"r",i[0]),s&2&&t!==(t=Ii(["svelte-flow__background-pattern","dots",i[1]]))&&A(e,"class",t)},i:It,o:It,d(i){i&&E(e)}}}function dre(n,e,t){let{radius:i=5}=e,{class:s=""}=e;return n.$$set=r=>{"radius"in r&&t(0,i=r.radius),"class"in r&&t(1,s=r.class)},[i,s]}class fre extends Ht{constructor(e){super(),zt(this,e,dre,ure,qt,{radius:0,class:1})}}function gre(n){let e,t,i;return{c(){e=lt("path"),this.h()},l(s){e=ct(s,"path",{"stroke-width":!0,d:!0,class:!0}),V(e).forEach(E),this.h()},h(){A(e,"stroke-width",n[0]),A(e,"d",t=`M${n[1][0]/2} 0 V${n[1][1]} M0 ${n[1][1]/2} H${n[1][0]}`),A(e,"class",i=Ii(["svelte-flow__background-pattern",n[2],n[3]]))},m(s,r){te(s,e,r)},p(s,[r]){r&1&&A(e,"stroke-width",s[0]),r&2&&t!==(t=`M${s[1][0]/2} 0 V${s[1][1]} M0 ${s[1][1]/2} H${s[1][0]}`)&&A(e,"d",t),r&12&&i!==(i=Ii(["svelte-flow__background-pattern",s[2],s[3]]))&&A(e,"class",i)},i:It,o:It,d(s){s&&E(e)}}}function mre(n,e,t){let{lineWidth:i=1}=e,{dimensions:s}=e,{variant:r=void 0}=e,{class:a=""}=e;return n.$$set=o=>{"lineWidth"in o&&t(0,i=o.lineWidth),"dimensions"in o&&t(1,s=o.dimensions),"variant"in o&&t(2,r=o.variant),"class"in o&&t(3,a=o.class)},[i,s,r,a]}class pre extends Ht{constructor(e){super(),zt(this,e,mre,gre,qt,{lineWidth:0,dimensions:1,variant:2,class:3})}}function bre(n){let e,t;return e=new pre({props:{dimensions:n[6],variant:n[0],lineWidth:n[1],class:n[4]}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s&64&&(r.dimensions=i[6]),s&1&&(r.variant=i[0]),s&2&&(r.lineWidth=i[1]),s&16&&(r.class=i[4]),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function xre(n){let e,t;return e=new fre({props:{radius:n[7]/2,class:n[4]}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s&128&&(r.radius=i[7]/2),s&16&&(r.class=i[4]),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function yre(n){let e,t,i,s,r,a,o,l,c,h,u,d,f;const g=[xre,bre],m=[];function x(p,y){return p[14]?0:1}return i=x(n),s=m[i]=g[i](n),{c(){e=lt("svg"),t=lt("pattern"),s.c(),h=lt("rect"),this.h()},l(p){e=ct(p,"svg",{class:!0,"data-testid":!0});var y=V(e);t=ct(y,"pattern",{id:!0,x:!0,y:!0,width:!0,height:!0,patternUnits:!0,patternTransform:!0});var w=V(t);s.l(w),w.forEach(E),h=ct(y,"rect",{x:!0,y:!0,width:!0,height:!0,fill:!0}),V(h).forEach(E),y.forEach(E),this.h()},h(){A(t,"id",n[11]),A(t,"x",r=n[9].x%n[8][0]),A(t,"y",a=n[9].y%n[8][1]),A(t,"width",o=n[8][0]),A(t,"height",l=n[8][1]),A(t,"patternUnits","userSpaceOnUse"),A(t,"patternTransform",c=`translate(-${n[10][0]},-${n[10][1]})`),A(h,"x","0"),A(h,"y","0"),A(h,"width","100%"),A(h,"height","100%"),A(h,"fill",u=`url(#${n[11]})`),A(e,"class",d=e_(Ii(["svelte-flow__background",n[5]]))+" svelte-1r7pe8d"),A(e,"data-testid","svelte-flow__background"),tn(e,"--xy-background-color-props",n[2]),tn(e,"--xy-background-pattern-color-props",n[3])},m(p,y){te(p,e,y),W(e,t),m[i].m(t,null),W(e,h),f=!0},p(p,[y]){s.p(p,y),(!f||y&2048)&&A(t,"id",p[11]),(!f||y&768&&r!==(r=p[9].x%p[8][0]))&&A(t,"x",r),(!f||y&768&&a!==(a=p[9].y%p[8][1]))&&A(t,"y",a),(!f||y&256&&o!==(o=p[8][0]))&&A(t,"width",o),(!f||y&256&&l!==(l=p[8][1]))&&A(t,"height",l),(!f||y&1024&&c!==(c=`translate(-${p[10][0]},-${p[10][1]})`))&&A(t,"patternTransform",c),(!f||y&2048&&u!==(u=`url(#${p[11]})`))&&A(h,"fill",u),(!f||y&32&&d!==(d=e_(Ii(["svelte-flow__background",p[5]]))+" svelte-1r7pe8d"))&&A(e,"class",d),y&4&&tn(e,"--xy-background-color-props",p[2]),y&8&&tn(e,"--xy-background-pattern-color-props",p[3])},i(p){f||(H(s),f=!0)},o(p){q(s),f=!1},d(p){p&&E(e),m[i].d()}}}const wre={[h0.Dots]:1,[h0.Lines]:1,[h0.Cross]:6};function vre(n,e,t){let i,s,r,a,o,l,c,{id:h=void 0}=e,{variant:u=h0.Dots}=e,{gap:d=20}=e,{size:f=1}=e,{lineWidth:g=1}=e,{bgColor:m=void 0}=e,{patternColor:x=void 0}=e,{patternClass:p=void 0}=e,{class:y=""}=e;const{viewport:w,flowId:v}=es();Oe(n,w,S=>t(9,l=S)),Oe(n,v,S=>t(18,c=S));const _=f||wre[u],C=u===h0.Dots,k=u===h0.Cross,I=Array.isArray(d)?d:[d,d];return n.$$set=S=>{"id"in S&&t(15,h=S.id),"variant"in S&&t(0,u=S.variant),"gap"in S&&t(16,d=S.gap),"size"in S&&t(17,f=S.size),"lineWidth"in S&&t(1,g=S.lineWidth),"bgColor"in S&&t(2,m=S.bgColor),"patternColor"in S&&t(3,x=S.patternColor),"patternClass"in S&&t(4,p=S.patternClass),"class"in S&&t(5,y=S.class)},n.$$.update=()=>{n.$$.dirty&294912&&t(11,i=`background-pattern-${c}-${h||""}`),n.$$.dirty&512&&t(8,s=[I[0]*l.zoom||1,I[1]*l.zoom||1]),n.$$.dirty&512&&t(7,r=_*l.zoom),n.$$.dirty&384&&t(6,a=k?[r,r]:s),n.$$.dirty&192&&t(10,o=C?[r/2,r/2]:[a[0]/2,a[1]/2])},[u,g,m,x,p,y,a,r,s,l,o,i,w,v,C,h,d,f,c]}class _re extends Ht{constructor(e){super(),zt(this,e,vre,yre,qt,{id:15,variant:0,gap:16,size:17,lineWidth:1,bgColor:2,patternColor:3,patternClass:4,class:5})}}const zS=n=>jte(n);function kre(){const{zoomIn:n,zoomOut:e,fitView:t,onbeforedelete:i,snapGrid:s,viewport:r,width:a,height:o,minZoom:l,maxZoom:c,panZoom:h,nodes:u,edges:d,domNode:f,nodeLookup:g,nodeOrigin:m,edgeLookup:x,connectionLookup:p}=es(),y=_=>{var R,P;const C=Qe(g),k=zS(_)?_:C.get(_.id),I=k.parentId?Kte(k.position,k.measured,k.parentId,C,Qe(m)):k.position,S={id:k.id,position:I,width:((R=k.measured)==null?void 0:R.width)??k.width,height:((P=k.measured)==null?void 0:P.height)??k.height,data:k.data};return Bg(S)},w=(_,C,k={replace:!1})=>{var R;const I=(R=Qe(g).get(_))==null?void 0:R.internals.userNode;if(!I)return;const S=typeof C=="function"?C(I):C;k.replace?u.update(P=>P.map(D=>D.id===_?zS(S)?S:{...D,...S}:D)):(Object.assign(I,S),u.update(P=>P))},v=_=>Qe(g).get(_);return{zoomIn:n,zoomOut:e,getInternalNode:v,getNode:_=>{var C;return(C=v(_))==null?void 0:C.internals.userNode},getNodes:_=>_===void 0?Qe(u):jS(Qe(g),_),getEdge:_=>Qe(x).get(_),getEdges:_=>_===void 0?Qe(d):jS(Qe(x),_),setZoom:(_,C)=>{const k=Qe(h);return k?k.scaleTo(_,{duration:C==null?void 0:C.duration}):Promise.resolve(!1)},getZoom:()=>Qe(r).zoom,setViewport:async(_,C)=>{const k=Qe(r),I=Qe(h);return I?(await I.setViewport({x:_.x??k.x,y:_.y??k.y,zoom:_.zoom??k.zoom},{duration:C==null?void 0:C.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>Qe(r),setCenter:async(_,C,k)=>{const I=typeof(k==null?void 0:k.zoom)<"u"?k.zoom:Qe(c),S=Qe(h);return S?(await S.setViewport({x:Qe(a)/2-_*I,y:Qe(o)/2-C*I,zoom:I},{duration:k==null?void 0:k.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitView:t,fitBounds:async(_,C)=>{const k=Qe(h);if(!k)return Promise.resolve(!1);const I=Bv(_,Qe(a),Qe(o),Qe(l),Qe(c),(C==null?void 0:C.padding)??.1);return await k.setViewport(I,{duration:C==null?void 0:C.duration}),Promise.resolve(!0)},getIntersectingNodes:(_,C=!0,k)=>{const I=sS(_),S=I?_:y(_);return S?(k||Qe(u)).filter(R=>{const P=Qe(g).get(R.id);if(!P||!I&&R.id===_.id)return!1;const D=Bg(P),U=s2(D,S);return C&&U>0||U>=S.width*S.height}):[]},isNodeIntersecting:(_,C,k=!0)=>{const S=sS(_)?_:y(_);if(!S)return!1;const R=s2(S,C);return k&&R>0||R>=S.width*S.height},deleteElements:async({nodes:_=[],edges:C=[]})=>{const{nodes:k,edges:I}=await hO({nodesToRemove:_,edgesToRemove:C,nodes:Qe(u),edges:Qe(d),onBeforeDelete:Qe(i)});return k&&u.update(S=>S.filter(R=>!k.some(({id:P})=>P===R.id))),I&&d.update(S=>S.filter(R=>!I.some(({id:P})=>P===R.id))),{deletedNodes:k,deletedEdges:I}},screenToFlowPosition:(_,C={snapToGrid:!0})=>{const k=Qe(f);if(!k)return _;const I=C.snapToGrid?Qe(s):!1,{x:S,y:R,zoom:P}=Qe(r),{x:D,y:U}=k.getBoundingClientRect(),T={x:_.x-D,y:_.y-U};return _x(T,[S,R,P],I!==null,I||[1,1])},flowToScreenPosition:_=>{const C=Qe(f);if(!C)return _;const{x:k,y:I,zoom:S}=Qe(r),{x:R,y:P}=C.getBoundingClientRect(),D=fO(_,[k,I,S]);return{x:D.x+R,y:D.y+P}},toObject:()=>({nodes:Qe(u).map(_=>({..._,position:{..._.position},data:{..._.data}})),edges:Qe(d).map(_=>({..._})),viewport:{...Qe(r)}}),updateNode:w,updateNodeData:(_,C,k)=>{var R;const I=(R=Qe(g).get(_))==null?void 0:R.internals.userNode;if(!I)return;const S=typeof C=="function"?C(I):C;I.data=k!=null&&k.replace?S:{...I.data,...S},u.update(P=>P)},getNodesBounds:_=>{const C=Qe(g),k=Qe(m);return Gte(_,{nodeLookup:C,nodeOrigin:k})},getHandleConnections:({type:_,id:C,nodeId:k})=>{var I;return Array.from(((I=Qe(p).get(`${k}-${_}-${C??null}`))==null?void 0:I.values())??[])},viewport:r}}function jS(n,e){var i;const t=[];for(const s of e){const r=n.get(s);if(r){const a="internals"in r?(i=r.internals)==null?void 0:i.userNode:r;t.push(a)}}return t}function Cre(){const{nodesInitialized:n}=es();return{subscribe:n.subscribe}}function GS(n,e,t){const i=n.slice();return i[25]=e[t],i[27]=t,i}function VS(n,e,t){const i=n.slice();return i[22]=e[t],i[24]=t,i}function Are(n){let e,t;return e=new t4({props:{className:"size-4"}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p:It,i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Sre(n){let e,t,i,s,r,a,o,l=n[8].t("Tools")+"",c,h,u=n[8].t("Functions")+"",d,f,g,m,x,p,y,w;function v(I,S){if(I[1]==="tools")return Ere;if(I[1]==="functions")return Ire}let _=v(n),C=_&&_(n),k=n[2]&&KS(n);return{c(){e=ie("form"),t=ie("div"),i=ie("div"),s=ie("div"),r=ie("div"),a=ie("select"),o=ie("option"),c=At(l),h=ie("option"),d=At(u),f=Se(),g=ie("div"),m=ie("select"),C&&C.c(),x=Se(),k&&k.c(),this.h()},l(I){e=se(I,"FORM",{class:!0});var S=V(e);t=se(S,"DIV",{class:!0});var R=V(t);i=se(R,"DIV",{class:!0});var P=V(i);s=se(P,"DIV",{class:!0});var D=V(s);r=se(D,"DIV",{class:!0});var U=V(r);a=se(U,"SELECT",{class:!0,placeholder:!0});var T=V(a);o=se(T,"OPTION",{class:!0});var G=V(o);c=St(G,l),G.forEach(E),h=se(T,"OPTION",{class:!0});var M=V(h);d=St(M,u),M.forEach(E),T.forEach(E),U.forEach(E),f=Ie(D),g=se(D,"DIV",{class:!0});var F=V(g);m=se(F,"SELECT",{class:!0});var X=V(m);C&&C.l(X),X.forEach(E),F.forEach(E),D.forEach(E),P.forEach(E),x=Ie(R),k&&k.l(R),R.forEach(E),S.forEach(E),this.h()},h(){o.__value="tools",xo(o,o.__value),A(o,"class","bg-gray-100 dark:bg-gray-800"),h.__value="functions",xo(h,h.__value),A(h,"class","bg-gray-100 dark:bg-gray-800"),A(a,"class","w-full rounded-sm text-xs py-2 px-1 bg-transparent outline-hidden"),A(a,"placeholder","Select"),n[1]===void 0&&Rh(()=>n[13].call(a)),A(r,"class","flex-1"),A(m,"class","w-full rounded-sm py-2 px-1 text-xs bg-transparent outline-hidden"),n[2]===void 0&&Rh(()=>n[14].call(m)),A(g,"class","flex-1"),A(s,"class","flex gap-2"),A(i,"class","space-y-1"),A(t,"class","flex flex-col"),A(e,"class","flex flex-col h-full justify-between space-y-3 text-sm")},m(I,S){te(I,e,S),W(e,t),W(t,i),W(i,s),W(s,r),W(r,a),W(a,o),W(o,c),W(a,h),W(h,d),Ax(a,n[1],!0),W(s,f),W(s,g),W(g,m),C&&C.m(m,null),Ax(m,n[2],!0),W(t,x),k&&k.m(t,null),p=!0,y||(w=[xt(a,"change",n[13]),xt(m,"change",n[14]),xt(m,"change",n[15]),xt(e,"submit",zg(n[18]))],y=!0)},p(I,S){(!p||S&256)&&l!==(l=I[8].t("Tools")+"")&&Pt(c,l),(!p||S&256)&&u!==(u=I[8].t("Functions")+"")&&Pt(d,u),S&2&&Ax(a,I[1]),_===(_=v(I))&&C?C.p(I,S):(C&&C.d(1),C=_&&_(I),C&&(C.c(),C.m(m,null))),S&196&&Ax(m,I[2]),I[2]?k?(k.p(I,S),S&4&&H(k,1)):(k=KS(I),k.c(),H(k,1),k.m(t,null)):k&&(yt(),q(k,1,1,()=>{k=null}),wt())},i(I){p||(H(k),p=!0)},o(I){q(k),p=!1},d(I){I&&E(e),C&&C.d(),k&&k.d(),y=!1,Zr(w)}}}function Ire(n){let e,t=n[8].t("Select a function")+"",i,s,r=ni(n[7]),a=[];for(let o=0;o<r.length;o+=1)a[o]=qS(GS(n,r,o));return{c(){e=ie("option"),i=At(t);for(let o=0;o<a.length;o+=1)a[o].c();s=Xt(),this.h()},l(o){e=se(o,"OPTION",{class:!0});var l=V(e);i=St(l,t),l.forEach(E);for(let c=0;c<a.length;c+=1)a[c].l(o);s=Xt(),this.h()},h(){e.__value="",xo(e,e.__value),e.selected=!0,e.disabled=!0,A(e,"class","bg-gray-100 dark:bg-gray-800")},m(o,l){te(o,e,l),W(e,i);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(o,l);te(o,s,l)},p(o,l){if(l&256&&t!==(t=o[8].t("Select a function")+"")&&Pt(i,t),l&128){r=ni(o[7]);let c;for(c=0;c<r.length;c+=1){const h=GS(o,r,c);a[c]?a[c].p(h,l):(a[c]=qS(h),a[c].c(),a[c].m(s.parentNode,s))}for(;c<a.length;c+=1)a[c].d(1);a.length=r.length}},d(o){o&&(E(e),E(s)),vo(a,o)}}}function Ere(n){let e,t=n[8].t("Select a tool")+"",i,s,r=ni(n[6]),a=[];for(let o=0;o<r.length;o+=1)a[o]=WS(VS(n,r,o));return{c(){e=ie("option"),i=At(t);for(let o=0;o<a.length;o+=1)a[o].c();s=Xt(),this.h()},l(o){e=se(o,"OPTION",{class:!0});var l=V(e);i=St(l,t),l.forEach(E);for(let c=0;c<a.length;c+=1)a[c].l(o);s=Xt(),this.h()},h(){e.__value="",xo(e,e.__value),e.selected=!0,e.disabled=!0,A(e,"class","bg-gray-100 dark:bg-gray-800")},m(o,l){te(o,e,l),W(e,i);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(o,l);te(o,s,l)},p(o,l){if(l&256&&t!==(t=o[8].t("Select a tool")+"")&&Pt(i,t),l&64){r=ni(o[6]);let c;for(c=0;c<r.length;c+=1){const h=VS(o,r,c);a[c]?a[c].p(h,l):(a[c]=WS(h),a[c].c(),a[c].m(s.parentNode,s))}for(;c<a.length;c+=1)a[c].d(1);a.length=r.length}},d(o){o&&(E(e),E(s)),vo(a,o)}}}function qS(n){let e,t=n[25].name+"",i,s;return{c(){e=ie("option"),i=At(t),this.h()},l(r){e=se(r,"OPTION",{class:!0});var a=V(e);i=St(a,t),a.forEach(E),this.h()},h(){e.__value=s=n[25].id,xo(e,e.__value),A(e,"class","bg-gray-100 dark:bg-gray-800")},m(r,a){te(r,e,a),W(e,i)},p(r,a){a&128&&t!==(t=r[25].name+"")&&Pt(i,t),a&128&&s!==(s=r[25].id)&&(e.__value=s,xo(e,e.__value))},d(r){r&&E(e)}}}function WS(n){let e,t=n[22].name+"",i,s;return{c(){e=ie("option"),i=At(t),this.h()},l(r){e=se(r,"OPTION",{class:!0});var a=V(e);i=St(a,t),a.forEach(E),this.h()},h(){e.__value=s=n[22].id,xo(e,e.__value),A(e,"class","bg-gray-100 dark:bg-gray-800")},m(r,a){te(r,e,a),W(e,i)},p(r,a){a&64&&t!==(t=r[22].name+"")&&Pt(i,t),a&64&&s!==(s=r[22].id)&&(e.__value=s,xo(e,e.__value))},d(r){r&&E(e)}}}function KS(n){let e,t,i,s,r,a;const o=[Rre,Tre],l=[];function c(h,u){return h[3]?1:0}return s=c(n),r=l[s]=o[s](n),{c(){e=ie("hr"),t=Se(),i=ie("div"),r.c(),this.h()},l(h){e=se(h,"HR",{class:!0}),t=Ie(h),i=se(h,"DIV",{class:!0});var u=V(i);r.l(u),u.forEach(E),this.h()},h(){A(e,"class","border-gray-50 dark:border-gray-800 my-1 w-full"),A(i,"class","my-2 text-xs")},m(h,u){te(h,e,u),te(h,t,u),te(h,i,u),l[s].m(i,null),a=!0},p(h,u){let d=s;s=c(h),s===d?l[s].p(h,u):(yt(),q(l[d],1,1,()=>{l[d]=null}),wt(),r=l[s],r?r.p(h,u):(r=l[s]=o[s](h),r.c()),H(r,1),r.m(i,null))},i(h){a||(H(r),a=!0)},o(h){q(r),a=!1},d(h){h&&(E(e),E(t),E(i)),l[s].d()}}}function Tre(n){let e,t;return e=new t4({props:{className:"size-5"}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p:It,i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Rre(n){let e,t,i;function s(a){n[16](a)}let r={valvesSpec:n[4]};return n[5]!==void 0&&(r.valves=n[5]),e=new vL({props:r}),Et.push(()=>Kt(e,"valves",s)),e.$on("change",n[17]),{c(){be(e.$$.fragment)},l(a){ve(e.$$.fragment,a)},m(a,o){xe(e,a,o),i=!0},p(a,o){const l={};o&16&&(l.valvesSpec=a[4]),!t&&o&32&&(t=!0,l.valves=a[5],Wt(()=>t=!1)),e.$set(l)},i(a){i||(H(e.$$.fragment,a),i=!0)},o(a){q(e.$$.fragment,a),i=!1},d(a){ye(e,a)}}}function Mre(n){let e,t,i,s;const r=[Sre,Are],a=[];function o(l,c){return l[0]&&!l[3]?0:1}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=Xt()},l(l){t.l(l),i=Xt()},m(l,c){a[e].m(l,c),te(l,i,c),s=!0},p(l,[c]){let h=e;e=o(l),e===h?a[e].p(l,c):(yt(),q(a[h],1,1,()=>{a[h]=null}),wt(),t=a[e],t?t.p(l,c):(t=a[e]=r[e](l),t.c()),H(t,1),t.m(i.parentNode,i))},i(l){s||(H(t),s=!0)},o(l){q(t),s=!1},d(l){l&&E(i),a[e].d(l)}}}function Pre(n,e,t){let i,s,r;Oe(n,zd,S=>t(6,i=S)),Oe(n,a_,S=>t(7,s=S));const a=Ka(),o=qs("i18n");Oe(n,o,S=>t(8,r=S));let{show:l=!1}=e,c="tools",h="",u=!1,d=null,f={},g;const m=async()=>{g&&clearTimeout(g),g=setTimeout(()=>{p()},500)},x=async()=>{var S;if(t(3,u=!0),c==="tools"?(t(5,f=await WD(localStorage.token,h)),t(4,d=await KD(localStorage.token,h))):c==="functions"&&(t(5,f=await xL(localStorage.token,h)),t(4,d=await yL(localStorage.token,h))),d)for(const R in d.properties)((S=d.properties[R])==null?void 0:S.type)==="array"&&t(5,f[R]=(f[R]??[]).join(","),f);t(3,u=!1)},p=async()=>{var S;if(d){for(const R in d.properties)((S=d.properties[R])==null?void 0:S.type)==="array"&&t(5,f[R]=(f[R]??"").split(",").map(P=>P.trim()),f);if(c==="tools"){const R=await XD(localStorage.token,h,f).catch(P=>(on.error(`${P}`),null));R&&(on.success(r.t("Valves updated")),t(5,f=R))}else if(c==="functions"){const R=await wL(localStorage.token,h,f).catch(P=>(on.error(`${P}`),null));R&&(on.success(r.t("Valves updated")),t(5,f=R))}}},y=async()=>{t(3,u=!0),s===null&&a_.set(await bL(localStorage.token)),i===null&&zd.set(await Z6(localStorage.token)),t(3,u=!1)};function w(){c=t_(this),t(1,c)}function v(){h=t_(this),t(2,h),t(1,c)}const _=async()=>{await un()};function C(S){f=S,t(5,f)}const k=()=>{m()},I=()=>{p(),a("save")};return n.$$set=S=>{"show"in S&&t(0,l=S.show)},n.$$.update=()=>{n.$$.dirty&2&&c&&t(2,h=""),n.$$.dirty&4&&h&&x(),n.$$.dirty&1&&l&&y()},[l,c,h,u,d,f,i,s,r,a,o,m,p,w,v,_,C,k,I]}class Nre extends Ht{constructor(e){super(),zt(this,e,Pre,Mre,qt,{show:0})}}function XS(n,e,t){const i=n.slice();return i[15]=e[t],i[17]=t,i}function YS(n){let e,t,i,s;return e=new jg({props:{title:n[3].t("Files"),open:!0,buttonClassName:"w-full",$$slots:{content:[Ore]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment),t=Se(),i=ie("hr"),this.h()},l(r){ve(e.$$.fragment,r),t=Ie(r),i=se(r,"HR",{class:!0}),this.h()},h(){A(i,"class","my-2 border-gray-50 dark:border-gray-700/10")},m(r,a){xe(e,r,a),te(r,t,a),te(r,i,a),s=!0},p(r,a){const o={};a&8&&(o.title=r[3].t("Files")),a&262145&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){s||(H(e.$$.fragment,r),s=!0)},o(r){q(e.$$.fragment,r),s=!1},d(r){r&&(E(t),E(i)),ye(e,r)}}}function JS(n){var r,a;let e,t;function i(){return n[10](n[17])}function s(){return n[11](n[15])}return e=new RI({props:{className:"w-full",item:n[15],edit:!0,url:(r=n[15])!=null&&r.url?n[15].url:null,name:n[15].name,type:n[15].type,size:(a=n[15])==null?void 0:a.size,dismissible:!0}}),e.$on("dismiss",i),e.$on("click",s),{c(){be(e.$$.fragment)},l(o){ve(e.$$.fragment,o)},m(o,l){xe(e,o,l),t=!0},p(o,l){var h,u;n=o;const c={};l&1&&(c.item=n[15]),l&1&&(c.url=(h=n[15])!=null&&h.url?n[15].url:null),l&1&&(c.name=n[15].name),l&1&&(c.type=n[15].type),l&1&&(c.size=(u=n[15])==null?void 0:u.size),e.$set(c)},i(o){t||(H(e.$$.fragment,o),t=!0)},o(o){q(e.$$.fragment,o),t=!1},d(o){ye(e,o)}}}function Ore(n){let e,t,i=ni(n[0]),s=[];for(let a=0;a<i.length;a+=1)s[a]=JS(XS(n,i,a));const r=a=>q(s[a],1,1,()=>{s[a]=null});return{c(){e=ie("div");for(let a=0;a<s.length;a+=1)s[a].c();this.h()},l(a){e=se(a,"DIV",{class:!0,slot:!0});var o=V(e);for(let l=0;l<s.length;l+=1)s[l].l(o);o.forEach(E),this.h()},h(){A(e,"class","flex flex-col gap-1 mt-1.5"),A(e,"slot","content")},m(a,o){te(a,e,o);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);t=!0},p(a,o){if(o&1){i=ni(a[0]);let l;for(l=0;l<i.length;l+=1){const c=XS(a,i,l);s[l]?(s[l].p(c,o),H(s[l],1)):(s[l]=JS(c),s[l].c(),H(s[l],1),s[l].m(e,null))}for(yt(),l=i.length;l<s.length;l+=1)r(l);wt()}},i(a){if(!t){for(let o=0;o<i.length;o+=1)H(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)q(s[o]);t=!1},d(a){a&&E(e),vo(s,a)}}}function Dre(n){let e,t,i;return t=new Nre({props:{show:n[2]}}),{c(){e=ie("div"),be(t.$$.fragment),this.h()},l(s){e=se(s,"DIV",{class:!0,slot:!0});var r=V(e);ve(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"class","text-sm"),A(e,"slot","content")},m(s,r){te(s,e,r),xe(t,e,null),i=!0},p(s,r){const a={};r&4&&(a.show=s[2]),t.$set(a)},i(s){i||(H(t.$$.fragment,s),i=!0)},o(s){q(t.$$.fragment,s),i=!1},d(s){s&&E(e),ye(t)}}}function ZS(n){let e,t,i,s;return i=new jg({props:{title:n[3].t("System Prompt"),open:!0,buttonClassName:"w-full",$$slots:{content:[Lre]},$$scope:{ctx:n}}}),{c(){e=ie("hr"),t=Se(),be(i.$$.fragment),this.h()},l(r){e=se(r,"HR",{class:!0}),t=Ie(r),ve(i.$$.fragment,r),this.h()},h(){A(e,"class","my-2 border-gray-50 dark:border-gray-700/10")},m(r,a){te(r,e,a),te(r,t,a),xe(i,r,a),s=!0},p(r,a){const o={};a&8&&(o.title=r[3].t("System Prompt")),a&262186&&(o.$$scope={dirty:a,ctx:r}),i.$set(o)},i(r){s||(H(i.$$.fragment,r),s=!0)},o(r){q(i.$$.fragment,r),s=!1},d(r){r&&(E(e),E(t)),ye(i,r)}}}function Lre(n){let e,t,i,s,r,a;return{c(){e=ie("div"),t=ie("textarea"),this.h()},l(o){e=se(o,"DIV",{class:!0,slot:!0});var l=V(e);t=se(l,"TEXTAREA",{class:!0,rows:!0,placeholder:!0}),V(t).forEach(E),l.forEach(E),this.h()},h(){A(t,"class",i="w-full text-xs outline-hidden resize-vertical "+(n[5].highContrastMode?"border-2 border-gray-300 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800 p-2.5":"py-1.5 bg-transparent")),A(t,"rows","4"),A(t,"placeholder",s=n[3].t("Enter system prompt")),A(e,"class",""),A(e,"slot","content")},m(o,l){te(o,e,l),W(e,t),xo(t,n[1].system),r||(a=xt(t,"input",n[13]),r=!0)},p(o,l){l&32&&i!==(i="w-full text-xs outline-hidden resize-vertical "+(o[5].highContrastMode?"border-2 border-gray-300 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800 p-2.5":"py-1.5 bg-transparent"))&&A(t,"class",i),l&8&&s!==(s=o[3].t("Enter system prompt"))&&A(t,"placeholder",s),l&2&&xo(t,o[1].system)},d(o){o&&E(e),r=!1,a()}}}function QS(n){let e,t,i,s;return i=new jg({props:{title:n[3].t("Advanced Params"),open:!0,buttonClassName:"w-full",$$slots:{content:[Fre]},$$scope:{ctx:n}}}),{c(){e=ie("hr"),t=Se(),be(i.$$.fragment),this.h()},l(r){e=se(r,"HR",{class:!0}),t=Ie(r),ve(i.$$.fragment,r),this.h()},h(){A(e,"class","my-2 border-gray-50 dark:border-gray-700/10")},m(r,a){te(r,e,a),te(r,t,a),xe(i,r,a),s=!0},p(r,a){const o={};a&8&&(o.title=r[3].t("Advanced Params")),a&262162&&(o.$$scope={dirty:a,ctx:r}),i.$set(o)},i(r){s||(H(i.$$.fragment,r),s=!0)},o(r){q(i.$$.fragment,r),s=!1},d(r){r&&(E(e),E(t)),ye(i,r)}}}function Fre(n){var l;let e,t,i,s,r;function a(c){n[14](c)}let o={admin:((l=n[4])==null?void 0:l.role)==="admin",custom:!0};return n[1]!==void 0&&(o.params=n[1]),i=new pL({props:o}),Et.push(()=>Kt(i,"params",a)),{c(){e=ie("div"),t=ie("div"),be(i.$$.fragment),this.h()},l(c){e=se(c,"DIV",{class:!0,slot:!0});var h=V(e);t=se(h,"DIV",{});var u=V(t);ve(i.$$.fragment,u),u.forEach(E),h.forEach(E),this.h()},h(){A(e,"class","text-sm mt-1.5"),A(e,"slot","content")},m(c,h){te(c,e,h),W(e,t),xe(i,t,null),r=!0},p(c,h){var d;const u={};h&16&&(u.admin=((d=c[4])==null?void 0:d.role)==="admin"),!s&&h&2&&(s=!0,u.params=c[1],Wt(()=>s=!1)),i.$set(u)},i(c){r||(H(i.$$.fragment,c),r=!0)},o(c){q(i.$$.fragment,c),r=!1},d(c){c&&E(e),ye(i)}}}function Bre(n){var I,S,R,P,D,U;let e,t,i,s=n[3].t("Chat Controls")+"",r,a,o,l,c,h,u,d,f,g,m,x,p,y;l=new qg({props:{className:"size-3.5"}});let w=n[0].length>0&&YS(n);function v(T){n[12](T)}let _={title:n[3].t("Valves"),buttonClassName:"w-full",$$slots:{content:[Dre]},$$scope:{ctx:n}};n[2]!==void 0&&(_.open=n[2]),d=new jg({props:_}),Et.push(()=>Kt(d,"open",v));let C=(((I=n[4])==null?void 0:I.role)==="admin"||(((R=(S=n[4])==null?void 0:S.permissions.chat)==null?void 0:R.system_prompt)??!0))&&ZS(n),k=(((P=n[4])==null?void 0:P.role)==="admin"||(((U=(D=n[4])==null?void 0:D.permissions.chat)==null?void 0:U.controls)??!0))&&QS(n);return{c(){e=ie("div"),t=ie("div"),i=ie("div"),r=At(s),a=Se(),o=ie("button"),be(l.$$.fragment),c=Se(),h=ie("div"),w&&w.c(),u=Se(),be(d.$$.fragment),g=Se(),C&&C.c(),m=Se(),k&&k.c(),this.h()},l(T){e=se(T,"DIV",{class:!0});var G=V(e);t=se(G,"DIV",{class:!0});var M=V(t);i=se(M,"DIV",{class:!0});var F=V(i);r=St(F,s),F.forEach(E),a=Ie(M),o=se(M,"BUTTON",{class:!0});var X=V(o);ve(l.$$.fragment,X),X.forEach(E),M.forEach(E),c=Ie(G),h=se(G,"DIV",{class:!0});var z=V(h);w&&w.l(z),u=Ie(z),ve(d.$$.fragment,z),g=Ie(z),C&&C.l(z),m=Ie(z),k&&k.l(z),z.forEach(E),G.forEach(E),this.h()},h(){A(i,"class","text-lg font-medium self-center font-primary"),A(o,"class","self-center"),A(t,"class","flex items-center justify-between dark:text-gray-100 mb-2"),A(h,"class","dark:text-gray-200 text-sm font-primary py-0.5 px-0.5"),A(e,"class","dark:text-white")},m(T,G){te(T,e,G),W(e,t),W(t,i),W(i,r),W(t,a),W(t,o),xe(l,o,null),W(e,c),W(e,h),w&&w.m(h,null),W(h,u),xe(d,h,null),W(h,g),C&&C.m(h,null),W(h,m),k&&k.m(h,null),x=!0,p||(y=xt(o,"click",n[9]),p=!0)},p(T,[G]){var F,X,z,K,j,ae;(!x||G&8)&&s!==(s=T[3].t("Chat Controls")+"")&&Pt(r,s),T[0].length>0?w?(w.p(T,G),G&1&&H(w,1)):(w=YS(T),w.c(),H(w,1),w.m(h,u)):w&&(yt(),q(w,1,1,()=>{w=null}),wt());const M={};G&8&&(M.title=T[3].t("Valves")),G&262148&&(M.$$scope={dirty:G,ctx:T}),!f&&G&4&&(f=!0,M.open=T[2],Wt(()=>f=!1)),d.$set(M),((F=T[4])==null?void 0:F.role)==="admin"||(((z=(X=T[4])==null?void 0:X.permissions.chat)==null?void 0:z.system_prompt)??!0)?C?(C.p(T,G),G&16&&H(C,1)):(C=ZS(T),C.c(),H(C,1),C.m(h,m)):C&&(yt(),q(C,1,1,()=>{C=null}),wt()),((K=T[4])==null?void 0:K.role)==="admin"||(((ae=(j=T[4])==null?void 0:j.permissions.chat)==null?void 0:ae.controls)??!0)?k?(k.p(T,G),G&16&&H(k,1)):(k=QS(T),k.c(),H(k,1),k.m(h,null)):k&&(yt(),q(k,1,1,()=>{k=null}),wt())},i(T){x||(H(l.$$.fragment,T),H(w),H(d.$$.fragment,T),H(C),H(k),x=!0)},o(T){q(l.$$.fragment,T),q(w),q(d.$$.fragment,T),q(C),q(k),x=!1},d(T){T&&E(e),ye(l),w&&w.d(),ye(d),C&&C.d(),k&&k.d(),p=!1,y()}}}function Ure(n,e,t){let i,s,r;Oe(n,w0,y=>t(4,s=y)),Oe(n,ja,y=>t(5,r=y));const a=Ka(),o=qs("i18n");Oe(n,o,y=>t(3,i=y));let{models:l=[]}=e,{chatFiles:c=[]}=e,{params:h={}}=e,u=!1;const d=()=>{a("close")},f=y=>{c.splice(y,1),t(0,c)},g=y=>{};function m(y){u=y,t(2,u)}function x(){h.system=this.value,t(1,h)}function p(y){h=y,t(1,h)}return n.$$set=y=>{"models"in y&&t(8,l=y.models),"chatFiles"in y&&t(0,c=y.chatFiles),"params"in y&&t(1,h=y.params)},[c,h,u,i,s,r,a,o,l,d,f,g,m,x,p]}class jO extends Ht{constructor(e){super(),zt(this,e,Ure,Bre,qt,{models:8,chatFiles:0,params:1})}}function $S(n,e,t){const i=n.slice();return i[10]=e[t],i}function Hre(n){let e;const t=n[4].default,i=zs(t,n,n[8],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&256)&&js(i,t,s,s[8],e?Vs(t,s[8],r,null):Gs(s[8]),null)},i(s){e||(H(i,s),e=!0)},o(s){q(i,s),e=!1},d(s){i&&i.d(s)}}}function zre(n){var a;let e,t,i=(((a=n[10])==null?void 0:a.label)??"Camera")+"",s,r;return{c(){e=ie("div"),t=ie("div"),s=At(i),r=Se(),this.h()},l(o){e=se(o,"DIV",{class:!0});var l=V(e);t=se(l,"DIV",{class:!0});var c=V(t);s=St(c,i),c.forEach(E),l.forEach(E),r=Ie(o),this.h()},h(){A(t,"class","line-clamp-1"),A(e,"class","flex items-center")},m(o,l){te(o,e,l),W(e,t),W(t,s),te(o,r,l)},p(o,l){var c;l&2&&i!==(i=(((c=o[10])==null?void 0:c.label)??"Camera")+"")&&Pt(s,i)},d(o){o&&(E(e),E(r))}}}function eI(n){let e,t;function i(){return n[5](n[10])}return e=new ha({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[zre]},$$scope:{ctx:n}}}),e.$on("click",i),{c(){be(e.$$.fragment)},l(s){ve(e.$$.fragment,s)},m(s,r){xe(e,s,r),t=!0},p(s,r){n=s;const a={};r&258&&(a.$$scope={dirty:r,ctx:n}),e.$set(a)},i(s){t||(H(e.$$.fragment,s),t=!0)},o(s){q(e.$$.fragment,s),t=!1},d(s){ye(e,s)}}}function jre(n){let e,t,i=ni(n[1]),s=[];for(let a=0;a<i.length;a+=1)s[a]=eI($S(n,i,a));const r=a=>q(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=Xt()},l(a){for(let o=0;o<s.length;o+=1)s[o].l(a);e=Xt()},m(a,o){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(a,o);te(a,e,o),t=!0},p(a,o){if(o&10){i=ni(a[1]);let l;for(l=0;l<i.length;l+=1){const c=$S(a,i,l);s[l]?(s[l].p(c,o),H(s[l],1)):(s[l]=eI(c),s[l].c(),H(s[l],1),s[l].m(e.parentNode,e))}for(yt(),l=i.length;l<s.length;l+=1)r(l);wt()}},i(a){if(!t){for(let o=0;o<i.length;o+=1)H(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)q(s[o]);t=!1},d(a){a&&E(e),vo(s,a)}}}function Gre(n){let e,t,i;return t=new Q6({props:{class:"w-full max-w-[180px] rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-9999 bg-white dark:bg-gray-900 dark:text-white shadow-xs",sideOffset:6,side:"top",align:"start",transition:V5,$$slots:{default:[jre]},$$scope:{ctx:n}}}),{c(){e=ie("div"),be(t.$$.fragment),this.h()},l(s){e=se(s,"DIV",{slot:!0});var r=V(e);ve(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"slot","content")},m(s,r){te(s,e,r),xe(t,e,null),i=!0},p(s,r){const a={};r&258&&(a.$$scope={dirty:r,ctx:s}),t.$set(a)},i(s){i||(H(t.$$.fragment,s),i=!0)},o(s){q(t.$$.fragment,s),i=!1},d(s){s&&E(e),ye(t)}}}function Vre(n){let e,t,i;function s(a){n[6](a)}let r={$$slots:{content:[Gre],default:[Hre]},$$scope:{ctx:n}};return n[2]!==void 0&&(r.show=n[2]),e=new $6({props:r}),Et.push(()=>Kt(e,"show",s)),e.$on("change",n[7]),{c(){be(e.$$.fragment)},l(a){ve(e.$$.fragment,a)},m(a,o){xe(e,a,o),i=!0},p(a,[o]){const l={};o&258&&(l.$$scope={dirty:o,ctx:a}),!t&&o&4&&(t=!0,l.show=a[2],Wt(()=>t=!1)),e.$set(l)},i(a){i||(H(e.$$.fragment,a),i=!0)},o(a){q(e.$$.fragment,a),i=!1},d(a){ye(e,a)}}}function qre(n,e,t){let{$$slots:i={},$$scope:s}=e;qs("i18n");const r=Ka();let{onClose:a=()=>{}}=e,{devices:o}=e,l=!1;const c=d=>{r("change",d.deviceId)};function h(d){l=d,t(2,l)}const u=d=>{d.detail===!1&&a()};return n.$$set=d=>{"onClose"in d&&t(0,a=d.onClose),"devices"in d&&t(1,o=d.devices),"$$scope"in d&&t(8,s=d.$$scope)},[a,o,l,r,i,c,h,u,s]}class Wre extends Ht{constructor(e){super(),zt(this,e,qre,Vre,qt,{onClose:0,devices:1})}}function tI(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"></path></svg>',p,y,w,v=n[4]&&nI(n);function _(T,G){return T[4]?Jre:Zre}let C=_(n),k=C(n);const I=[nae,tae],S=[];function R(T,G){return T[4]?0:1}o=R(n),l=S[o]=I[o](n);function P(T,G){return T[1]?oae:T[2]?aae:rae}let D=P(n),U=D(n);return{c(){e=ie("div"),v&&v.c(),t=Se(),i=ie("div"),k.c(),s=Se(),r=ie("div"),a=ie("div"),l.c(),c=Se(),h=ie("div"),u=ie("button"),d=ie("div"),U.c(),f=Se(),g=ie("div"),m=ie("button"),m.innerHTML=x,this.h()},l(T){e=se(T,"DIV",{class:!0});var G=V(e);v&&v.l(G),t=Ie(G),i=se(G,"DIV",{class:!0});var M=V(i);k.l(M),M.forEach(E),s=Ie(G),r=se(G,"DIV",{class:!0});var F=V(r);a=se(F,"DIV",{});var X=V(a);l.l(X),X.forEach(E),c=Ie(F),h=se(F,"DIV",{});var z=V(h);u=se(z,"BUTTON",{type:!0});var K=V(u);d=se(K,"DIV",{class:!0});var j=V(d);U.l(j),j.forEach(E),K.forEach(E),z.forEach(E),f=Ie(F),g=se(F,"DIV",{});var ae=V(g);m=se(ae,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),_o(m)!=="svelte-1k5eavb"&&(m.innerHTML=x),ae.forEach(E),F.forEach(E),G.forEach(E),this.h()},h(){A(i,"class","flex justify-center items-center flex-1 h-full w-full max-h-full"),A(d,"class","line-clamp-1 text-sm font-medium"),A(u,"type","button"),A(m,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),A(m,"type","button"),A(r,"class","flex justify-between items-center pb-2 w-full"),A(e,"class","max-w-lg w-full h-full max-h-[100dvh] flex flex-col justify-between p-3 md:p-6")},m(T,G){te(T,e,G),v&&v.m(e,null),W(e,t),W(e,i),k.m(i,null),W(e,s),W(e,r),W(r,a),S[o].m(a,null),W(r,c),W(r,h),W(h,u),W(u,d),U.m(d,null),W(r,f),W(r,g),W(g,m),p=!0,y||(w=[xt(u,"click",n[31]),xt(m,"click",n[32])],y=!0)},p(T,G){T[4]?v?v.p(T,G):(v=nI(T),v.c(),v.m(e,t)):v&&(v.d(1),v=null),C===(C=_(T))&&k?k.p(T,G):(k.d(1),k=C(T),k&&(k.c(),k.m(i,null)));let M=o;o=R(T),o===M?S[o].p(T,G):(yt(),q(S[M],1,1,()=>{S[M]=null}),wt(),l=S[o],l?l.p(T,G):(l=S[o]=I[o](T),l.c()),H(l,1),l.m(a,null)),D===(D=P(T))&&U?U.p(T,G):(U.d(1),U=D(T),U&&(U.c(),U.m(d,null)))},i(T){p||(H(l),p=!0)},o(T){q(l),p=!1},d(T){T&&E(e),v&&v.d(),k.d(),S[o].d(),U.d(),y=!1,Zr(w)}}}function nI(n){let e,t,i;function s(o,l){return o[3]?Yre:o[1]||o[2]?Xre:Kre}let r=s(n),a=r(n);return{c(){e=ie("button"),a.c(),this.h()},l(o){e=se(o,"BUTTON",{type:!0,class:!0});var l=V(e);a.l(l),l.forEach(E),this.h()},h(){A(e,"type","button"),A(e,"class","flex justify-center items-center w-full h-20 min-h-20")},m(o,l){te(o,e,l),a.m(e,null),t||(i=xt(e,"click",n[26]),t=!0)},p(o,l){r===(r=s(o))&&a?a.p(o,l):(a.d(1),a=r(o),a&&(a.c(),a.m(e,null)))},d(o){o&&E(e),a.d(),t=!1,i()}}}function Kre(n){let e,t,i;return{c(){e=ie("div"),this.h()},l(s){e=se(s,"DIV",{class:!0,style:!0}),V(e).forEach(E),this.h()},h(){var s,r,a,o,l,c,h,u,d;A(e,"class",t=(n[6]*100>4?" size-[4.5rem]":n[6]*100>2?" size-16":n[6]*100>1?"size-14":"size-12")+" transition-all rounded-full "+((((a=(r=(s=n[0])==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:a.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")+" bg-black dark:bg-white"),A(e,"style",i=(((c=(l=(o=n[0])==null?void 0:o.info)==null?void 0:l.meta)==null?void 0:c.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(d=(u=(h=n[0])==null?void 0:h.info)==null?void 0:u.meta)==null?void 0:d.profile_image_url}');`:"")},m(s,r){te(s,e,r)},p(s,r){var a,o,l,c,h,u,d,f,g;r[0]&65&&t!==(t=(s[6]*100>4?" size-[4.5rem]":s[6]*100>2?" size-16":s[6]*100>1?"size-14":"size-12")+" transition-all rounded-full "+((((l=(o=(a=s[0])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:l.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")+" bg-black dark:bg-white")&&A(e,"class",t),r[0]&1&&i!==(i=(((u=(h=(c=s[0])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(g=(f=(d=s[0])==null?void 0:d.info)==null?void 0:f.meta)==null?void 0:g.profile_image_url}');`:"")&&A(e,"style",i)},d(s){s&&E(e)}}}function Xre(n){let e,t,i,s,r,a;return{c(){e=lt("svg"),t=lt("style"),i=At(`.spinner_qM83 {
								animation: spinner_8HQG 1.05s infinite;
							}
							.spinner_oXPr {
								animation-delay: 0.1s;
							}
							.spinner_ZTLf {
								animation-delay: 0.2s;
							}
							@keyframes spinner_8HQG {
								0%,
								57.14% {
									animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
									transform: translate(0);
								}
								28.57% {
									animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
									transform: translateY(-6px);
								}
								100% {
									transform: translate(0);
								}
							}
						`),s=lt("circle"),r=lt("circle"),a=lt("circle"),this.h()},l(o){e=ct(o,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var l=V(e);t=ct(l,"style",{});var c=V(t);i=St(c,`.spinner_qM83 {
								animation: spinner_8HQG 1.05s infinite;
							}
							.spinner_oXPr {
								animation-delay: 0.1s;
							}
							.spinner_ZTLf {
								animation-delay: 0.2s;
							}
							@keyframes spinner_8HQG {
								0%,
								57.14% {
									animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
									transform: translate(0);
								}
								28.57% {
									animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
									transform: translateY(-6px);
								}
								100% {
									transform: translate(0);
								}
							}
						`),c.forEach(E),s=ct(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),V(s).forEach(E),r=ct(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),V(r).forEach(E),a=ct(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),V(a).forEach(E),l.forEach(E),this.h()},h(){A(s,"class","spinner_qM83"),A(s,"cx","4"),A(s,"cy","12"),A(s,"r","3"),A(r,"class","spinner_qM83 spinner_oXPr"),A(r,"cx","12"),A(r,"cy","12"),A(r,"r","3"),A(a,"class","spinner_qM83 spinner_ZTLf"),A(a,"cx","20"),A(a,"cy","12"),A(a,"r","3"),A(e,"class","size-12 text-gray-900 dark:text-gray-400"),A(e,"viewBox","0 0 24 24"),A(e,"fill","currentColor"),A(e,"xmlns","http://www.w3.org/2000/svg")},m(o,l){te(o,e,l),W(e,t),W(t,i),W(e,s),W(e,r),W(e,a)},p:It,d(o){o&&E(e)}}}function Yre(n){let e,t;return{c(){e=ie("div"),t=At(n[3]),this.h()},l(i){e=se(i,"DIV",{class:!0,style:!0});var s=V(e);t=St(s,n[3]),s.forEach(E),this.h()},h(){A(e,"class","transition-all rounded-full"),tn(e,"font-size",(n[6]*100>4?"4.5":n[6]*100>2?"4.25":n[6]*100>1?"3.75":"3.5")+"rem"),tn(e,"width","100%"),tn(e,"text-align","center")},m(i,s){te(i,e,s),W(e,t)},p(i,s){s[0]&8&&Pt(t,i[3]),s[0]&64&&tn(e,"font-size",(i[6]*100>4?"4.5":i[6]*100>2?"4.25":i[6]*100>1?"3.75":"3.5")+"rem")},d(i){i&&E(e)}}}function Jre(n){let e,t,i,s,r,a,o,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path d="M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"></path></svg>',c,h;return{c(){e=ie("div"),t=ie("video"),i=Se(),s=ie("canvas"),r=Se(),a=ie("div"),o=ie("button"),o.innerHTML=l,this.h()},l(u){e=se(u,"DIV",{class:!0});var d=V(e);t=se(d,"VIDEO",{id:!0,class:!0}),V(t).forEach(E),i=Ie(d),s=se(d,"CANVAS",{id:!0,style:!0}),V(s).forEach(E),r=Ie(d),a=se(d,"DIV",{class:!0});var f=V(a);o=se(f,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),_o(o)!=="svelte-16ul42n"&&(o.innerHTML=l),f.forEach(E),d.forEach(E),this.h()},h(){A(t,"id","camera-feed"),t.autoplay=!0,A(t,"class","rounded-2xl h-full min-w-full object-cover object-center"),t.playsInline=!0,A(s,"id","camera-canvas"),tn(s,"display","none"),A(o,"type","button"),A(o,"class","p-1.5 text-white cursor-pointer backdrop-blur-xl bg-black/10 rounded-full"),A(a,"class","absolute top-4 md:top-8 left-4"),A(e,"class","relative flex video-container w-full max-h-full pt-2 pb-4 md:py-6 px-2 h-full")},m(u,d){te(u,e,d),W(e,t),W(e,i),W(e,s),W(e,r),W(e,a),W(a,o),c||(h=xt(o,"click",n[28]),c=!0)},p:It,d(u){u&&E(e),c=!1,h()}}}function Zre(n){let e,t,i;function s(o,l){return o[3]?eae:o[1]||o[2]?$re:Qre}let r=s(n),a=r(n);return{c(){e=ie("button"),a.c(),this.h()},l(o){e=se(o,"BUTTON",{type:!0});var l=V(e);a.l(l),l.forEach(E),this.h()},h(){A(e,"type","button")},m(o,l){te(o,e,l),a.m(e,null),t||(i=xt(e,"click",n[27]),t=!0)},p(o,l){r===(r=s(o))&&a?a.p(o,l):(a.d(1),a=r(o),a&&(a.c(),a.m(e,null)))},d(o){o&&E(e),a.d(),t=!1,i()}}}function Qre(n){let e,t,i;return{c(){e=ie("div"),this.h()},l(s){e=se(s,"DIV",{class:!0,style:!0}),V(e).forEach(E),this.h()},h(){var s,r,a,o,l,c,h,u,d;A(e,"class",t=(n[6]*100>4?" size-52":n[6]*100>2?"size-48":n[6]*100>1?"size-44":"size-40")+" transition-all rounded-full "+((((a=(r=(s=n[0])==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:a.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")),A(e,"style",i=(((c=(l=(o=n[0])==null?void 0:o.info)==null?void 0:l.meta)==null?void 0:c.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(d=(u=(h=n[0])==null?void 0:h.info)==null?void 0:u.meta)==null?void 0:d.profile_image_url}');`:"")},m(s,r){te(s,e,r)},p(s,r){var a,o,l,c,h,u,d,f,g;r[0]&65&&t!==(t=(s[6]*100>4?" size-52":s[6]*100>2?"size-48":s[6]*100>1?"size-44":"size-40")+" transition-all rounded-full "+((((l=(o=(a=s[0])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:l.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white"))&&A(e,"class",t),r[0]&1&&i!==(i=(((u=(h=(c=s[0])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(g=(f=(d=s[0])==null?void 0:d.info)==null?void 0:f.meta)==null?void 0:g.profile_image_url}');`:"")&&A(e,"style",i)},d(s){s&&E(e)}}}function $re(n){let e,t,i,s,r,a;return{c(){e=lt("svg"),t=lt("style"),i=At(`.spinner_qM83 {
									animation: spinner_8HQG 1.05s infinite;
								}
								.spinner_oXPr {
									animation-delay: 0.1s;
								}
								.spinner_ZTLf {
									animation-delay: 0.2s;
								}
								@keyframes spinner_8HQG {
									0%,
									57.14% {
										animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
										transform: translate(0);
									}
									28.57% {
										animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
										transform: translateY(-6px);
									}
									100% {
										transform: translate(0);
									}
								}
							`),s=lt("circle"),r=lt("circle"),a=lt("circle"),this.h()},l(o){e=ct(o,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var l=V(e);t=ct(l,"style",{});var c=V(t);i=St(c,`.spinner_qM83 {
									animation: spinner_8HQG 1.05s infinite;
								}
								.spinner_oXPr {
									animation-delay: 0.1s;
								}
								.spinner_ZTLf {
									animation-delay: 0.2s;
								}
								@keyframes spinner_8HQG {
									0%,
									57.14% {
										animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
										transform: translate(0);
									}
									28.57% {
										animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
										transform: translateY(-6px);
									}
									100% {
										transform: translate(0);
									}
								}
							`),c.forEach(E),s=ct(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),V(s).forEach(E),r=ct(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),V(r).forEach(E),a=ct(l,"circle",{class:!0,cx:!0,cy:!0,r:!0}),V(a).forEach(E),l.forEach(E),this.h()},h(){A(s,"class","spinner_qM83"),A(s,"cx","4"),A(s,"cy","12"),A(s,"r","3"),A(r,"class","spinner_qM83 spinner_oXPr"),A(r,"cx","12"),A(r,"cy","12"),A(r,"r","3"),A(a,"class","spinner_qM83 spinner_ZTLf"),A(a,"cx","20"),A(a,"cy","12"),A(a,"r","3"),A(e,"class","size-44 text-gray-900 dark:text-gray-400"),A(e,"viewBox","0 0 24 24"),A(e,"fill","currentColor"),A(e,"xmlns","http://www.w3.org/2000/svg")},m(o,l){te(o,e,l),W(e,t),W(t,i),W(e,s),W(e,r),W(e,a)},p:It,d(o){o&&E(e)}}}function eae(n){let e,t;return{c(){e=ie("div"),t=At(n[3]),this.h()},l(i){e=se(i,"DIV",{class:!0,style:!0});var s=V(e);t=St(s,n[3]),s.forEach(E),this.h()},h(){A(e,"class","transition-all rounded-full"),tn(e,"font-size",(n[6]*100>4?"13":n[6]*100>2?"12":n[6]*100>1?"11.5":"11")+"rem"),tn(e,"width","100%"),tn(e,"text-align","center")},m(i,s){te(i,e,s),W(e,t)},p(i,s){s[0]&8&&Pt(t,i[3]),s[0]&64&&tn(e,"font-size",(i[6]*100>4?"13":i[6]*100>2?"12":i[6]*100>1?"11.5":"11")+"rem")},d(i){i&&E(e)}}}function tae(n){let e,t;return e=new yi({props:{content:n[11].t("Camera"),$$slots:{default:[iae]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&2048&&(r.content=i[11].t("Camera")),s[2]&16&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function nae(n){let e,t;return e=new Wre({props:{devices:n[8],$$slots:{default:[sae]},$$scope:{ctx:n}}}),e.$on("change",n[29]),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&256&&(r.devices=i[8]),s[2]&16&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function iae(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"></path></svg>',i,s;return{c(){e=ie("button"),e.innerHTML=t,this.h()},l(r){e=se(r,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),_o(e)!=="svelte-1n1gs9g"&&(e.innerHTML=t),this.h()},h(){A(e,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),A(e,"type","button")},m(r,a){te(r,e,a),i||(s=xt(e,"click",n[30]),i=!0)},p:It,d(r){r&&E(e),i=!1,s()}}}function sae(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z" clip-rule="evenodd"></path></svg>';return{c(){e=ie("button"),e.innerHTML=t,this.h()},l(i){e=se(i,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),_o(e)!=="svelte-5e0pue"&&(e.innerHTML=t),this.h()},h(){A(e,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),A(e,"type","button")},m(i,s){te(i,e,s)},p:It,d(i){i&&E(e)}}}function rae(n){let e=n[11].t("Listening...")+"",t;return{c(){t=At(e)},l(i){t=St(i,e)},m(i,s){te(i,t,s)},p(i,s){s[0]&2048&&e!==(e=i[11].t("Listening...")+"")&&Pt(t,e)},d(i){i&&E(t)}}}function aae(n){let e=n[11].t("Tap to interrupt")+"",t;return{c(){t=At(e)},l(i){t=St(i,e)},m(i,s){te(i,t,s)},p(i,s){s[0]&2048&&e!==(e=i[11].t("Tap to interrupt")+"")&&Pt(t,e)},d(i){i&&E(t)}}}function oae(n){let e=n[11].t("Thinking...")+"",t;return{c(){t=At(e)},l(i){t=St(i,e)},m(i,s){te(i,t,s)},p(i,s){s[0]&2048&&e!==(e=i[11].t("Thinking...")+"")&&Pt(t,e)},d(i){i&&E(t)}}}function lae(n){let e,t,i=n[10]&&tI(n);return{c(){i&&i.c(),e=Xt()},l(s){i&&i.l(s),e=Xt()},m(s,r){i&&i.m(s,r),te(s,e,r),t=!0},p(s,r){s[10]?i?(i.p(s,r),r[0]&1024&&H(i,1)):(i=tI(s),i.c(),H(i,1),i.m(e.parentNode,e)):i&&(yt(),q(i,1,1,()=>{i=null}),wt())},i(s){t||(H(i),t=!0)},o(s){q(i),t=!1},d(s){s&&E(e),i&&i.d(s)}}}function cae(n,e,t){let i,s,r,a,o,l;Oe(n,Vg,Me=>t(45,i=Me)),Oe(n,Gg,Me=>t(46,s=Me)),Oe(n,ja,Me=>t(47,r=Me)),Oe(n,Jw,Me=>t(48,a=Me)),Oe(n,Fa,Me=>t(10,o=Me));const c=Ka(),h=qs("i18n");Oe(n,h,Me=>t(11,l=Me));let{eventTarget:u}=e,{submitPrompt:d}=e,{stopResponse:f}=e,{files:g}=e,{chatId:m}=e,{modelId:x}=e,p=null,y=null,w=!1,v=!1,_=!1,C=null,k=!1,I=null,S=!1,R=0,P=!1,D,U=null,T=[],G=[],M=null;const F=async()=>{const Me=await navigator.mediaDevices.enumerateDevices();t(8,G=Me.filter(Dt=>Dt.kind==="videoinput")),navigator.mediaDevices.getDisplayMedia&&t(8,G=[...G,{deviceId:"screen",label:"Screen Share"}]),M===null&&G.length>0&&t(9,M=G[0].deviceId)},X=async()=>{if(await F(),I===null){t(4,k=!0),await un();try{await z()}catch(Me){console.error("Error accessing webcam: ",Me)}}},z=async()=>{const Me=document.getElementById("camera-feed");Me&&(M==="screen"?t(5,I=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1})):t(5,I=await navigator.mediaDevices.getUserMedia({video:{deviceId:M?{exact:M}:void 0}})),I&&(await F(),Me.srcObject=I,await Me.play()))},K=async()=>{I&&I.getTracks().forEach(Dt=>Dt.stop()),t(5,I=null)},j=()=>{const Me=document.getElementById("camera-feed"),Dt=document.getElementById("camera-canvas");if(!Dt)return;const gt=Dt.getContext("2d");Dt.width=Me.videoWidth,Dt.height=Me.videoHeight,gt.drawImage(Me,0,0,Me.videoWidth,Me.videoHeight);const jt=Dt.toDataURL("image/png");return jt},ae=async()=>{await K(),t(4,k=!1)},ge=-55,ue=async Me=>{var jt,Fn;await un();const Dt=ED(Me,"recording.wav"),gt=await CL(localStorage.token,Dt,(Fn=(jt=r==null?void 0:r.audio)==null?void 0:jt.stt)==null?void 0:Fn.language).catch(Kn=>(on.error(`${Kn}`),null));if(gt&&(gt.text,gt.text!=="")){const Kn=await d(gt.text,{_raw:!0})}},pe=async(Me=!0)=>{if(o){const Dt=T.slice(0);if(T=[],D=!1,Me&&de(),v){if(t(1,w=!0),t(3,C=null),I){const jt=j();t(20,g=[{type:"image",url:jt}])}const gt=new Blob(Dt,{type:"audio/wav"});await ue(gt),v=!1,t(1,w=!1)}}else T=[],D=!1,U&&U.getTracks().forEach(gt=>gt.stop()),t(7,U=null)},de=async()=>{o&&(U||t(7,U=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}})),D=new MediaRecorder(U),D.onstart=()=>{T=[]},D.ondataavailable=Me=>{P&&T.push(Me.data)},D.onstop=Me=>{pe()},le(U))},O=async()=>{try{D&&D.stop()}catch(Me){}U&&(U.getAudioTracks().forEach(function(Me){Me.stop()}),t(7,U=null))},Y=Me=>{let Dt=0;for(let gt=0;gt<Me.length;gt++){const jt=(Me[gt]-128)/128;Dt+=jt*jt}return Math.sqrt(Dt/Me.length)},le=Me=>{const Dt=new AudioContext,gt=Dt.createMediaStreamSource(Me),jt=Dt.createAnalyser();jt.minDecibels=ge,gt.connect(jt);const Fn=jt.frequencyBinCount,Kn=new Uint8Array(Fn),ci=new Uint8Array(jt.fftSize);let ji=Date.now();P=!1,(()=>{const hi=()=>{if(!D||!o)return;if(_&&!((r==null?void 0:r.voiceInterruption)??!1)?(jt.maxDecibels=0,jt.minDecibels=-1):(jt.minDecibels=ge,jt.maxDecibels=-30),jt.getByteTimeDomainData(ci),jt.getByteFrequencyData(Kn),t(6,R=Y(ci)),Kn.some(ys=>ys>0)&&(D&&D.state!=="recording"&&D.start(),P||(P=!0,je()),ji=Date.now()),P&&Date.now()-ji>2e3&&(v=!0,D)){D.stop();return}window.requestAnimationFrame(hi)};window.requestAnimationFrame(hi)})()};let $={},re=null,oe=null;const ee=Me=>o?new Promise(Dt=>{let gt=[];const jt=setInterval(async()=>{var Fn,Kn,ci;if(gt=await speechSynthesis.getVoices(),gt.length>0){clearInterval(jt);const ji=((Fn=gt==null?void 0:gt.filter(xs=>{var hi,qi,ys,ki;return xs.voiceURI===(((qi=(hi=r==null?void 0:r.audio)==null?void 0:hi.tts)==null?void 0:qi.voice)??((ki=(ys=s==null?void 0:s.audio)==null?void 0:ys.tts)==null?void 0:ki.voice))}))==null?void 0:Fn.at(0))??void 0;oe=new SpeechSynthesisUtterance(Me),oe.rate=((ci=(Kn=r.audio)==null?void 0:Kn.tts)==null?void 0:ci.playbackRate)??1,ji&&(oe.voice=ji),speechSynthesis.speak(oe),oe.onend=async xs=>{await new Promise(hi=>setTimeout(hi,200)),Dt(xs)}}},100)}):Promise.resolve(),Q=Me=>o?new Promise(Dt=>{var jt,Fn;const gt=document.getElementById("audioElement");gt&&(gt.src=Me.src,gt.muted=!0,gt.playbackRate=((Fn=(jt=r.audio)==null?void 0:jt.tts)==null?void 0:Fn.playbackRate)??1,gt.play().then(()=>{gt.muted=!1}).catch(Kn=>{console.error(Kn)}),gt.onended=async Kn=>{await new Promise(ci=>setTimeout(ci,100)),Dt(Kn)})}):Promise.resolve(),je=async()=>{t(2,_=!1),S&&f(),oe&&(speechSynthesis.cancel(),oe=null);const Me=document.getElementById("audioElement");Me&&(Me.muted=!0,Me.pause(),Me.currentTime=0)};let Re=new AbortController;const Ne=new Map,He=new Map,Be=async Me=>{var Dt,gt,jt,Fn,Kn,ci,ji,xs,hi,qi,ys,ki,Tr,Ks;if(!Ne.has(Me))try{if((r==null?void 0:r.showEmojiInCall)??!1){const Ss=await HD(localStorage.token,x,Me,m);Ss&&He.set(Me,Ss)}if(((gt=(Dt=r.audio)==null?void 0:Dt.tts)==null?void 0:gt.engine)==="browser-kokoro"){const Ss=await a.generate({text:Me,voice:((Fn=(jt=r==null?void 0:r.audio)==null?void 0:jt.tts)==null?void 0:Fn.voice)??((ci=(Kn=s==null?void 0:s.audio)==null?void 0:Kn.tts)==null?void 0:ci.voice)}).catch(De=>{console.error(De),on.error(`${De}`)});Ss&&Ne.set(Me,new Audio(Ss))}else if(s.audio.tts.engine!==""){const Ss=await kL(localStorage.token,((xs=(ji=r==null?void 0:r.audio)==null?void 0:ji.tts)==null?void 0:xs.defaultVoice)===s.audio.tts.voice?((qi=(hi=r==null?void 0:r.audio)==null?void 0:hi.tts)==null?void 0:qi.voice)??((ki=(ys=s==null?void 0:s.audio)==null?void 0:ys.tts)==null?void 0:ki.voice):(Ks=(Tr=s==null?void 0:s.audio)==null?void 0:Tr.tts)==null?void 0:Ks.voice,Me).catch(De=>(console.error(De),null));if(Ss){const De=await Ss.blob(),qe=URL.createObjectURL(De);Ne.set(Me,new Audio(qe))}}else Ne.set(Me,!0)}catch(Ss){console.error("Error synthesizing speech:",Ss)}return Ne.get(Me)};let Je={};const ht=async(Me,Dt)=>{for(;!Dt.aborted;)if(Je[Me]&&Je[Me].length>0){const gt=Je[Me].shift();if(Ne.has(gt))if(((r==null?void 0:r.showEmojiInCall)??!1)&&He.has(gt)?t(3,C=He.get(gt)):t(3,C=null),s.audio.tts.engine!=="")try{`${gt}`;const jt=Ne.get(gt);await Q(jt),`${gt}`,await new Promise(Fn=>setTimeout(Fn,200))}catch(jt){console.error("Error playing audio:",jt)}else await ee(gt);else Je[Me].unshift(gt),`${gt}`,await new Promise(jt=>setTimeout(jt,200))}else if($[Me]&&Je[Me]&&Je[Me].length===0){t(2,_=!1);break}else await new Promise(gt=>setTimeout(gt,200));`${Me}`},ot=async Me=>{const{id:Dt}=Me.detail;S=!0,re!==Dt&&(`${Dt}`,re=Dt,Re&&Re.abort(),Re=new AbortController,t(2,_=!0),ht(Dt,Re.signal))},Ye=async Me=>{const{id:Dt,content:gt}=Me.detail;if(re===Dt){`${Dt}${gt}`;try{Je[Dt]===void 0?Je[Dt]=[gt]:Je[Dt].push(gt),Be(gt)}catch(jt){console.error("Failed to fetch or play audio:",jt)}}},rt=async Me=>{const{id:Dt,content:gt}=Me.detail;$[Dt]=!0,S=!1};ol(async()=>{const Me=async()=>{try{p=await navigator.wakeLock.request("screen")}catch(Dt){}p&&p.addEventListener("release",()=>{})};return"wakeLock"in navigator&&(await Me(),document.addEventListener("visibilitychange",async()=>{p!==null&&document.visibilityState==="visible"&&await Me()})),t(0,y=i.find(Dt=>Dt.id===x)),de(),u.addEventListener("chat:start",ot),u.addEventListener("chat",Ye),u.addEventListener("chat:finish",rt),async()=>{await je(),O(),u.removeEventListener("chat:start",ot),u.removeEventListener("chat",Ye),u.removeEventListener("chat:finish",rt),Re.abort(),await un(),await je(),await pe(!1),await ae()}}),Gh(async()=>{await je(),await pe(!1),await ae(),await O(),u.removeEventListener("chat:start",ot),u.removeEventListener("chat",Ye),u.removeEventListener("chat:finish",rt),Re.abort(),await un(),await je()});const me=()=>{_&&je()},Mt=()=>{_&&je()},ut=()=>{ae()},dt=async Me=>{Me.detail,t(9,M=Me.detail),await K(),await z()},Ve=async()=>{await navigator.mediaDevices.getUserMedia({video:!0}),X()},Ot=()=>{_&&je()},rn=async()=>{await O(),await K(),Fa.set(!1),c("close")};return n.$$set=Me=>{"eventTarget"in Me&&t(21,u=Me.eventTarget),"submitPrompt"in Me&&t(22,d=Me.submitPrompt),"stopResponse"in Me&&t(23,f=Me.stopResponse),"files"in Me&&t(20,g=Me.files),"chatId"in Me&&t(24,m=Me.chatId),"modelId"in Me&&t(25,x=Me.modelId)},[y,w,_,C,k,I,R,U,G,M,o,l,c,h,X,z,K,ae,O,je,g,u,d,f,m,x,me,Mt,ut,dt,Ve,Ot,rn]}class GO extends Ht{constructor(e){super(),zt(this,e,cae,lae,qt,{eventTarget:21,submitPrompt:22,stopResponse:23,files:20,chatId:24,modelId:25},null,[-1,-1,-1])}}function hae(n){var v,_,C,k,I,S,R,P,D,U;let e,t,i,s,r,a,o=(((_=(v=n[0])==null?void 0:v.model)==null?void 0:_.name)??((k=(C=n[0])==null?void 0:C.message)==null?void 0:k.model)??"Assistant")+"",l,c,h,u,d,f,g,m,x;t=new PI({props:{src:((P=(R=(S=(I=n[0])==null?void 0:I.model)==null?void 0:S.info)==null?void 0:R.meta)==null?void 0:P.profile_image_url)??"",className:"size-5 -translate-y-[1px]"}}),u=new _L({props:{className:"size-3 "+((U=(D=n[0])==null?void 0:D.message)!=null&&U.favorite?"fill-red-500 stroke-red-500":"hover:fill-red-500 hover:stroke-red-500")+" ",strokeWidth:"2.5"}});function p(T,G){var M,F;return(F=(M=T[0])==null?void 0:M.message)!=null&&F.error?fae:dae}let y=p(n),w=y(n);return{c(){e=ie("div"),be(t.$$.fragment),i=Se(),s=ie("div"),r=ie("div"),a=ie("div"),l=At(o),c=Se(),h=ie("button"),be(u.$$.fragment),f=Se(),w.c(),this.h()},l(T){e=se(T,"DIV",{class:!0});var G=V(e);ve(t.$$.fragment,G),i=Ie(G),s=se(G,"DIV",{class:!0});var M=V(s);r=se(M,"DIV",{class:!0});var F=V(r);a=se(F,"DIV",{class:!0});var X=V(a);l=St(X,o),X.forEach(E),c=Ie(F),h=se(F,"BUTTON",{class:!0});var z=V(h);ve(u.$$.fragment,z),z.forEach(E),F.forEach(E),f=Ie(M),w.l(M),M.forEach(E),G.forEach(E),this.h()},h(){var T,G;A(a,"class","text-xs text-black dark:text-white font-medium line-clamp-1"),A(h,"class",d=(G=(T=n[0])==null?void 0:T.message)!=null&&G.favorite?"":"invisible group-hover:visible"),A(r,"class","flex justify-between items-center"),A(s,"class","ml-2"),A(e,"class","flex w-full")},m(T,G){te(T,e,G),xe(t,e,null),W(e,i),W(e,s),W(s,r),W(r,a),W(a,l),W(r,c),W(r,h),xe(u,h,null),W(s,f),w.m(s,null),g=!0,m||(x=xt(h,"click",n[1]),m=!0)},p(T,G){var X,z,K,j,ae,ge,ue,pe,de,O,Y,le;const M={};G&1&&(M.src=((j=(K=(z=(X=T[0])==null?void 0:X.model)==null?void 0:z.info)==null?void 0:K.meta)==null?void 0:j.profile_image_url)??""),t.$set(M),(!g||G&1)&&o!==(o=(((ge=(ae=T[0])==null?void 0:ae.model)==null?void 0:ge.name)??((pe=(ue=T[0])==null?void 0:ue.message)==null?void 0:pe.model)??"Assistant")+"")&&Pt(l,o);const F={};G&1&&(F.className="size-3 "+((O=(de=T[0])==null?void 0:de.message)!=null&&O.favorite?"fill-red-500 stroke-red-500":"hover:fill-red-500 hover:stroke-red-500")+" "),u.$set(F),(!g||G&1&&d!==(d=(le=(Y=T[0])==null?void 0:Y.message)!=null&&le.favorite?"":"invisible group-hover:visible"))&&A(h,"class",d),y===(y=p(T))&&w?w.p(T,G):(w.d(1),w=y(T),w&&(w.c(),w.m(s,null)))},i(T){g||(H(t.$$.fragment,T),H(u.$$.fragment,T),g=!0)},o(T){q(t.$$.fragment,T),q(u.$$.fragment,T),g=!1},d(T){T&&E(e),ye(t),ye(u),w.d(),m=!1,x()}}}function uae(n){var g,m,x;let e,t,i,s,r,a,o=(((m=(g=n[0])==null?void 0:g.user)==null?void 0:m.name)??"User")+"",l,c,h;t=new PI({props:{src:((x=n[0].user)==null?void 0:x.profile_image_url)??`${Yo}/user.png`,className:"size-5 -translate-y-[1px]"}});function u(p,y){var w,v;return(v=(w=p[0])==null?void 0:w.message)!=null&&v.error?mae:gae}let d=u(n),f=d(n);return{c(){e=ie("div"),be(t.$$.fragment),i=Se(),s=ie("div"),r=ie("div"),a=ie("div"),l=At(o),c=Se(),f.c(),this.h()},l(p){e=se(p,"DIV",{class:!0});var y=V(e);ve(t.$$.fragment,y),i=Ie(y),s=se(y,"DIV",{class:!0});var w=V(s);r=se(w,"DIV",{class:!0});var v=V(r);a=se(v,"DIV",{class:!0});var _=V(a);l=St(_,o),_.forEach(E),v.forEach(E),c=Ie(w),f.l(w),w.forEach(E),y.forEach(E),this.h()},h(){A(a,"class","text-xs text-black dark:text-white font-medium line-clamp-1"),A(r,"class","flex justify-between items-center"),A(s,"class","ml-2"),A(e,"class","flex w-full")},m(p,y){te(p,e,y),xe(t,e,null),W(e,i),W(e,s),W(s,r),W(r,a),W(a,l),W(s,c),f.m(s,null),h=!0},p(p,y){var v,_,C;const w={};y&1&&(w.src=((v=p[0].user)==null?void 0:v.profile_image_url)??`${Yo}/user.png`),t.$set(w),(!h||y&1)&&o!==(o=(((C=(_=p[0])==null?void 0:_.user)==null?void 0:C.name)??"User")+"")&&Pt(l,o),d===(d=u(p))&&f?f.p(p,y):(f.d(1),f=d(p),f&&(f.c(),f.m(s,null)))},i(p){h||(H(t.$$.fragment,p),h=!0)},o(p){q(t.$$.fragment,p),h=!1},d(p){p&&E(e),ye(t),f.d()}}}function dae(n){let e,t=n[0].message.content+"",i;return{c(){e=ie("div"),i=At(t),this.h()},l(s){e=se(s,"DIV",{class:!0});var r=V(e);i=St(r,t),r.forEach(E),this.h()},h(){A(e,"class","text-gray-500 line-clamp-2 text-xs mt-0.5")},m(s,r){te(s,e,r),W(e,i)},p(s,r){r&1&&t!==(t=s[0].message.content+"")&&Pt(i,t)},d(s){s&&E(e)}}}function fae(n){let e,t=n[0].message.error.content+"",i;return{c(){e=ie("div"),i=At(t),this.h()},l(s){e=se(s,"DIV",{class:!0});var r=V(e);i=St(r,t),r.forEach(E),this.h()},h(){A(e,"class","text-red-500 line-clamp-2 text-xs mt-0.5")},m(s,r){te(s,e,r),W(e,i)},p(s,r){r&1&&t!==(t=s[0].message.error.content+"")&&Pt(i,t)},d(s){s&&E(e)}}}function gae(n){let e,t=n[0].message.content+"",i;return{c(){e=ie("div"),i=At(t),this.h()},l(s){e=se(s,"DIV",{class:!0});var r=V(e);i=St(r,t),r.forEach(E),this.h()},h(){A(e,"class","text-gray-500 line-clamp-2 text-xs mt-0.5")},m(s,r){te(s,e,r),W(e,i)},p(s,r){r&1&&t!==(t=s[0].message.content+"")&&Pt(i,t)},d(s){s&&E(e)}}}function mae(n){let e,t=n[0].message.error.content+"",i;return{c(){e=ie("div"),i=At(t),this.h()},l(s){e=se(s,"DIV",{class:!0});var r=V(e);i=St(r,t),r.forEach(E),this.h()},h(){A(e,"class","text-red-500 line-clamp-2 text-xs mt-0.5")},m(s,r){te(s,e,r),W(e,i)},p(s,r){r&1&&t!==(t=s[0].message.error.content+"")&&Pt(i,t)},d(s){s&&E(e)}}}function pae(n){let e,t,i,s;const r=[uae,hae],a=[];function o(l,c){return l[0].message.role==="user"?0:1}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=Xt()},l(l){t.l(l),i=Xt()},m(l,c){a[e].m(l,c),te(l,i,c),s=!0},p(l,c){let h=e;e=o(l),e===h?a[e].p(l,c):(yt(),q(a[h],1,1,()=>{a[h]=null}),wt(),t=a[e],t?t.p(l,c):(t=a[e]=r[e](l),t.c()),H(t,1),t.m(i.parentNode,i))},i(l){s||(H(t),s=!0)},o(l){q(t),s=!1},d(l){l&&E(i),a[e].d(l)}}}function bae(n){var l,c;let e,t,i,s,r,a,o;return t=new yi({props:{content:(c=(l=n[0])==null?void 0:l.message)!=null&&c.error?n[0].message.error.content:n[0].message.content,class:"w-full",allowHTML:!1,$$slots:{default:[pae]},$$scope:{ctx:n}}}),s=new Ug({props:{type:"target",position:pn.Top,class:"w-2 rounded-full dark:bg-gray-900"}}),a=new Ug({props:{type:"source",position:pn.Bottom,class:"w-2 rounded-full dark:bg-gray-900"}}),{c(){e=ie("div"),be(t.$$.fragment),i=Se(),be(s.$$.fragment),r=Se(),be(a.$$.fragment),this.h()},l(h){e=se(h,"DIV",{class:!0});var u=V(e);ve(t.$$.fragment,u),i=Ie(u),ve(s.$$.fragment,u),r=Ie(u),ve(a.$$.fragment,u),u.forEach(E),this.h()},h(){A(e,"class","px-4 py-3 shadow-md rounded-xl dark:bg-black bg-white border dark:border-gray-900 w-60 h-20 group")},m(h,u){te(h,e,u),xe(t,e,null),W(e,i),xe(s,e,null),W(e,r),xe(a,e,null),o=!0},p(h,[u]){var f,g;const d={};u&1&&(d.content=(g=(f=h[0])==null?void 0:f.message)!=null&&g.error?h[0].message.error.content:h[0].message.content),u&5&&(d.$$scope={dirty:u,ctx:h}),t.$set(d)},i(h){o||(H(t.$$.fragment,h),H(s.$$.fragment,h),H(a.$$.fragment,h),o=!0)},o(h){q(t.$$.fragment,h),q(s.$$.fragment,h),q(a.$$.fragment,h),o=!1},d(h){h&&E(e),ye(t),ye(s),ye(a)}}}function xae(n,e,t){let{data:i}=e;const s=()=>{var r;t(0,i.message.favorite=!(((r=i==null?void 0:i.message)==null?void 0:r.favorite)??!1),i)};return n.$$set=r=>{"data"in r&&t(0,i=r.data)},[i,s]}let yae=class extends Ht{constructor(e){super(),zt(this,e,xae,bae,qt,{data:0})}};function wae(n){let e,t,i,s;return e=new hre({props:{showLock:!1}}),i=new _re({props:{variant:h0.Dots}}),{c(){be(e.$$.fragment),t=Se(),be(i.$$.fragment)},l(r){ve(e.$$.fragment,r),t=Ie(r),ve(i.$$.fragment,r)},m(r,a){xe(e,r,a),te(r,t,a),xe(i,r,a),s=!0},p:It,i(r){s||(H(e.$$.fragment,r),H(i.$$.fragment,r),s=!0)},o(r){q(e.$$.fragment,r),q(i.$$.fragment,r),s=!1},d(r){r&&E(t),ye(e,r),ye(i,r)}}}function vae(n){let e,t;return e=new Lse({props:{nodes:n[0],nodeTypes:n[1],edges:n[2],fitView:!0,minZoom:.001,colorMode:n[3].includes("dark")||n[3]==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",nodesConnectable:!1,nodesDraggable:!1,oninit:n[5],$$slots:{default:[wae]},$$scope:{ctx:n}}}),e.$on("nodeclick",n[6]),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,[s]){const r={};s&1&&(r.nodes=i[0]),s&2&&(r.nodeTypes=i[1]),s&4&&(r.edges=i[2]),s&8&&(r.colorMode=i[3].includes("dark")||i[3]==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),s&128&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function _ae(n,e,t){let i;Oe(n,mD,h=>t(3,i=h));const s=Ka();let{nodes:r}=e,{nodeTypes:a}=e,{edges:o}=e;const l=()=>{},c=h=>s("nodeclick",h.detail);return n.$$set=h=>{"nodes"in h&&t(0,r=h.nodes),"nodeTypes"in h&&t(1,a=h.nodeTypes),"edges"in h&&t(2,o=h.edges)},[r,a,o,i,s,l,c]}class kae extends Ht{constructor(e){super(),zt(this,e,_ae,vae,qt,{nodes:0,nodeTypes:1,edges:2})}}function Cae(n){let e,t;return{c(){e=lt("svg"),t=lt("path"),this.h()},l(i){e=ct(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=V(e);t=ct(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"d","M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width",n[1]),A(e,"stroke","currentColor"),A(e,"class",n[0])},m(i,s){te(i,e,s),W(e,t)},p(i,[s]){s&2&&A(e,"stroke-width",i[1]),s&1&&A(e,"class",i[0])},i:It,o:It,d(i){i&&E(e)}}}function Aae(n,e,t){let{className:i="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class VO extends Ht{constructor(e){super(),zt(this,e,Aae,Cae,qt,{className:0,strokeWidth:1})}}function iI(n){let e,t;return e=new kae({props:{nodes:n[6],nodeTypes:n[8],edges:n[7]}}),e.$on("nodeclick",n[12]),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p:It,i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Sae(n){let e,t,i,s,r,a,o,l=n[1].t("Chat Overview")+"",c,h,u,d,f,g,m,x;r=new VO({props:{className:"size-3.5"}}),d=new qg({props:{className:"size-3.5"}});let p=n[2].length>0&&iI(n);return{c(){e=ie("div"),t=ie("div"),i=ie("div"),s=ie("button"),be(r.$$.fragment),a=Se(),o=ie("div"),c=At(l),h=Se(),u=ie("button"),be(d.$$.fragment),f=Se(),p&&p.c(),this.h()},l(y){e=se(y,"DIV",{class:!0});var w=V(e);t=se(w,"DIV",{class:!0});var v=V(t);i=se(v,"DIV",{class:!0});var _=V(i);s=se(_,"BUTTON",{class:!0});var C=V(s);ve(r.$$.fragment,C),C.forEach(E),a=Ie(_),o=se(_,"DIV",{class:!0});var k=V(o);c=St(k,l),k.forEach(E),_.forEach(E),h=Ie(v),u=se(v,"BUTTON",{class:!0});var I=V(u);ve(d.$$.fragment,I),I.forEach(E),v.forEach(E),f=Ie(w),p&&p.l(w),w.forEach(E),this.h()},h(){A(s,"class","self-center p-0.5"),A(o,"class","text-lg font-medium self-center font-primary"),A(i,"class","flex items-center gap-2.5"),A(u,"class","self-center p-0.5"),A(t,"class","absolute z-50 w-full flex justify-between dark:text-gray-100 px-4 py-3.5"),A(e,"class","w-full h-full relative")},m(y,w){te(y,e,w),W(e,t),W(t,i),W(i,s),xe(r,s,null),W(i,a),W(i,o),W(o,c),W(t,h),W(t,u),xe(d,u,null),W(e,f),p&&p.m(e,null),g=!0,m||(x=[xt(s,"click",n[10]),xt(u,"click",n[11])],m=!0)},p(y,[w]){(!g||w&2)&&l!==(l=y[1].t("Chat Overview")+"")&&Pt(c,l),y[2].length>0?p?(p.p(y,w),w&4&&H(p,1)):(p=iI(y),p.c(),H(p,1),p.m(e,null)):p&&(yt(),q(p,1,1,()=>{p=null}),wt())},i(y){g||(H(r.$$.fragment,y),H(d.$$.fragment,y),H(p),g=!0)},o(y){q(r.$$.fragment,y),q(d.$$.fragment,y),q(p),g=!1},d(y){y&&E(e),ye(r),ye(d),p&&p.d(),m=!1,Zr(x)}}}function Iae(n,e,t){let i,s,r,a;Oe(n,Vg,S=>t(13,i=S)),Oe(n,w0,S=>t(14,s=S));const o=Ka(),l=qs("i18n");Oe(n,l,S=>t(1,r=S));const{width:c,height:h}=es(),{fitView:u,getViewport:d}=kre(),f=Cre();let{history:g}=e,m=null;const x=$t([]);Oe(n,x,S=>t(2,a=S));const p=$t([]),y={custom:yae},w=async()=>{m===null?await u({nodes:[{id:g.currentId}]}):await u({nodes:[{id:m}]}),t(0,m=null)},v=async()=>{const S=[],R=[];let U=new Map,T={};Object.keys(g.messages).forEach(G=>{var X;const M=g.messages[G],F=M.parentId?(((X=U.get(M.parentId))==null?void 0:X.level)??-1)+1:0;T[F]||(T[F]=0),U.set(G,{id:M.id,level:F,position:T[F]++})}),Object.keys(g.messages).forEach(G=>{const M=U.get(G),F=M.position*250,X=M.level*150,z=F;S.push({id:M.id,type:"custom",data:{user:s,message:g.messages[G],model:i.find(j=>j.id===g.messages[G].model)},position:{x:z,y:X}});const K=g.messages[G].parentId;K&&R.push({id:K+"-"+M.id,source:K,target:M.id,selectable:!1,class:" dark:fill-gray-300 fill-gray-300",type:"smoothstep",animated:g.currentId===G||_(G,g.currentId)})}),await p.set([...R]),await x.set([...S])},_=(S,R)=>{const P=g.messages[S];return P.childrenIds&&P.childrenIds.some(D=>D===R||_(D,R))};ol(()=>{v(),f.subscribe(async S=>{S&&(await un(),await u({nodes:[{id:g.currentId}]}))}),c.subscribe(S=>{S&&u({nodes:[{id:g.currentId}]})}),h.subscribe(S=>{S&&u({nodes:[{id:g.currentId}]})})}),Gh(()=>{x.set([]),p.set([])});const C=()=>{n0.set(!1)},k=()=>{o("close"),n0.set(!1)},I=S=>{S.detail.node.data,o("nodeclick",S.detail),t(0,m=S.detail.node.data.message.id),u({nodes:[{id:m}]})};return n.$$set=S=>{"history"in S&&t(9,g=S.history)},n.$$.update=()=>{n.$$.dirty&512&&g&&v(),n.$$.dirty&512&&g&&g.currentId&&w()},[m,r,a,o,l,u,x,p,y,g,C,k,I]}class qO extends Ht{constructor(e){super(),zt(this,e,Iae,Sae,qt,{history:9})}}function Eae(n){let e,t;return{c(){e=lt("svg"),t=lt("path"),this.h()},l(i){e=ct(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=V(e);t=ct(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"d","M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width",n[1]),A(e,"stroke","currentColor"),A(e,"class",n[0])},m(i,s){te(i,e,s),W(e,t)},p(i,[s]){s&2&&A(e,"stroke-width",i[1]),s&1&&A(e,"class",i[0])},i:It,o:It,d(i){i&&E(e)}}}function Tae(n,e,t){let{className:i="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class Rae extends Ht{constructor(e){super(),zt(this,e,Tae,Eae,qt,{className:0,strokeWidth:1})}}function sI(n){let e,t,i,s,r,a,o,l,c,h,u,d,f,g=n[5].t("Version {{selectedVersion}} of {{totalVersions}}",{selectedVersion:n[2]+1,totalVersions:n[1].length})+"",m,x,p,y,w,v,_,C,k,I=(n[3]?n[5].t("Copied"):n[5].t("Copy"))+"",S,R,P,D,U,T,G,M,F,X;i=new VO({props:{className:"size-3.5  text-gray-900 dark:text-white"}}),P=new yi({props:{content:n[5].t("Download"),$$slots:{default:[Mae]},$$scope:{ctx:n}}});let z=n[1][n[2]].type==="iframe"&&rI(n);return G=new qg({props:{className:"size-3.5 text-gray-900 dark:text-white"}}),{c(){e=ie("div"),t=ie("button"),be(i.$$.fragment),s=Se(),r=ie("div"),a=ie("div"),o=ie("div"),l=ie("button"),c=lt("svg"),h=lt("path"),d=Se(),f=ie("div"),m=At(g),x=Se(),p=ie("button"),y=lt("svg"),w=lt("path"),_=Se(),C=ie("div"),k=ie("button"),S=At(I),R=Se(),be(P.$$.fragment),D=Se(),z&&z.c(),U=Se(),T=ie("button"),be(G.$$.fragment),this.h()},l(K){e=se(K,"DIV",{class:!0});var j=V(e);t=se(j,"BUTTON",{class:!0});var ae=V(t);ve(i.$$.fragment,ae),ae.forEach(E),s=Ie(j),r=se(j,"DIV",{class:!0});var ge=V(r);a=se(ge,"DIV",{class:!0});var ue=V(a);o=se(ue,"DIV",{class:!0,dir:!0});var pe=V(o);l=se(pe,"BUTTON",{class:!0});var de=V(l);c=ct(de,"svg",{xmlns:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var O=V(c);h=ct(O,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(h).forEach(E),O.forEach(E),de.forEach(E),d=Ie(pe),f=se(pe,"DIV",{class:!0});var Y=V(f);m=St(Y,g),Y.forEach(E),x=Ie(pe),p=se(pe,"BUTTON",{class:!0});var le=V(p);y=ct(le,"svg",{xmlns:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var $=V(y);w=ct($,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(w).forEach(E),$.forEach(E),le.forEach(E),pe.forEach(E),ue.forEach(E),_=Ie(ge),C=se(ge,"DIV",{class:!0});var re=V(C);k=se(re,"BUTTON",{class:!0});var oe=V(k);S=St(oe,I),oe.forEach(E),R=Ie(re),ve(P.$$.fragment,re),D=Ie(re),z&&z.l(re),re.forEach(E),ge.forEach(E),U=Ie(j),T=se(j,"BUTTON",{class:!0});var ee=V(T);ve(G.$$.fragment,ee),ee.forEach(E),j.forEach(E),this.h()},h(){A(t,"class","self-center pointer-events-auto p-1 rounded-full bg-white dark:bg-gray-850"),A(h,"stroke-linecap","round"),A(h,"stroke-linejoin","round"),A(h,"d","M15.75 19.5 8.25 12l7.5-7.5"),A(c,"xmlns","http://www.w3.org/2000/svg"),A(c,"fill","none"),A(c,"viewBox","0 0 24 24"),A(c,"stroke","currentColor"),A(c,"stroke-width","2.5"),A(c,"class","size-3.5"),A(l,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition disabled:cursor-not-allowed"),l.disabled=u=n[1].length<=1,A(f,"class","text-xs self-center dark:text-gray-100 min-w-fit"),A(w,"stroke-linecap","round"),A(w,"stroke-linejoin","round"),A(w,"d","m8.25 4.5 7.5 7.5-7.5 7.5"),A(y,"xmlns","http://www.w3.org/2000/svg"),A(y,"fill","none"),A(y,"viewBox","0 0 24 24"),A(y,"stroke","currentColor"),A(y,"stroke-width","2.5"),A(y,"class","size-3.5"),A(p,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition disabled:cursor-not-allowed"),p.disabled=v=n[1].length<=1,A(o,"class","flex items-center gap-0.5 self-center min-w-fit"),A(o,"dir","ltr"),A(a,"class","flex items-center space-x-2"),A(k,"class","copy-code-button bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md px-1.5 py-0.5"),A(C,"class","flex items-center gap-1.5"),A(r,"class","flex-1 flex items-center justify-between pr-1"),A(T,"class","self-center pointer-events-auto p-1 rounded-full bg-white dark:bg-gray-850"),A(e,"class","pointer-events-auto z-20 flex justify-between items-center p-2.5 font-primar text-gray-900 dark:text-white")},m(K,j){te(K,e,j),W(e,t),xe(i,t,null),W(e,s),W(e,r),W(r,a),W(a,o),W(o,l),W(l,c),W(c,h),W(o,d),W(o,f),W(f,m),W(o,x),W(o,p),W(p,y),W(y,w),W(r,_),W(r,C),W(C,k),W(k,S),W(C,R),xe(P,C,null),W(C,D),z&&z.m(C,null),W(e,U),W(e,T),xe(G,T,null),M=!0,F||(X=[xt(t,"click",n[14]),xt(l,"click",n[15]),xt(p,"click",n[16]),xt(k,"click",n[17]),xt(T,"click",n[18])],F=!0)},p(K,j){(!M||j&2&&u!==(u=K[1].length<=1))&&(l.disabled=u),(!M||j&38)&&g!==(g=K[5].t("Version {{selectedVersion}} of {{totalVersions}}",{selectedVersion:K[2]+1,totalVersions:K[1].length})+"")&&Pt(m,g),(!M||j&2&&v!==(v=K[1].length<=1))&&(p.disabled=v),(!M||j&40)&&I!==(I=(K[3]?K[5].t("Copied"):K[5].t("Copy"))+"")&&Pt(S,I);const ae={};j&32&&(ae.content=K[5].t("Download")),j&8388608&&(ae.$$scope={dirty:j,ctx:K}),P.$set(ae),K[1][K[2]].type==="iframe"?z?(z.p(K,j),j&6&&H(z,1)):(z=rI(K),z.c(),H(z,1),z.m(C,null)):z&&(yt(),q(z,1,1,()=>{z=null}),wt())},i(K){M||(H(i.$$.fragment,K),H(P.$$.fragment,K),H(z),H(G.$$.fragment,K),M=!0)},o(K){q(i.$$.fragment,K),q(P.$$.fragment,K),q(z),q(G.$$.fragment,K),M=!1},d(K){K&&E(e),ye(i),ye(P),z&&z.d(),ye(G),F=!1,Zr(X)}}}function Mae(n){let e,t,i,s,r;return t=new SL({props:{className:"size-3.5"}}),{c(){e=ie("button"),be(t.$$.fragment),this.h()},l(a){e=se(a,"BUTTON",{class:!0});var o=V(e);ve(t.$$.fragment,o),o.forEach(E),this.h()},h(){A(e,"class","bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md p-0.5")},m(a,o){te(a,e,o),xe(t,e,null),i=!0,s||(r=xt(e,"click",n[12]),s=!0)},p:It,i(a){i||(H(t.$$.fragment,a),i=!0)},o(a){q(t.$$.fragment,a),i=!1},d(a){a&&E(e),ye(t),s=!1,r()}}}function rI(n){let e,t;return e=new yi({props:{content:n[5].t("Open in full screen"),$$slots:{default:[Pae]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s&32&&(r.content=i[5].t("Open in full screen")),s&8388608&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Pae(n){let e,t,i,s,r;return t=new Rae({props:{className:"size-3.5"}}),{c(){e=ie("button"),be(t.$$.fragment),this.h()},l(a){e=se(a,"BUTTON",{class:!0});var o=V(e);ve(t.$$.fragment,o),o.forEach(E),this.h()},h(){A(e,"class","bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md p-0.5")},m(a,o){te(a,e,o),xe(t,e,null),i=!0,s||(r=xt(e,"click",n[11]),s=!0)},p:It,i(a){i||(H(t.$$.fragment,a),i=!0)},o(a){q(t.$$.fragment,a),i=!1},d(a){a&&E(e),ye(t),s=!1,r()}}}function aI(n){let e;return{c(){e=ie("div"),this.h()},l(t){e=se(t,"DIV",{class:!0}),V(e).forEach(E),this.h()},h(){A(e,"class","absolute top-0 left-0 right-0 bottom-0 z-10")},m(t,i){te(t,e,i)},d(t){t&&E(e)}}}function Nae(n){let e,t=n[5].t("No HTML, CSS, or JavaScript content found.")+"",i;return{c(){e=ie("div"),i=At(t),this.h()},l(s){e=se(s,"DIV",{class:!0});var r=V(e);i=St(r,t),r.forEach(E),this.h()},h(){A(e,"class","m-auto font-medium text-xs text-gray-900 dark:text-white")},m(s,r){te(s,e,r),W(e,i)},p(s,r){r&32&&t!==(t=s[5].t("No HTML, CSS, or JavaScript content found.")+"")&&Pt(i,t)},i:It,o:It,d(s){s&&E(e)}}}function Oae(n){let e,t,i,s;const r=[Lae,Dae],a=[];function o(l,c){return l[1][l[2]].type==="iframe"?0:l[1][l[2]].type==="svg"?1:-1}return~(t=o(n))&&(i=a[t]=r[t](n)),{c(){e=ie("div"),i&&i.c(),this.h()},l(l){e=se(l,"DIV",{class:!0});var c=V(e);i&&i.l(c),c.forEach(E),this.h()},h(){A(e,"class","max-w-full w-full h-full")},m(l,c){te(l,e,c),~t&&a[t].m(e,null),s=!0},p(l,c){let h=t;t=o(l),t===h?~t&&a[t].p(l,c):(i&&(yt(),q(a[h],1,1,()=>{a[h]=null}),wt()),~t?(i=a[t],i?i.p(l,c):(i=a[t]=r[t](l),i.c()),H(i,1),i.m(e,null)):i=null)},i(l){s||(H(i),s=!0)},o(l){q(i),s=!1},d(l){l&&E(e),~t&&a[t].d()}}}function Dae(n){let e,t;return e=new sD({props:{className:" w-full h-full max-h-full overflow-hidden",svg:n[1][n[2]].content}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s&6&&(r.svg=i[1][i[2]].content),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Lae(n){let e,t,i,s,r;return{c(){e=ie("iframe"),this.h()},l(a){e=se(a,"IFRAME",{title:!0,srcdoc:!0,class:!0,sandbox:!0}),V(e).forEach(E),this.h()},h(){var a,o;A(e,"title","Content"),A(e,"srcdoc",t=n[1][n[2]].content),A(e,"class","w-full border-0 h-full rounded-none"),A(e,"sandbox",i="allow-scripts allow-downloads"+(((a=n[6])==null?void 0:a.iframeSandboxAllowForms)??!1?" allow-forms":"")+(((o=n[6])==null?void 0:o.iframeSandboxAllowSameOrigin)??!1?" allow-same-origin":""))},m(a,o){te(a,e,o),n[19](e),s||(r=xt(e,"load",n[10]),s=!0)},p(a,o){var l,c;o&6&&t!==(t=a[1][a[2]].content)&&A(e,"srcdoc",t),o&64&&i!==(i="allow-scripts allow-downloads"+(((l=a[6])==null?void 0:l.iframeSandboxAllowForms)??!1?" allow-forms":"")+(((c=a[6])==null?void 0:c.iframeSandboxAllowSameOrigin)??!1?" allow-same-origin":""))&&A(e,"sandbox",i)},i:It,o:It,d(a){a&&E(e),n[19](null),s=!1,r()}}}function Fae(n){let e,t,i,s,r,a,o,l,c,h=n[1].length>0&&sI(n),u=n[0]&&aI();const d=[Oae,Nae],f=[];function g(m,x){return m[1].length>0?0:1}return o=g(n),l=f[o]=d[o](n),{c(){e=ie("div"),t=ie("div"),h&&h.c(),i=Se(),u&&u.c(),s=Se(),r=ie("div"),a=ie("div"),l.c(),this.h()},l(m){e=se(m,"DIV",{class:!0});var x=V(e);t=se(x,"DIV",{class:!0});var p=V(t);h&&h.l(p),i=Ie(p),u&&u.l(p),s=Ie(p),r=se(p,"DIV",{class:!0});var y=V(r);a=se(y,"DIV",{class:!0});var w=V(a);l.l(w),w.forEach(E),y.forEach(E),p.forEach(E),x.forEach(E),this.h()},h(){A(a,"class","h-full flex flex-col"),A(r,"class","flex-1 w-full h-full"),A(t,"class","w-full h-full flex flex-col flex-1 relative"),A(e,"class","w-full h-full relative flex flex-col bg-gray-50 dark:bg-gray-850")},m(m,x){te(m,e,x),W(e,t),h&&h.m(t,null),W(t,i),u&&u.m(t,null),W(t,s),W(t,r),W(r,a),f[o].m(a,null),c=!0},p(m,[x]){m[1].length>0?h?(h.p(m,x),x&2&&H(h,1)):(h=sI(m),h.c(),H(h,1),h.m(t,i)):h&&(yt(),q(h,1,1,()=>{h=null}),wt()),m[0]?u||(u=aI(),u.c(),u.m(t,s)):u&&(u.d(1),u=null);let p=o;o=g(m),o===p?f[o].p(m,x):(yt(),q(f[p],1,1,()=>{f[p]=null}),wt(),l=f[o],l?l.p(m,x):(l=f[o]=d[o](m),l.c()),H(l,1),l.m(a,null))},i(m){c||(H(h),H(l),c=!0)},o(m){q(h),q(l),c=!1},d(m){m&&E(e),h&&h.d(),u&&u.d(),f[o].d()}}}function Bae(n,e,t){let i,s,r;Oe(n,cu,R=>t(21,i=R)),Oe(n,ja,R=>t(6,r=R));const a=qs("i18n");Oe(n,a,R=>t(5,s=R));const o=Ka();let{overlay:l=!1}=e,{history:c}=e,h=[],u=[],d=0,f=!1,g;const m=()=>{t(1,u=[]),h.forEach(R=>{if((R==null?void 0:R.role)!=="user"&&(R!=null&&R.content)){const P=R.content.match(/```[\s\S]*?```/g);let D=[];P&&P.forEach(z=>{const K=z.split(`
`)[0].replace("```","").trim().toLowerCase(),j=z.replace(/```[\s\S]*?\n/,"").replace(/```$/,"");D.push({lang:K,code:j})});let U="",T="",G="";D.forEach(z=>{const{lang:K,code:j}=z;K==="html"?U+=j+`
`:K==="css"?T+=j+`
`:(K==="javascript"||K==="js")&&(G+=j+`
`)});const M=R.content.match(/<html>[\s\S]*?<\/html>/gi),F=R.content.match(/<style>[\s\S]*?<\/style>/gi),X=R.content.match(/<script>[\s\S]*?<\/script>/gi);if(M&&M.forEach(z=>{const K=z.replace(/<\/?html>/gi,"");U+=K+`
`}),F&&F.forEach(z=>{const K=z.replace(/<\/?style>/gi,"");T+=K+`
`}),X&&X.forEach(z=>{const K=z.replace(/<\/?script>/gi,"");G+=K+`
`}),U||T||G){const z=`
                        <!DOCTYPE html>
                        <html lang="en">
                        <head>
                            <meta charset="UTF-8">
                            <meta name="viewport" content="width=device-width, initial-scale=1.0">
							<style>
								body {
									background-color: white; /* Ensure the iframe has a white background */
								}

								${T}
							</style>
                        </head>
                        <body>
                            ${U}

							<script>
                            	${G}
							<\/script>
                        </body>
                        </html>
                    `;t(1,u=[...u,{type:"iframe",content:z}])}else for(const z of D)(z.lang==="svg"||z.lang==="xml"&&z.code.includes("<svg"))&&t(1,u=[...u,{type:"svg",content:z.code}])}}),u.length===0&&(Ki.set(!1),Jl.set(!1)),t(2,d=u?u.length-1:0)};function x(R){t(2,d=R==="prev"?Math.max(d-1,0):Math.min(d+1,u.length-1))}const p=()=>{g.contentWindow.addEventListener("click",function(R){const P=R.target.closest("a");if(P&&P.href){R.preventDefault();const D=new URL(P.href,g.baseURI);D.origin===window.location.origin?g.contentWindow.history.pushState(null,"",D.pathname+D.search+D.hash):console.info("External navigation blocked:",D.href)}},!0),g.contentWindow.addEventListener("mouseenter",function(R){R.preventDefault(),g.contentWindow.addEventListener("dragstart",P=>{P.preventDefault()})})},y=()=>{g.requestFullscreen?g.requestFullscreen():g.webkitRequestFullscreen?g.webkitRequestFullscreen():g.msRequestFullscreen&&g.msRequestFullscreen()},w=()=>{const R=new Blob([u[d].content],{type:"text/html"}),P=URL.createObjectURL(R),D=document.createElement("a");D.href=P,D.download=`artifact-${i}-${d}.html`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(P)};ol(()=>{pD.subscribe(R=>{if(u){const P=u.findIndex(D=>D.content.includes(R));t(2,d=P!==-1?P:0)}})});const v=()=>{Jl.set(!1)},_=()=>x("prev"),C=()=>x("next"),k=()=>{J6(u[d].content),t(3,f=!0),setTimeout(()=>{t(3,f=!1)},2e3)},I=()=>{o("close"),Ki.set(!1),Jl.set(!1)};function S(R){Et[R?"unshift":"push"](()=>{g=R,t(4,g)})}return n.$$set=R=>{"overlay"in R&&t(0,l=R.overlay),"history"in R&&t(13,c=R.history)},n.$$.update=()=>{n.$$.dirty&8192&&(c?(h=Oa(c,c.currentId),m()):(h=[],m()))},[l,u,d,f,g,s,r,a,o,x,p,y,w,c,v,_,C,k,I,S]}class WO extends Ht{constructor(e){super(),zt(this,e,Bae,Fae,qt,{overlay:0,history:13})}}function Uae(n){let e,t,i,s,r=n[16]&&oI(n);function a(l){n[37](l)}let o={defaultSize:0,onResize:n[35],onCollapse:n[36],collapsible:!0,class:" z-10 ",$$slots:{default:[Wae]},$$scope:{ctx:n}};return n[4]!==void 0&&(o.pane=n[4]),t=new CI({props:o}),Et.push(()=>Kt(t,"pane",a)),{c(){r&&r.c(),e=Se(),be(t.$$.fragment)},l(l){r&&r.l(l),e=Ie(l),ve(t.$$.fragment,l)},m(l,c){r&&r.m(l,c),te(l,e,c),xe(t,l,c),s=!0},p(l,c){l[16]?r?c[0]&65536&&H(r,1):(r=oI(l),r.c(),H(r,1),r.m(e.parentNode,e)):r&&(yt(),q(r,1,1,()=>{r=null}),wt());const h={};c[0]&81936&&(h.onResize=l[35]),c[0]&503791|c[1]&4096&&(h.$$scope={dirty:c,ctx:l}),!i&&c[0]&16&&(i=!0,h.pane=l[4],Wt(()=>i=!1)),t.$set(h)},i(l){s||(H(r),H(t.$$.fragment,l),s=!0)},o(l){q(r),q(t.$$.fragment,l),s=!1},d(l){l&&E(e),r&&r.d(l),ye(t,l)}}}function Hae(n){let e,t,i=n[16]&&cI(n);return{c(){i&&i.c(),e=Xt()},l(s){i&&i.l(s),e=Xt()},m(s,r){i&&i.m(s,r),te(s,e,r),t=!0},p(s,r){s[16]?i?(i.p(s,r),r[0]&65536&&H(i,1)):(i=cI(s),i.c(),H(i,1),i.m(e.parentNode,e)):i&&(yt(),q(i,1,1,()=>{i=null}),wt())},i(s){t||(H(i),t=!0)},o(s){q(i),t=!1},d(s){s&&E(e),i&&i.d(s)}}}function oI(n){let e,t;return e=new hD({props:{class:"relative flex w-2 items-center justify-center bg-background group",$$slots:{default:[zae]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function zae(n){let e,t,i;return t=new AL({props:{className:"size-4 invisible group-hover:visible"}}),{c(){e=ie("div"),be(t.$$.fragment),this.h()},l(s){e=se(s,"DIV",{class:!0});var r=V(e);ve(t.$$.fragment,r),r.forEach(E),this.h()},h(){A(e,"class","z-10 flex h-7 w-5 items-center justify-center rounded-xs")},m(s,r){te(s,e,r),xe(t,e,null),i=!0},p:It,i(s){i||(H(t.$$.fragment,s),i=!0)},o(s){q(t.$$.fragment,s),i=!1},d(s){s&&E(e),ye(t)}}}function lI(n){let e,t,i,s,r,a;const o=[qae,Vae,Gae,jae],l=[];function c(h,u){return h[15]?0:h[18]?1:h[17]?2:3}return i=c(n),s=l[i]=o[i](n),{c(){e=ie("div"),t=ie("div"),s.c(),this.h()},l(h){e=se(h,"DIV",{class:!0});var u=V(e);t=se(u,"DIV",{class:!0});var d=V(t);s.l(d),d.forEach(E),u.forEach(E),this.h()},h(){A(t,"class",r="w-full "+((n[17]||n[18])&&!n[15]?" ":"px-4 py-4 bg-white dark:shadow-lg dark:bg-gray-850  border border-gray-100 dark:border-gray-850")+" z-40 pointer-events-auto overflow-y-auto scrollbar-hidden"),A(e,"class","flex max-h-full min-h-full")},m(h,u){te(h,e,u),W(e,t),l[i].m(t,null),a=!0},p(h,u){let d=i;i=c(h),i===d?l[i].p(h,u):(yt(),q(l[d],1,1,()=>{l[d]=null}),wt(),s=l[i],s?s.p(h,u):(s=l[i]=o[i](h),s.c()),H(s,1),s.m(t,null)),(!a||u[0]&425984&&r!==(r="w-full "+((h[17]||h[18])&&!h[15]?" ":"px-4 py-4 bg-white dark:shadow-lg dark:bg-gray-850  border border-gray-100 dark:border-gray-850")+" z-40 pointer-events-auto overflow-y-auto scrollbar-hidden"))&&A(t,"class",r)},i(h){a||(H(s),a=!0)},o(h){q(s),a=!1},d(h){h&&E(e),l[i].d()}}}function jae(n){let e,t,i,s;function r(l){n[32](l)}function a(l){n[33](l)}let o={models:n[5]};return n[1]!==void 0&&(o.chatFiles=n[1]),n[2]!==void 0&&(o.params=n[2]),e=new jO({props:o}),Et.push(()=>Kt(e,"chatFiles",r)),Et.push(()=>Kt(e,"params",a)),e.$on("close",n[34]),{c(){be(e.$$.fragment)},l(l){ve(e.$$.fragment,l)},m(l,c){xe(e,l,c),s=!0},p(l,c){const h={};c[0]&32&&(h.models=l[5]),!t&&c[0]&2&&(t=!0,h.chatFiles=l[1],Wt(()=>t=!1)),!i&&c[0]&4&&(i=!0,h.params=l[2],Wt(()=>i=!1)),e.$set(h)},i(l){s||(H(e.$$.fragment,l),s=!0)},o(l){q(e.$$.fragment,l),s=!1},d(l){ye(e,l)}}}function Gae(n){let e,t;return e=new qO({props:{history:n[0]}}),e.$on("nodeclick",n[30]),e.$on("close",n[31]),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&1&&(r.history=i[0]),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Vae(n){let e,t;return e=new WO({props:{history:n[0],overlay:n[13]}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&1&&(r.history=i[0]),s[0]&8192&&(r.overlay=i[13]),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function qae(n){let e,t,i,s;function r(o){n[28](o)}let a={submitPrompt:n[8],stopResponse:n[9],modelId:n[11],chatId:n[6],eventTarget:n[7]};return n[3]!==void 0&&(a.files=n[3]),t=new GO({props:a}),Et.push(()=>Kt(t,"files",r)),t.$on("close",n[29]),{c(){e=ie("div"),be(t.$$.fragment),this.h()},l(o){e=se(o,"DIV",{class:!0});var l=V(e);ve(t.$$.fragment,l),l.forEach(E),this.h()},h(){A(e,"class","w-full h-full flex justify-center")},m(o,l){te(o,e,l),xe(t,e,null),s=!0},p(o,l){const c={};l[0]&256&&(c.submitPrompt=o[8]),l[0]&512&&(c.stopResponse=o[9]),l[0]&2048&&(c.modelId=o[11]),l[0]&64&&(c.chatId=o[6]),l[0]&128&&(c.eventTarget=o[7]),!i&&l[0]&8&&(i=!0,c.files=o[3],Wt(()=>i=!1)),t.$set(c)},i(o){s||(H(t.$$.fragment,o),s=!0)},o(o){q(t.$$.fragment,o),s=!1},d(o){o&&E(e),ye(t)}}}function Wae(n){let e,t,i=n[16]&&lI(n);return{c(){i&&i.c(),e=Xt()},l(s){i&&i.l(s),e=Xt()},m(s,r){i&&i.m(s,r),te(s,e,r),t=!0},p(s,r){s[16]?i?(i.p(s,r),r[0]&65536&&H(i,1)):(i=lI(s),i.c(),H(i,1),i.m(e.parentNode,e)):i&&(yt(),q(i,1,1,()=>{i=null}),wt())},i(s){t||(H(i),t=!0)},o(s){q(i),t=!1},d(s){s&&E(e),i&&i.d(s)}}}function cI(n){let e,t;return e=new eL({props:{show:n[16],onClose:n[27],$$slots:{default:[Zae]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&65536&&(r.show=i[16]),s[0]&430063|s[1]&4096&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Kae(n){let e,t,i,s;function r(l){n[24](l)}function a(l){n[25](l)}let o={models:n[5]};return n[1]!==void 0&&(o.chatFiles=n[1]),n[2]!==void 0&&(o.params=n[2]),e=new jO({props:o}),Et.push(()=>Kt(e,"chatFiles",r)),Et.push(()=>Kt(e,"params",a)),e.$on("close",n[26]),{c(){be(e.$$.fragment)},l(l){ve(e.$$.fragment,l)},m(l,c){xe(e,l,c),s=!0},p(l,c){const h={};c[0]&32&&(h.models=l[5]),!t&&c[0]&2&&(t=!0,h.chatFiles=l[1],Wt(()=>t=!1)),!i&&c[0]&4&&(i=!0,h.params=l[2],Wt(()=>i=!1)),e.$set(h)},i(l){s||(H(e.$$.fragment,l),s=!0)},o(l){q(e.$$.fragment,l),s=!1},d(l){ye(e,l)}}}function Xae(n){let e,t;return e=new qO({props:{history:n[0]}}),e.$on("nodeclick",n[22]),e.$on("close",n[23]),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&1&&(r.history=i[0]),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Yae(n){let e,t;return e=new WO({props:{history:n[0]}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&1&&(r.history=i[0]),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function Jae(n){let e,t,i,s;function r(o){n[20](o)}let a={submitPrompt:n[8],stopResponse:n[9],modelId:n[11],chatId:n[6],eventTarget:n[7]};return n[3]!==void 0&&(a.files=n[3]),t=new GO({props:a}),Et.push(()=>Kt(t,"files",r)),t.$on("close",n[21]),{c(){e=ie("div"),be(t.$$.fragment),this.h()},l(o){e=se(o,"DIV",{class:!0});var l=V(e);ve(t.$$.fragment,l),l.forEach(E),this.h()},h(){A(e,"class","h-full max-h-[100dvh] bg-white text-gray-700 dark:bg-black dark:text-gray-300 flex justify-center")},m(o,l){te(o,e,l),xe(t,e,null),s=!0},p(o,l){const c={};l[0]&256&&(c.submitPrompt=o[8]),l[0]&512&&(c.stopResponse=o[9]),l[0]&2048&&(c.modelId=o[11]),l[0]&64&&(c.chatId=o[6]),l[0]&128&&(c.eventTarget=o[7]),!i&&l[0]&8&&(i=!0,c.files=o[3],Wt(()=>i=!1)),t.$set(c)},i(o){s||(H(t.$$.fragment,o),s=!0)},o(o){q(t.$$.fragment,o),s=!1},d(o){o&&E(e),ye(t)}}}function Zae(n){let e,t,i,s,r;const a=[Jae,Yae,Xae,Kae],o=[];function l(c,h){return c[15]?0:c[18]?1:c[17]?2:3}return t=l(n),i=o[t]=a[t](n),{c(){e=ie("div"),i.c(),this.h()},l(c){e=se(c,"DIV",{class:!0});var h=V(e);i.l(h),h.forEach(E),this.h()},h(){A(e,"class",s=(n[15]||n[17]||n[18]?" h-screen  w-full":"px-6 py-4")+" h-full")},m(c,h){te(c,e,h),o[t].m(e,null),r=!0},p(c,h){let u=t;t=l(c),t===u?o[t].p(c,h):(yt(),q(o[u],1,1,()=>{o[u]=null}),wt(),i=o[t],i?i.p(c,h):(i=o[t]=a[t](c),i.c()),H(i,1),i.m(e,null)),(!r||h[0]&425984&&s!==(s=(c[15]||c[17]||c[18]?" h-screen  w-full":"px-6 py-4")+" h-full"))&&A(e,"class",s)},i(c){r||(H(i),r=!0)},o(c){q(i),r=!1},d(c){c&&E(e),o[t].d()}}}function Qae(n){let e,t,i,s;const r=[Hae,Uae],a=[];function o(l,c){return l[12]?1:0}return e=o(n),t=a[e]=r[e](n),{c(){t.c(),i=Xt()},l(l){t.l(l),i=Xt()},m(l,c){a[e].m(l,c),te(l,i,c),s=!0},p(l,c){let h=e;e=o(l),e===h?a[e].p(l,c):(yt(),q(a[h],1,1,()=>{a[h]=null}),wt(),t=a[e],t?t.p(l,c):(t=a[e]=r[e](l),t.c()),H(t,1),t.m(i.parentNode,i))},i(l){s||(H(t),s=!0)},o(l){q(t),s=!1},d(l){l&&E(i),a[e].d(l)}}}function $ae(n){let e,t;return e=new Use({props:{$$slots:{default:[Qae]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&524287|s[1]&4096&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function eoe(n,e,t){let i,s,r,a;Oe(n,Fa,$=>t(15,i=$)),Oe(n,Ki,$=>t(16,s=$)),Oe(n,n0,$=>t(17,r=$)),Oe(n,Jl,$=>t(18,a=$));let{history:o}=e,{models:l=[]}=e,{chatId:c=null}=e,{chatFiles:h=[]}=e,{params:u={}}=e,{eventTarget:d}=e,{submitPrompt:f}=e,{stopResponse:g}=e,{showMessage:m}=e,{files:x}=e,{modelId:p}=e,{pane:y}=e,w,v=!1,_=!1,C=0;const k=()=>{parseInt(localStorage==null?void 0:localStorage.chatControlsSize)?y.resize(parseInt(localStorage==null?void 0:localStorage.chatControlsSize)):y.resize(C)},I=async $=>{$.matches?(t(12,v=!0),i&&(Fa.set(!1),await un(),Fa.set(!0))):(t(12,v=!1),i&&(Fa.set(!1),await un(),Fa.set(!0)),t(4,y=null))},S=$=>{t(13,_=!0)},R=$=>{t(13,_=!1)};ol(()=>{w=window.matchMedia("(min-width: 1024px)"),w.addEventListener("change",I),I(w);const $=document.getElementById("chat-container");t(14,C=Math.floor(350/$.clientWidth*100)),new ResizeObserver(oe=>{for(let ee of oe){const je=350/ee.contentRect.width*100;t(14,C=Math.floor(je)),s&&y&&y.isExpanded()&&y.getSize()<C&&y.resize(C)}}).observe($),document.addEventListener("mousedown",S),document.addEventListener("mouseup",R)}),Gh(()=>{Ki.set(!1),w.removeEventListener("change",I),document.removeEventListener("mousedown",S),document.removeEventListener("mouseup",R)});const P=()=>{Ki.set(!1),n0.set(!1),Jl.set(!1),i&&Fa.set(!1)};function D($){x=$,t(3,x)}const U=()=>{Ki.set(!1)},T=$=>{m($.detail.node.data.message)},G=()=>{Ki.set(!1)};function M($){h=$,t(1,h)}function F($){u=$,t(2,u)}const X=()=>{Ki.set(!1)},z=()=>{Ki.set(!1)};function K($){x=$,t(3,x)}const j=()=>{Ki.set(!1)},ae=$=>{$.detail.node.data.message.favorite?t(0,o.messages[$.detail.node.data.message.id].favorite=!0,o):t(0,o.messages[$.detail.node.data.message.id].favorite=null,o),m($.detail.node.data.message)},ge=()=>{Ki.set(!1)};function ue($){h=$,t(1,h)}function pe($){u=$,t(2,u)}const de=()=>{Ki.set(!1)},O=$=>{s&&y.isExpanded()&&($<C&&y.resize(C),$<C?localStorage.chatControlsSize=0:localStorage.chatControlsSize=$)},Y=()=>{Ki.set(!1)};function le($){y=$,t(4,y)}return n.$$set=$=>{"history"in $&&t(0,o=$.history),"models"in $&&t(5,l=$.models),"chatId"in $&&t(6,c=$.chatId),"chatFiles"in $&&t(1,h=$.chatFiles),"params"in $&&t(2,u=$.params),"eventTarget"in $&&t(7,d=$.eventTarget),"submitPrompt"in $&&t(8,f=$.submitPrompt),"stopResponse"in $&&t(9,g=$.stopResponse),"showMessage"in $&&t(10,m=$.showMessage),"files"in $&&t(3,x=$.files),"modelId"in $&&t(11,p=$.modelId),"pane"in $&&t(4,y=$.pane)},n.$$.update=()=>{n.$$.dirty[0]&64&&(c||P())},[o,h,u,x,y,l,c,d,f,g,m,p,v,_,C,i,s,r,a,k,D,U,T,G,M,F,X,z,K,j,ae,ge,ue,pe,de,O,Y,le]}class toe extends Ht{constructor(e){super(),zt(this,e,eoe,$ae,qt,{history:0,models:5,chatId:6,chatFiles:1,params:2,eventTarget:7,submitPrompt:8,stopResponse:9,showMessage:10,files:3,modelId:11,pane:4,openPane:19},null,[-1,-1])}get openPane(){return this.$$.ctx[19]}}function noe(n){let e,t;return{c(){e=lt("svg"),t=lt("path"),this.h()},l(i){e=ct(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=V(e);t=ct(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(t).forEach(E),s.forEach(E),this.h()},h(){A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"d","M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"fill","none"),A(e,"viewBox","0 0 24 24"),A(e,"stroke-width",n[1]),A(e,"stroke","currentColor"),A(e,"class",n[0])},m(i,s){te(i,e,s),W(e,t)},p(i,[s]){s&2&&A(e,"stroke-width",i[1]),s&1&&A(e,"class",i[0])},i:It,o:It,d(i){i&&E(e)}}}function ioe(n,e,t){let{className:i="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,i=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[i,s]}class soe extends Ht{constructor(e){super(),zt(this,e,ioe,noe,qt,{className:0,strokeWidth:1})}}function hI(n,e,t){const i=n.slice();return i[44]=e[t],i[46]=t,i}function uI(n){let e,t;return e=new yi({props:{content:n[21].t("This chat won't appear in history and your messages will not be saved."),className:"w-full flex justify-center mb-0.5",placement:"top",$$slots:{default:[roe]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(i){ve(e.$$.fragment,i)},m(i,s){xe(e,i,s),t=!0},p(i,s){const r={};s[0]&2097152&&(r.content=i[21].t("This chat won't appear in history and your messages will not be saved.")),s[0]&2097152|s[1]&65536&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(H(e.$$.fragment,i),t=!0)},o(i){q(e.$$.fragment,i),t=!1},d(i){ye(e,i)}}}function roe(n){let e,t,i=n[21].t("Temporary Chat")+"",s,r;return t=new EL({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=ie("div"),be(t.$$.fragment),s=At(i),this.h()},l(a){e=se(a,"DIV",{class:!0});var o=V(e);ve(t.$$.fragment,o),s=St(o,i),o.forEach(E),this.h()},h(){A(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(a,o){te(a,e,o),xe(t,e,null),W(e,s),r=!0},p(a,o){(!r||o[0]&2097152)&&i!==(i=a[21].t("Temporary Chat")+"")&&Pt(s,i)},i(a){r||(H(t.$$.fragment,a),r=!0)},o(a){q(t.$$.fragment,a),r=!1},d(a){a&&E(e),ye(t)}}}function aoe(n){var C,k,I;let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m=ni(n[18]),x=[];for(let S=0;S<m.length;S+=1)x[S]=dI(hI(n,m,S));const p=S=>q(x[S],1,1,()=>{x[S]=null}),y=[hoe,coe],w=[];function v(S,R){var P;return(P=S[18][S[19]])!=null&&P.name?0:1}o=v(n),l=w[o]=y[o](n);let _=(((I=(k=(C=n[18][n[19]])==null?void 0:C.info)==null?void 0:k.meta)==null?void 0:I.description)??null)&&fI(n);return{c(){e=ie("div"),t=ie("div"),i=ie("div");for(let S=0;S<x.length;S+=1)x[S].c();r=Se(),a=ie("div"),l.c(),h=Se(),u=ie("div"),d=ie("div"),_&&_.c(),this.h()},l(S){e=se(S,"DIV",{class:!0});var R=V(e);t=se(R,"DIV",{class:!0});var P=V(t);i=se(P,"DIV",{class:!0});var D=V(i);for(let M=0;M<x.length;M+=1)x[M].l(D);D.forEach(E),P.forEach(E),r=Ie(R),a=se(R,"DIV",{class:!0});var U=V(a);l.l(U),U.forEach(E),R.forEach(E),h=Ie(S),u=se(S,"DIV",{class:!0});var T=V(u);d=se(T,"DIV",{});var G=V(d);_&&_.l(G),G.forEach(E),T.forEach(E),this.h()},h(){A(i,"class","flex -space-x-4 mb-0.5"),A(t,"class","flex shrink-0 justify-center"),A(a,"class","text-3xl @sm:text-3xl line-clamp-1 flex items-center"),A(e,"class","flex flex-row justify-center gap-3 @sm:gap-3.5 w-fit px-5 max-w-xl"),A(u,"class","flex mt-1 mb-2")},m(S,R){te(S,e,R),W(e,t),W(t,i);for(let P=0;P<x.length;P+=1)x[P]&&x[P].m(i,null);W(e,r),W(e,a),w[o].m(a,null),te(S,h,R),te(S,u,R),W(u,d),_&&_.m(d,null),g=!0},p(S,R){var D,U,T;if(R[0]&2883584){m=ni(S[18]);let G;for(G=0;G<m.length;G+=1){const M=hI(S,m,G);x[G]?(x[G].p(M,R),H(x[G],1)):(x[G]=dI(M),x[G].c(),H(x[G],1),x[G].m(i,null))}for(yt(),G=m.length;G<x.length;G+=1)p(G);wt()}let P=o;o=v(S),o===P?w[o].p(S,R):(yt(),q(w[P],1,1,()=>{w[P]=null}),wt(),l=w[o],l?l.p(S,R):(l=w[o]=y[o](S),l.c()),H(l,1),l.m(a,null)),((T=(U=(D=S[18][S[19]])==null?void 0:D.info)==null?void 0:U.meta)==null?void 0:T.description)??null?_?(_.p(S,R),R[0]&786432&&H(_,1)):(_=fI(S),_.c(),H(_,1),_.m(d,null)):_&&(yt(),q(_,1,1,()=>{_=null}),wt())},i(S){if(!g){for(let R=0;R<m.length;R+=1)H(x[R]);S&&(s||Rh(()=>{s=up(i,dp,{duration:100}),s.start()})),H(l),S&&(c||Rh(()=>{c=up(a,dp,{duration:100}),c.start()})),H(_),S&&(f||Rh(()=>{f=up(d,dp,{duration:100,delay:50}),f.start()})),g=!0}},o(S){x=x.filter(Boolean);for(let R=0;R<x.length;R+=1)q(x[R]);q(l),q(_),g=!1},d(S){S&&(E(e),E(h),E(u)),vo(x,S),w[o].d(),_&&_.d()}}}function ooe(n){var x;let e,t,i,s,r,a,o=((x=n[22])==null?void 0:x.name)+"",l,c,h,u,d,f,g,m;return s=new soe({props:{className:"size-4.5",strokeWidth:"2"}}),d=new qg({props:{className:"size-4"}}),{c(){e=ie("div"),t=ie("div"),i=ie("div"),be(s.$$.fragment),r=Se(),a=ie("div"),l=At(o),c=Se(),h=ie("div"),u=ie("button"),be(d.$$.fragment),this.h()},l(p){e=se(p,"DIV",{class:!0});var y=V(e);t=se(y,"DIV",{class:!0});var w=V(t);i=se(w,"DIV",{class:!0});var v=V(i);ve(s.$$.fragment,v),v.forEach(E),r=Ie(w),a=se(w,"DIV",{class:!0});var _=V(a);l=St(_,o),_.forEach(E),w.forEach(E),c=Ie(y),h=se(y,"DIV",{class:!0});var C=V(h);u=se(C,"BUTTON",{class:!0,type:!0});var k=V(u);ve(d.$$.fragment,k),k.forEach(E),C.forEach(E),y.forEach(E),this.h()},h(){A(i,"class","rounded-full bg-gray-50 dark:bg-gray-800 p-3 w-fit"),A(a,"class","text-3xl"),A(t,"class","text-center flex gap-3.5 items-center"),A(u,"class","group-hover:visible invisible rounded-md"),A(u,"type","button"),A(h,"class","absolute -right-3"),A(e,"class","mb-3 px-4 justify-center w-fit flex relative group")},m(p,y){te(p,e,y),W(e,t),W(t,i),xe(s,i,null),W(t,r),W(t,a),W(a,l),W(e,c),W(e,h),W(h,u),xe(d,u,null),f=!0,g||(m=xt(u,"click",n[28]),g=!0)},p(p,y){var w;(!f||y[0]&4194304)&&o!==(o=((w=p[22])==null?void 0:w.name)+"")&&Pt(l,o)},i(p){f||(H(s.$$.fragment,p),H(d.$$.fragment,p),f=!0)},o(p){q(s.$$.fragment,p),q(d.$$.fragment,p),f=!1},d(p){p&&E(e),ye(s),ye(d),g=!1,m()}}}function loe(n){let e,t,i,s,r,a,o,l;function c(){return n[29](n[46])}return{c(){e=ie("button"),t=ie("img"),a=Se(),this.h()},l(h){e=se(h,"BUTTON",{"aria-hidden":!0,"aria-label":!0});var u=V(e);t=se(u,"IMG",{crossorigin:!0,src:!0,class:!0,"aria-hidden":!0,draggable:!0}),u.forEach(E),a=Ie(h),this.h()},h(){var h,u,d,f;A(t,"crossorigin","anonymous"),g0(t.src,i=((d=(u=(h=n[44])==null?void 0:h.info)==null?void 0:u.meta)==null?void 0:d.profile_image_url)??(n[21].language==="dg-DG"?`${Yo}/doge.png`:`${Yo}/static/favicon.png`))||A(t,"src",i),A(t,"class","size-9 @sm:size-10 rounded-full border-[1px] border-gray-100 dark:border-none"),A(t,"aria-hidden","true"),A(t,"draggable","false"),A(e,"aria-hidden",s=n[18].length<=1),A(e,"aria-label",r=n[21].t("Get information on {{name}} in the UI",{name:(f=n[18][n[46]])==null?void 0:f.name}))},m(h,u){te(h,e,u),W(e,t),te(h,a,u),o||(l=xt(e,"click",c),o=!0)},p(h,u){var d,f,g,m;n=h,u[0]&2359296&&!g0(t.src,i=((g=(f=(d=n[44])==null?void 0:d.info)==null?void 0:f.meta)==null?void 0:g.profile_image_url)??(n[21].language==="dg-DG"?`${Yo}/doge.png`:`${Yo}/static/favicon.png`))&&A(t,"src",i),u[0]&262144&&s!==(s=n[18].length<=1)&&A(e,"aria-hidden",s),u[0]&2359296&&r!==(r=n[21].t("Get information on {{name}} in the UI",{name:(m=n[18][n[46]])==null?void 0:m.name}))&&A(e,"aria-label",r)},d(h){h&&(E(e),E(a)),o=!1,l()}}}function dI(n){var i,s,r;let e,t;return e=new yi({props:{content:(((r=(s=(i=n[18][n[46]])==null?void 0:i.info)==null?void 0:s.meta)==null?void 0:r.tags)??[]).map(mI).join(", "),placement:"top",$$slots:{default:[loe]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(a){ve(e.$$.fragment,a)},m(a,o){xe(e,a,o),t=!0},p(a,o){var c,h,u;const l={};o[0]&262144&&(l.content=(((u=(h=(c=a[18][a[46]])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.tags)??[]).map(mI).join(", ")),o[0]&2883584|o[1]&65536&&(l.$$scope={dirty:o,ctx:a}),e.$set(l)},i(a){t||(H(e.$$.fragment,a),t=!0)},o(a){q(e.$$.fragment,a),t=!1},d(a){ye(e,a)}}}function coe(n){var i;let e=n[21].t("Hello, {{name}}",{name:(i=n[23])==null?void 0:i.name})+"",t;return{c(){t=At(e)},l(s){t=St(s,e)},m(s,r){te(s,t,r)},p(s,r){var a;r[0]&10485760&&e!==(e=s[21].t("Hello, {{name}}",{name:(a=s[23])==null?void 0:a.name})+"")&&Pt(t,e)},i:It,o:It,d(s){s&&E(t)}}}function hoe(n){var i;let e,t;return e=new yi({props:{content:(i=n[18][n[19]])==null?void 0:i.name,placement:"top",className:" flex items-center ",$$slots:{default:[uoe]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment)},l(s){ve(e.$$.fragment,s)},m(s,r){xe(e,s,r),t=!0},p(s,r){var o;const a={};r[0]&786432&&(a.content=(o=s[18][s[19]])==null?void 0:o.name),r[0]&786432|r[1]&65536&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){t||(H(e.$$.fragment,s),t=!0)},o(s){q(e.$$.fragment,s),t=!1},d(s){ye(e,s)}}}function uoe(n){var s;let e,t=((s=n[18][n[19]])==null?void 0:s.name)+"",i;return{c(){e=ie("span"),i=At(t),this.h()},l(r){e=se(r,"SPAN",{class:!0});var a=V(e);i=St(a,t),a.forEach(E),this.h()},h(){A(e,"class","line-clamp-1")},m(r,a){te(r,e,a),W(e,i)},p(r,a){var o;a[0]&786432&&t!==(t=((o=r[18][r[19]])==null?void 0:o.name)+"")&&Pt(i,t)},d(r){r&&E(e)}}}function fI(n){var a,o,l,c,h,u;let e,t,i,s;e=new yi({props:{className:" w-fit",content:_g.parse(d3(((l=(o=(a=n[18][n[19]])==null?void 0:a.info)==null?void 0:o.meta)==null?void 0:l.description)??"").replaceAll(`
`,"<br>")),placement:"top",$$slots:{default:[doe]},$$scope:{ctx:n}}});let r=((u=(h=(c=n[18][n[19]])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.user)&&gI(n);return{c(){be(e.$$.fragment),t=Se(),r&&r.c(),i=Xt()},l(d){ve(e.$$.fragment,d),t=Ie(d),r&&r.l(d),i=Xt()},m(d,f){xe(e,d,f),te(d,t,f),r&&r.m(d,f),te(d,i,f),s=!0},p(d,f){var m,x,p,y,w,v;const g={};f[0]&786432&&(g.content=_g.parse(d3(((p=(x=(m=d[18][d[19]])==null?void 0:m.info)==null?void 0:x.meta)==null?void 0:p.description)??"").replaceAll(`
`,"<br>"))),f[0]&786432|f[1]&65536&&(g.$$scope={dirty:f,ctx:d}),e.$set(g),(v=(w=(y=d[18][d[19]])==null?void 0:y.info)==null?void 0:w.meta)!=null&&v.user?r?r.p(d,f):(r=gI(d),r.c(),r.m(i.parentNode,i)):r&&(r.d(1),r=null)},i(d){s||(H(e.$$.fragment,d),s=!0)},o(d){q(e.$$.fragment,d),s=!1},d(d){d&&(E(t),E(i)),ye(e,d),r&&r.d(d)}}}function doe(n){var s,r,a;let e,t,i=_g.parse(d3(((a=(r=(s=n[18][n[19]])==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:a.description)??"").replaceAll(`
`,"<br>"))+"";return{c(){e=ie("div"),t=new yI(!1),this.h()},l(o){e=se(o,"DIV",{class:!0});var l=V(e);t=wI(l,!1),l.forEach(E),this.h()},h(){t.a=null,A(e,"class","mt-0.5 px-2 text-sm font-normal text-gray-500 dark:text-gray-400 line-clamp-2 max-w-xl markdown")},m(o,l){te(o,e,l),t.m(i,e)},p(o,l){var c,h,u;l[0]&786432&&i!==(i=_g.parse(d3(((u=(h=(c=o[18][o[19]])==null?void 0:c.info)==null?void 0:h.meta)==null?void 0:u.description)??"").replaceAll(`
`,"<br>"))+"")&&t.p(i)},d(o){o&&E(e)}}}function gI(n){let e,t;function i(a,o){var l,c,h;return(h=(c=(l=a[18][a[19]])==null?void 0:l.info)==null?void 0:c.meta)!=null&&h.user.community?goe:foe}let s=i(n),r=s(n);return{c(){e=ie("div"),t=At(`By
									`),r.c(),this.h()},l(a){e=se(a,"DIV",{class:!0});var o=V(e);t=St(o,`By
									`),r.l(o),o.forEach(E),this.h()},h(){A(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(a,o){te(a,e,o),W(e,t),r.m(e,null)},p(a,o){s===(s=i(a))&&r?r.p(a,o):(r.d(1),r=s(a),r&&(r.c(),r.m(e,null)))},d(a){a&&E(e),r.d()}}}function foe(n){var i,s,r;let e=((r=(s=(i=n[18][n[19]])==null?void 0:i.info)==null?void 0:s.meta)==null?void 0:r.user.name)+"",t;return{c(){t=At(e)},l(a){t=St(a,e)},m(a,o){te(a,t,o)},p(a,o){var l,c,h;o[0]&786432&&e!==(e=((h=(c=(l=a[18][a[19]])==null?void 0:l.info)==null?void 0:c.meta)==null?void 0:h.user.name)+"")&&Pt(t,e)},d(a){a&&E(t)}}}function goe(n){var r,a,o,l,c,h,u,d,f;let e,t=((o=(a=(r=n[18][n[19]])==null?void 0:r.info)==null?void 0:a.meta)!=null&&o.user.name?(h=(c=(l=n[18][n[19]])==null?void 0:l.info)==null?void 0:c.meta)==null?void 0:h.user.name:`@${(f=(d=(u=n[18][n[19]])==null?void 0:u.info)==null?void 0:d.meta)==null?void 0:f.user.username}`)+"",i,s;return{c(){e=ie("a"),i=At(t),this.h()},l(g){e=se(g,"A",{href:!0});var m=V(e);i=St(m,t),m.forEach(E),this.h()},h(){var g,m,x;A(e,"href",s="/m/"+((x=(m=(g=n[18][n[19]])==null?void 0:g.info)==null?void 0:m.meta)==null?void 0:x.user.username))},m(g,m){te(g,e,m),W(e,i)},p(g,m){var x,p,y,w,v,_,C,k,I,S,R,P;m[0]&786432&&t!==(t=((y=(p=(x=g[18][g[19]])==null?void 0:x.info)==null?void 0:p.meta)!=null&&y.user.name?(_=(v=(w=g[18][g[19]])==null?void 0:w.info)==null?void 0:v.meta)==null?void 0:_.user.name:`@${(I=(k=(C=g[18][g[19]])==null?void 0:C.info)==null?void 0:k.meta)==null?void 0:I.user.username}`)+"")&&Pt(i,t),m[0]&786432&&s!==(s="/m/"+((P=(R=(S=g[18][g[19]])==null?void 0:S.info)==null?void 0:R.meta)==null?void 0:P.user.username))&&A(e,"href",s)},d(g){g&&E(e)}}}function moe(n){var de,O,Y,le,$,re,oe;let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,v,_,C,k,I,S,R,P=n[20]&&uI(n);const D=[ooe,aoe],U=[];function T(ee,Q){return ee[22]?0:1}r=T(n),a=U[r]=D[r](n);function G(ee){n[32](ee)}function M(ee){n[33](ee)}function F(ee){n[34](ee)}function X(ee){n[35](ee)}function z(ee){n[36](ee)}function K(ee){n[37](ee)}function j(ee){n[38](ee)}function ae(ee){n[39](ee)}function ge(ee){n[40](ee)}function ue(ee){n[41](ee)}let pe={history:n[15],selectedModels:n[14],toolServers:n[17],transparentBackground:n[11],stopResponse:n[13],createMessagePair:n[12],placeholder:n[21].t("How can I help you today?"),onChange:n[30]};return n[3]!==void 0&&(pe.files=n[3]),n[2]!==void 0&&(pe.prompt=n[2]),n[0]!==void 0&&(pe.autoScroll=n[0]),n[5]!==void 0&&(pe.selectedToolIds=n[5]),n[6]!==void 0&&(pe.selectedFilterIds=n[6]),n[8]!==void 0&&(pe.imageGenerationEnabled=n[8]),n[9]!==void 0&&(pe.codeInterpreterEnabled=n[9]),n[10]!==void 0&&(pe.webSearchEnabled=n[10]),n[1]!==void 0&&(pe.atSelectedModel=n[1]),n[7]!==void 0&&(pe.showCommands=n[7]),c=new oO({props:pe}),n[31](c),Et.push(()=>Kt(c,"files",G)),Et.push(()=>Kt(c,"prompt",M)),Et.push(()=>Kt(c,"autoScroll",F)),Et.push(()=>Kt(c,"selectedToolIds",X)),Et.push(()=>Kt(c,"selectedFilterIds",z)),Et.push(()=>Kt(c,"imageGenerationEnabled",K)),Et.push(()=>Kt(c,"codeInterpreterEnabled",j)),Et.push(()=>Kt(c,"webSearchEnabled",ae)),Et.push(()=>Kt(c,"atSelectedModel",ge)),Et.push(()=>Kt(c,"showCommands",ue)),c.$on("upload",n[42]),c.$on("submit",n[43]),I=new aL({props:{suggestionPrompts:((Y=(O=(de=n[1])==null?void 0:de.info)==null?void 0:O.meta)==null?void 0:Y.suggestion_prompts)??((re=($=(le=n[18][n[19]])==null?void 0:le.info)==null?void 0:$.meta)==null?void 0:re.suggestion_prompts)??((oe=n[24])==null?void 0:oe.default_prompt_suggestions)??[],inputValue:n[2],onSelect:n[16]}}),{c(){e=ie("div"),P&&P.c(),t=Se(),i=ie("div"),s=ie("div"),a.c(),o=Se(),l=ie("div"),be(c.$$.fragment),_=Se(),C=ie("div"),k=ie("div"),be(I.$$.fragment),this.h()},l(ee){e=se(ee,"DIV",{class:!0});var Q=V(e);P&&P.l(Q),t=Ie(Q),i=se(Q,"DIV",{class:!0});var je=V(i);s=se(je,"DIV",{class:!0});var Re=V(s);a.l(Re),o=Ie(Re),l=se(Re,"DIV",{class:!0});var Ne=V(l);ve(c.$$.fragment,Ne),Ne.forEach(E),Re.forEach(E),je.forEach(E),_=Ie(Q),C=se(Q,"DIV",{class:!0});var He=V(C);k=se(He,"DIV",{class:!0});var Be=V(k);ve(I.$$.fragment,Be),Be.forEach(E),He.forEach(E),Q.forEach(E),this.h()},h(){A(l,"class",v="text-base font-normal @md:max-w-3xl w-full py-3 "+(n[1]?"mt-2":"")),A(s,"class","w-full flex flex-col justify-center items-center"),A(i,"class","w-full text-3xl text-gray-800 dark:text-gray-100 text-center flex items-center gap-4 font-primary"),A(k,"class","mx-5"),A(C,"class","mx-auto max-w-2xl font-primary mt-2"),A(e,"class","m-auto w-full max-w-6xl px-2 @2xl:px-20 translate-y-6 py-24 text-center")},m(ee,Q){te(ee,e,Q),P&&P.m(e,null),W(e,t),W(e,i),W(i,s),U[r].m(s,null),W(s,o),W(s,l),xe(c,l,null),W(e,_),W(e,C),W(C,k),xe(I,k,null),R=!0},p(ee,Q){var He,Be,Je,ht,ot,Ye,rt;ee[20]?P?(P.p(ee,Q),Q[0]&1048576&&H(P,1)):(P=uI(ee),P.c(),H(P,1),P.m(e,t)):P&&(yt(),q(P,1,1,()=>{P=null}),wt());let je=r;r=T(ee),r===je?U[r].p(ee,Q):(yt(),q(U[je],1,1,()=>{U[je]=null}),wt(),a=U[r],a?a.p(ee,Q):(a=U[r]=D[r](ee),a.c()),H(a,1),a.m(s,o));const Re={};Q[0]&32768&&(Re.history=ee[15]),Q[0]&16384&&(Re.selectedModels=ee[14]),Q[0]&131072&&(Re.toolServers=ee[17]),Q[0]&2048&&(Re.transparentBackground=ee[11]),Q[0]&8192&&(Re.stopResponse=ee[13]),Q[0]&4096&&(Re.createMessagePair=ee[12]),Q[0]&2097152&&(Re.placeholder=ee[21].t("How can I help you today?")),Q[0]&1048576&&(Re.onChange=ee[30]),!h&&Q[0]&8&&(h=!0,Re.files=ee[3],Wt(()=>h=!1)),!u&&Q[0]&4&&(u=!0,Re.prompt=ee[2],Wt(()=>u=!1)),!d&&Q[0]&1&&(d=!0,Re.autoScroll=ee[0],Wt(()=>d=!1)),!f&&Q[0]&32&&(f=!0,Re.selectedToolIds=ee[5],Wt(()=>f=!1)),!g&&Q[0]&64&&(g=!0,Re.selectedFilterIds=ee[6],Wt(()=>g=!1)),!m&&Q[0]&256&&(m=!0,Re.imageGenerationEnabled=ee[8],Wt(()=>m=!1)),!x&&Q[0]&512&&(x=!0,Re.codeInterpreterEnabled=ee[9],Wt(()=>x=!1)),!p&&Q[0]&1024&&(p=!0,Re.webSearchEnabled=ee[10],Wt(()=>p=!1)),!y&&Q[0]&2&&(y=!0,Re.atSelectedModel=ee[1],Wt(()=>y=!1)),!w&&Q[0]&128&&(w=!0,Re.showCommands=ee[7],Wt(()=>w=!1)),c.$set(Re),(!R||Q[0]&2&&v!==(v="text-base font-normal @md:max-w-3xl w-full py-3 "+(ee[1]?"mt-2":"")))&&A(l,"class",v);const Ne={};Q[0]&17563650&&(Ne.suggestionPrompts=((Je=(Be=(He=ee[1])==null?void 0:He.info)==null?void 0:Be.meta)==null?void 0:Je.suggestion_prompts)??((Ye=(ot=(ht=ee[18][ee[19]])==null?void 0:ht.info)==null?void 0:ot.meta)==null?void 0:Ye.suggestion_prompts)??((rt=ee[24])==null?void 0:rt.default_prompt_suggestions)??[]),Q[0]&4&&(Ne.inputValue=ee[2]),Q[0]&65536&&(Ne.onSelect=ee[16]),I.$set(Ne)},i(ee){R||(H(P),H(a),H(c.$$.fragment,ee),H(I.$$.fragment,ee),ee&&(S||Rh(()=>{S=up(C,dp,{duration:200,delay:200}),S.start()})),R=!0)},o(ee){q(P),q(a),q(c.$$.fragment,ee),q(I.$$.fragment,ee),R=!1},d(ee){ee&&E(e),P&&P.d(),U[r].d(),n[31](null),ye(c),ye(I)}}}const mI=n=>n.name.toUpperCase();function poe(n,e,t){let i,s,r,a,o,l;Oe(n,Vg,re=>t(27,i=re)),Oe(n,Od,re=>t(20,s=re)),Oe(n,u3,re=>t(22,a=re)),Oe(n,w0,re=>t(23,o=re)),Oe(n,Gg,re=>t(24,l=re));const c=Ka(),h=qs("i18n");Oe(n,h,re=>t(21,r=re));let{transparentBackground:u=!1}=e,{createMessagePair:d}=e,{stopResponse:f}=e,{autoScroll:g=!1}=e,{atSelectedModel:m}=e,{selectedModels:x}=e,{history:p}=e,{prompt:y=""}=e,{files:w=[]}=e,{messageInput:v=null}=e,{selectedToolIds:_=[]}=e,{selectedFilterIds:C=[]}=e,{showCommands:k=!1}=e,{imageGenerationEnabled:I=!1}=e,{codeInterpreterEnabled:S=!1}=e,{webSearchEnabled:R=!1}=e,{onSelect:P=re=>{}}=e,{toolServers:D=[]}=e,U=[],T=0;ol(()=>{});const G=()=>{u3.set(null)},M=re=>{t(19,T=re)},F=re=>{s||(re.prompt!==null?sessionStorage.setItem("chat-input",JSON.stringify(re)):sessionStorage.removeItem("chat-input"))};function X(re){Et[re?"unshift":"push"](()=>{v=re,t(4,v)})}function z(re){w=re,t(3,w)}function K(re){y=re,t(2,y)}function j(re){g=re,t(0,g)}function ae(re){_=re,t(5,_)}function ge(re){C=re,t(6,C)}function ue(re){I=re,t(8,I)}function pe(re){S=re,t(9,S)}function de(re){R=re,t(10,R)}function O(re){m=re,t(1,m)}function Y(re){k=re,t(7,k)}const le=re=>{c("upload",re.detail)},$=re=>{c("submit",re.detail)};return n.$$set=re=>{"transparentBackground"in re&&t(11,u=re.transparentBackground),"createMessagePair"in re&&t(12,d=re.createMessagePair),"stopResponse"in re&&t(13,f=re.stopResponse),"autoScroll"in re&&t(0,g=re.autoScroll),"atSelectedModel"in re&&t(1,m=re.atSelectedModel),"selectedModels"in re&&t(14,x=re.selectedModels),"history"in re&&t(15,p=re.history),"prompt"in re&&t(2,y=re.prompt),"files"in re&&t(3,w=re.files),"messageInput"in re&&t(4,v=re.messageInput),"selectedToolIds"in re&&t(5,_=re.selectedToolIds),"selectedFilterIds"in re&&t(6,C=re.selectedFilterIds),"showCommands"in re&&t(7,k=re.showCommands),"imageGenerationEnabled"in re&&t(8,I=re.imageGenerationEnabled),"codeInterpreterEnabled"in re&&t(9,S=re.codeInterpreterEnabled),"webSearchEnabled"in re&&t(10,R=re.webSearchEnabled),"onSelect"in re&&t(16,P=re.onSelect),"toolServers"in re&&t(17,D=re.toolServers)},n.$$.update=()=>{n.$$.dirty[0]&134234112&&t(18,U=x.map(re=>i.find(oe=>oe.id===re))),n.$$.dirty[0]&278528&&x.length>0&&t(19,T=U.length-1)},[g,m,y,w,v,_,C,k,I,S,R,u,d,f,x,p,P,D,U,T,s,r,a,o,l,c,h,i,G,M,F,X,z,K,j,ae,ge,ue,pe,de,O,Y,le,$]}class boe extends Ht{constructor(e){super(),zt(this,e,poe,moe,qt,{transparentBackground:11,createMessagePair:12,stopResponse:13,autoScroll:0,atSelectedModel:1,selectedModels:14,history:15,prompt:2,files:3,messageInput:4,selectedToolIds:5,selectedFilterIds:6,showCommands:7,imageGenerationEnabled:8,codeInterpreterEnabled:9,webSearchEnabled:10,onSelect:16,toolServers:17},null,[-1,-1])}}const{document:Xw}=_I;function xoe(n){let e,t,i,s;return i=new t4({props:{className:"size-5"}}),{c(){e=ie("div"),t=ie("div"),be(i.$$.fragment),this.h()},l(r){e=se(r,"DIV",{class:!0});var a=V(e);t=se(a,"DIV",{class:!0});var o=V(t);ve(i.$$.fragment,o),o.forEach(E),a.forEach(E),this.h()},h(){A(t,"class","m-auto"),A(e,"class","flex items-center justify-center h-full w-full")},m(r,a){te(r,e,a),W(e,t),xe(i,t,null),s=!0},p:It,i(r){s||(H(i.$$.fragment,r),s=!0)},o(r){q(i.$$.fragment,r),s=!1},d(r){r&&E(e),ye(i)}}}function yoe(n){var o;let e,t,i,s,r,a=(((o=n[31])==null?void 0:o.backgroundImageUrl)??null)&&pI(n);return i=new uD({props:{direction:"horizontal",class:"w-full h-full",$$slots:{default:[koe]},$$scope:{ctx:n}}}),{c(){e=ie("div"),a&&a.c(),t=Se(),be(i.$$.fragment),this.h()},l(l){e=se(l,"DIV",{class:!0});var c=V(e);a&&a.l(c),t=Ie(c),ve(i.$$.fragment,c),c.forEach(E),this.h()},h(){A(e,"class","w-full h-full flex flex-col")},m(l,c){te(l,e,c),a&&a.m(e,null),W(e,t),xe(i,e,null),r=!0},p(l,c){var u;((u=l[31])==null?void 0:u.backgroundImageUrl)??null?a?a.p(l,c):(a=pI(l),a.c(),a.m(e,t)):a&&(a.d(1),a=null);const h={};c[0]&2147353591|c[1]&15|c[4]&128&&(h.$$scope={dirty:c,ctx:l}),i.$set(h)},i(l){r||(H(i.$$.fragment,l),l&&(s||Rh(()=>{s=up(e,dp,{duration:50}),s.start()})),r=!0)},o(l){q(i.$$.fragment,l),r=!1},d(l){l&&E(e),a&&a.d(),ye(i)}}}function pI(n){let e,t,i,s;return{c(){e=ie("div"),i=Se(),s=ie("div"),this.h()},l(r){e=se(r,"DIV",{class:!0,style:!0}),V(e).forEach(E),i=Ie(r),s=se(r,"DIV",{class:!0}),V(s).forEach(E),this.h()},h(){A(e,"class",t="absolute "+(n[36]?"md:max-w-[calc(100%-260px)] md:translate-x-[260px]":"")+" top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat"),tn(e,"background-image","url("+n[31].backgroundImageUrl+")"),A(s,"class","absolute top-0 left-0 w-full h-full bg-linear-to-t from-white to-white/85 dark:from-gray-900 dark:to-gray-900/90 z-0")},m(r,a){te(r,e,a),te(r,i,a),te(r,s,a)},p(r,a){a[1]&32&&t!==(t="absolute "+(r[36]?"md:max-w-[calc(100%-260px)] md:translate-x-[260px]":"")+" top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat")&&A(e,"class",t),a[1]&1&&tn(e,"background-image","url("+r[31].backgroundImageUrl+")")},d(r){r&&(E(e),E(i),E(s))}}}function woe(n){var P;let e,t,i,s,r,a,o,l,c,h,u,d,f,g;function m(D){n[81](D)}function x(D){n[82](D)}function p(D){n[83](D)}function y(D){n[84](D)}function w(D){n[85](D)}function v(D){n[86](D)}function _(D){n[87](D)}function C(D){n[88](D)}function k(D){n[89](D)}function I(D){n[90](D)}function S(D){n[91](D)}let R={history:n[23],selectedModels:n[0],transparentBackground:((P=n[31])==null?void 0:P.backgroundImageUrl)??!1,toolServers:n[33],stopResponse:n[50],createMessagePair:n[46],onSelect:n[39]};return n[6]!==void 0&&(R.messageInput=n[6]),n[27]!==void 0&&(R.files=n[27]),n[25]!==void 0&&(R.prompt=n[25]),n[7]!==void 0&&(R.autoScroll=n[7]),n[17]!==void 0&&(R.selectedToolIds=n[17]),n[18]!==void 0&&(R.selectedFilterIds=n[18]),n[19]!==void 0&&(R.imageGenerationEnabled=n[19]),n[21]!==void 0&&(R.codeInterpreterEnabled=n[21]),n[20]!==void 0&&(R.webSearchEnabled=n[20]),n[1]!==void 0&&(R.atSelectedModel=n[1]),n[22]!==void 0&&(R.showCommands=n[22]),t=new boe({props:R}),Et.push(()=>Kt(t,"messageInput",m)),Et.push(()=>Kt(t,"files",x)),Et.push(()=>Kt(t,"prompt",p)),Et.push(()=>Kt(t,"autoScroll",y)),Et.push(()=>Kt(t,"selectedToolIds",w)),Et.push(()=>Kt(t,"selectedFilterIds",v)),Et.push(()=>Kt(t,"imageGenerationEnabled",_)),Et.push(()=>Kt(t,"codeInterpreterEnabled",C)),Et.push(()=>Kt(t,"webSearchEnabled",k)),Et.push(()=>Kt(t,"atSelectedModel",I)),Et.push(()=>Kt(t,"showCommands",S)),t.$on("upload",n[92]),t.$on("submit",n[93]),{c(){e=ie("div"),be(t.$$.fragment),this.h()},l(D){e=se(D,"DIV",{class:!0});var U=V(e);ve(t.$$.fragment,U),U.forEach(E),this.h()},h(){A(e,"class","overflow-auto w-full h-full flex items-center")},m(D,U){te(D,e,U),xe(t,e,null),g=!0},p(D,U){var G;const T={};U[0]&8388608&&(T.history=D[23]),U[0]&1&&(T.selectedModels=D[0]),U[1]&1&&(T.transparentBackground=((G=D[31])==null?void 0:G.backgroundImageUrl)??!1),U[1]&4&&(T.toolServers=D[33]),!i&&U[0]&64&&(i=!0,T.messageInput=D[6],Wt(()=>i=!1)),!s&&U[0]&134217728&&(s=!0,T.files=D[27],Wt(()=>s=!1)),!r&&U[0]&33554432&&(r=!0,T.prompt=D[25],Wt(()=>r=!1)),!a&&U[0]&128&&(a=!0,T.autoScroll=D[7],Wt(()=>a=!1)),!o&&U[0]&131072&&(o=!0,T.selectedToolIds=D[17],Wt(()=>o=!1)),!l&&U[0]&262144&&(l=!0,T.selectedFilterIds=D[18],Wt(()=>l=!1)),!c&&U[0]&524288&&(c=!0,T.imageGenerationEnabled=D[19],Wt(()=>c=!1)),!h&&U[0]&2097152&&(h=!0,T.codeInterpreterEnabled=D[21],Wt(()=>h=!1)),!u&&U[0]&1048576&&(u=!0,T.webSearchEnabled=D[20],Wt(()=>u=!1)),!d&&U[0]&2&&(d=!0,T.atSelectedModel=D[1],Wt(()=>d=!1)),!f&&U[0]&4194304&&(f=!0,T.showCommands=D[22],Wt(()=>f=!1)),t.$set(T)},i(D){g||(H(t.$$.fragment,D),g=!0)},o(D){q(t.$$.fragment,D),g=!1},d(D){D&&E(e),ye(t)}}}function voe(n){var pe;let e,t,i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,v,_,C="",k,I,S;function R(de){n[62](de)}function P(de){n[63](de)}function D(de){n[64](de)}let U={chatId:n[30],selectedModels:n[0],atSelectedModel:n[1],sendPrompt:n[49],showMessage:n[40],submitMessage:n[51],continueResponse:n[53],regenerateResponse:n[52],mergeResponses:n[54],chatActionHandler:n[45],addMessages:n[47],bottomPadding:n[27].length>0,onSelect:n[39]};n[23]!==void 0&&(U.history=n[23]),n[7]!==void 0&&(U.autoScroll=n[7]),n[25]!==void 0&&(U.prompt=n[25]),i=new oL({props:U}),Et.push(()=>Kt(i,"history",R)),Et.push(()=>Kt(i,"autoScroll",P)),Et.push(()=>Kt(i,"prompt",D));function T(de){n[69](de)}function G(de){n[70](de)}function M(de){n[71](de)}function F(de){n[72](de)}function X(de){n[73](de)}function z(de){n[74](de)}function K(de){n[75](de)}function j(de){n[76](de)}function ae(de){n[77](de)}function ge(de){n[78](de)}let ue={history:n[23],taskIds:n[24],selectedModels:n[0],toolServers:n[33],transparentBackground:((pe=n[31])==null?void 0:pe.backgroundImageUrl)??!1,stopResponse:n[50],createMessagePair:n[46],onChange:n[67]};return n[27]!==void 0&&(ue.files=n[27]),n[25]!==void 0&&(ue.prompt=n[25]),n[7]!==void 0&&(ue.autoScroll=n[7]),n[17]!==void 0&&(ue.selectedToolIds=n[17]),n[18]!==void 0&&(ue.selectedFilterIds=n[18]),n[19]!==void 0&&(ue.imageGenerationEnabled=n[19]),n[21]!==void 0&&(ue.codeInterpreterEnabled=n[21]),n[20]!==void 0&&(ue.webSearchEnabled=n[20]),n[1]!==void 0&&(ue.atSelectedModel=n[1]),n[22]!==void 0&&(ue.showCommands=n[22]),c=new oO({props:ue}),n[68](c),Et.push(()=>Kt(c,"files",T)),Et.push(()=>Kt(c,"prompt",G)),Et.push(()=>Kt(c,"autoScroll",M)),Et.push(()=>Kt(c,"selectedToolIds",F)),Et.push(()=>Kt(c,"selectedFilterIds",X)),Et.push(()=>Kt(c,"imageGenerationEnabled",z)),Et.push(()=>Kt(c,"codeInterpreterEnabled",K)),Et.push(()=>Kt(c,"webSearchEnabled",j)),Et.push(()=>Kt(c,"atSelectedModel",ae)),Et.push(()=>Kt(c,"showCommands",ge)),c.$on("upload",n[79]),c.$on("submit",n[80]),{c(){e=ie("div"),t=ie("div"),be(i.$$.fragment),o=Se(),l=ie("div"),be(c.$$.fragment),v=Se(),_=ie("div"),_.innerHTML=C,this.h()},l(de){e=se(de,"DIV",{class:!0,id:!0});var O=V(e);t=se(O,"DIV",{class:!0});var Y=V(t);ve(i.$$.fragment,Y),Y.forEach(E),O.forEach(E),o=Ie(de),l=se(de,"DIV",{class:!0});var le=V(l);ve(c.$$.fragment,le),v=Ie(le),_=se(le,"DIV",{class:!0,"data-svelte-h":!0}),_o(_)!=="svelte-ko82kn"&&(_.innerHTML=C),le.forEach(E),this.h()},h(){A(t,"class","h-full w-full flex flex-col"),A(e,"class","pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0 max-w-full z-10 scrollbar-hidden"),A(e,"id","messages-container"),A(_,"class","absolute bottom-1 text-xs text-gray-500 text-center line-clamp-1 right-0 left-0"),A(l,"class","pb-2")},m(de,O){te(de,e,O),W(e,t),xe(i,t,null),n[65](e),te(de,o,O),te(de,l,O),xe(c,l,null),W(l,v),W(l,_),k=!0,I||(S=xt(e,"scroll",n[66]),I=!0)},p(de,O){var $;const Y={};O[0]&1073741824&&(Y.chatId=de[30]),O[0]&1&&(Y.selectedModels=de[0]),O[0]&2&&(Y.atSelectedModel=de[1]),O[0]&134217728&&(Y.bottomPadding=de[27].length>0),!s&&O[0]&8388608&&(s=!0,Y.history=de[23],Wt(()=>s=!1)),!r&&O[0]&128&&(r=!0,Y.autoScroll=de[7],Wt(()=>r=!1)),!a&&O[0]&33554432&&(a=!0,Y.prompt=de[25],Wt(()=>a=!1)),i.$set(Y);const le={};O[0]&8388608&&(le.history=de[23]),O[0]&16777216&&(le.taskIds=de[24]),O[0]&1&&(le.selectedModels=de[0]),O[1]&4&&(le.toolServers=de[33]),O[1]&1&&(le.transparentBackground=(($=de[31])==null?void 0:$.backgroundImageUrl)??!1),O[0]&1610612736&&(le.onChange=de[67]),!h&&O[0]&134217728&&(h=!0,le.files=de[27],Wt(()=>h=!1)),!u&&O[0]&33554432&&(u=!0,le.prompt=de[25],Wt(()=>u=!1)),!d&&O[0]&128&&(d=!0,le.autoScroll=de[7],Wt(()=>d=!1)),!f&&O[0]&131072&&(f=!0,le.selectedToolIds=de[17],Wt(()=>f=!1)),!g&&O[0]&262144&&(g=!0,le.selectedFilterIds=de[18],Wt(()=>g=!1)),!m&&O[0]&524288&&(m=!0,le.imageGenerationEnabled=de[19],Wt(()=>m=!1)),!x&&O[0]&2097152&&(x=!0,le.codeInterpreterEnabled=de[21],Wt(()=>x=!1)),!p&&O[0]&1048576&&(p=!0,le.webSearchEnabled=de[20],Wt(()=>p=!1)),!y&&O[0]&2&&(y=!0,le.atSelectedModel=de[1],Wt(()=>y=!1)),!w&&O[0]&4194304&&(w=!0,le.showCommands=de[22],Wt(()=>w=!1)),c.$set(le)},i(de){k||(H(i.$$.fragment,de),H(c.$$.fragment,de),k=!0)},o(de){q(i.$$.fragment,de),q(c.$$.fragment,de),k=!1},d(de){de&&(E(e),E(o),E(l)),ye(i),n[65](null),n[68](null),ye(c),I=!1,S()}}}function _oe(n){let e,t,i,s,r,a,o,l;function c(g){n[61](g)}let h={chat:{id:n[30],chat:{title:n[34],models:n[0],system:n[31].system??void 0,params:n[28],history:n[23],timestamp:Date.now()}},history:n[23],title:n[34],shareEnabled:!!n[23].currentId,initNewChat:n[44],showBanners:!n[22]};n[0]!==void 0&&(h.selectedModels=n[0]),e=new Ute({props:h}),n[60](e),Et.push(()=>Kt(e,"selectedModels",c));const u=[voe,woe],d=[];function f(g,m){var x;return m[0]&8388608|m[1]&1&&(r=null),r==null&&(r=((x=g[31])==null?void 0:x.landingPageMode)==="chat"||Oa(g[23],g[23].currentId).length>0),r?0:1}return a=f(n,[-1,-1,-1,-1,-1]),o=d[a]=u[a](n),{c(){be(e.$$.fragment),i=Se(),s=ie("div"),o.c(),this.h()},l(g){ve(e.$$.fragment,g),i=Ie(g),s=se(g,"DIV",{class:!0});var m=V(s);o.l(m),m.forEach(E),this.h()},h(){A(s,"class","flex flex-col flex-auto z-10 w-full @container")},m(g,m){xe(e,g,m),te(g,i,m),te(g,s,m),d[a].m(s,null),l=!0},p(g,m){const x={};m[0]&1350565889|m[1]&9&&(x.chat={id:g[30],chat:{title:g[34],models:g[0],system:g[31].system??void 0,params:g[28],history:g[23],timestamp:Date.now()}}),m[0]&8388608&&(x.history=g[23]),m[1]&8&&(x.title=g[34]),m[0]&8388608&&(x.shareEnabled=!!g[23].currentId),m[0]&4194304&&(x.showBanners=!g[22]),!t&&m[0]&1&&(t=!0,x.selectedModels=g[0],Wt(()=>t=!1)),e.$set(x);let p=a;a=f(g,m),a===p?d[a].p(g,m):(yt(),q(d[p],1,1,()=>{d[p]=null}),wt(),o=d[a],o?o.p(g,m):(o=d[a]=u[a](g),o.c()),H(o,1),o.m(s,null))},i(g){l||(H(e.$$.fragment,g),H(o),l=!0)},o(g){q(e.$$.fragment,g),q(o),l=!1},d(g){g&&(E(i),E(s)),n[60](null),ye(e,g),d[a].d()}}}function koe(n){var x;let e,t,i,s,r,a,o,l,c;e=new CI({props:{defaultSize:50,class:"h-full flex relative max-w-full flex-col",$$slots:{default:[_oe]},$$scope:{ctx:n}}});function h(p){n[96](p)}function u(p){n[97](p)}function d(p){n[98](p)}function f(p){n[99](p)}function g(p){n[100](p)}let m={chatId:n[30],modelId:((x=n[2])==null?void 0:x.at(0))??null,models:n[2].reduce(n[94],[]),submitPrompt:n[48],stopResponse:n[50],showMessage:n[40],eventTarget:n[38]};return n[23]!==void 0&&(m.history=n[23]),n[26]!==void 0&&(m.chatFiles=n[26]),n[28]!==void 0&&(m.params=n[28]),n[27]!==void 0&&(m.files=n[27]),n[4]!==void 0&&(m.pane=n[4]),i=new toe({props:m}),n[95](i),Et.push(()=>Kt(i,"history",h)),Et.push(()=>Kt(i,"chatFiles",u)),Et.push(()=>Kt(i,"params",d)),Et.push(()=>Kt(i,"files",f)),Et.push(()=>Kt(i,"pane",g)),{c(){be(e.$$.fragment),t=Se(),be(i.$$.fragment)},l(p){ve(e.$$.fragment,p),t=Ie(p),ve(i.$$.fragment,p)},m(p,y){xe(e,p,y),te(p,t,y),xe(i,p,y),c=!0},p(p,y){var _;const w={};y[0]&2080244675|y[1]&13|y[4]&128&&(w.$$scope={dirty:y,ctx:p}),e.$set(w);const v={};y[0]&1073741824&&(v.chatId=p[30]),y[0]&4&&(v.modelId=((_=p[2])==null?void 0:_.at(0))??null),y[0]&4|y[1]&2&&(v.models=p[2].reduce(p[94],[])),!s&&y[0]&8388608&&(s=!0,v.history=p[23],Wt(()=>s=!1)),!r&&y[0]&67108864&&(r=!0,v.chatFiles=p[26],Wt(()=>r=!1)),!a&&y[0]&268435456&&(a=!0,v.params=p[28],Wt(()=>a=!1)),!o&&y[0]&134217728&&(o=!0,v.files=p[27],Wt(()=>o=!1)),!l&&y[0]&16&&(l=!0,v.pane=p[4],Wt(()=>l=!1)),i.$set(v)},i(p){c||(H(e.$$.fragment,p),H(i.$$.fragment,p),c=!0)},o(p){q(e.$$.fragment,p),q(i.$$.fragment,p),c=!1},d(p){p&&E(t),ye(e,p),n[95](null),ye(i,p)}}}function Coe(n){let e,t,i,s,r,a,o,l,c,h,u,d,f;Xw.title=e=`
		`+(n[34]?`${n[34].length>30?`${n[34].slice(0,30)}...`:n[34]} • ${n[35]}`:`${n[35]}`)+`
	`;function g(w){n[57](w)}let m={title:n[11],message:n[12],input:n[13],inputPlaceholder:n[14],inputValue:n[15]};n[10]!==void 0&&(m.show=n[10]),a=new IL({props:m}),Et.push(()=>Kt(a,"show",g)),a.$on("confirm",n[58]),a.$on("cancel",n[59]);const x=[yoe,xoe],p=[];function y(w,v){return w[3]?w[3]?1:-1:0}return~(h=y(n))&&(u=p[h]=x[h](n)),{c(){t=Se(),i=ie("audio"),r=Se(),be(a.$$.fragment),l=Se(),c=ie("div"),u&&u.c(),this.h()},l(w){QO("svelte-5280jy",Xw.head).forEach(E),t=Ie(w),i=se(w,"AUDIO",{id:!0,src:!0,style:!0}),V(i).forEach(E),r=Ie(w),ve(a.$$.fragment,w),l=Ie(w),c=se(w,"DIV",{class:!0,id:!0});var _=V(c);u&&u.l(_),_.forEach(E),this.h()},h(){A(i,"id","audioElement"),g0(i.src,s="")||A(i,"src",s),tn(i,"display","none"),A(c,"class",d="h-screen max-h-[100dvh] transition-width duration-200 ease-in-out "+(n[36]?"  md:max-w-[calc(100%-260px)]":" ")+" w-full max-w-full flex flex-col"),A(c,"id","chat-container")},m(w,v){te(w,t,v),te(w,i,v),te(w,r,v),xe(a,w,v),te(w,l,v),te(w,c,v),~h&&p[h].m(c,null),f=!0},p(w,v){(!f||v[1]&24)&&e!==(e=`
		`+(w[34]?`${w[34].length>30?`${w[34].slice(0,30)}...`:w[34]} • ${w[35]}`:`${w[35]}`)+`
	`)&&(Xw.title=e);const _={};v[0]&2048&&(_.title=w[11]),v[0]&4096&&(_.message=w[12]),v[0]&8192&&(_.input=w[13]),v[0]&16384&&(_.inputPlaceholder=w[14]),v[0]&32768&&(_.inputValue=w[15]),!o&&v[0]&1024&&(o=!0,_.show=w[10],Wt(()=>o=!1)),a.$set(_);let C=h;h=y(w),h===C?~h&&p[h].p(w,v):(u&&(yt(),q(p[C],1,1,()=>{p[C]=null}),wt()),~h?(u=p[h],u?u.p(w,v):(u=p[h]=x[h](w),u.c()),H(u,1),u.m(c,null)):u=null),(!f||v[1]&32&&d!==(d="h-screen max-h-[100dvh] transition-width duration-200 ease-in-out "+(w[36]?"  md:max-w-[calc(100%-260px)]":" ")+" w-full max-w-full flex flex-col"))&&A(c,"class",d)},i(w){f||(H(a.$$.fragment,w),H(u),f=!0)},o(w){q(a.$$.fragment,w),q(u),f=!1},d(w){w&&(E(t),E(i),E(r),E(l),E(c)),ye(a,w),~h&&p[h].d()}}}function Aoe(n,e,t){let i,s,r,a,o,l,c,h,u,d,f,g,m,x,p,y,w,v;Oe(n,Kh,Z=>t(104,i=Z)),Oe(n,Od,Z=>t(29,s=Z)),Oe(n,cu,Z=>t(30,r=Z)),Oe(n,u3,Z=>t(105,a=Z)),Oe(n,ja,Z=>t(31,o=Z)),Oe(n,Vg,Z=>t(32,c=Z)),Oe(n,bD,Z=>t(107,h=Z)),Oe(n,w0,Z=>t(108,u=Z)),Oe(n,Gg,Z=>t(109,d=Z)),Oe(n,AI,Z=>t(33,f=Z)),Oe(n,Fa,Z=>t(110,g=Z)),Oe(n,s_,Z=>t(111,m=Z)),Oe(n,tx,Z=>t(112,x=Z)),Oe(n,zd,Z=>t(113,p=Z)),Oe(n,Sx,Z=>t(34,y=Z)),Oe(n,SI,Z=>t(35,w=Z)),Oe(n,Zw,Z=>t(36,v=Z));const _=qs("i18n");Oe(n,_,Z=>t(106,l=Z));let{chatIdProp:C=""}=e,k=!0;const I=new EventTarget;let S,R,P,D=!0,U,T,G=!1,M="",F="",X=!1,z="",K="",j=null,ae=[""],ge,ue=[],pe=[],de=[],O=!1,Y=!1,le=!1,$=!1,re=null,oe={messages:{},currentId:null},ee=null,Q="",je=[],Re=[],Ne={};const He=async()=>{t(3,k=!0),t(25,Q=""),P==null||P.setText(""),t(27,Re=[]),t(17,pe=[]),t(18,de=[]),t(20,Y=!1),t(19,O=!1);const Z=sessionStorage.getItem(`chat-input${C?`-${C}`:""}`);if(C&&await Dt()){if(await un(),t(3,k=!1),window.setTimeout(()=>gt(),0),await un(),Z)try{const Pe=JSON.parse(Z);s||(P==null||P.setText(Pe.prompt),t(27,Re=Pe.files),t(17,pe=Pe.selectedToolIds),t(18,de=Pe.selectedFilterIds),t(20,Y=Pe.webSearchEnabled),t(19,O=Pe.imageGenerationEnabled),t(21,le=Pe.codeInterpreterEnabled))}catch{}const Te=document.getElementById("chat-input");Te==null||Te.focus()}else await i_("/")},Be=async Z=>{const{type:Te,data:Pe}=Z;Te==="prompt"&&(P==null||P.setText(Pe))},Je=()=>{ae.length===0||ae.length===1&&ae[0]===""||(sessionStorage.selectedModels=JSON.stringify(ae),sessionStorage.selectedModels)};let ht=[""];const ot=()=>{ht.filter(Z=>Z).length>0&&Ye(),t(56,ht=ue)},Ye=()=>{rt(),t(18,de=[]),t(20,Y=!1),t(19,O=!1),t(21,le=!1)},rt=async()=>{var Te,Pe,at,We;if(p||zd.set(await Z6(localStorage.token)),ae.length!==1&&!ge)return;const Z=ge??c.find(Ge=>Ge.id===ae[0]);Z&&((Pe=(Te=Z==null?void 0:Z.info)==null?void 0:Te.meta)!=null&&Pe.toolIds)?t(17,pe=[...new Set([...((We=(at=Z==null?void 0:Z.info)==null?void 0:at.meta)==null?void 0:We.toolIds)??[]].filter(Ge=>p.find(nt=>nt.id===Ge)))]):t(17,pe=[])},me=async Z=>{await un();const Te=JSON.parse(JSON.stringify(r));let Pe=JSON.parse(JSON.stringify(Z.id)),at=[];for(Pe===null?at=Object.keys(oe.messages).filter(We=>oe.messages[We].parentId===null):at=oe.messages[Pe].childrenIds;at.length!==0;)Pe=at.at(-1),at=oe.messages[Pe].childrenIds;if(t(23,oe.currentId=Pe,oe),await un(),await un(),await un(),(o==null?void 0:o.scrollOnBranchChange)??!0){const We=document.getElementById(`message-${Z.id}`);We&&We.scrollIntoView({behavior:"smooth"})}await un(),Vt(Te,oe)},Mt=async(Z,Te)=>{var Pe,at;if(Z.chat_id===r){await un();let We=oe.messages[Z.message_id];if(We){const Ge=((Pe=Z==null?void 0:Z.data)==null?void 0:Pe.type)??null,nt=((at=Z==null?void 0:Z.data)==null?void 0:at.data)??null;if(Ge==="status")We!=null&&We.statusHistory?We.statusHistory.push(nt):We.statusHistory=[nt];else if(Ge==="chat:completion")xs(nt,We,Z.chat_id);else if(Ge==="chat:message:delta"||Ge==="message")We.content+=nt.content;else if(Ge==="chat:message"||Ge==="replace")We.content=nt.content;else if(Ge==="chat:message:files"||Ge==="files")We.files=nt.files;else if(Ge==="chat:message:follow_ups")We.followUps=nt.follow_ups,D&&gt("smooth");else if(Ge==="chat:title")Sx.set(nt),Kh.set(1),await Xh.set(await cf(localStorage.token,i));else if(Ge==="chat:tags")re=await Qw(localStorage.token,r),xD.set(await OD(localStorage.token));else if(Ge==="source"||Ge==="citation")if((nt==null?void 0:nt.type)==="code_execution"){We!=null&&We.code_executions||(We.code_executions=[]);const et=We.code_executions.findIndex(vt=>vt.id===nt.id);et!==-1?We.code_executions[et]=nt:We.code_executions.push(nt),We.code_executions=We.code_executions}else We!=null&&We.sources?We.sources.push(nt):We.sources=[nt];else if(Ge==="notification"){const et=(nt==null?void 0:nt.type)??"info",vt=(nt==null?void 0:nt.content)??"";et==="success"?on.success(vt):et==="error"?on.error(vt):et==="warning"?on.warning(vt):on.info(vt)}else if(Ge==="confirmation")t(16,j=Te),t(13,X=!1),t(10,G=!0),t(11,M=nt.title),t(12,F=nt.message);else if(Ge==="execute"){t(16,j=Te);try{const vt=await new Function(`return (async () => { ${nt.code} })()`)();Te&&Te(vt)}catch(et){console.error("Error executing code:",et)}}else Ge==="input"&&(t(16,j=Te),t(13,X=!0),t(10,G=!0),t(11,M=nt.title),t(12,F=nt.message),t(14,z=nt.placeholder),t(15,K=(nt==null?void 0:nt.value)??""));t(23,oe.messages[Z.message_id]=We,oe)}}},ut=async Z=>{if(Z.origin===window.origin){if(Z.data.type==="input:prompt"){Z.data.text;const Te=document.getElementById("chat-input");Te&&(P==null||P.setText(Z.data.text),Te.focus())}Z.data.type==="action:submit"&&(Z.data.text,Q!==""&&(await un(),hi(Q))),Z.data.type==="input:prompt:submit"&&(Z.data.text,Z.data.text!==""&&(await un(),hi(Z.data.text)))}};let dt=null;ol(async()=>{t(3,k=!0),window.addEventListener("message",ut),h==null||h.on("chat-events",Mt),dt=s_.subscribe(async Pe=>{Pe.url.pathname==="/"&&(await un(),Me())});const Z=sessionStorage.getItem(`chat-input${C?`-${C}`:""}`);if(C||(t(3,k=!1),await un()),Z){t(25,Q=""),P==null||P.setText(""),t(27,Re=[]),t(17,pe=[]),t(18,de=[]),t(20,Y=!1),t(19,O=!1),t(21,le=!1);try{const Pe=JSON.parse(Z);s||(P==null||P.setText(Pe.prompt),t(27,Re=Pe.files),t(17,pe=Pe.selectedToolIds),t(18,de=Pe.selectedFilterIds),t(20,Y=Pe.webSearchEnabled),t(19,O=Pe.imageGenerationEnabled),t(21,le=Pe.codeInterpreterEnabled))}catch{}}Ki.subscribe(async Pe=>{if(S&&!x)try{Pe?R.openPane():S.collapse()}catch{}Pe||(Fa.set(!1),n0.set(!1),Jl.set(!1))});const Te=document.getElementById("chat-input");Te==null||Te.focus(),Xh.subscribe(()=>{})}),Gh(()=>{dt(),window.removeEventListener("message",ut),h==null||h.off("chat-events",Mt)});const Ve=async Z=>{var at,We,Ge,nt,et,vt;if(Z.id,Z.name,Z.url,`${token}`,!(Z!=null&&Z.id)||!(Z!=null&&Z.name)||!(Z!=null&&Z.url)||!((at=Z==null?void 0:Z.headers)!=null&&at.Authorization))throw new Error("Invalid file data provided");const Te=kl(),Pe={type:"file",file:"",id:null,url:Z.url,name:Z.name,collection_name:"",status:"uploading",error:"",itemId:Te,size:0};try{t(27,Re=[...Re,Pe]),Z.url;const En={headers:{Authorization:Z.headers.Authorization,Accept:"*/*"},method:"GET"},vn=await fetch(Z.url,En);if(!vn.ok){const Co=await vn.text();throw new Error(`Failed to fetch file (${vn.status}): ${Co}`)}const cn=vn.headers.get("content-type")||"application/octet-stream",jn=await vn.blob();if(jn.size===0)throw new Error("Retrieved file is empty");jn.size,jn.type;const Ci=new File([jn],Z.name,{type:jn.type||cn});if(Ci.name,Ci.size,Ci.type,Ci.size===0)throw new Error("Created file is empty");let gr=null;(Ci.type.startsWith("audio/")||Ci.type.startsWith("video/"))&&((Ge=(We=o==null?void 0:o.audio)==null?void 0:We.stt)!=null&&Ge.language)&&(gr={language:(et=(nt=o==null?void 0:o.audio)==null?void 0:nt.stt)==null?void 0:et.language});const os=await uploadFile(localStorage.token,Ci,gr);if(!os)throw new Error("Server returned null response for file upload");Pe.status="uploaded",Pe.file=os,Pe.id=os.id,Pe.size=Ci.size,Pe.collection_name=(vt=os==null?void 0:os.meta)==null?void 0:vt.collection_name,Pe.url=`${WEBUI_API_BASE_URL}/files/${os.id}`,t(27,Re),on.success(l.t("File uploaded successfully"))}catch(En){console.error("Error uploading file:",En),t(27,Re=Re.filter(vn=>vn.itemId!==Te)),on.error(l.t("Error uploading file: {{error}}",{error:En.message||"Unknown error"}))}},Ot=async Z=>{const Te={type:"doc",name:Z,collection_name:"",status:"uploading",url:Z,error:""};try{t(27,Re=[...Re,Te]);const Pe=await FD(localStorage.token,"",Z);Pe&&(Te.status="uploaded",Te.collection_name=Pe.collection_name,Te.file={...Pe.file,...Te.file},t(27,Re))}catch(Pe){t(27,Re=Re.filter(at=>at.name!==Z)),on.error(JSON.stringify(Pe))}},rn=async Z=>{const Te={type:"doc",name:Z,collection_name:"",status:"uploading",context:"full",url:Z,error:""};try{t(27,Re=[...Re,Te]);const Pe=await BD(localStorage.token,Z);Pe&&(Te.status="uploaded",Te.collection_name=Pe.collection_name,Te.file={...Pe.file,...Te.file},t(27,Re))}catch(Pe){t(27,Re=Re.filter(at=>at.name!==Z)),on.error(`${Pe}`)}},Me=async()=>{var at,We,Ge,nt,et;(u==null?void 0:u.role)!=="admin"&&((We=(at=u==null?void 0:u.permissions)==null?void 0:at.chat)!=null&&We.temporary_enforced)&&await Od.set(!0);const Z=c.filter(vt=>{var En,vn;return!(((vn=(En=vt==null?void 0:vt.info)==null?void 0:En.meta)==null?void 0:vn.hidden)??!1)}).map(vt=>vt.id);if(m.url.searchParams.get("models")||m.url.searchParams.get("model")){const vt=(Ge=m.url.searchParams.get("models")||m.url.searchParams.get("model")||"")==null?void 0:Ge.split(",");if(vt.length===1)if(c.find(vn=>vn.id===vt[0]))t(0,ae=vt);else{const vn=document.getElementById("model-selector-0-button");if(vn){vn.click(),await un();const cn=document.getElementById("model-search-input");cn&&(cn.focus(),cn.value=vt[0],cn.dispatchEvent(new Event("input")))}}else t(0,ae=vt);t(0,ae=ae.filter(En=>c.map(vn=>vn.id).includes(En)))}else sessionStorage.selectedModels?(t(0,ae=JSON.parse(sessionStorage.selectedModels)),sessionStorage.removeItem("selectedModels")):o!=null&&o.models?t(0,ae=o==null?void 0:o.models):d!=null&&d.default_models&&(d==null||d.default_models.split(","),t(0,ae=d==null?void 0:d.default_models.split(","))),t(0,ae=ae.filter(vt=>Z.includes(vt)));if((ae.length===0||ae.length===1&&ae[0]==="")&&(Z.length>0?t(0,ae=[(Z==null?void 0:Z.at(0))??""]):t(0,ae=[""])),await Ki.set(!1),await Fa.set(!1),await n0.set(!1),await Jl.set(!1),m.url.pathname.includes("/c/")&&window.history.replaceState(oe.state,"","/"),t(7,D=!0),Ye(),await cu.set(""),await Sx.set(""),t(23,oe={messages:{},currentId:null}),t(26,je=[]),t(28,Ne={}),m.url.searchParams.get("youtube")&&rn(`https://www.youtube.com/watch?v=${m.url.searchParams.get("youtube")}`),m.url.searchParams.get("load-url")&&await Ot(m.url.searchParams.get("load-url")),m.url.searchParams.get("web-search")==="true"&&t(20,Y=!0),m.url.searchParams.get("image-generation")==="true"&&t(19,O=!0),m.url.searchParams.get("code-interpreter")==="true"&&t(21,le=!0),m.url.searchParams.get("tools")?t(17,pe=(nt=m.url.searchParams.get("tools"))==null?void 0:nt.split(",").map(vt=>vt.trim()).filter(vt=>vt)):m.url.searchParams.get("tool-ids")&&t(17,pe=(et=m.url.searchParams.get("tool-ids"))==null?void 0:et.split(",").map(vt=>vt.trim()).filter(vt=>vt)),m.url.searchParams.get("call")==="true"&&(Fa.set(!0),Ki.set(!0)),m.url.searchParams.get("q")){const vt=m.url.searchParams.get("q")??"";P==null||P.setText(vt),vt&&(m.url.searchParams.get("submit")??"true")==="true"&&(await un(),hi(vt))}t(0,ae=ae.map(vt=>c.map(En=>En.id).includes(vt)?vt:""));const Te=await c_(localStorage.token);Te?ja.set(Te.ui):ja.set(JSON.parse(localStorage.getItem("settings")??"{}"));const Pe=document.getElementById("chat-input");setTimeout(()=>Pe==null?void 0:Pe.focus(),0)},Dt=async()=>{var Z,Te;if(cu.set(C),s&&Od.set(!1),re=await Qw(localStorage.token,r).catch(async Pe=>(await i_("/"),null)),re){await DD(localStorage.token,r).catch(async at=>[]);const Pe=re.chat;if(Pe){t(0,ae=((Pe==null?void 0:Pe.models)??void 0)!==void 0?Pe.models:[Pe.models??""]),(u==null?void 0:u.role)==="admin"||(((Te=(Z=u==null?void 0:u.permissions)==null?void 0:Z.chat)==null?void 0:Te.multiple_models)??!0)||t(0,ae=ae.length>0?[ae[0]]:[""]),t(56,ht=ae),t(23,oe=((Pe==null?void 0:Pe.history)??void 0)!==void 0?Pe.history:PD(Pe.messages)),Sx.set(Pe.title);const at=await c_(localStorage.token);if(at?await ja.set(at.ui):await ja.set(JSON.parse(localStorage.getItem("settings")??"{}")),t(28,Ne=(Pe==null?void 0:Pe.params)??{}),t(26,je=(Pe==null?void 0:Pe.files)??[]),t(7,D=!0),await un(),oe.currentId)for(const Ge of Object.values(oe.messages))Ge.role==="assistant"&&(Ge.done=!0);const We=await zD(localStorage.token,r).catch(Ge=>null);return We&&t(24,ee=We.task_ids),await un(),!0}else return null}},gt=async(Z="auto")=>{await un(),U&&U.scrollTo({top:U.scrollHeight,behavior:Z})},jt=async(Z,Te,Pe,at)=>{const We=await qD(localStorage.token,{model:Te,messages:at.map(Ge=>({id:Ge.id,role:Ge.role,content:Ge.content,info:Ge.info?Ge.info:void 0,timestamp:Ge.timestamp,...Ge.usage?{usage:Ge.usage}:{},...Ge.sources?{sources:Ge.sources}:{}})),filter_ids:de.length>0?de:void 0,model_item:c.find(Ge=>Ge.id===Te),chat_id:Z,session_id:h==null?void 0:h.id,id:Pe}).catch(Ge=>(on.error(`${Ge}`),at.at(-1).error={content:Ge},null));if(We!==null&&We.messages)for(const Ge of We.messages)Ge!=null&&Ge.id&&t(23,oe.messages[Ge.id]={...oe.messages[Ge.id],...oe.messages[Ge.id].content!==Ge.content?{originalContent:oe.messages[Ge.id].content}:{},...Ge},oe);await un(),r==Z&&(s||(re=await ew(localStorage.token,Z,{models:ae,messages:at,history:oe,params:Ne,files:je}),Kh.set(1),await Xh.set(await cf(localStorage.token,i)))),t(24,ee=null)},Fn=async(Z,Te,Pe,at,We=null)=>{const Ge=Oa(oe,at),nt=await jD(localStorage.token,Te,{model:Pe,messages:Ge.map(et=>({id:et.id,role:et.role,content:et.content,info:et.info?et.info:void 0,timestamp:et.timestamp,...et.sources?{sources:et.sources}:{}})),...We?{event:We}:{},model_item:c.find(et=>et.id===Pe),chat_id:Z,session_id:h==null?void 0:h.id,id:at}).catch(et=>(on.error(`${et}`),Ge.at(-1).error={content:et},null));if(nt!==null&&nt.messages)for(const et of nt.messages)t(23,oe.messages[et.id]={...oe.messages[et.id],...oe.messages[et.id].content!==et.content?{originalContent:oe.messages[et.id].content}:{},...et},oe);r==Z&&(s||(re=await ew(localStorage.token,Z,{models:ae,messages:Ge,history:oe,params:Ne,files:je}),Kh.set(1),await Xh.set(await cf(localStorage.token,i))))},Kn=async(Z,Te="")=>setInterval(()=>{h==null||h.emit("usage",{action:"chat",model:Z,chat_id:Te})},1e3),ci=async Z=>{if(P==null||P.setText(""),ae.length===0)on.error(l.t("Model not selected"));else{const Te=ae[0],Pe=c.filter(En=>En.id===Te).at(0),at=Oa(oe,oe.currentId),We=at.length!==0?at.at(-1):null,Ge=kl(),nt=kl(),et={id:Ge,parentId:We?We.id:null,childrenIds:[nt],role:"user",content:Z||`[PROMPT] ${Ge}`,timestamp:Math.floor(Date.now()/1e3)},vt={id:nt,parentId:Ge,childrenIds:[],role:"assistant",content:`[RESPONSE] ${nt}`,done:!0,model:Te,modelName:Pe.name??Pe.id,modelIdx:0,timestamp:Math.floor(Date.now()/1e3)};We&&(We.childrenIds.push(Ge),t(23,oe.messages[We.id]=We,oe)),t(23,oe.messages[Ge]=et,oe),t(23,oe.messages[nt]=vt,oe),t(23,oe.currentId=nt,oe),await un(),D&&gt(),at.length===0?await ft(oe):await Vt(r,oe)}},ji=async({modelId:Z,parentId:Te,messages:Pe})=>{const at=c.filter(nt=>nt.id===Z).at(0);let We=oe.messages[Te],Ge=We?We.id:null;for(const nt of Pe){let et=kl();if(nt.role==="user"){const vt={id:et,parentId:Ge,childrenIds:[],timestamp:Math.floor(Date.now()/1e3),...nt};We&&(We.childrenIds.push(et),t(23,oe.messages[We.id]=We,oe)),t(23,oe.messages[et]=vt,oe),We=vt,Ge=et}else{const vt={id:et,parentId:Ge,childrenIds:[],done:!0,model:at.id,modelName:at.name??at.id,modelIdx:0,timestamp:Math.floor(Date.now()/1e3),...nt};We&&(We.childrenIds.push(et),t(23,oe.messages[We.id]=We,oe)),t(23,oe.messages[et]=vt,oe),We=vt,Ge=et}}t(23,oe.currentId=Ge,oe),await un(),D&&gt(),Pe.length===0?await ft(oe):await Vt(r,oe)},xs=async(Z,Te,Pe)=>{var cn,jn,Ci,gr,os,Co,fl,Ao,qh,v0,Wh,fm,gm,mm;const{id:at,done:We,choices:Ge,content:nt,sources:et,selected_model_id:vt,error:En,usage:vn}=Z;if(En&&await ki(En,Te),et&&(Te.sources=et),Ge)if((jn=(cn=Ge[0])==null?void 0:cn.message)!=null&&jn.content)Te.content+=(gr=(Ci=Ge[0])==null?void 0:Ci.message)==null?void 0:gr.content;else{let Xs=((Co=(os=Ge[0])==null?void 0:os.delta)==null?void 0:Co.content)??"";if(!(Te.content==""&&Xs==`
`)){Te.content+=Xs,navigator.vibrate&&((o==null?void 0:o.hapticFeedback)??!1)&&navigator.vibrate(5);const So=Qy($y(Te.content),((Ao=(fl=d==null?void 0:d.audio)==null?void 0:fl.tts)==null?void 0:Ao.split_on)??"punctuation");So.pop(),So.length>0&&So[So.length-1]!==Te.lastSentence&&(Te.lastSentence=So[So.length-1],I.dispatchEvent(new CustomEvent("chat",{detail:{id:Te.id,content:So[So.length-1]}})))}}if(nt){Te.content=nt,navigator.vibrate&&((o==null?void 0:o.hapticFeedback)??!1)&&navigator.vibrate(5);const Xs=Qy($y(Te.content),((v0=(qh=d==null?void 0:d.audio)==null?void 0:qh.tts)==null?void 0:v0.split_on)??"punctuation");Xs.pop(),Xs.length>0&&Xs[Xs.length-1]!==Te.lastSentence&&(Te.lastSentence=Xs[Xs.length-1],I.dispatchEvent(new CustomEvent("chat",{detail:{id:Te.id,content:Xs[Xs.length-1]}})))}if(vt&&(Te.selectedModelId=vt,Te.arena=!0),vn&&(Te.usage=vn),t(23,oe.messages[Te.id]=Te,oe),We){Te.done=!0,o.responseAutoCopy&&J6(Te.content),o.responseAutoPlayback&&!g&&(await un(),(Wh=document.getElementById(`speak-button-${Te.id}`))==null||Wh.click());let Xs=((mm=Qy($y(Te.content),((gm=(fm=d==null?void 0:d.audio)==null?void 0:fm.tts)==null?void 0:gm.split_on)??"punctuation"))==null?void 0:mm.at(-1))??"";Xs&&I.dispatchEvent(new CustomEvent("chat",{detail:{id:Te.id,content:Xs}})),I.dispatchEvent(new CustomEvent("chat:finish",{detail:{id:Te.id,content:Te.content}})),t(23,oe.messages[Te.id]=Te,oe),await jt(Pe,Te.model,Te.id,Oa(oe,Te.id))}D&&gt()},hi=async(Z,{_raw:Te=!1}={})=>{var vt,En,vn;const Pe=Oa(oe,oe.currentId),at=ae.map(cn=>c.map(jn=>jn.id).includes(cn)?cn:"");if(JSON.stringify(ae)!==JSON.stringify(at)&&t(0,ae=at),Z===""&&Re.length===0){on.error(l.t("Please enter a prompt"));return}if(ae.includes("")){on.error(l.t("Model not selected"));return}if(Pe.length!=0&&Pe.at(-1).done!=!0)return;if(Pe.length!=0&&Pe.at(-1).error&&!Pe.at(-1).content){on.error(l.t("Oops! There was an error in the previous response."));return}if(Re.length>0&&Re.filter(cn=>cn.type!=="image"&&cn.status==="uploading").length>0){on.error(l.t("Oops! There are files still uploading. Please wait for the upload to complete."));return}if((((vt=d==null?void 0:d.file)==null?void 0:vt.max_count)??null)!==null&&Re.length+je.length>((En=d==null?void 0:d.file)==null?void 0:En.max_count)){on.error(l.t("You can only chat with a maximum of {{maxCount}} file(s) at a time.",{maxCount:(vn=d==null?void 0:d.file)==null?void 0:vn.max_count}));return}if(P==null||P.setText(""),!((o==null?void 0:o.richTextInput)??!0)){const cn=document.getElementById("chat-input");cn&&(await un(),cn.style.height="")}const We=JSON.parse(JSON.stringify(Re));je.push(...We.filter(cn=>["doc","file","collection"].includes(cn.type))),t(26,je=je.filter((cn,jn,Ci)=>Ci.findIndex(gr=>JSON.stringify(gr)===JSON.stringify(cn))===jn)),t(27,Re=[]),P==null||P.setText("");let Ge=kl(),nt={id:Ge,parentId:Pe.length!==0?Pe.at(-1).id:null,childrenIds:[],role:"user",content:Z,files:We.length>0?We:void 0,timestamp:Math.floor(Date.now()/1e3),models:ae};t(23,oe.messages[Ge]=nt,oe),t(23,oe.currentId=Ge,oe),Pe.length!==0&&oe.messages[Pe.at(-1).id].childrenIds.push(Ge);const et=document.getElementById("chat-input");et==null||et.focus(),Je(),await qi(oe,Z,Ge,{newChat:!0})},qi=async(Z,Te,Pe,{modelId:at=null,modelIdx:We=null,newChat:Ge=!1}={})=>{D&&gt();let nt=JSON.parse(JSON.stringify(r));Z=JSON.parse(JSON.stringify(Z));const et={};let vt=at?[at]:ge!==void 0?[ge.id]:ae;for(const[En,vn]of vt.entries()){const cn=c.filter(jn=>jn.id===vn).at(0);if(cn){let jn=kl(),Ci={parentId:Pe,id:jn,childrenIds:[],role:"assistant",content:"",model:cn.id,modelName:cn.name??cn.id,modelIdx:We||En,timestamp:Math.floor(Date.now()/1e3)};t(23,oe.messages[jn]=Ci,oe),t(23,oe.currentId=jn,oe),Pe!==null&&oe.messages[Pe]&&t(23,oe.messages[Pe].childrenIds=[...oe.messages[Pe].childrenIds,jn],oe),et[`${vn}-${We||En}`]=jn}}t(23,oe),Ge&&Z.messages[Z.currentId].parentId===null&&(nt=await ft(Z)),await un(),Z=JSON.parse(JSON.stringify(oe)),await Vt(nt,Z),await Promise.all(vt.map(async(En,vn)=>{var jn,Ci,gr;const cn=c.filter(os=>os.id===En).at(0);if(cn){Oa(Z,Pe).some(qh=>{var v0;return(v0=qh.files)==null?void 0:v0.some(Wh=>Wh.type==="image")})&&!(((gr=(Ci=(jn=cn.info)==null?void 0:jn.meta)==null?void 0:Ci.capabilities)==null?void 0:gr.vision)??!0)&&on.error(l.t("Model {{modelName}} is not vision capable",{modelName:cn.name??cn.id}));let fl=et[`${En}-${We||vn}`];const Ao=await Kn(cn.id,nt);gt(),await ys(Z,cn,fl),Ao&&clearInterval(Ao)}else on.error(l.t("Model {{modelId}} not found",{modelId:En}))})),Kh.set(1),Xh.set(await cf(localStorage.token,i))},ys=async(Z,Te,Pe,at)=>{var jn,Ci,gr,os,Co,fl,Ao,qh,v0,Wh,fm,gm,mm,Xs,So,Wv,Kv,Xv,Yv;const We=Oa(oe,oe.currentId),Ge=Z.messages[Pe],nt=Z.messages[Ge.parentId],et=We.filter(fn=>fn.files).flatMap(fn=>fn.files);t(26,je=je.filter(fn=>et.some(kx=>kx.id===fn.id)));let vt=JSON.parse(JSON.stringify(je));vt.push(...((nt==null?void 0:nt.files)??[]).filter(fn=>["doc","text","file","note","collection"].includes(fn.type))),vt=vt.filter((fn,lf,kx)=>kx.findIndex(Cx=>JSON.stringify(Cx)===JSON.stringify(fn))===lf),gt(),I.dispatchEvent(new CustomEvent("chat:start",{detail:{id:Pe}})),await un();const En=((Ci=(jn=Te==null?void 0:Te.info)==null?void 0:jn.params)==null?void 0:Ci.stream_response)??((gr=o==null?void 0:o.params)==null?void 0:gr.stream_response)??(Ne==null?void 0:Ne.stream_response)??!0;let vn=[Ne!=null&&Ne.system||o.system?{role:"system",content:`${TD((Ne==null?void 0:Ne.system)??(o==null?void 0:o.system)??"",u==null?void 0:u.name,o!=null&&o.userLocation?await h_(localStorage.token).catch(fn=>{console.error(fn)}):void 0)}`}:void 0,...Oa(Z,Pe).map(fn=>({...fn,content:RD(fn.content)}))].filter(fn=>fn);vn=vn.map((fn,lf,kx)=>{var Cx,Jv,Zv;return{role:fn.role,...((Cx=fn.files)==null?void 0:Cx.filter(pm=>pm.type==="image").length)>0&&fn.role==="user"?{content:[{type:"text",text:((Jv=fn==null?void 0:fn.merged)==null?void 0:Jv.content)??fn.content},...fn.files.filter(pm=>pm.type==="image").map(pm=>({type:"image_url",image_url:{url:pm.url}}))]}:{content:((Zv=fn==null?void 0:fn.merged)==null?void 0:Zv.content)??fn.content}}}).filter(fn=>{var lf;return(fn==null?void 0:fn.role)==="user"||((lf=fn==null?void 0:fn.content)==null?void 0:lf.trim())});const cn=await LD(localStorage.token,{stream:En,model:Te.id,messages:vn,params:{...o==null?void 0:o.params,...Ne,stop:(Ne==null?void 0:Ne.stop)??((os=o==null?void 0:o.params)==null?void 0:os.stop)??void 0?((Ne==null?void 0:Ne.stop.split(",").map(fn=>fn.trim()))??o.params.stop).map(fn=>decodeURIComponent(JSON.parse('"'+fn.replace(/\"/g,'\\"')+'"'))):void 0},files:((vt==null?void 0:vt.length)??0)>0?vt:void 0,filter_ids:de.length>0?de:void 0,tool_ids:pe.length>0?pe:void 0,tool_servers:f,features:{image_generation:(Co=d==null?void 0:d.features)!=null&&Co.enable_image_generation&&((u==null?void 0:u.role)==="admin"||(Ao=(fl=u==null?void 0:u.permissions)==null?void 0:fl.features)!=null&&Ao.image_generation)?O:!1,code_interpreter:(qh=d==null?void 0:d.features)!=null&&qh.enable_code_interpreter&&((u==null?void 0:u.role)==="admin"||(Wh=(v0=u==null?void 0:u.permissions)==null?void 0:v0.features)!=null&&Wh.code_interpreter)?le:!1,web_search:(fm=d==null?void 0:d.features)!=null&&fm.enable_web_search&&((u==null?void 0:u.role)==="admin"||(mm=(gm=u==null?void 0:u.permissions)==null?void 0:gm.features)!=null&&mm.web_search)?Y||((o==null?void 0:o.webSearch)??!1)==="always":!1,memory:(o==null?void 0:o.memory)??!1},variables:{...MD(u==null?void 0:u.name,o!=null&&o.userLocation?await h_(localStorage.token).catch(fn=>{console.error(fn)}):void 0)},model_item:c.find(fn=>fn.id===Te.id),session_id:h==null?void 0:h.id,chat_id:r,id:Pe,background_tasks:{...!s&&(vn.length==1||vn.length==2&&((Xs=vn.at(0))==null?void 0:Xs.role)==="system"&&((So=vn.at(1))==null?void 0:So.role)==="user")&&(ae[0]===Te.id||ge!==void 0)?{title_generation:((Wv=o==null?void 0:o.title)==null?void 0:Wv.auto)??!0,tags_generation:(o==null?void 0:o.autoTags)??!0}:{},follow_up_generation:(o==null?void 0:o.autoFollowUps)??!0},...En&&(((Yv=(Xv=(Kv=Te.info)==null?void 0:Kv.meta)==null?void 0:Xv.capabilities)==null?void 0:Yv.usage)??!1)?{stream_options:{include_usage:!0}}:{}},`${Yo}/api`).catch(async fn=>(on.error(`${fn}`),Ge.error={content:fn},Ge.done=!0,t(23,oe.messages[Pe]=Ge,oe),t(23,oe.currentId=Pe,oe),null));cn&&(cn.error?await ki(cn.error,Ge):ee?ee.push(cn.task_id):t(24,ee=[cn.task_id])),await un(),gt()},ki=async(Z,Te)=>{let Pe="",at;Z&&(at=Z),console.error(at),"detail"in at?(on.error(at.detail),Pe=at.detail):"error"in at?"message"in at.error?(on.error(at.error.message),Pe=at.error.message):(on.error(at.error),Pe=at.error):"message"in at&&(on.error(at.message),Pe=at.message),Te.error={content:l.t("Uh-oh! There was an issue with the response.")+`
`+Pe},Te.done=!0,Te.statusHistory&&(Te.statusHistory=Te.statusHistory.filter(We=>We.action!=="knowledge_search")),t(23,oe.messages[Te.id]=Te,oe)},Tr=async()=>{if(ee){for(const Te of ee)await GD(localStorage.token,Te).catch(Pe=>(on.error(`${Pe}`),null));t(24,ee=null);const Z=oe.messages[oe.currentId];for(const Te of oe.messages[Z.parentId].childrenIds)t(23,oe.messages[Te].done=!0,oe);t(23,oe.messages[oe.currentId]=Z,oe),D&&gt()}},Ks=async(Z,Te)=>{let Pe=Te,at=kl(),We={id:at,parentId:Z,childrenIds:[],role:"user",content:Pe,models:ae,timestamp:Math.floor(Date.now()/1e3)};Z!==null&&t(23,oe.messages[Z].childrenIds=[...oe.messages[Z].childrenIds,at],oe),t(23,oe.messages[at]=We,oe),t(23,oe.currentId=at,oe),await un(),D&&gt(),await qi(oe,Pe,at)},Ss=async Z=>{if(oe.currentId){let Te=oe.messages[Z.parentId],Pe=Te.content;D&&gt(),((Te==null?void 0:Te.models)??[...ae]).length==1?await qi(oe,Pe,Te.id):await qi(oe,Pe,Te.id,{modelId:Z.model,modelIdx:Z.modelIdx})}},De=async()=>{if(JSON.parse(JSON.stringify(r)),oe.currentId&&oe.messages[oe.currentId].done==!0){const Z=oe.messages[oe.currentId];Z.done=!1,await un();const Te=c.filter(Pe=>Pe.id===((Z==null?void 0:Z.selectedModelId)??Z.model)).at(0);Te&&await ys(oe,Te,Z.id)}},qe=async(Z,Te,Pe)=>{const at=oe.messages[Z],We={status:!0,content:""};at.merged=We,t(23,oe.messages[Z]=at,oe);try{const[Ge,nt]=await VD(localStorage.token,at.model,oe.messages[at.parentId].content,Te);if(Ge&&Ge.ok&&Ge.body){const et=await JL(Ge.body,o.splitLargeChunks);for await(const vt of et){const{value:En,done:vn,sources:cn,error:jn,usage:Ci}=vt;if(jn||vn)break;We.content==""&&En==`
`||(We.content+=En,t(23,oe.messages[Z]=at,oe),D&&gt())}await Vt(Pe,oe)}else console.error(Ge)}catch(Ge){console.error(Ge)}},ft=async Z=>{let Te=r;return s?(Te="local",await cu.set("local")):(re=await ND(localStorage.token,{id:Te,title:l.t("New Chat"),models:ae,system:o.system??void 0,params:Ne,history:Z,messages:Oa(Z,Z.currentId),tags:[],timestamp:Date.now()},a==null?void 0:a.id),Te=re.id,await cu.set(Te),window.history.replaceState(Z.state,"",`/c/${Te}`),await un(),await Xh.set(await cf(localStorage.token,i)),Kh.set(1),u3.set(null)),await un(),Te},Vt=async(Z,Te)=>{r==Z&&(s||(re=await ew(localStorage.token,Z,{models:ae,history:Te,messages:Oa(Te,Te.currentId),params:Ne,files:je}),Kh.set(1),await Xh.set(await cf(localStorage.token,i))))};function sn(Z){G=Z,t(10,G)}const Bn=Z=>{Z.detail?j(Z.detail):j(!0)},Cn=()=>{j(!1)};function Un(Z){Et[Z?"unshift":"push"](()=>{T=Z,t(9,T)})}function zn(Z){ae=Z,t(0,ae)}function dl(Z){oe=Z,t(23,oe)}function fr(Z){D=Z,t(7,D)}function Qg(Z){Q=Z,t(25,Q)}function $g(Z){Et[Z?"unshift":"push"](()=>{U=Z,t(8,U)})}const em=Z=>{t(7,D=U.scrollHeight-U.scrollTop<=U.clientHeight+5)},tm=Z=>{s||(Z.prompt!==null?sessionStorage.setItem(`chat-input${r?`-${r}`:""}`,JSON.stringify(Z)):sessionStorage.removeItem(`chat-input${r?`-${r}`:""}`))};function nm(Z){Et[Z?"unshift":"push"](()=>{P=Z,t(6,P)})}function im(Z){Re=Z,t(27,Re)}function sm(Z){Q=Z,t(25,Q)}function rm(Z){D=Z,t(7,D)}function am(Z){pe=Z,t(17,pe)}function om(Z){de=Z,t(18,de)}function lm(Z){O=Z,t(19,O)}function cm(Z){le=Z,t(21,le)}function hm(Z){Y=Z,t(20,Y)}function um(Z){ge=Z,t(1,ge)}function dm(Z){$=Z,t(22,$)}const ke=async Z=>{const{type:Te,data:Pe}=Z.detail;Te==="web"?await Ot(Pe):Te==="youtube"?await rn(Pe):Te==="google-drive"&&await Ve(Pe)},Oy=async Z=>{(Z.detail||Re.length>0)&&(await un(),hi((o==null?void 0:o.richTextInput)??!0?Z.detail.replaceAll(`

`,`
`):Z.detail))};function Dy(Z){P=Z,t(6,P)}function Ly(Z){Re=Z,t(27,Re)}function Fy(Z){Q=Z,t(25,Q)}function By(Z){D=Z,t(7,D)}function Uy(Z){pe=Z,t(17,pe)}function Hy(Z){de=Z,t(18,de)}function zy(Z){O=Z,t(19,O)}function jy(Z){le=Z,t(21,le)}function Gy(Z){Y=Z,t(20,Y)}function Vy(Z){ge=Z,t(1,ge)}function qy(Z){$=Z,t(22,$)}const Wy=async Z=>{const{type:Te,data:Pe}=Z.detail;Te==="web"?await Ot(Pe):Te==="youtube"&&await rn(Pe)},Ky=async Z=>{(Z.detail||Re.length>0)&&(await un(),hi((o==null?void 0:o.richTextInput)??!0?Z.detail.replaceAll(`

`,`
`):Z.detail))},Xy=(Z,Te,Pe,at)=>{const We=c.find(Ge=>Ge.id===Te);return We?[...Z,We]:Z};function J(Z){Et[Z?"unshift":"push"](()=>{R=Z,t(5,R)})}function Xe(Z){oe=Z,t(23,oe)}function kt(Z){je=Z,t(26,je)}function _t(Z){Ne=Z,t(28,Ne)}function tt(Z){Re=Z,t(27,Re)}function Rt(Z){S=Z,t(4,S)}return n.$$set=Z=>{"chatIdProp"in Z&&t(55,C=Z.chatIdProp)},n.$$.update=()=>{n.$$.dirty[0]&3&&t(2,ue=ge!==void 0?[ge.id]:ae),n.$$.dirty[1]&16777216&&C&&He(),n.$$.dirty[0]&1|n.$$.dirty[1]&16777216&&ae&&C!==""&&Je(),n.$$.dirty[0]&4|n.$$.dirty[1]&33554432&&JSON.stringify(ue)!==JSON.stringify(ht)&&ot()},[ae,ge,ue,k,S,R,P,D,U,T,G,M,F,X,z,K,j,pe,de,O,Y,le,$,oe,ee,Q,je,Re,Ne,s,r,o,c,f,y,w,v,_,I,Be,me,Ve,Ot,rn,Me,Fn,ci,ji,hi,qi,Tr,Ks,Ss,De,qe,C,ht,sn,Bn,Cn,Un,zn,dl,fr,Qg,$g,em,tm,nm,im,sm,rm,am,om,lm,cm,hm,um,dm,ke,Oy,Dy,Ly,Fy,By,Uy,Hy,zy,jy,Gy,Vy,qy,Wy,Ky,Xy,J,Xe,kt,_t,tt,Rt]}class jle extends Ht{constructor(e){super(),zt(this,e,Aoe,Coe,qt,{chatIdProp:55},null,[-1,-1,-1,-1,-1])}}export{jle as C};
//# sourceMappingURL=-TaAMeSV.js.map
