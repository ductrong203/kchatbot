var wr=Object.defineProperty;var yr=(n,e,t)=>e in n?wr(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var vt=(n,e,t)=>yr(n,typeof e!="symbol"?e+"":e,t);import{s as Te,k as j,e as y,t as U,o as H,c as I,a as k,b as W,d as m,f as d,i as E,g as b,B as ut,u as me,h as G,R as qe,F as Ye,j as Me,p as Fe,W as Vt,q as yt,y as He,A as Qe,r as Ir,v as Mr,w as Er,x as Nr,X as tt,l as he,n as Ee,D as ke,E as we,U as At,C as Ce,I as Dr,an as Vr,J as Et,_ as Lt,Y as Cr,Z as Sr}from"./CpYWeDpV.js";import{S as Pe,i as Ae,b as $,d as x,m as ee,t as v,a as M,e as te,f as Xe,g as se,c as ne,h as Nt}from"./A77IWoha.js";import{e as Ne,u as Ht,o as Kt,d as Tr}from"./BvZIxBJR.js";import{m as zt,d as gl,j as zn,a as bt,h as Br,F as _l,G as bl,H as Rr,J as Or,c as Un,T as pl,u as Ut,l as Zt,e as Ze,W as Pr,b as vl,C as kl,E as Ar}from"./CII-ifV1.js";import{t as Le}from"./DRUj32p2.js";import{h as Lr,u as jr,j as Hr}from"./CAwXrIow.js";import{a as Gt,D as wl,d as Wn,E as zr,w as kt,B as wt,l as qn,m as jt,v as yl}from"./CGXrK5Vj.js";import{d as it}from"./I1CDPYOB.js";import"./BFK-koEx.js";import{u as Il,c as Ur}from"./CzibIIeD.js";import{d as Wr}from"./p9RbhZKl.js";import{s as qr}from"./DVv-wuCi.js";import{i as Fr}from"./BP3B-TZn.js";import{P as Fn,N as Qt}from"./Cgx9ELzN.js";import{S as Xt}from"./B_1GIiRP.js";import{aG as Jn,aV as Jr,aL as Ct,aW as Gr,aq as Yt,aX as Kr}from"./_oz107bi.js";import{T as Be}from"./BP0ESyD0.js";import{T as Zr}from"./06vRkOT7.js";import{X as Wt}from"./tGJoZG05.js";import{C as Gn}from"./DgoEirCH.js";import{C as Kn}from"./CRM-trYC.js";import{S as Qr}from"./DMRz2RFC.js";import{S as Xr}from"./Des-ZCXq.js";import{C as Zn}from"./CPo0RP4Q.js";import{I as Yr}from"./D924FiQS.js";import{M as Qn}from"./CBRABhh8.js";import{S as $t}from"./8PHfpnp8.js";import{B as xt}from"./DNO91rMh.js";import{C as $r}from"./DLoz2Jl1.js";import{E as xr}from"./xcf8UyH7.js";import{c as Ml}from"./BpCxpEqW.js";import{F as el}from"./CQImYGIE.js";import{f as Dt}from"./Ce8fqCmC.js";import{L as ei}from"./DUKUEZdH.js";import{F as ti}from"./CU2r43ac.js";import{E as li}from"./vYXyNVrM.js";function si(n){return new Worker(""+new URL("../workers/kokoro.worker-C3fj7GC4.js",import.meta.url).href,{type:"module",name:n==null?void 0:n.name})}class ni{constructor(e="fp32"){vt(this,"worker",null);vt(this,"initialized",!1);vt(this,"dtype");vt(this,"requestQueue",[]);vt(this,"processing",!1);this.dtype=e}async init(){if(this.worker){console.warn("KokoroWorker is already initialized.");return}return this.worker=new si,this.worker.onmessage=e=>{const{status:t,error:l,audioUrl:s}=e.data;if(t==="init:complete")this.initialized=!0;else if(t==="init:error")console.error(l),this.initialized=!1;else if(t==="generate:complete"){const r=this.requestQueue.shift();r&&(r.resolve(s),this.processNextRequest())}else if(t==="generate:error"){const r=this.requestQueue.shift();r&&(r.reject(new Error(l)),this.processNextRequest())}},new Promise((e,t)=>{this.worker.postMessage({type:"init",payload:{dtype:this.dtype}});const l=s=>{s.data.status==="init:complete"?(this.worker.removeEventListener("message",l),this.initialized=!0,e()):s.data.status==="init:error"&&(this.worker.removeEventListener("message",l),t(new Error(s.data.error)))};this.worker.addEventListener("message",l)})}async generate({text:e,voice:t}){if(!this.initialized||!this.worker)throw new Error("KokoroTTS Worker is not initialized yet.");return new Promise((l,s)=>{this.requestQueue.push({text:e,voice:t,resolve:l,reject:s}),this.processing||this.processNextRequest()})}processNextRequest(){if(this.requestQueue.length===0){this.processing=!1;return}this.processing=!0;const{text:e,voice:t}=this.requestQueue[0];this.worker.postMessage({type:"generate",payload:{text:e,voice:t}})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1)}}function El(n,e,t){const l=n.slice();return l[23]=e[t],l}function Nl(n,e,t){const l=n.slice();return l[26]=e[t],l}function Dl(n){var s;let e,t=n[8].t('This response was generated by "{{model}}"',{model:n[7]?((s=n[7])==null?void 0:s.name)??n[7].id:n[1].selectedModelId})+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(r){e=I(r,"DIV",{class:!0});var i=k(e);l=W(i,t),i.forEach(m),this.h()},h(){d(e,"class","text-xs font-medium pt-1.5 -mb-0.5")},m(r,i){E(r,e,i),b(e,l)},p(r,i){var o;i&386&&t!==(t=r[8].t('This response was generated by "{{model}}"',{model:r[7]?((o=r[7])==null?void 0:o.name)??r[7].id:r[1].selectedModelId})+"")&&G(l,t)},d(r){r&&m(e)}}}function Vl(n){let e,t=n[26]+"",l,s,r,i,o,a;function f(){return n[12](n[26])}return{c(){e=y("button"),l=U(t),s=j(),this.h()},l(u){e=I(u,"BUTTON",{class:!0});var c=k(e);l=W(c,t),s=H(c),c.forEach(m),this.h()},h(){var u,c;d(e,"class",r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900"),e.disabled=i=((c=(u=n[1])==null?void 0:u.annotation)==null?void 0:c.rating)===-1?n[26]>5:n[26]<6},m(u,c){E(u,e,c),b(e,l),b(e,s),o||(a=me(e,"click",f),o=!0)},p(u,c){var g,h;n=u,c&64&&r!==(r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900")&&d(e,"class",r),c&2&&i!==(i=((h=(g=n[1])==null?void 0:g.annotation)==null?void 0:h.rating)===-1?n[26]>5:n[26]<6)&&(e.disabled=i)},d(u){u&&m(e),o=!1,a()}}}function Cl(n){let e,t=n[8].t("Why?")+"",l,s,r,i=Ne(n[3]),o=[];for(let a=0;a<i.length;a+=1)o[a]=Sl(El(n,i,a));return{c(){e=y("div"),l=U(t),s=j(),r=y("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=I(a,"DIV",{class:!0});var f=k(e);l=W(f,t),f.forEach(m),s=H(a),r=I(a,"DIV",{class:!0});var u=k(r);for(let c=0;c<o.length;c+=1)o[c].l(u);u.forEach(m),this.h()},h(){d(e,"class","text-sm mt-1.5 font-medium"),d(r,"class","flex flex-wrap gap-1.5 text-sm mt-1.5")},m(a,f){E(a,e,f),b(e,l),E(a,s,f),E(a,r,f);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(r,null)},p(a,f){if(f&256&&t!==(t=a[8].t("Why?")+"")&&G(l,t),f&280){i=Ne(a[3]);let u;for(u=0;u<i.length;u+=1){const c=El(a,i,u);o[u]?o[u].p(c,f):(o[u]=Sl(c),o[u].c(),o[u].m(r,null))}for(;u<o.length;u+=1)o[u].d(1);o.length=i.length}},d(a){a&&(m(e),m(s),m(r)),qe(o,a)}}}function ri(n){let e=n[23]+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&8&&e!==(e=l[23]+"")&&G(t,e)},d(l){l&&m(t)}}}function ii(n){let e=n[8].t("Other")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Other")+"")&&G(t,e)},d(l){l&&m(t)}}}function ai(n){let e=n[8].t("Being lazy")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Being lazy")+"")&&G(t,e)},d(l){l&&m(t)}}}function oi(n){let e=n[8].t("Refused when it shouldn't have")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Refused when it shouldn't have")+"")&&G(t,e)},d(l){l&&m(t)}}}function fi(n){let e=n[8].t("Didn't fully follow instructions")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Didn't fully follow instructions")+"")&&G(t,e)},d(l){l&&m(t)}}}function ui(n){let e=n[8].t("Not factually correct")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not factually correct")+"")&&G(t,e)},d(l){l&&m(t)}}}function ci(n){let e=n[8].t("Not helpful")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not helpful")+"")&&G(t,e)},d(l){l&&m(t)}}}function di(n){let e=n[8].t("Too verbose")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Too verbose")+"")&&G(t,e)},d(l){l&&m(t)}}}function hi(n){let e=n[8].t("Don't like the style")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Don't like the style")+"")&&G(t,e)},d(l){l&&m(t)}}}function mi(n){let e=n[8].t("Thorough explanation")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Thorough explanation")+"")&&G(t,e)},d(l){l&&m(t)}}}function gi(n){let e=n[8].t("Attention to detail")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Attention to detail")+"")&&G(t,e)},d(l){l&&m(t)}}}function _i(n){let e=n[8].t("Positive attitude")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Positive attitude")+"")&&G(t,e)},d(l){l&&m(t)}}}function bi(n){let e=n[8].t("Showcased creativity")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Showcased creativity")+"")&&G(t,e)},d(l){l&&m(t)}}}function pi(n){let e=n[8].t("Followed instructions perfectly")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Followed instructions perfectly")+"")&&G(t,e)},d(l){l&&m(t)}}}function vi(n){let e=n[8].t("Accurate information")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Accurate information")+"")&&G(t,e)},d(l){l&&m(t)}}}function Sl(n){let e,t,l,s,r;function i(u,c){return u[23]==="accurate_information"?vi:u[23]==="followed_instructions_perfectly"?pi:u[23]==="showcased_creativity"?bi:u[23]==="positive_attitude"?_i:u[23]==="attention_to_detail"?gi:u[23]==="thorough_explanation"?mi:u[23]==="dont_like_the_style"?hi:u[23]==="too_verbose"?di:u[23]==="not_helpful"?ci:u[23]==="not_factually_correct"?ui:u[23]==="didnt_fully_follow_instructions"?fi:u[23]==="refused_when_it_shouldnt_have"?oi:u[23]==="being_lazy"?ai:u[23]==="other"?ii:ri}let o=i(n),a=o(n);function f(){return n[13](n[23])}return{c(){e=y("button"),a.c(),t=j(),this.h()},l(u){e=I(u,"BUTTON",{class:!0});var c=k(e);a.l(c),t=H(c),c.forEach(m),this.h()},h(){d(e,"class",l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")},m(u,c){E(u,e,c),a.m(e,null),b(e,t),s||(r=me(e,"click",f),s=!0)},p(u,c){n=u,o===(o=i(n))&&a?a.p(n,c):(a.d(1),a=o(n),a&&(a.c(),a.m(e,t))),c&24&&l!==(l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")&&d(e,"class",l)},d(u){u&&m(e),a.d(),s=!1,r()}}}function ki(n){var Z;let e,t,l,s,r=n[8].t("How would you rate this response?")+"",i,o,a,f,u,c,g,h,_,C,p,N,D=n[8].t("Awful")+"",L,O,A,w,V=n[8].t("Amazing")+"",T,S,B,R,q,le,F,X,ae,de,ge,pe,Y,re=n[8].t("Save")+"",be,fe,ce,ye,J,oe=((Z=n[1])==null?void 0:Z.arena)&&Dl(n);f=new Wt({props:{className:"size-4"}});let _e=Ne(Array.from({length:10}).map(Tl)),P=[];for(let Q=0;Q<_e.length;Q+=1)P[Q]=Vl(Nl(n,_e,Q));let K=n[3].length>0&&Cl(n);return ge=new Zr({props:{tags:n[2]}}),ge.$on("delete",n[15]),ge.$on("add",n[16]),{c(){oe&&oe.c(),e=j(),t=y("div"),l=y("div"),s=y("div"),i=U(r),o=j(),a=y("button"),$(f.$$.fragment),u=j(),c=y("div"),g=y("div"),h=y("div");for(let Q=0;Q<P.length;Q+=1)P[Q].c();_=j(),C=y("div"),p=y("div"),N=U("1 - "),L=U(D),O=j(),A=y("div"),w=U("10 - "),T=U(V),S=j(),B=y("div"),K&&K.c(),R=j(),q=y("div"),le=y("textarea"),X=j(),ae=y("div"),de=y("div"),$(ge.$$.fragment),pe=j(),Y=y("button"),be=U(re),this.h()},l(Q){oe&&oe.l(Q),e=H(Q),t=I(Q,"DIV",{class:!0,id:!0});var ue=k(t);l=I(ue,"DIV",{class:!0});var ve=k(l);s=I(ve,"DIV",{class:!0});var Ve=k(s);i=W(Ve,r),Ve.forEach(m),o=H(ve),a=I(ve,"BUTTON",{});var De=k(a);x(f.$$.fragment,De),De.forEach(m),ve.forEach(m),u=H(ue),c=I(ue,"DIV",{class:!0});var ze=k(c);g=I(ze,"DIV",{class:!0});var Ue=k(g);h=I(Ue,"DIV",{class:!0});var je=k(h);for(let ot=0;ot<P.length;ot+=1)P[ot].l(je);je.forEach(m),_=H(Ue),C=I(Ue,"DIV",{class:!0});var ie=k(C);p=I(ie,"DIV",{});var Je=k(p);N=W(Je,"1 - "),L=W(Je,D),Je.forEach(m),O=H(ie),A=I(ie,"DIV",{});var Ge=k(A);w=W(Ge,"10 - "),T=W(Ge,V),Ge.forEach(m),ie.forEach(m),Ue.forEach(m),ze.forEach(m),S=H(ue),B=I(ue,"DIV",{});var $e=k(B);K&&K.l($e),$e.forEach(m),R=H(ue),q=I(ue,"DIV",{class:!0});var lt=k(q);le=I(lt,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),k(le).forEach(m),lt.forEach(m),X=H(ue),ae=I(ue,"DIV",{class:!0});var at=k(ae);de=I(at,"DIV",{class:!0});var ct=k(de);x(ge.$$.fragment,ct),ct.forEach(m),pe=H(at),Y=I(at,"BUTTON",{class:!0});var dt=k(Y);be=W(dt,re),dt.forEach(m),at.forEach(m),ue.forEach(m),this.h()},h(){d(s,"class","text-sm font-medium"),d(l,"class","flex justify-between items-center"),d(h,"class","mt-1.5 w-fit flex gap-1 pb-2"),d(C,"class","sticky top-0 bottom-0 left-0 right-0 flex justify-between text-xs"),d(g,"class","relative w-fit overflow-x-auto scrollbar-none"),d(c,"class","w-full flex justify-center"),d(le,"class","w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl"),d(le,"placeholder",F=n[8].t("Feel free to add specific details")),d(le,"rows","3"),d(q,"class","mt-2"),d(de,"class","flex items-end group"),d(Y,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),d(ae,"class","mt-2 gap-1.5 flex justify-between"),d(t,"class","my-2.5 rounded-xl px-4 py-3 border border-gray-100 dark:border-gray-850"),d(t,"id",fe="message-feedback-"+n[1].id)},m(Q,ue){oe&&oe.m(Q,ue),E(Q,e,ue),E(Q,t,ue),b(t,l),b(l,s),b(s,i),b(l,o),b(l,a),ee(f,a,null),b(t,u),b(t,c),b(c,g),b(g,h);for(let ve=0;ve<P.length;ve+=1)P[ve]&&P[ve].m(h,null);b(g,_),b(g,C),b(C,p),b(p,N),b(p,L),b(C,O),b(C,A),b(A,w),b(A,T),b(t,S),b(t,B),K&&K.m(B,null),b(t,R),b(t,q),b(q,le),ut(le,n[5]),b(t,X),b(t,ae),b(ae,de),ee(ge,de,null),b(ae,pe),b(ae,Y),b(Y,be),ce=!0,ye||(J=[me(a,"click",n[11]),me(le,"input",n[14]),me(Y,"click",n[17])],ye=!0)},p(Q,[ue]){var Ve;if((Ve=Q[1])!=null&&Ve.arena?oe?oe.p(Q,ue):(oe=Dl(Q),oe.c(),oe.m(e.parentNode,e)):oe&&(oe.d(1),oe=null),(!ce||ue&256)&&r!==(r=Q[8].t("How would you rate this response?")+"")&&G(i,r),ue&66){_e=Ne(Array.from({length:10}).map(Tl));let De;for(De=0;De<_e.length;De+=1){const ze=Nl(Q,_e,De);P[De]?P[De].p(ze,ue):(P[De]=Vl(ze),P[De].c(),P[De].m(h,null))}for(;De<P.length;De+=1)P[De].d(1);P.length=_e.length}(!ce||ue&256)&&D!==(D=Q[8].t("Awful")+"")&&G(L,D),(!ce||ue&256)&&V!==(V=Q[8].t("Amazing")+"")&&G(T,V),Q[3].length>0?K?K.p(Q,ue):(K=Cl(Q),K.c(),K.m(B,null)):K&&(K.d(1),K=null),(!ce||ue&256&&F!==(F=Q[8].t("Feel free to add specific details")))&&d(le,"placeholder",F),ue&32&&ut(le,Q[5]);const ve={};ue&4&&(ve.tags=Q[2]),ge.$set(ve),(!ce||ue&256)&&re!==(re=Q[8].t("Save")+"")&&G(be,re),(!ce||ue&2&&fe!==(fe="message-feedback-"+Q[1].id))&&d(t,"id",fe)},i(Q){ce||(v(f.$$.fragment,Q),v(ge.$$.fragment,Q),ce=!0)},o(Q){M(f.$$.fragment,Q),M(ge.$$.fragment,Q),ce=!1},d(Q){Q&&(m(e),m(t)),oe&&oe.d(Q),te(f),qe(P,Q),K&&K.d(),te(ge),ye=!1,Ye(J)}}}const Tl=(n,e)=>e+1;function wi(n,e,t){let l,s;Me(n,zt,B=>t(18,s=B));const r=Fe("i18n");Me(n,r,B=>t(8,l=B));const i=Vt();let{message:o}=e,{show:a=!1}=e,f=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],u=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],c=[],g=[],h=null,_="",C=null,p=null;const N=()=>{var B,R,q,le,F;h||t(4,h=((B=o==null?void 0:o.annotation)==null?void 0:B.reason)??""),_||t(5,_=((R=o==null?void 0:o.annotation)==null?void 0:R.comment)??""),t(2,c=(((q=o==null?void 0:o.annotation)==null?void 0:q.tags)??[]).map(X=>({name:X}))),C||t(6,C=((F=(le=o==null?void 0:o.annotation)==null?void 0:le.details)==null?void 0:F.rating)??null)};yt(()=>{o!=null&&o.arena&&(t(7,p=s.find(B=>B.id===o.selectedModelId)),Le.success(l.t('This response was generated by "{{model}}"',{model:p?(p==null?void 0:p.name)??p.id:o.selectedModelId})))});const D=()=>{i("save",{reason:h,comment:_,tags:c.map(B=>B.name),details:{rating:C}}),Le.success(l.t("Thanks for your feedback!")),t(0,a=!1)},L=()=>{t(0,a=!1)},O=B=>{t(6,C=B)},A=B=>{t(4,h=B)};function w(){_=this.value,t(5,_)}const V=B=>{t(2,c=c.filter(R=>R.name.replaceAll(" ","_").toLowerCase()!==B.detail.replaceAll(" ","_").toLowerCase()))},T=B=>{t(2,c=[...c,{name:B.detail}])},S=()=>{D()};return n.$$set=B=>{"message"in B&&t(1,o=B.message),"show"in B&&t(0,a=B.show)},n.$$.update=()=>{var B,R;n.$$.dirty&2&&(((B=o==null?void 0:o.annotation)==null?void 0:B.rating)===1?t(3,g=f):((R=o==null?void 0:o.annotation)==null?void 0:R.rating)===-1&&t(3,g=u)),n.$$.dirty&2&&o&&N()},[a,o,c,g,h,_,C,p,l,r,D,L,O,A,w,V,T,S]}class yi extends Pe{constructor(e){super(),Ae(this,e,wi,ki,Te,{message:1,show:0})}}function Bl(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function Ii(n){let e,t;return e=new Gn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Mi(n){let e,t;return e=new Kn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Ei(n){let e,t,l,s,r;const i=n[2].default,o=Ir(i,n,n[4],null),a=[Mi,Ii],f=[];function u(c,g){return c[1]?0:1}return l=u(n),s=f[l]=a[l](n),{c(){e=y("div"),o&&o.c(),t=j(),s.c(),this.h()},l(c){e=I(c,"DIV",{class:!0});var g=k(e);o&&o.l(g),t=H(g),s.l(g),g.forEach(m),this.h()},h(){d(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition")},m(c,g){E(c,e,g),o&&o.m(e,null),b(e,t),f[l].m(e,null),r=!0},p(c,g){o&&o.p&&(!r||g&16)&&Mr(o,i,c,c[4],r?Nr(i,c[4],g,null):Er(c[4]),null);let h=l;l=u(c),l!==h&&(se(),M(f[h],1,1,()=>{f[h]=null}),ne(),s=f[l],s||(s=f[l]=a[l](c),s.c()),v(s,1),s.m(e,null))},i(c){r||(v(o,c),v(s),r=!0)},o(c){M(o,c),M(s),r=!1},d(c){c&&m(e),o&&o.d(c),f[l].d()}}}function Rl(n){let e,t,l,s,r,i=n[0].query+"",o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',c,g;return l=new Qr({}),{c(){e=y("a"),t=y("div"),$(l.$$.fragment),s=j(),r=y("div"),o=U(i),a=j(),f=y("div"),f.innerHTML=u,this.h()},l(h){e=I(h,"A",{href:!0,target:!0,class:!0});var _=k(e);t=I(_,"DIV",{class:!0});var C=k(t);x(l.$$.fragment,C),s=H(C),r=I(C,"DIV",{class:!0});var p=k(r);o=W(p,i),p.forEach(m),C.forEach(m),a=H(_),f=I(_,"DIV",{class:!0,"data-svelte-h":!0}),tt(f)!=="svelte-14xjows"&&(f.innerHTML=u),_.forEach(m),this.h()},h(){d(r,"class","line-clamp-1"),d(t,"class","flex gap-2 items-center"),d(f,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),d(e,"href",c="https://www.google.com/search?q="+n[0].query),d(e,"target","_blank"),d(e,"class","flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline")},m(h,_){E(h,e,_),b(e,t),ee(l,t,null),b(t,s),b(t,r),b(r,o),b(e,a),b(e,f),g=!0},p(h,_){(!g||_&1)&&i!==(i=h[0].query+"")&&G(o,i),(!g||_&1&&c!==(c="https://www.google.com/search?q="+h[0].query))&&d(e,"href",c)},i(h){g||(v(l.$$.fragment,h),g=!0)},o(h){M(l.$$.fragment,h),g=!1},d(h){h&&m(e),te(l)}}}function Ol(n){let e,t,l=n[5]+"",s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',a,f,u;return{c(){e=y("a"),t=y("div"),s=U(l),r=j(),i=y("div"),i.innerHTML=o,a=j(),this.h()},l(c){e=I(c,"A",{href:!0,target:!0,class:!0});var g=k(e);t=I(g,"DIV",{class:!0});var h=k(t);s=W(h,l),h.forEach(m),r=H(g),i=I(g,"DIV",{class:!0,"data-svelte-h":!0}),tt(i)!=="svelte-14xjows"&&(i.innerHTML=o),a=H(g),g.forEach(m),this.h()},h(){d(t,"class","line-clamp-1"),d(i,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),d(e,"href",f=n[5]),d(e,"target","_blank"),d(e,"class",u="flex w-full items-center p-3 px-4 "+(n[7]===n[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")},m(c,g){E(c,e,g),b(e,t),b(t,s),b(e,r),b(e,i),b(e,a)},p(c,g){g&1&&l!==(l=c[5]+"")&&G(s,l),g&1&&f!==(f=c[5])&&d(e,"href",f),g&1&&u!==(u="flex w-full items-center p-3 px-4 "+(c[7]===c[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")&&d(e,"class",u)},d(c){c&&m(e)}}}function Ni(n){var o;let e,t,l,s=((o=n[0])==null?void 0:o.query)&&Rl(n),r=Ne(n[0].urls),i=[];for(let a=0;a<r.length;a+=1)i[a]=Ol(Bl(n,r,a));return{c(){e=y("div"),s&&s.c(),t=j();for(let a=0;a<i.length;a+=1)i[a].c();this.h()},l(a){e=I(a,"DIV",{class:!0,slot:!0});var f=k(e);s&&s.l(f),t=H(f);for(let u=0;u<i.length;u+=1)i[u].l(f);f.forEach(m),this.h()},h(){d(e,"class","text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5"),d(e,"slot","content")},m(a,f){E(a,e,f),s&&s.m(e,null),b(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);l=!0},p(a,f){var u;if((u=a[0])!=null&&u.query?s?(s.p(a,f),f&1&&v(s,1)):(s=Rl(a),s.c(),v(s,1),s.m(e,t)):s&&(se(),M(s,1,1,()=>{s=null}),ne()),f&1){r=Ne(a[0].urls);let c;for(c=0;c<r.length;c+=1){const g=Bl(a,r,c);i[c]?i[c].p(g,f):(i[c]=Ol(g),i[c].c(),i[c].m(e,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=r.length}},i(a){l||(v(s),l=!0)},o(a){M(s),l=!1},d(a){a&&m(e),s&&s.d(),qe(i,a)}}}function Di(n){let e,t,l;function s(i){n[3](i)}let r={className:"w-full space-y-1",$$slots:{content:[Ni],default:[Ei]},$$scope:{ctx:n}};return n[1]!==void 0&&(r.open=n[1]),e=new Jn({props:r}),He.push(()=>Xe(e,"open",s)),{c(){$(e.$$.fragment)},l(i){x(e.$$.fragment,i)},m(i,o){ee(e,i,o),l=!0},p(i,[o]){const a={};o&19&&(a.$$scope={dirty:o,ctx:i}),!t&&o&2&&(t=!0,a.open=i[1],Qe(()=>t=!1)),e.$set(a)},i(i){l||(v(e.$$.fragment,i),l=!0)},o(i){M(e.$$.fragment,i),l=!1},d(i){te(e,i)}}}function Vi(n,e,t){let{$$slots:l={},$$scope:s}=e,{status:r={urls:[],query:""}}=e,i=!1;function o(a){i=a,t(1,i)}return n.$$set=a=>{"status"in a&&t(0,r=a.status),"$$scope"in a&&t(4,s=a.$$scope)},[r,i,l,o,s]}class Ci extends Pe{constructor(e){super(),Ae(this,e,Vi,Di,Te,{status:0})}}function Si(n){let e,t,l,s,r,i=(typeof n[0]=="string"?n[0]:JSON.stringify(n[0]))+"",o,a;return l=new Yr({props:{className:"size-5 text-red-700 dark:text-red-400"}}),{c(){e=y("div"),t=y("div"),$(l.$$.fragment),s=j(),r=y("div"),o=U(i),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);t=I(u,"DIV",{class:!0});var c=k(t);x(l.$$.fragment,c),c.forEach(m),s=H(u),r=I(u,"DIV",{class:!0});var g=k(r);o=W(g,i),g.forEach(m),u.forEach(m),this.h()},h(){d(t,"class","self-start mt-0.5"),d(r,"class","self-center text-sm"),d(e,"class","flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg")},m(f,u){E(f,e,u),b(e,t),ee(l,t,null),b(e,s),b(e,r),b(r,o),a=!0},p(f,[u]){(!a||u&1)&&i!==(i=(typeof f[0]=="string"?f[0]:JSON.stringify(f[0]))+"")&&G(o,i)},i(f){a||(v(l.$$.fragment,f),a=!0)},o(f){M(l.$$.fragment,f),a=!1},d(f){f&&m(e),te(l)}}}function Ti(n,e,t){let{content:l=""}=e;return n.$$set=s=>{"content"in s&&t(0,l=s.content)},[l]}let Bi=class extends Pe{constructor(e){super(),Ae(this,e,Ti,Si,Te,{content:0})}};function Pl(n,e,t){const l=n.slice();return l[10]=e[t],l[12]=t,l}function Ri(n){const e=n.slice(),t=Ji(e[10].distance);return e[13]=t,e}function Oi(n){let e,t=n[4].t("No source available")+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=k(e);l=W(r,t),r.forEach(m),this.h()},h(){d(e,"class","text-sm dark:text-gray-400")},m(s,r){E(s,e,r),b(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No source available")+"")&&G(l,t)},i:Ee,o:Ee,d(s){s&&m(e)}}}function Pi(n){var a;let e,t,l,s,r;e=new Be({props:{className:"w-fit",content:n[4].t("Open file"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Ai]},$$scope:{ctx:n}}});let i=((a=n[10].metadata)==null?void 0:a.parameters)&&Ll(n),o=n[2]&&jl(n);return{c(){$(e.$$.fragment),t=j(),i&&i.c(),l=j(),o&&o.c(),s=he()},l(f){x(e.$$.fragment,f),t=H(f),i&&i.l(f),l=H(f),o&&o.l(f),s=he()},m(f,u){ee(e,f,u),E(f,t,u),i&&i.m(f,u),E(f,l,u),o&&o.m(f,u),E(f,s,u),r=!0},p(f,u){var g;const c={};u&16&&(c.content=f[4].t("Open file")),u&16408&&(c.$$scope={dirty:u,ctx:f}),e.$set(c),(g=f[10].metadata)!=null&&g.parameters?i?i.p(f,u):(i=Ll(f),i.c(),i.m(l.parentNode,l)):i&&(i.d(1),i=null),f[2]?o?(o.p(f,u),u&4&&v(o,1)):(o=jl(f),o.c(),v(o,1),o.m(s.parentNode,s)):o&&(se(),M(o,1,1,()=>{o=null}),ne())},i(f){r||(v(e.$$.fragment,f),v(o),r=!0)},o(f){M(e.$$.fragment,f),M(o),r=!1},d(f){f&&(m(t),m(l),m(s)),te(e,f),i&&i.d(f),o&&o.d(f)}}}function Al(n){let e,t,l=n[4].t("page")+"",s,r,i=n[10].metadata.page+1+"",o,a;return{c(){e=y("span"),t=U("("),s=U(l),r=j(),o=U(i),a=U(")"),this.h()},l(f){e=I(f,"SPAN",{class:!0});var u=k(e);t=W(u,"("),s=W(u,l),r=H(u),o=W(u,i),a=W(u,")"),u.forEach(m),this.h()},h(){d(e,"class","text-xs text-gray-500 dark:text-gray-400")},m(f,u){E(f,e,u),b(e,t),b(e,s),b(e,r),b(e,o),b(e,a)},p(f,u){u&16&&l!==(l=f[4].t("page")+"")&&G(s,l),u&8&&i!==(i=f[10].metadata.page+1+"")&&G(o,i)},d(f){f&&m(e)}}}function Ai(n){var f,u,c,g;let e,t,l=n[6](((u=(f=n[10])==null?void 0:f.metadata)==null?void 0:u.name)??n[10].source.name)+"",s,r,i,o=Number.isInteger((g=(c=n[10])==null?void 0:c.metadata)==null?void 0:g.page),a=o&&Al(n);return{c(){e=y("div"),t=y("a"),s=U(l),i=j(),a&&a.c(),this.h()},l(h){e=I(h,"DIV",{class:!0});var _=k(e);t=I(_,"A",{class:!0,href:!0,target:!0});var C=k(t);s=W(C,l),C.forEach(m),i=H(_),a&&a.l(_),_.forEach(m),this.h()},h(){var h,_,C,p,N,D,L,O;d(t,"class","hover:text-gray-500 dark:hover:text-gray-100 underline grow"),d(t,"href",r=(_=(h=n[10])==null?void 0:h.metadata)!=null&&_.file_id?`${gl}/files/${(p=(C=n[10])==null?void 0:C.metadata)==null?void 0:p.file_id}/content${((D=(N=n[10])==null?void 0:N.metadata)==null?void 0:D.page)!==void 0?`#page=${n[10].metadata.page+1}`:""}`:(O=(L=n[10].source)==null?void 0:L.url)!=null&&O.includes("http")?n[10].source.url:"#"),d(t,"target","_blank"),d(e,"class","text-sm dark:text-gray-400 flex items-center gap-2 w-fit")},m(h,_){E(h,e,_),b(e,t),b(t,s),b(e,i),a&&a.m(e,null)},p(h,_){var C,p,N,D,L,O,A,w,V,T,S,B;_&8&&l!==(l=h[6](((p=(C=h[10])==null?void 0:C.metadata)==null?void 0:p.name)??h[10].source.name)+"")&&G(s,l),_&8&&r!==(r=(D=(N=h[10])==null?void 0:N.metadata)!=null&&D.file_id?`${gl}/files/${(O=(L=h[10])==null?void 0:L.metadata)==null?void 0:O.file_id}/content${((w=(A=h[10])==null?void 0:A.metadata)==null?void 0:w.page)!==void 0?`#page=${h[10].metadata.page+1}`:""}`:(T=(V=h[10].source)==null?void 0:V.url)!=null&&T.includes("http")?h[10].source.url:"#")&&d(t,"href",r),_&8&&(o=Number.isInteger((B=(S=h[10])==null?void 0:S.metadata)==null?void 0:B.page)),o?a?a.p(h,_):(a=Al(h),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(h){h&&m(e),a&&a.d()}}}function Ll(n){let e,t=n[4].t("Parameters")+"",l,s,r,i=JSON.stringify(n[10].metadata.parameters,null,2)+"",o;return{c(){e=y("div"),l=U(t),s=j(),r=y("pre"),o=U(i),this.h()},l(a){e=I(a,"DIV",{class:!0});var f=k(e);l=W(f,t),f.forEach(m),s=H(a),r=I(a,"PRE",{class:!0});var u=k(r);o=W(u,i),u.forEach(m),this.h()},h(){d(e,"class","text-sm font-medium dark:text-gray-300 mt-2"),d(r,"class","text-sm dark:text-gray-400 bg-gray-50 dark:bg-gray-800 p-2 rounded-md overflow-auto max-h-40")},m(a,f){E(a,e,f),b(e,l),E(a,s,f),E(a,r,f),b(r,o)},p(a,f){f&16&&t!==(t=a[4].t("Parameters")+"")&&G(l,t),f&8&&i!==(i=JSON.stringify(a[10].metadata.parameters,null,2)+"")&&G(o,i)},d(a){a&&(m(e),m(s),m(r))}}}function jl(n){let e,t=n[4].t("Relevance")+"",l,s,r,i,o,a;const f=[ji,Li],u=[];function c(g,h){return g[10].distance!==void 0?0:1}return r=c(n),i=u[r]=f[r](n),{c(){e=y("div"),l=U(t),s=j(),i.c(),o=he(),this.h()},l(g){e=I(g,"DIV",{class:!0});var h=k(e);l=W(h,t),h.forEach(m),s=H(g),i.l(g),o=he(),this.h()},h(){d(e,"class","text-sm font-medium dark:text-gray-300 mt-2")},m(g,h){E(g,e,h),b(e,l),E(g,s,h),u[r].m(g,h),E(g,o,h),a=!0},p(g,h){(!a||h&16)&&t!==(t=g[4].t("Relevance")+"")&&G(l,t);let _=r;r=c(g),r===_?u[r].p(g,h):(se(),M(u[_],1,1,()=>{u[_]=null}),ne(),i=u[r],i?i.p(g,h):(i=u[r]=f[r](g),i.c()),v(i,1),i.m(o.parentNode,o))},i(g){a||(v(i),a=!0)},o(g){M(i),a=!1},d(g){g&&(m(e),m(s),m(o)),u[r].d(g)}}}function Li(n){let e,t=n[4].t("No distance available")+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=k(e);l=W(r,t),r.forEach(m),this.h()},h(){d(e,"class","text-sm dark:text-gray-400")},m(s,r){E(s,e,r),b(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No distance available")+"")&&G(l,t)},i:Ee,o:Ee,d(s){s&&m(e)}}}function ji(n){let e,t;return e=new Be({props:{className:"w-fit",content:n[4].t("Semantic distance to query"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[zi]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s&16&&(r.content=l[4].t("Semantic distance to query")),s&16394&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Hi(n){var i;let e,t,l=(((i=n[10])==null?void 0:i.distance)??0).toFixed(4)+"",s,r;return{c(){e=y("span"),t=U("("),s=U(l),r=U(")"),this.h()},l(o){e=I(o,"SPAN",{class:!0});var a=k(e);t=W(a,"("),s=W(a,l),r=W(a,")"),a.forEach(m),this.h()},h(){d(e,"class","text-gray-500 dark:text-gray-500")},m(o,a){E(o,e,a),b(e,t),b(e,s),b(e,r)},p(o,a){var f;a&8&&l!==(l=(((f=o[10])==null?void 0:f.distance)??0).toFixed(4)+"")&&G(s,l)},d(o){o&&m(e)}}}function Hl(n){var r;let e,t,l=typeof n[13]=="number"&&zl(n),s=typeof((r=n[10])==null?void 0:r.distance)=="number"&&Ul(n);return{c(){l&&l.c(),e=j(),s&&s.c(),t=he()},l(i){l&&l.l(i),e=H(i),s&&s.l(i),t=he()},m(i,o){l&&l.m(i,o),E(i,e,o),s&&s.m(i,o),E(i,t,o)},p(i,o){var a;typeof i[13]=="number"?l?l.p(i,o):(l=zl(i),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),typeof((a=i[10])==null?void 0:a.distance)=="number"?s?s.p(i,o):(s=Ul(i),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},d(i){i&&(m(e),m(t)),l&&l.d(i),s&&s.d(i)}}}function zl(n){let e,t=n[13].toFixed(2)+"",l,s,r;return{c(){e=y("span"),l=U(t),s=U("%"),this.h()},l(i){e=I(i,"SPAN",{class:!0});var o=k(e);l=W(o,t),s=W(o,"%"),o.forEach(m),this.h()},h(){d(e,"class",r=`px-1 rounded-sm font-medium ${Fl(n[13])}`)},m(i,o){E(i,e,o),b(e,l),b(e,s)},p(i,o){o&8&&t!==(t=i[13].toFixed(2)+"")&&G(l,t),o&8&&r!==(r=`px-1 rounded-sm font-medium ${Fl(i[13])}`)&&d(e,"class",r)},d(i){i&&m(e)}}}function Ul(n){var i;let e,t,l=(((i=n[10])==null?void 0:i.distance)??0).toFixed(4)+"",s,r;return{c(){e=y("span"),t=U("("),s=U(l),r=U(")"),this.h()},l(o){e=I(o,"SPAN",{class:!0});var a=k(e);t=W(a,"("),s=W(a,l),r=W(a,")"),a.forEach(m),this.h()},h(){d(e,"class","text-gray-500 dark:text-gray-500")},m(o,a){E(o,e,a),b(e,t),b(e,s),b(e,r)},p(o,a){var f;a&8&&l!==(l=(((f=o[10])==null?void 0:f.distance)??0).toFixed(4)+"")&&G(s,l)},d(o){o&&m(e)}}}function zi(n){let e;function t(i,o){var a;if(i[1])return Hl;if(typeof((a=i[10])==null?void 0:a.distance)=="number")return Hi}function l(i,o){return o===Hl?Ri(i):i}let s=t(n),r=s&&s(l(n,s));return{c(){e=y("div"),r&&r.c(),this.h()},l(i){e=I(i,"DIV",{class:!0});var o=k(e);r&&r.l(o),o.forEach(m),this.h()},h(){d(e,"class","text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit")},m(i,o){E(i,e,o),r&&r.m(e,null)},p(i,o){s===(s=t(i))&&r?r.p(l(i,s),o):(r&&r.d(1),r=s&&s(l(i,s)),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r&&r.d()}}}function Ui(n){let e,t,l=n[10].document+"",s,r;return{c(){e=y("pre"),t=U("                "),s=U(l),r=U(`
              `),this.h()},l(i){e=I(i,"PRE",{class:!0});var o=k(e);t=W(o,"                "),s=W(o,l),r=W(o,`
              `),o.forEach(m),this.h()},h(){d(e,"class","text-sm dark:text-gray-400 whitespace-pre-line")},m(i,o){E(i,e,o),b(e,t),b(e,s),b(e,r)},p(i,o){o&8&&l!==(l=i[10].document+"")&&G(s,l)},d(i){i&&m(e)}}}function Wi(n){let e,t,l;return{c(){e=y("iframe"),this.h()},l(s){e=I(s,"IFRAME",{class:!0,sandbox:!0,srcdoc:!0,title:!0}),k(e).forEach(m),this.h()},h(){d(e,"class","w-full border-0 h-auto rounded-none"),d(e,"sandbox","allow-scripts allow-forms allow-same-origin"),d(e,"srcdoc",t=n[10].document),d(e,"title",l=n[4].t("Content"))},m(s,r){E(s,e,r)},p(s,r){r&8&&t!==(t=s[10].document)&&d(e,"srcdoc",t),r&16&&l!==(l=s[4].t("Content"))&&d(e,"title",l)},d(s){s&&m(e)}}}function Wl(n){let e;return{c(){e=y("hr"),this.h()},l(t){e=I(t,"HR",{class:!0}),this.h()},h(){d(e,"class","border-gray-100 dark:border-gray-850 my-3")},m(t,l){E(t,e,l)},d(t){t&&m(e)}}}function ql(n){let e,t,l=n[4].t("Source")+"",s,r,i,o,a,f,u,c=n[4].t("Content")+"",g,h,_,C,p;const N=[Pi,Oi],D=[];function L(T,S){var B;return(B=T[10].source)!=null&&B.name?0:1}i=L(n),o=D[i]=N[i](n);function O(T,S){var B;return(B=T[10].metadata)!=null&&B.html?Wi:Ui}let A=O(n),w=A(n),V=n[12]!==n[3].length-1&&Wl();return{c(){e=y("div"),t=y("div"),s=U(l),r=j(),o.c(),a=j(),f=y("div"),u=y("div"),g=U(c),h=j(),w.c(),_=j(),V&&V.c(),C=he(),this.h()},l(T){e=I(T,"DIV",{class:!0});var S=k(e);t=I(S,"DIV",{class:!0});var B=k(t);s=W(B,l),B.forEach(m),r=H(S),o.l(S),S.forEach(m),a=H(T),f=I(T,"DIV",{class:!0});var R=k(f);u=I(R,"DIV",{class:!0});var q=k(u);g=W(q,c),q.forEach(m),h=H(R),w.l(R),R.forEach(m),_=H(T),V&&V.l(T),C=he(),this.h()},h(){d(t,"class","text-sm font-medium dark:text-gray-300"),d(e,"class","flex flex-col w-full"),d(u,"class","text-sm font-medium dark:text-gray-300 mt-2"),d(f,"class","flex flex-col w-full")},m(T,S){E(T,e,S),b(e,t),b(t,s),b(e,r),D[i].m(e,null),E(T,a,S),E(T,f,S),b(f,u),b(u,g),b(f,h),w.m(f,null),E(T,_,S),V&&V.m(T,S),E(T,C,S),p=!0},p(T,S){(!p||S&16)&&l!==(l=T[4].t("Source")+"")&&G(s,l);let B=i;i=L(T),i===B?D[i].p(T,S):(se(),M(D[B],1,1,()=>{D[B]=null}),ne(),o=D[i],o?o.p(T,S):(o=D[i]=N[i](T),o.c()),v(o,1),o.m(e,null)),(!p||S&16)&&c!==(c=T[4].t("Content")+"")&&G(g,c),A===(A=O(T))&&w?w.p(T,S):(w.d(1),w=A(T),w&&(w.c(),w.m(f,null))),T[12]!==T[3].length-1?V||(V=Wl(),V.c(),V.m(C.parentNode,C)):V&&(V.d(1),V=null)},i(T){p||(v(o),p=!0)},o(T){M(o),p=!1},d(T){T&&(m(e),m(a),m(f),m(_),m(C)),D[i].d(),w.d(),V&&V.d(T)}}}function qi(n){let e,t,l,s=n[4].t("Citation")+"",r,i,o,a,f,u,c,g,h,_;a=new Wt({props:{className:"size-5"}});let C=Ne(n[3]),p=[];for(let D=0;D<C.length;D+=1)p[D]=ql(Pl(n,C,D));const N=D=>M(p[D],1,1,()=>{p[D]=null});return{c(){e=y("div"),t=y("div"),l=y("div"),r=U(s),i=j(),o=y("button"),$(a.$$.fragment),f=j(),u=y("div"),c=y("div");for(let D=0;D<p.length;D+=1)p[D].c();this.h()},l(D){e=I(D,"DIV",{});var L=k(e);t=I(L,"DIV",{class:!0});var O=k(t);l=I(O,"DIV",{class:!0});var A=k(l);r=W(A,s),A.forEach(m),i=H(O),o=I(O,"BUTTON",{class:!0});var w=k(o);x(a.$$.fragment,w),w.forEach(m),O.forEach(m),f=H(L),u=I(L,"DIV",{class:!0});var V=k(u);c=I(V,"DIV",{class:!0});var T=k(c);for(let S=0;S<p.length;S+=1)p[S].l(T);T.forEach(m),V.forEach(m),L.forEach(m),this.h()},h(){d(l,"class","text-lg font-medium self-center capitalize"),d(o,"class","self-center"),d(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),d(c,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),d(u,"class","flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4")},m(D,L){E(D,e,L),b(e,t),b(t,l),b(l,r),b(t,i),b(t,o),ee(a,o,null),b(e,f),b(e,u),b(u,c);for(let O=0;O<p.length;O+=1)p[O]&&p[O].m(c,null);g=!0,h||(_=me(o,"click",n[8]),h=!0)},p(D,L){if((!g||L&16)&&s!==(s=D[4].t("Citation")+"")&&G(r,s),L&94){C=Ne(D[3]);let O;for(O=0;O<C.length;O+=1){const A=Pl(D,C,O);p[O]?(p[O].p(A,L),v(p[O],1)):(p[O]=ql(A),p[O].c(),v(p[O],1),p[O].m(c,null))}for(se(),O=C.length;O<p.length;O+=1)N(O);ne()}},i(D){if(!g){v(a.$$.fragment,D);for(let L=0;L<C.length;L+=1)v(p[L]);g=!0}},o(D){M(a.$$.fragment,D),p=p.filter(Boolean);for(let L=0;L<p.length;L+=1)M(p[L]);g=!1},d(D){D&&m(e),te(a),qe(p,D),h=!1,_()}}}function Fi(n){let e,t,l;function s(i){n[9](i)}let r={size:"lg",$$slots:{default:[qi]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new Qn({props:r}),He.push(()=>Xe(e,"show",s)),{c(){$(e.$$.fragment)},l(i){x(e.$$.fragment,i)},m(i,o){ee(e,i,o),l=!0},p(i,[o]){const a={};o&16415&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Qe(()=>t=!1)),e.$set(a)},i(i){l||(v(e.$$.fragment,i),l=!0)},o(i){M(e.$$.fragment,i),l=!1},d(i){te(e,i)}}}function Ji(n){return typeof n!="number"?null:n<0?0:n>1?100:Math.round(n*1e4)/100}function Fl(n){return n>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":n>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":n>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}function Gi(n,e,t){let l;const s=Fe("i18n");Me(n,s,h=>t(4,l=h));let{show:r=!1}=e,{citation:i}=e,{showPercentage:o=!1}=e,{showRelevance:a=!0}=e,f=[];const u=h=>{try{return decodeURIComponent(h)}catch{return h}},c=()=>{t(0,r=!1)};function g(h){r=h,t(0,r)}return n.$$set=h=>{"show"in h&&t(0,r=h.show),"citation"in h&&t(7,i=h.citation),"showPercentage"in h&&t(1,o=h.showPercentage),"showRelevance"in h&&t(2,a=h.showRelevance)},n.$$.update=()=>{var h;n.$$.dirty&136&&i&&(t(3,f=(h=i.document)==null?void 0:h.map((_,C)=>{var p,N;return{source:i.source,document:_,metadata:(p=i.metadata)==null?void 0:p[C],distance:(N=i.distances)==null?void 0:N[C]}})),f.every(_=>_.distance!==void 0)&&t(3,f=f.sort((_,C)=>(C.distance??1/0)-(_.distance??1/0))))},[r,o,a,f,l,s,u,i,c,g]}class Ki extends Pe{constructor(e){super(),Ae(this,e,Gi,Fi,Te,{show:0,citation:7,showPercentage:1,showRelevance:2})}}function Jl(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Gl(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Kl(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Zl(n){let e,t,l,s;const r=[Qi,Zi],i=[];function o(a,f){return a[1].length<=3?0:1}return t=o(n),l=i[t]=r[t](n),{c(){e=y("div"),l.c(),this.h()},l(a){e=I(a,"DIV",{class:!0});var f=k(e);l.l(f),f.forEach(m),this.h()},h(){d(e,"class","py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap")},m(a,f){E(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t===u?i[t].p(a,f):(se(),M(i[u],1,1,()=>{i[u]=null}),ne(),l=i[t],l?l.p(a,f):(l=i[t]=r[t](a),l.c()),v(l,1),l.m(e,null))},i(a){s||(v(l),s=!0)},o(a){M(l),s=!1},d(a){a&&m(e),i[t].d()}}}function Zi(n){let e,t,l;function s(i){n[18](i)}let r={id:`collapsible-${n[0]}`,className:"w-full max-w-full ",buttonClassName:"w-fit max-w-full",$$slots:{content:[xi],default:[$i]},$$scope:{ctx:n}};return n[6]!==void 0&&(r.open=n[6]),e=new Jn({props:r}),He.push(()=>Xe(e,"open",s)),{c(){$(e.$$.fragment)},l(i){x(e.$$.fragment,i)},m(i,o){ee(e,i,o),l=!0},p(i,o){const a={};o&1&&(a.id=`collapsible-${i[0]}`),o&16777458&&(a.$$scope={dirty:o,ctx:i}),!t&&o&64&&(t=!0,a.open=i[6],Qe(()=>t=!1)),e.$set(a)},i(i){l||(v(e.$$.fragment,i),l=!0)},o(i){M(e.$$.fragment,i),l=!1},d(i){te(e,i)}}}function Qi(n){let e,t=Ne(n[1]),l=[];for(let s=0;s<t.length;s+=1)l[s]=es(Kl(n,t,s));return{c(){e=y("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=I(s,"DIV",{class:!0});var r=k(e);for(let i=0;i<l.length;i+=1)l[i].l(r);r.forEach(m),this.h()},h(){d(e,"class","flex text-xs font-medium flex-wrap")},m(s,r){E(s,e,r);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(s,r){if(r&563){t=Ne(s[1]);let i;for(i=0;i<t.length;i+=1){const o=Kl(s,t,i);l[i]?l[i].p(o,r):(l[i]=es(o),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},i:Ee,o:Ee,d(s){s&&m(e),qe(l,s)}}}function Ql(n){let e,t=n[21]+1+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=k(e);l=W(r,t),r.forEach(m),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){E(s,e,r),b(e,l)},d(s){s&&m(e)}}}function Xl(n){let e,t=n[1].every(n[13]),l,s,r=n[9](n[19].source.name)+"",i,o,a,f,u=t&&Ql(n);function c(){return n[17](n[19])}return{c(){e=y("button"),u&&u.c(),l=j(),s=y("div"),i=U(r),o=j(),this.h()},l(g){e=I(g,"BUTTON",{class:!0});var h=k(e);u&&u.l(h),l=H(h),s=I(h,"DIV",{class:!0});var _=k(s);i=W(_,r),_.forEach(m),o=H(h),h.forEach(m),this.h()},h(){d(s,"class","flex-1 mx-1 truncate"),d(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(g,h){E(g,e,h),u&&u.m(e,null),b(e,l),b(e,s),b(s,i),b(e,o),a||(f=[me(e,"click",c),me(e,"pointerup",sa)],a=!0)},p(g,h){n=g,h&2&&(t=n[1].every(n[13])),t?u||(u=Ql(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),h&2&&r!==(r=n[9](n[19].source.name)+"")&&G(i,r)},d(g){g&&m(e),u&&u.d(),a=!1,Ye(f)}}}function Xi(n){let e,t;return e=new Gn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Yi(n){let e,t;return e=new Kn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function $i(n){let e,t,l,s=n[7].t("References from")+"",r,i,o,a,f,u,c,g=n[7].t("and")+"",h,_,C=n[1].length-2+"",p,N,D,L=n[7].t("more")+"",O,A,w,V,T,S,B=Ne(n[1].slice(0,2)),R=[];for(let X=0;X<B.length;X+=1)R[X]=Xl(Jl(n,B,X));const q=[Yi,Xi],le=[];function F(X,ae){return X[6]?0:1}return V=F(n),T=le[V]=q[V](n),{c(){e=y("div"),t=y("div"),l=y("span"),r=U(s),i=j(),o=y("div"),a=y("div");for(let X=0;X<R.length;X+=1)R[X].c();f=j(),u=y("div"),c=y("span"),h=U(g),_=j(),p=U(C),N=j(),D=y("span"),O=U(L),A=j(),w=y("div"),T.c(),this.h()},l(X){e=I(X,"DIV",{class:!0});var ae=k(e);t=I(ae,"DIV",{class:!0});var de=k(t);l=I(de,"SPAN",{class:!0});var ge=k(l);r=W(ge,s),ge.forEach(m),i=H(de),o=I(de,"DIV",{class:!0});var pe=k(o);a=I(pe,"DIV",{class:!0});var Y=k(a);for(let ye=0;ye<R.length;ye+=1)R[ye].l(Y);Y.forEach(m),pe.forEach(m),f=H(de),u=I(de,"DIV",{class:!0});var re=k(u);c=I(re,"SPAN",{class:!0});var be=k(c);h=W(be,g),be.forEach(m),_=H(re),p=W(re,C),N=H(re),D=I(re,"SPAN",{});var fe=k(D);O=W(fe,L),fe.forEach(m),re.forEach(m),de.forEach(m),A=H(ae),w=I(ae,"DIV",{class:!0});var ce=k(w);T.l(ce),ce.forEach(m),ae.forEach(m),this.h()},h(){d(l,"class","whitespace-nowrap hidden sm:inline shrink-0"),d(a,"class","flex text-xs font-medium items-center"),d(o,"class","flex items-center overflow-auto scrollbar-none w-full max-w-full flex-1"),d(c,"class","hidden sm:inline"),d(u,"class","flex items-center gap-1 whitespace-nowrap shrink-0"),d(t,"class","flex-1 flex items-center gap-1 overflow-auto scrollbar-none w-full max-w-full"),d(w,"class","shrink-0"),d(e,"class","flex w-full overflow-auto items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer")},m(X,ae){E(X,e,ae),b(e,t),b(t,l),b(l,r),b(t,i),b(t,o),b(o,a);for(let de=0;de<R.length;de+=1)R[de]&&R[de].m(a,null);b(t,f),b(t,u),b(u,c),b(c,h),b(u,_),b(u,p),b(u,N),b(u,D),b(D,O),b(e,A),b(e,w),le[V].m(w,null),S=!0},p(X,ae){if((!S||ae&128)&&s!==(s=X[7].t("References from")+"")&&G(r,s),ae&562){B=Ne(X[1].slice(0,2));let ge;for(ge=0;ge<B.length;ge+=1){const pe=Jl(X,B,ge);R[ge]?R[ge].p(pe,ae):(R[ge]=Xl(pe),R[ge].c(),R[ge].m(a,null))}for(;ge<R.length;ge+=1)R[ge].d(1);R.length=B.length}(!S||ae&128)&&g!==(g=X[7].t("and")+"")&&G(h,g),(!S||ae&2)&&C!==(C=X[1].length-2+"")&&G(p,C),(!S||ae&128)&&L!==(L=X[7].t("more")+"")&&G(O,L);let de=V;V=F(X),V!==de&&(se(),M(le[de],1,1,()=>{le[de]=null}),ne(),T=le[V],T||(T=le[V]=q[V](X),T.c()),v(T,1),T.m(w,null))},i(X){S||(v(T),S=!0)},o(X){M(T),S=!1},d(X){X&&m(e),qe(R,X),le[V].d()}}}function Yl(n){let e,t=n[21]+3+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=k(e);l=W(r,t),r.forEach(m),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){E(s,e,r),b(e,l)},d(s){s&&m(e)}}}function $l(n){let e,t=n[1].every(n[12]),l,s,r=n[9](n[19].source.name)+"",i,o,a,f,u=t&&Yl(n);function c(){return n[16](n[19])}return{c(){e=y("button"),u&&u.c(),l=j(),s=y("div"),i=U(r),o=j(),this.h()},l(g){e=I(g,"BUTTON",{class:!0});var h=k(e);u&&u.l(h),l=H(h),s=I(h,"DIV",{class:!0});var _=k(s);i=W(_,r),_.forEach(m),o=H(h),h.forEach(m),this.h()},h(){d(s,"class","flex-1 mx-1 truncate"),d(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(g,h){E(g,e,h),u&&u.m(e,null),b(e,l),b(e,s),b(s,i),b(e,o),a||(f=me(e,"click",c),a=!0)},p(g,h){n=g,h&2&&(t=n[1].every(n[12])),t?u||(u=Yl(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),h&2&&r!==(r=n[9](n[19].source.name)+"")&&G(i,r)},d(g){g&&m(e),u&&u.d(),a=!1,f()}}}function xi(n){let e,t,l=Ne(n[1].slice(2)),s=[];for(let r=0;r<l.length;r+=1)s[r]=$l(Gl(n,l,r));return{c(){e=y("div"),t=y("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=I(r,"DIV",{slot:!0});var i=k(e);t=I(i,"DIV",{class:!0});var o=k(t);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),i.forEach(m),this.h()},h(){d(t,"class","flex text-xs font-medium flex-wrap"),d(e,"slot","content")},m(r,i){E(r,e,i),b(e,t);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(t,null)},p(r,i){if(i&562){l=Ne(r[1].slice(2));let o;for(o=0;o<l.length;o+=1){const a=Gl(r,l,o);s[o]?s[o].p(a,i):(s[o]=$l(a),s[o].c(),s[o].m(t,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(r){r&&m(e),qe(s,r)}}}function xl(n){let e,t=n[21]+1+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=k(e);l=W(r,t),r.forEach(m),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){E(s,e,r),b(e,l)},d(s){s&&m(e)}}}function es(n){let e,t=n[1].every(n[11]),l,s,r=n[9](n[19].source.name)+"",i,o,a,f,u,c=t&&xl(n);function g(){return n[15](n[19])}return{c(){e=y("button"),c&&c.c(),l=j(),s=y("div"),i=U(r),o=j(),this.h()},l(h){e=I(h,"BUTTON",{id:!0,class:!0});var _=k(e);c&&c.l(_),l=H(_),s=I(_,"DIV",{class:!0});var C=k(s);i=W(C,r),C.forEach(m),o=H(_),_.forEach(m),this.h()},h(){d(s,"class","flex-1 mx-1 truncate text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition"),d(e,"id",a=`source-${n[0]}-${n[21]+1}`),d(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96")},m(h,_){E(h,e,_),c&&c.m(e,null),b(e,l),b(e,s),b(s,i),b(e,o),f||(u=me(e,"click",g),f=!0)},p(h,_){n=h,_&2&&(t=n[1].every(n[11])),t?c||(c=xl(n),c.c(),c.m(e,l)):c&&(c.d(1),c=null),_&2&&r!==(r=n[9](n[19].source.name)+"")&&G(i,r),_&1&&a!==(a=`source-${n[0]}-${n[21]+1}`)&&d(e,"id",a)},d(h){h&&m(e),c&&c.d(),f=!1,u()}}}function ea(n){let e,t,l,s,r;function i(f){n[14](f)}let o={citation:n[5],showPercentage:n[2],showRelevance:n[3]};n[4]!==void 0&&(o.show=n[4]),e=new Ki({props:o}),He.push(()=>Xe(e,"show",i));let a=n[1].length>0&&Zl(n);return{c(){$(e.$$.fragment),l=j(),a&&a.c(),s=he()},l(f){x(e.$$.fragment,f),l=H(f),a&&a.l(f),s=he()},m(f,u){ee(e,f,u),E(f,l,u),a&&a.m(f,u),E(f,s,u),r=!0},p(f,[u]){const c={};u&32&&(c.citation=f[5]),u&4&&(c.showPercentage=f[2]),u&8&&(c.showRelevance=f[3]),!t&&u&16&&(t=!0,c.show=f[4],Qe(()=>t=!1)),e.$set(c),f[1].length>0?a?(a.p(f,u),u&2&&v(a,1)):(a=Zl(f),a.c(),v(a,1),a.m(s.parentNode,s)):a&&(se(),M(a,1,1,()=>{a=null}),ne())},i(f){r||(v(e.$$.fragment,f),v(a),r=!0)},o(f){M(e.$$.fragment,f),M(a),r=!1},d(f){f&&(m(l),m(s)),te(e,f),a&&a.d(f)}}}function ta(n){const e=n.flatMap(s=>s.distances??[]),t=e.filter(s=>s!==void 0&&s>=-1&&s<=1).length,l=e.filter(s=>s!==void 0&&(s<-1||s>1)).length;return!(e.length===0||t===e.length-1&&l===1||l===e.length-1&&t===1)}function la(n){return n.flatMap(t=>t.distances??[]).every(t=>t!==void 0&&t>=-1&&t<=1)}const sa=n=>{n.stopPropagation()};function na(n,e,t){let l;const s=Fe("i18n");Me(n,s,w=>t(7,l=w));let{id:r=""}=e,{sources:i=[]}=e,o=[],a=!1,f=!0,u=!1,c=null,g=!1;const h=w=>{try{return decodeURIComponent(w)}catch{return w}},_=w=>w.distances!==void 0,C=w=>w.distances!==void 0,p=w=>w.distances!==void 0;function N(w){u=w,t(4,u)}const D=w=>{t(4,u=!0),t(5,c=w)},L=w=>{t(4,u=!0),t(5,c=w)},O=w=>{t(4,u=!0),t(5,c=w)};function A(w){g=w,t(6,g)}return n.$$set=w=>{"id"in w&&t(0,r=w.id),"sources"in w&&t(10,i=w.sources)},n.$$.update=()=>{n.$$.dirty&1026&&(t(1,o=i.reduce((w,V)=>(Object.keys(V).length===0||V.document.forEach((T,S)=>{var X,ae,de;const B=(X=V.metadata)==null?void 0:X[S],R=(ae=V.distances)==null?void 0:ae[S],q=(B==null?void 0:B.source)??((de=V==null?void 0:V.source)==null?void 0:de.id)??"N/A";let le=V==null?void 0:V.source;B!=null&&B.name&&(le={...le,name:B.name}),(q.startsWith("http://")||q.startsWith("https://"))&&(le={...le,name:q,url:q});const F=w.find(ge=>ge.id===q);F?(F.document.push(T),F.metadata.push(B),R!==void 0&&F.distances.push(R)):w.push({id:q,source:le,document:[T],metadata:B?[B]:[],distances:R!==void 0?[R]:void 0})}),w),[])),t(3,f=ta(o)),t(2,a=la(o)))},[r,o,a,f,u,c,g,l,s,h,i,_,C,p,N,D,L,O,A]}class ra extends Pe{constructor(e){super(),Ae(this,e,na,ea,Te,{id:0,sources:10})}}function ts(n,e,t){const l=n.slice();return l[6]=e[t],l}function ls(n){let e,t,l,s;const r=[oa,aa,ia],i=[];function o(a,f){var u,c;return(u=a[1].result)!=null&&u.error?0:(c=a[1].result)!=null&&c.output?1:2}return t=o(n),l=i[t]=r[t](n),{c(){e=y("div"),l.c()},l(a){e=I(a,"DIV",{});var f=k(e);l.l(f),f.forEach(m)},m(a,f){E(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t!==u&&(se(),M(i[u],1,1,()=>{i[u]=null}),ne(),l=i[t],l||(l=i[t]=r[t](a),l.c()),v(l,1),l.m(e,null))},i(a){s||(v(l),s=!0)},o(a){M(l),s=!1},d(a){a&&m(e),i[t].d()}}}function ia(n){let e,t;return e=new xt({props:{type:"warning",content:"incomplete"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function aa(n){let e,t;return e=new xt({props:{type:"success",content:"success"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function oa(n){let e,t;return e=new xt({props:{type:"error",content:"error"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function ss(n){let e,t,l;return t=new $t({props:{className:"size-4"}}),{c(){e=y("div"),$(t.$$.fragment)},l(s){e=I(s,"DIV",{});var r=k(e);x(t.$$.fragment,r),r.forEach(m)},m(s,r){E(s,e,r),ee(t,e,null),l=!0},i(s){l||(v(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),te(t)}}}function fa(n){let e=n[2].t("Code execution")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s&4&&e!==(e=l[2].t("Code execution")+"")&&G(t,e)},d(l){l&&m(t)}}}function ua(n){var i;let e=n[2].t("Code execution")+"",t,l,s=((i=n[1])==null?void 0:i.name)+"",r;return{c(){t=U(e),l=U(": "),r=U(s)},l(o){t=W(o,e),l=W(o,": "),r=W(o,s)},m(o,a){E(o,t,a),E(o,l,a),E(o,r,a)},p(o,a){var f;a&4&&e!==(e=o[2].t("Code execution")+"")&&G(t,e),a&2&&s!==(s=((f=o[1])==null?void 0:f.name)+"")&&G(r,s)},d(o){o&&(m(t),m(l),m(r))}}}function ns(n){var r,i,o,a;let e,t,l=((i=(r=n[1])==null?void 0:r.result)==null?void 0:i.error)&&rs(n),s=((a=(o=n[1])==null?void 0:o.result)==null?void 0:a.output)&&is(n);return{c(){e=y("div"),l&&l.c(),t=j(),s&&s.c(),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);l&&l.l(u),t=H(u),s&&s.l(u),u.forEach(m),this.h()},h(){d(e,"class","dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3")},m(f,u){E(f,e,u),l&&l.m(e,null),b(e,t),s&&s.m(e,null)},p(f,u){var c,g,h,_;(g=(c=f[1])==null?void 0:c.result)!=null&&g.error?l?l.p(f,u):(l=rs(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),(_=(h=f[1])==null?void 0:h.result)!=null&&_.output?s?s.p(f,u):(s=is(f),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(f){f&&m(e),l&&l.d(),s&&s.d()}}}function rs(n){var f,u;let e,t,l=n[2].t("ERROR")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.error)+"",a;return{c(){e=y("div"),t=y("div"),s=U(l),r=j(),i=y("div"),a=U(o),this.h()},l(c){e=I(c,"DIV",{});var g=k(e);t=I(g,"DIV",{class:!0});var h=k(t);s=W(h,l),h.forEach(m),r=H(g),i=I(g,"DIV",{class:!0});var _=k(i);a=W(_,o),_.forEach(m),g.forEach(m),this.h()},h(){d(t,"class","text-gray-500 text-xs mb-1"),d(i,"class","text-sm")},m(c,g){E(c,e,g),b(e,t),b(t,s),b(e,r),b(e,i),b(i,a)},p(c,g){var h,_;g&4&&l!==(l=c[2].t("ERROR")+"")&&G(s,l),g&2&&o!==(o=((_=(h=c[1])==null?void 0:h.result)==null?void 0:_.error)+"")&&G(a,o)},d(c){c&&m(e)}}}function is(n){var f,u;let e,t,l=n[2].t("OUTPUT")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.output)+"",a;return{c(){e=y("div"),t=y("div"),s=U(l),r=j(),i=y("div"),a=U(o),this.h()},l(c){e=I(c,"DIV",{});var g=k(e);t=I(g,"DIV",{class:!0});var h=k(t);s=W(h,l),h.forEach(m),r=H(g),i=I(g,"DIV",{class:!0});var _=k(i);a=W(_,o),_.forEach(m),g.forEach(m),this.h()},h(){d(t,"class","text-gray-500 text-xs mb-1"),d(i,"class","text-sm")},m(c,g){E(c,e,g),b(e,t),b(t,s),b(e,r),b(e,i),b(i,a)},p(c,g){var h,_;g&4&&l!==(l=c[2].t("OUTPUT")+"")&&G(s,l),g&2&&o!==(o=((_=(h=c[1])==null?void 0:h.result)==null?void 0:_.output)+"")&&G(a,o)},d(c){c&&m(e)}}}function as(n){var c,g;let e,t,l,s,r=n[2].t("Files")+"",i,o,a,f=Ne((g=(c=n[1])==null?void 0:c.result)==null?void 0:g.files),u=[];for(let h=0;h<f.length;h+=1)u[h]=os(ts(n,f,h));return{c(){e=y("div"),t=y("hr"),l=j(),s=y("div"),i=U(r),o=j(),a=y("ul");for(let h=0;h<u.length;h+=1)u[h].c();this.h()},l(h){e=I(h,"DIV",{class:!0});var _=k(e);t=I(_,"HR",{class:!0}),l=H(_),s=I(_,"DIV",{class:!0});var C=k(s);i=W(C,r),C.forEach(m),o=H(_),a=I(_,"UL",{class:!0});var p=k(a);for(let N=0;N<u.length;N+=1)u[N].l(p);p.forEach(m),_.forEach(m),this.h()},h(){d(t,"class","border-gray-100 dark:border-gray-850 my-2"),d(s,"class","text-sm font-medium dark:text-gray-300"),d(a,"class","mt-1 list-disc pl-4 text-xs"),d(e,"class","flex flex-col w-full")},m(h,_){E(h,e,_),b(e,t),b(e,l),b(e,s),b(s,i),b(e,o),b(e,a);for(let C=0;C<u.length;C+=1)u[C]&&u[C].m(a,null)},p(h,_){var C,p;if(_&4&&r!==(r=h[2].t("Files")+"")&&G(i,r),_&2){f=Ne((p=(C=h[1])==null?void 0:C.result)==null?void 0:p.files);let N;for(N=0;N<f.length;N+=1){const D=ts(h,f,N);u[N]?u[N].p(D,_):(u[N]=os(D),u[N].c(),u[N].m(a,null))}for(;N<u.length;N+=1)u[N].d(1);u.length=f.length}},d(h){h&&m(e),qe(u,h)}}}function os(n){let e,t,l=n[6].name+"",s,r,i;return{c(){e=y("li"),t=y("a"),s=U(l),i=j(),this.h()},l(o){e=I(o,"LI",{});var a=k(e);t=I(a,"A",{href:!0,target:!0});var f=k(t);s=W(f,l),f.forEach(m),i=H(a),a.forEach(m),this.h()},h(){d(t,"href",r=n[6].url),d(t,"target","_blank")},m(o,a){E(o,e,a),b(e,t),b(t,s),b(e,i)},p(o,a){a&2&&l!==(l=o[6].name+"")&&G(s,l),a&2&&r!==(r=o[6].url)&&d(t,"href",r)},d(o){o&&m(e)}}}function ca(n){var q,le,F,X,ae,de,ge,pe,Y,re,be,fe,ce,ye,J,oe,_e,P,K;let e,t,l,s,r,i,o,a,f,u,c,g,h,_,C,p,N,D,L,O,A=((q=n[1])==null?void 0:q.result)&&ls(n),w=!((le=n[1])!=null&&le.result)&&ss();function V(Z,Q){var ue;return(ue=Z[1])!=null&&ue.name?ua:fa}let T=V(n),S=T(n);u=new Wt({props:{className:"size-5"}}),C=new Jr({props:{id:"code-exec-"+((F=n[1])==null?void 0:F.id)+"-code",lang:((X=n[1])==null?void 0:X.language)??"",code:((ae=n[1])==null?void 0:ae.code)??"",className:"",editorClassName:(de=n[1])!=null&&de.result&&((pe=(ge=n[1])==null?void 0:ge.result)!=null&&pe.error||(re=(Y=n[1])==null?void 0:Y.result)!=null&&re.output)?"rounded-b-none":"",stickyButtonsClassName:"top-0",run:!1}});let B=((be=n[1])==null?void 0:be.result)&&(((ce=(fe=n[1])==null?void 0:fe.result)==null?void 0:ce.error)||((J=(ye=n[1])==null?void 0:ye.result)==null?void 0:J.output))&&ns(n),R=((_e=(oe=n[1])==null?void 0:oe.result)==null?void 0:_e.files)&&((K=(P=n[1])==null?void 0:P.result)==null?void 0:K.files.length)>0&&as(n);return{c(){e=y("div"),t=y("div"),l=y("div"),A&&A.c(),s=j(),r=y("div"),w&&w.c(),i=j(),o=y("div"),S.c(),a=j(),f=y("button"),$(u.$$.fragment),c=j(),g=y("div"),h=y("div"),_=y("div"),$(C.$$.fragment),p=j(),B&&B.c(),N=j(),R&&R.c(),this.h()},l(Z){e=I(Z,"DIV",{});var Q=k(e);t=I(Q,"DIV",{class:!0});var ue=k(t);l=I(ue,"DIV",{class:!0});var ve=k(l);A&&A.l(ve),s=H(ve),r=I(ve,"DIV",{class:!0});var Ve=k(r);w&&w.l(Ve),i=H(Ve),o=I(Ve,"DIV",{});var De=k(o);S.l(De),De.forEach(m),Ve.forEach(m),ve.forEach(m),a=H(ue),f=I(ue,"BUTTON",{class:!0});var ze=k(f);x(u.$$.fragment,ze),ze.forEach(m),ue.forEach(m),c=H(Q),g=I(Q,"DIV",{class:!0});var Ue=k(g);h=I(Ue,"DIV",{class:!0});var je=k(h);_=I(je,"DIV",{class:!0});var ie=k(_);x(C.$$.fragment,ie),ie.forEach(m),p=H(je),B&&B.l(je),N=H(je),R&&R.l(je),je.forEach(m),Ue.forEach(m),Q.forEach(m),this.h()},h(){d(r,"class","flex gap-2 items-center"),d(l,"class","text-lg font-medium self-center flex flex-col gap-0.5 capitalize"),d(f,"class","self-center"),d(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),d(_,"class","flex flex-col w-full"),d(h,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),d(g,"class","flex flex-col md:flex-row w-full px-4 pb-5")},m(Z,Q){E(Z,e,Q),b(e,t),b(t,l),A&&A.m(l,null),b(l,s),b(l,r),w&&w.m(r,null),b(r,i),b(r,o),S.m(o,null),b(t,a),b(t,f),ee(u,f,null),b(e,c),b(e,g),b(g,h),b(h,_),ee(C,_,null),b(h,p),B&&B.m(h,null),b(h,N),R&&R.m(h,null),D=!0,L||(O=me(f,"click",n[4]),L=!0)},p(Z,Q){var ve,Ve,De,ze,Ue,je,ie,Je,Ge,$e,lt,at,ct,dt,ot,St,Tt,Bt,Rt;(ve=Z[1])!=null&&ve.result?A?(A.p(Z,Q),Q&2&&v(A,1)):(A=ls(Z),A.c(),v(A,1),A.m(l,s)):A&&(se(),M(A,1,1,()=>{A=null}),ne()),(Ve=Z[1])!=null&&Ve.result?w&&(se(),M(w,1,1,()=>{w=null}),ne()):w?Q&2&&v(w,1):(w=ss(),w.c(),v(w,1),w.m(r,i)),T===(T=V(Z))&&S?S.p(Z,Q):(S.d(1),S=T(Z),S&&(S.c(),S.m(o,null)));const ue={};Q&2&&(ue.id="code-exec-"+((De=Z[1])==null?void 0:De.id)+"-code"),Q&2&&(ue.lang=((ze=Z[1])==null?void 0:ze.language)??""),Q&2&&(ue.code=((Ue=Z[1])==null?void 0:Ue.code)??""),Q&2&&(ue.editorClassName=(je=Z[1])!=null&&je.result&&((Je=(ie=Z[1])==null?void 0:ie.result)!=null&&Je.error||($e=(Ge=Z[1])==null?void 0:Ge.result)!=null&&$e.output)?"rounded-b-none":""),C.$set(ue),(lt=Z[1])!=null&&lt.result&&((ct=(at=Z[1])==null?void 0:at.result)!=null&&ct.error||(ot=(dt=Z[1])==null?void 0:dt.result)!=null&&ot.output)?B?B.p(Z,Q):(B=ns(Z),B.c(),B.m(h,N)):B&&(B.d(1),B=null),(Tt=(St=Z[1])==null?void 0:St.result)!=null&&Tt.files&&((Rt=(Bt=Z[1])==null?void 0:Bt.result)==null?void 0:Rt.files.length)>0?R?R.p(Z,Q):(R=as(Z),R.c(),R.m(h,null)):R&&(R.d(1),R=null)},i(Z){D||(v(A),v(w),v(u.$$.fragment,Z),v(C.$$.fragment,Z),D=!0)},o(Z){M(A),M(w),M(u.$$.fragment,Z),M(C.$$.fragment,Z),D=!1},d(Z){Z&&m(e),A&&A.d(),w&&w.d(),S.d(),te(u),te(C),B&&B.d(),R&&R.d(),L=!1,O()}}}function da(n){let e,t,l;function s(i){n[5](i)}let r={size:"lg",$$slots:{default:[ca]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new Qn({props:r}),He.push(()=>Xe(e,"show",s)),{c(){$(e.$$.fragment)},l(i){x(e.$$.fragment,i)},m(i,o){ee(e,i,o),l=!0},p(i,[o]){const a={};o&519&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Qe(()=>t=!1)),e.$set(a)},i(i){l||(v(e.$$.fragment,i),l=!0)},o(i){M(e.$$.fragment,i),l=!1},d(i){te(e,i)}}}function ha(n,e,t){let l;const s=Fe("i18n");Me(n,s,f=>t(2,l=f));let{show:r=!1}=e,{codeExecution:i=null}=e;const o=()=>{t(0,r=!1),t(1,i=null)};function a(f){r=f,t(0,r)}return n.$$set=f=>{"show"in f&&t(0,r=f.show),"codeExecution"in f&&t(1,i=f.codeExecution)},[r,i,l,s,o,a]}class ma extends Pe{constructor(e){super(),Ae(this,e,ha,da,Te,{show:0,codeExecution:1})}}function fs(n,e,t){const l=n.slice();return l[6]=e[t],l}function us(n){let e,t=[],l=new Map,s,r=Ne(n[0]);const i=o=>o[6].id;for(let o=0;o<r.length;o+=1){let a=fs(n,r,o),f=i(a);l.set(f,t[o]=cs(f,a))}return{c(){e=y("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=I(o,"DIV",{class:!0});var a=k(e);for(let f=0;f<t.length;f+=1)t[f].l(a);a.forEach(m),this.h()},h(){d(e,"class","mt-1 mb-2 w-full flex gap-1 items-center flex-wrap")},m(o,a){E(o,e,a);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);s=!0},p(o,a){a&7&&(r=Ne(o[0]),se(),t=Ht(t,a,i,1,o,r,l,e,Kt,cs,null,fs),ne())},i(o){if(!s){for(let a=0;a<r.length;a+=1)v(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)M(t[a]);s=!1},d(o){o&&m(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function ga(n){let e,t;return e=new $t({props:{className:"size-4"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p:Ee,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function _a(n){let e,t,l,s;const r=[va,pa,ba],i=[];function o(a,f){var u,c;return(u=a[6].result)!=null&&u.error?0:(c=a[6].result)!=null&&c.output?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=he()},l(a){t.l(a),l=he()},m(a,f){i[e].m(a,f),E(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e!==u&&(se(),M(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t||(t=i[e]=r[e](a),t.c()),v(t,1),t.m(l.parentNode,l))},i(a){s||(v(t),s=!0)},o(a){M(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function ba(n){let e,t;return e=new xr({}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function pa(n){let e,t;return e=new $r({props:{strokeWidth:"3",className:"size-3"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function va(n){let e,t;return e=new Wt({}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function cs(n,e){let t,l,s,r,i,o,a,f=e[6].name+"",u,c,g,h,_,C;const p=[_a,ga],N=[];function D(O,A){var w;return(w=O[6])!=null&&w.result?0:1}r=D(e),i=N[r]=p[r](e);function L(){return e[4](e[6])}return{key:n,first:null,c(){t=y("div"),l=y("button"),s=y("div"),i.c(),o=j(),a=y("div"),u=U(f),g=j(),this.h()},l(O){t=I(O,"DIV",{class:!0});var A=k(t);l=I(A,"BUTTON",{class:!0});var w=k(l);s=I(w,"DIV",{class:!0});var V=k(s);i.l(V),V.forEach(m),o=H(w),a=I(w,"DIV",{class:!0});var T=k(a);u=W(T,f),T.forEach(m),w.forEach(m),g=H(A),A.forEach(m),this.h()},h(){var O;d(s,"class","bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center"),d(a,"class",c="flex-1 mx-2 line-clamp-1 code-execution-name "+((O=e[6])!=null&&O.result?"":"pulse")+" svelte-1gvtig2"),d(l,"class","flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96"),d(t,"class","flex gap-1 text-xs font-semibold"),this.first=t},m(O,A){E(O,t,A),b(t,l),b(l,s),N[r].m(s,null),b(l,o),b(l,a),b(a,u),b(t,g),h=!0,_||(C=me(l,"click",L),_=!0)},p(O,A){var V;e=O;let w=r;r=D(e),r===w?N[r].p(e,A):(se(),M(N[w],1,1,()=>{N[w]=null}),ne(),i=N[r],i?i.p(e,A):(i=N[r]=p[r](e),i.c()),v(i,1),i.m(s,null)),(!h||A&1)&&f!==(f=e[6].name+"")&&G(u,f),(!h||A&1&&c!==(c="flex-1 mx-2 line-clamp-1 code-execution-name "+((V=e[6])!=null&&V.result?"":"pulse")+" svelte-1gvtig2"))&&d(a,"class",c)},i(O){h||(v(i),h=!0)},o(O){M(i),h=!1},d(O){O&&m(t),N[r].d(),_=!1,C()}}}function ka(n){let e,t,l,s,r;function i(f){n[3](f)}let o={codeExecution:n[1]};n[2]!==void 0&&(o.show=n[2]),e=new ma({props:o}),He.push(()=>Xe(e,"show",i));let a=n[0].length>0&&us(n);return{c(){$(e.$$.fragment),l=j(),a&&a.c(),s=he()},l(f){x(e.$$.fragment,f),l=H(f),a&&a.l(f),s=he()},m(f,u){ee(e,f,u),E(f,l,u),a&&a.m(f,u),E(f,s,u),r=!0},p(f,[u]){const c={};u&2&&(c.codeExecution=f[1]),!t&&u&4&&(t=!0,c.show=f[2],Qe(()=>t=!1)),e.$set(c),f[0].length>0?a?(a.p(f,u),u&1&&v(a,1)):(a=us(f),a.c(),v(a,1),a.m(s.parentNode,s)):a&&(se(),M(a,1,1,()=>{a=null}),ne())},i(f){r||(v(e.$$.fragment,f),v(a),r=!0)},o(f){M(e.$$.fragment,f),M(a),r=!1},d(f){f&&(m(l),m(s)),te(e,f),a&&a.d(f)}}}function wa(n,e,t){let{codeExecutions:l=[]}=e,s=null,r=!1;const i=()=>{s&&t(1,s=l.find(f=>f.id===s.id))};function o(f){r=f,t(2,r)}const a=f=>{t(1,s=f),t(2,r=!0)};return n.$$set=f=>{"codeExecutions"in f&&t(0,l=f.codeExecutions)},n.$$.update=()=>{n.$$.dirty&1&&l&&i()},[l,s,r,o,a]}class ya extends Pe{constructor(e){super(),Ae(this,e,wa,ka,Te,{codeExecutions:0})}}function Ia(n){let e,t;return{c(){e=ke("svg"),t=ke("path"),this.h()},l(l){e=we(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=we(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){E(l,e,s),b(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:Ee,o:Ee,d(l){l&&m(e)}}}function Ma(n,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class Ea extends Pe{constructor(e){super(),Ae(this,e,Ma,Ia,Te,{className:0,strokeWidth:1})}}function Na(n){let e,t,l,s,r,i,o,a,f,u,c,g;s=new Ct({props:{id:`${n[0]}-float-prompt`,content:n[4]}});const h=[Ca,Va],_=[];function C(N,D){return D&32&&(a=null),a==null&&(a=N[5].trim()===""),a?0:1}f=C(n,-1),u=_[f]=h[f](n);let p=n[6]&&ds(n);return{c(){e=y("div"),t=y("div"),l=y("div"),$(s.$$.fragment),r=j(),i=y("div"),o=y("div"),u.c(),c=j(),p&&p.c(),this.h()},l(N){e=I(N,"DIV",{class:!0});var D=k(e);t=I(D,"DIV",{class:!0});var L=k(t);l=I(L,"DIV",{class:!0});var O=k(l);x(s.$$.fragment,O),O.forEach(m),L.forEach(m),r=H(D),i=I(D,"DIV",{class:!0});var A=k(i);o=I(A,"DIV",{class:!0,id:!0});var w=k(o);u.l(w),c=H(w),p&&p.l(w),w.forEach(m),A.forEach(m),D.forEach(m),this.h()},h(){d(l,"class","font-medium"),d(t,"class","bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),d(o,"class","max-h-80 overflow-y-auto w-full markdown-prose-xs"),d(o,"id","response-container"),d(i,"class","bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),d(e,"class","bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full")},m(N,D){E(N,e,D),b(e,t),b(t,l),ee(s,l,null),b(e,r),b(e,i),b(i,o),_[f].m(o,null),b(o,c),p&&p.m(o,null),g=!0},p(N,D){const L={};D&1&&(L.id=`${N[0]}-float-prompt`),D&16&&(L.content=N[4]),s.$set(L);let O=f;f=C(N,D),f===O?_[f].p(N,D):(se(),M(_[O],1,1,()=>{_[O]=null}),ne(),u=_[f],u?u.p(N,D):(u=_[f]=h[f](N),u.c()),v(u,1),u.m(o,c)),N[6]?p?p.p(N,D):(p=ds(N),p.c(),p.m(o,null)):p&&(p.d(1),p=null)},i(N){g||(v(s.$$.fragment,N),v(u),g=!0)},o(N){M(s.$$.fragment,N),M(u),g=!1},d(N){N&&m(e),te(s),_[f].d(),p&&p.d()}}}function Da(n){let e,t,l,s;const r=[Ta,Sa],i=[];function o(a,f){return a[1]?1:0}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=he()},l(a){t.l(a),l=he()},m(a,f){i[e].m(a,f),E(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(se(),M(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),v(t,1),t.m(l.parentNode,l))},i(a){s||(v(t),s=!0)},o(a){M(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function Va(n){let e,t;return e=new Ct({props:{id:`${n[0]}-float-response`,content:n[5]}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s&1&&(r.id=`${l[0]}-float-response`),s&32&&(r.content=l[5]),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Ca(n){let e,t;return e=new Xt({props:{size:"sm"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p:Ee,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function ds(n){let e,t,l=n[7].t("Add")+"",s,r,i;return{c(){e=y("div"),t=y("button"),s=U(l),this.h()},l(o){e=I(o,"DIV",{class:!0});var a=k(e);t=I(a,"BUTTON",{class:!0});var f=k(t);s=W(f,l),f.forEach(m),a.forEach(m),this.h()},h(){d(t,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),d(e,"class","flex justify-end pt-3 text-sm font-medium")},m(o,a){E(o,e,a),b(e,t),b(t,s),r||(i=me(t,"click",n[11]),r=!0)},p(o,a){a&128&&l!==(l=o[7].t("Add")+"")&&G(s,l)},d(o){o&&m(e),r=!1,i()}}}function Sa(n){let e,t,l,s,r,i,o,a,f,u,c;return{c(){e=y("div"),t=y("input"),s=j(),r=y("div"),i=y("button"),o=ke("svg"),a=ke("path"),this.h()},l(g){e=I(g,"DIV",{class:!0});var h=k(e);t=I(h,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),s=H(h),r=I(h,"DIV",{class:!0});var _=k(r);i=I(_,"BUTTON",{class:!0});var C=k(i);o=we(C,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var p=k(o);a=we(p,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(a).forEach(m),p.forEach(m),C.forEach(m),_.forEach(m),h.forEach(m),this.h()},h(){d(t,"type","text"),d(t,"id","floating-message-input"),d(t,"class","ml-5 bg-transparent outline-hidden w-full flex-1 text-sm"),d(t,"placeholder",l=n[7].t("Ask a question")),d(a,"fill-rule","evenodd"),d(a,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),d(a,"clip-rule","evenodd"),d(o,"xmlns","http://www.w3.org/2000/svg"),d(o,"viewBox","0 0 16 16"),d(o,"fill","currentColor"),d(o,"class","size-4"),d(i,"class",f=(n[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),d(r,"class","ml-1 mr-2"),d(e,"class","py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border border-gray-100 dark:border-gray-850 w-72 rounded-full shadow-xl")},m(g,h){E(g,e,h),b(e,t),ut(t,n[3]),b(e,s),b(e,r),b(r,i),b(i,o),b(o,a),u||(c=[me(t,"input",n[18]),me(t,"keydown",n[19]),me(i,"click",n[20])],u=!0)},p(g,h){h&128&&l!==(l=g[7].t("Ask a question"))&&d(t,"placeholder",l),h&8&&t.value!==g[3]&&ut(t,g[3]),h&8&&f!==(f=(g[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&d(i,"class",f)},i:Ee,o:Ee,d(g){g&&m(e),u=!1,Ye(c)}}}function Ta(n){let e,t,l,s,r,i=n[7].t("Ask")+"",o,a,f,u,c,g,h=n[7].t("Explain")+"",_,C,p,N;return l=new Ea({props:{className:"size-3 shrink-0"}}),u=new Gr({props:{className:"size-3 shrink-0"}}),{c(){e=y("div"),t=y("button"),$(l.$$.fragment),s=j(),r=y("div"),o=U(i),a=j(),f=y("button"),$(u.$$.fragment),c=j(),g=y("div"),_=U(h),this.h()},l(D){e=I(D,"DIV",{class:!0});var L=k(e);t=I(L,"BUTTON",{class:!0});var O=k(t);x(l.$$.fragment,O),s=H(O),r=I(O,"DIV",{class:!0});var A=k(r);o=W(A,i),A.forEach(m),O.forEach(m),a=H(L),f=I(L,"BUTTON",{class:!0});var w=k(f);x(u.$$.fragment,w),c=H(w),g=I(w,"DIV",{class:!0});var V=k(g);_=W(V,h),V.forEach(m),w.forEach(m),L.forEach(m),this.h()},h(){d(r,"class","shrink-0"),d(t,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),d(g,"class","shrink-0"),d(f,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),d(e,"class","flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl")},m(D,L){E(D,e,L),b(e,t),ee(l,t,null),b(t,s),b(t,r),b(r,o),b(e,a),b(e,f),ee(u,f,null),b(f,c),b(f,g),b(g,_),C=!0,p||(N=[me(t,"click",n[16]),me(f,"click",n[17])],p=!0)},p(D,L){(!C||L&128)&&i!==(i=D[7].t("Ask")+"")&&G(o,i),(!C||L&128)&&h!==(h=D[7].t("Explain")+"")&&G(_,h)},i(D){C||(v(l.$$.fragment,D),v(u.$$.fragment,D),C=!0)},o(D){M(l.$$.fragment,D),M(u.$$.fragment,D),C=!1},d(D){D&&m(e),te(l),te(u),p=!1,Ye(N)}}}function Ba(n){let e,t,l,s,r;const i=[Da,Na],o=[];function a(f,u){return f[5]===null?0:1}return t=a(n),l=o[t]=i[t](n),{c(){e=y("div"),l.c(),this.h()},l(f){e=I(f,"DIV",{id:!0,class:!0,style:!0});var u=k(e);l.l(u),u.forEach(m),this.h()},h(){d(e,"id",s=`floating-buttons-${n[0]}`),d(e,"class","absolute rounded-lg mt-1 text-xs z-9999"),At(e,"display","none")},m(f,u){E(f,e,u),o[t].m(e,null),r=!0},p(f,[u]){let c=t;t=a(f),t===c?o[t].p(f,u):(se(),M(o[c],1,1,()=>{o[c]=null}),ne(),l=o[t],l?l.p(f,u):(l=o[t]=i[t](f),l.c()),v(l,1),l.m(e,null)),(!r||u&1&&s!==(s=`floating-buttons-${f[0]}`))&&d(e,"id",s)},i(f){r||(v(l),r=!0)},o(f){M(l),r=!1},d(f){f&&m(e),o[t].d()}}}function Ra(n,e,t){let l;const s=Fe("i18n");Me(n,s,S=>t(7,l=S));let{id:r=""}=e,{model:i=null}=e,{messages:o=[]}=e,{onAdd:a=()=>{}}=e,f=!1,u="",c="",g="",h=null,_=!1;const C=async()=>{const S=document.getElementById("response-container");S.scrollHeight-S.clientHeight<=S.scrollTop+50&&(S.scrollTop=S.scrollHeight)},p=async()=>{if(!i){Le.error("Model not selected");return}t(4,g=[...u.split(`
`).map(R=>`> ${R}`),"",c].join(`
`)),t(3,c=""),t(5,h="");const[S,B]=await Ml(localStorage.token,{model:i,messages:[...o,{role:"user",content:g}].map(R=>({role:R.role,content:R.content})),stream:!0});if(S&&S.ok){const R=S.body.getReader(),q=new TextDecoder;await(async()=>{var F,X;for(;;){const{done:ae,value:de}=await R.read();if(ae)break;const pe=q.decode(de,{stream:!0}).split(`
`).filter(Y=>Y.trim()!=="");for(const Y of pe)if(Y.startsWith("data: "))if(Y.startsWith("data: [DONE]")){t(6,_=!0),await Ce(),C();continue}else try{const re=JSON.parse(Y.slice(6));re.choices&&((X=(F=re.choices[0])==null?void 0:F.delta)!=null&&X.content)&&(t(5,h+=re.choices[0].delta.content),C())}catch(re){console.error(re)}}})()}else Le.error("An error occurred while fetching the explanation")},N=async()=>{if(!i){Le.error("Model not selected");return}const S=u.split(`
`).map(q=>`> ${q}`).join(`
`);t(4,g=`${S}

Explain`),t(5,h="");const[B,R]=await Ml(localStorage.token,{model:i,messages:[...o,{role:"user",content:g}].map(q=>({role:q.role,content:q.content})),stream:!0});if(B&&B.ok){const q=B.body.getReader(),le=new TextDecoder;await(async()=>{var X,ae;for(;;){const{done:de,value:ge}=await q.read();if(de)break;const Y=le.decode(ge,{stream:!0}).split(`
`).filter(re=>re.trim()!=="");for(const re of Y)if(re.startsWith("data: "))if(re.startsWith("data: [DONE]")){t(6,_=!0),await Ce(),C();continue}else try{const be=JSON.parse(re.slice(6));be.choices&&((ae=(X=be.choices[0])==null?void 0:X.delta)!=null&&ae.content)&&(t(5,h+=be.choices[0].delta.content),C())}catch(be){console.error(be)}}})()}else Le.error("An error occurred while fetching the explanation")},D=async()=>{a({modelId:i,parentId:r,messages:[{role:"user",content:g},{role:"assistant",content:h}]})},L=()=>{t(5,h=null),t(6,_=!1),t(1,f=!1),t(3,c="")},O=async()=>{t(2,u=window.getSelection().toString()),t(1,f=!0),await Ce(),setTimeout(()=>{const S=document.getElementById("floating-message-input");S&&S.focus()},0)},A=()=>{t(2,u=window.getSelection().toString()),N()};function w(){c=this.value,t(3,c)}const V=S=>{S.key==="Enter"&&p()},T=()=>{p()};return n.$$set=S=>{"id"in S&&t(0,r=S.id),"model"in S&&t(12,i=S.model),"messages"in S&&t(13,o=S.messages),"onAdd"in S&&t(14,a=S.onAdd)},[r,f,u,c,g,h,_,l,s,p,N,D,i,o,a,L,O,A,w,V,T]}class Oa extends Pe{constructor(e){super(),Ae(this,e,Ra,Ba,Te,{id:0,model:12,messages:13,onAdd:14,closeHandler:15})}get closeHandler(){return this.$$.ctx[15]}}function hs(n){var s,r,i;let e,t,l={id:n[0],model:(n[3]??[]).includes((s=n[4])==null?void 0:s.id)?(r=n[4])==null?void 0:r.id:(n[3]??[]).length>0?n[3].at(0):(i=n[4])==null?void 0:i.id,messages:Gt(n[2],n[0]),onAdd:n[23]};return e=new Oa({props:l}),n[24](e),{c(){$(e.$$.fragment)},l(o){x(e.$$.fragment,o)},m(o,a){ee(e,o,a),t=!0},p(o,a){var u,c,g;const f={};a&1&&(f.id=o[0]),a&24&&(f.model=(o[3]??[]).includes((u=o[4])==null?void 0:u.id)?(c=o[4])==null?void 0:c.id:(o[3]??[]).length>0?o[3].at(0):(g=o[4])==null?void 0:g.id),a&5&&(f.messages=Gt(o[2],o[0])),a&4096&&(f.onAdd=o[23]),e.$set(f)},i(o){t||(v(e.$$.fragment,o),t=!0)},o(o){M(e.$$.fragment,o),t=!1},d(o){n[24](null),te(e,o)}}}function Pa(n){let e,t,l,s,r;t=new Ct({props:{id:n[0],content:n[1],model:n[4],save:n[6],preview:n[7],sourceIds:(n[5]??[]).reduce(n[19],[]),onSourceClick:n[10],onTaskClick:n[11],onSave:n[9],onUpdate:n[20],onPreview:n[21]}});let i=n[8]&&n[4]&&hs(n);return{c(){e=y("div"),$(t.$$.fragment),l=j(),i&&i.c(),s=he()},l(o){e=I(o,"DIV",{});var a=k(e);x(t.$$.fragment,a),a.forEach(m),l=H(o),i&&i.l(o),s=he()},m(o,a){E(o,e,a),ee(t,e,null),n[22](e),E(o,l,a),i&&i.m(o,a),E(o,s,a),r=!0},p(o,[a]){const f={};a&1&&(f.id=o[0]),a&2&&(f.content=o[1]),a&16&&(f.model=o[4]),a&64&&(f.save=o[6]),a&128&&(f.preview=o[7]),a&48&&(f.sourceIds=(o[5]??[]).reduce(o[19],[])),a&1024&&(f.onSourceClick=o[10]),a&2048&&(f.onTaskClick=o[11]),a&512&&(f.onSave=o[9]),a&229376&&(f.onUpdate=o[20]),t.$set(f),o[8]&&o[4]?i?(i.p(o,a),a&272&&v(i,1)):(i=hs(o),i.c(),v(i,1),i.m(s.parentNode,s)):i&&(se(),M(i,1,1,()=>{i=null}),ne())},i(o){r||(v(t.$$.fragment,o),v(i),r=!0)},o(o){M(t.$$.fragment,o),M(i),r=!1},d(o){o&&(m(e),m(l),m(s)),te(t),n[22](null),i&&i.d(o)}}}function Aa(n,e,t){let l,s,r;Me(n,zn,F=>t(15,l=F)),Me(n,bt,F=>t(16,s=F)),Me(n,Br,F=>t(17,r=F)),Fe("i18n");let{id:i}=e,{content:o}=e,{history:a}=e,{selectedModels:f=[]}=e,{model:u=null}=e,{sources:c=null}=e,{save:g=!1}=e,{preview:h=!1}=e,{floatingButtons:_=!0}=e,{onSave:C=F=>{}}=e,{onSourceClick:p=F=>{}}=e,{onTaskClick:N=F=>{}}=e,{onAddMessages:D=F=>{}}=e,L,O;const A=F=>{const X=document.getElementById(`floating-buttons-${i}`);if(!(L!=null&&L.contains(F.target))&&!(X!=null&&X.contains(F.target))){w();return}setTimeout(async()=>{if(await Ce(),!(L!=null&&L.contains(F.target)))return;let ae=window.getSelection();if(ae.toString().trim().length>0){const ge=ae.getRangeAt(0).getBoundingClientRect(),pe=L.getBoundingClientRect(),Y=ge.bottom-pe.top,re=ge.left-pe.left;if(X){X.style.display="block";const be=pe.width-re;let fe=l?window.innerWidth/2:window.innerWidth/3;if(be<fe){const ce=pe.right-ge.right;X.style.right=`${ce}px`,X.style.left="auto"}else X.style.left=`${re}px`,X.style.right="auto";X.style.top=`${Y+5}px`}}else w()},0)},w=()=>{const F=document.getElementById(`floating-buttons-${i}`);F&&(F.style.display="none"),O&&typeof(O==null?void 0:O.closeHandler)=="function"&&(O==null||O.closeHandler())},V=F=>{F.key==="Escape"&&w()};yt(()=>{_&&(L==null||L.addEventListener("mouseup",A),document.addEventListener("mouseup",A),document.addEventListener("keydown",V))}),Dr(()=>{_&&(L==null||L.removeEventListener("mouseup",A),document.removeEventListener("mouseup",A),document.removeEventListener("keydown",V))});const T=(F,X)=>{let ae=[];return X.document.forEach((de,ge)=>{var re,be,fe,ce,ye;if(((fe=(be=(re=u==null?void 0:u.info)==null?void 0:re.meta)==null?void 0:be.capabilities)==null?void 0:fe.citations)==!1)return ae.push("N/A"),ae;const pe=(ce=X.metadata)==null?void 0:ce[ge],Y=(pe==null?void 0:pe.source)??"N/A";return pe!=null&&pe.name?(ae.push(pe.name),ae):(Y.startsWith("http://")||Y.startsWith("https://")?ae.push(Y):ae.push(((ye=X==null?void 0:X.source)==null?void 0:ye.name)??Y),ae)}),F=[...F,...ae],F.filter((de,ge)=>F.indexOf(de)===ge)},S=F=>{const{lang:X,text:ae}=F;((s==null?void 0:s.detectArtifacts)??!0)&&(["html","svg"].includes(X)||X==="xml"&&ae.includes("svg"))&&!l&&r&&(_l.set(!0),bl.set(!0))},B=async F=>{await Rr.set(F),await bl.set(!0),await _l.set(!0),await Or.set(!1)};function R(F){He[F?"unshift":"push"](()=>{L=F,t(13,L)})}const q=({modelId:F,parentId:X,messages:ae})=>{D({modelId:F,parentId:X,messages:ae}),w()};function le(F){He[F?"unshift":"push"](()=>{O=F,t(14,O)})}return n.$$set=F=>{"id"in F&&t(0,i=F.id),"content"in F&&t(1,o=F.content),"history"in F&&t(2,a=F.history),"selectedModels"in F&&t(3,f=F.selectedModels),"model"in F&&t(4,u=F.model),"sources"in F&&t(5,c=F.sources),"save"in F&&t(6,g=F.save),"preview"in F&&t(7,h=F.preview),"floatingButtons"in F&&t(8,_=F.floatingButtons),"onSave"in F&&t(9,C=F.onSave),"onSourceClick"in F&&t(10,p=F.onSourceClick),"onTaskClick"in F&&t(11,N=F.onTaskClick),"onAddMessages"in F&&t(12,D=F.onAddMessages)},[i,o,a,f,u,c,g,h,_,C,p,N,D,L,O,l,s,r,w,T,S,B,R,q,le]}class La extends Pe{constructor(e){super(),Ae(this,e,Aa,Pa,Te,{id:0,content:1,history:2,selectedModels:3,model:4,sources:5,save:6,preview:7,floatingButtons:8,onSave:9,onSourceClick:10,onTaskClick:11,onAddMessages:12})}}function ja(n){let e,t;return{c(){e=ke("svg"),t=ke("path"),this.h()},l(l){e=we(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var s=k(e);t=we(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"fill-rule","evenodd"),d(t,"d","M2.75 2a.75.75 0 0 1 .75.75v6.5h7.94l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H2.75A.75.75 0 0 1 2 10V2.75A.75.75 0 0 1 2.75 2Z"),d(t,"clip-rule","evenodd"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"viewBox","0 0 16 16"),d(e,"fill","currentColor"),d(e,"class",n[0])},m(l,s){E(l,e,s),b(e,t)},p(l,[s]){s&1&&d(e,"class",l[0])},i:Ee,o:Ee,d(l){l&&m(e)}}}function Ha(n,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class za extends Pe{constructor(e){super(),Ae(this,e,Ha,ja,Te,{className:0,strokeWidth:1})}}function ms(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function gs(n){let e;return{c(){e=y("hr"),this.h()},l(t){e=I(t,"HR",{class:!0}),this.h()},h(){d(e,"class","border-gray-100 dark:border-gray-850")},m(t,l){E(t,e,l)},d(t){t&&m(e)}}}function _s(n,e){let t,l,s,r,i=e[5]+"",o,a,f,u,c,g,h,_;l=new za({props:{className:"size-3.5"}});function C(){return e[4](e[5])}let p=e[7]<e[0].length-1&&gs();return{key:n,first:null,c(){t=y("div"),$(l.$$.fragment),s=j(),r=y("div"),o=U(i),u=j(),p&&p.c(),c=he(),this.h()},l(N){t=I(N,"DIV",{class:!0,title:!0,"aria-label":!0});var D=k(t);x(l.$$.fragment,D),s=H(D),r=I(D,"DIV",{class:!0});var L=k(r);o=W(L,i),L.forEach(m),D.forEach(m),u=H(N),p&&p.l(N),c=he(),this.h()},h(){d(r,"class","line-clamp-1"),d(t,"class","mr-2 py-1.5 bg-transparent text-left text-sm flex items-center gap-2 px-1.5 text-gray-500 dark:text-gray-400 hover:text-black dark:hover:text-white transition cursor-pointer"),d(t,"title",a=e[5]),d(t,"aria-label",f=e[5]),this.first=t},m(N,D){E(N,t,D),ee(l,t,null),b(t,s),b(t,r),b(r,o),E(N,u,D),p&&p.m(N,D),E(N,c,D),g=!0,h||(_=me(t,"click",C),h=!0)},p(N,D){e=N,(!g||D&1)&&i!==(i=e[5]+"")&&G(o,i),(!g||D&1&&a!==(a=e[5]))&&d(t,"title",a),(!g||D&1&&f!==(f=e[5]))&&d(t,"aria-label",f),e[7]<e[0].length-1?p||(p=gs(),p.c(),p.m(c.parentNode,c)):p&&(p.d(1),p=null)},i(N){g||(v(l.$$.fragment,N),g=!0)},o(N){M(l.$$.fragment,N),g=!1},d(N){N&&(m(t),m(u),m(c)),te(l),p&&p.d(N),h=!1,_()}}}function Ua(n){let e,t,l=n[2].t("Follow up")+"",s,r,i,o=[],a=new Map,f,u=Ne(n[0]);const c=g=>g[7];for(let g=0;g<u.length;g+=1){let h=ms(n,u,g),_=c(h);a.set(_,o[g]=_s(_,h))}return{c(){e=y("div"),t=y("div"),s=U(l),r=j(),i=y("div");for(let g=0;g<o.length;g+=1)o[g].c();this.h()},l(g){e=I(g,"DIV",{class:!0});var h=k(e);t=I(h,"DIV",{class:!0});var _=k(t);s=W(_,l),_.forEach(m),r=H(h),i=I(h,"DIV",{class:!0});var C=k(i);for(let p=0;p<o.length;p+=1)o[p].l(C);C.forEach(m),h.forEach(m),this.h()},h(){d(t,"class","text-sm font-medium"),d(i,"class","flex flex-col text-left gap-1 mt-1.5"),d(e,"class","mt-4")},m(g,h){E(g,e,h),b(e,t),b(t,s),b(e,r),b(e,i);for(let _=0;_<o.length;_+=1)o[_]&&o[_].m(i,null);f=!0},p(g,[h]){(!f||h&4)&&l!==(l=g[2].t("Follow up")+"")&&G(s,l),h&3&&(u=Ne(g[0]),se(),o=Ht(o,h,c,1,g,u,a,i,Kt,_s,null,ms),ne())},i(g){if(!f){for(let h=0;h<u.length;h+=1)v(o[h]);f=!0}},o(g){for(let h=0;h<o.length;h+=1)M(o[h]);f=!1},d(g){g&&m(e);for(let h=0;h<o.length;h+=1)o[h].d()}}}function Wa(n,e,t){let l;const s=Fe("i18n");Me(n,s,a=>t(2,l=a));let{followUps:r=[]}=e,{onClick:i=()=>{}}=e;const o=a=>i(a);return n.$$set=a=>{"followUps"in a&&t(0,r=a.followUps),"onClick"in a&&t(1,i=a.onClick)},[r,i,l,s,o]}class qa extends Pe{constructor(e){super(),Ae(this,e,Wa,Ua,Te,{followUps:0,onClick:1})}}function bs(n,e,t){const l=n.slice();return l[90]=e[t],l}function ps(n,e,t){const l=n.slice();return l[93]=e[t],l}function qt(n){var l,s,r;const e=n.slice(),t=(((l=e[14])==null?void 0:l.statusHistory)??[...(s=e[14])!=null&&s.status?[(r=e[14])==null?void 0:r.status]:[]]).at(-1);return e[96]=t,e}function Fa(n){var s;let e,t=(((s=n[18])==null?void 0:s.name)??n[14].model)+"",l;return{c(){e=y("span"),l=U(t),this.h()},l(r){e=I(r,"SPAN",{class:!0});var i=k(e);l=W(i,t),i.forEach(m),this.h()},h(){d(e,"class","line-clamp-1 text-black dark:text-white")},m(r,i){E(r,e,i),b(e,l)},p(r,i){var o;i[0]&278528&&t!==(t=(((o=r[18])==null?void 0:o.name)??r[14].model)+"")&&G(l,t)},d(r){r&&m(e)}}}function vs(n){let e,t,l;return t=new Be({props:{content:it(n[14].timestamp*1e3).format("LLLL"),$$slots:{default:[Ja]},$$scope:{ctx:n}}}),{c(){e=y("div"),$(t.$$.fragment),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=k(e);x(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){E(s,e,r),ee(t,e,null),l=!0},p(s,r){const i={};r[0]&16384&&(i.content=it(s[14].timestamp*1e3).format("LLLL")),r[0]&16384|r[3]&16&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(v(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),te(t)}}}function Ja(n){let e,t=wt(n[14].timestamp*1e3)+"",l;return{c(){e=y("span"),l=U(t),this.h()},l(s){e=I(s,"SPAN",{class:!0});var r=k(e);l=W(r,t),r.forEach(m),this.h()},h(){d(e,"class","line-clamp-1")},m(s,r){E(s,e,r),b(e,l)},p(s,r){r[0]&16384&&t!==(t=wt(s[14].timestamp*1e3)+"")&&G(l,t)},d(s){s&&m(e)}}}function Ga(n){var i;let e,t,l,s;e=new Be({props:{content:((i=n[18])==null?void 0:i.name)??n[14].model,placement:"top-start",$$slots:{default:[Fa]},$$scope:{ctx:n}}});let r=n[14].timestamp&&vs(n);return{c(){$(e.$$.fragment),t=j(),r&&r.c(),l=he()},l(o){x(e.$$.fragment,o),t=H(o),r&&r.l(o),l=he()},m(o,a){ee(e,o,a),E(o,t,a),r&&r.m(o,a),E(o,l,a),s=!0},p(o,a){var u;const f={};a[0]&278528&&(f.content=((u=o[18])==null?void 0:u.name)??o[14].model),a[0]&278528|a[3]&16&&(f.$$scope={dirty:a,ctx:o}),e.$set(f),o[14].timestamp?r?(r.p(o,a),a[0]&16384&&v(r,1)):(r=vs(o),r.c(),v(r,1),r.m(l.parentNode,l)):r&&(se(),M(r,1,1,()=>{r=null}),ne())},i(o){s||(v(e.$$.fragment,o),v(r),s=!0)},o(o){M(e.$$.fragment,o),M(r),s=!1},d(o){o&&(m(t),m(l)),te(e,o),r&&r.d(o)}}}function ks(n){var s;let e,t,l=!((s=n[96])!=null&&s.hidden)&&ws(n);return{c(){l&&l.c(),e=he()},l(r){l&&l.l(r),e=he()},m(r,i){l&&l.m(r,i),E(r,e,i),t=!0},p(r,i){var o;(o=r[96])!=null&&o.hidden?l&&(se(),M(l,1,1,()=>{l=null}),ne()):l?(l.p(r,i),i[0]&16384&&v(l,1)):(l=ws(r),l.c(),v(l,1),l.m(e.parentNode,e))},i(r){t||(v(l),t=!0)},o(r){M(l),t=!1},d(r){r&&m(e),l&&l.d(r)}}}function ws(n){let e,t,l,s;const r=[Qa,Za,Ka],i=[];function o(a,f){var u,c,g;return((u=a[96])==null?void 0:u.action)==="web_search"&&((c=a[96])!=null&&c.urls)?0:((g=a[96])==null?void 0:g.action)==="knowledge_search"?1:2}return t=o(n),l=i[t]=r[t](n),{c(){e=y("div"),l.c(),this.h()},l(a){e=I(a,"DIV",{class:!0});var f=k(e);l.l(f),f.forEach(m),this.h()},h(){d(e,"class","status-description flex items-center gap-2 py-0.5")},m(a,f){E(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t===u?i[t].p(a,f):(se(),M(i[u],1,1,()=>{i[u]=null}),ne(),l=i[t],l?l.p(a,f):(l=i[t]=r[t](a),l.c()),v(l,1),l.m(e,null))},i(a){s||(v(l),s=!0)},o(a){M(l),s=!1},d(a){a&&m(e),i[t].d()}}}function Ka(n){let e,t,l,s;function r(a,f){var u,c,g,h;return f[0]&16384&&(l=null),l==null&&(l=!!((u=a[96])!=null&&u.description.includes("{{searchQuery}}"))),l?eo:((c=a[96])==null?void 0:c.description)==="No search query generated"?xa:((g=a[96])==null?void 0:g.description)==="Generating search query"?$a:((h=a[96])==null?void 0:h.description)==="Searching the web"?Ya:Xa}let i=r(n,[-1,-1,-1,-1]),o=i(n);return{c(){e=y("div"),t=y("div"),o.c(),this.h()},l(a){e=I(a,"DIV",{class:!0});var f=k(e);t=I(f,"DIV",{class:!0});var u=k(t);o.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var a;d(t,"class",s=(((a=n[96])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){E(a,e,f),b(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&16384&&s!==(s=(((u=a[96])==null?void 0:u.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&d(t,"class",s)},i:Ee,o:Ee,d(a){a&&m(e),o.d()}}}function Za(n){let e,t,l=n[29].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:n[96].query})+"",s,r;return{c(){e=y("div"),t=y("div"),s=U(l),this.h()},l(i){e=I(i,"DIV",{class:!0});var o=k(e);t=I(o,"DIV",{class:!0});var a=k(t);s=W(a,l),a.forEach(m),o.forEach(m),this.h()},h(){var i;d(t,"class",r=(((i=n[96])==null?void 0:i.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(i,o){E(i,e,o),b(e,t),b(t,s)},p(i,o){var a;o[0]&536887296&&l!==(l=i[29].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:i[96].query})+"")&&G(s,l),o[0]&16384&&r!==(r=(((a=i[96])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&d(t,"class",r)},i:Ee,o:Ee,d(i){i&&m(e)}}}function Qa(n){let e,t;return e=new Ci({props:{status:n[96],$$slots:{default:[ro]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&16384&&(r.status=l[96]),s[0]&536887296|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Xa(n){var l;let e=((l=n[96])==null?void 0:l.description)+"",t;return{c(){t=U(e)},l(s){t=W(s,e)},m(s,r){E(s,t,r)},p(s,r){var i;r[0]&16384&&e!==(e=((i=s[96])==null?void 0:i.description)+"")&&G(t,e)},d(s){s&&m(t)}}}function Ya(n){let e=n[29].t("Searching the web...")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s[0]&536870912&&e!==(e=l[29].t("Searching the web...")+"")&&G(t,e)},d(l){l&&m(t)}}}function $a(n){let e=n[29].t("Generating search query")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s[0]&536870912&&e!==(e=l[29].t("Generating search query")+"")&&G(t,e)},d(l){l&&m(t)}}}function xa(n){let e=n[29].t("No search query generated")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s[0]&536870912&&e!==(e=l[29].t("No search query generated")+"")&&G(t,e)},d(l){l&&m(t)}}}function eo(n){var l,s;let e=n[29].t((l=n[96])==null?void 0:l.description,{searchQuery:(s=n[96])==null?void 0:s.query})+"",t;return{c(){t=U(e)},l(r){t=W(r,e)},m(r,i){E(r,t,i)},p(r,i){var o,a;i[0]&536887296&&e!==(e=r[29].t((o=r[96])==null?void 0:o.description,{searchQuery:(a=r[96])==null?void 0:a.query})+"")&&G(t,e)},d(r){r&&m(t)}}}function to(n){var l;let e=((l=n[96])==null?void 0:l.description)+"",t;return{c(){t=U(e)},l(s){t=W(s,e)},m(s,r){E(s,t,r)},p(s,r){var i;r[0]&16384&&e!==(e=((i=s[96])==null?void 0:i.description)+"")&&G(t,e)},d(s){s&&m(t)}}}function lo(n){let e=n[29].t("Generating search query")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s[0]&536870912&&e!==(e=l[29].t("Generating search query")+"")&&G(t,e)},d(l){l&&m(t)}}}function so(n){let e=n[29].t("No search query generated")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s[0]&536870912&&e!==(e=l[29].t("No search query generated")+"")&&G(t,e)},d(l){l&&m(t)}}}function no(n){var l,s;let e=n[29].t((l=n[96])==null?void 0:l.description,{count:(s=n[96])==null?void 0:s.urls.length})+"",t;return{c(){t=U(e)},l(r){t=W(r,e)},m(r,i){E(r,t,i)},p(r,i){var o,a;i[0]&536887296&&e!==(e=r[29].t((o=r[96])==null?void 0:o.description,{count:(a=r[96])==null?void 0:a.urls.length})+"")&&G(t,e)},d(r){r&&m(t)}}}function ro(n){let e,t,l,s;function r(a,f){var u,c,g;return f[0]&16384&&(l=null),l==null&&(l=!!((u=a[96])!=null&&u.description.includes("{{count}}"))),l?no:((c=a[96])==null?void 0:c.description)==="No search query generated"?so:((g=a[96])==null?void 0:g.description)==="Generating search query"?lo:to}let i=r(n,[-1,-1,-1,-1]),o=i(n);return{c(){e=y("div"),t=y("div"),o.c(),this.h()},l(a){e=I(a,"DIV",{class:!0});var f=k(e);t=I(f,"DIV",{class:!0});var u=k(t);o.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var a;d(t,"class",s=(((a=n[96])==null?void 0:a.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){E(a,e,f),b(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&16384&&s!==(s=(((u=a[96])==null?void 0:u.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap")&&d(t,"class",s)},d(a){a&&m(e),o.d()}}}function ys(n){let e,t,l=Ne(n[14].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Is(ps(n,l,i));const r=i=>M(s[i],1,1,()=>{s[i]=null});return{c(){e=y("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","my-1 w-full flex overflow-x-auto gap-2 flex-wrap")},m(i,o){E(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&16384){l=Ne(i[14].files);let a;for(a=0;a<l.length;a+=1){const f=ps(i,l,a);s[a]?(s[a].p(f,o),v(s[a],1)):(s[a]=Is(f),s[a].c(),v(s[a],1),s[a].m(e,null))}for(se(),a=l.length;a<s.length;a+=1)r(a);ne()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)v(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)M(s[o]);t=!1},d(i){i&&m(e),qe(s,i)}}}function io(n){var l;let e,t;return e=new el({props:{item:n[93],url:n[93].url,name:n[93].name,type:n[93].type,size:(l=n[93])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){$(e.$$.fragment)},l(s){x(e.$$.fragment,s)},m(s,r){ee(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&16384&&(i.item=s[93]),r[0]&16384&&(i.url=s[93].url),r[0]&16384&&(i.name=s[93].name),r[0]&16384&&(i.type=s[93].type),r[0]&16384&&(i.size=(o=s[93])==null?void 0:o.size),e.$set(i)},i(s){t||(v(e.$$.fragment,s),t=!0)},o(s){M(e.$$.fragment,s),t=!1},d(s){te(e,s)}}}function ao(n){let e,t;return e=new Yt({props:{src:n[93].url,alt:n[14].content}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&16384&&(r.src=l[93].url),s[0]&16384&&(r.alt=l[14].content),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Is(n){let e,t,l,s,r;const i=[ao,io],o=[];function a(f,u){return f[93].type==="image"?0:1}return t=a(n),l=o[t]=i[t](n),{c(){e=y("div"),l.c(),s=j()},l(f){e=I(f,"DIV",{});var u=k(e);l.l(u),s=H(u),u.forEach(m)},m(f,u){E(f,e,u),o[t].m(e,null),b(e,s),r=!0},p(f,u){let c=t;t=a(f),t===c?o[t].p(f,u):(se(),M(o[c],1,1,()=>{o[c]=null}),ne(),l=o[t],l?l.p(f,u):(l=o[t]=i[t](f),l.c()),v(l,1),l.m(e,s))},i(f){r||(v(l),r=!0)},o(f){M(l),r=!1},d(f){f&&m(e),o[t].d()}}}function oo(n){var _,C,p,N,D,L,O;let e,t,l,s,r,i,o;const a=[co,uo],f=[];function u(A,w){var V,T,S;return A[14].content===""&&!A[14].error&&(((V=A[14])==null?void 0:V.statusHistory)??[...(T=A[14])!=null&&T.status?[(S=A[14])==null?void 0:S.status]:[]]).length===0?0:A[14].content&&A[14].error!==!0?1:-1}~(t=u(n))&&(l=f[t]=a[t](n));let c=((_=n[14])==null?void 0:_.error)&&Ms(n),g=(((C=n[14])==null?void 0:C.sources)||((p=n[14])==null?void 0:p.citations))&&(((O=(L=(D=(N=n[18])==null?void 0:N.info)==null?void 0:D.meta)==null?void 0:L.capabilities)==null?void 0:O.citations)??!0)&&Es(n),h=n[14].code_executions&&Ns(n);return{c(){e=y("div"),l&&l.c(),s=j(),c&&c.c(),r=j(),g&&g.c(),i=j(),h&&h.c(),this.h()},l(A){e=I(A,"DIV",{class:!0,id:!0});var w=k(e);l&&l.l(w),s=H(w),c&&c.l(w),r=H(w),g&&g.l(w),i=H(w),h&&h.l(w),w.forEach(m),this.h()},h(){d(e,"class","w-full flex flex-col relative"),d(e,"id","response-content-container")},m(A,w){E(A,e,w),~t&&f[t].m(e,null),b(e,s),c&&c.m(e,null),b(e,r),g&&g.m(e,null),b(e,i),h&&h.m(e,null),o=!0},p(A,w){var T,S,B,R,q,le,F;let V=t;t=u(A),t===V?~t&&f[t].p(A,w):(l&&(se(),M(f[V],1,1,()=>{f[V]=null}),ne()),~t?(l=f[t],l?l.p(A,w):(l=f[t]=a[t](A),l.c()),v(l,1),l.m(e,s)):l=null),(T=A[14])!=null&&T.error?c?(c.p(A,w),w[0]&16384&&v(c,1)):(c=Ms(A),c.c(),v(c,1),c.m(e,r)):c&&(se(),M(c,1,1,()=>{c=null}),ne()),((S=A[14])!=null&&S.sources||(B=A[14])!=null&&B.citations)&&(((F=(le=(q=(R=A[18])==null?void 0:R.info)==null?void 0:q.meta)==null?void 0:le.capabilities)==null?void 0:F.citations)??!0)?g?(g.p(A,w),w[0]&278528&&v(g,1)):(g=Es(A),g.c(),v(g,1),g.m(e,i)):g&&(se(),M(g,1,1,()=>{g=null}),ne()),A[14].code_executions?h?(h.p(A,w),w[0]&16384&&v(h,1)):(h=Ns(A),h.c(),v(h,1),h.m(e,null)):h&&(se(),M(h,1,1,()=>{h=null}),ne())},i(A){o||(v(l),v(c),v(g),v(h),o=!0)},o(A){M(l),M(c),M(g),M(h),o=!1},d(A){A&&m(e),~t&&f[t].d(),c&&c.d(),g&&g.d(),h&&h.d()}}}function fo(n){let e,t,l,s,r,i,o,a=n[29].t("Save As Copy")+"",f,u,c,g,h=n[29].t("Cancel")+"",_,C,p,N=n[29].t("Save")+"",D,L,O;return{c(){e=y("div"),t=y("textarea"),s=j(),r=y("div"),i=y("div"),o=y("button"),f=U(a),u=j(),c=y("div"),g=y("button"),_=U(h),C=j(),p=y("button"),D=U(N),this.h()},l(A){e=I(A,"DIV",{class:!0});var w=k(e);t=I(w,"TEXTAREA",{id:!0,class:!0}),k(t).forEach(m),s=H(w),r=I(w,"DIV",{class:!0});var V=k(r);i=I(V,"DIV",{});var T=k(i);o=I(T,"BUTTON",{id:!0,class:!0});var S=k(o);f=W(S,a),S.forEach(m),T.forEach(m),u=H(V),c=I(V,"DIV",{class:!0});var B=k(c);g=I(B,"BUTTON",{id:!0,class:!0});var R=k(g);_=W(R,h),R.forEach(m),C=H(B),p=I(B,"BUTTON",{id:!0,class:!0});var q=k(p);D=W(q,N),q.forEach(m),B.forEach(m),V.forEach(m),w.forEach(m),this.h()},h(){d(t,"id",l="message-edit-"+n[14].id),d(t,"class","bg-transparent outline-hidden w-full resize-none"),d(o,"id","save-new-message-button"),d(o,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),d(g,"id","close-edit-message-button"),d(g,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),d(p,"id","confirm-edit-message-button"),d(p,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),d(c,"class","flex space-x-1.5"),d(r,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),d(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2")},m(A,w){E(A,e,w),b(e,t),n[52](t),ut(t,n[19]),b(e,s),b(e,r),b(r,i),b(i,o),b(o,f),b(r,u),b(r,c),b(c,g),b(g,_),b(c,C),b(c,p),b(p,D),L||(O=[me(t,"input",n[53]),me(t,"input",Oo),me(t,"keydown",n[54]),me(o,"click",n[55]),me(g,"click",n[56]),me(p,"click",n[57])],L=!0)},p(A,w){w[0]&16384&&l!==(l="message-edit-"+A[14].id)&&d(t,"id",l),w[0]&524288&&ut(t,A[19]),w[0]&536870912&&a!==(a=A[29].t("Save As Copy")+"")&&G(f,a),w[0]&536870912&&h!==(h=A[29].t("Cancel")+"")&&G(_,h),w[0]&536870912&&N!==(N=A[29].t("Save")+"")&&G(D,N)},i:Ee,o:Ee,d(A){A&&m(e),n[52](null),L=!1,Ye(O)}}}function uo(n){var l;let e,t;return e=new La({props:{id:n[14].id,history:n[0],selectedModels:n[1],content:n[14].content,sources:n[14].sources,floatingButtons:((l=n[14])==null?void 0:l.done)&&!n[13],save:!n[13],preview:!n[13],model:n[18],onTaskClick:n[58],onSourceClick:n[59],onAddMessages:n[60],onSave:n[61]}}),{c(){$(e.$$.fragment)},l(s){x(e.$$.fragment,s)},m(s,r){ee(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&16384&&(i.id=s[14].id),r[0]&1&&(i.history=s[0]),r[0]&2&&(i.selectedModels=s[1]),r[0]&16384&&(i.content=s[14].content),r[0]&16384&&(i.sources=s[14].sources),r[0]&24576&&(i.floatingButtons=((o=s[14])==null?void 0:o.done)&&!s[13]),r[0]&8192&&(i.save=!s[13]),r[0]&8192&&(i.preview=!s[13]),r[0]&262144&&(i.model=s[18]),r[0]&16384&&(i.onSourceClick=s[59]),r[0]&2048&&(i.onAddMessages=s[60]),r[0]&16449&&(i.onSave=s[61]),e.$set(i)},i(s){t||(v(e.$$.fragment,s),t=!0)},o(s){M(e.$$.fragment,s),t=!1},d(s){te(e,s)}}}function co(n){let e,t;return e=new Xt({}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p:Ee,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Ms(n){var l,s;let e,t;return e=new Bi({props:{content:((s=(l=n[14])==null?void 0:l.error)==null?void 0:s.content)??n[14].content}}),{c(){$(e.$$.fragment)},l(r){x(e.$$.fragment,r)},m(r,i){ee(e,r,i),t=!0},p(r,i){var a,f;const o={};i[0]&16384&&(o.content=((f=(a=r[14])==null?void 0:a.error)==null?void 0:f.content)??r[14].content),e.$set(o)},i(r){t||(v(e.$$.fragment,r),t=!0)},o(r){M(e.$$.fragment,r),t=!1},d(r){te(e,r)}}}function Es(n){var l,s,r;let e,t;return e=new ra({props:{id:(l=n[14])==null?void 0:l.id,sources:((s=n[14])==null?void 0:s.sources)??((r=n[14])==null?void 0:r.citations)}}),{c(){$(e.$$.fragment)},l(i){x(e.$$.fragment,i)},m(i,o){ee(e,i,o),t=!0},p(i,o){var f,u,c;const a={};o[0]&16384&&(a.id=(f=i[14])==null?void 0:f.id),o[0]&16384&&(a.sources=((u=i[14])==null?void 0:u.sources)??((c=i[14])==null?void 0:c.citations)),e.$set(a)},i(i){t||(v(e.$$.fragment,i),t=!0)},o(i){M(e.$$.fragment,i),t=!1},d(i){te(e,i)}}}function Ns(n){let e,t;return e=new ya({props:{codeExecutions:n[14].code_executions}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&16384&&(r.codeExecutions=l[14].code_executions),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Ds(n){var f;let e,t,l,s,r,i=(n[14].done||n[2].length>1)&&Vs(n),o=n[14].done&&n[25]&&Ws(n),a=n[12]&&n[14].done&&!n[13]&&(((f=n[14])==null?void 0:f.followUps)??[]).length>0&&qs(n);return{c(){e=y("div"),i&&i.c(),t=j(),o&&o.c(),l=j(),a&&a.c(),s=he(),this.h()},l(u){e=I(u,"DIV",{class:!0});var c=k(e);i&&i.l(c),c.forEach(m),t=H(u),o&&o.l(u),l=H(u),a&&a.l(u),s=he(),this.h()},h(){d(e,"class","flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1u5gq5j")},m(u,c){E(u,e,c),i&&i.m(e,null),n[78](e),E(u,t,c),o&&o.m(u,c),E(u,l,c),a&&a.m(u,c),E(u,s,c),r=!0},p(u,c){var g;u[14].done||u[2].length>1?i?(i.p(u,c),c[0]&16388&&v(i,1)):(i=Vs(u),i.c(),v(i,1),i.m(e,null)):i&&(se(),M(i,1,1,()=>{i=null}),ne()),u[14].done&&u[25]?o?(o.p(u,c),c[0]&33570816&&v(o,1)):(o=Ws(u),o.c(),v(o,1),o.m(l.parentNode,l)):o&&(se(),M(o,1,1,()=>{o=null}),ne()),u[12]&&u[14].done&&!u[13]&&(((g=u[14])==null?void 0:g.followUps)??[]).length>0?a?(a.p(u,c),c[0]&28672&&v(a,1)):(a=qs(u),a.c(),v(a,1),a.m(s.parentNode,s)):a&&(se(),M(a,1,1,()=>{a=null}),ne())},i(u){r||(v(i),v(o),v(a),r=!0)},o(u){M(i),M(o),M(a),r=!1},d(u){u&&(m(e),m(t),m(l),m(s)),i&&i.d(),n[78](null),o&&o.d(u),a&&a.d(u)}}}function Vs(n){let e,t,l,s=n[2].length>1&&Cs(n),r=n[14].done&&Ss(n);return{c(){s&&s.c(),e=j(),r&&r.c(),t=he()},l(i){s&&s.l(i),e=H(i),r&&r.l(i),t=he()},m(i,o){s&&s.m(i,o),E(i,e,o),r&&r.m(i,o),E(i,t,o),l=!0},p(i,o){i[2].length>1?s?s.p(i,o):(s=Cs(i),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),i[14].done?r?(r.p(i,o),o[0]&16384&&v(r,1)):(r=Ss(i),r.c(),v(r,1),r.m(t.parentNode,t)):r&&(se(),M(r,1,1,()=>{r=null}),ne())},i(i){l||(v(r),l=!0)},o(i){M(r),l=!1},d(i){i&&(m(e),m(t)),s&&s.d(i),r&&r.d(i)}}}function Cs(n){let e,t,l,s,r,i,o,a,f,u,c,g,h;function _(N,D){return N[21]?mo:ho}let C=_(n),p=C(n);return{c(){e=y("div"),t=y("button"),l=ke("svg"),s=ke("path"),i=j(),p.c(),o=j(),a=y("button"),f=ke("svg"),u=ke("path"),this.h()},l(N){e=I(N,"DIV",{class:!0,dir:!0});var D=k(e);t=I(D,"BUTTON",{"aria-label":!0,class:!0});var L=k(t);l=we(L,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var O=k(l);s=we(O,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(s).forEach(m),O.forEach(m),L.forEach(m),i=H(D),p.l(D),o=H(D),a=I(D,"BUTTON",{class:!0,"aria-label":!0});var A=k(a);f=we(A,"svg",{xmlns:!0,fill:!0,"aria-hidden":!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var w=k(f);u=we(w,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(u).forEach(m),w.forEach(m),A.forEach(m),D.forEach(m),this.h()},h(){d(s,"stroke-linecap","round"),d(s,"stroke-linejoin","round"),d(s,"d","M15.75 19.5 8.25 12l7.5-7.5"),d(l,"aria-hidden","true"),d(l,"xmlns","http://www.w3.org/2000/svg"),d(l,"fill","none"),d(l,"viewBox","0 0 24 24"),d(l,"stroke","currentColor"),d(l,"stroke-width","2.5"),d(l,"class","size-3.5"),d(t,"aria-label",r=n[29].t("Previous message")),d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(u,"stroke-linecap","round"),d(u,"stroke-linejoin","round"),d(u,"d","m8.25 4.5 7.5 7.5-7.5 7.5"),d(f,"xmlns","http://www.w3.org/2000/svg"),d(f,"fill","none"),d(f,"aria-hidden","true"),d(f,"viewBox","0 0 24 24"),d(f,"stroke","currentColor"),d(f,"stroke-width","2.5"),d(f,"class","size-3.5"),d(a,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(a,"aria-label",c=n[29].t("Next message")),d(e,"class","flex self-center min-w-fit"),d(e,"dir","ltr")},m(N,D){E(N,e,D),b(e,t),b(t,l),b(l,s),b(e,i),p.m(e,null),b(e,o),b(e,a),b(a,f),b(f,u),g||(h=[me(t,"click",n[62]),me(a,"click",n[66])],g=!0)},p(N,D){D[0]&536870912&&r!==(r=N[29].t("Previous message"))&&d(t,"aria-label",r),C===(C=_(N))&&p?p.p(N,D):(p.d(1),p=C(N),p&&(p.c(),p.m(e,o))),D[0]&536870912&&c!==(c=N[29].t("Next message"))&&d(a,"aria-label",c)},d(N){N&&m(e),p.d(),g=!1,Ye(h)}}}function ho(n){let e,t=n[2].indexOf(n[14].id)+1+"",l,s,r=n[2].length+"",i,o,a;return{c(){e=y("div"),l=U(t),s=U("/"),i=U(r),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);l=W(u,t),s=W(u,"/"),i=W(u,r),u.forEach(m),this.h()},h(){d(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){E(f,e,u),b(e,l),b(e,s),b(e,i),o||(a=me(e,"dblclick",n[65]),o=!0)},p(f,u){u[0]&16388&&t!==(t=f[2].indexOf(f[14].id)+1+"")&&G(l,t),u[0]&4&&r!==(r=f[2].length+"")&&G(i,r)},d(f){f&&m(e),o=!1,a()}}}function mo(n){let e,t,l,s,r,i,o=n[2].length+"",a,f,u;return{c(){e=y("div"),t=y("input"),i=U("/"),a=U(o),this.h()},l(c){e=I(c,"DIV",{class:!0});var g=k(e);t=I(g,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=W(g,"/"),a=W(g,o),g.forEach(m),this.h()},h(){d(t,"id",l="message-index-input-"+n[14].id),d(t,"type","number"),t.value=s=n[2].indexOf(n[14].id)+1,d(t,"min","1"),d(t,"max",r=n[2].length),d(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),d(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,g){E(c,e,g),b(e,t),b(e,i),b(e,a),f||(u=[me(t,"focus",Po),me(t,"blur",n[63]),me(t,"keydown",n[64])],f=!0)},p(c,g){g[0]&16384&&l!==(l="message-index-input-"+c[14].id)&&d(t,"id",l),g[0]&16388&&s!==(s=c[2].indexOf(c[14].id)+1)&&t.value!==s&&(t.value=s),g[0]&4&&r!==(r=c[2].length)&&d(t,"max",r),g[0]&4&&o!==(o=c[2].length+"")&&G(a,o)},d(c){c&&m(e),f=!1,Ye(u)}}}function Ss(n){var _,C,p,N,D,L,O,A,w;let e,t,l,s,r,i,o,a,f=!n[13]&&Ts(n);t=new Be({props:{content:n[29].t("Copy"),placement:"bottom",$$slots:{default:[_o]},$$scope:{ctx:n}}});let u=(((_=n[30])==null?void 0:_.role)==="admin"||(((N=(p=(C=n[30])==null?void 0:C.permissions)==null?void 0:p.chat)==null?void 0:N.tts)??!0))&&Rs(n),c=((D=n[28])==null?void 0:D.features.enable_image_generation)&&(((L=n[30])==null?void 0:L.role)==="admin"||((w=(A=(O=n[30])==null?void 0:O.permissions)==null?void 0:A.features)==null?void 0:w.image_generation))&&!n[13]&&Os(n),g=n[14].usage&&Ps(n),h=!n[13]&&As(n);return{c(){f&&f.c(),e=j(),$(t.$$.fragment),l=j(),u&&u.c(),s=j(),c&&c.c(),r=j(),g&&g.c(),i=j(),h&&h.c(),o=he()},l(V){f&&f.l(V),e=H(V),x(t.$$.fragment,V),l=H(V),u&&u.l(V),s=H(V),c&&c.l(V),r=H(V),g&&g.l(V),i=H(V),h&&h.l(V),o=he()},m(V,T){f&&f.m(V,T),E(V,e,T),ee(t,V,T),E(V,l,T),u&&u.m(V,T),E(V,s,T),c&&c.m(V,T),E(V,r,T),g&&g.m(V,T),E(V,i,T),h&&h.m(V,T),E(V,o,T),a=!0},p(V,T){var B,R,q,le,F,X,ae,de,ge;V[13]?f&&(se(),M(f,1,1,()=>{f=null}),ne()):f?(f.p(V,T),T[0]&8192&&v(f,1)):(f=Ts(V),f.c(),v(f,1),f.m(e.parentNode,e));const S={};T[0]&536870912&&(S.content=V[29].t("Copy")),T[0]&536891392|T[3]&16&&(S.$$scope={dirty:T,ctx:V}),t.$set(S),((B=V[30])==null?void 0:B.role)==="admin"||(((le=(q=(R=V[30])==null?void 0:R.permissions)==null?void 0:q.chat)==null?void 0:le.tts)??!0)?u?(u.p(V,T),T[0]&1073741824&&v(u,1)):(u=Rs(V),u.c(),v(u,1),u.m(s.parentNode,s)):u&&(se(),M(u,1,1,()=>{u=null}),ne()),(F=V[28])!=null&&F.features.enable_image_generation&&(((X=V[30])==null?void 0:X.role)==="admin"||(ge=(de=(ae=V[30])==null?void 0:ae.permissions)==null?void 0:de.features)!=null&&ge.image_generation)&&!V[13]?c?(c.p(V,T),T[0]&1342185472&&v(c,1)):(c=Os(V),c.c(),v(c,1),c.m(r.parentNode,r)):c&&(se(),M(c,1,1,()=>{c=null}),ne()),V[14].usage?g?(g.p(V,T),T[0]&16384&&v(g,1)):(g=Ps(V),g.c(),v(g,1),g.m(i.parentNode,i)):g&&(se(),M(g,1,1,()=>{g=null}),ne()),V[13]?h&&(se(),M(h,1,1,()=>{h=null}),ne()):h?(h.p(V,T),T[0]&8192&&v(h,1)):(h=As(V),h.c(),v(h,1),h.m(o.parentNode,o))},i(V){a||(v(f),v(t.$$.fragment,V),v(u),v(c),v(g),v(h),a=!0)},o(V){M(f),M(t.$$.fragment,V),M(u),M(c),M(g),M(h),a=!1},d(V){V&&(m(e),m(l),m(s),m(r),m(i),m(o)),f&&f.d(V),te(t,V),u&&u.d(V),c&&c.d(V),g&&g.d(V),h&&h.d(V)}}}function Ts(n){var s,r,i,o;let e,t,l=(((s=n[30])==null?void 0:s.role)==="user"?((o=(i=(r=n[30])==null?void 0:r.permissions)==null?void 0:i.chat)==null?void 0:o.edit)??!0:!0)&&Bs(n);return{c(){l&&l.c(),e=he()},l(a){l&&l.l(a),e=he()},m(a,f){l&&l.m(a,f),E(a,e,f),t=!0},p(a,f){var u,c,g,h;((u=a[30])==null?void 0:u.role)!=="user"||(((h=(g=(c=a[30])==null?void 0:c.permissions)==null?void 0:g.chat)==null?void 0:h.edit)??!0)?l?(l.p(a,f),f[0]&1073741824&&v(l,1)):(l=Bs(a),l.c(),v(l,1),l.m(e.parentNode,e)):l&&(se(),M(l,1,1,()=>{l=null}),ne())},i(a){t||(v(l),t=!0)},o(a){M(l),t=!1},d(a){a&&m(e),l&&l.d(a)}}}function Bs(n){let e,t;return e=new Be({props:{content:n[29].t("Edit"),placement:"bottom",$$slots:{default:[go]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&536870912&&(r.content=l[29].t("Edit")),s[0]&536875008|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function go(n){let e,t,l,s,r,i,o;return{c(){e=y("button"),t=ke("svg"),l=ke("path"),this.h()},l(a){e=I(a,"BUTTON",{"aria-label":!0,class:!0});var f=k(e);t=we(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,"aria-hidden":!0,stroke:!0,class:!0});var u=k(t);l=we(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"aria-hidden","true"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"aria-label",s=n[29].t("Edit")),d(e,"class",r=(n[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(a,f){E(a,e,f),b(e,t),b(t,l),i||(o=me(e,"click",n[67]),i=!0)},p(a,f){f[0]&536870912&&s!==(s=a[29].t("Edit"))&&d(e,"aria-label",s),f[0]&4096&&r!==(r=(a[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",r)},d(a){a&&m(e),i=!1,o()}}}function _o(n){let e,t,l,s,r,i,o;return{c(){e=y("button"),t=ke("svg"),l=ke("path"),this.h()},l(a){e=I(a,"BUTTON",{"aria-label":!0,class:!0});var f=k(e);t=we(f,"svg",{xmlns:!0,fill:!0,"aria-hidden":!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=we(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"aria-hidden","true"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"aria-label",s=n[29].t("Copy")),d(e,"class",r=(n[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")},m(a,f){E(a,e,f),b(e,t),b(t,l),i||(o=me(e,"click",n[68]),i=!0)},p(a,f){f[0]&536870912&&s!==(s=a[29].t("Copy"))&&d(e,"aria-label",s),f[0]&4096&&r!==(r=(a[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")&&d(e,"class",r)},d(a){a&&m(e),i=!1,o()}}}function Rs(n){let e,t;return e=new Be({props:{content:n[29].t("Read Aloud"),placement:"bottom",$$slots:{default:[ko]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&536870912&&(r.content=l[29].t("Read Aloud")),s[0]&549474304|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function bo(n){let e,t;return{c(){e=ke("svg"),t=ke("path"),this.h()},l(l){e=we(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"aria-hidden":!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=we(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"aria-hidden","true"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){E(l,e,s),b(e,t)},d(l){l&&m(e)}}}function po(n){let e,t;return{c(){e=ke("svg"),t=ke("path"),this.h()},l(l){e=we(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"aria-hidden":!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=we(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"aria-hidden","true"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){E(l,e,s),b(e,t)},d(l){l&&m(e)}}}function vo(n){let e,t,l,s,r,i;return{c(){e=ke("svg"),t=ke("style"),l=U(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=ke("circle"),r=ke("circle"),i=ke("circle"),this.h()},l(o){e=we(o,"svg",{class:!0,fill:!0,viewBox:!0,"aria-hidden":!0,xmlns:!0});var a=k(e);t=we(a,"style",{});var f=k(t);l=W(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(m),s=we(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(m),r=we(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(m),i=we(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(m),a.forEach(m),this.h()},h(){d(s,"class","spinner_S1WN"),d(s,"cx","4"),d(s,"cy","12"),d(s,"r","3"),d(r,"class","spinner_S1WN spinner_Km9P"),d(r,"cx","12"),d(r,"cy","12"),d(r,"r","3"),d(i,"class","spinner_S1WN spinner_JApP"),d(i,"cx","20"),d(i,"cy","12"),d(i,"r","3"),d(e,"class","w-4 h-4"),d(e,"fill","currentColor"),d(e,"viewBox","0 0 24 24"),d(e,"aria-hidden","true"),d(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){E(o,e,a),b(e,t),b(t,l),b(e,s),b(e,r),b(e,i)},d(o){o&&m(e)}}}function ko(n){let e,t,l,s,r,i;function o(u,c){return u[23]?vo:u[22]?po:bo}let a=o(n),f=a(n);return{c(){e=y("button"),f.c(),this.h()},l(u){e=I(u,"BUTTON",{"aria-label":!0,id:!0,class:!0});var c=k(e);f.l(c),c.forEach(m),this.h()},h(){d(e,"aria-label",t=n[29].t("Read Aloud")),d(e,"id",l="speak-button-"+n[14].id),d(e,"class",s=(n[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(u,c){E(u,e,c),f.m(e,null),r||(i=me(e,"click",n[69]),r=!0)},p(u,c){a!==(a=o(u))&&(f.d(1),f=a(u),f&&(f.c(),f.m(e,null))),c[0]&536870912&&t!==(t=u[29].t("Read Aloud"))&&d(e,"aria-label",t),c[0]&16384&&l!==(l="speak-button-"+u[14].id)&&d(e,"id",l),c[0]&4096&&s!==(s=(u[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",s)},d(u){u&&m(e),f.d(),r=!1,i()}}}function Os(n){let e,t;return e=new Be({props:{content:n[29].t("Generate Image"),placement:"bottom",$$slots:{default:[Io]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&536870912&&(r.content=l[29].t("Generate Image")),s[0]&553668608|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function wo(n){let e,t;return{c(){e=ke("svg"),t=ke("path"),this.h()},l(l){e=we(l,"svg",{xmlns:!0,fill:!0,"aria-hidden":!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=we(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"aria-hidden","true"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){E(l,e,s),b(e,t)},d(l){l&&m(e)}}}function yo(n){let e,t,l,s,r,i;return{c(){e=ke("svg"),t=ke("style"),l=U(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=ke("circle"),r=ke("circle"),i=ke("circle"),this.h()},l(o){e=we(o,"svg",{"aria-hidden":!0,class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=k(e);t=we(a,"style",{});var f=k(t);l=W(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(m),s=we(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(s).forEach(m),r=we(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(r).forEach(m),i=we(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),k(i).forEach(m),a.forEach(m),this.h()},h(){d(s,"class","spinner_S1WN"),d(s,"cx","4"),d(s,"cy","12"),d(s,"r","3"),d(r,"class","spinner_S1WN spinner_Km9P"),d(r,"cx","12"),d(r,"cy","12"),d(r,"r","3"),d(i,"class","spinner_S1WN spinner_JApP"),d(i,"cx","20"),d(i,"cy","12"),d(i,"r","3"),d(e,"aria-hidden","true"),d(e,"class","w-4 h-4"),d(e,"fill","currentColor"),d(e,"viewBox","0 0 24 24"),d(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){E(o,e,a),b(e,t),b(t,l),b(e,s),b(e,r),b(e,i)},d(o){o&&m(e)}}}function Io(n){let e,t,l,s,r;function i(f,u){return f[24]?yo:wo}let o=i(n),a=o(n);return{c(){e=y("button"),a.c(),this.h()},l(f){e=I(f,"BUTTON",{"aria-label":!0,class:!0});var u=k(e);a.l(u),u.forEach(m),this.h()},h(){d(e,"aria-label",t=n[29].t("Generate Image")),d(e,"class",l=(n[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(f,u){E(f,e,u),a.m(e,null),s||(r=me(e,"click",n[70]),s=!0)},p(f,u){o!==(o=i(f))&&(a.d(1),a=o(f),a&&(a.c(),a.m(e,null))),u[0]&536870912&&t!==(t=f[29].t("Generate Image"))&&d(e,"aria-label",t),u[0]&4096&&l!==(l=(f[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",l)},d(f){f&&m(e),a.d(),s=!1,r()}}}function Ps(n){let e,t;return e=new Be({props:{content:n[14].usage?`<pre>${kt(JSON.stringify(n[14].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Ks).map(Zs).join(`
`))}</pre>`:"",placement:"bottom",$$slots:{default:[Mo]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&16384&&(r.content=l[14].usage?`<pre>${kt(JSON.stringify(l[14].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Ks).map(Zs).join(`
`))}</pre>`:""),s[0]&20480|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Mo(n){let e,t,l,s,r,i,o;return{c(){e=y("button"),t=ke("svg"),l=ke("path"),this.h()},l(a){e=I(a,"BUTTON",{"aria-hidden":!0,class:!0,id:!0});var f=k(e);t=we(f,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=k(t);l=we(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"),d(t,"aria-hidden","true"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"aria-hidden","true"),d(e,"class",s=(n[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap"),d(e,"id",r="info-"+n[14].id)},m(a,f){E(a,e,f),b(e,t),b(t,l),i||(o=me(e,"click",n[71]),i=!0)},p(a,f){f[0]&4096&&s!==(s=(a[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap")&&d(e,"class",s),f[0]&16384&&r!==(r="info-"+a[14].id)&&d(e,"id",r)},d(a){a&&m(e),i=!1,o()}}}function As(n){var g;let e,t,l,s,r,i,o,a=!n[31]&&(((g=n[28])==null?void 0:g.features.enable_message_rating)??!0)&&Ls(n),f=n[12]&&js(n);l=new Be({props:{content:n[29].t("Regenerate"),placement:"bottom",$$slots:{default:[Vo]},$$scope:{ctx:n}}});let u=n[2].length>1&&Hs(n),c=n[12]&&zs(n);return{c(){a&&a.c(),e=j(),f&&f.c(),t=j(),$(l.$$.fragment),s=j(),u&&u.c(),r=j(),c&&c.c(),i=he()},l(h){a&&a.l(h),e=H(h),f&&f.l(h),t=H(h),x(l.$$.fragment,h),s=H(h),u&&u.l(h),r=H(h),c&&c.l(h),i=he()},m(h,_){a&&a.m(h,_),E(h,e,_),f&&f.m(h,_),E(h,t,_),ee(l,h,_),E(h,s,_),u&&u.m(h,_),E(h,r,_),c&&c.m(h,_),E(h,i,_),o=!0},p(h,_){var p;!h[31]&&(((p=h[28])==null?void 0:p.features.enable_message_rating)??!0)?a?(a.p(h,_),_[0]&268435456|_[1]&1&&v(a,1)):(a=Ls(h),a.c(),v(a,1),a.m(e.parentNode,e)):a&&(se(),M(a,1,1,()=>{a=null}),ne()),h[12]?f?(f.p(h,_),_[0]&4096&&v(f,1)):(f=js(h),f.c(),v(f,1),f.m(t.parentNode,t)):f&&(se(),M(f,1,1,()=>{f=null}),ne());const C={};_[0]&536870912&&(C.content=h[29].t("Regenerate")),_[0]&570708992|_[3]&16&&(C.$$scope={dirty:_,ctx:h}),l.$set(C),h[2].length>1?u?(u.p(h,_),_[0]&4&&v(u,1)):(u=Hs(h),u.c(),v(u,1),u.m(r.parentNode,r)):u&&(se(),M(u,1,1,()=>{u=null}),ne()),h[12]?c?(c.p(h,_),_[0]&4096&&v(c,1)):(c=zs(h),c.c(),v(c,1),c.m(i.parentNode,i)):c&&(se(),M(c,1,1,()=>{c=null}),ne())},i(h){o||(v(a),v(f),v(l.$$.fragment,h),v(u),v(c),o=!0)},o(h){M(a),M(f),M(l.$$.fragment,h),M(u),M(c),o=!1},d(h){h&&(m(e),m(t),m(s),m(r),m(i)),a&&a.d(h),f&&f.d(h),te(l,h),u&&u.d(h),c&&c.d(h)}}}function Ls(n){let e,t,l,s;return e=new Be({props:{content:n[29].t("Good Response"),placement:"bottom",$$slots:{default:[Eo]},$$scope:{ctx:n}}}),l=new Be({props:{content:n[29].t("Bad Response"),placement:"bottom",$$slots:{default:[No]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment),t=j(),$(l.$$.fragment)},l(r){x(e.$$.fragment,r),t=H(r),x(l.$$.fragment,r)},m(r,i){ee(e,r,i),E(r,t,i),ee(l,r,i),s=!0},p(r,i){const o={};i[0]&536870912&&(o.content=r[29].t("Good Response")),i[0]&604000256|i[3]&16&&(o.$$scope={dirty:i,ctx:r}),e.$set(o);const a={};i[0]&536870912&&(a.content=r[29].t("Bad Response")),i[0]&604000256|i[3]&16&&(a.$$scope={dirty:i,ctx:r}),l.$set(a)},i(r){s||(v(e.$$.fragment,r),v(l.$$.fragment,r),s=!0)},o(r){M(e.$$.fragment,r),M(l.$$.fragment,r),s=!1},d(r){r&&m(t),te(e,r),te(l,r)}}}function Eo(n){let e,t,l,s,r,i,o;return{c(){e=y("button"),t=ke("svg"),l=ke("path"),this.h()},l(a){e=I(a,"BUTTON",{"aria-label":!0,class:!0});var f=k(e);t=we(f,"svg",{"aria-hidden":!0,stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var u=k(t);l=we(u,"path",{d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){var a,f;d(l,"d","M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"),d(t,"aria-hidden","true"),d(t,"stroke","currentColor"),d(t,"fill","none"),d(t,"stroke-width","2.3"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"class","w-4 h-4"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(e,"aria-label",s=n[29].t("Good Response")),d(e,"class",r=(n[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((f=(a=n[14])==null?void 0:a.annotation)==null?void 0:f.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[26]},m(a,f){E(a,e,f),b(e,t),b(t,l),i||(o=me(e,"click",n[72]),i=!0)},p(a,f){var u,c;f[0]&536870912&&s!==(s=a[29].t("Good Response"))&&d(e,"aria-label",s),f[0]&20480&&r!==(r=(a[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((c=(u=a[14])==null?void 0:u.annotation)==null?void 0:c.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&d(e,"class",r),f[0]&67108864&&(e.disabled=a[26])},d(a){a&&m(e),i=!1,o()}}}function No(n){let e,t,l,s,r,i,o;return{c(){e=y("button"),t=ke("svg"),l=ke("path"),this.h()},l(a){e=I(a,"BUTTON",{"aria-label":!0,class:!0});var f=k(e);t=we(f,"svg",{"aria-hidden":!0,stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var u=k(t);l=we(u,"path",{d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){var a,f;d(l,"d","M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"),d(t,"aria-hidden","true"),d(t,"stroke","currentColor"),d(t,"fill","none"),d(t,"stroke-width","2.3"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"class","w-4 h-4"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(e,"aria-label",s=n[29].t("Bad Response")),d(e,"class",r=(n[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((f=(a=n[14])==null?void 0:a.annotation)==null?void 0:f.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[26]},m(a,f){E(a,e,f),b(e,t),b(t,l),i||(o=me(e,"click",n[73]),i=!0)},p(a,f){var u,c;f[0]&536870912&&s!==(s=a[29].t("Bad Response"))&&d(e,"aria-label",s),f[0]&20480&&r!==(r=(a[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((c=(u=a[14])==null?void 0:u.annotation)==null?void 0:c.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&d(e,"class",r),f[0]&67108864&&(e.disabled=a[26])},d(a){a&&m(e),i=!1,o()}}}function js(n){let e,t;return e=new Be({props:{content:n[29].t("Continue Response"),placement:"bottom",$$slots:{default:[Do]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&536870912&&(r.content=l[29].t("Continue Response")),s[0]&536875520|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Do(n){let e,t,l,s,r,i,o,a;return{c(){e=y("button"),t=ke("svg"),l=ke("path"),s=ke("path"),this.h()},l(f){e=I(f,"BUTTON",{"aria-label":!0,type:!0,id:!0,class:!0});var u=k(e);t=we(u,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var c=k(t);l=we(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),s=we(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(s).forEach(m),c.forEach(m),u.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),d(s,"stroke-linecap","round"),d(s,"stroke-linejoin","round"),d(s,"d","M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"),d(t,"aria-hidden","true"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"aria-label",r=n[29].t("Continue Response")),d(e,"type","button"),d(e,"id","continue-response-button"),d(e,"class",i=(n[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(f,u){E(f,e,u),b(e,t),b(t,l),b(t,s),o||(a=me(e,"click",n[74]),o=!0)},p(f,u){u[0]&536870912&&r!==(r=f[29].t("Continue Response"))&&d(e,"aria-label",r),u[0]&4096&&i!==(i=(f[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",i)},d(f){f&&m(e),o=!1,a()}}}function Vo(n){let e,t,l,s,r,i,o;return{c(){e=y("button"),t=ke("svg"),l=ke("path"),this.h()},l(a){e=I(a,"BUTTON",{type:!0,"aria-label":!0,class:!0});var f=k(e);t=we(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,"aria-hidden":!0,stroke:!0,class:!0});var u=k(t);l=we(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"aria-hidden","true"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"aria-label",s=n[29].t("Regenerate")),d(e,"class",r=(n[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,f){E(a,e,f),b(e,t),b(t,l),i||(o=me(e,"click",n[75]),i=!0)},p(a,f){f[0]&536870912&&s!==(s=a[29].t("Regenerate"))&&d(e,"aria-label",s),f[0]&4096&&r!==(r=(a[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",r)},d(a){a&&m(e),i=!1,o()}}}function Hs(n){let e,t;return e=new Be({props:{content:n[29].t("Delete"),placement:"bottom",$$slots:{default:[Co]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&536870912&&(r.content=l[29].t("Delete")),s[0]&537006080|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Co(n){let e,t,l,s,r,i,o;return{c(){e=y("button"),t=ke("svg"),l=ke("path"),this.h()},l(a){e=I(a,"BUTTON",{type:!0,"aria-label":!0,id:!0,class:!0});var f=k(e);t=we(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,"aria-hidden":!0,class:!0});var u=k(t);l=we(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2"),d(t,"stroke","currentColor"),d(t,"aria-hidden","true"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"aria-label",s=n[29].t("Delete")),d(e,"id","delete-response-button"),d(e,"class",r=(n[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,f){E(a,e,f),b(e,t),b(t,l),i||(o=me(e,"click",n[76]),i=!0)},p(a,f){f[0]&536870912&&s!==(s=a[29].t("Delete"))&&d(e,"aria-label",s),f[0]&4096&&r!==(r=(a[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",r)},d(a){a&&m(e),i=!1,o()}}}function zs(n){var i;let e,t,l=Ne(((i=n[18])==null?void 0:i.actions)??[]),s=[];for(let o=0;o<l.length;o+=1)s[o]=Us(bs(n,l,o));const r=o=>M(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=he()},l(o){for(let a=0;a<s.length;a+=1)s[a].l(o);e=he()},m(o,a){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(o,a);E(o,e,a),t=!0},p(o,a){var f;if(a[0]&282752){l=Ne(((f=o[18])==null?void 0:f.actions)??[]);let u;for(u=0;u<l.length;u+=1){const c=bs(o,l,u);s[u]?(s[u].p(c,a),v(s[u],1)):(s[u]=Us(c),s[u].c(),v(s[u],1),s[u].m(e.parentNode,e))}for(se(),u=l.length;u<s.length;u+=1)r(u);ne()}},i(o){if(!t){for(let a=0;a<l.length;a+=1)v(s[a]);t=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)M(s[a]);t=!1},d(o){o&&m(e),qe(s,o)}}}function So(n){let e,t;return e=new Xr({props:{strokeWidth:"2.1",className:"size-4"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p:Ee,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function To(n){let e,t,l,s,r;return{c(){e=y("div"),t=y("img"),this.h()},l(i){e=I(i,"DIV",{class:!0});var o=k(e);t=I(o,"IMG",{src:!0,class:!0,style:!0,alt:!0}),o.forEach(m),this.h()},h(){Lt(t.src,l=n[90].icon)||d(t,"src",l),d(t,"class",s="w-4 h-4 "+(n[90].icon.includes("svg")?"dark:invert-[80%]":"")),At(t,"fill","currentColor"),d(t,"alt",r=n[90].name),d(e,"class","size-4")},m(i,o){E(i,e,o),b(e,t)},p(i,o){o[0]&262144&&!Lt(t.src,l=i[90].icon)&&d(t,"src",l),o[0]&262144&&s!==(s="w-4 h-4 "+(i[90].icon.includes("svg")?"dark:invert-[80%]":""))&&d(t,"class",s),o[0]&262144&&r!==(r=i[90].name)&&d(t,"alt",r)},i:Ee,o:Ee,d(i){i&&m(e)}}}function Bo(n){let e,t,l,s,r,i,o,a,f;const u=[To,So],c=[];function g(_,C){var p;return(p=_[90])!=null&&p.icon?0:1}t=g(n),l=c[t]=u[t](n);function h(){return n[77](n[90])}return{c(){e=y("button"),l.c(),i=j(),this.h()},l(_){e=I(_,"BUTTON",{type:!0,"aria-label":!0,class:!0});var C=k(e);l.l(C),C.forEach(m),i=H(_),this.h()},h(){d(e,"type","button"),d(e,"aria-label",s=n[90].name),d(e,"class",r=(n[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(_,C){E(_,e,C),c[t].m(e,null),E(_,i,C),o=!0,a||(f=me(e,"click",h),a=!0)},p(_,C){n=_;let p=t;t=g(n),t===p?c[t].p(n,C):(se(),M(c[p],1,1,()=>{c[p]=null}),ne(),l=c[t],l?l.p(n,C):(l=c[t]=u[t](n),l.c()),v(l,1),l.m(e,null)),(!o||C[0]&262144&&s!==(s=n[90].name))&&d(e,"aria-label",s),(!o||C[0]&4096&&r!==(r=(n[12]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition"))&&d(e,"class",r)},i(_){o||(v(l),o=!0)},o(_){M(l),o=!1},d(_){_&&(m(e),m(i)),c[t].d(),a=!1,f()}}}function Us(n){let e,t;return e=new Be({props:{content:n[90].name,placement:"bottom",$$slots:{default:[Bo]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&262144&&(r.content=l[90].name),s[0]&282752|s[3]&16&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Ws(n){let e,t,l,s;function r(a){n[79](a)}function i(a){n[80](a)}let o={};return n[14]!==void 0&&(o.message=n[14]),n[25]!==void 0&&(o.show=n[25]),e=new yi({props:o}),He.push(()=>Xe(e,"message",r)),He.push(()=>Xe(e,"show",i)),e.$on("save",n[81]),{c(){$(e.$$.fragment)},l(a){x(e.$$.fragment,a)},m(a,f){ee(e,a,f),s=!0},p(a,f){const u={};!t&&f[0]&16384&&(t=!0,u.message=a[14],Qe(()=>t=!1)),!l&&f[0]&33554432&&(l=!0,u.show=a[25],Qe(()=>l=!1)),e.$set(u)},i(a){s||(v(e.$$.fragment,a),s=!0)},o(a){M(e.$$.fragment,a),s=!1},d(a){te(e,a)}}}function qs(n){var r;let e,t,l,s;return t=new qa({props:{followUps:(r=n[14])==null?void 0:r.followUps,onClick:n[82]}}),{c(){e=y("div"),$(t.$$.fragment),this.h()},l(i){e=I(i,"DIV",{class:!0});var o=k(e);x(t.$$.fragment,o),o.forEach(m),this.h()},h(){d(e,"class","mt-2.5")},m(i,o){E(i,e,o),ee(t,e,null),s=!0},p(i,o){var f;const a={};o[0]&16384&&(a.followUps=(f=i[14])==null?void 0:f.followUps),o[0]&16640&&(a.onClick=i[82]),t.$set(a)},i(i){s||(v(t.$$.fragment,i),i&&(l||Et(()=>{l=Nt(e,Dt,{duration:100}),l.start()})),s=!0)},o(i){M(t.$$.fragment,i),s=!1},d(i){i&&m(e),te(t)}}}function Fs(n){var s;let e,t=(((s=n[14])==null?void 0:s.content)??"")+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(r){e=I(r,"DIV",{"aria-live":!0,class:!0});var i=k(e);l=W(i,t),i.forEach(m),this.h()},h(){d(e,"aria-live","polite"),d(e,"class","sr-only")},m(r,i){E(r,e,i),b(e,l)},p(r,i){var o;i[0]&16384&&t!==(t=(((o=r[14])==null?void 0:o.content)??"")+"")&&G(l,t)},d(r){r&&m(e)}}}function Js(n){var F,X,ae,de,ge,pe,Y,re,be;let e,t,l,s,r,i,o,a,f,u,c,g=((F=n[14])==null?void 0:F.files)&&((X=n[14].files)==null?void 0:X.filter(Gs).length)>0,h,_,C,p,N,D,L,O,A,w;l=new Fn({props:{src:((ge=(de=(ae=n[18])==null?void 0:ae.info)==null?void 0:de.meta)==null?void 0:ge.profile_image_url)??(n[29].language==="dg-DG"?`${Ze}/doge.png`:`${Ze}/favicon.png`),className:"size-8 assistant-message-profile-image"}}),i=new Qt({props:{$$slots:{default:[Ga]},$$scope:{ctx:n}}});let V=(((pe=n[14])==null?void 0:pe.statusHistory)??[...(Y=n[14])!=null&&Y.status?[(re=n[14])==null?void 0:re.status]:[]]).length>0&&ks(qt(n)),T=g&&ys(n);const S=[fo,oo],B=[];function R(fe,ce){return fe[15]===!0?0:1}_=R(n),C=B[_]=S[_](n);let q=!n[15]&&Ds(n),le=((be=n[14])==null?void 0:be.done)&&Fs(n);return{c(){e=y("div"),t=y("div"),$(l.$$.fragment),s=j(),r=y("div"),$(i.$$.fragment),o=j(),a=y("div"),f=y("div"),u=y("div"),V&&V.c(),c=j(),T&&T.c(),h=j(),C.c(),N=j(),q&&q.c(),D=j(),le&&le.c(),this.h()},l(fe){e=I(fe,"DIV",{class:!0,id:!0,dir:!0});var ce=k(e);t=I(ce,"DIV",{class:!0});var ye=k(t);x(l.$$.fragment,ye),ye.forEach(m),s=H(ce),r=I(ce,"DIV",{class:!0});var J=k(r);x(i.$$.fragment,J),o=H(J),a=I(J,"DIV",{});var oe=k(a);f=I(oe,"DIV",{class:!0});var _e=k(f);u=I(_e,"DIV",{});var P=k(u);V&&V.l(P),c=H(P),T&&T.l(P),h=H(P),C.l(P),P.forEach(m),_e.forEach(m),N=H(oe),q&&q.l(oe),oe.forEach(m),D=H(J),le&&le.l(J),J.forEach(m),ce.forEach(m),this.h()},h(){d(t,"class",Vr("shrink-0 ltr:mr-3 rtl:ml-3 hidden @lg:flex mt-1 ")+" svelte-1u5gq5j"),d(f,"class",p="chat-"+n[14].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"),d(r,"class","flex-auto w-0 pl-1 relative"),d(e,"class",L="flex w-full message-"+n[14].id+" svelte-1u5gq5j"),d(e,"id",O="message-"+n[14].id),d(e,"dir",A=n[27].chatDirection)},m(fe,ce){E(fe,e,ce),b(e,t),ee(l,t,null),b(e,s),b(e,r),ee(i,r,null),b(r,o),b(r,a),b(a,f),b(f,u),V&&V.m(u,null),b(u,c),T&&T.m(u,null),b(u,h),B[_].m(u,null),b(a,N),q&&q.m(a,null),b(r,D),le&&le.m(r,null),w=!0},p(fe,ce){var _e,P,K,Z,Q,ue,ve,Ve,De;const ye={};ce[0]&537133056&&(ye.src=((K=(P=(_e=fe[18])==null?void 0:_e.info)==null?void 0:P.meta)==null?void 0:K.profile_image_url)??(fe[29].language==="dg-DG"?`${Ze}/doge.png`:`${Ze}/favicon.png`)),l.$set(ye);const J={};ce[0]&278528|ce[3]&16&&(J.$$scope={dirty:ce,ctx:fe}),i.$set(J),(((Z=fe[14])==null?void 0:Z.statusHistory)??[...(Q=fe[14])!=null&&Q.status?[(ue=fe[14])==null?void 0:ue.status]:[]]).length>0?V?(V.p(qt(fe),ce),ce[0]&16384&&v(V,1)):(V=ks(qt(fe)),V.c(),v(V,1),V.m(u,c)):V&&(se(),M(V,1,1,()=>{V=null}),ne()),ce[0]&16384&&(g=((ve=fe[14])==null?void 0:ve.files)&&((Ve=fe[14].files)==null?void 0:Ve.filter(Gs).length)>0),g?T?(T.p(fe,ce),ce[0]&16384&&v(T,1)):(T=ys(fe),T.c(),v(T,1),T.m(u,h)):T&&(se(),M(T,1,1,()=>{T=null}),ne());let oe=_;_=R(fe),_===oe?B[_].p(fe,ce):(se(),M(B[oe],1,1,()=>{B[oe]=null}),ne(),C=B[_],C?C.p(fe,ce):(C=B[_]=S[_](fe),C.c()),v(C,1),C.m(u,null)),(!w||ce[0]&16384&&p!==(p="chat-"+fe[14].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"))&&d(f,"class",p),fe[15]?q&&(se(),M(q,1,1,()=>{q=null}),ne()):q?(q.p(fe,ce),ce[0]&32768&&v(q,1)):(q=Ds(fe),q.c(),v(q,1),q.m(a,null)),(De=fe[14])!=null&&De.done?le?le.p(fe,ce):(le=Fs(fe),le.c(),le.m(r,null)):le&&(le.d(1),le=null),(!w||ce[0]&16384&&L!==(L="flex w-full message-"+fe[14].id+" svelte-1u5gq5j"))&&d(e,"class",L),(!w||ce[0]&16384&&O!==(O="message-"+fe[14].id))&&d(e,"id",O),(!w||ce[0]&134217728&&A!==(A=fe[27].chatDirection))&&d(e,"dir",A)},i(fe){w||(v(l.$$.fragment,fe),v(i.$$.fragment,fe),v(V),v(T),v(C),v(q),w=!0)},o(fe){M(l.$$.fragment,fe),M(i.$$.fragment,fe),M(V),M(T),M(C),M(q),w=!1},d(fe){fe&&m(e),te(l),te(i),V&&V.d(),T&&T.d(),B[_].d(),q&&q.d(),le&&le.d()}}}function Ro(n){let e,t,l,s=n[14].id,r,i;function o(u){n[50](u)}let a={title:n[29].t("Delete message?")};n[17]!==void 0&&(a.show=n[17]),e=new Zn({props:a}),He.push(()=>Xe(e,"show",o)),e.$on("confirm",n[51]);let f=Js(n);return{c(){$(e.$$.fragment),l=j(),f.c(),r=he()},l(u){x(e.$$.fragment,u),l=H(u),f.l(u),r=he()},m(u,c){ee(e,u,c),E(u,l,c),f.m(u,c),E(u,r,c),i=!0},p(u,c){const g={};c[0]&536870912&&(g.title=u[29].t("Delete message?")),!t&&c[0]&131072&&(t=!0,g.show=u[17],Qe(()=>t=!1)),e.$set(g),c[0]&16384&&Te(s,s=u[14].id)?(se(),M(f,1,1,Ee),ne(),f=Js(u),f.c(),v(f,1),f.m(r.parentNode,r)):f.p(u,c)},i(u){i||(v(e.$$.fragment,u),v(f),i=!0)},o(u){M(e.$$.fragment,u),M(f),i=!1},d(u){u&&(m(l),m(r)),te(e,u),f.d(u)}}}const Gs=n=>n.type==="image",Oo=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},Po=n=>{n.target.select()},Ks=n=>n.slice(2),Zs=n=>n.endsWith(",")?n.slice(0,-1):n;function Ao(n,e,t){let l,s,r,i,o,a,f;Me(n,zt,z=>t(49,l=z)),Me(n,bt,z=>t(27,s=z)),Me(n,Un,z=>t(28,r=z)),Me(n,pl,z=>t(86,i=z)),Me(n,Ut,z=>t(30,a=z)),Me(n,Zt,z=>t(31,f=z));const u=Fe("i18n");Me(n,u,z=>t(29,o=z));const c=Vt();let{chatId:g=""}=e,{history:h}=e,{messageId:_}=e,{selectedModels:C=[]}=e,p=JSON.parse(JSON.stringify(h.messages[_])),{siblings:N}=e,{gotoMessage:D=()=>{}}=e,{showPreviousMessage:L}=e,{showNextMessage:O}=e,{updateChat:A}=e,{editMessage:w}=e,{saveMessage:V}=e,{rateMessage:T}=e,{actionMessage:S}=e,{deleteMessage:B}=e,{submitMessage:R}=e,{continueResponse:q}=e,{regenerateResponse:le}=e,{addMessages:F}=e,{isLastMessage:X=!0}=e,{readOnly:ae=!1}=e,de,ge=!1,pe=null,Y=!1,re="",be,fe=!1,ce={},ye=!1,J,oe=!1,_e=!1,P=!1;const K=async z=>{var Ie,Re;z=wl(z),(((Ie=r==null?void 0:r.ui)==null?void 0:Ie.response_watermark)??"").trim()!==""&&(z=`${z}

${(Re=r==null?void 0:r.ui)==null?void 0:Re.response_watermark}`),await Wn(z,(s==null?void 0:s.copyFormatted)??!1)&&Le.success(o.t("Copying to clipboard was successful!"))},Z=z=>new Promise(Se=>{J=z;const Ie=ce[z];if(!Ie)return Se();Ie.play(),Ie.onended=async()=>{await new Promise(Re=>setTimeout(Re,300)),Object.keys(ce).length-1===z&&t(22,ye=!1),Se()}}),Q=async()=>{var Se,Ie,Re,st,nt,Ot,ht,It,Oe,Ke,ft,Mt,Pt,tl,ll,sl,nl,rl,il,al,ol,fl,ul;if(ye){try{speechSynthesis.cancel(),J!==void 0&&ce[J]&&(ce[J].pause(),ce[J].currentTime=0)}catch{}t(22,ye=!1),J=void 0;return}if(!((p==null?void 0:p.content)??"").trim().length){Le.info(o.t("No content to speak"));return}t(22,ye=!0);const z=wl(p.content);if(r.audio.tts.engine===""){let xe=[];const pt=setInterval(()=>{var et,mt,rt;if(xe=speechSynthesis.getVoices(),xe.length>0){clearInterval(pt);const We=((et=xe==null?void 0:xe.filter(_t=>{var cl,dl,hl,ml;return _t.voiceURI===(((dl=(cl=s==null?void 0:s.audio)==null?void 0:cl.tts)==null?void 0:dl.voice)??((ml=(hl=r==null?void 0:r.audio)==null?void 0:hl.tts)==null?void 0:ml.voice))}))==null?void 0:et.at(0))??void 0,gt=new SpeechSynthesisUtterance(z);gt.rate=((rt=(mt=s.audio)==null?void 0:mt.tts)==null?void 0:rt.playbackRate)??1,gt.onend=()=>{var _t;t(22,ye=!1),s.conversationMode&&((_t=document.getElementById("voice-input-button"))==null||_t.click())},We&&(gt.voice=We),speechSynthesis.speak(gt)}},100)}else{t(23,oe=!0);const xe=zr(z,((Ie=(Se=r==null?void 0:r.audio)==null?void 0:Se.tts)==null?void 0:Ie.split_on)??"punctuation");if(!xe.length){Le.info(o.t("No content to speak")),t(22,ye=!1),t(23,oe=!1);return}ce=xe.reduce((et,mt,rt)=>(et[rt]=null,et),{});let pt=Promise.resolve();if(((st=(Re=s.audio)==null?void 0:Re.tts)==null?void 0:st.engine)==="browser-kokoro"){i||(await pl.set(new ni({dtype:((ht=(Ot=(nt=s.audio)==null?void 0:nt.tts)==null?void 0:Ot.engineConfig)==null?void 0:ht.dtype)??"fp32"})),await i.init());for(const[et,mt]of xe.entries()){const rt=await i.generate({text:mt,voice:((Oe=(It=s==null?void 0:s.audio)==null?void 0:It.tts)==null?void 0:Oe.voice)??((ft=(Ke=r==null?void 0:r.audio)==null?void 0:Ke.tts)==null?void 0:ft.voice)}).catch(We=>{console.error(We),Le.error(`${We}`),t(22,ye=!1),t(23,oe=!1)});if(rt){const We=new Audio(rt);We.playbackRate=((Pt=(Mt=s.audio)==null?void 0:Mt.tts)==null?void 0:Pt.playbackRate)??1,ce[et]=We,t(23,oe=!1),pt=pt.then(()=>Z(et))}}}else for(const[et,mt]of xe.entries()){const rt=await qr(localStorage.token,((ll=(tl=s==null?void 0:s.audio)==null?void 0:tl.tts)==null?void 0:ll.defaultVoice)===r.audio.tts.voice?((nl=(sl=s==null?void 0:s.audio)==null?void 0:sl.tts)==null?void 0:nl.voice)??((il=(rl=r==null?void 0:r.audio)==null?void 0:rl.tts)==null?void 0:il.voice):(ol=(al=r==null?void 0:r.audio)==null?void 0:al.tts)==null?void 0:ol.voice,mt).catch(We=>{console.error(We),Le.error(`${We}`),t(22,ye=!1),t(23,oe=!1)});if(rt){const We=await rt.blob(),gt=URL.createObjectURL(We),_t=new Audio(gt);_t.playbackRate=((ul=(fl=s.audio)==null?void 0:fl.tts)==null?void 0:ul.playbackRate)??1,ce[et]=_t,t(23,oe=!1),pt=pt.then(()=>Z(et))}}}};let ue=[];function ve(z){const Se=[];let Ie=0;return z=z.replace(/<details[\s\S]*?<\/details>/gi,Re=>(Se.push(Re),`<details id="__DETAIL_${Ie++}__"/>`)),ue=Se,z}function Ve(z){return z.replace(/<details id="__DETAIL_(\d+)__"\/>/g,(Ie,Re)=>ue[parseInt(Re)]||"")}const De=async()=>{t(15,Y=!0),t(19,re=ve(p.content)),await Ce(),t(20,be.style.height="",be),t(20,be.style.height=`${be.scrollHeight}px`,be)},ze=async()=>{const z=Ve(re||"");w(p.id,{content:z},!1),t(15,Y=!1),t(19,re=""),await Ce()},Ue=async()=>{const z=Ve(re||"");w(p.id,{content:z}),t(15,Y=!1),t(19,re=""),await Ce()},je=async()=>{t(15,Y=!1),t(19,re=""),await Ce()},ie=async z=>{t(24,_e=!0);const Se=await Fr(localStorage.token,z.content).catch(Ie=>{Le.error(`${Ie}`)});if(Se){const Ie=Se.map(Re=>({type:"image",url:`${Re.url}`}));V(z.id,{...z,files:Ie})}t(24,_e=!1)};let Je=!1;const Ge=async(z=null,Se=null)=>{var It;t(26,Je=!0);const Ie={...p,annotation:{...(p==null?void 0:p.annotation)??{},...z!==null?{rating:z}:{},...Se||{}}},Re=await Lr(localStorage.token,g).catch(Oe=>{Le.error(`${Oe}`)});if(!Re)return;const st=Gt(h,p.id);let nt={type:"rating",data:{...Ie!=null&&Ie.annotation?Ie.annotation:{},model_id:(p==null?void 0:p.selectedModelId)??p.model,...h.messages[p.parentId].childrenIds.length>1?{sibling_model_ids:h.messages[p.parentId].childrenIds.filter(Oe=>Oe!==p.id).map(Oe=>{var Ke;return((Ke=h.messages[Oe])==null?void 0:Ke.selectedModelId)??h.messages[Oe].model})}:{}},meta:{arena:p?p.arena:!1,model_id:p.model,message_id:p.id,message_index:st.length,chat_id:g},snapshot:{chat:Re}};const Ot=[nt.data.model_id,...nt.data.sibling_model_ids??[]].reduce((Oe,Ke)=>{var Mt;const ft=l.find(Pt=>Pt.id===Ke);return ft?Oe[ft.id]=((Mt=ft==null?void 0:ft.info)==null?void 0:Mt.base_model_id)??null:console.warn(`Model with ID ${Ke} not found`),Oe},{});nt.meta.base_models=Ot;let ht=null;if(p!=null&&p.feedbackId?ht=await Il(localStorage.token,p.feedbackId,nt).catch(Oe=>{Le.error(`${Oe}`)}):(ht=await Ur(localStorage.token,nt).catch(Oe=>{Le.error(`${Oe}`)}),ht&&(Ie.feedbackId=ht.id)),V(p.id,Ie),await Ce(),!Se&&(t(25,P=!0),!((It=Ie.annotation)!=null&&It.tags))){const Oe=await Wr(localStorage.token,p.model,st,g).catch(Ke=>(console.error(Ke),[]));Oe&&(Ie.annotation.tags=Oe,nt.data.tags=Oe,V(p.id,Ie),await Il(localStorage.token,Ie.feedbackId,nt).catch(Ke=>{Le.error(`${Ke}`)}))}t(26,Je=!1)},$e=async()=>{B(p.id)};yt(async()=>{await Ce(),de&&de.addEventListener("wheel",function(z){de.scrollWidth<=de.clientWidth||(z.preventDefault(),z.deltaY!==0&&t(16,de.scrollLeft+=z.deltaY,de))})});function lt(z){ge=z,t(17,ge)}const at=()=>{$e()};function ct(z){He[z?"unshift":"push"](()=>{be=z,t(20,be)})}function dt(){re=this.value,t(19,re)}const ot=z=>{var Re,st;z.key==="Escape"&&((Re=document.getElementById("close-edit-message-button"))==null||Re.click());const Se=z.metaKey||z.ctrlKey,Ie=z.key==="Enter";Se&&Ie&&((st=document.getElementById("confirm-edit-message-button"))==null||st.click())},St=()=>{Ue()},Tt=()=>{je()},Bt=()=>{ze()},Rt=async z=>{},Yn=async(z,Se)=>{let Ie=document.getElementById(`source-${p.id}-${Se}`);const Re=document.getElementById(`collapsible-${p.id}`);Ie?Ie.click():Re&&(Re.querySelector("div:first-child").dispatchEvent(new PointerEvent("pointerup",{})),await new Promise(st=>{requestAnimationFrame(()=>{requestAnimationFrame(st)})}),Ie=document.getElementById(`source-${p.id}-${Se}`),Ie&&Ie.click())},$n=({modelId:z,parentId:Se,messages:Ie})=>{F({modelId:z,parentId:Se,messages:Ie})},xn=({raw:z,oldContent:Se,newContent:Ie})=>{t(0,h.messages[p.id].content=h.messages[p.id].content.replace(z,z.replace(Se,Ie)),h),A()},er=()=>{L(p)},tr=z=>{D(p,z.target.value-1),t(21,fe=!1)},lr=z=>{z.key==="Enter"&&(D(p,z.target.value-1),t(21,fe=!1))},sr=async()=>{t(21,fe=!0),await Ce();const z=document.getElementById(`message-index-input-${p.id}`);z&&(z.focus(),z.select())},nr=()=>{O(p)},rr=()=>{De()},ir=()=>{K(p.content)},ar=()=>{oe||Q()},or=()=>{_e||ie(p)},fr=()=>{},ur=async()=>{await Ge(1),window.setTimeout(()=>{var z;(z=document.getElementById(`message-feedback-${p.id}`))==null||z.scrollIntoView()},0)},cr=async()=>{await Ge(-1),window.setTimeout(()=>{var z;(z=document.getElementById(`message-feedback-${p.id}`))==null||z.scrollIntoView()},0)},dr=()=>{q()},hr=()=>{t(25,P=!1),le(p),((pe==null?void 0:pe.actions)??[]).forEach(z=>{c("action",{id:z.id,event:{id:"regenerate-response",data:{messageId:p.id}}})})},mr=()=>{t(17,ge=!0)},gr=z=>{S(z.id,p)};function _r(z){He[z?"unshift":"push"](()=>{de=z,t(16,de)})}function br(z){p=z,t(14,p),t(0,h),t(44,_)}function pr(z){P=z,t(25,P)}const vr=async z=>{await Ge(null,{...z.detail})},kr=z=>{R(p==null?void 0:p.id,z)};return n.$$set=z=>{"chatId"in z&&t(43,g=z.chatId),"history"in z&&t(0,h=z.history),"messageId"in z&&t(44,_=z.messageId),"selectedModels"in z&&t(1,C=z.selectedModels),"siblings"in z&&t(2,N=z.siblings),"gotoMessage"in z&&t(3,D=z.gotoMessage),"showPreviousMessage"in z&&t(4,L=z.showPreviousMessage),"showNextMessage"in z&&t(5,O=z.showNextMessage),"updateChat"in z&&t(6,A=z.updateChat),"editMessage"in z&&t(45,w=z.editMessage),"saveMessage"in z&&t(46,V=z.saveMessage),"rateMessage"in z&&t(47,T=z.rateMessage),"actionMessage"in z&&t(7,S=z.actionMessage),"deleteMessage"in z&&t(48,B=z.deleteMessage),"submitMessage"in z&&t(8,R=z.submitMessage),"continueResponse"in z&&t(9,q=z.continueResponse),"regenerateResponse"in z&&t(10,le=z.regenerateResponse),"addMessages"in z&&t(11,F=z.addMessages),"isLastMessage"in z&&t(12,X=z.isLastMessage),"readOnly"in z&&t(13,ae=z.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&16385|n.$$.dirty[1]&8192&&h.messages&&JSON.stringify(p)!==JSON.stringify(h.messages[_])&&t(14,p=JSON.parse(JSON.stringify(h.messages[_]))),n.$$.dirty[0]&16384|n.$$.dirty[1]&262144&&t(18,pe=l.find(z=>z.id===p.model)),n.$$.dirty[0]&32768&&(Y||(async()=>await Ce())())},[h,C,N,D,L,O,A,S,R,q,le,F,X,ae,p,Y,de,ge,pe,re,be,fe,ye,oe,_e,P,Je,s,r,o,a,f,u,c,K,Q,De,ze,Ue,je,ie,Ge,$e,g,_,w,V,T,B,l,lt,at,ct,dt,ot,St,Tt,Bt,Rt,Yn,$n,xn,er,tr,lr,sr,nr,rr,ir,ar,or,fr,ur,cr,dr,hr,mr,gr,_r,br,pr,vr,kr]}class Xn extends Pe{constructor(e){super(),Ae(this,e,Ao,Ro,Te,{chatId:43,history:0,messageId:44,selectedModels:1,siblings:2,gotoMessage:3,showPreviousMessage:4,showNextMessage:5,updateChat:6,editMessage:45,saveMessage:46,rateMessage:47,actionMessage:7,deleteMessage:48,submitMessage:8,continueResponse:9,regenerateResponse:10,addMessages:11,isLastMessage:12,readOnly:13},null,[-1,-1,-1,-1])}}function Lo(n){let e,t;return{c(){e=ke("svg"),t=ke("path"),this.h()},l(l){e=we(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=k(e);t=we(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),k(t).forEach(m),s.forEach(m),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",n[1]),d(e,"stroke","currentColor"),d(e,"class",n[0])},m(l,s){E(l,e,s),b(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:Ee,o:Ee,d(l){l&&m(e)}}}function jo(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class Ho extends Pe{constructor(e){super(),Ae(this,e,jo,Lo,Te,{className:0,strokeWidth:1})}}function Ft(n){var l;const e=n.slice(),t=(l=e[0].messages[e[2]])==null?void 0:l.merged;return e[16]=t,e}function Qs(n,e,t){const l=n.slice();return l[40]=e[t],l}function Jt(n){const e=n.slice(),t=e[19][e[40]].messageIds[e[20][e[40]]];return e[43]=t,e}function Xs(n){let e,t,l,s,r,i=Ne(Object.keys(n[19])),o=[];for(let u=0;u<i.length;u+=1)o[u]=en(Qs(n,i,u));const a=u=>M(o[u],1,1,()=>{o[u]=null});let f=!n[5]&&tn(n);return{c(){e=y("div"),t=y("div");for(let u=0;u<o.length;u+=1)o[u].c();s=j(),f&&f.c(),this.h()},l(u){e=I(u,"DIV",{});var c=k(e);t=I(c,"DIV",{class:!0,id:!0});var g=k(t);for(let h=0;h<o.length;h+=1)o[h].l(g);g.forEach(m),s=H(c),f&&f.l(c),c.forEach(m),this.h()},h(){d(t,"class","flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"),d(t,"id",l="responses-container-"+n[1]+"-"+n[18].id)},m(u,c){E(u,e,c),b(e,t);for(let g=0;g<o.length;g+=1)o[g]&&o[g].m(t,null);b(e,s),f&&f.m(e,null),r=!0},p(u,c){if(c[0]&121241583){i=Ne(Object.keys(u[19]));let g;for(g=0;g<i.length;g+=1){const h=Qs(u,i,g);o[g]?(o[g].p(h,c),v(o[g],1)):(o[g]=en(h),o[g].c(),v(o[g],1),o[g].m(t,null))}for(se(),g=i.length;g<o.length;g+=1)a(g);ne()}(!r||c[0]&262146&&l!==(l="responses-container-"+u[1]+"-"+u[18].id))&&d(t,"id",l),u[5]?f&&(se(),M(f,1,1,()=>{f=null}),ne()):f?(f.p(u,c),c[0]&32&&v(f,1)):(f=tn(u),f.c(),v(f,1),f.m(e,null))},i(u){if(!r){for(let c=0;c<i.length;c+=1)v(o[c]);v(f),r=!0}},o(u){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)M(o[c]);M(f),r=!1},d(u){u&&m(e),qe(o,u),f&&f.d()}}}function Ys(n){let e,t=n[0].currentId,l,s,r,i,o,a=xs(n);function f(){return n[35](n[43])}return{c(){e=y("div"),a.c(),l=j(),this.h()},l(u){e=I(u,"DIV",{class:!0});var c=k(e);a.l(c),l=H(c),c.forEach(m),this.h()},h(){var u;d(e,"class",s="snap-center w-full max-w-full m-1 border "+(((u=n[0].messages[n[2]])==null?void 0:u.modelIdx)==n[40]?`bg-gray-50 dark:bg-gray-850 border-gray-100 dark:border-gray-800 border-2 ${n[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl")},m(u,c){E(u,e,c),a.m(e,null),b(e,l),r=!0,i||(o=me(e,"click",f),i=!0)},p(u,c){var g;n=u,c[0]&1&&Te(t,t=n[0].currentId)?(se(),M(a,1,1,Ee),ne(),a=xs(n),a.c(),v(a,1),a.m(e,l)):a.p(n,c),(!r||c[0]&2621445&&s!==(s="snap-center w-full max-w-full m-1 border "+(((g=n[0].messages[n[2]])==null?void 0:g.modelIdx)==n[40]?`bg-gray-50 dark:bg-gray-850 border-gray-100 dark:border-gray-800 border-2 ${n[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl"))&&d(e,"class",s)},i(u){r||(v(a),r=!0)},o(u){M(a),r=!1},d(u){u&&m(e),a.d(u),i=!1,o()}}}function $s(n){let e,t;function l(...o){return n[31](n[40],...o)}function s(){return n[32](n[40])}function r(){return n[33](n[40])}function i(...o){return n[34](n[40],...o)}return e=new Xn({props:{chatId:n[1],history:n[0],messageId:n[43],selectedModels:n[3],isLastMessage:!0,siblings:n[19][n[40]].messageIds,gotoMessage:l,showPreviousMessage:s,showNextMessage:r,updateChat:n[6],editMessage:n[7],saveMessage:n[8],rateMessage:n[9],deleteMessage:n[12],actionMessage:n[10],submitMessage:n[11],continueResponse:n[13],regenerateResponse:i,addMessages:n[15],readOnly:n[5]}}),{c(){$(e.$$.fragment)},l(o){x(e.$$.fragment,o)},m(o,a){ee(e,o,a),t=!0},p(o,a){n=o;const f={};a[0]&2&&(f.chatId=n[1]),a[0]&1&&(f.history=n[0]),a[0]&1572864&&(f.messageId=n[43]),a[0]&8&&(f.selectedModels=n[3]),a[0]&524288&&(f.siblings=n[19][n[40]].messageIds),a[0]&524288&&(f.gotoMessage=l),a[0]&524288&&(f.showPreviousMessage=s),a[0]&524288&&(f.showNextMessage=r),a[0]&64&&(f.updateChat=n[6]),a[0]&128&&(f.editMessage=n[7]),a[0]&256&&(f.saveMessage=n[8]),a[0]&512&&(f.rateMessage=n[9]),a[0]&4096&&(f.deleteMessage=n[12]),a[0]&1024&&(f.actionMessage=n[10]),a[0]&2048&&(f.submitMessage=n[11]),a[0]&8192&&(f.continueResponse=n[13]),a[0]&1589248&&(f.regenerateResponse=i),a[0]&32768&&(f.addMessages=n[15]),a[0]&32&&(f.readOnly=n[5]),e.$set(f)},i(o){t||(v(e.$$.fragment,o),t=!0)},o(o){M(e.$$.fragment,o),t=!1},d(o){te(e,o)}}}function xs(n){let e,t,l=n[16]&&$s(n);return{c(){l&&l.c(),e=he()},l(s){l&&l.l(s),e=he()},m(s,r){l&&l.m(s,r),E(s,e,r),t=!0},p(s,r){s[16]?l?(l.p(s,r),r[0]&65536&&v(l,1)):(l=$s(s),l.c(),v(l,1),l.m(e.parentNode,e)):l&&(se(),M(l,1,1,()=>{l=null}),ne())},i(s){t||(v(l),t=!0)},o(s){M(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function en(n){let e,t,l=n[20][n[40]]!==void 0&&n[19][n[40]].messageIds.length>0&&Ys(Jt(n));return{c(){l&&l.c(),e=he()},l(s){l&&l.l(s),e=he()},m(s,r){l&&l.m(s,r),E(s,e,r),t=!0},p(s,r){s[20][s[40]]!==void 0&&s[19][s[40]].messageIds.length>0?l?(l.p(Jt(s),r),r[0]&1572864&&v(l,1)):(l=Ys(Jt(s)),l.c(),v(l,1),l.m(e.parentNode,e)):l&&(se(),M(l,1,1,()=>{l=null}),ne())},i(s){t||(v(l),t=!0)},o(s){M(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function tn(n){let e=!Object.keys(n[19]).find(n[30]),t,l,s=e&&ln(n);return{c(){s&&s.c(),t=he()},l(r){s&&s.l(r),t=he()},m(r,i){s&&s.m(r,i),E(r,t,i),l=!0},p(r,i){i[0]&1572865&&(e=!Object.keys(r[19]).find(r[30])),e?s?(s.p(r,i),i[0]&1572865&&v(s,1)):(s=ln(r),s.c(),v(s,1),s.m(t.parentNode,t)):s&&(se(),M(s,1,1,()=>{s=null}),ne())},i(r){l||(v(s),l=!0)},o(r){M(s),l=!1},d(r){r&&m(t),s&&s.d(r)}}}function ln(n){var o,a;let e,t,l,s,r=((a=(o=n[0].messages[n[2]])==null?void 0:o.merged)==null?void 0:a.status)&&sn(Ft(n)),i=n[4]&&rn(n);return{c(){e=y("div"),t=y("div"),r&&r.c(),l=j(),i&&i.c(),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);t=I(u,"DIV",{class:!0});var c=k(t);r&&r.l(c),c.forEach(m),l=H(u),i&&i.l(u),u.forEach(m),this.h()},h(){d(t,"class","w-full"),d(e,"class","flex justify-end")},m(f,u){E(f,e,u),b(e,t),r&&r.m(t,null),b(e,l),i&&i.m(e,null),s=!0},p(f,u){var c,g;(g=(c=f[0].messages[f[2]])==null?void 0:c.merged)!=null&&g.status?r?(r.p(Ft(f),u),u[0]&5&&v(r,1)):(r=sn(Ft(f)),r.c(),v(r,1),r.m(t,null)):r&&(se(),M(r,1,1,()=>{r=null}),ne()),f[4]?i?(i.p(f,u),u[0]&16&&v(i,1)):(i=rn(f),i.c(),v(i,1),i.m(e,null)):i&&(se(),M(i,1,1,()=>{i=null}),ne())},i(f){s||(v(r),v(i),s=!0)},o(f){M(r),M(i),s=!1},d(f){f&&m(e),r&&r.d(),i&&i.d()}}}function sn(n){let e,t,l,s,r,i,o;t=new Qt({props:{$$slots:{default:[zo]},$$scope:{ctx:n}}});const a=[Wo,Uo],f=[];function u(c,g){var h;return(((h=c[16])==null?void 0:h.content)??"")===""?0:1}return r=u(n),i=f[r]=a[r](n),{c(){e=y("div"),$(t.$$.fragment),l=j(),s=y("div"),i.c(),this.h()},l(c){e=I(c,"DIV",{class:!0});var g=k(e);x(t.$$.fragment,g),l=H(g),s=I(g,"DIV",{class:!0});var h=k(s);i.l(h),h.forEach(m),g.forEach(m),this.h()},h(){d(s,"class","mt-1 markdown-prose w-full min-w-full"),d(e,"class","w-full rounded-xl pl-5 pr-2 py-2")},m(c,g){E(c,e,g),ee(t,e,null),b(e,l),b(e,s),f[r].m(s,null),o=!0},p(c,g){const h={};g[0]&4194309|g[1]&8192&&(h.$$scope={dirty:g,ctx:c}),t.$set(h);let _=r;r=u(c),r===_?f[r].p(c,g):(se(),M(f[_],1,1,()=>{f[_]=null}),ne(),i=f[r],i?i.p(c,g):(i=f[r]=a[r](c),i.c()),v(i,1),i.m(s,null))},i(c){o||(v(t.$$.fragment,c),v(i),o=!0)},o(c){M(t.$$.fragment,c),M(i),o=!1},d(c){c&&m(e),te(t),f[r].d()}}}function nn(n){let e,t=it(n[16].timestamp*1e3).format("LT")+"",l;return{c(){e=y("span"),l=U(t),this.h()},l(s){e=I(s,"SPAN",{class:!0});var r=k(e);l=W(r,t),r.forEach(m),this.h()},h(){d(e,"class","self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5")},m(s,r){E(s,e,r),b(e,l)},p(s,r){r[0]&5&&t!==(t=it(s[16].timestamp*1e3).format("LT")+"")&&G(l,t)},d(s){s&&m(e)}}}function zo(n){let e=n[22].t("Merged Response")+"",t,l,s,r=n[16].timestamp&&nn(n);return{c(){t=U(e),l=j(),r&&r.c(),s=he()},l(i){t=W(i,e),l=H(i),r&&r.l(i),s=he()},m(i,o){E(i,t,o),E(i,l,o),r&&r.m(i,o),E(i,s,o)},p(i,o){o[0]&4194304&&e!==(e=i[22].t("Merged Response")+"")&&G(t,e),i[16].timestamp?r?r.p(i,o):(r=nn(i),r.c(),r.m(s.parentNode,s)):r&&(r.d(1),r=null)},d(i){i&&(m(t),m(l),m(s)),r&&r.d(i)}}}function Uo(n){let e,t;return e=new Ct({props:{id:"merged",content:n[16].content??""}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&5&&(r.content=l[16].content??""),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Wo(n){let e,t;return e=new Xt({}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p:Ee,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function rn(n){let e,t,l;return t=new Be({props:{content:n[22].t("Merge Responses"),placement:"bottom",$$slots:{default:[qo]},$$scope:{ctx:n}}}),{c(){e=y("div"),$(t.$$.fragment),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=k(e);x(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","shrink-0 text-gray-600 dark:text-gray-500 mt-1")},m(s,r){E(s,e,r),ee(t,e,null),l=!0},p(s,r){const i={};r[0]&4194304&&(i.content=s[22].t("Merge Responses")),r[1]&8192&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(v(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),te(t)}}}function qo(n){let e,t,l,s,r;return t=new Ho({props:{className:" size-5 "}}),{c(){e=y("button"),$(t.$$.fragment),this.h()},l(i){e=I(i,"BUTTON",{type:!0,id:!0,class:!0});var o=k(e);x(t.$$.fragment,o),o.forEach(m),this.h()},h(){d(e,"type","button"),d(e,"id","merge-response-button"),d(e,"class","visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(i,o){E(i,e,o),ee(t,e,null),l=!0,s||(r=me(e,"click",n[36]),s=!0)},p:Ee,i(i){l||(v(t.$$.fragment,i),l=!0)},o(i){M(t.$$.fragment,i),l=!1},d(i){i&&m(e),te(t),s=!1,r()}}}function Fo(n){let e,t,l=n[18]&&Xs(n);return{c(){l&&l.c(),e=he()},l(s){l&&l.l(s),e=he()},m(s,r){l&&l.m(s,r),E(s,e,r),t=!0},p(s,r){s[18]?l?(l.p(s,r),r[0]&262144&&v(l,1)):(l=Xs(s),l.c(),v(l,1),l.m(e.parentNode,e)):l&&(se(),M(l,1,1,()=>{l=null}),ne())},i(s){t||(v(l),t=!0)},o(s){M(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function Jo(n,e,t){let l,s,r;Me(n,bt,J=>t(37,l=J)),Me(n,zn,J=>t(21,s=J));const i=Fe("i18n");Me(n,i,J=>t(22,r=J)),it.extend(qn);let{chatId:o}=e,{history:a}=e,{messageId:f}=e,{selectedModels:u=[]}=e,{isLastMessage:c}=e,{readOnly:g=!1}=e,{updateChat:h}=e,{editMessage:_}=e,{saveMessage:C}=e,{rateMessage:p}=e,{actionMessage:N}=e,{submitMessage:D}=e,{deleteMessage:L}=e,{continueResponse:O}=e,{regenerateResponse:A}=e,{mergeResponses:w}=e,{addMessages:V}=e,{triggerScroll:T}=e;Vt();let S,B,R={},q={},le=JSON.parse(JSON.stringify(a.messages[f]));const F=async(J,oe)=>{t(20,q[J]=Math.max(0,Math.min(oe,R[J].messageIds.length-1)),q);let _e=R[J].messageIds[q[J]],P=a.messages[_e].childrenIds;for(;P.length!==0;)_e=P.at(-1),P=a.messages[_e].childrenIds;t(0,a.currentId=_e,a),await Ce(),await h(),T()},X=async J=>{t(20,q[J]=Math.max(0,q[J]-1),q);let oe=R[J].messageIds[q[J]],_e=a.messages[oe].childrenIds;for(;_e.length!==0;)oe=_e.at(-1),_e=a.messages[oe].childrenIds;t(0,a.currentId=oe,a),await Ce(),await h(),T()},ae=async J=>{t(20,q[J]=Math.min(R[J].messageIds.length-1,q[J]+1),q);let oe=R[J].messageIds[q[J]],_e=a.messages[oe].childrenIds;for(;_e.length!==0;)oe=_e.at(-1),_e=a.messages[oe].childrenIds;t(0,a.currentId=oe,a),await Ce(),await h(),T()},de=async()=>{await Ce(),t(17,S=f),t(18,B=a.messages[f].parentId?a.messages[a.messages[f].parentId]:null),t(19,R=B==null?void 0:B.models.reduce((J,oe,_e)=>{let P=B==null?void 0:B.childrenIds.map(K=>a.messages[K]).filter(K=>(K==null?void 0:K.modelIdx)===_e).map(K=>K.id);if(P.length===0){let K=B==null?void 0:B.childrenIds.map(Z=>a.messages[Z]).filter(Z=>(Z==null?void 0:Z.model)===oe);K.forEach(Z=>{Z.modelIdx=_e}),P=K.map(Z=>Z.id)}return{...J,[_e]:{messageIds:P}}},{})),t(20,q=B==null?void 0:B.models.reduce((J,oe,_e)=>{const P=R[_e].messageIds.findIndex(K=>K===f);return P!==-1?{...J,[_e]:P}:{...J,[_e]:R[_e].messageIds.length-1}},{})),await Ce()},ge=async()=>{const J=Object.keys(R).map(oe=>{const{messageIds:_e}=R[oe],P=_e[q[oe]];return a.messages[P].content});w(f,J,o)};yt(async()=>{if(await de(),await Ce(),(l==null?void 0:l.scrollOnBranchChange)??!0){const J=document.getElementById(`message-${f}`);J&&J.scrollIntoView({block:"start"})}});const pe=J=>{var P;const{messageIds:oe}=R[J],_e=oe[q[J]];return!((P=a.messages[_e])!=null&&P.done)},Y=(J,oe,_e)=>F(J,_e),re=J=>X(J),be=J=>ae(J),fe=async(J,oe)=>{A(oe),await Ce(),t(20,q[J]=R[J].messageIds.length-1,q)},ce=async J=>{if(f!=J){let oe=J,_e=a.messages[oe].childrenIds;for(;_e.length!==0;)oe=_e.at(-1),_e=a.messages[oe].childrenIds;t(0,a.currentId=oe,a)}},ye=()=>{ge()};return n.$$set=J=>{"chatId"in J&&t(1,o=J.chatId),"history"in J&&t(0,a=J.history),"messageId"in J&&t(2,f=J.messageId),"selectedModels"in J&&t(3,u=J.selectedModels),"isLastMessage"in J&&t(4,c=J.isLastMessage),"readOnly"in J&&t(5,g=J.readOnly),"updateChat"in J&&t(6,h=J.updateChat),"editMessage"in J&&t(7,_=J.editMessage),"saveMessage"in J&&t(8,C=J.saveMessage),"rateMessage"in J&&t(9,p=J.rateMessage),"actionMessage"in J&&t(10,N=J.actionMessage),"submitMessage"in J&&t(11,D=J.submitMessage),"deleteMessage"in J&&t(12,L=J.deleteMessage),"continueResponse"in J&&t(13,O=J.continueResponse),"regenerateResponse"in J&&t(14,A=J.regenerateResponse),"mergeResponses"in J&&t(28,w=J.mergeResponses),"addMessages"in J&&t(15,V=J.addMessages),"triggerScroll"in J&&t(29,T=J.triggerScroll)},n.$$.update=()=>{n.$$.dirty[0]&65541&&a.messages&&JSON.stringify(le)!==JSON.stringify(a.messages[f])&&t(16,le=JSON.parse(JSON.stringify(a.messages[f])))},[a,o,f,u,c,g,h,_,C,p,N,D,L,O,A,V,le,S,B,R,q,s,r,i,F,X,ae,ge,w,T,pe,Y,re,be,fe,ce,ye]}class Go extends Pe{constructor(e){super(),Ae(this,e,Jo,Fo,Te,{chatId:1,history:0,messageId:2,selectedModels:3,isLastMessage:4,readOnly:5,updateChat:6,editMessage:7,saveMessage:8,rateMessage:9,actionMessage:10,submitMessage:11,deleteMessage:12,continueResponse:13,regenerateResponse:14,mergeResponses:28,addMessages:15,triggerScroll:29},null,[-1,-1])}}function an(n,e,t){const l=n.slice();return l[53]=e[t],l[55]=t,l}function on(n,e,t){const l=n.slice();return l[53]=e[t],l}function fn(n){var s,r,i,o;let e,t,l;return t=new Fn({props:{src:n[7].user?((i=(r=(s=n[16].find(n[30]))==null?void 0:s.info)==null?void 0:r.meta)==null?void 0:i.profile_image_url)??`${Ze}/user.png`:((o=n[0])==null?void 0:o.profile_image_url)??`${Ze}/user.png`,className:"size-8 user-message-profile-image"}}),{c(){e=y("div"),$(t.$$.fragment),this.h()},l(a){e=I(a,"DIV",{class:!0});var f=k(e);x(t.$$.fragment,f),f.forEach(m),this.h()},h(){d(e,"class","shrink-0 ltr:mr-3 rtl:ml-3 mt-1")},m(a,f){E(a,e,f),ee(t,e,null),l=!0},p(a,f){var c,g,h,_;const u={};f[0]&65665&&(u.src=a[7].user?((h=(g=(c=a[16].find(a[30]))==null?void 0:c.info)==null?void 0:g.meta)==null?void 0:h.profile_image_url)??`${Ze}/user.png`:((_=a[0])==null?void 0:_.profile_image_url)??`${Ze}/user.png`),t.$set(u)},i(a){l||(v(t.$$.fragment,a),l=!0)},o(a){M(t.$$.fragment,a),l=!1},d(a){a&&m(e),te(t)}}}function Ko(n){let e,t,l,s;return l=new Be({props:{content:it(n[7].timestamp*1e3).format("LLLL"),$$slots:{default:[Qo]},$$scope:{ctx:n}}}),{c(){e=y("div"),t=y("div"),$(l.$$.fragment),this.h()},l(r){e=I(r,"DIV",{class:!0});var i=k(e);t=I(i,"DIV",{class:!0});var o=k(t);x(l.$$.fragment,o),o.forEach(m),i.forEach(m),this.h()},h(){d(t,"class","text-[0.65rem] invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize mb-0.5"),d(e,"class","flex justify-end pr-2 text-xs")},m(r,i){E(r,e,i),b(e,t),ee(l,t,null),s=!0},p(r,i){const o={};i[0]&128&&(o.content=it(r[7].timestamp*1e3).format("LLLL")),i[0]&128|i[1]&134217728&&(o.$$scope={dirty:i,ctx:r}),l.$set(o)},i(r){s||(v(l.$$.fragment,r),s=!0)},o(r){M(l.$$.fragment,r),s=!1},d(r){r&&m(e),te(l)}}}function Zo(n){let e,t,l;return t=new Qt({props:{$$slots:{default:[ef]},$$scope:{ctx:n}}}),{c(){e=y("div"),$(t.$$.fragment)},l(s){e=I(s,"DIV",{});var r=k(e);x(t.$$.fragment,r),r.forEach(m)},m(s,r){E(s,e,r),ee(t,e,null),l=!0},p(s,r){const i={};r[0]&180353|r[1]&134217728&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(v(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),te(t)}}}function Qo(n){let e,t=wt(n[7].timestamp*1e3)+"",l;return{c(){e=y("span"),l=U(t),this.h()},l(s){e=I(s,"SPAN",{class:!0});var r=k(e);l=W(r,t),r.forEach(m),this.h()},h(){d(e,"class","line-clamp-1")},m(s,r){E(s,e,r),b(e,l)},p(s,r){r[0]&128&&t!==(t=wt(s[7].timestamp*1e3)+"")&&G(l,t)},d(s){s&&m(e)}}}function Xo(n){let e=n[14].t("You")+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s[0]&16384&&e!==(e=l[14].t("You")+"")&&G(t,e)},d(l){l&&m(t)}}}function Yo(n){let e=n[0].name+"",t;return{c(){t=U(e)},l(l){t=W(l,e)},m(l,s){E(l,t,s)},p(l,s){s[0]&1&&e!==(e=l[0].name+"")&&G(t,e)},d(l){l&&m(t)}}}function $o(n){var o;let e=n[14].t("You")+"",t,l,s,r=(((o=n[7])==null?void 0:o.user)??"")+"",i;return{c(){t=U(e),l=j(),s=y("span"),i=U(r),this.h()},l(a){t=W(a,e),l=H(a),s=I(a,"SPAN",{class:!0});var f=k(s);i=W(f,r),f.forEach(m),this.h()},h(){d(s,"class","text-gray-500 text-sm font-medium")},m(a,f){E(a,t,f),E(a,l,f),E(a,s,f),b(s,i)},p(a,f){var u;f[0]&16384&&e!==(e=a[14].t("You")+"")&&G(t,e),f[0]&128&&r!==(r=(((u=a[7])==null?void 0:u.user)??"")+"")&&G(i,r)},d(a){a&&(m(t),m(l),m(s))}}}function un(n){let e,t,l;return t=new Be({props:{content:it(n[7].timestamp*1e3).format("LLLL"),$$slots:{default:[xo]},$$scope:{ctx:n}}}),{c(){e=y("div"),$(t.$$.fragment),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=k(e);x(t.$$.fragment,r),r.forEach(m),this.h()},h(){d(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){E(s,e,r),ee(t,e,null),l=!0},p(s,r){const i={};r[0]&128&&(i.content=it(s[7].timestamp*1e3).format("LLLL")),r[0]&128|r[1]&134217728&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(v(t.$$.fragment,s),l=!0)},o(s){M(t.$$.fragment,s),l=!1},d(s){s&&m(e),te(t)}}}function xo(n){let e,t=wt(n[7].timestamp*1e3)+"",l;return{c(){e=y("span"),l=U(t),this.h()},l(s){e=I(s,"SPAN",{class:!0});var r=k(e);l=W(r,t),r.forEach(m),this.h()},h(){d(e,"class","line-clamp-1")},m(s,r){E(s,e,r),b(e,l)},p(s,r){r[0]&128&&t!==(t=wt(s[7].timestamp*1e3)+"")&&G(l,t)},d(s){s&&m(e)}}}function ef(n){let e,t,l;function s(a,f){return a[7].user?$o:a[15].showUsername||a[17].name!==a[0].name?Yo:Xo}let r=s(n),i=r(n),o=n[7].timestamp&&un(n);return{c(){i.c(),e=j(),o&&o.c(),t=he()},l(a){i.l(a),e=H(a),o&&o.l(a),t=he()},m(a,f){i.m(a,f),E(a,e,f),o&&o.m(a,f),E(a,t,f),l=!0},p(a,f){r===(r=s(a))&&i?i.p(a,f):(i.d(1),i=r(a),i&&(i.c(),i.m(e.parentNode,e))),a[7].timestamp?o?(o.p(a,f),f[0]&128&&v(o,1)):(o=un(a),o.c(),v(o,1),o.m(t.parentNode,t)):o&&(se(),M(o,1,1,()=>{o=null}),ne())},i(a){l||(v(o),l=!0)},o(a){M(o),l=!1},d(a){a&&(m(e),m(t)),i.d(a),o&&o.d(a)}}}function cn(n){let e,t,l=n[7].files&&dn(n);return{c(){l&&l.c(),e=he()},l(s){l&&l.l(s),e=he()},m(s,r){l&&l.m(s,r),E(s,e,r),t=!0},p(s,r){s[7].files?l?(l.p(s,r),r[0]&128&&v(l,1)):(l=dn(s),l.c(),v(l,1),l.m(e.parentNode,e)):l&&(se(),M(l,1,1,()=>{l=null}),ne())},i(s){t||(v(l),t=!0)},o(s){M(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function dn(n){let e,t,l=Ne(n[7].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=hn(on(n,l,i));const r=i=>M(s[i],1,1,()=>{s[i]=null});return{c(){e=y("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap")},m(i,o){E(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&32896){l=Ne(i[7].files);let a;for(a=0;a<l.length;a+=1){const f=on(i,l,a);s[a]?(s[a].p(f,o),v(s[a],1)):(s[a]=hn(f),s[a].c(),v(s[a],1),s[a].m(e,null))}for(se(),a=l.length;a<s.length;a+=1)r(a);ne()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)v(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)M(s[o]);t=!1},d(i){i&&m(e),qe(s,i)}}}function tf(n){var l;let e,t;return e=new el({props:{item:n[53],url:n[53].url,name:n[53].name,type:n[53].type,size:(l=n[53])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){$(e.$$.fragment)},l(s){x(e.$$.fragment,s)},m(s,r){ee(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&128&&(i.item=s[53]),r[0]&128&&(i.url=s[53].url),r[0]&128&&(i.name=s[53].name),r[0]&128&&(i.type=s[53].type),r[0]&128&&(i.size=(o=s[53])==null?void 0:o.size),e.$set(i)},i(s){t||(v(e.$$.fragment,s),t=!0)},o(s){M(e.$$.fragment,s),t=!1},d(s){te(e,s)}}}function lf(n){let e,t;return e=new Yt({props:{src:n[53].url,imageClassName:" max-h-96 rounded-lg"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&128&&(r.src=l[53].url),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function hn(n){let e,t,l,s,r,i;const o=[lf,tf],a=[];function f(u,c){return u[53].type==="image"?0:1}return t=f(n),l=a[t]=o[t](n),{c(){e=y("div"),l.c(),s=j(),this.h()},l(u){e=I(u,"DIV",{class:!0});var c=k(e);l.l(c),s=H(c),c.forEach(m),this.h()},h(){var u;d(e,"class",r=((u=n[15])==null?void 0:u.chatBubble)??!0?"self-end":"")},m(u,c){E(u,e,c),a[t].m(e,null),b(e,s),i=!0},p(u,c){var h;let g=t;t=f(u),t===g?a[t].p(u,c):(se(),M(a[g],1,1,()=>{a[g]=null}),ne(),l=a[t],l?l.p(u,c):(l=a[t]=o[t](u),l.c()),v(l,1),l.m(e,s)),(!i||c[0]&32768&&r!==(r=((h=u[15])==null?void 0:h.chatBubble)??!0?"self-end":""))&&d(e,"class",r)},i(u){i||(v(l),i=!0)},o(u){M(l),i=!1},d(u){u&&m(e),a[t].d()}}}function mn(n){let e,t,l,s;const r=[nf,sf],i=[];function o(a,f){return a[10]===!0?0:1}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=he()},l(a){t.l(a),l=he()},m(a,f){i[e].m(a,f),E(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(se(),M(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),v(t,1),t.m(l.parentNode,l))},i(a){s||(v(t),s=!0)},o(a){M(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function sf(n){var O,A;let e,t,l,s,r,i,o,a,f,u,c,g,h,_,C=n[7].content&&gn(n),p=!(((O=n[15])==null?void 0:O.chatBubble)??!0)&&_n(n),N=!n[6]&&pn(n);u=new Be({props:{content:n[14].t("Copy"),placement:"bottom",$$slots:{default:[ff]},$$scope:{ctx:n}}});let D=!n[6]&&(!n[5]||n[1].length>1)&&vn(n),L=(((A=n[15])==null?void 0:A.chatBubble)??!0)&&kn(n);return{c(){e=y("div"),t=y("div"),l=y("div"),C&&C.c(),i=j(),o=y("div"),p&&p.c(),a=j(),N&&N.c(),f=j(),$(u.$$.fragment),c=j(),D&&D.c(),g=j(),L&&L.c(),this.h()},l(w){e=I(w,"DIV",{class:!0});var V=k(e);t=I(V,"DIV",{class:!0});var T=k(t);l=I(T,"DIV",{class:!0});var S=k(l);C&&C.l(S),S.forEach(m),T.forEach(m),i=H(V),o=I(V,"DIV",{class:!0});var B=k(o);p&&p.l(B),a=H(B),N&&N.l(B),f=H(B),x(u.$$.fragment,B),c=H(B),D&&D.l(B),g=H(B),L&&L.l(B),B.forEach(m),V.forEach(m),this.h()},h(){var w,V,T;d(l,"class",s="rounded-3xl "+(((w=n[15])==null?void 0:w.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${n[7].files?"rounded-tr-lg":""}`:" w-full")),d(t,"class",r="flex "+(((V=n[15])==null?void 0:V.chatBubble)??!0?"justify-end pb-1":"w-full")),d(o,"class",h="flex "+(((T=n[15])==null?void 0:T.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"),d(e,"class","w-full")},m(w,V){E(w,e,V),b(e,t),b(t,l),C&&C.m(l,null),b(e,i),b(e,o),p&&p.m(o,null),b(o,a),N&&N.m(o,null),b(o,f),ee(u,o,null),b(o,c),D&&D.m(o,null),b(o,g),L&&L.m(o,null),_=!0},p(w,V){var S,B,R,q,le;w[7].content?C?(C.p(w,V),V[0]&128&&v(C,1)):(C=gn(w),C.c(),v(C,1),C.m(l,null)):C&&(se(),M(C,1,1,()=>{C=null}),ne()),(!_||V[0]&32896&&s!==(s="rounded-3xl "+(((S=w[15])==null?void 0:S.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${w[7].files?"rounded-tr-lg":""}`:" w-full")))&&d(l,"class",s),(!_||V[0]&32768&&r!==(r="flex "+(((B=w[15])==null?void 0:B.chatBubble)??!0?"justify-end pb-1":"w-full")))&&d(t,"class",r),((R=w[15])==null?void 0:R.chatBubble)??!0?p&&(p.d(1),p=null):p?p.p(w,V):(p=_n(w),p.c(),p.m(o,a)),w[6]?N&&(se(),M(N,1,1,()=>{N=null}),ne()):N?(N.p(w,V),V[0]&64&&v(N,1)):(N=pn(w),N.c(),v(N,1),N.m(o,f));const T={};V[0]&16384&&(T.content=w[14].t("Copy")),V[0]&128|V[1]&134217728&&(T.$$scope={dirty:V,ctx:w}),u.$set(T),!w[6]&&(!w[5]||w[1].length>1)?D?(D.p(w,V),V[0]&98&&v(D,1)):(D=vn(w),D.c(),v(D,1),D.m(o,g)):D&&(se(),M(D,1,1,()=>{D=null}),ne()),((q=w[15])==null?void 0:q.chatBubble)??!0?L?L.p(w,V):(L=kn(w),L.c(),L.m(o,null)):L&&(L.d(1),L=null),(!_||V[0]&32768&&h!==(h="flex "+(((le=w[15])==null?void 0:le.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"))&&d(o,"class",h)},i(w){_||(v(C),v(N),v(u.$$.fragment,w),v(D),_=!0)},o(w){M(C),M(N),M(u.$$.fragment,w),M(D),_=!1},d(w){w&&m(e),C&&C.d(),p&&p.d(),N&&N.d(),te(u),D&&D.d(),L&&L.d()}}}function nf(n){let e,t,l,s,r,i,o,a,f,u=n[14].t("Save")+"",c,g,h,_,C=n[14].t("Cancel")+"",p,N,D,L=n[14].t("Send")+"",O,A,w,V,T=(n[12]??[]).length>0&&yn(n);return{c(){e=y("div"),T&&T.c(),t=j(),l=y("div"),s=y("textarea"),i=j(),o=y("div"),a=y("div"),f=y("button"),c=U(u),g=j(),h=y("div"),_=y("button"),p=U(C),N=j(),D=y("button"),O=U(L),this.h()},l(S){e=I(S,"DIV",{class:!0});var B=k(e);T&&T.l(B),t=H(B),l=I(B,"DIV",{class:!0});var R=k(l);s=I(R,"TEXTAREA",{id:!0,class:!0}),k(s).forEach(m),R.forEach(m),i=H(B),o=I(B,"DIV",{class:!0});var q=k(o);a=I(q,"DIV",{});var le=k(a);f=I(le,"BUTTON",{id:!0,class:!0});var F=k(f);c=W(F,u),F.forEach(m),le.forEach(m),g=H(q),h=I(q,"DIV",{class:!0});var X=k(h);_=I(X,"BUTTON",{id:!0,class:!0});var ae=k(_);p=W(ae,C),ae.forEach(m),N=H(X),D=I(X,"BUTTON",{id:!0,class:!0});var de=k(D);O=W(de,L),de.forEach(m),X.forEach(m),q.forEach(m),B.forEach(m),this.h()},h(){d(s,"id",r="message-edit-"+n[7].id),d(s,"class","bg-transparent outline-hidden w-full resize-none"),d(l,"class","max-h-96 overflow-auto"),d(f,"id","save-edit-message-button"),d(f,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),d(_,"id","close-edit-message-button"),d(_,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),d(D,"id","confirm-edit-message-button"),d(D,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),d(h,"class","flex space-x-1.5"),d(o,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),d(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2")},m(S,B){E(S,e,B),T&&T.m(e,null),b(e,t),b(e,l),b(l,s),n[34](s),ut(s,n[11]),b(e,i),b(e,o),b(o,a),b(a,f),b(f,c),b(o,g),b(o,h),b(h,_),b(_,p),b(h,N),b(h,D),b(D,O),A=!0,w||(V=[me(s,"input",n[35]),me(s,"input",_f),me(s,"keydown",n[36]),me(f,"click",n[37]),me(_,"click",n[38]),me(D,"click",n[39])],w=!0)},p(S,B){(S[12]??[]).length>0?T?(T.p(S,B),B[0]&4096&&v(T,1)):(T=yn(S),T.c(),v(T,1),T.m(e,t)):T&&(se(),M(T,1,1,()=>{T=null}),ne()),(!A||B[0]&128&&r!==(r="message-edit-"+S[7].id))&&d(s,"id",r),B[0]&2048&&ut(s,S[11]),(!A||B[0]&16384)&&u!==(u=S[14].t("Save")+"")&&G(c,u),(!A||B[0]&16384)&&C!==(C=S[14].t("Cancel")+"")&&G(p,C),(!A||B[0]&16384)&&L!==(L=S[14].t("Send")+"")&&G(O,L)},i(S){A||(v(T),A=!0)},o(S){M(T),A=!1},d(S){S&&m(e),T&&T.d(),n[34](null),w=!1,Ye(V)}}}function gn(n){let e,t;return e=new Ct({props:{id:n[7].id,content:n[7].content}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&128&&(r.id=l[7].id),s[0]&128&&(r.content=l[7].content),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function _n(n){let e,t=n[1].length>1&&bn(n);return{c(){t&&t.c(),e=he()},l(l){t&&t.l(l),e=he()},m(l,s){t&&t.m(l,s),E(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=bn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function bn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',a,f;function u(h,_){return h[9]?af:rf}let c=u(n),g=c(n);return{c(){e=y("div"),t=y("button"),t.innerHTML=l,s=j(),g.c(),r=j(),i=y("button"),i.innerHTML=o,this.h()},l(h){e=I(h,"DIV",{class:!0,dir:!0});var _=k(e);t=I(_,"BUTTON",{class:!0,"data-svelte-h":!0}),tt(t)!=="svelte-buado9"&&(t.innerHTML=l),s=H(_),g.l(_),r=H(_),i=I(_,"BUTTON",{class:!0,"data-svelte-h":!0}),tt(i)!=="svelte-4phel2"&&(i.innerHTML=o),_.forEach(m),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center"),d(e,"dir","ltr")},m(h,_){E(h,e,_),b(e,t),b(e,s),g.m(e,null),b(e,r),b(e,i),a||(f=[me(t,"click",n[40]),me(i,"click",n[44])],a=!0)},p(h,_){c===(c=u(h))&&g?g.p(h,_):(g.d(1),g=c(h),g&&(g.c(),g.m(e,r)))},d(h){h&&m(e),g.d(),a=!1,Ye(f)}}}function rf(n){let e,t=n[1].indexOf(n[7].id)+1+"",l,s,r=n[1].length+"",i,o,a;return{c(){e=y("div"),l=U(t),s=U("/"),i=U(r),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);l=W(u,t),s=W(u,"/"),i=W(u,r),u.forEach(m),this.h()},h(){d(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){E(f,e,u),b(e,l),b(e,s),b(e,i),o||(a=me(e,"dblclick",n[43]),o=!0)},p(f,u){u[0]&130&&t!==(t=f[1].indexOf(f[7].id)+1+"")&&G(l,t),u[0]&2&&r!==(r=f[1].length+"")&&G(i,r)},d(f){f&&m(e),o=!1,a()}}}function af(n){let e,t,l,s,r,i,o=n[1].length+"",a,f,u;return{c(){e=y("div"),t=y("input"),i=U("/"),a=U(o),this.h()},l(c){e=I(c,"DIV",{class:!0});var g=k(e);t=I(g,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=W(g,"/"),a=W(g,o),g.forEach(m),this.h()},h(){d(t,"id",l="message-index-input-"+n[7].id),d(t,"type","number"),t.value=s=n[1].indexOf(n[7].id)+1,d(t,"min","1"),d(t,"max",r=n[1].length),d(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),d(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,g){E(c,e,g),b(e,t),b(e,i),b(e,a),f||(u=[me(t,"focus",bf),me(t,"blur",n[41]),me(t,"keydown",n[42])],f=!0)},p(c,g){g[0]&128&&l!==(l="message-index-input-"+c[7].id)&&d(t,"id",l),g[0]&130&&s!==(s=c[1].indexOf(c[7].id)+1)&&t.value!==s&&(t.value=s),g[0]&2&&r!==(r=c[1].length)&&d(t,"max",r),g[0]&2&&o!==(o=c[1].length+"")&&G(a,o)},d(c){c&&m(e),f=!1,Ye(u)}}}function pn(n){let e,t;return e=new Be({props:{content:n[14].t("Edit"),placement:"bottom",$$slots:{default:[of]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&16384&&(r.content=l[14].t("Edit")),s[1]&134217728&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function of(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg>',l,s;return{c(){e=y("button"),e.innerHTML=t,this.h()},l(r){e=I(r,"BUTTON",{class:!0,"data-svelte-h":!0}),tt(e)!=="svelte-tlrz1q"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button")},m(r,i){E(r,e,i),l||(s=me(e,"click",n[45]),l=!0)},p:Ee,d(r){r&&m(e),l=!1,s()}}}function ff(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg>',l,s;return{c(){e=y("button"),e.innerHTML=t,this.h()},l(r){e=I(r,"BUTTON",{class:!0,"data-svelte-h":!0}),tt(e)!=="svelte-1ivgdx2"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(r,i){E(r,e,i),l||(s=me(e,"click",n[46]),l=!0)},p:Ee,d(r){r&&m(e),l=!1,s()}}}function vn(n){let e,t;return e=new Be({props:{content:n[14].t("Delete"),placement:"bottom",$$slots:{default:[uf]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&16384&&(r.content=l[14].t("Delete")),s[0]&256|s[1]&134217728&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function uf(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',l,s;return{c(){e=y("button"),e.innerHTML=t,this.h()},l(r){e=I(r,"BUTTON",{class:!0,"data-svelte-h":!0}),tt(e)!=="svelte-146x2zz"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1 rounded-sm dark:hover:text-white hover:text-black transition")},m(r,i){E(r,e,i),l||(s=me(e,"click",n[47]),l=!0)},p:Ee,d(r){r&&m(e),l=!1,s()}}}function kn(n){let e,t=n[1].length>1&&wn(n);return{c(){t&&t.c(),e=he()},l(l){t&&t.l(l),e=he()},m(l,s){t&&t.m(l,s),E(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=wn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function wn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',a,f;function u(h,_){return h[9]?df:cf}let c=u(n),g=c(n);return{c(){e=y("div"),t=y("button"),t.innerHTML=l,s=j(),g.c(),r=j(),i=y("button"),i.innerHTML=o,this.h()},l(h){e=I(h,"DIV",{class:!0,dir:!0});var _=k(e);t=I(_,"BUTTON",{class:!0,"data-svelte-h":!0}),tt(t)!=="svelte-buado9"&&(t.innerHTML=l),s=H(_),g.l(_),r=H(_),i=I(_,"BUTTON",{class:!0,"data-svelte-h":!0}),tt(i)!=="svelte-4phel2"&&(i.innerHTML=o),_.forEach(m),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center"),d(e,"dir","ltr")},m(h,_){E(h,e,_),b(e,t),b(e,s),g.m(e,null),b(e,r),b(e,i),a||(f=[me(t,"click",n[48]),me(i,"click",n[52])],a=!0)},p(h,_){c===(c=u(h))&&g?g.p(h,_):(g.d(1),g=c(h),g&&(g.c(),g.m(e,r)))},d(h){h&&m(e),g.d(),a=!1,Ye(f)}}}function cf(n){let e,t=n[1].indexOf(n[7].id)+1+"",l,s,r=n[1].length+"",i,o,a;return{c(){e=y("div"),l=U(t),s=U("/"),i=U(r),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);l=W(u,t),s=W(u,"/"),i=W(u,r),u.forEach(m),this.h()},h(){d(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){E(f,e,u),b(e,l),b(e,s),b(e,i),o||(a=me(e,"dblclick",n[51]),o=!0)},p(f,u){u[0]&130&&t!==(t=f[1].indexOf(f[7].id)+1+"")&&G(l,t),u[0]&2&&r!==(r=f[1].length+"")&&G(i,r)},d(f){f&&m(e),o=!1,a()}}}function df(n){let e,t,l,s,r,i,o=n[1].length+"",a,f,u;return{c(){e=y("div"),t=y("input"),i=U("/"),a=U(o),this.h()},l(c){e=I(c,"DIV",{class:!0});var g=k(e);t=I(g,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=W(g,"/"),a=W(g,o),g.forEach(m),this.h()},h(){d(t,"id",l="message-index-input-"+n[7].id),d(t,"type","number"),t.value=s=n[1].indexOf(n[7].id)+1,d(t,"min","1"),d(t,"max",r=n[1].length),d(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),d(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,g){E(c,e,g),b(e,t),b(e,i),b(e,a),f||(u=[me(t,"focus",pf),me(t,"blur",n[49]),me(t,"keydown",n[50])],f=!0)},p(c,g){g[0]&128&&l!==(l="message-index-input-"+c[7].id)&&d(t,"id",l),g[0]&130&&s!==(s=c[1].indexOf(c[7].id)+1)&&t.value!==s&&(t.value=s),g[0]&2&&r!==(r=c[1].length)&&d(t,"max",r),g[0]&2&&o!==(o=c[1].length+"")&&G(a,o)},d(c){c&&m(e),f=!1,Ye(u)}}}function yn(n){let e,t,l=Ne(n[12]),s=[];for(let i=0;i<l.length;i+=1)s[i]=In(an(n,l,i));const r=i=>M(s[i],1,1,()=>{s[i]=null});return{c(){e=y("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var o=k(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","flex items-center flex-wrap gap-2 -mx-2 mb-1")},m(i,o){E(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&4096){l=Ne(i[12]);let a;for(a=0;a<l.length;a+=1){const f=an(i,l,a);s[a]?(s[a].p(f,o),v(s[a],1)):(s[a]=In(f),s[a].c(),v(s[a],1),s[a].m(e,null))}for(se(),a=l.length;a<s.length;a+=1)r(a);ne()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)v(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)M(s[o]);t=!1},d(i){i&&m(e),qe(s,i)}}}function hf(n){var r;let e,t;function l(){return n[32](n[55])}function s(){return n[33](n[53])}return e=new el({props:{item:n[53],name:n[53].name,type:n[53].type,size:(r=n[53])==null?void 0:r.size,loading:n[53].status==="uploading",dismissible:!0,edit:!0}}),e.$on("dismiss",l),e.$on("click",s),{c(){$(e.$$.fragment)},l(i){x(e.$$.fragment,i)},m(i,o){ee(e,i,o),t=!0},p(i,o){var f;n=i;const a={};o[0]&4096&&(a.item=n[53]),o[0]&4096&&(a.name=n[53].name),o[0]&4096&&(a.type=n[53].type),o[0]&4096&&(a.size=(f=n[53])==null?void 0:f.size),o[0]&4096&&(a.loading=n[53].status==="uploading"),e.$set(a)},i(i){t||(v(e.$$.fragment,i),t=!0)},o(i){M(e.$$.fragment,i),t=!1},d(i){te(e,i)}}}function mf(n){let e,t,l,s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',a,f,u,c;l=new Yt({props:{src:n[53].url,alt:"input",imageClassName:" size-14 rounded-xl object-cover"}});function g(){return n[31](n[55])}return{c(){e=y("div"),t=y("div"),$(l.$$.fragment),s=j(),r=y("div"),i=y("button"),i.innerHTML=o,a=j(),this.h()},l(h){e=I(h,"DIV",{class:!0});var _=k(e);t=I(_,"DIV",{class:!0});var C=k(t);x(l.$$.fragment,C),C.forEach(m),s=H(_),r=I(_,"DIV",{class:!0});var p=k(r);i=I(p,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),tt(i)!=="svelte-1ki5d3w"&&(i.innerHTML=o),p.forEach(m),a=H(_),_.forEach(m),this.h()},h(){d(t,"class","relative flex items-center"),d(i,"class","bg-white text-black border border-white rounded-full group-hover:visible invisible transition"),d(i,"type","button"),d(r,"class","absolute -top-1 -right-1"),d(e,"class","relative group")},m(h,_){E(h,e,_),b(e,t),ee(l,t,null),b(e,s),b(e,r),b(r,i),b(e,a),f=!0,u||(c=me(i,"click",g),u=!0)},p(h,_){n=h;const C={};_[0]&4096&&(C.src=n[53].url),l.$set(C)},i(h){f||(v(l.$$.fragment,h),f=!0)},o(h){M(l.$$.fragment,h),f=!1},d(h){h&&m(e),te(l),u=!1,c()}}}function In(n){let e,t,l,s;const r=[mf,hf],i=[];function o(a,f){return a[53].type==="image"?0:1}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=he()},l(a){t.l(a),l=he()},m(a,f){i[e].m(a,f),E(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(se(),M(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),v(t,1),t.m(l.parentNode,l))},i(a){s||(v(t),s=!0)},o(a){M(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function gf(n){var T;let e,t,l,s,r,i,o,a,f,u,c,g,h,_,C;function p(S){n[28](S)}let N={title:n[14].t("Delete message?")};n[8]!==void 0&&(N.show=n[8]),e=new Zn({props:N}),He.push(()=>Xe(e,"show",p)),e.$on("confirm",n[29]);let D=!(((T=n[15])==null?void 0:T.chatBubble)??!0)&&fn(n);const L=[Zo,Ko],O=[];function A(S,B){var R;return((R=S[15])==null?void 0:R.chatBubble)??!0?S[7].timestamp?1:-1:0}~(o=A(n))&&(a=O[o]=L[o](n));let w=n[10]!==!0&&cn(n),V=n[7].content!==""&&mn(n);return{c(){$(e.$$.fragment),l=j(),s=y("div"),D&&D.c(),r=j(),i=y("div"),a&&a.c(),f=j(),u=y("div"),w&&w.c(),c=j(),V&&V.c(),this.h()},l(S){x(e.$$.fragment,S),l=H(S),s=I(S,"DIV",{class:!0,dir:!0,id:!0});var B=k(s);D&&D.l(B),r=H(B),i=I(B,"DIV",{class:!0});var R=k(i);a&&a.l(R),f=H(R),u=I(R,"DIV",{class:!0});var q=k(u);w&&w.l(q),c=H(q),V&&V.l(q),q.forEach(m),R.forEach(m),B.forEach(m),this.h()},h(){d(u,"class",g="chat-"+n[7].role+" w-full min-w-full markdown-prose"),d(i,"class","flex-auto w-0 max-w-full pl-1"),d(s,"class","flex w-full user-message group"),d(s,"dir",h=n[15].chatDirection),d(s,"id",_="message-"+n[7].id)},m(S,B){ee(e,S,B),E(S,l,B),E(S,s,B),D&&D.m(s,null),b(s,r),b(s,i),~o&&O[o].m(i,null),b(i,f),b(i,u),w&&w.m(u,null),b(u,c),V&&V.m(u,null),C=!0},p(S,B){var le;const R={};B[0]&16384&&(R.title=S[14].t("Delete message?")),!t&&B[0]&256&&(t=!0,R.show=S[8],Qe(()=>t=!1)),e.$set(R),((le=S[15])==null?void 0:le.chatBubble)??!0?D&&(se(),M(D,1,1,()=>{D=null}),ne()):D?(D.p(S,B),B[0]&32768&&v(D,1)):(D=fn(S),D.c(),v(D,1),D.m(s,r));let q=o;o=A(S),o===q?~o&&O[o].p(S,B):(a&&(se(),M(O[q],1,1,()=>{O[q]=null}),ne()),~o?(a=O[o],a?a.p(S,B):(a=O[o]=L[o](S),a.c()),v(a,1),a.m(i,f)):a=null),S[10]!==!0?w?(w.p(S,B),B[0]&1024&&v(w,1)):(w=cn(S),w.c(),v(w,1),w.m(u,c)):w&&(se(),M(w,1,1,()=>{w=null}),ne()),S[7].content!==""?V?(V.p(S,B),B[0]&128&&v(V,1)):(V=mn(S),V.c(),v(V,1),V.m(u,null)):V&&(se(),M(V,1,1,()=>{V=null}),ne()),(!C||B[0]&128&&g!==(g="chat-"+S[7].role+" w-full min-w-full markdown-prose"))&&d(u,"class",g),(!C||B[0]&32768&&h!==(h=S[15].chatDirection))&&d(s,"dir",h),(!C||B[0]&128&&_!==(_="message-"+S[7].id))&&d(s,"id",_)},i(S){C||(v(e.$$.fragment,S),v(D),v(a),v(w),v(V),C=!0)},o(S){M(e.$$.fragment,S),M(D),M(a),M(w),M(V),C=!1},d(S){S&&(m(l),m(s)),te(e,S),D&&D.d(),~o&&O[o].d(),w&&w.d(),V&&V.d()}}}const _f=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},bf=n=>{n.target.select()},pf=n=>{n.target.select()};function vf(n,e,t){let l,s,r,i;Me(n,bt,ie=>t(15,s=ie)),Me(n,zt,ie=>t(16,r=ie)),Me(n,Ut,ie=>t(17,i=ie));const o=Fe("i18n");Me(n,o,ie=>t(14,l=ie)),it.extend(qn);let{user:a}=e,{history:f}=e,{messageId:u}=e,{siblings:c}=e,{gotoMessage:g}=e,{showPreviousMessage:h}=e,{showNextMessage:_}=e,{editMessage:C}=e,{deleteMessage:p}=e,{isFirstMessage:N}=e,{readOnly:D}=e,L=!1,O=!1,A=!1,w="",V=[],T,S=JSON.parse(JSON.stringify(f.messages[u]));const B=async ie=>{await Wn(ie)&&Le.success(l.t("Copying to clipboard was successful!"))},R=async()=>{t(10,A=!0),t(11,w=S.content),t(12,V=S.files),await Ce(),T&&(t(13,T.style.height="",T),t(13,T.style.height=`${T.scrollHeight}px`,T),T==null||T.focus())},q=async(ie=!0)=>{C(S.id,{content:w,files:V},ie),t(10,A=!1),t(11,w=""),t(12,V=[])},le=()=>{t(10,A=!1),t(11,w=""),t(12,V=[])},F=async()=>{p(S.id)};yt(()=>{});function X(ie){L=ie,t(8,L)}const ae=()=>{F()},de=ie=>ie.id===S.user,ge=ie=>{V.splice(ie,1),t(12,V)},pe=async ie=>{V.splice(ie,1),t(12,V)},Y=ie=>{};function re(ie){He[ie?"unshift":"push"](()=>{T=ie,t(13,T)})}function be(){w=this.value,t(11,w)}const fe=ie=>{var $e,lt;ie.key==="Escape"&&(($e=document.getElementById("close-edit-message-button"))==null||$e.click());const Je=ie.metaKey||ie.ctrlKey,Ge=ie.key==="Enter";Je&&Ge&&((lt=document.getElementById("confirm-edit-message-button"))==null||lt.click())},ce=()=>{q(!1)},ye=()=>{le()},J=()=>{q()},oe=()=>{h(S)},_e=ie=>{g(S,ie.target.value-1),t(9,O=!1)},P=ie=>{ie.key==="Enter"&&(g(S,ie.target.value-1),t(9,O=!1))},K=async()=>{t(9,O=!0),await Ce();const ie=document.getElementById(`message-index-input-${S.id}`);ie&&(ie.focus(),ie.select())},Z=()=>{_(S)},Q=()=>{R()},ue=()=>{B(S.content)},ve=()=>{t(8,L=!0)},Ve=()=>{h(S)},De=ie=>{g(S,ie.target.value-1),t(9,O=!1)},ze=ie=>{ie.key==="Enter"&&(g(S,ie.target.value-1),t(9,O=!1))},Ue=async()=>{t(9,O=!0),await Ce();const ie=document.getElementById(`message-index-input-${S.id}`);ie&&(ie.focus(),ie.select())},je=()=>{_(S)};return n.$$set=ie=>{"user"in ie&&t(0,a=ie.user),"history"in ie&&t(24,f=ie.history),"messageId"in ie&&t(25,u=ie.messageId),"siblings"in ie&&t(1,c=ie.siblings),"gotoMessage"in ie&&t(2,g=ie.gotoMessage),"showPreviousMessage"in ie&&t(3,h=ie.showPreviousMessage),"showNextMessage"in ie&&t(4,_=ie.showNextMessage),"editMessage"in ie&&t(26,C=ie.editMessage),"deleteMessage"in ie&&t(27,p=ie.deleteMessage),"isFirstMessage"in ie&&t(5,N=ie.isFirstMessage),"readOnly"in ie&&t(6,D=ie.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&50331776&&f.messages&&JSON.stringify(S)!==JSON.stringify(f.messages[u])&&t(7,S=JSON.parse(JSON.stringify(f.messages[u])))},[a,c,g,h,_,N,D,S,L,O,A,w,V,T,l,s,r,i,o,B,R,q,le,F,f,u,C,p,X,ae,de,ge,pe,Y,re,be,fe,ce,ye,J,oe,_e,P,K,Z,Q,ue,ve,Ve,De,ze,Ue,je]}class kf extends Pe{constructor(e){super(),Ae(this,e,vf,gf,Te,{user:0,history:24,messageId:25,siblings:1,gotoMessage:2,showPreviousMessage:3,showNextMessage:4,editMessage:26,deleteMessage:27,isFirstMessage:5,readOnly:6},null,[-1,-1])}}function Mn(n){let e,t,l,s;const r=[If,yf,wf],i=[];function o(a,f){var u,c;return a[0].messages[a[4]].role==="user"?0:(((c=(u=a[0].messages[a[0].messages[a[4]].parentId])==null?void 0:u.models)==null?void 0:c.length)??1)===1?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=he()},l(a){t.l(a),l=he()},m(a,f){i[e].m(a,f),E(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(se(),M(i[u],1,1,()=>{i[u]=null}),ne(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),v(t,1),t.m(l.parentNode,l))},i(a){s||(v(t),s=!0)},o(a){M(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function wf(n){var i;let e,t,l;function s(o){n[23](o)}let r={chatId:n[1],messageId:n[4],selectedModels:n[2],isLastMessage:n[4]===((i=n[0])==null?void 0:i.currentId),updateChat:n[9],editMessage:n[10],saveMessage:n[11],rateMessage:n[13],actionMessage:n[14],submitMessage:n[15],deleteMessage:n[12],continueResponse:n[17],regenerateResponse:n[16],mergeResponses:n[18],triggerScroll:n[20],addMessages:n[19],readOnly:n[21]};return n[0]!==void 0&&(r.history=n[0]),e=new Go({props:r}),He.push(()=>Xe(e,"history",s)),{c(){$(e.$$.fragment)},l(o){x(e.$$.fragment,o)},m(o,a){ee(e,o,a),l=!0},p(o,a){var u;const f={};a&2&&(f.chatId=o[1]),a&16&&(f.messageId=o[4]),a&4&&(f.selectedModels=o[2]),a&17&&(f.isLastMessage=o[4]===((u=o[0])==null?void 0:u.currentId)),a&512&&(f.updateChat=o[9]),a&1024&&(f.editMessage=o[10]),a&2048&&(f.saveMessage=o[11]),a&8192&&(f.rateMessage=o[13]),a&16384&&(f.actionMessage=o[14]),a&32768&&(f.submitMessage=o[15]),a&4096&&(f.deleteMessage=o[12]),a&131072&&(f.continueResponse=o[17]),a&65536&&(f.regenerateResponse=o[16]),a&262144&&(f.mergeResponses=o[18]),a&1048576&&(f.triggerScroll=o[20]),a&524288&&(f.addMessages=o[19]),a&2097152&&(f.readOnly=o[21]),!t&&a&1&&(t=!0,f.history=o[0],Qe(()=>t=!1)),e.$set(f)},i(o){l||(v(e.$$.fragment,o),l=!0)},o(o){M(e.$$.fragment,o),l=!1},d(o){te(e,o)}}}function yf(n){var l;let e,t;return e=new Xn({props:{chatId:n[1],history:n[0],messageId:n[4],selectedModels:n[2],isLastMessage:n[4]===n[0].currentId,siblings:((l=n[0].messages[n[0].messages[n[4]].parentId])==null?void 0:l.childrenIds)??[],gotoMessage:n[6],showPreviousMessage:n[7],showNextMessage:n[8],updateChat:n[9],editMessage:n[10],saveMessage:n[11],rateMessage:n[13],actionMessage:n[14],submitMessage:n[15],deleteMessage:n[12],continueResponse:n[17],regenerateResponse:n[16],addMessages:n[19],readOnly:n[21]}}),{c(){$(e.$$.fragment)},l(s){x(e.$$.fragment,s)},m(s,r){ee(e,s,r),t=!0},p(s,r){var o;const i={};r&2&&(i.chatId=s[1]),r&1&&(i.history=s[0]),r&16&&(i.messageId=s[4]),r&4&&(i.selectedModels=s[2]),r&17&&(i.isLastMessage=s[4]===s[0].currentId),r&17&&(i.siblings=((o=s[0].messages[s[0].messages[s[4]].parentId])==null?void 0:o.childrenIds)??[]),r&64&&(i.gotoMessage=s[6]),r&128&&(i.showPreviousMessage=s[7]),r&256&&(i.showNextMessage=s[8]),r&512&&(i.updateChat=s[9]),r&1024&&(i.editMessage=s[10]),r&2048&&(i.saveMessage=s[11]),r&8192&&(i.rateMessage=s[13]),r&16384&&(i.actionMessage=s[14]),r&32768&&(i.submitMessage=s[15]),r&4096&&(i.deleteMessage=s[12]),r&131072&&(i.continueResponse=s[17]),r&65536&&(i.regenerateResponse=s[16]),r&524288&&(i.addMessages=s[19]),r&2097152&&(i.readOnly=s[21]),e.$set(i)},i(s){t||(v(e.$$.fragment,s),t=!0)},o(s){M(e.$$.fragment,s),t=!1},d(s){te(e,s)}}}function If(n){var l;let e,t;return e=new kf({props:{user:n[5],history:n[0],messageId:n[4],isFirstMessage:n[3]===0,siblings:n[0].messages[n[4]].parentId!==null?((l=n[0].messages[n[0].messages[n[4]].parentId])==null?void 0:l.childrenIds)??[]:Object.values(n[0].messages).filter(En).map(Nn)??[],gotoMessage:n[6],showPreviousMessage:n[7],showNextMessage:n[8],editMessage:n[10],deleteMessage:n[12],readOnly:n[21]}}),{c(){$(e.$$.fragment)},l(s){x(e.$$.fragment,s)},m(s,r){ee(e,s,r),t=!0},p(s,r){var o;const i={};r&32&&(i.user=s[5]),r&1&&(i.history=s[0]),r&16&&(i.messageId=s[4]),r&8&&(i.isFirstMessage=s[3]===0),r&17&&(i.siblings=s[0].messages[s[4]].parentId!==null?((o=s[0].messages[s[0].messages[s[4]].parentId])==null?void 0:o.childrenIds)??[]:Object.values(s[0].messages).filter(En).map(Nn)??[]),r&64&&(i.gotoMessage=s[6]),r&128&&(i.showPreviousMessage=s[7]),r&256&&(i.showNextMessage=s[8]),r&1024&&(i.editMessage=s[10]),r&4096&&(i.deleteMessage=s[12]),r&2097152&&(i.readOnly=s[21]),e.$set(i)},i(s){t||(v(e.$$.fragment,s),t=!0)},o(s){M(e.$$.fragment,s),t=!1},d(s){te(e,s)}}}function Mf(n){let e,t,l,s=n[0].messages[n[4]]&&Mn(n);return{c(){e=y("div"),s&&s.c(),this.h()},l(r){e=I(r,"DIV",{class:!0});var i=k(e);s&&s.l(i),i.forEach(m),this.h()},h(){var r;d(e,"class",t="flex flex-col justify-between px-5 mb-3 w-full "+(((r=n[22])==null?void 0:r.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group")},m(r,i){E(r,e,i),s&&s.m(e,null),l=!0},p(r,[i]){var o;r[0].messages[r[4]]?s?(s.p(r,i),i&17&&v(s,1)):(s=Mn(r),s.c(),v(s,1),s.m(e,null)):s&&(se(),M(s,1,1,()=>{s=null}),ne()),(!l||i&4194304&&t!==(t="flex flex-col justify-between px-5 mb-3 w-full "+(((o=r[22])==null?void 0:o.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group"))&&d(e,"class",t)},i(r){l||(v(s),l=!0)},o(r){M(s),l=!1},d(r){r&&m(e),s&&s.d()}}}const En=n=>n.parentId===null,Nn=n=>n.id;function Ef(n,e,t){let l;Me(n,bt,R=>t(22,l=R)),Vt(),Fe("i18n");let{chatId:s}=e,{selectedModels:r=[]}=e,{idx:i=0}=e,{history:o}=e,{messageId:a}=e,{user:f}=e,{gotoMessage:u}=e,{showPreviousMessage:c}=e,{showNextMessage:g}=e,{updateChat:h}=e,{editMessage:_}=e,{saveMessage:C}=e,{deleteMessage:p}=e,{rateMessage:N}=e,{actionMessage:D}=e,{submitMessage:L}=e,{regenerateResponse:O}=e,{continueResponse:A}=e,{mergeResponses:w}=e,{addMessages:V}=e,{triggerScroll:T}=e,{readOnly:S=!1}=e;function B(R){o=R,t(0,o)}return n.$$set=R=>{"chatId"in R&&t(1,s=R.chatId),"selectedModels"in R&&t(2,r=R.selectedModels),"idx"in R&&t(3,i=R.idx),"history"in R&&t(0,o=R.history),"messageId"in R&&t(4,a=R.messageId),"user"in R&&t(5,f=R.user),"gotoMessage"in R&&t(6,u=R.gotoMessage),"showPreviousMessage"in R&&t(7,c=R.showPreviousMessage),"showNextMessage"in R&&t(8,g=R.showNextMessage),"updateChat"in R&&t(9,h=R.updateChat),"editMessage"in R&&t(10,_=R.editMessage),"saveMessage"in R&&t(11,C=R.saveMessage),"deleteMessage"in R&&t(12,p=R.deleteMessage),"rateMessage"in R&&t(13,N=R.rateMessage),"actionMessage"in R&&t(14,D=R.actionMessage),"submitMessage"in R&&t(15,L=R.submitMessage),"regenerateResponse"in R&&t(16,O=R.regenerateResponse),"continueResponse"in R&&t(17,A=R.continueResponse),"mergeResponses"in R&&t(18,w=R.mergeResponses),"addMessages"in R&&t(19,V=R.addMessages),"triggerScroll"in R&&t(20,T=R.triggerScroll),"readOnly"in R&&t(21,S=R.readOnly)},[o,s,r,i,a,f,u,c,g,h,_,C,p,N,D,L,O,A,w,V,T,S,l,B]}class Nf extends Pe{constructor(e){super(),Ae(this,e,Ef,Mf,Te,{chatId:1,selectedModels:2,idx:3,history:0,messageId:4,user:5,gotoMessage:6,showPreviousMessage:7,showNextMessage:8,updateChat:9,editMessage:10,saveMessage:11,deleteMessage:12,rateMessage:13,actionMessage:14,submitMessage:15,regenerateResponse:16,continueResponse:17,mergeResponses:18,addMessages:19,triggerScroll:20,readOnly:21})}}function Dn(n,e,t){const l=n.slice();return l[14]=e[t],l[16]=t,l}function Df(n){let e,t,l,s,r;return{c(){e=y("div"),t=U(n[5]),l=U(" ‧ v"),s=U(vl),this.h()},l(i){e=I(i,"DIV",{class:!0});var o=k(e);t=W(o,n[5]),l=W(o," ‧ v"),s=W(o,vl),o.forEach(m),this.h()},h(){var i;d(e,"class",r="flex w-full "+(((i=n[4])==null?void 0:i.landingPageMode)==="chat"?" -mt-1":"text-center items-center justify-center")+" self-start text-gray-600 dark:text-gray-400")},m(i,o){E(i,e,o),b(e,t),b(e,l),b(e,s)},p(i,o){var a;o&32&&G(t,i[5]),o&16&&r!==(r="flex w-full "+(((a=i[4])==null?void 0:a.landingPageMode)==="chat"?" -mt-1":"text-center items-center justify-center")+" self-start text-gray-600 dark:text-gray-400")&&d(e,"class",r)},i:Ee,o:Ee,d(i){i&&m(e)}}}function Vf(n){let e,t,l=n[3].t("Suggested")+"",s,r;return e=new Kr({}),{c(){$(e.$$.fragment),t=j(),s=U(l)},l(i){x(e.$$.fragment,i),t=H(i),s=W(i,l)},m(i,o){ee(e,i,o),E(i,t,o),E(i,s,o),r=!0},p(i,o){(!r||o&8)&&l!==(l=i[3].t("Suggested")+"")&&G(s,l)},i(i){r||(v(e.$$.fragment,i),r=!0)},o(i){M(e.$$.fragment,i),r=!1},d(i){i&&(m(t),m(s)),te(e,i)}}}function Vn(n){let e,t=[],l=new Map,s,r=Ne(n[2]);const i=o=>o[14].id||o[14].content;for(let o=0;o<r.length;o+=1){let a=Dn(n,r,o),f=i(a);l.set(f,t[o]=Cn(f,a))}return{c(){e=y("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=I(o,"DIV",{role:!0,class:!0});var a=k(e);for(let f=0;f<t.length;f+=1)t[f].l(a);a.forEach(m),this.h()},h(){d(e,"role","list"),d(e,"class",s="max-h-40 overflow-auto scrollbar-none items-start "+n[0]+" svelte-1co34if")},m(o,a){E(o,e,a);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null)},p(o,a){a&14&&(r=Ne(o[2]),t=Ht(t,a,i,1,o,r,l,e,Tr,Cn,null,Dn)),a&1&&s!==(s="max-h-40 overflow-auto scrollbar-none items-start "+o[0]+" svelte-1co34if")&&d(e,"class",s)},d(o){o&&m(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Cf(n){let e,t=n[14].content+"",l,s,r,i=n[3].t("Prompt")+"",o;return{c(){e=y("div"),l=U(t),s=j(),r=y("div"),o=U(i),this.h()},l(a){e=I(a,"DIV",{class:!0});var f=k(e);l=W(f,t),f.forEach(m),s=H(a),r=I(a,"DIV",{class:!0});var u=k(r);o=W(u,i),u.forEach(m),this.h()},h(){d(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),d(r,"class","text-xs text-gray-600 dark:text-gray-400 font-normal line-clamp-1")},m(a,f){E(a,e,f),b(e,l),E(a,s,f),E(a,r,f),b(r,o)},p(a,f){f&4&&t!==(t=a[14].content+"")&&G(l,t),f&8&&i!==(i=a[3].t("Prompt")+"")&&G(o,i)},d(a){a&&(m(e),m(s),m(r))}}}function Sf(n){let e,t=n[14].title[0]+"",l,s,r,i=n[14].title[1]+"",o;return{c(){e=y("div"),l=U(t),s=j(),r=y("div"),o=U(i),this.h()},l(a){e=I(a,"DIV",{class:!0});var f=k(e);l=W(f,t),f.forEach(m),s=H(a),r=I(a,"DIV",{class:!0});var u=k(r);o=W(u,i),u.forEach(m),this.h()},h(){d(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),d(r,"class","text-xs text-gray-600 dark:text-gray-400 font-normal line-clamp-1")},m(a,f){E(a,e,f),b(e,l),E(a,s,f),E(a,r,f),b(r,o)},p(a,f){f&4&&t!==(t=a[14].title[0]+"")&&G(l,t),f&4&&i!==(i=a[14].title[1]+"")&&G(o,i)},d(a){a&&(m(e),m(s),m(r))}}}function Cn(n,e){let t,l,s,r,i;function o(c,g){return c[14].title&&c[14].title[0]!==""?Sf:Cf}let a=o(e),f=a(e);function u(){return e[10](e[14])}return{key:n,first:null,c(){t=y("button"),l=y("div"),f.c(),s=j(),this.h()},l(c){t=I(c,"BUTTON",{role:!0,class:!0,style:!0});var g=k(t);l=I(g,"DIV",{class:!0});var h=k(l);f.l(h),h.forEach(m),s=H(g),g.forEach(m),this.h()},h(){d(l,"class","flex flex-col text-left"),d(t,"role","listitem"),d(t,"class","waterfall flex flex-col flex-1 shrink-0 w-full justify-between px-3 py-2 rounded-xl bg-transparent hover:bg-black/5 dark:hover:bg-white/5 transition group svelte-1co34if"),At(t,"animation-delay",e[16]*60+"ms"),this.first=t},m(c,g){E(c,t,g),b(t,l),f.m(l,null),b(t,s),r||(i=me(t,"click",u),r=!0)},p(c,g){e=c,a===(a=o(e))&&f?f.p(e,g):(f.d(1),f=a(e),f&&(f.c(),f.m(l,null))),g&4&&At(t,"animation-delay",e[16]*60+"ms")},d(c){c&&m(t),f.d(),r=!1,i()}}}function Tf(n){let e,t,l,s,r,i;const o=[Vf,Df],a=[];function f(c,g){return c[2].length>0?0:1}t=f(n),l=a[t]=o[t](n);let u=n[2].length>0&&Vn(n);return{c(){e=y("div"),l.c(),s=j(),r=y("div"),u&&u.c(),this.h()},l(c){e=I(c,"DIV",{class:!0});var g=k(e);l.l(g),g.forEach(m),s=H(c),r=I(c,"DIV",{class:!0});var h=k(r);u&&u.l(h),h.forEach(m),this.h()},h(){d(e,"class","mb-1 flex gap-1 text-xs font-medium items-center text-gray-600 dark:text-gray-400"),d(r,"class","h-40 w-full")},m(c,g){E(c,e,g),a[t].m(e,null),E(c,s,g),E(c,r,g),u&&u.m(r,null),i=!0},p(c,[g]){let h=t;t=f(c),t===h?a[t].p(c,g):(se(),M(a[h],1,1,()=>{a[h]=null}),ne(),l=a[t],l?l.p(c,g):(l=a[t]=o[t](c),l.c()),v(l,1),l.m(e,null)),c[2].length>0?u?u.p(c,g):(u=Vn(c),u.c(),u.m(r,null)):u&&(u.d(1),u=null)},i(c){i||(v(l),i=!0)},o(c){M(l),i=!1},d(c){c&&(m(e),m(s),m(r)),a[t].d(),u&&u.d()}}}function Bf(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if((n[t].id??n[t].content)!==(e[t].id??e[t].content))return!1;return!0}function Rf(n,e,t){let l,s,r;Me(n,bt,N=>t(4,s=N)),Me(n,Pr,N=>t(5,r=N));const i=Fe("i18n");Me(n,i,N=>t(3,l=N));let{suggestionPrompts:o=[]}=e,{className:a=""}=e,{inputValue:f=""}=e,{onSelect:u=N=>{}}=e,c=[];const g={keys:["content","title"],threshold:.5};let h,_=[];const C=N=>{if(N.length>500)t(2,_=[]);else{const D=N.trim()&&h?h.search(N.trim()).map(L=>L.item):c;Bf(_,D)||t(2,_=D)}},p=N=>u({type:"prompt",data:N.content});return n.$$set=N=>{"suggestionPrompts"in N&&t(7,o=N.suggestionPrompts),"className"in N&&t(0,a=N.className),"inputValue"in N&&t(8,f=N.inputValue),"onSelect"in N&&t(1,u=N.onSelect)},n.$$.update=()=>{n.$$.dirty&384&&o&&(t(9,c=[...o??[]].sort(()=>Math.random()-.5)),C(f)),n.$$.dirty&512&&(h=new ti(c,g)),n.$$.dirty&256&&C(f)},[a,u,_,l,s,r,i,o,f,c,p]}class Of extends Pe{constructor(e){super(),Ae(this,e,Rf,Tf,Te,{suggestionPrompts:7,className:0,inputValue:8,onSelect:1})}}function Sn(n,e,t){const l=n.slice();return l[13]=e[t],l[15]=t,l}function Pf(n){let e,t;return{c(){e=y("img"),this.h()},l(l){e=I(l,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),this.h()},h(){var l,s,r;d(e,"crossorigin","anonymous"),Lt(e.src,t=((r=(s=(l=n[13])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.profile_image_url)??(n[5].language==="dg-DG"?`${Ze}/doge.png`:`${Ze}/static/favicon.png`))||d(e,"src",t),d(e,"class","size-[2.7rem] rounded-full border-[1px] border-gray-100 dark:border-none"),d(e,"alt","logo"),d(e,"draggable","false")},m(l,s){E(l,e,s)},p(l,s){var r,i,o;s&33&&!Lt(e.src,t=((o=(i=(r=l[13])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:o.profile_image_url)??(l[5].language==="dg-DG"?`${Ze}/doge.png`:`${Ze}/static/favicon.png`))&&d(e,"src",t)},d(l){l&&m(e)}}}function Tn(n){var a,f,u;let e,t,l,s,r,i;t=new Be({props:{content:jt.parse(kt(((u=(f=(a=n[0][n[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.description)??"").replaceAll(`
`,"<br>")),placement:"right",$$slots:{default:[Pf]},$$scope:{ctx:n}}});function o(){return n[12](n[15])}return{c(){e=y("button"),$(t.$$.fragment),l=j()},l(c){e=I(c,"BUTTON",{});var g=k(e);x(t.$$.fragment,g),l=H(g),g.forEach(m)},m(c,g){E(c,e,g),ee(t,e,null),b(e,l),s=!0,r||(i=me(e,"click",o),r=!0)},p(c,g){var _,C,p;n=c;const h={};g&17&&(h.content=jt.parse(kt(((p=(C=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:C.meta)==null?void 0:p.description)??"").replaceAll(`
`,"<br>"))),g&65569&&(h.$$scope={dirty:g,ctx:n}),t.$set(h)},i(c){s||(v(t.$$.fragment,c),s=!0)},o(c){M(t.$$.fragment,c),s=!1},d(c){c&&m(e),te(t),r=!1,i()}}}function Bn(n){let e,t;return e=new Be({props:{content:n[5].t("This chat won't appear in history and your messages will not be saved."),className:"w-full flex justify-start mb-0.5",placement:"top",$$slots:{default:[Af]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s&32&&(r.content=l[5].t("This chat won't appear in history and your messages will not be saved.")),s&65568&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Af(n){let e,t,l=n[5].t("Temporary Chat")+"",s,r;return t=new li({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=y("div"),$(t.$$.fragment),s=U(l),this.h()},l(i){e=I(i,"DIV",{class:!0});var o=k(e);x(t.$$.fragment,o),s=W(o,l),o.forEach(m),this.h()},h(){d(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg mt-2 w-fit")},m(i,o){E(i,e,o),ee(t,e,null),b(e,s),r=!0},p(i,o){(!r||o&32)&&l!==(l=i[5].t("Temporary Chat")+"")&&G(s,l)},i(i){r||(v(t.$$.fragment,i),r=!0)},o(i){M(t.$$.fragment,i),r=!1},d(i){i&&m(e),te(t)}}}function Lf(n){var l;let e=n[5].t("Hello, {{name}}",{name:(l=n[7])==null?void 0:l.name})+"",t;return{c(){t=U(e)},l(s){t=W(s,e)},m(s,r){E(s,t,r)},p(s,r){var i;r&160&&e!==(e=s[5].t("Hello, {{name}}",{name:(i=s[7])==null?void 0:i.name})+"")&&G(t,e)},d(s){s&&m(t)}}}function jf(n){var l;let e=((l=n[0][n[4]])==null?void 0:l.name)+"",t;return{c(){t=U(e)},l(s){t=W(s,e)},m(s,r){E(s,t,r)},p(s,r){var i;r&17&&e!==(e=((i=s[0][s[4]])==null?void 0:i.name)+"")&&G(t,e)},d(s){s&&m(t)}}}function Hf(n){let e,t=n[5].t("How can I help you today?")+"",l;return{c(){e=y("div"),l=U(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var r=k(e);l=W(r,t),r.forEach(m),this.h()},h(){d(e,"class","font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p")},m(s,r){E(s,e,r),b(e,l)},p(s,r){r&32&&t!==(t=s[5].t("How can I help you today?")+"")&&G(l,t)},d(s){s&&m(e)}}}function zf(n){var o,a,f,u,c,g;let e,t,l=jt.parse(kt((f=(a=(o=n[0][n[4]])==null?void 0:o.info)==null?void 0:a.meta)==null?void 0:f.description).replaceAll(`
`,"<br>"))+"",s,r,i=((g=(c=(u=n[0][n[4]])==null?void 0:u.info)==null?void 0:c.meta)==null?void 0:g.user)&&Rn(n);return{c(){e=y("div"),t=new Cr(!1),s=j(),i&&i.c(),r=he(),this.h()},l(h){e=I(h,"DIV",{class:!0});var _=k(e);t=Sr(_,!1),_.forEach(m),s=H(h),i&&i.l(h),r=he(),this.h()},h(){t.a=null,d(e,"class","mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown")},m(h,_){E(h,e,_),t.m(l,e),E(h,s,_),i&&i.m(h,_),E(h,r,_)},p(h,_){var C,p,N,D,L,O;_&17&&l!==(l=jt.parse(kt((N=(p=(C=h[0][h[4]])==null?void 0:C.info)==null?void 0:p.meta)==null?void 0:N.description).replaceAll(`
`,"<br>"))+"")&&t.p(l),(O=(L=(D=h[0][h[4]])==null?void 0:D.info)==null?void 0:L.meta)!=null&&O.user?i?i.p(h,_):(i=Rn(h),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},d(h){h&&(m(e),m(s),m(r)),i&&i.d(h)}}}function Rn(n){let e,t;function l(i,o){var a,f,u;return(u=(f=(a=i[0][i[4]])==null?void 0:a.info)==null?void 0:f.meta)!=null&&u.user.community?Wf:Uf}let s=l(n),r=s(n);return{c(){e=y("div"),t=U(`By
								`),r.c(),this.h()},l(i){e=I(i,"DIV",{class:!0});var o=k(e);t=W(o,`By
								`),r.l(o),o.forEach(m),this.h()},h(){d(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,o){E(i,e,o),b(e,t),r.m(e,null)},p(i,o){s===(s=l(i))&&r?r.p(i,o):(r.d(1),r=s(i),r&&(r.c(),r.m(e,null)))},d(i){i&&m(e),r.d()}}}function Uf(n){var l,s,r;let e=((r=(s=(l=n[0][n[4]])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.user.name)+"",t;return{c(){t=U(e)},l(i){t=W(i,e)},m(i,o){E(i,t,o)},p(i,o){var a,f,u;o&17&&e!==(e=((u=(f=(a=i[0][i[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name)+"")&&G(t,e)},d(i){i&&m(t)}}}function Wf(n){var r,i,o,a,f,u,c,g,h;let e,t=((o=(i=(r=n[0][n[4]])==null?void 0:r.info)==null?void 0:i.meta)!=null&&o.user.name?(u=(f=(a=n[0][n[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name:`@${(h=(g=(c=n[0][n[4]])==null?void 0:c.info)==null?void 0:g.meta)==null?void 0:h.user.username}`)+"",l,s;return{c(){e=y("a"),l=U(t),this.h()},l(_){e=I(_,"A",{href:!0});var C=k(e);l=W(C,t),C.forEach(m),this.h()},h(){var _,C,p;d(e,"href",s="/m/"+((p=(C=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:C.meta)==null?void 0:p.user.username))},m(_,C){E(_,e,C),b(e,l)},p(_,C){var p,N,D,L,O,A,w,V,T,S,B,R;C&17&&t!==(t=((D=(N=(p=_[0][_[4]])==null?void 0:p.info)==null?void 0:N.meta)!=null&&D.user.name?(A=(O=(L=_[0][_[4]])==null?void 0:L.info)==null?void 0:O.meta)==null?void 0:A.user.name:`@${(T=(V=(w=_[0][_[4]])==null?void 0:w.info)==null?void 0:V.meta)==null?void 0:T.user.username}`)+"")&&G(l,t),C&17&&s!==(s="/m/"+((R=(B=(S=_[0][_[4]])==null?void 0:S.info)==null?void 0:B.meta)==null?void 0:R.user.username))&&d(e,"href",s)},d(_){_&&m(e)}}}function On(n){var le,F,X,ae,de,ge,pe;let e,t,l,s,r,i,o,a,f,u,c,g,h,_,C,p,N,D,L=Ne(n[0]),O=[];for(let Y=0;Y<L.length;Y+=1)O[Y]=Tn(Sn(n,L,Y));const A=Y=>M(O[Y],1,1,()=>{O[Y]=null});let w=n[6]&&Bn(n);function V(Y,re){var be;return(be=Y[0][Y[4]])!=null&&be.name?jf:Lf}let T=V(n),S=T(n);function B(Y,re){var be,fe,ce;return((ce=(fe=(be=Y[0][Y[4]])==null?void 0:be.info)==null?void 0:fe.meta)==null?void 0:ce.description)??null?zf:Hf}let R=B(n),q=R(n);return p=new Of({props:{className:"grid grid-cols-2",suggestionPrompts:((X=(F=(le=n[1])==null?void 0:le.info)==null?void 0:F.meta)==null?void 0:X.suggestion_prompts)??((ge=(de=(ae=n[0][n[4]])==null?void 0:ae.info)==null?void 0:de.meta)==null?void 0:ge.suggestion_prompts)??((pe=n[8])==null?void 0:pe.default_prompt_suggestions)??[],onSelect:n[2]}}),{c(){e=y("div"),t=y("div"),l=y("div");for(let Y=0;Y<O.length;Y+=1)O[Y].c();r=j(),w&&w.c(),i=j(),o=y("div"),a=y("div"),f=y("div"),S.c(),c=j(),g=y("div"),q.c(),_=j(),C=y("div"),$(p.$$.fragment),this.h()},l(Y){e=I(Y,"DIV",{class:!0});var re=k(e);t=I(re,"DIV",{class:!0});var be=k(t);l=I(be,"DIV",{class:!0});var fe=k(l);for(let P=0;P<O.length;P+=1)O[P].l(fe);fe.forEach(m),be.forEach(m),r=H(re),w&&w.l(re),i=H(re),o=I(re,"DIV",{class:!0});var ce=k(o);a=I(ce,"DIV",{});var ye=k(a);f=I(ye,"DIV",{class:!0});var J=k(f);S.l(J),J.forEach(m),c=H(ye),g=I(ye,"DIV",{});var oe=k(g);q.l(oe),oe.forEach(m),ye.forEach(m),ce.forEach(m),_=H(re),C=I(re,"DIV",{class:!0});var _e=k(C);x(p.$$.fragment,_e),_e.forEach(m),re.forEach(m),this.h()},h(){d(l,"class","flex -space-x-4 mb-0.5"),d(t,"class","flex justify-start"),d(f,"class","capitalize line-clamp-1"),d(o,"class","mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary"),d(C,"class","w-full font-primary"),d(e,"class","m-auto w-full max-w-6xl px-8 lg:px-20")},m(Y,re){E(Y,e,re),b(e,t),b(t,l);for(let be=0;be<O.length;be+=1)O[be]&&O[be].m(l,null);b(e,r),w&&w.m(e,null),b(e,i),b(e,o),b(o,a),b(a,f),S.m(f,null),b(a,c),b(a,g),q.m(g,null),b(e,_),b(e,C),ee(p,C,null),D=!0},p(Y,re){var fe,ce,ye,J,oe,_e,P;if(re&49){L=Ne(Y[0]);let K;for(K=0;K<L.length;K+=1){const Z=Sn(Y,L,K);O[K]?(O[K].p(Z,re),v(O[K],1)):(O[K]=Tn(Z),O[K].c(),v(O[K],1),O[K].m(l,null))}for(se(),K=L.length;K<O.length;K+=1)A(K);ne()}Y[6]?w?(w.p(Y,re),re&64&&v(w,1)):(w=Bn(Y),w.c(),v(w,1),w.m(e,i)):w&&(se(),M(w,1,1,()=>{w=null}),ne()),T===(T=V(Y))&&S?S.p(Y,re):(S.d(1),S=T(Y),S&&(S.c(),S.m(f,null))),R===(R=B(Y))&&q?q.p(Y,re):(q.d(1),q=R(Y),q&&(q.c(),q.m(g,null)));const be={};re&275&&(be.suggestionPrompts=((ye=(ce=(fe=Y[1])==null?void 0:fe.info)==null?void 0:ce.meta)==null?void 0:ye.suggestion_prompts)??((_e=(oe=(J=Y[0][Y[4]])==null?void 0:J.info)==null?void 0:oe.meta)==null?void 0:_e.suggestion_prompts)??((P=Y[8])==null?void 0:P.default_prompt_suggestions)??[]),re&4&&(be.onSelect=Y[2]),p.$set(be)},i(Y){if(!D){for(let re=0;re<L.length;re+=1)v(O[re]);Y&&(s||Et(()=>{s=Nt(l,Dt,{duration:200}),s.start()})),v(w),Y&&(u||Et(()=>{u=Nt(f,Dt,{duration:200}),u.start()})),Y&&(h||Et(()=>{h=Nt(g,Dt,{duration:200,delay:200}),h.start()})),v(p.$$.fragment,Y),Y&&(N||Et(()=>{N=Nt(C,Dt,{duration:200,delay:300}),N.start()})),D=!0}},o(Y){O=O.filter(Boolean);for(let re=0;re<O.length;re+=1)M(O[re]);M(w),M(p.$$.fragment,Y),D=!1},d(Y){Y&&m(e),qe(O,Y),w&&w.d(),S.d(),q.d(),te(p)}}}function qf(n){let e=n[3],t,l,s=On(n);return{c(){s.c(),t=he()},l(r){s.l(r),t=he()},m(r,i){s.m(r,i),E(r,t,i),l=!0},p(r,[i]){i&8&&Te(e,e=r[3])?(se(),M(s,1,1,Ee),ne(),s=On(r),s.c(),v(s,1),s.m(t.parentNode,t)):s.p(r,i)},i(r){l||(v(s),l=!0)},o(r){M(s),l=!1},d(r){r&&m(t),s.d(r)}}}function Ff(n,e,t){let l,s,r,i,o;Me(n,zt,p=>t(11,l=p)),Me(n,Zt,p=>t(6,r=p)),Me(n,Ut,p=>t(7,i=p)),Me(n,Un,p=>t(8,o=p));const a=Fe("i18n");Me(n,a,p=>t(5,s=p));let{modelIds:f=[]}=e,{models:u=[]}=e,{atSelectedModel:c}=e,{onSelect:g=p=>{}}=e,h=!1,_=0;yt(()=>{t(3,h=!0)});const C=p=>{t(4,_=p)};return n.$$set=p=>{"modelIds"in p&&t(10,f=p.modelIds),"models"in p&&t(0,u=p.models),"atSelectedModel"in p&&t(1,c=p.atSelectedModel),"onSelect"in p&&t(2,g=p.onSelect)},n.$$.update=()=>{n.$$.dirty&3072&&t(0,u=f.map(p=>l.find(N=>N.id===p))),n.$$.dirty&1025&&f.length>0&&t(4,_=u.length-1)},[u,c,g,h,_,s,r,i,o,a,f,l,C]}class Jf extends Pe{constructor(e){super(),Ae(this,e,Ff,qf,Te,{modelIds:10,models:0,atSelectedModel:1,onSelect:2})}}function Pn(n,e,t){const l=n.slice();return l[43]=e[t],l[45]=t,l}function Gf(n){let e,t=n[2],l,s=Hn(n);return{c(){e=y("div"),s.c(),this.h()},l(r){e=I(r,"DIV",{class:!0});var i=k(e);s.l(i),i.forEach(m),this.h()},h(){d(e,"class","w-full pt-2")},m(r,i){E(r,e,i),s.m(e,null),l=!0},p(r,i){i[0]&4&&Te(t,t=r[2])?(se(),M(s,1,1,Ee),ne(),s=Hn(r),s.c(),v(s,1),s.m(e,null)):s.p(r,i)},i(r){l||(v(s),l=!0)},o(r){M(s),l=!1},d(r){r&&m(e),s.d(r)}}}function Kf(n){let e,t;return e=new Jf({props:{modelIds:n[4],atSelectedModel:n[5],onSelect:n[13]}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&16&&(r.modelIds=l[4]),s[0]&32&&(r.atSelectedModel=l[5]),s[0]&8192&&(r.onSelect=l[13]),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function An(n){let e,t;return e=new ei({props:{$$slots:{default:[Zf]},$$scope:{ctx:n}}}),e.$on("visible",n[34]),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[1]&32768&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Zf(n){let e,t,l,s,r="Loading...",i;return t=new $t({props:{className:" size-4"}}),{c(){e=y("div"),$(t.$$.fragment),l=j(),s=y("div"),s.textContent=r,this.h()},l(o){e=I(o,"DIV",{class:!0});var a=k(e);x(t.$$.fragment,a),l=H(a),s=I(a,"DIV",{class:!0,"data-svelte-h":!0}),tt(s)!=="svelte-17uns3n"&&(s.textContent=r),a.forEach(m),this.h()},h(){d(s,"class",""),d(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(o,a){E(o,e,a),ee(t,e,null),b(e,l),b(e,s),i=!0},p:Ee,i(o){i||(v(t.$$.fragment,o),i=!0)},o(o){M(t.$$.fragment,o),i=!1},d(o){o&&m(e),te(t)}}}function Ln(n,e){let t,l,s,r;function i(a){e[35](a)}let o={chatId:e[2],selectedModels:e[4],messageId:e[43].id,idx:e[45],user:e[3],gotoMessage:e[19],showPreviousMessage:e[20],showNextMessage:e[21],updateChat:e[18],editMessage:e[23],deleteMessage:e[26],rateMessage:e[22],actionMessage:e[24],saveMessage:e[25],submitMessage:e[9],regenerateResponse:e[7],continueResponse:e[6],mergeResponses:e[8],addMessages:e[10],triggerScroll:e[27],readOnly:e[11]};return e[0]!==void 0&&(o.history=e[0]),l=new Nf({props:o}),He.push(()=>Xe(l,"history",i)),{key:n,first:null,c(){t=he(),$(l.$$.fragment),this.h()},l(a){t=he(),x(l.$$.fragment,a),this.h()},h(){this.first=t},m(a,f){E(a,t,f),ee(l,a,f),r=!0},p(a,f){e=a;const u={};f[0]&4&&(u.chatId=e[2]),f[0]&16&&(u.selectedModels=e[4]),f[0]&16384&&(u.messageId=e[43].id),f[0]&16384&&(u.idx=e[45]),f[0]&8&&(u.user=e[3]),f[0]&512&&(u.submitMessage=e[9]),f[0]&128&&(u.regenerateResponse=e[7]),f[0]&64&&(u.continueResponse=e[6]),f[0]&256&&(u.mergeResponses=e[8]),f[0]&1024&&(u.addMessages=e[10]),f[0]&2048&&(u.readOnly=e[11]),!s&&f[0]&1&&(s=!0,u.history=e[0],Qe(()=>s=!1)),l.$set(u)},i(a){r||(v(l.$$.fragment,a),r=!0)},o(a){M(l.$$.fragment,a),r=!1},d(a){a&&m(t),te(l,a)}}}function jn(n){let e;return{c(){e=y("div"),this.h()},l(t){e=I(t,"DIV",{class:!0}),k(e).forEach(m),this.h()},h(){d(e,"class","pb-6")},m(t,l){E(t,e,l)},d(t){t&&m(e)}}}function Hn(n){var C;let e,t=((C=n[14].at(0))==null?void 0:C.parentId)!==null,l,s=[],r=new Map,i,o,a,f,u,c=t&&An(n),g=Ne(n[14]);const h=p=>p[43].id;for(let p=0;p<g.length;p+=1){let N=Pn(n,g,p),D=h(N);r.set(D,s[p]=Ln(D,N))}let _=n[12]&&jn();return{c(){e=y("div"),c&&c.c(),l=j();for(let p=0;p<s.length;p+=1)s[p].c();i=j(),o=y("div"),a=j(),_&&_.c(),f=he(),this.h()},l(p){e=I(p,"DIV",{class:!0});var N=k(e);c&&c.l(N),l=H(N);for(let D=0;D<s.length;D+=1)s[D].l(N);N.forEach(m),i=H(p),o=I(p,"DIV",{class:!0}),k(o).forEach(m),a=H(p),_&&_.l(p),f=he(),this.h()},h(){d(e,"class","w-full"),d(o,"class","pb-12")},m(p,N){E(p,e,N),c&&c.m(e,null),b(e,l);for(let D=0;D<s.length;D+=1)s[D]&&s[D].m(e,null);E(p,i,N),E(p,o,N),E(p,a,N),_&&_.m(p,N),E(p,f,N),u=!0},p(p,N){var D;N[0]&16384&&(t=((D=p[14].at(0))==null?void 0:D.parentId)!==null),t?c?(c.p(p,N),N[0]&16384&&v(c,1)):(c=An(p),c.c(),v(c,1),c.m(e,l)):c&&(se(),M(c,1,1,()=>{c=null}),ne()),N[0]&268193757&&(g=Ne(p[14]),se(),s=Ht(s,N,h,1,p,g,r,e,Kt,Ln,null,Pn),ne()),p[12]?_||(_=jn(),_.c(),_.m(f.parentNode,f)):_&&(_.d(1),_=null)},i(p){if(!u){v(c);for(let N=0;N<g.length;N+=1)v(s[N]);u=!0}},o(p){M(c);for(let N=0;N<s.length;N+=1)M(s[N]);u=!1},d(p){p&&(m(e),m(i),m(o),m(a),m(f)),c&&c.d();for(let N=0;N<s.length;N+=1)s[N].d();_&&_.d(p)}}}function Qf(n){let e,t,l,s,r;const i=[Kf,Gf],o=[];function a(f,u){var c;return u[0]&1&&(t=null),t==null&&(t=Object.keys(((c=f[0])==null?void 0:c.messages)??{}).length==0),t?0:1}return l=a(n,[-1,-1]),s=o[l]=i[l](n),{c(){e=y("div"),s.c(),this.h()},l(f){e=I(f,"DIV",{class:!0});var u=k(e);s.l(u),u.forEach(m),this.h()},h(){d(e,"class",n[1])},m(f,u){E(f,e,u),o[l].m(e,null),r=!0},p(f,u){let c=l;l=a(f,u),l===c?o[l].p(f,u):(se(),M(o[c],1,1,()=>{o[c]=null}),ne(),s=o[l],s?s.p(f,u):(s=o[l]=i[l](f),s.c()),v(s,1),s.m(e,null)),(!r||u[0]&2)&&d(e,"class",f[1])},i(f){r||(v(s),r=!0)},o(f){M(s),r=!1},d(f){f&&m(e),o[l].d()}}}function Xf(n,e,t){let l,s,r,i,o;Me(n,bt,P=>t(37,s=P)),Me(n,kl,P=>t(38,r=P)),Me(n,Zt,P=>t(39,i=P)),Me(n,Ut,P=>t(40,o=P)),Vt();const a=Fe("i18n");Me(n,a,P=>t(36,l=P));let{className:f="h-full flex pt-8"}=e,{chatId:u=""}=e,{user:c=o}=e,{prompt:g}=e,{history:h={}}=e,{selectedModels:_}=e,{atSelectedModel:C}=e,p=[],{sendPrompt:N}=e,{continueResponse:D}=e,{regenerateResponse:L}=e,{mergeResponses:O}=e,{chatActionHandler:A}=e,{showMessage:w=()=>{}}=e,{submitMessage:V=()=>{}}=e,{addMessages:T=()=>{}}=e,{readOnly:S=!1}=e,{bottomPadding:B=!1}=e,{autoScroll:R}=e,{onSelect:q=P=>{}}=e,le=20,F=!1;const X=async()=>{const P=document.getElementById("messages-container");P.scrollTop=P.scrollTop+100,t(15,F=!0),t(33,le+=20),await Ce(),t(15,F=!1)},ae=()=>{const P=document.getElementById("messages-container");P.scrollTop=P.scrollHeight},de=async()=>{i||(t(0,h),await Ce(),await jr(localStorage.token,u,{history:h,messages:p}),kl.set(1),await Ar.set(await Hr(localStorage.token,r)))},ge=async(P,K)=>{let Z;P.parentId!==null?Z=h.messages[P.parentId].childrenIds:Z=Object.values(h.messages).filter(ue=>ue.parentId===null).map(ue=>ue.id),K=Math.max(0,Math.min(K,Z.length-1));let Q=Z[K];if(P.id!==Q){let ue=h.messages[Q].childrenIds;for(;ue.length!==0;)Q=ue.at(-1),ue=h.messages[Q].childrenIds;t(0,h.currentId=Q,h)}if(await Ce(),(s==null?void 0:s.scrollOnBranchChange)??!0){const ue=document.getElementById("messages-container");t(28,R=ue.scrollHeight-ue.scrollTop<=ue.clientHeight+50),setTimeout(()=>{ae()},100)}},pe=async P=>{if(P.parentId!==null){let K=h.messages[P.parentId].childrenIds[Math.max(h.messages[P.parentId].childrenIds.indexOf(P.id)-1,0)];if(P.id!==K){let Z=h.messages[K].childrenIds;for(;Z.length!==0;)K=Z.at(-1),Z=h.messages[K].childrenIds;t(0,h.currentId=K,h)}}else{let K=Object.values(h.messages).filter(Q=>Q.parentId===null).map(Q=>Q.id),Z=K[Math.max(K.indexOf(P.id)-1,0)];if(P.id!==Z){let Q=h.messages[Z].childrenIds;for(;Q.length!==0;)Z=Q.at(-1),Q=h.messages[Z].childrenIds;t(0,h.currentId=Z,h)}}if(await Ce(),(s==null?void 0:s.scrollOnBranchChange)??!0){const K=document.getElementById("messages-container");t(28,R=K.scrollHeight-K.scrollTop<=K.clientHeight+50),setTimeout(()=>{ae()},100)}},Y=async P=>{if(P.parentId!==null){let K=h.messages[P.parentId].childrenIds[Math.min(h.messages[P.parentId].childrenIds.indexOf(P.id)+1,h.messages[P.parentId].childrenIds.length-1)];if(P.id!==K){let Z=h.messages[K].childrenIds;for(;Z.length!==0;)K=Z.at(-1),Z=h.messages[K].childrenIds;t(0,h.currentId=K,h)}}else{let K=Object.values(h.messages).filter(Q=>Q.parentId===null).map(Q=>Q.id),Z=K[Math.min(K.indexOf(P.id)+1,K.length-1)];if(P.id!==Z){let Q=h.messages[Z].childrenIds;for(;Q.length!==0;)Z=Q.at(-1),Q=h.messages[Z].childrenIds;t(0,h.currentId=Z,h)}}if(await Ce(),(s==null?void 0:s.scrollOnBranchChange)??!0){const K=document.getElementById("messages-container");t(28,R=K.scrollHeight-K.scrollTop<=K.clientHeight+50),setTimeout(()=>{ae()},100)}},re=async(P,K)=>{t(0,h.messages[P].annotation={...h.messages[P].annotation,rating:K},h),await de()},be=async(P,{content:K,files:Z},Q=!0)=>{if((_??[]).filter(ue=>ue).length===0){Le.error(l.t("Model not selected"));return}if(h.messages[P].role==="user")if(Q){let ue=K,ve=yl(),Ve={id:ve,parentId:h.messages[P].parentId,childrenIds:[],role:"user",content:ue,...Z&&{files:Z},models:_,timestamp:Math.floor(Date.now()/1e3)},De=h.messages[P].parentId;De!==null&&t(0,h.messages[De].childrenIds=[...h.messages[De].childrenIds,ve],h),t(0,h.messages[ve]=Ve,h),t(0,h.currentId=ve,h),await Ce(),await N(h,ue,ve)}else t(0,h.messages[P].content=K,h),t(0,h.messages[P].files=Z,h),await de();else if(Q){const ue=yl(),ve=h.messages[P],Ve=ve.parentId,De={...ve,id:ue,parentId:Ve,childrenIds:[],files:void 0,content:K,timestamp:Math.floor(Date.now()/1e3)};t(0,h.messages[ue]=De,h),t(0,h.currentId=ue,h),Ve!==null&&t(0,h.messages[Ve].childrenIds=[...h.messages[Ve].childrenIds,ue],h),await de()}else t(0,h.messages[P].originalContent=h.messages[P].content,h),t(0,h.messages[P].content=K,h),await de()},fe=async(P,K,Z=null)=>{await A(u,P,K.model,K.id,Z)},ce=async(P,K)=>{t(0,h.messages[P]=K,h),await de()},ye=async P=>{const K=h.messages[P],Z=K.parentId,Q=K.childrenIds??[],ue=Q.flatMap(ve=>{var Ve;return((Ve=h.messages[ve])==null?void 0:Ve.childrenIds)??[]});Z&&h.messages[Z]&&t(0,h.messages[Z].childrenIds=[...h.messages[Z].childrenIds.filter(ve=>ve!==P),...ue],h),ue.forEach(ve=>{h.messages[ve]&&t(0,h.messages[ve].parentId=Z,h)}),[P,...Q].forEach(ve=>{delete h.messages[ve]}),await Ce(),w({id:Z}),await de()},J=()=>{if(R){const P=document.getElementById("messages-container");t(28,R=P.scrollHeight-P.scrollTop<=P.clientHeight+50),setTimeout(()=>{ae()},100)}},oe=P=>{F||X()};function _e(P){h=P,t(0,h)}return n.$$set=P=>{"className"in P&&t(1,f=P.className),"chatId"in P&&t(2,u=P.chatId),"user"in P&&t(3,c=P.user),"prompt"in P&&t(29,g=P.prompt),"history"in P&&t(0,h=P.history),"selectedModels"in P&&t(4,_=P.selectedModels),"atSelectedModel"in P&&t(5,C=P.atSelectedModel),"sendPrompt"in P&&t(30,N=P.sendPrompt),"continueResponse"in P&&t(6,D=P.continueResponse),"regenerateResponse"in P&&t(7,L=P.regenerateResponse),"mergeResponses"in P&&t(8,O=P.mergeResponses),"chatActionHandler"in P&&t(31,A=P.chatActionHandler),"showMessage"in P&&t(32,w=P.showMessage),"submitMessage"in P&&t(9,V=P.submitMessage),"addMessages"in P&&t(10,T=P.addMessages),"readOnly"in P&&t(11,S=P.readOnly),"bottomPadding"in P&&t(12,B=P.bottomPadding),"autoScroll"in P&&t(28,R=P.autoScroll),"onSelect"in P&&t(13,q=P.onSelect)},n.$$.update=()=>{if(n.$$.dirty[0]&1|n.$$.dirty[1]&4)if(h.currentId){let P=[],K=h.messages[h.currentId];for(;K&&P.length<=le;)P.unshift({...K}),K=K.parentId!==null?h.messages[K.parentId]:null;t(14,p=P)}else t(14,p=[]);n.$$.dirty[0]&268439552&&R&&B&&(async()=>(await Ce(),ae()))()},[h,f,u,c,_,C,D,L,O,V,T,S,B,q,p,F,a,X,de,ge,pe,Y,re,be,fe,ce,ye,J,R,g,N,A,w,le,oe,_e]}class Pu extends Pe{constructor(e){super(),Ae(this,e,Xf,Qf,Te,{className:1,chatId:2,user:3,prompt:29,history:0,selectedModels:4,atSelectedModel:5,sendPrompt:30,continueResponse:6,regenerateResponse:7,mergeResponses:8,chatActionHandler:31,showMessage:32,submitMessage:9,addMessages:10,readOnly:11,bottomPadding:12,autoScroll:28,onSelect:13},null,[-1,-1])}}export{ni as K,Pu as M,Of as S};
//# sourceMappingURL=BMfnlrZ5.js.map
